(()=>{var uwe=Object.create;var lne=Object.defineProperty;var swe=Object.getOwnPropertyDescriptor;var lwe=Object.getOwnPropertyNames;var cwe=Object.getPrototypeOf,dwe=Object.prototype.hasOwnProperty;var fwe=(e,r)=>()=>(e&&(r=e(e=0)),r);var T=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var pwe=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(var a=lwe(r),o=0,u=a.length,s;o<u;o++)s=a[o],!dwe.call(e,s)&&s!==t&&lne(e,s,{get:(l=>r[l]).bind(null,s),enumerable:!(n=swe(r,s))||n.enumerable});return e};var NV=(e,r,t)=>(t=e!=null?uwe(cwe(e)):{},pwe(r||!e||!e.__esModule?lne(t,"default",{value:e,enumerable:!0}):t,e));var cne=T((exports,module)=>{p();if(exports.__platformBundles!==void 0)for(platformBundles=exports.__platformBundles.concat(),Reflect.deleteProperty(exports,"__platformBundles"),i=0;i<platformBundles.length;++i)console.log("PB start "+(i+1)+"/"+platformBundles.length),eval(platformBundles[i]),console.log("PB done  "+(i+1)+"/"+platformBundles.length);var platformBundles,i});var global,p=fwe(()=>{global=new Function("return this;")();cne()});var mne=T(()=>{p();function mwe(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=fne(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function gwe(e,r){return Swe(e)||hwe(e,r)||fne(e,r)||vwe()}function vwe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fne(e,r){if(e){if(typeof e=="string")return dne(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return dne(e,r)}}function dne(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function hwe(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n,a,o,u,s=[],l=!0,c=!1;try{if(o=(t=t.call(e)).next,r===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=o.call(t)).done)&&(s.push(n.value),s.length!==r);l=!0);}catch(d){c=!0,a=d}finally{try{if(!l&&t.return!=null&&(u=t.return(),Object(u)!==u))return}finally{if(c)throw a}}return s}}function Swe(e){if(Array.isArray(e))return e}var xE=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global;function pne(e){try{new e}catch(r){return!1}return!0}(typeof xE.Event!="function"||!pne(xE.Event))&&(xE.Event=function(){function e(r,t){this.bubbles=!!t&&!!t.bubbles,this.cancelable=!!t&&!!t.cancelable,this.composed=!!t&&!!t.composed,this.type=r}return e}());(typeof xE.EventTarget>"u"||!pne(xE.Event))&&(xE.EventTarget=function(){function e(){this.__listeners=new Map}return e.prototype=Object.create(Object.prototype),e.prototype.addEventListener=function(r,t,n){if(arguments.length<2)throw new TypeError("TypeError: Failed to execute 'addEventListener' on 'EventTarget': 2 arguments required, but only "+arguments.length+" present.");var a=this.__listeners,o=r.toString();a.has(o)||a.set(o,new Map);var u=a.get(o);u.has(t)||u.set(t,n)},e.prototype.removeEventListener=function(r,t,n){if(arguments.length<2)throw new TypeError("TypeError: Failed to execute 'addEventListener' on 'EventTarget': 2 arguments required, but only "+arguments.length+" present.");var a=this.__listeners,o=r.toString();if(a.has(o)){var u=a.get(o);u.has(t)&&u.delete(t)}},e.prototype.dispatchEvent=function(r){var t=this;if(!(r instanceof Event))throw new TypeError("Failed to execute 'dispatchEvent' on 'EventTarget': parameter 1 is not of type 'Event'.");var n=r.type,a=this.__listeners,o=a.get(n);if(o)for(var u=function(){try{typeof f=="function"?f.call(t,r):f&&typeof f.handleEvent=="function"&&f.handleEvent(r)}catch(h){setTimeout(function(){throw h})}m&&m.once&&o.delete(f)},s=mwe(o.entries()),l;!(l=s()).done;){var c=l.value,d=gwe(c,2),f=d[0],m=d[1];u()}return!0},e}())});var hne=T(()=>{p();function ywe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function gne(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bwe(n.key),n)}}function _we(e,r,t){return r&&gne(e.prototype,r),t&&gne(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function bwe(e){var r=Cwe(e,"string");return typeof r=="symbol"?r:String(r)}function Cwe(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Twe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&mk(e,r)}function Rwe(e){var r=vne();return function(){var n=gk(e),a;if(r){var o=gk(this).constructor;a=Reflect.construct(n,arguments,o)}else a=n.apply(this,arguments);return Ewe(this,a)}}function Ewe(e,r){if(r&&(typeof r=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pwe(e)}function Pwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OV(e){var r=typeof Map=="function"?new Map:void 0;return OV=function(n){if(n===null||!Awe(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r<"u"){if(r.has(n))return r.get(n);r.set(n,a)}function a(){return mw(n,arguments,gk(this).constructor)}return a.prototype=Object.create(n.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),mk(a,n)},OV(e)}function mw(e,r,t){return vne()?mw=Reflect.construct.bind():mw=function(a,o,u){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(a,s),c=new l;return u&&mk(c,u.prototype),c},mw.apply(null,arguments)}function vne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Awe(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch(r){return typeof e=="function"}}function mk(e,r){return mk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},mk(e,r)}function gk(e){return gk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gk(e)}globalThis.CustomEvent||(globalThis.CustomEvent=function(e){"use strict";Twe(t,e);var r=Rwe(t);function t(n,a){var o;return ywe(this,t),o=r.call(this,n,a),o.detail=void 0,o.detail=a==null?void 0:a.detail,o}return _we(t,[{key:"initCustomEvent",value:function(a,o,u,s){console.error("initCustomEvent is deprecated")}}]),t}(OV(Event)))});var dm=T((bLr,Sne)=>{"use strict";p();var kV=typeof document=="object"&&document.all;Sne.exports=typeof kV>"u"&&kV!==void 0?function(e){return typeof e=="function"||e===kV}:function(e){return typeof e=="function"}});var fm=T((TLr,yne)=>{"use strict";p();yne.exports=function(e){try{return!!e()}catch(r){return!0}}});var rg=T((ELr,_ne)=>{"use strict";p();var Fwe=fm();_ne.exports=!Fwe(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})});var bc=T((MV,bne)=>{"use strict";p();var vk=function(r){return r&&r.Math===Math&&r};bne.exports=vk(typeof globalThis=="object"&&globalThis)||vk(typeof window=="object"&&window)||vk(typeof self=="object"&&self)||vk(typeof global=="object"&&global)||vk(typeof MV=="object"&&MV)||function(){return this}()||Function("return this")()});var x_=T((FLr,Cne)=>{"use strict";p();var Nwe=dm();Cne.exports=function(e){return typeof e=="object"?e!==null:Nwe(e)}});var IV=T((OLr,Rne)=>{"use strict";p();var Owe=bc(),Tne=x_(),xV=Owe.document,kwe=Tne(xV)&&Tne(xV.createElement);Rne.exports=function(e){return kwe?xV.createElement(e):{}}});var wV=T((MLr,Ene)=>{"use strict";p();var Mwe=rg(),xwe=fm(),Iwe=IV();Ene.exports=!Mwe&&!xwe(function(){return Object.defineProperty(Iwe("div"),"a",{get:function(){return 7}}).a!==7})});var DV=T((ILr,Pne)=>{"use strict";p();var wwe=rg(),Dwe=fm();Pne.exports=wwe&&Dwe(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})});var I_=T((DLr,Ane)=>{"use strict";p();var Lwe=x_(),qwe=String,Gwe=TypeError;Ane.exports=function(e){if(Lwe(e))return e;throw new Gwe(qwe(e)+" is not an object")}});var LV=T((qLr,Fne)=>{"use strict";p();var Bwe=fm();Fne.exports=!Bwe(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")})});var IE=T((BLr,Nne)=>{"use strict";p();var Uwe=LV(),gw=Function.prototype.call;Nne.exports=Uwe?gw.bind(gw):function(){return gw.apply(gw,arguments)}});var QS=T((KLr,One)=>{"use strict";p();var qV=bc(),Kwe=dm(),Vwe=function(r){return Kwe(r)?r:void 0};One.exports=function(e,r){return arguments.length<2?Vwe(qV[e]):qV[e]&&qV[e][r]}});var Sp=T((jLr,xne)=>{"use strict";p();var kne=LV(),Mne=Function.prototype,GV=Mne.call,jwe=kne&&Mne.bind.bind(GV,GV);xne.exports=kne?jwe:function(e){return function(){return GV.apply(e,arguments)}}});var BV=T((HLr,Ine)=>{"use strict";p();var Wwe=Sp();Ine.exports=Wwe({}.isPrototypeOf)});var Dne=T((QLr,wne)=>{"use strict";p();wne.exports=typeof navigator<"u"&&String(navigator.userAgent)||""});var Vne=T((YLr,Kne)=>{"use strict";p();var Une=bc(),UV=Dne(),Lne=Une.process,qne=Une.Deno,Gne=Lne&&Lne.versions||qne&&qne.version,Bne=Gne&&Gne.v8,Bv,vw;Bne&&(Bv=Bne.split("."),vw=Bv[0]>0&&Bv[0]<4?1:+(Bv[0]+Bv[1]));!vw&&UV&&(Bv=UV.match(/Edge\/(\d+)/),(!Bv||Bv[1]>=74)&&(Bv=UV.match(/Chrome\/(\d+)/),Bv&&(vw=+Bv[1])));Kne.exports=vw});var KV=T((ZLr,Wne)=>{"use strict";p();var jne=Vne(),Hwe=fm(),zwe=bc(),Qwe=zwe.String;Wne.exports=!!Object.getOwnPropertySymbols&&!Hwe(function(){var e=Symbol("symbol detection");return!Qwe(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&jne&&jne<41})});var VV=T((eqr,Hne)=>{"use strict";p();var Xwe=KV();Hne.exports=Xwe&&!Symbol.sham&&typeof Symbol.iterator=="symbol"});var jV=T((tqr,zne)=>{"use strict";p();var Ywe=QS(),Jwe=dm(),Zwe=BV(),$we=VV(),eDe=Object;zne.exports=$we?function(e){return typeof e=="symbol"}:function(e){var r=Ywe("Symbol");return Jwe(r)&&Zwe(r.prototype,eDe(e))}});var Xne=T((aqr,Qne)=>{"use strict";p();var rDe=String;Qne.exports=function(e){try{return rDe(e)}catch(r){return"Object"}}});var WV=T((oqr,Yne)=>{"use strict";p();var tDe=dm(),nDe=Xne(),aDe=TypeError;Yne.exports=function(e){if(tDe(e))return e;throw new aDe(nDe(e)+" is not a function")}});var HV=T((sqr,Jne)=>{"use strict";p();Jne.exports=function(e){return e==null}});var $ne=T((cqr,Zne)=>{"use strict";p();var iDe=WV(),oDe=HV();Zne.exports=function(e,r){var t=e[r];return oDe(t)?void 0:iDe(t)}});var rae=T((fqr,eae)=>{"use strict";p();var zV=IE(),QV=dm(),XV=x_(),uDe=TypeError;eae.exports=function(e,r){var t,n;if(r==="string"&&QV(t=e.toString)&&!XV(n=zV(t,e))||QV(t=e.valueOf)&&!XV(n=zV(t,e))||r!=="string"&&QV(t=e.toString)&&!XV(n=zV(t,e)))return n;throw new uDe("Can't convert object to primitive value")}});var hw=T((mqr,tae)=>{"use strict";p();tae.exports=!1});var Sw=T((vqr,aae)=>{"use strict";p();var nae=bc(),sDe=Object.defineProperty;aae.exports=function(e,r){try{sDe(nae,e,{value:r,configurable:!0,writable:!0})}catch(t){nae[e]=r}return r}});var yw=T((Sqr,oae)=>{"use strict";p();var lDe=bc(),cDe=Sw(),iae="__core-js_shared__",dDe=lDe[iae]||cDe(iae,{});oae.exports=dDe});var YV=T((_qr,sae)=>{"use strict";p();var fDe=hw(),uae=yw();(sae.exports=function(e,r){return uae[e]||(uae[e]=r!==void 0?r:{})})("versions",[]).push({version:"3.35.0",mode:fDe?"pure":"global",copyright:"\xA9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.0/LICENSE",source:"https://github.com/zloirock/core-js"})});var JV=T((Cqr,lae)=>{"use strict";p();var pDe=HV(),mDe=TypeError;lae.exports=function(e){if(pDe(e))throw new mDe("Can't call method on "+e);return e}});var dae=T((Rqr,cae)=>{"use strict";p();var gDe=JV(),vDe=Object;cae.exports=function(e){return vDe(gDe(e))}});var Uv=T((Pqr,fae)=>{"use strict";p();var hDe=Sp(),SDe=dae(),yDe=hDe({}.hasOwnProperty);fae.exports=Object.hasOwn||function(r,t){return yDe(SDe(r),t)}});var ZV=T((Fqr,pae)=>{"use strict";p();var _De=Sp(),bDe=0,CDe=Math.random(),TDe=_De(1 .toString);pae.exports=function(e){return"Symbol("+(e===void 0?"":e)+")_"+TDe(++bDe+CDe,36)}});var hk=T((Oqr,gae)=>{"use strict";p();var RDe=bc(),EDe=YV(),mae=Uv(),PDe=ZV(),ADe=KV(),FDe=VV(),wE=RDe.Symbol,$V=EDe("wks"),NDe=FDe?wE.for||wE:wE&&wE.withoutSetter||PDe;gae.exports=function(e){return mae($V,e)||($V[e]=ADe&&mae(wE,e)?wE[e]:NDe("Symbol."+e)),$V[e]}});var yae=T((Mqr,Sae)=>{"use strict";p();var ODe=IE(),vae=x_(),hae=jV(),kDe=$ne(),MDe=rae(),xDe=hk(),IDe=TypeError,wDe=xDe("toPrimitive");Sae.exports=function(e,r){if(!vae(e)||hae(e))return e;var t=kDe(e,wDe),n;if(t){if(r===void 0&&(r="default"),n=ODe(t,e,r),!vae(n)||hae(n))return n;throw new IDe("Can't convert object to primitive value")}return r===void 0&&(r="number"),MDe(e,r)}});var ej=T((Iqr,_ae)=>{"use strict";p();var DDe=yae(),LDe=jV();_ae.exports=function(e){var r=DDe(e,"string");return LDe(r)?r:r+""}});var XS=T(Cae=>{"use strict";p();var qDe=rg(),GDe=wV(),BDe=DV(),_w=I_(),bae=ej(),UDe=TypeError,rj=Object.defineProperty,KDe=Object.getOwnPropertyDescriptor,tj="enumerable",nj="configurable",aj="writable";Cae.f=qDe?BDe?function(r,t,n){if(_w(r),t=bae(t),_w(n),typeof r=="function"&&t==="prototype"&&"value"in n&&aj in n&&!n[aj]){var a=KDe(r,t);a&&a[aj]&&(r[t]=n.value,n={configurable:nj in n?n[nj]:a[nj],enumerable:tj in n?n[tj]:a[tj],writable:!1})}return rj(r,t,n)}:rj:function(r,t,n){if(_w(r),t=bae(t),_w(n),GDe)try{return rj(r,t,n)}catch(a){}if("get"in n||"set"in n)throw new UDe("Accessors not supported");return"value"in n&&(r[t]=n.value),r}});var Eae=T((qqr,Rae)=>{"use strict";p();var ij=rg(),VDe=Uv(),Tae=Function.prototype,jDe=ij&&Object.getOwnPropertyDescriptor,oj=VDe(Tae,"name"),WDe=oj&&function(){}.name==="something",HDe=oj&&(!ij||ij&&jDe(Tae,"name").configurable);Rae.exports={EXISTS:oj,PROPER:WDe,CONFIGURABLE:HDe}});var Aae=T((Bqr,Pae)=>{"use strict";p();var zDe=Sp(),QDe=dm(),uj=yw(),XDe=zDe(Function.toString);QDe(uj.inspectSource)||(uj.inspectSource=function(e){return XDe(e)});Pae.exports=uj.inspectSource});var Oae=T((Kqr,Nae)=>{"use strict";p();var YDe=bc(),JDe=dm(),Fae=YDe.WeakMap;Nae.exports=JDe(Fae)&&/native code/.test(String(Fae))});var Sk=T((jqr,kae)=>{"use strict";p();kae.exports=function(e,r){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:r}}});var sj=T((Hqr,Mae)=>{"use strict";p();var ZDe=rg(),$De=XS(),eLe=Sk();Mae.exports=ZDe?function(e,r,t){return $De.f(e,r,eLe(1,t))}:function(e,r,t){return e[r]=t,e}});var lj=T((Qqr,Iae)=>{"use strict";p();var rLe=YV(),tLe=ZV(),xae=rLe("keys");Iae.exports=function(e){return xae[e]||(xae[e]=tLe(e))}});var bw=T((Yqr,wae)=>{"use strict";p();wae.exports={}});var pj=T((Zqr,qae)=>{"use strict";p();var nLe=Oae(),Lae=bc(),aLe=x_(),iLe=sj(),cj=Uv(),dj=yw(),oLe=lj(),uLe=bw(),Dae="Object already initialized",fj=Lae.TypeError,sLe=Lae.WeakMap,Cw,yk,Tw,lLe=function(r){return Tw(r)?yk(r):Cw(r,{})},cLe=function(r){return function(t){var n;if(!aLe(t)||(n=yk(t)).type!==r)throw new fj("Incompatible receiver, "+r+" required");return n}};nLe||dj.state?(Kv=dj.state||(dj.state=new sLe),Kv.get=Kv.get,Kv.has=Kv.has,Kv.set=Kv.set,Cw=function(r,t){if(Kv.has(r))throw new fj(Dae);return t.facade=r,Kv.set(r,t),t},yk=function(r){return Kv.get(r)||{}},Tw=function(r){return Kv.has(r)}):(O1=oLe("state"),uLe[O1]=!0,Cw=function(r,t){if(cj(r,O1))throw new fj(Dae);return t.facade=r,iLe(r,O1,t),t},yk=function(r){return cj(r,O1)?r[O1]:{}},Tw=function(r){return cj(r,O1)});var Kv,O1;qae.exports={set:Cw,get:yk,has:Tw,enforce:lLe,getterFor:cLe}});var vj=T((eGr,Uae)=>{"use strict";p();var gj=Sp(),dLe=fm(),fLe=dm(),Rw=Uv(),mj=rg(),pLe=Eae().CONFIGURABLE,mLe=Aae(),Bae=pj(),gLe=Bae.enforce,vLe=Bae.get,Gae=String,Ew=Object.defineProperty,hLe=gj("".slice),SLe=gj("".replace),yLe=gj([].join),_Le=mj&&!dLe(function(){return Ew(function(){},"length",{value:8}).length!==8}),bLe=String(String).split("String"),CLe=Uae.exports=function(e,r,t){hLe(Gae(r),0,7)==="Symbol("&&(r="["+SLe(Gae(r),/^Symbol\(([^)]*)\)/,"$1")+"]"),t&&t.getter&&(r="get "+r),t&&t.setter&&(r="set "+r),(!Rw(e,"name")||pLe&&e.name!==r)&&(mj?Ew(e,"name",{value:r,configurable:!0}):e.name=r),_Le&&t&&Rw(t,"arity")&&e.length!==t.arity&&Ew(e,"length",{value:t.arity});try{t&&Rw(t,"constructor")&&t.constructor?mj&&Ew(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(a){}var n=gLe(e);return Rw(n,"source")||(n.source=yLe(bLe,typeof r=="string"?r:"")),e};Function.prototype.toString=CLe(function(){return fLe(this)&&vLe(this).source||mLe(this)},"toString")});var _k=T((tGr,Kae)=>{"use strict";p();var TLe=dm(),RLe=XS(),ELe=vj(),PLe=Sw();Kae.exports=function(e,r,t,n){n||(n={});var a=n.enumerable,o=n.name!==void 0?n.name:r;if(TLe(t)&&ELe(t,o,n),n.global)a?e[r]=t:PLe(r,t);else{try{n.unsafe?e[r]&&(a=!0):delete e[r]}catch(u){}a?e[r]=t:RLe.f(e,r,{value:t,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e}});var Pw=T((aGr,jae)=>{"use strict";p();var ALe=hk(),FLe=ALe("toStringTag"),Vae={};Vae[FLe]="z";jae.exports=String(Vae)==="[object z]"});var Aw=T((oGr,Hae)=>{"use strict";p();var Wae=Sp(),NLe=Wae({}.toString),OLe=Wae("".slice);Hae.exports=function(e){return OLe(NLe(e),8,-1)}});var hj=T((sGr,zae)=>{"use strict";p();var kLe=Pw(),MLe=dm(),Fw=Aw(),xLe=hk(),ILe=xLe("toStringTag"),wLe=Object,DLe=Fw(function(){return arguments}())==="Arguments",LLe=function(r,t){try{return r[t]}catch(n){}};zae.exports=kLe?Fw:function(e){var r,t,n;return e===void 0?"Undefined":e===null?"Null":typeof(t=LLe(r=wLe(e),ILe))=="string"?t:DLe?Fw(r):(n=Fw(r))==="Object"&&MLe(r.callee)?"Arguments":n}});var Nw=T((cGr,Qae)=>{"use strict";p();var qLe=hj(),GLe=String;Qae.exports=function(e){if(qLe(e)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return GLe(e)}});var Ow=T((fGr,Xae)=>{"use strict";p();var BLe=Nw();Xae.exports=function(e,r){return e===void 0?arguments.length<2?"":r:BLe(e)}});var Sj=T((mGr,Jae)=>{"use strict";p();var ULe=rg(),KLe=fm(),VLe=I_(),Yae=Ow(),kw=Error.prototype.toString,jLe=KLe(function(){if(ULe){var e=Object.create(Object.defineProperty({},"name",{get:function(){return this===e}}));if(kw.call(e)!=="true")return!0}return kw.call({message:1,name:2})!=="2: 1"||kw.call({})!=="Error"});Jae.exports=jLe?function(){var r=VLe(this),t=Yae(r.name,"Error"),n=Yae(r.message);return t?n?t+": "+n:t:n}:kw});var yj=T(()=>{"use strict";p();var WLe=_k(),Zae=Sj(),$ae=Error.prototype;$ae.toString!==Zae&&WLe($ae,"toString",Zae)});var rie=T((yGr,eie)=>{"use strict";p();var HLe=Pw(),zLe=hj();eie.exports=HLe?{}.toString:function(){return"[object "+zLe(this)+"]"}});var _j=T(()=>{"use strict";p();var QLe=Pw(),XLe=_k(),YLe=rie();QLe||XLe(Object.prototype,"toString",YLe,{unsafe:!0})});var iie=T(aie=>{"use strict";p();var tie={}.propertyIsEnumerable,nie=Object.getOwnPropertyDescriptor,JLe=nie&&!tie.call({1:2},1);aie.f=JLe?function(r){var t=nie(this,r);return!!t&&t.enumerable}:tie});var uie=T((PGr,oie)=>{"use strict";p();var ZLe=Sp(),$Le=fm(),eqe=Aw(),bj=Object,rqe=ZLe("".split);oie.exports=$Le(function(){return!bj("z").propertyIsEnumerable(0)})?function(e){return eqe(e)==="String"?rqe(e,""):bj(e)}:bj});var bk=T((FGr,sie)=>{"use strict";p();var tqe=uie(),nqe=JV();sie.exports=function(e){return tqe(nqe(e))}});var Cj=T(cie=>{"use strict";p();var aqe=rg(),iqe=IE(),oqe=iie(),uqe=Sk(),sqe=bk(),lqe=ej(),cqe=Uv(),dqe=wV(),lie=Object.getOwnPropertyDescriptor;cie.f=aqe?lie:function(r,t){if(r=sqe(r),t=lqe(t),dqe)try{return lie(r,t)}catch(n){}if(cqe(r,t))return uqe(!iqe(oqe.f,r,t),r[t])}});var fie=T((MGr,die)=>{"use strict";p();var fqe=Math.ceil,pqe=Math.floor;die.exports=Math.trunc||function(r){var t=+r;return(t>0?pqe:fqe)(t)}});var Tj=T((IGr,pie)=>{"use strict";p();var mqe=fie();pie.exports=function(e){var r=+e;return r!==r||r===0?0:mqe(r)}});var gie=T((DGr,mie)=>{"use strict";p();var gqe=Tj(),vqe=Math.max,hqe=Math.min;mie.exports=function(e,r){var t=gqe(e);return t<0?vqe(t+r,0):hqe(t,r)}});var hie=T((qGr,vie)=>{"use strict";p();var Sqe=Tj(),yqe=Math.min;vie.exports=function(e){return e>0?yqe(Sqe(e),9007199254740991):0}});var yie=T((BGr,Sie)=>{"use strict";p();var _qe=hie();Sie.exports=function(e){return _qe(e.length)}});var Cie=T((KGr,bie)=>{"use strict";p();var bqe=bk(),Cqe=gie(),Tqe=yie(),_ie=function(r){return function(t,n,a){var o=bqe(t),u=Tqe(o),s=Cqe(a,u),l;if(r&&n!==n){for(;u>s;)if(l=o[s++],l!==l)return!0}else for(;u>s;s++)if((r||s in o)&&o[s]===n)return r||s||0;return!r&&-1}};bie.exports={includes:_ie(!0),indexOf:_ie(!1)}});var Ej=T((jGr,Rie)=>{"use strict";p();var Rqe=Sp(),Rj=Uv(),Eqe=bk(),Pqe=Cie().indexOf,Aqe=bw(),Tie=Rqe([].push);Rie.exports=function(e,r){var t=Eqe(e),n=0,a=[],o;for(o in t)!Rj(Aqe,o)&&Rj(t,o)&&Tie(a,o);for(;r.length>n;)Rj(t,o=r[n++])&&(~Pqe(a,o)||Tie(a,o));return a}});var Mw=T((HGr,Eie)=>{"use strict";p();Eie.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]});var Aie=T(Pie=>{"use strict";p();var Fqe=Ej(),Nqe=Mw(),Oqe=Nqe.concat("length","prototype");Pie.f=Object.getOwnPropertyNames||function(r){return Fqe(r,Oqe)}});var Nie=T(Fie=>{"use strict";p();Fie.f=Object.getOwnPropertySymbols});var kie=T((ZGr,Oie)=>{"use strict";p();var kqe=QS(),Mqe=Sp(),xqe=Aie(),Iqe=Nie(),wqe=I_(),Dqe=Mqe([].concat);Oie.exports=kqe("Reflect","ownKeys")||function(r){var t=xqe.f(wqe(r)),n=Iqe.f;return n?Dqe(t,n(r)):t}});var Iie=T((eBr,xie)=>{"use strict";p();var Mie=Uv(),Lqe=kie(),qqe=Cj(),Gqe=XS();xie.exports=function(e,r,t){for(var n=Lqe(r),a=Gqe.f,o=qqe.f,u=0;u<n.length;u++){var s=n[u];!Mie(e,s)&&!(t&&Mie(t,s))&&a(e,s,o(r,s))}}});var Die=T((tBr,wie)=>{"use strict";p();var Bqe=fm(),Uqe=dm(),Kqe=/#|\.prototype\./,Ck=function(r,t){var n=jqe[Vqe(r)];return n===Hqe?!0:n===Wqe?!1:Uqe(t)?Bqe(t):!!t},Vqe=Ck.normalize=function(e){return String(e).replace(Kqe,".").toLowerCase()},jqe=Ck.data={},Wqe=Ck.NATIVE="N",Hqe=Ck.POLYFILL="P";wie.exports=Ck});var DE=T((aBr,Lie)=>{"use strict";p();var Pj=bc(),zqe=Cj().f,Qqe=sj(),Xqe=_k(),Yqe=Sw(),Jqe=Iie(),Zqe=Die();Lie.exports=function(e,r){var t=e.target,n=e.global,a=e.stat,o,u,s,l,c,d;if(n?u=Pj:a?u=Pj[t]||Yqe(t,{}):u=(Pj[t]||{}).prototype,u)for(s in r){if(c=r[s],e.dontCallGetSet?(d=zqe(u,s),l=d&&d.value):l=u[s],o=Zqe(n?s:t+(a?".":"#")+s,e.forced),!o&&l!==void 0){if(typeof c==typeof l)continue;Jqe(c,l)}(e.sham||l&&l.sham)&&Qqe(c,"sham",!0),Xqe(u,s,c,e)}}});var Aj=T((oBr,qie)=>{"use strict";p();var $qe=TypeError;qie.exports=function(e,r){if(e<r)throw new $qe("Not enough arguments");return e}});var Fj=T((sBr,Kie)=>{"use strict";p();var Gie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Uie=function(r){for(var t={},n=0;n<64;n++)t[r.charAt(n)]=n;return t};Kie.exports={i2c:Gie,c2i:Uie(Gie),i2cUrl:Bie,c2iUrl:Uie(Bie)}});var Xie=T(()=>{"use strict";p();var eGe=DE(),rGe=bc(),Wie=QS(),Nj=Sp(),tGe=IE(),xw=fm(),nGe=Nw(),aGe=Aj(),Vie=Fj().c2i,Hie=/[^\d+/a-z]/i,iGe=/[\t\n\f\r ]+/g,oGe=/[=]{1,2}$/,k1=Wie("atob"),uGe=String.fromCharCode,sGe=Nj("".charAt),jie=Nj("".replace),lGe=Nj(Hie.exec),LE=!!k1&&!xw(function(){return k1("aGk=")!=="hi"}),zie=LE&&xw(function(){return k1(" ")!==""}),Qie=LE&&!xw(function(){k1("a")}),cGe=LE&&!xw(function(){k1()}),dGe=LE&&k1.length!==1,fGe=!LE||zie||Qie||cGe||dGe;eGe({global:!0,bind:!0,enumerable:!0,forced:fGe},{atob:function(r){if(aGe(arguments.length,1),LE&&!zie&&!Qie)return tGe(k1,rGe,r);var t=jie(nGe(r),iGe,""),n="",a=0,o=0,u,s,l;if(t.length%4===0&&(t=jie(t,oGe,"")),u=t.length,u%4===1||lGe(Hie,t))throw new(Wie("DOMException"))("The string is not correctly encoded","InvalidCharacterError");for(;a<u;)s=sGe(t,a++),l=o%4?l*64+Vie[s]:Vie[s],o++%4&&(n+=uGe(255&l>>(-2*o&6)));return n}})});var Jie=T((pBr,Yie)=>{"use strict";p();var pGe=bc(),mGe=Aw();Yie.exports=mGe(pGe.process)==="process"});var $ie=T((gBr,Zie)=>{"use strict";p();var gGe=Jie();Zie.exports=function(e){try{if(gGe)return Function('return require("'+e+'")')()}catch(r){}}});var roe=T((hBr,eoe)=>{"use strict";p();var vGe=Ej(),hGe=Mw();eoe.exports=Object.keys||function(r){return vGe(r,hGe)}});var noe=T(toe=>{"use strict";p();var SGe=rg(),yGe=DV(),_Ge=XS(),bGe=I_(),CGe=bk(),TGe=roe();toe.f=SGe&&!yGe?Object.defineProperties:function(r,t){bGe(r);for(var n=CGe(t),a=TGe(t),o=a.length,u=0,s;o>u;)_Ge.f(r,s=a[u++],n[s]);return r}});var ioe=T((bBr,aoe)=>{"use strict";p();var RGe=QS();aoe.exports=RGe("document","documentElement")});var doe=T((TBr,coe)=>{"use strict";p();var EGe=I_(),PGe=noe(),ooe=Mw(),AGe=bw(),FGe=ioe(),NGe=IV(),OGe=lj(),kGe=">",MGe="<",kj="prototype",xGe="script",soe=OGe("IE_PROTO"),Oj=function(){},loe=function(r){return"<script>"+r+MGe+"/"+xGe+kGe},uoe=function(r){r.write(loe("")),r.close();var t=r.parentWindow.Object;return r=null,t},IGe=function(){var r=NGe("iframe"),t="javascript:",n;return r.style.display="none",FGe.appendChild(r),r.src=String(t),n=r.contentWindow.document,n.open(),n.write(loe("document.F=Object")),n.close(),n.F},Iw,ww=function(){try{Iw=new ActiveXObject("htmlfile")}catch(t){}ww=typeof document<"u"?document.domain&&Iw?uoe(Iw):IGe():uoe(Iw);for(var r=ooe.length;r--;)delete ww[kj][ooe[r]];return ww()};AGe[soe]=!0;coe.exports=Object.create||function(r,t){var n;return r!==null?(Oj[kj]=EGe(r),n=new Oj,Oj[kj]=null,n[soe]=r):n=ww(),t===void 0?n:PGe.f(n,t)}});var moe=T((EBr,poe)=>{"use strict";p();var foe=vj(),wGe=XS();poe.exports=function(e,r,t){return t.get&&foe(t.get,r,{getter:!0}),t.set&&foe(t.set,r,{setter:!0}),wGe.f(e,r,t)}});var Mj=T((ABr,goe)=>{"use strict";p();var DGe=BV(),LGe=TypeError;goe.exports=function(e,r){if(DGe(r,e))return e;throw new LGe("Incorrect invocation")}});var xj=T((NBr,voe)=>{"use strict";p();voe.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}});var Ij=T((kBr,yoe)=>{"use strict";p();var qGe=Sp(),hoe=Error,GGe=qGe("".replace),BGe=function(e){return String(new hoe(e).stack)}("zxcasd"),Soe=/\n\s*at [^:]*:[^\n]*/,UGe=Soe.test(BGe);yoe.exports=function(e,r){if(UGe&&typeof e=="string"&&!hoe.prepareStackTrace)for(;r--;)e=GGe(e,Soe,"");return e}});var jj=T(()=>{"use strict";p();var KGe=DE(),VGe=$ie(),qw=QS(),Bj=fm(),jGe=doe(),Uj=Sk(),Gw=XS().f,WGe=_k(),Dw=moe(),Lw=Uv(),HGe=Mj(),zGe=I_(),Coe=Sj(),_oe=Ow(),qE=xj(),QGe=Ij(),Toe=pj(),Kj=rg(),Roe=hw(),GE="DOMException",Gj="DATA_CLONE_ERR",Uw=qw("Error"),YS=qw(GE)||function(){try{var e=qw("MessageChannel")||VGe("worker_threads").MessageChannel;new e().port1.postMessage(new WeakMap)}catch(r){if(r.name===Gj&&r.code===25)return r.constructor}}(),XGe=YS&&YS.prototype,Eoe=Uw.prototype,YGe=Toe.set,JGe=Toe.getterFor(GE),ZGe="stack"in new Uw(GE),Poe=function(r){return Lw(qE,r)&&qE[r].m?qE[r].c:0},Vj=function(){HGe(this,Rk);var r=arguments.length,t=_oe(r<1?void 0:arguments[0]),n=_oe(r<2?void 0:arguments[1],"Error"),a=Poe(n);if(YGe(this,{type:GE,name:n,message:t,code:a}),Kj||(this.name=n,this.message=t,this.code=a),ZGe){var o=new Uw(t);o.name=GE,Gw(this,"stack",Uj(1,QGe(o.stack,1)))}},Rk=Vj.prototype=jGe(Eoe),Aoe=function(r){return{enumerable:!0,configurable:!0,get:r}},wj=function(r){return Aoe(function(){return JGe(this)[r]})};Kj&&(Dw(Rk,"code",wj("code")),Dw(Rk,"message",wj("message")),Dw(Rk,"name",wj("name")));Gw(Rk,"constructor",Uj(1,Vj));var Kw=Bj(function(){return!(new YS instanceof Uw)}),Foe=Kw||Bj(function(){return Eoe.toString!==Coe||String(new YS(1,2))!=="2: 1"}),Noe=Kw||Bj(function(){return new YS(1,"DataCloneError").code!==25}),$Ge=Kw||YS[Gj]!==25||XGe[Gj]!==25,boe=Roe?Foe||Noe||$Ge:Kw;KGe({global:!0,constructor:!0,forced:boe},{DOMException:boe?Vj:YS});var Ek=qw(GE),Bw=Ek.prototype;Foe&&(Roe||YS===Ek)&&WGe(Bw,"toString",Coe);Noe&&Kj&&YS===Ek&&Dw(Bw,"code",Aoe(function(){return Poe(zGe(this).name)}));for(Dj in qE)Lw(qE,Dj)&&(Lj=qE[Dj],Tk=Lj.s,qj=Uj(6,Lj.c),Lw(Ek,Tk)||Gw(Ek,Tk,qj),Lw(Bw,Tk)||Gw(Bw,Tk,qj));var Lj,Tk,qj,Dj});var koe=T((DBr,Ooe)=>{"use strict";p();var eBe=Sp(),rBe=WV();Ooe.exports=function(e,r,t){try{return eBe(rBe(Object.getOwnPropertyDescriptor(e,r)[t]))}catch(n){}}});var xoe=T((qBr,Moe)=>{"use strict";p();var tBe=x_();Moe.exports=function(e){return tBe(e)||e===null}});var woe=T((BBr,Ioe)=>{"use strict";p();var nBe=xoe(),aBe=String,iBe=TypeError;Ioe.exports=function(e){if(nBe(e))return e;throw new iBe("Can't set "+aBe(e)+" as a prototype")}});var Loe=T((KBr,Doe)=>{"use strict";p();var oBe=koe(),uBe=I_(),sBe=woe();Doe.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,r={},t;try{t=oBe(Object.prototype,"__proto__","set"),t(r,[]),e=r instanceof Array}catch(n){}return function(a,o){return uBe(a),sBe(o),e?t(a,o):a.__proto__=o,a}}():void 0)});var Boe=T((jBr,Goe)=>{"use strict";p();var lBe=dm(),cBe=x_(),qoe=Loe();Goe.exports=function(e,r,t){var n,a;return qoe&&lBe(n=r.constructor)&&n!==t&&cBe(a=n.prototype)&&a!==t.prototype&&qoe(e,a),e}});var eW=T(()=>{"use strict";p();var dBe=DE(),fBe=bc(),Zj=QS(),Yj=Sk(),Jj=XS().f,Uoe=Uv(),pBe=Mj(),mBe=Boe(),Koe=Ow(),Wj=xj(),gBe=Ij(),vBe=rg(),Woe=hw(),Ak="DOMException",Hoe=Zj("Error"),Fk=Zj(Ak),$j=function(){pBe(this,hBe);var r=arguments.length,t=Koe(r<1?void 0:arguments[0]),n=Koe(r<2?void 0:arguments[1],"Error"),a=new Fk(t,n),o=new Hoe(t);return o.name=Ak,Jj(a,"stack",Yj(1,gBe(o.stack,1))),mBe(a,this,$j),a},hBe=$j.prototype=Fk.prototype,SBe="stack"in new Hoe(Ak),yBe="stack"in new Fk(1,2),Hj=Fk&&vBe&&Object.getOwnPropertyDescriptor(fBe,Ak),_Be=!!Hj&&!(Hj.writable&&Hj.configurable),Voe=SBe&&!_Be&&!yBe;dBe({global:!0,constructor:!0,forced:Woe||Voe},{DOMException:Voe?$j:Fk});var Pk=Zj(Ak),joe=Pk.prototype;if(joe.constructor!==Pk){Woe||Jj(joe,"constructor",Yj(1,Pk));for(zj in Wj)Uoe(Wj,zj)&&(Qj=Wj[zj],Xj=Qj.s,Uoe(Pk,Xj)||Jj(Pk,Xj,Yj(6,Qj.c)))}var Qj,Xj,zj});var Xoe=T((XBr,Qoe)=>{"use strict";p();var bBe=XS().f,CBe=Uv(),TBe=hk(),zoe=TBe("toStringTag");Qoe.exports=function(e,r,t){e&&!t&&(e=e.prototype),e&&!CBe(e,zoe)&&bBe(e,zoe,{configurable:!0,value:r})}});var rW=T(()=>{"use strict";p();var RBe=QS(),EBe=Xoe(),Yoe="DOMException";EBe(RBe(Yoe),Yoe)});var tW=T((eUr,Joe)=>{"use strict";p();var PBe=bc();Joe.exports=PBe});var $oe=T((tUr,Zoe)=>{"use strict";p();yj();_j();Xie();jj();eW();rW();var ABe=tW();Zoe.exports=ABe.atob});var aue=T(()=>{"use strict";p();var FBe=DE(),NBe=bc(),tue=QS(),nue=Sp(),OBe=IE(),nW=fm(),eue=Nw(),kBe=Aj(),MBe=Fj().i2c,BE=tue("btoa"),rue=nue("".charAt),xBe=nue("".charCodeAt),Nk=!!BE&&!nW(function(){return BE("hi")!=="aGk="}),IBe=Nk&&!nW(function(){BE()}),wBe=Nk&&nW(function(){return BE(null)!=="bnVsbA=="}),DBe=Nk&&BE.length!==1;FBe({global:!0,bind:!0,enumerable:!0,forced:!Nk||IBe||wBe||DBe},{btoa:function(r){if(kBe(arguments.length,1),Nk)return OBe(BE,NBe,eue(r));for(var t=eue(r),n="",a=0,o=MBe,u,s;rue(t,a)||(o="=",a%1);){if(s=xBe(t,a+=.75),s>255)throw new(tue("DOMException"))("The string contains characters outside of the Latin1 range","InvalidCharacterError");u=u<<8|s,n+=rue(o,63&u>>8-a%1*8)}return n}})});var oue=T((uUr,iue)=>{"use strict";p();yj();_j();aue();jj();eW();rW();var LBe=tW();iue.exports=LBe.btoa});var uue=T(()=>{"use strict";p();var qBe=DE(),aW=bc();qBe({global:!0,forced:aW.globalThis!==aW},{globalThis:aW})});var lue=T((fUr,sue)=>{"use strict";p();uue();sue.exports=bc()});var due=T((mUr,cue)=>{"use strict";p();var GBe=lue();cue.exports=GBe});var pue=T(fue=>{p();Object.defineProperty(fue,"__esModule",{value:!0})});var gue=T(mue=>{p();Object.defineProperty(mue,"__esModule",{value:!0})});var hue=T(vue=>{p();Object.defineProperty(vue,"__esModule",{value:!0})});var fe=T(ai=>{p();Object.defineProperty(ai,"__esModule",{value:!0});ai.__assign=void 0;ai.__asyncDelegator=tUe;ai.__asyncGenerator=rUe;ai.__asyncValues=nUe;ai.__await=Ok;ai.__awaiter=XBe;ai.__classPrivateFieldGet=sUe;ai.__classPrivateFieldIn=cUe;ai.__classPrivateFieldSet=lUe;ai.__createBinding=void 0;ai.__decorate=KBe;ai.__esDecorate=jBe;ai.__exportStar=JBe;ai.__extends=BBe;ai.__generator=YBe;ai.__importDefault=uUe;ai.__importStar=oUe;ai.__makeTemplateObject=aUe;ai.__metadata=QBe;ai.__param=VBe;ai.__propKey=HBe;ai.__read=_ue;ai.__rest=UBe;ai.__runInitializers=WBe;ai.__setFunctionName=zBe;ai.__spread=ZBe;ai.__spreadArray=eUe;ai.__spreadArrays=$Be;ai.__values=oW;var iW=function(r,t){return iW=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])},iW(r,t)};function BBe(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");iW(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var Sue=ai.__assign=function(){return ai.__assign=Sue=Object.assign||function(t){for(var n,a=1,o=arguments.length;a<o;a++){n=arguments[a];for(var u in n)Object.prototype.hasOwnProperty.call(n,u)&&(t[u]=n[u])}return t},Sue.apply(this,arguments)};function UBe(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t}function KBe(e,r,t,n){var a=arguments.length,o=a<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,r,t,n);else for(var s=e.length-1;s>=0;s--)(u=e[s])&&(o=(a<3?u(o):a>3?u(r,t,o):u(r,t))||o);return a>3&&o&&Object.defineProperty(r,t,o),o}function VBe(e,r){return function(t,n){r(t,n,e)}}function jBe(e,r,t,n,a,o){function u(E){if(E!==void 0&&typeof E!="function")throw new TypeError("Function expected");return E}for(var s=n.kind,l=s==="getter"?"get":s==="setter"?"set":"value",c=!r&&e?n.static?e:e.prototype:null,d=r||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),f,m=!1,v=t.length-1;v>=0;v--){var h={};for(var y in n)h[y]=y==="access"?{}:n[y];for(var y in n.access)h.access[y]=n.access[y];h.addInitializer=function(E){if(m)throw new TypeError("Cannot add initializers after decoration has completed");o.push(u(E||null))};var _=(0,t[v])(s==="accessor"?{get:d.get,set:d.set}:d[l],h);if(s==="accessor"){if(_===void 0)continue;if(_===null||typeof _!="object")throw new TypeError("Object expected");(f=u(_.get))&&(d.get=f),(f=u(_.set))&&(d.set=f),(f=u(_.init))&&a.push(f)}else(f=u(_))&&(s==="field"?a.push(f):d[l]=f)}c&&Object.defineProperty(c,n.name,d),m=!0}function WBe(e,r,t){for(var n=arguments.length>2,a=0;a<r.length;a++)t=n?r[a].call(e,t):r[a].call(e);return n?t:void 0}function HBe(e){return typeof e=="symbol"?e:"".concat(e)}function zBe(e,r,t){return typeof r=="symbol"&&(r=r.description?"[".concat(r.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:t?"".concat(t," ",r):r})}function QBe(e,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,r)}function XBe(e,r,t,n){function a(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function s(d){try{c(n.next(d))}catch(f){u(f)}}function l(d){try{c(n.throw(d))}catch(f){u(f)}}function c(d){d.done?o(d.value):a(d.value).then(s,l)}c((n=n.apply(e,r||[])).next())})}function YBe(e,r){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(c){return function(d){return l([c,d])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,c[0]&&(t=0)),t;)try{if(n=1,a&&(o=c[0]&2?a.return:c[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,c[1])).done)return o;switch(a=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,a=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=r.call(e,t)}catch(d){c=[6,d],a=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var yue=ai.__createBinding=Object.create?function(e,r,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(r,t);(!a||("get"in a?!r.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,a)}:function(e,r,t,n){n===void 0&&(n=t),e[n]=r[t]};function JBe(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&yue(r,e,t)}function oW(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function _ue(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),a,o=[],u;try{for(;(r===void 0||r-- >0)&&!(a=n.next()).done;)o.push(a.value)}catch(s){u={error:s}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(u)throw u.error}}return o}function ZBe(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(_ue(arguments[r]));return e}function $Be(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;for(var n=Array(e),a=0,r=0;r<t;r++)for(var o=arguments[r],u=0,s=o.length;u<s;u++,a++)n[a]=o[u];return n}function eUe(e,r,t){if(t||arguments.length===2)for(var n=0,a=r.length,o;n<a;n++)(o||!(n in r))&&(o||(o=Array.prototype.slice.call(r,0,n)),o[n]=r[n]);return e.concat(o||Array.prototype.slice.call(r))}function Ok(e){return this instanceof Ok?(this.v=e,this):new Ok(e)}function rUe(e,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(e,r||[]),a,o=[];return a={},u("next"),u("throw"),u("return"),a[Symbol.asyncIterator]=function(){return this},a;function u(m){n[m]&&(a[m]=function(v){return new Promise(function(h,y){o.push([m,v,h,y])>1||s(m,v)})})}function s(m,v){try{l(n[m](v))}catch(h){f(o[0][3],h)}}function l(m){m.value instanceof Ok?Promise.resolve(m.value.v).then(c,d):f(o[0][2],m)}function c(m){s("next",m)}function d(m){s("throw",m)}function f(m,v){m(v),o.shift(),o.length&&s(o[0][0],o[0][1])}}function tUe(e){var r,t;return r={},n("next"),n("throw",function(a){throw a}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(a,o){r[a]=e[a]?function(u){return(t=!t)?{value:Ok(e[a](u)),done:!1}:o?o(u):u}:o}}function nUe(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e[Symbol.asyncIterator],t;return r?r.call(e):(e=typeof oW=="function"?oW(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=e[o]&&function(u){return new Promise(function(s,l){u=e[o](u),a(s,l,u.done,u.value)})}}function a(o,u,s,l){Promise.resolve(l).then(function(c){o({value:c,done:s})},u)}}function aUe(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e}var iUe=Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r};function oUe(e){if(e&&e.__esModule)return e;var r={};if(e!=null)for(var t in e)t!=="default"&&Object.prototype.hasOwnProperty.call(e,t)&&yue(r,e,t);return iUe(r,e),r}function uUe(e){return e&&e.__esModule?e:{default:e}}function sUe(e,r,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(e):n?n.value:r.get(e)}function lUe(e,r,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?e!==r||!a:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(e,t):a?a.value=t:r.set(e,t),t}function cUe(e,r){if(r===null||typeof r!="object"&&typeof r!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?r===e:e.has(r)}});var jw=T(Vw=>{p();Object.defineProperty(Vw,"__esModule",{value:!0});Vw.NoopLogger=void 0;var RUr=Vw.NoopLogger=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}()});var UE=T(Ww=>{p();Object.defineProperty(Ww,"__esModule",{value:!0});Ww.TraceLevel=void 0;var bue;(function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"})(bue||(Ww.TraceLevel=bue={}))});var uW=T(Hw=>{p();Object.defineProperty(Hw,"__esModule",{value:!0});Hw.LogCategory=void 0;var Cue;(function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles"})(Cue||(Hw.LogCategory=Cue={}))});var sW=T(zw=>{p();Object.defineProperty(zw,"__esModule",{value:!0});zw.ConsoleLogger=void 0;var kk=UE(),dUe=uW(),kUr=zw.ConsoleLogger=function(){function e(){this.correlationId=""}return e.tagIntToString=function(r){return r<=e.maxNumericTag?r.toString():r>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255):e.map.charAt(r>>24&63)+e.map.charAt(r>>18&63)+e.map.charAt(r>>12&63)+e.map.charAt(r>>6&63)+e.map.charAt(r&63)},e.prototype.getLogMessage=function(r,t,n){var a="tag_".concat(e.tagIntToString(r)," [").concat(dUe.LogCategory[t],"] ").concat(n);return this.correlationId&&this.correlationId!==""&&(a+="		".concat(this.correlationId)),a},e.prototype.sendTraceTag=function(r,t,n,a){var o=this.logMessage;switch(n){case kk.TraceLevel.Error:o=this.logError;break;case kk.TraceLevel.Warning:o=this.logWarning;break;case kk.TraceLevel.Info:o=this.logInfo;break;case kk.TraceLevel.Verbose:o=this.logVerbose;break;case kk.TraceLevel.Spam:default:o=this.logMessage;break}try{o(this.getLogMessage(r,t,a))}catch(s){var u=typeof navigator<"u"?navigator:void 0;if(u&&!/rv:11.0/i.test(u.userAgent))throw s}},e.prototype.shipAssertTag=function(r,t,n,a){console.assert(n,this.getLogMessage(r,t,a))},e.prototype.debugAssertTag=function(r,t,n,a){this.shipAssertTag(r,t,n,a)},e.prototype.setCorrelationId=function(r){this.correlationId=r},e.prototype.logMessage=function(r){"log"in console&&console.log(r)},e.prototype.logError=function(r){"error"in console&&console.error(r)},e.prototype.logWarning=function(r){"warn"in console&&console.warn(r)},e.prototype.logInfo=function(r){"info"in console&&console.info(r)},e.prototype.logVerbose=function(r){"debug"in console&&console.debug(r)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789",e}()});var lW=T(M1=>{p();Object.defineProperty(M1,"__esModule",{value:!0});M1.UlsLoggerWrapper=M1.ULS=void 0;M1.initializeLogger=gUe;var fUe=jw(),IUr=sW(),pUe=M1.UlsLoggerWrapper=function(){function e(){this.externalLogger=new fUe.NoopLogger}return e.prototype.setCorrelationId=function(r){this.externalLogger.setCorrelationId(r)},e.prototype.setLogger=function(r){this.externalLogger=r},e.prototype.sendTraceTag=function(r,t,n,a){this.externalLogger.sendTraceTag(r,t,n,a)},e.prototype.debugAssertTag=function(r,t,n,a){this.externalLogger.debugAssertTag(r,t,n,a)},e.prototype.shipAssertTag=function(r,t,n,a){this.externalLogger.shipAssertTag(r,t,n,a)},e}(),mUe=M1.ULS=new pUe;function gUe(e){if(!e)throw new Error("The 'logger' argument is missing");mUe.setLogger(e)}});var cW=T(Qw=>{p();Object.defineProperty(Qw,"__esModule",{value:!0});Qw.LogType=void 0;var Tue;(function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"})(Tue||(Qw.LogType=Tue={}))});var fW=T(dW=>{p();Object.defineProperty(dW,"__esModule",{value:!0});dW.uploadLogs=vUe;function vUe(e,r,t){if(r){var n=window.navigator;if(n&&n.sendBeacon)try{n.sendBeacon(r,e);return}catch(a){}hUe(e,r,t)}}function hUe(e,r,t){var n=new XMLHttpRequest;(n.readyState===XMLHttpRequest.UNSENT||n.readyState===XMLHttpRequest.DONE)&&(n.open("POST",r,t),n.send(e))}});var mW=T(pW=>{p();Object.defineProperty(pW,"__esModule",{value:!0});pW.formatForUpload=SUe;function SUe(e,r,t,n){var a=[],o=e.map(function(s){return _Ue(s,n,a)}),u=bUe(n,o,r,t,a);return JSON.stringify(u)}var yUe=1e3;function _Ue(e,r,t){var n={};if(n.G=e.tag,n.T=e.timestamp-r,n.M=e.message,n.C=e.category,e.correlationId){var a=t.findIndex(function(u){return u===e.correlationId});a<0&&(a=t.push(e.correlationId)-1),n.I=a}var o=e.type*yUe+e.level;return n.D=o,n}function bUe(e,r,t,n,a){var o={};return o.T=e,o.L=r,o.S=t,o.I=n,a&&a.length>0&&(o.W=a),o.V=1,o}});var Rue=T(Xw=>{p();Object.defineProperty(Xw,"__esModule",{value:!0});Xw.bUlsCache=void 0;var CUe=fW(),TUe=mW(),RUe=UE(),VUr=Xw.bUlsCache=function(){function e(r,t,n){var a=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){a.triggerUpload(!1,!1)},this.flush=function(){a.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout(function(){return a.triggerUpload(!0,!0)},0)},this.triggerUpload=function(u,s){if(window.clearTimeout(a.timeoutId),a.logCache.length>0){a.uploadId+=1;var l=(0,TUe.formatForUpload)(a.logCache,a.userSessionId,a.uploadId,a.timestampBase);(0,CUe.uploadLogs)(l,a.remoteUrlEndpoint,s),a.logCache=[],a.timestampBase=Date.now()}u&&(a.timeoutId=window.setTimeout(a.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=r;var o=t+"?usid="+r;n!==void 0&&n.forEach(function(u,s){o+="&"+s+"="+u}),this.remoteUrlEndpoint=o,window.setTimeout(function(){return a.triggerUpload(!0,!0)},0)}return e.prototype.handleTrace=function(r){r.message.length>e.messageMaxChars&&(r.message=r.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(r),(this.logCache.length>e.uploadTriggerSize||r.level===RUe.TraceLevel.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]",e}()});var Pue=T(KE=>{p();Object.defineProperty(KE,"__esModule",{value:!0});KE.RemoteUlsLogger=void 0;KE.getUlsLogger=AUe;KE.getUlsLoggerDeprecated=FUe;var EUe=cW(),Eue=Rue(),gW=UE(),PUe=KE.RemoteUlsLogger=function(){function e(r,t,n){this.correlationId="",this.cache=new Eue.bUlsCache(r,t,n)}return e.prototype.setCorrelationId=function(r){this.correlationId=r},e.prototype.sendTraceTag=function(r,t,n,a){Yw(this.cache,r,t,n,a,this.correlationId)},e.prototype.debugAssertTag=function(r,t,n,a){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},e.prototype.shipAssertTag=function(r,t,n,a){n&&Yw(this.cache,r,t,gW.TraceLevel.Error,a,this.correlationId)},e.prototype.flush=function(){this.cache.flush()},e.prototype.flushOnClose=function(){this.cache.flushOnClose},e}();function AUe(e,r){return new PUe(e,r)}function FUe(e,r){var t=new Eue.bUlsCache(e,r);return{sendTraceTag:function(a,o,u,s){return Yw(t,a,o,u,s,"")},shipAssertTag:function(a,o,u,s){u&&Yw(t,a,o,gW.TraceLevel.Error,s,"")},debugAssertTag:function(){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}}}function Yw(e,r,t,n,a,o){var u=gW.TraceLevel.Info;if(!(n>u)){var s={timestamp:Date.now(),category:t,tag:r,level:n,type:EUe.LogType.Trace,message:a,correlationId:o};e.handleTrace(s)}}});var Fue=T(Aue=>{p();Object.defineProperty(Aue,"__esModule",{value:!0})});var Nue=T(Jw=>{p();Object.defineProperty(Jw,"__esModule",{value:!0});Jw.UnitTestLogger=void 0;var NUe=fe(),OUe=jw(),YUr=Jw.UnitTestLogger=function(e){(0,NUe.__extends)(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r}(OUe.NoopLogger)});var Oue=T(Zw=>{p();Object.defineProperty(Zw,"__esModule",{value:!0});Zw.CategoryLogger=void 0;var vW=UE(),hW=lW(),$Ur=Zw.CategoryLogger=function(){function e(r){this.category=r}return e.prototype.info=function(r,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];hW.ULS.sendTraceTag(r,this.category,vW.TraceLevel.Info,this.messageToLog(t,n))},e.prototype.warn=function(r,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];hW.ULS.sendTraceTag(r,this.category,vW.TraceLevel.Warning,this.messageToLog(t,n))},e.prototype.error=function(r,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];hW.ULS.sendTraceTag(r,this.category,vW.TraceLevel.Error,this.messageToLog(t,n))},e.prototype.messageToLog=function(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!t.length)return r;var a=t.map(function(o){return JSON.stringify(o)}).join(", ");return"".concat(r,": ").concat(a)},e}()});var od=T(Ma=>{p();Object.defineProperty(Ma,"__esModule",{value:!0});var SW=lW();Object.keys(SW).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===SW[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return SW[e]}})});var yW=Pue();Object.keys(yW).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===yW[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return yW[e]}})});var _W=mW();Object.keys(_W).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===_W[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return _W[e]}})});var bW=fW();Object.keys(bW).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===bW[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return bW[e]}})});var CW=uW();Object.keys(CW).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===CW[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return CW[e]}})});var TW=Fue();Object.keys(TW).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===TW[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return TW[e]}})});var RW=cW();Object.keys(RW).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===RW[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return RW[e]}})});var EW=UE();Object.keys(EW).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===EW[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return EW[e]}})});var PW=Nue();Object.keys(PW).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===PW[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return PW[e]}})});var AW=sW();Object.keys(AW).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===AW[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return AW[e]}})});var FW=Oue();Object.keys(FW).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===FW[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return FW[e]}})});var NW=jw();Object.keys(NW).forEach(function(e){e==="default"||e==="__esModule"||e in Ma&&Ma[e]===NW[e]||Object.defineProperty(Ma,e,{enumerable:!0,get:function(){return NW[e]}})})});var eD=T(yp=>{"use strict";p();Object.defineProperty(yp,"__esModule",{value:!0});yp.setFeatureGateDictionaryGetter=yp.getIntFeatureGate=yp.getNumberFeatureGate=yp.getBooleanFeatureGate=yp.getStringFeatureGate=yp.getFeatureGateDictionary=void 0;var kUe={};function kue(){return typeof globalThis.__get_feature_gate_dictionary_variable>"u"?kUe:globalThis.__get_feature_gate_dictionary_variable()}yp.getFeatureGateDictionary=kue;function $w(e,r){var t;return(t=kue()[e])!==null&&t!==void 0?t:r}yp.getStringFeatureGate=$w;function MUe(e,r){var t,n=(t=$w(e))===null||t===void 0?void 0:t.trim().toLowerCase();return n==="true"?!0:n==="false"?!1:r}yp.getBooleanFeatureGate=MUe;function xUe(e,r){var t,n=(t=$w(e))===null||t===void 0?void 0:t.trim().toLowerCase();if(n===void 0)return r;if(n==="infinity"||n==="+infinity")return 1/0;if(n==="-infinity")return-(1/0);var a=parseFloat(n);return isNaN(a)?r:a}yp.getNumberFeatureGate=xUe;function IUe(e,r){var t,n=(t=$w(e))===null||t===void 0?void 0:t.trim();if(n===void 0)return r;var a=parseInt(n,10);return isNaN(a)?r:a}yp.getIntFeatureGate=IUe;function wUe(e){var r=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,r}yp.setFeatureGateDictionaryGetter=wUe});var Mue=T(rD=>{"use strict";p();Object.defineProperty(rD,"__esModule",{value:!0});rD.makeGetTypedFeatureGate=void 0;var OW=eD();function DUe(e){function r(t){var n=e[t];switch(typeof n){case"boolean":return(0,OW.getBooleanFeatureGate)(t,n);case"number":return(0,OW.getNumberFeatureGate)(t,n);case"string":return(0,OW.getStringFeatureGate)(t,n);default:throw new Error("Wrong defaultValue type")}}return r}rD.makeGetTypedFeatureGate=DUe});var tD=T(w_=>{"use strict";p();Object.defineProperty(w_,"__esModule",{value:!0});w_.setChangeGateDictionaryGetter=w_.isChangeGateEnabled=w_.getChangeGateDictionary=void 0;function xue(){return typeof globalThis.__get_change_gate_dictionary_variable>"u"?{}:globalThis.__get_change_gate_dictionary_variable()}w_.getChangeGateDictionary=xue;function LUe(e){var r,t=xue();return(r=t[e])!==null&&r!==void 0?r:!0}w_.isChangeGateEnabled=LUe;function qUe(e){var r=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,r}w_.setChangeGateDictionaryGetter=qUe});var Iue=T(nD=>{"use strict";p();Object.defineProperty(nD,"__esModule",{value:!0});nD.makeTypedIsChangeGateEnabled=void 0;var GUe=tD();function BUe(e){return function(r){return(0,GUe.isChangeGateEnabled)(r)}}nD.makeTypedIsChangeGateEnabled=BUe});var que=T(VE=>{"use strict";p();Object.defineProperty(VE,"__esModule",{value:!0});VE.overrideTypedChangeGates=VE.overrideChangeGates=void 0;var wue=fe(),Due=tD();function Lue(e){var r=(0,Due.setChangeGateDictionaryGetter)(void 0);return(0,Due.setChangeGateDictionaryGetter)(function(){var t=r!==void 0?r():{};return wue.__assign(wue.__assign({},t),e)}),r}VE.overrideChangeGates=Lue;function UUe(e,r){return Lue(r)}VE.overrideTypedChangeGates=UUe});var Kue=T(jE=>{"use strict";p();Object.defineProperty(jE,"__esModule",{value:!0});jE.overrideTypedFeatureGates=jE.overrideFeatureGates=void 0;var Gue=fe(),Bue=eD();function Uue(e){for(var r,t,n={},a=0,o=Object.keys(e);a<o.length;a++){var u=o[a];n[u]=(r=e[u])===null||r===void 0?void 0:r.toString()}var s=function(){return{}},l=(t=(0,Bue.setFeatureGateDictionaryGetter)(void 0))!==null&&t!==void 0?t:s;return(0,Bue.setFeatureGateDictionaryGetter)(function(){return Gue.__assign(Gue.__assign({},l()),n)}),l}jE.overrideFeatureGates=Uue;function KUe(e,r){return Uue(r)}jE.overrideTypedFeatureGates=KUe});var mi=T(D_=>{"use strict";p();Object.defineProperty(D_,"__esModule",{value:!0});var WE=fe();WE.__exportStar(eD(),D_);WE.__exportStar(Mue(),D_);WE.__exportStar(tD(),D_);WE.__exportStar(Iue(),D_);WE.__exportStar(que(),D_);WE.__exportStar(Kue(),D_)});var Vue=T(a0=>{p();Object.defineProperty(a0,"__esModule",{value:!0});a0.setFeatureGateManager=a0.getStringFeatureGate=a0.getIntFeatureGate=a0.getBooleanFeatureGate=void 0;var x1,S3r=a0.setFeatureGateManager=function(r){x1=r},y3r=a0.getIntFeatureGate=function(r,t){return x1?x1.getIntFeatureGate(r,t):t},_3r=a0.getBooleanFeatureGate=function(r,t){return t===void 0&&(t=!1),x1?x1.getBooleanFeatureGate(r,t):t},b3r=a0.getStringFeatureGate=function(r,t){return x1?x1.getStringFeatureGate(r,t):t}});var Wue=T(jue=>{p();Object.defineProperty(jue,"__esModule",{value:!0})});var xW=T(L_=>{p();Object.defineProperty(L_,"__esModule",{value:!0});var kW=Vue();Object.keys(kW).forEach(function(e){e==="default"||e==="__esModule"||e in L_&&L_[e]===kW[e]||Object.defineProperty(L_,e,{enumerable:!0,get:function(){return kW[e]}})});var MW=Wue();Object.keys(MW).forEach(function(e){e==="default"||e==="__esModule"||e in L_&&L_[e]===MW[e]||Object.defineProperty(L_,e,{enumerable:!0,get:function(){return MW[e]}})})});var wW=T(tg=>{p();Object.defineProperty(tg,"__esModule",{value:!0});tg.getAppSettingValue=Mk;tg.getIntFeatureGateValue=HUe;tg.getListAppSetting=QUe;tg.isChangeGateEnabledInAppSetting=XUe;tg.isChangeGateEnabledInAppSettingWithDelimiter=YUe;tg.isFeatureEnabled=WUe;tg.setAppSettingValueForTest=zUe;tg.setAppSettings=aD;tg.setIsFeatureEnabledCallback=jUe;tg.setTestAppSettings=VUe;var Hue=xW(),Vv,HE,IW;function aD(e){Vv=e;try{HE=JSON.parse(Mk("DisabledChangeGates","{}"))}catch(r){HE={}}}function VUe(e){var r=Vv;return aD(e),function(){aD(r)}}function jUe(e){IW=e}function WUe(e,r){r===void 0&&(r=!1);var t=IW?IW(e):!!Vv&&!!Vv[e]&&Vv[e].toLowerCase()==="true";return t||(0,Hue.getBooleanFeatureGate)(e,r)}function HUe(e,r){return(0,Hue.getIntFeatureGate)(e,r)}function Mk(e,r){return!Vv||!Vv[e]?r:Vv[e]}function zUe(e,r){Vv||aD({});var t=Vv[e];return Vv[e]=r,t}function QUe(e){var r=Mk(e,"[]");return JSON.parse(r)}function XUe(e,r){var t=Mk(e,"");return!(HE&&r in HE)&&!t.split(",").some(function(n){return n===r})}function YUe(e,r,t){var n=Mk(e,"");return!(HE&&r in HE)&&!n.split(t).some(function(a){return a.trim()===r})}});var zue=T(zE=>{p();Object.defineProperty(zE,"__esModule",{value:!0});zE.getDeploymentRing=zE.getAppSettingsForDeploymentRingValueForTest=void 0;var JUe=wW(),O3r=zE.getDeploymentRing=function(){var r=(0,JUe.getAppSettingValue)("StatusBarEnvironmentNameToUse","").toLowerCase();return r.length===0?"production":r.indexOf("outer ring")>=0?"outer-ring":r.indexOf("inner ring")>=0?"inner-ring":r.indexOf("dev box")>=0?"dev-box":"production"},k3r=zE.getAppSettingsForDeploymentRingValueForTest=function(r){var t=r==="production"?"":r==="outer-ring"?"Outer Ring (PPE) : FakeDC2":r==="inner-ring"?"Inner Ring (Fastfood) : FakeDC1":"Dev Box";return{StatusBarEnvironmentNameToUse:t}}});var DW=T(jv=>{p();Object.defineProperty(jv,"__esModule",{value:!0});Object.defineProperty(jv,"getAppSettingValue",{enumerable:!0,get:function(){return q_.getAppSettingValue}});Object.defineProperty(jv,"getDeploymentRing",{enumerable:!0,get:function(){return ZUe.getDeploymentRing}});Object.defineProperty(jv,"getIntFeatureGateValue",{enumerable:!0,get:function(){return q_.getIntFeatureGateValue}});Object.defineProperty(jv,"getListAppSetting",{enumerable:!0,get:function(){return q_.getListAppSetting}});Object.defineProperty(jv,"isChangeGateEnabledInAppSetting",{enumerable:!0,get:function(){return q_.isChangeGateEnabledInAppSetting}});Object.defineProperty(jv,"isChangeGateEnabledInAppSettingWithDelimiter",{enumerable:!0,get:function(){return q_.isChangeGateEnabledInAppSettingWithDelimiter}});Object.defineProperty(jv,"isFeatureEnabled",{enumerable:!0,get:function(){return q_.isFeatureEnabled}});Object.defineProperty(jv,"setAppSettings",{enumerable:!0,get:function(){return q_.setAppSettings}});Object.defineProperty(jv,"setIsFeatureEnabledCallback",{enumerable:!0,get:function(){return q_.setIsFeatureEnabledCallback}});var q_=wW(),ZUe=zue()});var Xue=T(LW=>{p();Object.defineProperty(LW,"__esModule",{value:!0});LW.setWebpackPublicPath=$Ue;var Que=DW();function $Ue(e){var r=e;(0,Que.isFeatureEnabled)("AppChromeOverrideEnabled")&&(r=(0,Que.getAppSettingValue)("AppChromeBaseScriptUrlOverride","")),__webpack_public_path__=__webpack_public_path__||r}});var Yue=T(xk=>{p();Object.defineProperty(xk,"__esModule",{value:!0});var qW=Xue();Object.keys(qW).forEach(function(e){e==="default"||e==="__esModule"||e in xk&&xk[e]===qW[e]||Object.defineProperty(xk,e,{enumerable:!0,get:function(){return qW[e]}})})});var Jue=T(Wv=>{p();Object.defineProperty(Wv,"__esModule",{value:!0});var GW=DW();Object.keys(GW).forEach(function(e){e==="default"||e==="__esModule"||e in Wv&&Wv[e]===GW[e]||Object.defineProperty(Wv,e,{enumerable:!0,get:function(){return GW[e]}})});var BW=Yue();Object.keys(BW).forEach(function(e){e==="default"||e==="__esModule"||e in Wv&&Wv[e]===BW[e]||Object.defineProperty(Wv,e,{enumerable:!0,get:function(){return BW[e]}})});var UW=xW();Object.keys(UW).forEach(function(e){e==="default"||e==="__esModule"||e in Wv&&Wv[e]===UW[e]||Object.defineProperty(Wv,e,{enumerable:!0,get:function(){return UW[e]}})})});var VW=T(KW=>{p();Object.defineProperty(KW,"__esModule",{value:!0});KW.configureGating=n3e;var e3e=fe(),Zue=od(),$ue=mi(),r3e=Jue(),t3e="Microsoft.Office.",ese="Microsoft.Office.Excel.";function n3e(e){(0,$ue.setFeatureGateDictionaryGetter)(function(){return e}),(0,$ue.setChangeGateDictionaryGetter)(function(){return i3e(e)}),(0,r3e.setIsFeatureEnabledCallback)(function(r){return Zue.ULS.shipAssertTag(508864162,Zue.LogCategory.msoulscat_ES_EWAJS,!1,"The deprecated office-online-app-platform's isFeatureEnabled API was called on feature gate '".concat(r,"'. Please switch over to office-online-feature-gates' getBooleanFeatureGate API.")),e[r]==="true"||!r.startsWith(t3e)&&e[ese+r]==="true"})}var a3e="Microsoft.Office.Excel.OfficeVSO:";function i3e(e){var r=(0,e3e.__assign)({},e);for(var t in Object.keys(e))if(t.startsWith(a3e)){var n=t.replace(ese,"");n.length>0&&(r[n]=e[t])}return r}});var rse=T(Ik=>{p();Object.defineProperty(Ik,"__esModule",{value:!0});var jW=VW();Object.keys(jW).forEach(function(e){e==="default"||e==="__esModule"||e in Ik&&Ik[e]===jW[e]||Object.defineProperty(Ik,e,{enumerable:!0,get:function(){return jW[e]}})})});var rl=T((H3r,tse)=>{p();tse.exports=OfficePlatformGlobal.Reka});var nse=T(wk=>{p();Object.defineProperty(wk,"__esModule",{value:!0});wk.MockRekaBridge=void 0;wk.initMockRekaBridge=s3e;var o3e=rl(),u3e=wk.MockRekaBridge=function(){function e(){this.RekaConstants={}}return e.prototype.invokeNative=function(r){},e}();function s3e(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=new u3e;o3e.RekaInstance.initBridge(t,e)}});var ase=T(Dk=>{p();Object.defineProperty(Dk,"__esModule",{value:!0});var WW=nse();Object.keys(WW).forEach(function(e){e==="default"||e==="__esModule"||e in Dk&&Dk[e]===WW[e]||Object.defineProperty(Dk,e,{enumerable:!0,get:function(){return WW[e]}})})});var ise=T(QE=>{p();Object.defineProperty(QE,"__esModule",{value:!0});QE.ServiceInfos=QE.NativeServices=void 0;var l3e=rl(),c3e=QE.ServiceInfos={ITaskPaneClient2Host:["Uxpp::Internal::RekaServices::ITaskPaneClient2Host",{loaded:["FireAndForgetMethod",[]]}]},Z3r=QE.NativeServices=function(){function e(){}return Object.defineProperty(e,"ITaskPaneClient2Host",{get:function(){var t;return(t=e._ITaskPaneClient2Host)!==null&&t!==void 0?t:e._ITaskPaneClient2Host=l3e.RekaServiceRegistry.getNativeService(c3e.ITaskPaneClient2Host)},enumerable:!1,configurable:!0}),e}()});var ose=T(iD=>{p();Object.defineProperty(iD,"__esModule",{value:!0});iD.ServiceInfos=void 0;var rKr=iD.ServiceInfos={ITaskPaneHost2Client:["Uxpp::Internal::RekaServices::ITaskPaneHost2Client",{start2:["ReturnsPromiseMethod","$number",["Uxpp::TaskPanes::StartParams"]],start:["ReturnsPromiseMethod","$number",["Uxpp::TaskPanes::StartParams"]]}]}});var HW=T(XE=>{p();Object.defineProperty(XE,"__esModule",{value:!0});XE.ServiceInfos=XE.NativeServices=void 0;var d3e=rl(),f3e=XE.ServiceInfos={Logger:["Uxpp::Internal::RekaServices::Logger",{sendTraceTag:["FireAndForgetMethod",["$number","$number","$string"]],shipAssertTag:["FireAndForgetMethod",["$number","$boolean","$string"]],debugAssertTag:["FireAndForgetMethod",["$number","$boolean","$string"]],setCorrelationId:["FireAndForgetMethod",["$string"]]}]},aKr=XE.NativeServices=function(){function e(){}return Object.defineProperty(e,"Logger",{get:function(){var t;return(t=e._Logger)!==null&&t!==void 0?t:e._Logger=d3e.RekaServiceRegistry.getNativeService(f3e.Logger)},enumerable:!1,configurable:!0}),e}()});var sse=T(YE=>{p();Object.defineProperty(YE,"__esModule",{value:!0});YE.ServiceInfos=YE.NativeServices=void 0;var use=rl();use.CustomTypeRegistry.registerTypeInfos({"Uxpp::RekaServices::PowerOptionsTaskPane::PowerOptionsTaskPaneProps":{pal:["opt-field","$string"]}});var p3e=YE.ServiceInfos={IPowerOptionsTaskPaneCallbacks:["Uxpp::RekaServices::PowerOptionsTaskPane::IPowerOptionsTaskPaneCallbacks",{do:["FireAndForgetMethod",[]]}]},uKr=YE.NativeServices=function(){function e(){}return Object.defineProperty(e,"IPowerOptionsTaskPaneCallbacks",{get:function(){var t;return(t=e._IPowerOptionsTaskPaneCallbacks)!==null&&t!==void 0?t:e._IPowerOptionsTaskPaneCallbacks=use.RekaServiceRegistry.getNativeService(p3e.IPowerOptionsTaskPaneCallbacks)},enumerable:!1,configurable:!0}),e}()});var cse=T(JE=>{p();Object.defineProperty(JE,"__esModule",{value:!0});JE.nativeNamespace=JE.TraceLevel=void 0;var cKr=JE.nativeNamespace="Uxpp.Internal.RekaServices",lse;(function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"})(lse||(JE.TraceLevel=lse={}))});var dse=T(zW=>{p();Object.defineProperty(zW,"__esModule",{value:!0});Object.defineProperty(zW,"TraceLevel",{enumerable:!0,get:function(){return m3e.TraceLevel}});var m3e=cse()});var QW=T(ZE=>{p();Object.defineProperty(ZE,"__esModule",{value:!0});ZE.ServiceInfos=ZE.NativeServices=void 0;var g3e=rl(),v3e=ZE.ServiceInfos={RekaTelemetryAdapter:["Uxpp::RekaServices::RekaTelemetryAdapter",{sendTelemetryEvent:["FireAndForgetMethod",["$string"]]}]},gKr=ZE.NativeServices=function(){function e(){}return Object.defineProperty(e,"RekaTelemetryAdapter",{get:function(){var t;return(t=e._RekaTelemetryAdapter)!==null&&t!==void 0?t:e._RekaTelemetryAdapter=g3e.RekaServiceRegistry.getNativeService(v3e.RekaTelemetryAdapter)},enumerable:!1,configurable:!0}),e}()});var XW=T($E=>{p();Object.defineProperty($E,"__esModule",{value:!0});$E.ServiceInfos=$E.NativeServices=void 0;var h3e=rl(),S3e=$E.ServiceInfos={UxppGatesService:["Uxpp::RekaServices::UxppGatesService",{getGates:["ReturnsPromiseMethod",["$indexer","$string"],[]]}]},SKr=$E.NativeServices=function(){function e(){}return Object.defineProperty(e,"UxppGatesService",{get:function(){var t;return(t=e._UxppGatesService)!==null&&t!==void 0?t:e._UxppGatesService=h3e.RekaServiceRegistry.getNativeService(S3e.UxppGatesService)},enumerable:!1,configurable:!0}),e}()});var fse=T(eP=>{p();Object.defineProperty(eP,"__esModule",{value:!0});eP.ServiceInfos=eP.NativeServices=void 0;var y3e=rl(),_3e=eP.ServiceInfos={UxppPowerOptionsJsService:["Uxpp::Internal::RekaServices::UxppPowerOptionsJsService",{simulateTestEvent:["ReturnsPromiseMethod","$string",["$string"]],onTestEvent:["Event","$string"]}]},bKr=eP.NativeServices=function(){function e(){}return Object.defineProperty(e,"UxppPowerOptionsJsService",{get:function(){var t;return(t=e._UxppPowerOptionsJsService)!==null&&t!==void 0?t:e._UxppPowerOptionsJsService=y3e.RekaServiceRegistry.getNativeService(_3e.UxppPowerOptionsJsService)},enumerable:!1,configurable:!0}),e}()});var pse=T(rP=>{p();Object.defineProperty(rP,"__esModule",{value:!0});rP.ServiceInfos=rP.NativeServices=void 0;var b3e=rl(),C3e=rP.ServiceInfos={UxppPowerOptionsService:["Uxpp::Internal::RekaServices::UxppPowerOptionsService",{simulateThemeChange:["FireAndForgetMethod",["$number"]]}]},RKr=rP.NativeServices=function(){function e(){}return Object.defineProperty(e,"UxppPowerOptionsService",{get:function(){var t;return(t=e._UxppPowerOptionsService)!==null&&t!==void 0?t:e._UxppPowerOptionsService=b3e.RekaServiceRegistry.getNativeService(C3e.UxppPowerOptionsService)},enumerable:!1,configurable:!0}),e}()});var mse=T(tP=>{p();Object.defineProperty(tP,"__esModule",{value:!0});tP.ServiceInfos=tP.NativeServices=void 0;var T3e=rl(),R3e=tP.ServiceInfos={UxppRekaServiceManager:["Uxpp::Internal::RekaServices::UxppRekaServiceManager",{indicateStarted:["FireAndForgetMethod",[]],registerServices:["ReturnsPromiseMethod","$any",[["$array","$string"]]],raiseEvent:["FireAndForgetMethod",["$string","$string","$string"]]}]},AKr=tP.NativeServices=function(){function e(){}return Object.defineProperty(e,"UxppRekaServiceManager",{get:function(){var t;return(t=e._UxppRekaServiceManager)!==null&&t!==void 0?t:e._UxppRekaServiceManager=T3e.RekaServiceRegistry.getNativeService(R3e.UxppRekaServiceManager)},enumerable:!1,configurable:!0}),e}()});var vse=T(nP=>{p();Object.defineProperty(nP,"__esModule",{value:!0});nP.nativeNamespace=nP.UxppThemeId=void 0;var OKr=nP.nativeNamespace="Uxpp.TaskPanes",gse;(function(e){e[e.Colorful=0]="Colorful",e[e.VeryDark=1]="VeryDark",e[e.Black=2]="Black",e[e.Fresh=3]="Fresh",e[e.MacLight=4]="MacLight",e[e.MacDark=5]="MacDark"})(gse||(nP.UxppThemeId=gse={}))});var hse=T(YW=>{p();Object.defineProperty(YW,"__esModule",{value:!0});Object.defineProperty(YW,"UxppThemeId",{enumerable:!0,get:function(){return E3e.UxppThemeId}});var E3e=vse()});var Sse=T(aP=>{p();Object.defineProperty(aP,"__esModule",{value:!0});aP.ServiceInfos=aP.NativeServices=void 0;var P3e=rl(),A3e=aP.ServiceInfos={UxppThemeService:["Uxpp::Internal::RekaServices::UxppThemeService",{getCurrentTheme:["ReturnsPromiseMethod","$number",[]],onThemeChange:["Event","$number"]}]},wKr=aP.NativeServices=function(){function e(){}return Object.defineProperty(e,"UxppThemeService",{get:function(){var t;return(t=e._UxppThemeService)!==null&&t!==void 0?t:e._UxppThemeService=P3e.RekaServiceRegistry.getNativeService(A3e.UxppThemeService)},enumerable:!1,configurable:!0}),e}()});var yse=T(iP=>{p();Object.defineProperty(iP,"__esModule",{value:!0});iP.ServiceInfos=iP.NativeServices=void 0;var F3e=rl(),N3e=iP.ServiceInfos={UxppPaneLifecycleService:["Uxpp::Internal::RekaServices::UxppPaneLifecycleService",{onClose:["Event","Uxpp::TaskPanes::TaskPaneInstance"]}]},qKr=iP.NativeServices=function(){function e(){}return Object.defineProperty(e,"UxppPaneLifecycleService",{get:function(){var t;return(t=e._UxppPaneLifecycleService)!==null&&t!==void 0?t:e._UxppPaneLifecycleService=F3e.RekaServiceRegistry.getNativeService(N3e.UxppPaneLifecycleService)},enumerable:!1,configurable:!0}),e}()});var Ose=T(fu=>{p();Object.defineProperty(fu,"__esModule",{value:!0});Object.defineProperty(fu,"ITaskPaneClient2HostNativeServices",{enumerable:!0,get:function(){return _se.NativeServices}});Object.defineProperty(fu,"ITaskPaneClient2HostServiceInfos",{enumerable:!0,get:function(){return _se.ServiceInfos}});Object.defineProperty(fu,"ITaskPaneHost2ClientServiceInfos",{enumerable:!0,get:function(){return O3e.ServiceInfos}});Object.defineProperty(fu,"LoggerNativeServices",{enumerable:!0,get:function(){return bse.NativeServices}});Object.defineProperty(fu,"LoggerServiceInfos",{enumerable:!0,get:function(){return bse.ServiceInfos}});Object.defineProperty(fu,"PowerOptionsTaskPaneNativeServices",{enumerable:!0,get:function(){return Cse.NativeServices}});Object.defineProperty(fu,"PowerOptionsTaskPaneServiceInfos",{enumerable:!0,get:function(){return Cse.ServiceInfos}});Object.defineProperty(fu,"TelemetryAdapterNativeServices",{enumerable:!0,get:function(){return Tse.NativeServices}});Object.defineProperty(fu,"TelemetryAdapterServiceInfos",{enumerable:!0,get:function(){return Tse.ServiceInfos}});Object.defineProperty(fu,"TraceLevel",{enumerable:!0,get:function(){return k3e.TraceLevel}});Object.defineProperty(fu,"UxppGatesServiceNativeServices",{enumerable:!0,get:function(){return Rse.NativeServices}});Object.defineProperty(fu,"UxppGatesServiceServiceInfos",{enumerable:!0,get:function(){return Rse.ServiceInfos}});Object.defineProperty(fu,"UxppPaneLifecycleServiceNativeServices",{enumerable:!0,get:function(){return Nse.NativeServices}});Object.defineProperty(fu,"UxppPaneLifecycleServiceServiceInfos",{enumerable:!0,get:function(){return Nse.ServiceInfos}});Object.defineProperty(fu,"UxppPowerOptionsJsServiceNativeServices",{enumerable:!0,get:function(){return Ese.NativeServices}});Object.defineProperty(fu,"UxppPowerOptionsJsServiceServiceInfos",{enumerable:!0,get:function(){return Ese.ServiceInfos}});Object.defineProperty(fu,"UxppPowerOptionsServiceNativeServices",{enumerable:!0,get:function(){return Pse.NativeServices}});Object.defineProperty(fu,"UxppPowerOptionsServiceServiceInfos",{enumerable:!0,get:function(){return Pse.ServiceInfos}});Object.defineProperty(fu,"UxppRekaServiceManagerNativeServices",{enumerable:!0,get:function(){return Ase.NativeServices}});Object.defineProperty(fu,"UxppRekaServiceManagerServiceInfos",{enumerable:!0,get:function(){return Ase.ServiceInfos}});Object.defineProperty(fu,"UxppThemeId",{enumerable:!0,get:function(){return M3e.UxppThemeId}});Object.defineProperty(fu,"UxppThemeServiceNativeServices",{enumerable:!0,get:function(){return Fse.NativeServices}});Object.defineProperty(fu,"UxppThemeServiceServiceInfos",{enumerable:!0,get:function(){return Fse.ServiceInfos}});var _se=ise(),O3e=ose(),bse=HW(),Cse=sse(),k3e=dse(),Tse=QW(),Rse=XW(),Ese=fse(),Pse=pse(),Ase=mse(),M3e=hse(),Fse=Sse(),Nse=yse()});var Mse=T(kse=>{p();Object.defineProperty(kse,"__esModule",{value:!0})});var wse=T(JW=>{p();Object.defineProperty(JW,"__esModule",{value:!0});JW.initializeGates=D3e;var xse=fe(),x3e=w3e(XW()),I3e=VW();function Ise(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,t=new WeakMap;return(Ise=function(a){return a?t:r})(e)}function w3e(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=Ise(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}function D3e(){return(0,xse.__awaiter)(this,void 0,void 0,function(){var e;return(0,xse.__generator)(this,function(r){switch(r.label){case 0:return[4,x3e.NativeServices.UxppGatesService.getGates()];case 1:return e=r.sent(),(0,I3e.configureGating)(e),[2]}})})}});var Lse=T(oD=>{p();Object.defineProperty(oD,"__esModule",{value:!0});oD.HRESULT=void 0;var Dse;(function(e){e[e.hrNoError=0]="hrNoError",e[e.hrFail=2148140012]="hrFail"})(Dse||(oD.HRESULT=Dse={}))});var qse=T(uD=>{p();Object.defineProperty(uD,"__esModule",{value:!0});uD.Lazy=void 0;var XKr=uD.Lazy=function(){function e(r){this._factory=r}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value===void 0&&(this._value=this._factory()),this._value},enumerable:!1,configurable:!0}),e}()});var Gse=T(sD=>{p();Object.defineProperty(sD,"__esModule",{value:!0});sD.nameof=void 0;var ZKr=sD.nameof=function(r){return r}});var Vse=T(Gf=>{p();Object.defineProperty(Gf,"__esModule",{value:!0});Gf.areEqual=q3e;Gf.asStringOrUndefined=G3e;Gf.conditional=B3e;Gf.deepReplaceProperties=Bse;Gf.filterProperties=Use;Gf.forceCast=U3e;Gf.getDefinedProperties=K3e;Gf.getPropertyOrDefault=V3e;Gf.handleUndefined=j3e;Gf.isObject=Kse;Gf.isRecord=ZW;Gf.toString=W3e;Gf.transform=H3e;var L3e=fe();function q3e(e,r,t){return e===void 0&&r===void 0||e===null&&r===null?!0:e===null||r===null||e===void 0||r===void 0?!1:t(e,r)}function G3e(e){if(typeof e=="string")return e}function B3e(e,r){return e?r:void 0}function Bse(e,r){var t=e;if(r){t=t??{};for(var n=(0,L3e.__assign)({},t),a=0,o=Object.entries(r);a<o.length;a++){var u=o[a],s=u[0],l=u[1];n[s]=ZW(l)?Bse(t[s],l):l}return n}return t}function Use(e,r){for(var t={},n=0,a=Object.keys(e);n<a.length;n++){var o=a[n],u=e[o];r(u)&&(t[o]=u)}return t}function U3e(e){return e}function K3e(e){return Use(e,function(r){return r!==void 0})}function V3e(e,r,t){var n;return e&&ZW(e)&&e.hasOwnProperty(r)&&(n=e[r])!==null&&n!==void 0?n:t}function j3e(e){return function(r){if(r!==void 0)return e(r)}}function Kse(e){return e!==null&&typeof e=="object"}function ZW(e){return Kse(e)&&!Array.isArray(e)&&e.constructor===Object}function W3e(e){if(e!=null)return e.toString()}function H3e(e,r){if(e!==void 0)return r(e)}});var e9=T($W=>{p();Object.defineProperty($W,"__esModule",{value:!0});$W.sendEvent=Q3e;var z3e=QW();function Q3e(e){z3e.NativeServices.RekaTelemetryAdapter.sendTelemetryEvent(e)}});var JS=T((i4r,jse)=>{p();jse.exports=OfficePlatformGlobal.Telemetry.OTelV4});var Hse=T(r9=>{p();Object.defineProperty(r9,"__esModule",{value:!0});r9.convertDataFields=Y3e;var I1=X3e(JS());function Wse(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,t=new WeakMap;return(Wse=function(a){return a?t:r})(e)}function X3e(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=Wse(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}function Y3e(e){var r=!0,t=[];return e.forEach(function(n){var a,o=n.classification;if(o===I1.EnumObjects.DataClassification.SystemMetadata||o===I1.EnumObjects.DataClassification.EssentialServiceMetadata){var u=(a={},a.name=n.name,a.bool=null,a.string=null,a.double=null,a.int64=null,a.date=null,a.contract=null,a);switch(n.dataType){case I1.EnumObjects.DataFieldType.Boolean:u.bool=n.value;break;case I1.EnumObjects.DataFieldType.Double:u.double=n.value;break;case I1.EnumObjects.DataFieldType.Int64:u.int64=n.value;break;case I1.EnumObjects.DataFieldType.String:u.string=n.value;break;case I1.EnumObjects.DataFieldType.Guid:default:return}t.push(u)}else r=!1}),r?t:[]}});var zse=T(lD=>{p();Object.defineProperty(lD,"__esModule",{value:!0});lD.getTelemetryLogger=$3e;lD.setTelemetryLogger=Z3e;var J3e=JS(),t9=od();function Z3e(e){globalThis.__otel_util_telemetry_logger__&&e&&globalThis.__otel_util_telemetry_logger__!==e&&t9.ULS.sendTraceTag(507320407,t9.LogCategory.msoulscat_Wac_Telemetry,t9.TraceLevel.Error,"Overriding an already configured singleton telemetry logger"),globalThis.__otel_util_telemetry_logger__=e}function $3e(){return globalThis.__otel_util_telemetry_logger__===void 0&&(globalThis.__otel_util_telemetry_logger__=new J3e.TelemetryLogger),globalThis.__otel_util_telemetry_logger__}});var w1=T(G_=>{p();Object.defineProperty(G_,"__esModule",{value:!0});var n9=Hse();Object.keys(n9).forEach(function(e){e==="default"||e==="__esModule"||e in G_&&G_[e]===n9[e]||Object.defineProperty(G_,e,{enumerable:!0,get:function(){return n9[e]}})});var a9=zse();Object.keys(a9).forEach(function(e){e==="default"||e==="__esModule"||e in G_&&G_[e]===a9[e]||Object.defineProperty(G_,e,{enumerable:!0,get:function(){return a9[e]}})})});var o9=T(ng=>{p();Object.defineProperty(ng,"__esModule",{value:!0});ng.PartialEventNameScope=void 0;ng.appendEventNameSuffix=aKe;ng.appendToOfficeUxppNamespacePrefix=nKe;ng.officeAppClientNamespacePrefix=rKe;ng.officeAppNamespacePrefix=Qse;ng.officeUxppNamespacePrefix=ng.officeUxppAriaTenantToken=void 0;var oP=".",i9;(function(e){e[e.UxppRuntime=0]="UxppRuntime",e[e.PowerOptions=1]="PowerOptions",e[e.PowerQuery=2]="PowerQuery",e[e.DataCleansing=3]="DataCleansing"})(i9||(ng.PartialEventNameScope=i9={}));var eKe=ng.officeUxppNamespacePrefix="Office".concat(oP,"Uxpp"),p4r=ng.officeUxppAriaTenantToken="771eb6027aa74c4bbec78a064eb2ca56-d6fad40c-2791-45d8-a56f-3a4f8eb06f93-7480";function Qse(e){return"Office".concat(oP).concat(e??"None")}function rKe(e){return"".concat(Qse(e)).concat(oP,"Client")}function tKe(){return"".concat(eKe).concat(oP,"Client")}function nKe(e){return"".concat(tKe()).concat(oP).concat(i9[e])}function aKe(e,r){return"".concat(e).concat(oP).concat(r)}});var Xse=T(cD=>{p();Object.defineProperty(cD,"__esModule",{value:!0});cD.AriaTenantDefinitions=void 0;var v4r=cD.AriaTenantDefinitions=[{namespace:"Office.Excel.Online.Data",ariaTenant:"011776870b754a649aedc9456ac07a97-6bd8247c-11d3-4599-b599-ec9ef6d401f6-6722"},{namespace:"Office.Shared.Online.Data",ariaTenant:"4ad8b2b2029e481fb82edb7aac29de59-94494dd8-b684-4f92-ab7f-6b414eb77798-7917"},{namespace:"Office.Excel.Client",ariaTenant:"19eb5e37de684ce38ce5cf3d5842d3f7-e8722941-bde5-4b98-9cd5-2775ec51482c-6873"}]});var s9=T(dD=>{p();Object.defineProperty(dD,"__esModule",{value:!0});dD.getFilledEventFlags=sKe;dD.initTelemetryLoggerWithSink=oKe;var uP=od(),u9=w1(),D1=JS(),Yse=o9(),iKe=Xse();function oKe(e){(0,u9.getTelemetryLogger)().addSink(e);for(var r=0,t=iKe.AriaTenantDefinitions;r<t.length;r++){var n=t[r];(0,u9.getTelemetryLogger)().setTenantToken(n.namespace,n.ariaTenant)}(0,u9.getTelemetryLogger)().setTenantToken(Yse.officeUxppNamespacePrefix,Yse.officeUxppAriaTenantToken),(0,D1.onNotification)().addListener(function(a){uP.ULS.sendTraceTag(508687499,uP.LogCategory.msoulscat_ES_EWAJS,uKe(a.level),a.message())})}function uKe(e){switch(e){case D1.EnumObjects.LogLevel.Error:return uP.TraceLevel.Error;case D1.EnumObjects.LogLevel.Info:return uP.TraceLevel.Info;case D1.EnumObjects.LogLevel.Verbose:return uP.TraceLevel.Verbose;case D1.EnumObjects.LogLevel.Warning:return uP.TraceLevel.Warning}}function sKe(e,r,t){return{dataCategories:e,diagnosticLevel:r,samplingPolicy:t,costPriority:D1.EnumObjects.CostPriority.Normal,persistencePriority:D1.EnumObjects.PersistencePriority.Normal}}});var ele=T(B_=>{p();Object.defineProperty(B_,"__esModule",{value:!0});B_.errorLogLevel=void 0;B_.getTraceLevel=dKe;B_.infoLogLevel=void 0;B_.removeHiddenDataFields=pKe;var Jse=od(),lKe=B_.errorLogLevel="Error",b4r=B_.infoLogLevel="Info",cKe="Hidden.Tag",Zse="Hidden.Log.Level";function dKe(e){var r=fKe(e,Zse);return r===lKe?Jse.TraceLevel.Error:Jse.TraceLevel.Info}function fKe(e,r){var t,n=(t=e.dataFields)===null||t===void 0?void 0:t.filter(function(a){return a.name===r});if(n!=null&&n.length)return n[0].value}function pKe(e){mKe(e),gKe(e)}function mKe(e){e.dataFields=$se(e,cKe)}function gKe(e){e.dataFields=$se(e,Zse)}function $se(e,r){var t;return(t=e.dataFields)===null||t===void 0?void 0:t.filter(function(n){return n.name!==r})}});var f9=T(Hv=>{p();Object.defineProperty(Hv,"__esModule",{value:!0});var l9=s9();Object.keys(l9).forEach(function(e){e==="default"||e==="__esModule"||e in Hv&&Hv[e]===l9[e]||Object.defineProperty(Hv,e,{enumerable:!0,get:function(){return l9[e]}})});var c9=o9();Object.keys(c9).forEach(function(e){e==="default"||e==="__esModule"||e in Hv&&Hv[e]===c9[e]||Object.defineProperty(Hv,e,{enumerable:!0,get:function(){return c9[e]}})});var d9=ele();Object.keys(d9).forEach(function(e){e==="default"||e==="__esModule"||e in Hv&&Hv[e]===d9[e]||Object.defineProperty(Hv,e,{enumerable:!0,get:function(){return d9[e]}})})});var m9=T(fD=>{p();Object.defineProperty(fD,"__esModule",{value:!0});fD.RekaSink=void 0;var p9=JS(),vKe=e9(),hKe=f9(),P4r=fD.RekaSink=function(){function e(){}return e.prototype.sendTelemetryEvent=function(r){try{(0,hKe.removeHiddenDataFields)(r),(0,vKe.sendEvent)(JSON.stringify(r))}catch(t){(0,p9.logNotification)(p9.EnumObjects.LogLevel.Error,p9.EnumObjects.Category.Sink,function(){return"RekaSink caught an error for event name '".concat(r.eventName,"': (timestamp=").concat(Date.now(),") ").concat(JSON.stringify(t))})}},e}()});var rle=T(g9=>{p();Object.defineProperty(g9,"__esModule",{value:!0});g9.initializeTelemetry=_Ke;var SKe=m9(),yKe=s9();function _Ke(){(0,yKe.initTelemetryLoggerWithSink)(new SKe.RekaSink)}});var tle=T(zv=>{p();Object.defineProperty(zv,"__esModule",{value:!0});var v9=e9();Object.keys(v9).forEach(function(e){e==="default"||e==="__esModule"||e in zv&&zv[e]===v9[e]||Object.defineProperty(zv,e,{enumerable:!0,get:function(){return v9[e]}})});var h9=m9();Object.keys(h9).forEach(function(e){e==="default"||e==="__esModule"||e in zv&&zv[e]===h9[e]||Object.defineProperty(zv,e,{enumerable:!0,get:function(){return h9[e]}})});var S9=rle();Object.keys(S9).forEach(function(e){e==="default"||e==="__esModule"||e in zv&&zv[e]===S9[e]||Object.defineProperty(zv,e,{enumerable:!0,get:function(){return S9[e]}})})});var nle=T(Xl=>{p();Object.defineProperty(Xl,"__esModule",{value:!0});Xl.arrayHasLength=bKe;Xl.arrayLengthIsInRange=CKe;Xl.arrayNotEmpty=TKe;Xl.assert=RKe;Xl.equal=IKe;Xl.isDefined=EKe;Xl.isFalse=MKe;Xl.isGreaterOrEqualToZero=AKe;Xl.isGreaterThanZero=PKe;Xl.isInRange=xKe;Xl.isNever=FKe;Xl.isNeverWithoutThrowing=NKe;Xl.isOfType=OKe;Xl.isTrue=kKe;Xl.notEqual=wKe;Xl.notNull=DKe;Xl.notUndefined=LKe;function bKe(e,r,t){if(e.length!==r)throw new Error("Array should have ".concat(r," items instead of ").concat(e.length,". Array name: ").concat(t))}function CKe(e,r,t,n){if(e.length<r||e.length>t)throw new Error("Array length should be in range [".concat(r,", ").concat(t,"] instead of ").concat(e.length,". Array name: ").concat(n))}function TKe(e,r){if(e.length===0)throw new Error("Array should not be empty. Array name: ".concat(r))}function RKe(e,r){if(!e)throw new Error(r?r():"Expected condition to be true")}function EKe(e,r){if(e===void 0)throw new Error("Argument should not be undefined. Argument name: ".concat(r))}function PKe(e,r){if(e<=0)throw new Error("Argument ".concat(r," is not greater than zero. Value: ").concat(e))}function AKe(e,r){if(e<0)throw new Error("Argument ".concat(r," is not greater than or equal to zero. Value: ").concat(e))}function FKe(e){throw new Error("Unexpected value: ".concat(e))}function NKe(e){}function OKe(e,r){if(!r(e))throw new Error("Value is not of expected type")}function kKe(e,r){if(!e)throw new Error("Condition should be true. ".concat(r))}function MKe(e,r){if(e)throw new Error("Condition should be false. ".concat(r))}function xKe(e,r,t,n){var a=r+t-1;if(e<r||e>a)throw new Error("Argument out of range [".concat(r,", ").concat(a,"]. Actual value: ").concat(e,". ").concat(n))}function IKe(e,r,t){if(t===void 0&&(t=""),e!==r)throw new Error("Values ".concat(e," and ").concat(r," should be equal. ").concat(t))}function wKe(e,r,t){if(t===void 0&&(t=""),e===r)throw new Error("Values ".concat(e," and ").concat(r," should not be equal. ").concat(t))}function DKe(e,r){if(r===void 0&&(r=""),e===null)throw new Error("Value should not be null: ".concat(r))}function LKe(e,r){if(r===void 0&&(r=""),e===void 0)throw new Error("Value should not be undefined: ".concat(r))}});var ale=T($o=>{p();Object.defineProperty($o,"__esModule",{value:!0});var y9=Mse();Object.keys(y9).forEach(function(e){e==="default"||e==="__esModule"||e in $o&&$o[e]===y9[e]||Object.defineProperty($o,e,{enumerable:!0,get:function(){return y9[e]}})});var _9=wse();Object.keys(_9).forEach(function(e){e==="default"||e==="__esModule"||e in $o&&$o[e]===_9[e]||Object.defineProperty($o,e,{enumerable:!0,get:function(){return _9[e]}})});var b9=Lse();Object.keys(b9).forEach(function(e){e==="default"||e==="__esModule"||e in $o&&$o[e]===b9[e]||Object.defineProperty($o,e,{enumerable:!0,get:function(){return b9[e]}})});var C9=qse();Object.keys(C9).forEach(function(e){e==="default"||e==="__esModule"||e in $o&&$o[e]===C9[e]||Object.defineProperty($o,e,{enumerable:!0,get:function(){return C9[e]}})});var T9=Gse();Object.keys(T9).forEach(function(e){e==="default"||e==="__esModule"||e in $o&&$o[e]===T9[e]||Object.defineProperty($o,e,{enumerable:!0,get:function(){return T9[e]}})});var R9=Vse();Object.keys(R9).forEach(function(e){e==="default"||e==="__esModule"||e in $o&&$o[e]===R9[e]||Object.defineProperty($o,e,{enumerable:!0,get:function(){return R9[e]}})});var E9=tle();Object.keys(E9).forEach(function(e){e==="default"||e==="__esModule"||e in $o&&$o[e]===E9[e]||Object.defineProperty($o,e,{enumerable:!0,get:function(){return E9[e]}})});var P9=nle();Object.keys(P9).forEach(function(e){e==="default"||e==="__esModule"||e in $o&&$o[e]===P9[e]||Object.defineProperty($o,e,{enumerable:!0,get:function(){return P9[e]}})})});var ile=T(mD=>{p();Object.defineProperty(mD,"__esModule",{value:!0});mD.LoggerAdapter=void 0;var pD=HW(),L4r=mD.LoggerAdapter=function(){function e(){this.correlationId=""}return e.prototype.sendTraceTag=function(r,t,n,a){pD.NativeServices.Logger.sendTraceTag(r,n,a)},e.prototype.shipAssertTag=function(r,t,n,a){n||pD.NativeServices.Logger.shipAssertTag(r,n,new Error(a).stack)},e.prototype.debugAssertTag=function(r,t,n,a){n||pD.NativeServices.Logger.debugAssertTag(r,n,new Error(a).stack)},e.prototype.setCorrelationId=function(r){this.correlationId=r,pD.NativeServices.Logger.setCorrelationId(r)},e}()});var ole=T(Lk=>{p();Object.defineProperty(Lk,"__esModule",{value:!0});var A9=ile();Object.keys(A9).forEach(function(e){e==="default"||e==="__esModule"||e in Lk&&Lk[e]===A9[e]||Object.defineProperty(Lk,e,{enumerable:!0,get:function(){return A9[e]}})})});var i0=T(Sl=>{p();Object.defineProperty(Sl,"__esModule",{value:!0});var F9=rse();Object.keys(F9).forEach(function(e){e==="default"||e==="__esModule"||e in Sl&&Sl[e]===F9[e]||Object.defineProperty(Sl,e,{enumerable:!0,get:function(){return F9[e]}})});var N9=ase();Object.keys(N9).forEach(function(e){e==="default"||e==="__esModule"||e in Sl&&Sl[e]===N9[e]||Object.defineProperty(Sl,e,{enumerable:!0,get:function(){return N9[e]}})});var O9=Ose();Object.keys(O9).forEach(function(e){e==="default"||e==="__esModule"||e in Sl&&Sl[e]===O9[e]||Object.defineProperty(Sl,e,{enumerable:!0,get:function(){return O9[e]}})});var k9=ale();Object.keys(k9).forEach(function(e){e==="default"||e==="__esModule"||e in Sl&&Sl[e]===k9[e]||Object.defineProperty(Sl,e,{enumerable:!0,get:function(){return k9[e]}})});var M9=f9();Object.keys(M9).forEach(function(e){e==="default"||e==="__esModule"||e in Sl&&Sl[e]===M9[e]||Object.defineProperty(Sl,e,{enumerable:!0,get:function(){return M9[e]}})});var x9=ole();Object.keys(x9).forEach(function(e){e==="default"||e==="__esModule"||e in Sl&&Sl[e]===x9[e]||Object.defineProperty(Sl,e,{enumerable:!0,get:function(){return x9[e]}})})});var I9=T(sP=>{p();Object.defineProperty(sP,"__esModule",{value:!0});sP.nameOfEvent=sP.UxppEvent=void 0;var qKe=i0(),j4r=sP.UxppEvent=function(){function e(r,t){this.serviceInfo=r,this.eventName=t,this.handlers=new Map}return e.prototype.subscribe=function(r){var t=new GKe(this);return this.handlers.set(t,r),t},e.prototype.unsubscribe=function(r){this.handlers.delete(r)},e.prototype.unsubscribeAll=function(){this.handlers.clear()},e.prototype.trigger=function(r){qKe.UxppRekaServiceManagerNativeServices.UxppRekaServiceManager.raiseEvent(this.serviceInfo[0],this.eventName,JSON.stringify([r])),this.handlers.forEach(function(t,n){return t(r,n)})},e}(),W4r=sP.nameOfEvent=function(r){return r},GKe=function(){function e(r){this.event=r}return e.prototype.unsubscribe=function(){this.event.unsubscribe(this)},e}()});var w9=T(gD=>{p();Object.defineProperty(gD,"__esModule",{value:!0});gD.UxppPowerOptionsJsDataService=void 0;var BKe=i0(),ule=I9(),Q4r=gD.UxppPowerOptionsJsDataService=function(){function e(){this.onTestEvent=new ule.UxppEvent(e.ServiceInfo,(0,ule.nameOfEvent)("onTestEvent"))}return e.prototype.simulateTestEvent=function(r){return console.log("Raising Test Event: ",r),this.onTestEvent.trigger(r),Promise.resolve("Event Raised")},e.ServiceInfo=BKe.UxppPowerOptionsJsServiceServiceInfos.UxppPowerOptionsJsService,e}()});var lle=T((J4r,sle)=>{p();sle.exports=OfficePlatformGlobal.ReactNativeReka});var cle=T(D9=>{p();Object.defineProperty(D9,"__esModule",{value:!0});D9.initHeadlessUxpp=HKe;var vD=fe(),U_=i0(),hD=JS(),UKe=rl(),KKe=od(),VKe=w1(),jKe=w9();function WKe(e){return(0,vD.__awaiter)(this,void 0,void 0,function(){var r,t,n,a,o,u=this;return(0,vD.__generator)(this,function(s){switch(s.label){case 0:return r=e.headlessApps.filter(function(l){return l.services!==void 0}).flatMap(function(l){return l.services}),r.push(jKe.UxppPowerOptionsJsDataService),t=[],n={logger:new U_.LoggerAdapter,registerServiceInstances:function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];t.push.apply(t,c)}},[4,Promise.resolve().then(()=>NV(lle()))];case 1:return a=s.sent(),a.initReka.apply(a,r),(0,KKe.initializeLogger)(n.logger),(0,U_.initializeTelemetry)(),[4,(0,U_.initializeGates)()];case 2:return s.sent(),o=e.headlessApps.map(function(l){return(0,vD.__awaiter)(u,void 0,void 0,function(){var c,d;return(0,vD.__generator)(this,function(f){switch(f.label){case 0:return c=typeof l.enableOption=="function"?l.enableOption():l.enableOption,c?[4,l.importModule()]:[2];case 1:return d=f.sent(),[4,d.default(n)];case 2:return f.sent(),[2]}})})}),[4,Promise.all(o)];case 3:return s.sent(),t.forEach(function(l){return UKe.RekaInstance.registerServiceInstance(l)}),[4,U_.UxppRekaServiceManagerNativeServices.UxppRekaServiceManager.registerServices(t.concat(r).map(function(l){return l.ServiceInfo[0]}))];case 4:return s.sent(),console.log("Uxpp headless started"),U_.UxppRekaServiceManagerNativeServices.UxppRekaServiceManager.indicateStarted(),[2]}})})}function HKe(e){WKe(e).catch(function(r){throw(0,VKe.getTelemetryLogger)().sendTelemetryEvent({eventName:(0,U_.appendToOfficeUxppNamespacePrefix)(U_.PartialEventNameScope.UxppRuntime),dataFields:[(0,hD.makeBooleanDataField)("Headless.Load.Failed",!0)],eventFlags:(0,U_.getFilledEventFlags)(hD.EnumObjects.DataCategories.ProductServiceUsage,hD.EnumObjects.DiagnosticLevel.RequiredServiceData,hD.EnumObjects.SamplingPolicy.CriticalBusinessImpact)}),r})}});var dle=T(qk=>{p();Object.defineProperty(qk,"__esModule",{value:!0});var L9=cle();Object.keys(L9).forEach(function(e){e==="default"||e==="__esModule"||e in qk&&qk[e]===L9[e]||Object.defineProperty(qk,e,{enumerable:!0,get:function(){return L9[e]}})})});var fle=T(Gk=>{p();Object.defineProperty(Gk,"__esModule",{value:!0});var q9=w9();Object.keys(q9).forEach(function(e){e==="default"||e==="__esModule"||e in Gk&&Gk[e]===q9[e]||Object.defineProperty(Gk,e,{enumerable:!0,get:function(){return q9[e]}})})});var mle=T(SD=>{p();Object.defineProperty(SD,"__esModule",{value:!0});SD.PaneLifecycleManager=void 0;var ple=i0(),zKe=od(),i6r=SD.PaneLifecycleManager=function(){function e(r){var t=this;this.logger=r,this.registeredOnClosed=[];var n=ple.UxppPaneLifecycleServiceNativeServices.UxppPaneLifecycleService;n.onClose.subscribe(function(a){return t.onClose(a)})}return e.prototype.registerOnClose=function(r){this.registeredOnClosed.push(r)},e.prototype.onClose=function(r){var t=this;this.registeredOnClosed.forEach(function(n){try{n(r)}catch(a){t.logger.sendTraceTag(508703832,zKe.LogCategory.msoulscat_ES_EWAJS,ple.TraceLevel.Error,"PaneLifecycleManager.onClose got error")}})},e}()});var gle=T(K_=>{p();Object.defineProperty(K_,"__esModule",{value:!0});var G9=I9();Object.keys(G9).forEach(function(e){e==="default"||e==="__esModule"||e in K_&&K_[e]===G9[e]||Object.defineProperty(K_,e,{enumerable:!0,get:function(){return G9[e]}})});var B9=mle();Object.keys(B9).forEach(function(e){e==="default"||e==="__esModule"||e in K_&&K_[e]===B9[e]||Object.defineProperty(K_,e,{enumerable:!0,get:function(){return B9[e]}})})});var hle=T(vle=>{p();Object.defineProperty(vle,"__esModule",{value:!0})});var lP=T(os=>{p();Object.defineProperty(os,"__esModule",{value:!0});var U9=pue();Object.keys(U9).forEach(function(e){e==="default"||e==="__esModule"||e in os&&os[e]===U9[e]||Object.defineProperty(os,e,{enumerable:!0,get:function(){return U9[e]}})});var K9=gue();Object.keys(K9).forEach(function(e){e==="default"||e==="__esModule"||e in os&&os[e]===K9[e]||Object.defineProperty(os,e,{enumerable:!0,get:function(){return K9[e]}})});var V9=hue();Object.keys(V9).forEach(function(e){e==="default"||e==="__esModule"||e in os&&os[e]===V9[e]||Object.defineProperty(os,e,{enumerable:!0,get:function(){return V9[e]}})});var j9=dle();Object.keys(j9).forEach(function(e){e==="default"||e==="__esModule"||e in os&&os[e]===j9[e]||Object.defineProperty(os,e,{enumerable:!0,get:function(){return j9[e]}})});var W9=fle();Object.keys(W9).forEach(function(e){e==="default"||e==="__esModule"||e in os&&os[e]===W9[e]||Object.defineProperty(os,e,{enumerable:!0,get:function(){return W9[e]}})});var H9=gle();Object.keys(H9).forEach(function(e){e==="default"||e==="__esModule"||e in os&&os[e]===H9[e]||Object.defineProperty(os,e,{enumerable:!0,get:function(){return H9[e]}})});var z9=hle();Object.keys(z9).forEach(function(e){e==="default"||e==="__esModule"||e in os&&os[e]===z9[e]||Object.defineProperty(os,e,{enumerable:!0,get:function(){return z9[e]}})})});var Sle=T(cP=>{p();Object.defineProperty(cP,"__esModule",{value:!0});cP.AriaTenantToken=cP.AppName=void 0;var m6r=cP.AppName="Excel",g6r=cP.AriaTenantToken="19eb5e37de684ce38ce5cf3d5842d3f7-e8722941-bde5-4b98-9cd5-2775ec51482c-6873"});var Q9=T(yD=>{p();Object.defineProperty(yD,"__esModule",{value:!0});yD.getTypedFeatureGate=void 0;var QKe=mi(),XKe={"Microsoft.Office.Excel.DesktopX10JavascriptDebug":!1,"Microsoft.Office.Excel.DesktopX10UxppEnabled":!1,"Microsoft.Office.Excel.LogFloodgateActivity":!1,"Microsoft.Office.Excel.DesktopX10VPEnabled":!1},S6r=yD.getTypedFeatureGate=(0,QKe.makeGetTypedFeatureGate)(XKe)});var _le=T(dP=>{p();Object.defineProperty(dP,"__esModule",{value:!0});dP.ServiceInfos=dP.NativeServices=void 0;var YKe=rl();function JKe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function yle(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$Ke(n.key),n)}}function ZKe(e,r,t){return r&&yle(e.prototype,r),t&&yle(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ke(e){var r=e4e(e,"string");return typeof r=="symbol"?r:String(r)}function e4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var r4e=dP.ServiceInfos={UxppAnnotationsService:["Uxpp::Internal::RekaServices::UxppAnnotationsService",{registerAnnotationType:["ReturnsPromiseMethod","$any",["$string","$boolean"]],unregisterAnnotationType:["ReturnsPromiseMethod","$any",["$string"]],registerOnClose:["ReturnsPromiseMethod","$any",[]],onNewAnnotation:["Event","Uxpp::Internal::RekaServices::SerializedAnnotation"],onClose:["Event","$string"]}]},b6r=dP.NativeServices=function(){function e(){JKe(this,e)}return ZKe(e,null,[{key:"UxppAnnotationsService",get:function(){return e._UxppAnnotationsService??=YKe.RekaServiceRegistry.getNativeService(r4e.UxppAnnotationsService)}}]),e}()});var Rle=T(bD=>{p();Object.defineProperty(bD,"__esModule",{value:!0});bD.AnnotationsProxy=void 0;var ble=od(),Cle=i0(),_D=_le();function L1(){"use strict";L1=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(C,S,b){C[S]=b.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(C,S,b){return Object.defineProperty(C,S,{value:b,enumerable:!0,configurable:!0,writable:!0}),C[S]}try{c({},"")}catch(C){c=function(b,O,w){return b[O]=w}}function d(C,S,b,O){var w=S&&S.prototype instanceof E?S:E,D=Object.create(w.prototype),Q=new Z(O||[]);return a(D,"_invoke",{value:j(C,b,Q)}),D}function f(C,S,b){try{return{type:"normal",arg:C.call(S,b)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var m="suspendedStart",v="suspendedYield",h="executing",y="completed",_={};function E(){}function N(){}function k(){}var q={};c(q,u,function(){return this});var V=Object.getPrototypeOf,I=V&&V(V(J([])));I&&I!==t&&n.call(I,u)&&(q=I);var M=k.prototype=E.prototype=Object.create(q);function B(C){["next","throw","return"].forEach(function(S){c(C,S,function(b){return this._invoke(S,b)})})}function U(C,S){function b(w,D,Q,W){var $=f(C[w],C,D);if($.type!=="throw"){var me=$.arg,ve=me.value;return ve&&typeof ve=="object"&&n.call(ve,"__await")?S.resolve(ve.__await).then(function(Pe){b("next",Pe,Q,W)},function(Pe){b("throw",Pe,Q,W)}):S.resolve(ve).then(function(Pe){me.value=Pe,Q(me)},function(Pe){return b("throw",Pe,Q,W)})}W($.arg)}var O;a(this,"_invoke",{value:function(D,Q){function W(){return new S(function($,me){b(D,Q,$,me)})}return O=O?O.then(W,W):W()}})}function j(C,S,b){var O=m;return function(w,D){if(O===h)throw new Error("Generator is already running");if(O===y){if(w==="throw")throw D;return{value:e,done:!0}}for(b.method=w,b.arg=D;;){var Q=b.delegate;if(Q){var W=X(Q,b);if(W){if(W===_)continue;return W}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(O===m)throw O=y,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);O=h;var $=f(C,S,b);if($.type==="normal"){if(O=b.done?y:v,$.arg===_)continue;return{value:$.arg,done:b.done}}$.type==="throw"&&(O=y,b.method="throw",b.arg=$.arg)}}}function X(C,S){var b=S.method,O=C.iterator[b];if(O===e)return S.delegate=null,b==="throw"&&C.iterator.return&&(S.method="return",S.arg=e,X(C,S),S.method==="throw")||b!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+b+"' method")),_;var w=f(O,C.iterator,S.arg);if(w.type==="throw")return S.method="throw",S.arg=w.arg,S.delegate=null,_;var D=w.arg;return D?D.done?(S[C.resultName]=D.value,S.next=C.nextLoc,S.method!=="return"&&(S.method="next",S.arg=e),S.delegate=null,_):D:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,_)}function ee(C){var S={tryLoc:C[0]};1 in C&&(S.catchLoc=C[1]),2 in C&&(S.finallyLoc=C[2],S.afterLoc=C[3]),this.tryEntries.push(S)}function re(C){var S=C.completion||{};S.type="normal",delete S.arg,C.completion=S}function Z(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(ee,this),this.reset(!0)}function J(C){if(C||C===""){var S=C[u];if(S)return S.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var b=-1,O=function w(){for(;++b<C.length;)if(n.call(C,b))return w.value=C[b],w.done=!1,w;return w.value=e,w.done=!0,w};return O.next=O}}throw new TypeError(typeof C+" is not iterable")}return N.prototype=k,a(M,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:N,configurable:!0}),N.displayName=c(k,l,"GeneratorFunction"),r.isGeneratorFunction=function(C){var S=typeof C=="function"&&C.constructor;return!!S&&(S===N||(S.displayName||S.name)==="GeneratorFunction")},r.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,k):(C.__proto__=k,c(C,l,"GeneratorFunction")),C.prototype=Object.create(M),C},r.awrap=function(C){return{__await:C}},B(U.prototype),c(U.prototype,s,function(){return this}),r.AsyncIterator=U,r.async=function(C,S,b,O,w){w===void 0&&(w=Promise);var D=new U(d(C,S,b,O),w);return r.isGeneratorFunction(S)?D:D.next().then(function(Q){return Q.done?Q.value:D.next()})},B(M),c(M,l,"Generator"),c(M,u,function(){return this}),c(M,"toString",function(){return"[object Generator]"}),r.keys=function(C){var S=Object(C),b=[];for(var O in S)b.push(O);return b.reverse(),function w(){for(;b.length;){var D=b.pop();if(D in S)return w.value=D,w.done=!1,w}return w.done=!0,w}},r.values=J,Z.prototype={constructor:Z,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(re),!S)for(var b in this)b.charAt(0)==="t"&&n.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=e)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var b=this;function O(me,ve){return Q.type="throw",Q.arg=S,b.next=me,ve&&(b.method="next",b.arg=e),!!ve}for(var w=this.tryEntries.length-1;w>=0;--w){var D=this.tryEntries[w],Q=D.completion;if(D.tryLoc==="root")return O("end");if(D.tryLoc<=this.prev){var W=n.call(D,"catchLoc"),$=n.call(D,"finallyLoc");if(W&&$){if(this.prev<D.catchLoc)return O(D.catchLoc,!0);if(this.prev<D.finallyLoc)return O(D.finallyLoc)}else if(W){if(this.prev<D.catchLoc)return O(D.catchLoc,!0)}else{if(!$)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return O(D.finallyLoc)}}}},abrupt:function(S,b){for(var O=this.tryEntries.length-1;O>=0;--O){var w=this.tryEntries[O];if(w.tryLoc<=this.prev&&n.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var D=w;break}}D&&(S==="break"||S==="continue")&&D.tryLoc<=b&&b<=D.finallyLoc&&(D=null);var Q=D?D.completion:{};return Q.type=S,Q.arg=b,D?(this.method="next",this.next=D.finallyLoc,_):this.complete(Q)},complete:function(S,b){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&b&&(this.next=b),_},finish:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),re(O),_}},catch:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.tryLoc===S){var w=O.completion;if(w.type==="throw"){var D=w.arg;re(O)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(S,b,O){return this.delegate={iterator:J(S),resultName:b,nextLoc:O},this.method==="next"&&(this.arg=e),_}},r}function t4e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Tle(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a4e(n.key),n)}}function n4e(e,r,t){return r&&Tle(e.prototype,r),t&&Tle(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function a4e(e){var r=i4e(e,"string");return typeof r=="symbol"?r:String(r)}function i4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var R6r=bD.AnnotationsProxy=function(){function e(r){var t=this;t4e(this,e),this.registeredValidatedAnnotations=new Map,this.registeredNotValidatedAnnotations=new Map,this.registeredClosedConnection=[],this.logger=r;var n=_D.NativeServices.UxppAnnotationsService;n.onNewAnnotation.subscribe(function(a){return t.onAnnotationArrived(a)}),n.onClose.subscribe(function(a){return t.onClose(a)})}return n4e(e,[{key:"registerAnnotation",value:function(t,n,a){var o;return L1().async(function(s){for(;;)switch(s.prev=s.next){case 0:return o=_D.NativeServices.UxppAnnotationsService,s.next=3,L1().awrap(o.registerAnnotationType(t,n));case 3:n?this.registerAnnotationToMap(t,a,this.registeredValidatedAnnotations):this.registerAnnotationToMap(t,a,this.registeredNotValidatedAnnotations);case 4:case"end":return s.stop()}},null,this,null,Promise)}},{key:"unregisterAnnotation",value:function(t){var n;return L1().async(function(o){for(;;)switch(o.prev=o.next){case 0:return n=_D.NativeServices.UxppAnnotationsService,o.next=3,L1().awrap(n.unregisterAnnotationType(t));case 3:case"end":return o.stop()}},null,null,null,Promise)}},{key:"registerOnClose",value:function(t){var n;return L1().async(function(o){for(;;)switch(o.prev=o.next){case 0:return n=_D.NativeServices.UxppAnnotationsService,o.next=3,L1().awrap(n.registerOnClose());case 3:this.registeredClosedConnection.push(t);case 4:case"end":return o.stop()}},null,this,null,Promise)}},{key:"onClose",value:function(t){var n=this;this.registeredClosedConnection.forEach(function(a){try{a(t)}catch(o){n.logger.sendTraceTag(507593604,ble.LogCategory.msoulscat_ES_EWAJS,Cle.TraceLevel.Error,"AnnotationsProxy.onClose: "+o)}})}},{key:"onAnnotationArrived",value:function(t){t.validated?this.invokeAnnotationCallbacks(t,this.registeredValidatedAnnotations):this.invokeAnnotationCallbacks(t,this.registeredNotValidatedAnnotations)}},{key:"registerAnnotationToMap",value:function(t,n,a){var o;a.has(t)||a.set(t,[]),(o=a.get(t))==null||o.push(n)}},{key:"invokeAnnotationCallbacks",value:function(t,n){var a,o=this,u=(a=n.get(t.annotationType))!=null?a:[];u.forEach(function(s){try{s(t)}catch(l){o.logger.sendTraceTag(507593603,ble.LogCategory.msoulscat_ES_EWAJS,Cle.TraceLevel.Error,"AnnotationsProxy.invokeAnnotationCallbacks: "+l)}})}}]),e}()});var Bk=T(ag=>{p();Object.defineProperty(ag,"__esModule",{value:!0});ag.nativeNamespace=ag.OperationType=ag.AnnotationType_TableLintColumnAnnotation=ag.AnnotationType_ExcelCleanData_ResolverAnnotation=ag.AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation=void 0;var A6r=ag.nativeNamespace="Uxpp.Internal.RekaServices",F6r=ag.OperationType=function(e){return e[e.Invalid=-1]="Invalid",e[e.Add=0]="Add",e[e.Move=1]="Move",e[e.UpdateAnnotationMetaData=2]="UpdateAnnotationMetaData",e[e.Update=3]="Update",e[e.Delete=4]="Delete",e[e.Purge=5]="Purge",e[e.Focus=6]="Focus",e[e.Visibility=7]="Visibility",e}({}),N6r=ag.AnnotationType_TableLintColumnAnnotation="AugLoop_Tablelint_TableLintColumnAnnotation",O6r=ag.AnnotationType_ExcelCleanData_ResolverAnnotation="AugLoop_ExcelCleanData_CleanDataResolverAnnotation",k6r=ag.AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation="AugLoop_ExcelCleanData_ExtraSpacesTableAnnotation"});var Ele=T(fP=>{p();Object.defineProperty(fP,"__esModule",{value:!0});Object.defineProperty(fP,"AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation",{enumerable:!0,get:function(){return CD.AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation}});Object.defineProperty(fP,"AnnotationType_ExcelCleanData_ResolverAnnotation",{enumerable:!0,get:function(){return CD.AnnotationType_ExcelCleanData_ResolverAnnotation}});Object.defineProperty(fP,"AnnotationType_TableLintColumnAnnotation",{enumerable:!0,get:function(){return CD.AnnotationType_TableLintColumnAnnotation}});Object.defineProperty(fP,"OperationType",{enumerable:!0,get:function(){return CD.OperationType}});var o4e=rl(),CD=Bk();o4e.CustomTypeRegistry.registerTypeInfos({"Uxpp::Internal::RekaServices::SerializedAnnotation":{serializedData:"$string",annotationType:"$string",operationType:"$number",validated:"$boolean"}})});var Ale=T(pP=>{p();Object.defineProperty(pP,"__esModule",{value:!0});pP.ServiceInfos=pP.NativeServices=void 0;var u4e=rl();function s4e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ple(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c4e(n.key),n)}}function l4e(e,r,t){return r&&Ple(e.prototype,r),t&&Ple(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function c4e(e){var r=d4e(e,"string");return typeof r=="symbol"?r:String(r)}function d4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var f4e=pP.ServiceInfos={DataCleansingAnnotationsService:["Uxpp::Internal::RekaServices::DataCleansingAnnotationsService",{getAnnotationList:["ReturnsPromiseMethod",["$array","Uxpp::Internal::RekaServices::SerializedAnnotation"],[]],onNewAnnotationList:["Event",["$array","Uxpp::Internal::RekaServices::SerializedAnnotation"]]}]},D6r=pP.NativeServices=function(){function e(){s4e(this,e)}return l4e(e,null,[{key:"DataCleansingAnnotationsService",get:function(){return e._DataCleansingAnnotationsService??=u4e.RekaServiceRegistry.getNativeService(f4e.DataCleansingAnnotationsService)}}]),e}()});var Nle=T(Fle=>{p();Object.defineProperty(Fle,"__esModule",{value:!0})});var kle=T(TD=>{p();Object.defineProperty(TD,"__esModule",{value:!0});TD.AnnotationState=void 0;var Ole;(function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"})(Ole||(TD.AnnotationState=Ole={}))});var xle=T(Mle=>{p();Object.defineProperty(Mle,"__esModule",{value:!0})});var qle=T(o0=>{p();Object.defineProperty(o0,"__esModule",{value:!0});o0.OperationErrorCode=o0.ItemOperation=o0.ItemChanges=o0.EntryPoint=void 0;var Ile;(function(e){e.Canvas="Canvas",e.CopilotChat="CopilotChat",e.Test="Test"})(Ile||(o0.EntryPoint=Ile={}));var wle;(function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Updated=2]="Updated",e[e.Deleted=3]="Deleted"})(wle||(o0.ItemOperation=wle={}));var Dle;(function(e){e[e.ContentChanged=0]="ContentChanged",e[e.ContentWasEmpty=1]="ContentWasEmpty",e[e.FormattingChanged=2]="FormattingChanged",e[e.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"})(Dle||(o0.ItemChanges=Dle={}));var Lle;(function(e){e[e.AddOfZeroElements=0]="AddOfZeroElements",e[e.AddOfItemsWithExtraOrMissingIds=1]="AddOfItemsWithExtraOrMissingIds",e[e.AddOfItemWithUndefinedId=2]="AddOfItemWithUndefinedId",e[e.AddOfUndefinedItem=3]="AddOfUndefinedItem",e[e.AddOfItemsWithDuplicateIds=4]="AddOfItemsWithDuplicateIds",e[e.SetHeadToNonExistingItem=5]="SetHeadToNonExistingItem",e[e.DeleteOfNonExistingItem=6]="DeleteOfNonExistingItem",e[e.UpdateOfNonExistentItem=7]="UpdateOfNonExistentItem",e[e.UpdateOfStubbedItem=8]="UpdateOfStubbedItem",e[e.MoveOfNonExistentItem=9]="MoveOfNonExistentItem",e[e.UpdateMetaDataOfNonAnnotationType=10]="UpdateMetaDataOfNonAnnotationType",e[e.SequentialyInvertedUpdate=11]="SequentialyInvertedUpdate",e[e.MoveToTheSamePath=12]="MoveToTheSamePath",e[e.UnknownOperation=13]="UnknownOperation",e[e.DeltaOfNonExistingItem=100]="DeltaOfNonExistingItem"})(Lle||(o0.OperationErrorCode=Lle={}))});var Ble=T(Gle=>{p();Object.defineProperty(Gle,"__esModule",{value:!0})});var Kle=T(Ule=>{p();Object.defineProperty(Ule,"__esModule",{value:!0})});var jle=T(Vle=>{p();Object.defineProperty(Vle,"__esModule",{value:!0})});var Qle=T(ig=>{p();Object.defineProperty(ig,"__esModule",{value:!0});ig.ecsMetadataBlockWidth=ig.ecsMetadataBlockHeight=ig.OpenType=ig.GridConstants=ig.BlobRefType=void 0;function Wle(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m4e(n.key),n)}}function p4e(e,r,t){return r&&Wle(e.prototype,r),t&&Wle(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function m4e(e){var r=g4e(e,"string");return typeof r=="symbol"?r:String(r)}function g4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function v4e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var $6r=ig.ecsMetadataBlockHeight=512,e5r=ig.ecsMetadataBlockWidth=32,Hle;(function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation",e[e.Token=3]="Token"})(Hle||(ig.BlobRefType=Hle={}));var zle;(function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"})(zle||(ig.OpenType=zle={}));var Uk=ig.GridConstants=p4e(function e(){v4e(this,e)});Uk.lowerIndexBound=1;Uk.maxNumberOfRows=1048576;Uk.maxNumberOfColumns=16384;Uk.firstColumnName="A";Uk.lastColumnName="XFD"});var Yle=T(RD=>{p();Object.defineProperty(RD,"__esModule",{value:!0});RD.WorkflowErrorCode=void 0;var Xle;(function(e){e[e.LambdaExecutionUnhandledError=0]="LambdaExecutionUnhandledError",e[e.LambdaExecutionError=1]="LambdaExecutionError",e[e.WorkflowExecutionTimeout=2]="WorkflowExecutionTimeout",e[e.NetworkError=3]="NetworkError",e[e.SignalNotGotToExecution=4]="SignalNotGotToExecution",e[e.RequestTruncated=5]="RequestTruncated",e[e.WorkflowWrongAnnotationType=6]="WorkflowWrongAnnotationType",e[e.SequenceOutOfOrder=7]="SequenceOutOfOrder",e[e.WorkflowExecutionThrottled=8]="WorkflowExecutionThrottled",e[e.WorkflowExecutionCancelled=9]="WorkflowExecutionCancelled",e[e.NetworkTimeoutOrWorkflowIsBusy=10]="NetworkTimeoutOrWorkflowIsBusy",e[e.RequiredTokenNotAvailable=11]="RequiredTokenNotAvailable",e[e.InvalidInputQuantityForSingleItemWorkflow=12]="InvalidInputQuantityForSingleItemWorkflow",e[e.ExceededRequestSizeLimit=13]="ExceededRequestSizeLimit",e[e.UnknownAnnotationParent=14]="UnknownAnnotationParent",e[e.AnnotationsNotArray=15]="AnnotationsNotArray",e[e.UnexpectedOutput=16]="UnexpectedOutput",e[e.MixedOutput=17]="MixedOutput",e[e.OutputIsNotAnnotation=18]="OutputIsNotAnnotation",e[e.UnexpectedError=19]="UnexpectedError"})(Xle||(RD.WorkflowErrorCode=Xle={}))});var V_=T(ED=>{p();Object.defineProperty(ED,"__esModule",{value:!0});ED.SchemaObject=void 0;function h4e(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=Zle(e))||r&&e&&typeof e.length=="number"){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S4e(e){return b4e(e)||_4e(e)||Zle(e)||y4e()}function y4e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Zle(e,r){if(e){if(typeof e=="string")return Y9(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Y9(e,r)}}function _4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function b4e(e){if(Array.isArray(e))return Y9(e)}function Y9(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function C4e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Jle(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R4e(n.key),n)}}function T4e(e,r,t){return r&&Jle(e.prototype,r),t&&Jle(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function R4e(e){var r=E4e(e,"string");return typeof r=="symbol"?r:String(r)}function E4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var X9=ED.SchemaObject=function(){function e(r){C4e(this,e),e.assign(e,this,r)}return T4e(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_SchemaObject"}},{key:"getBaseTypes",value:function(){return[]}},{key:"getTypeNameFor",value:function(t){return t&&t.H_?t.H_.T_:void 0}},{key:"getBaseTypesFor",value:function(t){return t&&t.H_&&t.H_.B_?t.H_.B_:[]}},{key:"getAllTypesFor",value:function(t){var n=e.getTypeNameFor(t);return n?[n].concat(S4e(e.getBaseTypesFor(t))):[]}},{key:"matchesTypesFor",value:function(t,n){if(!Array.isArray(n)||n.length===0)return!0;for(var a=e.getTypeNameFor(t),o=e.getBaseTypesFor(t),u=h4e(n),s;!(s=u()).done;){var l=s.value;if(l===a||o.indexOf(l)>=0)return!0}return!1}},{key:"assign",value:function(t,n,a){if(a)for(var o=0,u=Object.keys(a);o<u.length;o++){var s=u[o];n[s]=a[s]}return n.H_=t.H_,n}}]),e}();X9.H_={T_:X9.getTypeName(),B_:X9.getBaseTypes()}});var ece=T(j_=>{p();Object.defineProperty(j_,"__esModule",{value:!0});j_.StreamAnnotation=j_.BinaryClassificationAnnotation=j_.Annotation=void 0;var mP=V_();function e8(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function $le(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P4e(n.key),n)}}function r8(e,r,t){return r&&$le(e.prototype,r),t&&$le(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function P4e(e){var r=A4e(e,"string");return typeof r=="symbol"?r:String(r)}function A4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var J9=j_.Annotation=function(){function e(r){e8(this,e),mP.SchemaObject.assign(e,this,r)}return r8(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_Core_Annotation"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return mP.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();J9.H_={T_:J9.getTypeName(),B_:J9.getBaseTypes()};var Z9=j_.BinaryClassificationAnnotation=function(){function e(r){e8(this,e),mP.SchemaObject.assign(e,this,r)}return r8(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_Core_BinaryClassificationAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return mP.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();Z9.H_={T_:Z9.getTypeName(),B_:Z9.getBaseTypes()};var $9=j_.StreamAnnotation=function(){function e(r){e8(this,e),mP.SchemaObject.assign(e,this,r)}return r8(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_Core_StreamAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return mP.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();$9.H_={T_:$9.getTypeName(),B_:$9.getBaseTypes()}});var ace=T(gP=>{p();Object.defineProperty(gP,"__esModule",{value:!0});gP.UserCommand=gP.Event=void 0;var PD=V_();function tce(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function rce(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F4e(n.key),n)}}function nce(e,r,t){return r&&rce(e.prototype,r),t&&rce(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function F4e(e){var r=N4e(e,"string");return typeof r=="symbol"?r:String(r)}function N4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var t8=gP.Event=function(){function e(r){tce(this,e),PD.SchemaObject.assign(e,this,r)}return nce(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Event"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return PD.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();t8.H_={T_:t8.getTypeName(),B_:t8.getBaseTypes()};var n8=gP.UserCommand=function(){function e(r){tce(this,e),PD.SchemaObject.assign(e,this,r)}return nce(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_UserCommand"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Event"]}},{key:"typeGuard",value:function(t){return PD.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();n8.H_={T_:n8.getTypeName(),B_:n8.getBaseTypes()}});var oce=T(Ha=>{p();Object.defineProperty(Ha,"__esModule",{value:!0});Ha.VisibilityOperation=Ha.UpdateOperation=Ha.UpdateAnnotationMetaDataOperation=Ha.SignalOperation=Ha.PurgeSubtreeOperation=Ha.PurgeOperation=Ha.PurgeByTypesOperation=Ha.OperationWithSiblingContext=Ha.Operation=Ha.MoveOperation=Ha.MicroSyncOperation=Ha.ItemDelta=Ha.ItemChangesDelta=Ha.FocusOperation=Ha.DeltaUpdateOperation=Ha.DeleteOperation=Ha.AddOperation=void 0;var ii=V_();function ud(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function ice(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O4e(n.key),n)}}function sd(e,r,t){return r&&ice(e.prototype,r),t&&ice(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function O4e(e){var r=k4e(e,"string");return typeof r=="symbol"?r:String(r)}function k4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var a8=Ha.ItemDelta=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_ItemDelta"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();a8.H_={T_:a8.getTypeName(),B_:a8.getBaseTypes()};var i8=Ha.ItemChangesDelta=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_ItemChangesDelta"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_ItemDelta"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();i8.H_={T_:i8.getTypeName(),B_:i8.getBaseTypes()};var o8=Ha.Operation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Operation"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();o8.H_={T_:o8.getTypeName(),B_:o8.getBaseTypes()};var u8=Ha.OperationWithSiblingContext=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_OperationWithSiblingContext"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();u8.H_={T_:u8.getTypeName(),B_:u8.getBaseTypes()};var s8=Ha.AddOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_AddOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();s8.H_={T_:s8.getTypeName(),B_:s8.getBaseTypes()};var l8=Ha.MoveOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_MoveOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();l8.H_={T_:l8.getTypeName(),B_:l8.getBaseTypes()};var c8=Ha.UpdateAnnotationMetaDataOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();c8.H_={T_:c8.getTypeName(),B_:c8.getBaseTypes()};var d8=Ha.UpdateOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_UpdateOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();d8.H_={T_:d8.getTypeName(),B_:d8.getBaseTypes()};var f8=Ha.DeleteOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_DeleteOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();f8.H_={T_:f8.getTypeName(),B_:f8.getBaseTypes()};var p8=Ha.PurgeOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_PurgeOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();p8.H_={T_:p8.getTypeName(),B_:p8.getBaseTypes()};var m8=Ha.PurgeSubtreeOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_PurgeSubtreeOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();m8.H_={T_:m8.getTypeName(),B_:m8.getBaseTypes()};var g8=Ha.PurgeByTypesOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_PurgeByTypesOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();g8.H_={T_:g8.getTypeName(),B_:g8.getBaseTypes()};var v8=Ha.FocusOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_FocusOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();v8.H_={T_:v8.getTypeName(),B_:v8.getBaseTypes()};var h8=Ha.VisibilityOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_VisibilityOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();h8.H_={T_:h8.getTypeName(),B_:h8.getBaseTypes()};var S8=Ha.DeltaUpdateOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_DeltaUpdateOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();S8.H_={T_:S8.getTypeName(),B_:S8.getBaseTypes()};var y8=Ha.MicroSyncOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_MicroSyncOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();y8.H_={T_:y8.getTypeName(),B_:y8.getBaseTypes()};var _8=Ha.SignalOperation=function(){function e(r){ud(this,e),ii.SchemaObject.assign(e,this,r)}return sd(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Signals_SignalOperation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Operation"]}},{key:"typeGuard",value:function(t){return ii.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();_8.H_={T_:_8.getTypeName(),B_:_8.getBaseTypes()}});var sce=T(W_=>{p();Object.defineProperty(W_,"__esModule",{value:!0});W_.Signal=W_.DirtyDocumentSignal=W_.DirtyAreaSignal=void 0;var vP=V_();function R8(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function uce(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M4e(n.key),n)}}function E8(e,r,t){return r&&uce(e.prototype,r),t&&uce(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function M4e(e){var r=x4e(e,"string");return typeof r=="symbol"?r:String(r)}function x4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var b8=W_.Signal=function(){function e(r){R8(this,e),vP.SchemaObject.assign(e,this,r)}return E8(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Signals_Signal"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return vP.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();b8.H_={T_:b8.getTypeName(),B_:b8.getBaseTypes()};var C8=W_.DirtyAreaSignal=function(){function e(r){R8(this,e),vP.SchemaObject.assign(e,this,r)}return E8(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_DirtyAreaSignal"}},{key:"getBaseTypes",value:function(){return["AugLoop_Signals_Signal"]}},{key:"typeGuard",value:function(t){return vP.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();C8.H_={T_:C8.getTypeName(),B_:C8.getBaseTypes()};var T8=W_.DirtyDocumentSignal=function(){function e(r){R8(this,e),vP.SchemaObject.assign(e,this,r)}return E8(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_DirtyDocumentSignal"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}},{key:"typeGuard",value:function(t){return vP.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();T8.H_={T_:T8.getTypeName(),B_:T8.getBaseTypes()}});var cce=T(Ti=>{p();Object.defineProperty(Ti,"__esModule",{value:!0});Ti.UserContextHolder=Ti.UserCommandsHolder=Ti.TileGroup=Ti.TenantContextHolder=Ti.SubDocument=Ti.Session=Ti.ItemFilter=Ti.GridNeighborhoodContext=Ti.GridCell=Ti.EventsHolder=Ti.DynamicContext=Ti.Document=Ti.ContextHolder=Ti.Blob=Ti.Binary=void 0;var Xi=V_();function Bf(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function lce(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I4e(n.key),n)}}function Uf(e,r,t){return r&&lce(e.prototype,r),t&&lce(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function I4e(e){var r=w4e(e,"string");return typeof r=="symbol"?r:String(r)}function w4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var P8=Ti.Blob=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Blob"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();P8.H_={T_:P8.getTypeName(),B_:P8.getBaseTypes()};var A8=Ti.Binary=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Binary"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();A8.H_={T_:A8.getTypeName(),B_:A8.getBaseTypes()};var F8=Ti.TileGroup=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_TileGroup"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();F8.H_={T_:F8.getTypeName(),B_:F8.getBaseTypes()};var N8=Ti.Session=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Session"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_TileGroup"]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();N8.H_={T_:N8.getTypeName(),B_:N8.getBaseTypes()};var O8=Ti.Document=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_Document"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_TileGroup"]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();O8.H_={T_:O8.getTypeName(),B_:O8.getBaseTypes()};var k8=Ti.SubDocument=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_SubDocument"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();k8.H_={T_:k8.getTypeName(),B_:k8.getBaseTypes()};var M8=Ti.GridCell=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_GridCell"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();M8.H_={T_:M8.getTypeName(),B_:M8.getBaseTypes()};var x8=Ti.GridNeighborhoodContext=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_GridNeighborhoodContext"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();x8.H_={T_:x8.getTypeName(),B_:x8.getBaseTypes()};var I8=Ti.ItemFilter=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_ItemFilter"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();I8.H_={T_:I8.getTypeName(),B_:I8.getBaseTypes()};var w8=Ti.DynamicContext=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_DynamicContext"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();w8.H_={T_:w8.getTypeName(),B_:w8.getBaseTypes()};var D8=Ti.ContextHolder=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_ContextHolder"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();D8.H_={T_:D8.getTypeName(),B_:D8.getBaseTypes()};var L8=Ti.UserContextHolder=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_UserContextHolder"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_ContextHolder"]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();L8.H_={T_:L8.getTypeName(),B_:L8.getBaseTypes()};var q8=Ti.TenantContextHolder=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_TenantContextHolder"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_ContextHolder"]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();q8.H_={T_:q8.getTypeName(),B_:q8.getBaseTypes()};var G8=Ti.EventsHolder=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_EventsHolder"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();G8.H_={T_:G8.getTypeName(),B_:G8.getBaseTypes()};var B8=Ti.UserCommandsHolder=function(){function e(r){Bf(this,e),Xi.SchemaObject.assign(e,this,r)}return Uf(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Core_UserCommandsHolder"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_EventsHolder"]}},{key:"typeGuard",value:function(t){return Xi.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();B8.H_={T_:B8.getTypeName(),B_:B8.getBaseTypes()}});var mce=T(hP=>{p();Object.defineProperty(hP,"__esModule",{value:!0});hP.SecondaryApology=hP.Apology=void 0;var AD=V_();function fce(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function dce(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D4e(n.key),n)}}function pce(e,r,t){return r&&dce(e.prototype,r),t&&dce(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function D4e(e){var r=L4e(e,"string");return typeof r=="symbol"?r:String(r)}function L4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var U8=hP.Apology=function(){function e(r){fce(this,e),AD.SchemaObject.assign(e,this,r)}return pce(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_Core_Apology"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return AD.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();U8.H_={T_:U8.getTypeName(),B_:U8.getBaseTypes()};var K8=hP.SecondaryApology=function(){function e(r){fce(this,e),AD.SchemaObject.assign(e,this,r)}return pce(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_Core_SecondaryApology"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return AD.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();K8.H_={T_:K8.getTypeName(),B_:K8.getBaseTypes()}});var ZS=T(Cn=>{p();Object.defineProperty(Cn,"__esModule",{value:!0});var _p={OperationErrorCode:!0,ItemOperation:!0,ItemChanges:!0,EntryPoint:!0};Object.defineProperty(Cn,"EntryPoint",{enumerable:!0,get:function(){return FD.EntryPoint}});Object.defineProperty(Cn,"ItemChanges",{enumerable:!0,get:function(){return FD.ItemChanges}});Object.defineProperty(Cn,"ItemOperation",{enumerable:!0,get:function(){return FD.ItemOperation}});Object.defineProperty(Cn,"OperationErrorCode",{enumerable:!0,get:function(){return FD.OperationErrorCode}});var V8=kle();Object.keys(V8).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===V8[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return V8[e]}})});var j8=xle();Object.keys(j8).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===j8[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return j8[e]}})});var FD=qle(),W8=Ble();Object.keys(W8).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===W8[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return W8[e]}})});var H8=Kle();Object.keys(H8).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===H8[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return H8[e]}})});var z8=jle();Object.keys(z8).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===z8[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return z8[e]}})});var Q8=Qle();Object.keys(Q8).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===Q8[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return Q8[e]}})});var X8=Yle();Object.keys(X8).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===X8[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return X8[e]}})});var Y8=ece();Object.keys(Y8).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===Y8[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return Y8[e]}})});var J8=ace();Object.keys(J8).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===J8[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return J8[e]}})});var Z8=oce();Object.keys(Z8).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===Z8[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return Z8[e]}})});var $8=V_();Object.keys($8).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===$8[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return $8[e]}})});var eH=sce();Object.keys(eH).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===eH[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return eH[e]}})});var rH=cce();Object.keys(rH).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===rH[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return rH[e]}})});var tH=mce();Object.keys(tH).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(_p,e)||e in Cn&&Cn[e]===tH[e]||Object.defineProperty(Cn,e,{enumerable:!0,get:function(){return tH[e]}})})});var vce=T(yl=>{p();Object.defineProperty(yl,"__esModule",{value:!0});yl.TableLintWorksheetAggregateAnnotation=yl.TableLintTextInconsistencySuggestion=yl.TableLintSuggestion=yl.TableLintNumberFormattingInconsistencySuggestion=yl.TableLintExtraSpacesSuggestion=yl.TableLintDateFormatSuggestion=yl.TableLintColumnAnnotation=yl.TableLintAnnotationBase=yl.TableLintAnnotation=void 0;var Cc=ZS();function $S(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function gce(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q4e(n.key),n)}}function ey(e,r,t){return r&&gce(e.prototype,r),t&&gce(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function q4e(e){var r=G4e(e,"string");return typeof r=="symbol"?r:String(r)}function G4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var nH=yl.TableLintAnnotationBase=function(){function e(r){$S(this,e),Cc.SchemaObject.assign(e,this,r)}return ey(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintAnnotationBase"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return Cc.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();nH.H_={T_:nH.getTypeName(),B_:nH.getBaseTypes()};var aH=yl.TableLintAnnotation=function(){function e(r){$S(this,e),Cc.SchemaObject.assign(e,this,r)}return ey(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return Cc.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();aH.H_={T_:aH.getTypeName(),B_:aH.getBaseTypes()};var iH=yl.TableLintColumnAnnotation=function(){function e(r){$S(this,e),Cc.SchemaObject.assign(e,this,r)}return ey(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return Cc.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();iH.H_={T_:iH.getTypeName(),B_:iH.getBaseTypes()};var oH=yl.TableLintWorksheetAggregateAnnotation=function(){function e(r){$S(this,e),Cc.SchemaObject.assign(e,this,r)}return ey(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return Cc.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();oH.H_={T_:oH.getTypeName(),B_:oH.getBaseTypes()};var uH=yl.TableLintSuggestion=function(){function e(r){$S(this,e),Cc.SchemaObject.assign(e,this,r)}return ey(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintSuggestion"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return Cc.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();uH.H_={T_:uH.getTypeName(),B_:uH.getBaseTypes()};var sH=yl.TableLintTextInconsistencySuggestion=function(){function e(r){$S(this,e),Cc.SchemaObject.assign(e,this,r)}return ey(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintTextInconsistencySuggestion"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintSuggestion"]}},{key:"typeGuard",value:function(t){return Cc.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();sH.H_={T_:sH.getTypeName(),B_:sH.getBaseTypes()};var lH=yl.TableLintNumberFormattingInconsistencySuggestion=function(){function e(r){$S(this,e),Cc.SchemaObject.assign(e,this,r)}return ey(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintNumberFormattingInconsistencySuggestion"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintSuggestion"]}},{key:"typeGuard",value:function(t){return Cc.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();lH.H_={T_:lH.getTypeName(),B_:lH.getBaseTypes()};var cH=yl.TableLintDateFormatSuggestion=function(){function e(r){$S(this,e),Cc.SchemaObject.assign(e,this,r)}return ey(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintDateFormatSuggestion"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintSuggestion"]}},{key:"typeGuard",value:function(t){return Cc.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();cH.H_={T_:cH.getTypeName(),B_:cH.getBaseTypes()};var dH=yl.TableLintExtraSpacesSuggestion=function(){function e(r){$S(this,e),Cc.SchemaObject.assign(e,this,r)}return ey(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintExtraSpacesSuggestion"}},{key:"getBaseTypes",value:function(){return["AugLoop_Tablelint_TableLintSuggestion"]}},{key:"typeGuard",value:function(t){return Cc.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();dH.H_={T_:dH.getTypeName(),B_:dH.getBaseTypes()}});var yce=T(ND=>{p();Object.defineProperty(ND,"__esModule",{value:!0});ND.TableLintLogMetric=void 0;var hce=ZS();function B4e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Sce(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K4e(n.key),n)}}function U4e(e,r,t){return r&&Sce(e.prototype,r),t&&Sce(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function K4e(e){var r=V4e(e,"string");return typeof r=="symbol"?r:String(r)}function V4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var fH=ND.TableLintLogMetric=function(){function e(r){B4e(this,e),hce.SchemaObject.assign(e,this,r)}return U4e(e,null,[{key:"getTypeName",value:function(){return"AugLoop_Tablelint_TableLintLogMetric"}},{key:"getBaseTypes",value:function(){return[]}},{key:"typeGuard",value:function(t){return hce.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();fH.H_={T_:fH.getTypeName(),B_:fH.getBaseTypes()}});var Kk=T(Qv=>{p();Object.defineProperty(Qv,"__esModule",{value:!0});var pH=Nle();Object.keys(pH).forEach(function(e){e==="default"||e==="__esModule"||e in Qv&&Qv[e]===pH[e]||Object.defineProperty(Qv,e,{enumerable:!0,get:function(){return pH[e]}})});var mH=vce();Object.keys(mH).forEach(function(e){e==="default"||e==="__esModule"||e in Qv&&Qv[e]===mH[e]||Object.defineProperty(Qv,e,{enumerable:!0,get:function(){return mH[e]}})});var gH=yce();Object.keys(gH).forEach(function(e){e==="default"||e==="__esModule"||e in Qv&&Qv[e]===gH[e]||Object.defineProperty(Qv,e,{enumerable:!0,get:function(){return gH[e]}})})});var bce=T(_ce=>{p();Object.defineProperty(_ce,"__esModule",{value:!0})});var Ece=T(SP=>{p();Object.defineProperty(SP,"__esModule",{value:!0});SP.RowsIdentityAnnotation=SP.DuplicatedRowsAnnotation=void 0;var OD=ZS();function Tce(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Cce(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j4e(n.key),n)}}function Rce(e,r,t){return r&&Cce(e.prototype,r),t&&Cce(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function j4e(e){var r=W4e(e,"string");return typeof r=="symbol"?r:String(r)}function W4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var vH=SP.RowsIdentityAnnotation=function(){function e(r){Tce(this,e),OD.SchemaObject.assign(e,this,r)}return Rce(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_ExcelCleanData_RowsIdentityAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return OD.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();vH.H_={T_:vH.getTypeName(),B_:vH.getBaseTypes()};var hH=SP.DuplicatedRowsAnnotation=function(){function e(r){Tce(this,e),OD.SchemaObject.assign(e,this,r)}return Rce(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_ExcelCleanData_DuplicatedRowsAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return OD.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();hH.H_={T_:hH.getTypeName(),B_:hH.getBaseTypes()}});var Ace=T(Pce=>{p();Object.defineProperty(Pce,"__esModule",{value:!0})});var kce=T(yP=>{p();Object.defineProperty(yP,"__esModule",{value:!0});yP.UnprintableCharactersTableAnnotation=yP.UnprintableCharactersColumnAnnotation=void 0;var kD=ZS();function Nce(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Fce(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H4e(n.key),n)}}function Oce(e,r,t){return r&&Fce(e.prototype,r),t&&Fce(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function H4e(e){var r=z4e(e,"string");return typeof r=="symbol"?r:String(r)}function z4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var SH=yP.UnprintableCharactersColumnAnnotation=function(){function e(r){Nce(this,e),kD.SchemaObject.assign(e,this,r)}return Oce(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_ExcelCleanData_UnprintableCharactersColumnAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return kD.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();SH.H_={T_:SH.getTypeName(),B_:SH.getBaseTypes()};var yH=yP.UnprintableCharactersTableAnnotation=function(){function e(r){Nce(this,e),kD.SchemaObject.assign(e,this,r)}return Oce(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_ExcelCleanData_UnprintableCharactersTableAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return kD.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();yH.H_={T_:yH.getTypeName(),B_:yH.getBaseTypes()}});var xce=T(Mce=>{p();Object.defineProperty(Mce,"__esModule",{value:!0})});var Dce=T(_P=>{p();Object.defineProperty(_P,"__esModule",{value:!0});_P.RepairType=_P.Confidence=void 0;var Ice;(function(e){e[e.PatternRepair=0]="PatternRepair",e[e.NumericOutlier=1]="NumericOutlier"})(Ice||(_P.RepairType=Ice={}));var wce;(function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low"})(wce||(_P.Confidence=wce={}))});var Gce=T(MD=>{p();Object.defineProperty(MD,"__esModule",{value:!0});MD.DataOutlierAnnotation=void 0;var Lce=ZS();function Q4e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function qce(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y4e(n.key),n)}}function X4e(e,r,t){return r&&qce(e.prototype,r),t&&qce(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y4e(e){var r=J4e(e,"string");return typeof r=="symbol"?r:String(r)}function J4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var _H=MD.DataOutlierAnnotation=function(){function e(r){Q4e(this,e),Lce.SchemaObject.assign(e,this,r)}return X4e(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_ExcelCleanData_DataOutlierAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return Lce.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();_H.H_={T_:_H.getTypeName(),B_:_H.getBaseTypes()}});var Uce=T(Bce=>{p();Object.defineProperty(Bce,"__esModule",{value:!0})});var Wce=T(bP=>{p();Object.defineProperty(bP,"__esModule",{value:!0});bP.ExtraSpacesTableAnnotation=bP.ExtraSpacesColumnAnnotation=void 0;var xD=ZS();function Vce(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Kce(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z4e(n.key),n)}}function jce(e,r,t){return r&&Kce(e.prototype,r),t&&Kce(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z4e(e){var r=$4e(e,"string");return typeof r=="symbol"?r:String(r)}function $4e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var bH=bP.ExtraSpacesColumnAnnotation=function(){function e(r){Vce(this,e),xD.SchemaObject.assign(e,this,r)}return jce(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_ExcelCleanData_ExtraSpacesColumnAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return xD.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();bH.H_={T_:bH.getTypeName(),B_:bH.getBaseTypes()};var CH=bP.ExtraSpacesTableAnnotation=function(){function e(r){Vce(this,e),xD.SchemaObject.assign(e,this,r)}return jce(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_ExcelCleanData_ExtraSpacesTableAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return xD.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();CH.H_={T_:CH.getTypeName(),B_:CH.getBaseTypes()}});var zce=T(Hce=>{p();Object.defineProperty(Hce,"__esModule",{value:!0})});var Yce=T(ID=>{p();Object.defineProperty(ID,"__esModule",{value:!0});ID.CleanDataResolverAnnotation=void 0;var Qce=ZS();function e6e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Xce(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t6e(n.key),n)}}function r6e(e,r,t){return r&&Xce(e.prototype,r),t&&Xce(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function t6e(e){var r=n6e(e,"string");return typeof r=="symbol"?r:String(r)}function n6e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var TH=ID.CleanDataResolverAnnotation=function(){function e(r){e6e(this,e),Qce.SchemaObject.assign(e,this,r)}return r6e(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_ExcelCleanData_CleanDataResolverAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return Qce.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();TH.H_={T_:TH.getTypeName(),B_:TH.getBaseTypes()}});var Vk=T(ri=>{p();Object.defineProperty(ri,"__esModule",{value:!0});var RH=bce();Object.keys(RH).forEach(function(e){e==="default"||e==="__esModule"||e in ri&&ri[e]===RH[e]||Object.defineProperty(ri,e,{enumerable:!0,get:function(){return RH[e]}})});var EH=Ece();Object.keys(EH).forEach(function(e){e==="default"||e==="__esModule"||e in ri&&ri[e]===EH[e]||Object.defineProperty(ri,e,{enumerable:!0,get:function(){return EH[e]}})});var PH=Ace();Object.keys(PH).forEach(function(e){e==="default"||e==="__esModule"||e in ri&&ri[e]===PH[e]||Object.defineProperty(ri,e,{enumerable:!0,get:function(){return PH[e]}})});var AH=kce();Object.keys(AH).forEach(function(e){e==="default"||e==="__esModule"||e in ri&&ri[e]===AH[e]||Object.defineProperty(ri,e,{enumerable:!0,get:function(){return AH[e]}})});var FH=xce();Object.keys(FH).forEach(function(e){e==="default"||e==="__esModule"||e in ri&&ri[e]===FH[e]||Object.defineProperty(ri,e,{enumerable:!0,get:function(){return FH[e]}})});var NH=Dce();Object.keys(NH).forEach(function(e){e==="default"||e==="__esModule"||e in ri&&ri[e]===NH[e]||Object.defineProperty(ri,e,{enumerable:!0,get:function(){return NH[e]}})});var OH=Gce();Object.keys(OH).forEach(function(e){e==="default"||e==="__esModule"||e in ri&&ri[e]===OH[e]||Object.defineProperty(ri,e,{enumerable:!0,get:function(){return OH[e]}})});var kH=Uce();Object.keys(kH).forEach(function(e){e==="default"||e==="__esModule"||e in ri&&ri[e]===kH[e]||Object.defineProperty(ri,e,{enumerable:!0,get:function(){return kH[e]}})});var MH=Wce();Object.keys(MH).forEach(function(e){e==="default"||e==="__esModule"||e in ri&&ri[e]===MH[e]||Object.defineProperty(ri,e,{enumerable:!0,get:function(){return MH[e]}})});var xH=zce();Object.keys(xH).forEach(function(e){e==="default"||e==="__esModule"||e in ri&&ri[e]===xH[e]||Object.defineProperty(ri,e,{enumerable:!0,get:function(){return xH[e]}})});var IH=Yce();Object.keys(IH).forEach(function(e){e==="default"||e==="__esModule"||e in ri&&ri[e]===IH[e]||Object.defineProperty(ri,e,{enumerable:!0,get:function(){return IH[e]}})})});var qH=T(q1=>{p();Object.defineProperty(q1,"__esModule",{value:!0});q1.deserializeDataCleansingAnnotations=l6e;q1.parseColumnAnnotation=Zce;q1.parseExtraSpacesTableAnnotation=ede;q1.parseResolverAnnotation=$ce;q1.serializeAnnotation=c6e;var a6e=Kk(),Jce=Vk(),wD=Bk();function wH(e){return s6e(e)||u6e(e)||o6e(e)||i6e()}function i6e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o6e(e,r){if(e){if(typeof e=="string")return DH(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return DH(e,r)}}function u6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function s6e(e){if(Array.isArray(e))return DH(e)}function DH(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function l6e(e){return[].concat(wH(d6e(e)),wH(f6e(e)),wH(p6e(e)))}function Zce(e){return new a6e.TableLintColumnAnnotation(JSON.parse(e.serializedData))}function $ce(e){return new Jce.CleanDataResolverAnnotation(JSON.parse(e.serializedData))}function ede(e){return new Jce.ExtraSpacesTableAnnotation(JSON.parse(e.serializedData))}function c6e(e,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wD.OperationType.Invalid,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return{serializedData:JSON.stringify(e),annotationType:r,operationType:t,validated:n}}function d6e(e){return LH(e,wD.AnnotationType_TableLintColumnAnnotation,Zce)}function f6e(e){return LH(e,wD.AnnotationType_ExcelCleanData_ResolverAnnotation,$ce)}function p6e(e){return LH(e,wD.AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation,ede)}function LH(e,r,t){return(e==null?void 0:e.filter(function(n){return n.annotationType===r}).map(t))||[]}});var ode=T(DD=>{p();Object.defineProperty(DD,"__esModule",{value:!0});DD.DataCleansingHostManager=void 0;var m6e=Ele(),g6e=y6e(Ale()),GH=qH(),v6e=od(),h6e=i0(),rde=lP(),tde=Bk(),S6e=Kk(),nde=Vk();function ide(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,t=new WeakMap;return(ide=function(a){return a?t:r})(e)}function y6e(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=ide(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}function BH(){"use strict";BH=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(C,S,b){C[S]=b.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(C,S,b){return Object.defineProperty(C,S,{value:b,enumerable:!0,configurable:!0,writable:!0}),C[S]}try{c({},"")}catch(C){c=function(b,O,w){return b[O]=w}}function d(C,S,b,O){var w=S&&S.prototype instanceof E?S:E,D=Object.create(w.prototype),Q=new Z(O||[]);return a(D,"_invoke",{value:j(C,b,Q)}),D}function f(C,S,b){try{return{type:"normal",arg:C.call(S,b)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var m="suspendedStart",v="suspendedYield",h="executing",y="completed",_={};function E(){}function N(){}function k(){}var q={};c(q,u,function(){return this});var V=Object.getPrototypeOf,I=V&&V(V(J([])));I&&I!==t&&n.call(I,u)&&(q=I);var M=k.prototype=E.prototype=Object.create(q);function B(C){["next","throw","return"].forEach(function(S){c(C,S,function(b){return this._invoke(S,b)})})}function U(C,S){function b(w,D,Q,W){var $=f(C[w],C,D);if($.type!=="throw"){var me=$.arg,ve=me.value;return ve&&typeof ve=="object"&&n.call(ve,"__await")?S.resolve(ve.__await).then(function(Pe){b("next",Pe,Q,W)},function(Pe){b("throw",Pe,Q,W)}):S.resolve(ve).then(function(Pe){me.value=Pe,Q(me)},function(Pe){return b("throw",Pe,Q,W)})}W($.arg)}var O;a(this,"_invoke",{value:function(D,Q){function W(){return new S(function($,me){b(D,Q,$,me)})}return O=O?O.then(W,W):W()}})}function j(C,S,b){var O=m;return function(w,D){if(O===h)throw new Error("Generator is already running");if(O===y){if(w==="throw")throw D;return{value:e,done:!0}}for(b.method=w,b.arg=D;;){var Q=b.delegate;if(Q){var W=X(Q,b);if(W){if(W===_)continue;return W}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(O===m)throw O=y,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);O=h;var $=f(C,S,b);if($.type==="normal"){if(O=b.done?y:v,$.arg===_)continue;return{value:$.arg,done:b.done}}$.type==="throw"&&(O=y,b.method="throw",b.arg=$.arg)}}}function X(C,S){var b=S.method,O=C.iterator[b];if(O===e)return S.delegate=null,b==="throw"&&C.iterator.return&&(S.method="return",S.arg=e,X(C,S),S.method==="throw")||b!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+b+"' method")),_;var w=f(O,C.iterator,S.arg);if(w.type==="throw")return S.method="throw",S.arg=w.arg,S.delegate=null,_;var D=w.arg;return D?D.done?(S[C.resultName]=D.value,S.next=C.nextLoc,S.method!=="return"&&(S.method="next",S.arg=e),S.delegate=null,_):D:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,_)}function ee(C){var S={tryLoc:C[0]};1 in C&&(S.catchLoc=C[1]),2 in C&&(S.finallyLoc=C[2],S.afterLoc=C[3]),this.tryEntries.push(S)}function re(C){var S=C.completion||{};S.type="normal",delete S.arg,C.completion=S}function Z(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(ee,this),this.reset(!0)}function J(C){if(C||C===""){var S=C[u];if(S)return S.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var b=-1,O=function w(){for(;++b<C.length;)if(n.call(C,b))return w.value=C[b],w.done=!1,w;return w.value=e,w.done=!0,w};return O.next=O}}throw new TypeError(typeof C+" is not iterable")}return N.prototype=k,a(M,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:N,configurable:!0}),N.displayName=c(k,l,"GeneratorFunction"),r.isGeneratorFunction=function(C){var S=typeof C=="function"&&C.constructor;return!!S&&(S===N||(S.displayName||S.name)==="GeneratorFunction")},r.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,k):(C.__proto__=k,c(C,l,"GeneratorFunction")),C.prototype=Object.create(M),C},r.awrap=function(C){return{__await:C}},B(U.prototype),c(U.prototype,s,function(){return this}),r.AsyncIterator=U,r.async=function(C,S,b,O,w){w===void 0&&(w=Promise);var D=new U(d(C,S,b,O),w);return r.isGeneratorFunction(S)?D:D.next().then(function(Q){return Q.done?Q.value:D.next()})},B(M),c(M,l,"Generator"),c(M,u,function(){return this}),c(M,"toString",function(){return"[object Generator]"}),r.keys=function(C){var S=Object(C),b=[];for(var O in S)b.push(O);return b.reverse(),function w(){for(;b.length;){var D=b.pop();if(D in S)return w.value=D,w.done=!1,w}return w.done=!0,w}},r.values=J,Z.prototype={constructor:Z,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(re),!S)for(var b in this)b.charAt(0)==="t"&&n.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=e)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var b=this;function O(me,ve){return Q.type="throw",Q.arg=S,b.next=me,ve&&(b.method="next",b.arg=e),!!ve}for(var w=this.tryEntries.length-1;w>=0;--w){var D=this.tryEntries[w],Q=D.completion;if(D.tryLoc==="root")return O("end");if(D.tryLoc<=this.prev){var W=n.call(D,"catchLoc"),$=n.call(D,"finallyLoc");if(W&&$){if(this.prev<D.catchLoc)return O(D.catchLoc,!0);if(this.prev<D.finallyLoc)return O(D.finallyLoc)}else if(W){if(this.prev<D.catchLoc)return O(D.catchLoc,!0)}else{if(!$)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return O(D.finallyLoc)}}}},abrupt:function(S,b){for(var O=this.tryEntries.length-1;O>=0;--O){var w=this.tryEntries[O];if(w.tryLoc<=this.prev&&n.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var D=w;break}}D&&(S==="break"||S==="continue")&&D.tryLoc<=b&&b<=D.finallyLoc&&(D=null);var Q=D?D.completion:{};return Q.type=S,Q.arg=b,D?(this.method="next",this.next=D.finallyLoc,_):this.complete(Q)},complete:function(S,b){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&b&&(this.next=b),_},finish:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),re(O),_}},catch:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.tryLoc===S){var w=O.completion;if(w.type==="throw"){var D=w.arg;re(O)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(S,b,O){return this.delegate={iterator:J(S),resultName:b,nextLoc:O},this.method==="next"&&(this.arg=e),_}},r}function _6e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function ade(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,C6e(n.key),n)}}function b6e(e,r,t){return r&&ade(e.prototype,r),t&&ade(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function C6e(e){var r=T6e(e,"string");return typeof r=="symbol"?r:String(r)}function T6e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var $5r=DD.DataCleansingHostManager=function(){function e(r,t){var n=this;_6e(this,e),this.onSheetAnnotationsChanged=function(o){var u;return BH().async(function(l){for(;;)switch(l.prev=l.next){case 0:u=n.getSerializedAnnotations(),n.onNewAnnotationList.trigger(u);case 2:case"end":return l.stop()}},null,null,null,Promise)},this.ServiceInfo=g6e.ServiceInfos.DataCleansingAnnotationsService,this.onNewAnnotationList=new rde.UxppEvent(this.ServiceInfo,(0,rde.nameOfEvent)("onNewAnnotationList")),this.excelCleanDataAnnotationsManager=r,this.logger=t,this.excelCleanDataAnnotationsManager.registerSheetAnnotationsChanged(this.onSheetAnnotationsChanged),this.excelCleanDataAnnotationsManager.activateEvents()}return b6e(e,[{key:"getAnnotationList",value:function(){return BH().async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.getSerializedAnnotations());case 1:case"end":return n.stop()}},null,this,null,Promise)}},{key:"getSerializedAnnotations",value:function(){var t=[],n=this.excelCleanDataAnnotationsManager.allAnnotations();return n.forEach(function(a){nde.CleanDataResolverAnnotation.typeGuard(a)?t.push((0,GH.serializeAnnotation)(a,tde.AnnotationType_ExcelCleanData_ResolverAnnotation)):S6e.TableLintColumnAnnotation.typeGuard(a)?t.push((0,GH.serializeAnnotation)(a,m6e.AnnotationType_TableLintColumnAnnotation)):nde.ExtraSpacesTableAnnotation.typeGuard(a)&&t.push((0,GH.serializeAnnotation)(a,tde.AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation))}),this.logger.sendTraceTag(507593602,v6e.LogCategory.msoulscat_ES_EWAJS,h6e.TraceLevel.Info,"UxppDataCleansingManager.getAnnotationList: Got "+t.length+" annotations"),t}}]),e}()});var pde=T(LD=>{p();Object.defineProperty(LD,"__esModule",{value:!0});LD.AnnotationsProvider=void 0;var Kf=Bk(),H_=i0(),z_=od(),ude=qH();function UH(){"use strict";UH=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(C,S,b){C[S]=b.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(C,S,b){return Object.defineProperty(C,S,{value:b,enumerable:!0,configurable:!0,writable:!0}),C[S]}try{c({},"")}catch(C){c=function(b,O,w){return b[O]=w}}function d(C,S,b,O){var w=S&&S.prototype instanceof E?S:E,D=Object.create(w.prototype),Q=new Z(O||[]);return a(D,"_invoke",{value:j(C,b,Q)}),D}function f(C,S,b){try{return{type:"normal",arg:C.call(S,b)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var m="suspendedStart",v="suspendedYield",h="executing",y="completed",_={};function E(){}function N(){}function k(){}var q={};c(q,u,function(){return this});var V=Object.getPrototypeOf,I=V&&V(V(J([])));I&&I!==t&&n.call(I,u)&&(q=I);var M=k.prototype=E.prototype=Object.create(q);function B(C){["next","throw","return"].forEach(function(S){c(C,S,function(b){return this._invoke(S,b)})})}function U(C,S){function b(w,D,Q,W){var $=f(C[w],C,D);if($.type!=="throw"){var me=$.arg,ve=me.value;return ve&&typeof ve=="object"&&n.call(ve,"__await")?S.resolve(ve.__await).then(function(Pe){b("next",Pe,Q,W)},function(Pe){b("throw",Pe,Q,W)}):S.resolve(ve).then(function(Pe){me.value=Pe,Q(me)},function(Pe){return b("throw",Pe,Q,W)})}W($.arg)}var O;a(this,"_invoke",{value:function(D,Q){function W(){return new S(function($,me){b(D,Q,$,me)})}return O=O?O.then(W,W):W()}})}function j(C,S,b){var O=m;return function(w,D){if(O===h)throw new Error("Generator is already running");if(O===y){if(w==="throw")throw D;return{value:e,done:!0}}for(b.method=w,b.arg=D;;){var Q=b.delegate;if(Q){var W=X(Q,b);if(W){if(W===_)continue;return W}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(O===m)throw O=y,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);O=h;var $=f(C,S,b);if($.type==="normal"){if(O=b.done?y:v,$.arg===_)continue;return{value:$.arg,done:b.done}}$.type==="throw"&&(O=y,b.method="throw",b.arg=$.arg)}}}function X(C,S){var b=S.method,O=C.iterator[b];if(O===e)return S.delegate=null,b==="throw"&&C.iterator.return&&(S.method="return",S.arg=e,X(C,S),S.method==="throw")||b!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+b+"' method")),_;var w=f(O,C.iterator,S.arg);if(w.type==="throw")return S.method="throw",S.arg=w.arg,S.delegate=null,_;var D=w.arg;return D?D.done?(S[C.resultName]=D.value,S.next=C.nextLoc,S.method!=="return"&&(S.method="next",S.arg=e),S.delegate=null,_):D:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,_)}function ee(C){var S={tryLoc:C[0]};1 in C&&(S.catchLoc=C[1]),2 in C&&(S.finallyLoc=C[2],S.afterLoc=C[3]),this.tryEntries.push(S)}function re(C){var S=C.completion||{};S.type="normal",delete S.arg,C.completion=S}function Z(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(ee,this),this.reset(!0)}function J(C){if(C||C===""){var S=C[u];if(S)return S.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var b=-1,O=function w(){for(;++b<C.length;)if(n.call(C,b))return w.value=C[b],w.done=!1,w;return w.value=e,w.done=!0,w};return O.next=O}}throw new TypeError(typeof C+" is not iterable")}return N.prototype=k,a(M,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:N,configurable:!0}),N.displayName=c(k,l,"GeneratorFunction"),r.isGeneratorFunction=function(C){var S=typeof C=="function"&&C.constructor;return!!S&&(S===N||(S.displayName||S.name)==="GeneratorFunction")},r.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,k):(C.__proto__=k,c(C,l,"GeneratorFunction")),C.prototype=Object.create(M),C},r.awrap=function(C){return{__await:C}},B(U.prototype),c(U.prototype,s,function(){return this}),r.AsyncIterator=U,r.async=function(C,S,b,O,w){w===void 0&&(w=Promise);var D=new U(d(C,S,b,O),w);return r.isGeneratorFunction(S)?D:D.next().then(function(Q){return Q.done?Q.value:D.next()})},B(M),c(M,l,"Generator"),c(M,u,function(){return this}),c(M,"toString",function(){return"[object Generator]"}),r.keys=function(C){var S=Object(C),b=[];for(var O in S)b.push(O);return b.reverse(),function w(){for(;b.length;){var D=b.pop();if(D in S)return w.value=D,w.done=!1,w}return w.done=!0,w}},r.values=J,Z.prototype={constructor:Z,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(re),!S)for(var b in this)b.charAt(0)==="t"&&n.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=e)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var b=this;function O(me,ve){return Q.type="throw",Q.arg=S,b.next=me,ve&&(b.method="next",b.arg=e),!!ve}for(var w=this.tryEntries.length-1;w>=0;--w){var D=this.tryEntries[w],Q=D.completion;if(D.tryLoc==="root")return O("end");if(D.tryLoc<=this.prev){var W=n.call(D,"catchLoc"),$=n.call(D,"finallyLoc");if(W&&$){if(this.prev<D.catchLoc)return O(D.catchLoc,!0);if(this.prev<D.finallyLoc)return O(D.finallyLoc)}else if(W){if(this.prev<D.catchLoc)return O(D.catchLoc,!0)}else{if(!$)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return O(D.finallyLoc)}}}},abrupt:function(S,b){for(var O=this.tryEntries.length-1;O>=0;--O){var w=this.tryEntries[O];if(w.tryLoc<=this.prev&&n.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var D=w;break}}D&&(S==="break"||S==="continue")&&D.tryLoc<=b&&b<=D.finallyLoc&&(D=null);var Q=D?D.completion:{};return Q.type=S,Q.arg=b,D?(this.method="next",this.next=D.finallyLoc,_):this.complete(Q)},complete:function(S,b){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&b&&(this.next=b),_},finish:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),re(O),_}},catch:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.tryLoc===S){var w=O.completion;if(w.type==="throw"){var D=w.arg;re(O)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(S,b,O){return this.delegate={iterator:J(S),resultName:b,nextLoc:O},this.method==="next"&&(this.arg=e),_}},r}function sde(e,r){return A6e(e)||P6e(e,r)||E6e(e,r)||R6e()}function R6e(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E6e(e,r){if(e){if(typeof e=="string")return lde(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return lde(e,r)}}function lde(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function P6e(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n,a,o,u,s=[],l=!0,c=!1;try{if(o=(t=t.call(e)).next,r===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=o.call(t)).done)&&(s.push(n.value),s.length!==r);l=!0);}catch(d){c=!0,a=d}finally{try{if(!l&&t.return!=null&&(u=t.return(),Object(u)!==u))return}finally{if(c)throw a}}return s}}function A6e(e){if(Array.isArray(e))return e}function F6e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function cde(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O6e(n.key),n)}}function N6e(e,r,t){return r&&cde(e.prototype,r),t&&cde(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function O6e(e){var r=k6e(e,"string");return typeof r=="symbol"?r:String(r)}function k6e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var dde="suggestionsAnnotationReceived",fde="resolverAnnotationReceived",tVr=LD.AnnotationsProvider=function(){function e(r,t){var n=this;F6e(this,e),this.connectionClosedCallback=void 0,this.areEventsRegistered=!1,this.eventTarget=new EventTarget,this.suggestionsAnnotationHandler=function(a){var o=(0,ude.deserializeDataCleansingAnnotations)([a]),u=sde(o,1),s=u[0],l=s;if(!l){n.logger.sendTraceTag(0,z_.LogCategory.msoulscat_ES_EWAJS,H_.TraceLevel.Info,"AnnotationsProvider.suggestionsAnnotationHandler suggestionsAnnotation is null."),console.error("suggestionsAnnotation parsing failed");return}switch(a.operationType){case Kf.OperationType.Add:case Kf.OperationType.Update:{n.eventTarget.dispatchEvent(new CustomEvent(dde,{detail:l}));break}case Kf.OperationType.Delete:break;default:{console.error("suggestionsAnnotationHandler op type : "+a.operationType),n.logger.sendTraceTag(0,z_.LogCategory.msoulscat_ES_EWAJS,H_.TraceLevel.Info,"AnnotationsProvider.suggestionsAnnotationHandler Received unexpected OperationType:"+a.operationType);break}}},this.resolverAnnotationHandler=function(a){var o=(0,ude.deserializeDataCleansingAnnotations)([a]),u=sde(o,1),s=u[0],l=s;if(!l){n.logger.sendTraceTag(0,z_.LogCategory.msoulscat_ES_EWAJS,H_.TraceLevel.Info,"AnnotationsProvider.resolverAnnotationHandler: resolverAnnotation is null."),console.error("resolverAnnotation parsing failed");return}switch(a.operationType){case Kf.OperationType.Add:case Kf.OperationType.Update:{n.eventTarget.dispatchEvent(new CustomEvent(fde,{detail:l}));break}case Kf.OperationType.Delete:break;default:{console.error("resolverAnnotationHandler op type : "+a.operationType),n.logger.sendTraceTag(0,z_.LogCategory.msoulscat_ES_EWAJS,H_.TraceLevel.Info,"AnnotationsProvider.resolverAnnotationHandler Received unexpected OperationType:"+a.operationType);break}}},this.annotationsProxy=r,this.logger=t}return N6e(e,[{key:"registerOnClose",value:function(t){var n=this;return UH().async(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.connectionClosedCallback===void 0){o.next=2;break}throw new Error("Closed connection already registered");case 2:return this.connectionClosedCallback=t,o.next=5,UH().awrap(this.annotationsProxy.registerOnClose(function(u){return n.connectionClosedCallback==null?void 0:n.connectionClosedCallback(u)}));case 5:this.logger.sendTraceTag(0,z_.LogCategory.msoulscat_ES_EWAJS,H_.TraceLevel.Info,"AnnotationsProvider.registerOnClose: registered on close");case 6:case"end":return o.stop()}},null,this,null,Promise)}},{key:"activateEvents",value:function(){if(this.areEventsRegistered){this.logger.sendTraceTag(507597338,z_.LogCategory.msoulscat_ES_EWAJS,H_.TraceLevel.Info,"AnnotationsProvider.ActivateEvents: Events are already registered");return}this.registerCleanDataEvents(),this.areEventsRegistered=!0}},{key:"deactivateEvents",value:function(){this.areEventsRegistered&&(this.unregisterCleanDataEvents(),this.areEventsRegistered=!1)}},{key:"registerSuggestionsAnnotationReceived",value:function(t){this.eventTarget.addEventListener(dde,function(n){n instanceof CustomEvent&&t(n==null?void 0:n.detail)})}},{key:"registerResolverAnnotationReceived",value:function(t){this.eventTarget.addEventListener(fde,function(n){n instanceof CustomEvent&&t(n==null?void 0:n.detail)})}},{key:"unregisterCleanDataEvents",value:function(){this.annotationsProxy.unregisterAnnotation(Kf.AnnotationType_TableLintColumnAnnotation).then(function(){console.log("AnnotationType_TableLintColumnAnnotation unregistration succeeded")}).catch(function(){console.error("AnnotationType_TableLintColumnAnnotation unregistration failed")}),this.annotationsProxy.unregisterAnnotation(Kf.AnnotationType_ExcelCleanData_ResolverAnnotation).then(function(){console.log("AnnotationType_ExcelCleanData_ResolverAnnotation unregistration succeeded")}).catch(function(){console.error("AnnotationType_ExcelCleanData_ResolverAnnotation unregistration failed")}),this.annotationsProxy.unregisterAnnotation(Kf.AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation).then(function(){console.log("AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation unregistration succeeded")}).catch(function(){console.error("AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation unregistration failed")})}},{key:"registerCleanDataEvents",value:function(){var t=this;this.logger.sendTraceTag(507593601,z_.LogCategory.msoulscat_ES_EWAJS,H_.TraceLevel.Info,"AnnotationsProvider.registerCleanDataEvents: activate annotations"),this.annotationsProxy.registerAnnotation(Kf.AnnotationType_TableLintColumnAnnotation,!0,function(n){return t.onAnnotationArrived(n)}).then(function(){console.log("AnnotationType_TableLintColumnAnnotation registration succeeded")}).catch(function(){console.error("AnnotationType_TableLintColumnAnnotation registration failed")}),this.annotationsProxy.registerAnnotation(Kf.AnnotationType_ExcelCleanData_ResolverAnnotation,!0,function(n){return t.onAnnotationArrived(n)}).then(function(){console.log("AnnotationType_ExcelCleanData_ResolverAnnotation registration succeeded")}).catch(function(){console.error("AnnotationType_ExcelCleanData_ResolverAnnotation registration failed")}),this.annotationsProxy.registerAnnotation(Kf.AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation,!0,function(n){return t.onAnnotationArrived(n)}).then(function(){console.log("AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation registration succeeded")}).catch(function(){console.error("AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation registration failed")}),this.logger.sendTraceTag(0,z_.LogCategory.msoulscat_ES_EWAJS,H_.TraceLevel.Info,"AnnotationsProvider.registerAnnotations: registered annotations")}},{key:"onAnnotationArrived",value:function(t){switch(t.annotationType){case Kf.AnnotationType_TableLintColumnAnnotation:case Kf.AnnotationType_ExcelCleanData_ExtraSpacesTableAnnotation:this.suggestionsAnnotationHandler(t);break;case Kf.AnnotationType_ExcelCleanData_ResolverAnnotation:this.resolverAnnotationHandler(t);break;default:}}}]),e}()});var gde=T(CP=>{p();Object.defineProperty(CP,"__esModule",{value:!0});CP.ServiceInfos=CP.NativeServices=void 0;var M6e=rl();function x6e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function mde(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w6e(n.key),n)}}function I6e(e,r,t){return r&&mde(e.prototype,r),t&&mde(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function w6e(e){var r=D6e(e,"string");return typeof r=="symbol"?r:String(r)}function D6e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var L6e=CP.ServiceInfos={DataCleansingSessionStorageService:["Uxpp::Internal::RekaServices::DataCleansingSessionStorageService",{getIgnoredSuggestions:["ReturnsPromiseMethod",["$array","$string"],[]],addToIgnoredSuggestions:["ReturnsPromiseMethod","$any",["$string"]],getAppliedSuggestions:["ReturnsPromiseMethod",["$array","$string"],[]],addToAppliedSuggestions:["ReturnsPromiseMethod","$any",["$string"]],removeFromAppliedSuggestions:["ReturnsPromiseMethod","$any",["$string"]],getIgnoredSuggestionsInfo:["ReturnsPromiseMethod","Uxpp::Internal::RekaServices::IgnoredSuggestionsInfo",[]],getAppliedSuggestionsOnTaskPaneOpen:["ReturnsPromiseMethod",["$array","$string"],[]],onIgnoredSuggestionsInfoChanged:["Event","Uxpp::Internal::RekaServices::IgnoredSuggestionsInfo"],onAppliedSuggestionsChanged:["Event",["$array","$string"]]}]},iVr=CP.NativeServices=function(){function e(){x6e(this,e)}return I6e(e,null,[{key:"DataCleansingSessionStorageService",get:function(){return e._DataCleansingSessionStorageService??=M6e.RekaServiceRegistry.getNativeService(L6e.DataCleansingSessionStorageService)}}]),e}()});var Sde=T(GD=>{p();Object.defineProperty(GD,"__esModule",{value:!0});GD.SessionStorage=void 0;var qD=lP(),q6e=B6e(gde()),G6e=mi();function hde(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,t=new WeakMap;return(hde=function(a){return a?t:r})(e)}function B6e(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=hde(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}function Vf(){"use strict";Vf=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(C,S,b){C[S]=b.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(C,S,b){return Object.defineProperty(C,S,{value:b,enumerable:!0,configurable:!0,writable:!0}),C[S]}try{c({},"")}catch(C){c=function(b,O,w){return b[O]=w}}function d(C,S,b,O){var w=S&&S.prototype instanceof E?S:E,D=Object.create(w.prototype),Q=new Z(O||[]);return a(D,"_invoke",{value:j(C,b,Q)}),D}function f(C,S,b){try{return{type:"normal",arg:C.call(S,b)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var m="suspendedStart",v="suspendedYield",h="executing",y="completed",_={};function E(){}function N(){}function k(){}var q={};c(q,u,function(){return this});var V=Object.getPrototypeOf,I=V&&V(V(J([])));I&&I!==t&&n.call(I,u)&&(q=I);var M=k.prototype=E.prototype=Object.create(q);function B(C){["next","throw","return"].forEach(function(S){c(C,S,function(b){return this._invoke(S,b)})})}function U(C,S){function b(w,D,Q,W){var $=f(C[w],C,D);if($.type!=="throw"){var me=$.arg,ve=me.value;return ve&&typeof ve=="object"&&n.call(ve,"__await")?S.resolve(ve.__await).then(function(Pe){b("next",Pe,Q,W)},function(Pe){b("throw",Pe,Q,W)}):S.resolve(ve).then(function(Pe){me.value=Pe,Q(me)},function(Pe){return b("throw",Pe,Q,W)})}W($.arg)}var O;a(this,"_invoke",{value:function(D,Q){function W(){return new S(function($,me){b(D,Q,$,me)})}return O=O?O.then(W,W):W()}})}function j(C,S,b){var O=m;return function(w,D){if(O===h)throw new Error("Generator is already running");if(O===y){if(w==="throw")throw D;return{value:e,done:!0}}for(b.method=w,b.arg=D;;){var Q=b.delegate;if(Q){var W=X(Q,b);if(W){if(W===_)continue;return W}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(O===m)throw O=y,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);O=h;var $=f(C,S,b);if($.type==="normal"){if(O=b.done?y:v,$.arg===_)continue;return{value:$.arg,done:b.done}}$.type==="throw"&&(O=y,b.method="throw",b.arg=$.arg)}}}function X(C,S){var b=S.method,O=C.iterator[b];if(O===e)return S.delegate=null,b==="throw"&&C.iterator.return&&(S.method="return",S.arg=e,X(C,S),S.method==="throw")||b!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+b+"' method")),_;var w=f(O,C.iterator,S.arg);if(w.type==="throw")return S.method="throw",S.arg=w.arg,S.delegate=null,_;var D=w.arg;return D?D.done?(S[C.resultName]=D.value,S.next=C.nextLoc,S.method!=="return"&&(S.method="next",S.arg=e),S.delegate=null,_):D:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,_)}function ee(C){var S={tryLoc:C[0]};1 in C&&(S.catchLoc=C[1]),2 in C&&(S.finallyLoc=C[2],S.afterLoc=C[3]),this.tryEntries.push(S)}function re(C){var S=C.completion||{};S.type="normal",delete S.arg,C.completion=S}function Z(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(ee,this),this.reset(!0)}function J(C){if(C||C===""){var S=C[u];if(S)return S.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var b=-1,O=function w(){for(;++b<C.length;)if(n.call(C,b))return w.value=C[b],w.done=!1,w;return w.value=e,w.done=!0,w};return O.next=O}}throw new TypeError(typeof C+" is not iterable")}return N.prototype=k,a(M,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:N,configurable:!0}),N.displayName=c(k,l,"GeneratorFunction"),r.isGeneratorFunction=function(C){var S=typeof C=="function"&&C.constructor;return!!S&&(S===N||(S.displayName||S.name)==="GeneratorFunction")},r.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,k):(C.__proto__=k,c(C,l,"GeneratorFunction")),C.prototype=Object.create(M),C},r.awrap=function(C){return{__await:C}},B(U.prototype),c(U.prototype,s,function(){return this}),r.AsyncIterator=U,r.async=function(C,S,b,O,w){w===void 0&&(w=Promise);var D=new U(d(C,S,b,O),w);return r.isGeneratorFunction(S)?D:D.next().then(function(Q){return Q.done?Q.value:D.next()})},B(M),c(M,l,"Generator"),c(M,u,function(){return this}),c(M,"toString",function(){return"[object Generator]"}),r.keys=function(C){var S=Object(C),b=[];for(var O in S)b.push(O);return b.reverse(),function w(){for(;b.length;){var D=b.pop();if(D in S)return w.value=D,w.done=!1,w}return w.done=!0,w}},r.values=J,Z.prototype={constructor:Z,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(re),!S)for(var b in this)b.charAt(0)==="t"&&n.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=e)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var b=this;function O(me,ve){return Q.type="throw",Q.arg=S,b.next=me,ve&&(b.method="next",b.arg=e),!!ve}for(var w=this.tryEntries.length-1;w>=0;--w){var D=this.tryEntries[w],Q=D.completion;if(D.tryLoc==="root")return O("end");if(D.tryLoc<=this.prev){var W=n.call(D,"catchLoc"),$=n.call(D,"finallyLoc");if(W&&$){if(this.prev<D.catchLoc)return O(D.catchLoc,!0);if(this.prev<D.finallyLoc)return O(D.finallyLoc)}else if(W){if(this.prev<D.catchLoc)return O(D.catchLoc,!0)}else{if(!$)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return O(D.finallyLoc)}}}},abrupt:function(S,b){for(var O=this.tryEntries.length-1;O>=0;--O){var w=this.tryEntries[O];if(w.tryLoc<=this.prev&&n.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var D=w;break}}D&&(S==="break"||S==="continue")&&D.tryLoc<=b&&b<=D.finallyLoc&&(D=null);var Q=D?D.completion:{};return Q.type=S,Q.arg=b,D?(this.method="next",this.next=D.finallyLoc,_):this.complete(Q)},complete:function(S,b){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&b&&(this.next=b),_},finish:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),re(O),_}},catch:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.tryLoc===S){var w=O.completion;if(w.type==="throw"){var D=w.arg;re(O)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(S,b,O){return this.delegate={iterator:J(S),resultName:b,nextLoc:O},this.method==="next"&&(this.arg=e),_}},r}function U6e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function vde(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V6e(n.key),n)}}function K6e(e,r,t){return r&&vde(e.prototype,r),t&&vde(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function V6e(e){var r=j6e(e,"string");return typeof r=="symbol"?r:String(r)}function j6e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var sVr=GD.SessionStorage=function(){function e(r){var t=this;U6e(this,e),this.appliedSuggestions=[],this.ignoredSuggestionsInfo={ids:[],isReady:!1},this.ServiceInfo=q6e.ServiceInfos.DataCleansingSessionStorageService,this.onIgnoredSuggestionsInfoChanged=new qD.UxppEvent(this.ServiceInfo,(0,qD.nameOfEvent)("onIgnoredSuggestionsInfoChanged")),this.onAppliedSuggestionsChanged=new qD.UxppEvent(this.ServiceInfo,(0,qD.nameOfEvent)("onAppliedSuggestionsChanged")),this.updateAppliedSuggestions=function(a){return Vf().async(function(u){for(;;)switch(u.prev=u.next){case 0:t.appliedSuggestions=a,t.onAppliedSuggestionsChanged.trigger(t.appliedSuggestions);case 2:case"end":return u.stop()}},null,null,null,Promise)},this.updateIgnoredSuggestions=function(a){return Vf().async(function(u){for(;;)switch(u.prev=u.next){case 0:t.ignoredSuggestionsInfo={ids:a,isReady:a!==void 0},t.onIgnoredSuggestionsInfoChanged.trigger(t.ignoredSuggestionsInfo);case 2:case"end":return u.stop()}},null,null,null,Promise)},this.cleanDataSessionStorage=r,this.cleanDataSessionStorage.registerIgnoredSuggestionsChanged(this.updateIgnoredSuggestions),(0,G6e.getBooleanFeatureGate)("Microsoft.Office.Excel.AddAppliedIdsToProps",!1)&&this.cleanDataSessionStorage.registerAppliedSuggestionsChanged(this.updateAppliedSuggestions)}return K6e(e,[{key:"registerIgnoredSuggestionsChanged",value:function(t){return Vf().async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this.cleanDataSessionStorage.registerIgnoredSuggestionsChanged(t));case 1:case"end":return a.stop()}},null,this,null,Promise)}},{key:"registerAppliedSuggestionsChanged",value:function(t){return Vf().async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this.cleanDataSessionStorage.registerAppliedSuggestionsChanged(t));case 1:case"end":return a.stop()}},null,this,null,Promise)}},{key:"getIgnoredSuggestions",value:function(){return Vf().async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.cleanDataSessionStorage.getIgnoredSuggestions());case 1:case"end":return n.stop()}},null,this,null,Promise)}},{key:"addToIgnoredSuggestions",value:function(t){return Vf().async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Vf().awrap(this.cleanDataSessionStorage.addToIgnoredSuggestions(t));case 2:case"end":return a.stop()}},null,this,null,Promise)}},{key:"getAppliedSuggestions",value:function(){return Vf().async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.cleanDataSessionStorage.getAppliedSuggestions());case 1:case"end":return n.stop()}},null,this,null,Promise)}},{key:"addToAppliedSuggestions",value:function(t){return Vf().async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Vf().awrap(this.cleanDataSessionStorage.addToAppliedSuggestions(t));case 2:case"end":return a.stop()}},null,this,null,Promise)}},{key:"removeFromAppliedSuggestions",value:function(t){return Vf().async(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Vf().awrap(this.cleanDataSessionStorage.removeFromAppliedSuggestions(t));case 2:case"end":return a.stop()}},null,this,null,Promise)}},{key:"getIgnoredSuggestionsInfo",value:function(){return Vf().async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.ignoredSuggestionsInfo);case 1:case"end":return n.stop()}},null,this,null,Promise)}},{key:"getAppliedSuggestionsOnTaskPaneOpen",value:function(){return Vf().async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.appliedSuggestions);case 1:case"end":return n.stop()}},null,this,null,Promise)}}]),e}()});var _de=T(TP=>{p();Object.defineProperty(TP,"__esModule",{value:!0});TP.ServiceInfos=TP.NativeServices=void 0;var W6e=rl();function H6e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function yde(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q6e(n.key),n)}}function z6e(e,r,t){return r&&yde(e.prototype,r),t&&yde(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q6e(e){var r=X6e(e,"string");return typeof r=="symbol"?r:String(r)}function X6e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Y6e=TP.ServiceInfos={DataCleansingStateService:["Uxpp::Internal::RekaServices::DataCleansingStateService",{getState:["ReturnsPromiseMethod","DataCleansing::TaskPane::RekaServices::State",[]],onStateChange:["Event","DataCleansing::TaskPane::RekaServices::State"]}]},dVr=TP.NativeServices=function(){function e(){H6e(this,e)}return z6e(e,null,[{key:"DataCleansingStateService",get:function(){return e._DataCleansingStateService??=W6e.RekaServiceRegistry.getNativeService(Y6e.DataCleansingStateService)}}]),e}()});var Ede=T(BD=>{p();Object.defineProperty(BD,"__esModule",{value:!0});BD.StateProvider=void 0;var J6e=od(),Z6e=i0(),bde=lP(),$6e=r5e(_de()),e5e=mi();function Tde(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,t=new WeakMap;return(Tde=function(a){return a?t:r})(e)}function r5e(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=Tde(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}function Rde(){"use strict";Rde=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(C,S,b){C[S]=b.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(C,S,b){return Object.defineProperty(C,S,{value:b,enumerable:!0,configurable:!0,writable:!0}),C[S]}try{c({},"")}catch(C){c=function(b,O,w){return b[O]=w}}function d(C,S,b,O){var w=S&&S.prototype instanceof E?S:E,D=Object.create(w.prototype),Q=new Z(O||[]);return a(D,"_invoke",{value:j(C,b,Q)}),D}function f(C,S,b){try{return{type:"normal",arg:C.call(S,b)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var m="suspendedStart",v="suspendedYield",h="executing",y="completed",_={};function E(){}function N(){}function k(){}var q={};c(q,u,function(){return this});var V=Object.getPrototypeOf,I=V&&V(V(J([])));I&&I!==t&&n.call(I,u)&&(q=I);var M=k.prototype=E.prototype=Object.create(q);function B(C){["next","throw","return"].forEach(function(S){c(C,S,function(b){return this._invoke(S,b)})})}function U(C,S){function b(w,D,Q,W){var $=f(C[w],C,D);if($.type!=="throw"){var me=$.arg,ve=me.value;return ve&&typeof ve=="object"&&n.call(ve,"__await")?S.resolve(ve.__await).then(function(Pe){b("next",Pe,Q,W)},function(Pe){b("throw",Pe,Q,W)}):S.resolve(ve).then(function(Pe){me.value=Pe,Q(me)},function(Pe){return b("throw",Pe,Q,W)})}W($.arg)}var O;a(this,"_invoke",{value:function(D,Q){function W(){return new S(function($,me){b(D,Q,$,me)})}return O=O?O.then(W,W):W()}})}function j(C,S,b){var O=m;return function(w,D){if(O===h)throw new Error("Generator is already running");if(O===y){if(w==="throw")throw D;return{value:e,done:!0}}for(b.method=w,b.arg=D;;){var Q=b.delegate;if(Q){var W=X(Q,b);if(W){if(W===_)continue;return W}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(O===m)throw O=y,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);O=h;var $=f(C,S,b);if($.type==="normal"){if(O=b.done?y:v,$.arg===_)continue;return{value:$.arg,done:b.done}}$.type==="throw"&&(O=y,b.method="throw",b.arg=$.arg)}}}function X(C,S){var b=S.method,O=C.iterator[b];if(O===e)return S.delegate=null,b==="throw"&&C.iterator.return&&(S.method="return",S.arg=e,X(C,S),S.method==="throw")||b!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+b+"' method")),_;var w=f(O,C.iterator,S.arg);if(w.type==="throw")return S.method="throw",S.arg=w.arg,S.delegate=null,_;var D=w.arg;return D?D.done?(S[C.resultName]=D.value,S.next=C.nextLoc,S.method!=="return"&&(S.method="next",S.arg=e),S.delegate=null,_):D:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,_)}function ee(C){var S={tryLoc:C[0]};1 in C&&(S.catchLoc=C[1]),2 in C&&(S.finallyLoc=C[2],S.afterLoc=C[3]),this.tryEntries.push(S)}function re(C){var S=C.completion||{};S.type="normal",delete S.arg,C.completion=S}function Z(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(ee,this),this.reset(!0)}function J(C){if(C||C===""){var S=C[u];if(S)return S.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var b=-1,O=function w(){for(;++b<C.length;)if(n.call(C,b))return w.value=C[b],w.done=!1,w;return w.value=e,w.done=!0,w};return O.next=O}}throw new TypeError(typeof C+" is not iterable")}return N.prototype=k,a(M,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:N,configurable:!0}),N.displayName=c(k,l,"GeneratorFunction"),r.isGeneratorFunction=function(C){var S=typeof C=="function"&&C.constructor;return!!S&&(S===N||(S.displayName||S.name)==="GeneratorFunction")},r.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,k):(C.__proto__=k,c(C,l,"GeneratorFunction")),C.prototype=Object.create(M),C},r.awrap=function(C){return{__await:C}},B(U.prototype),c(U.prototype,s,function(){return this}),r.AsyncIterator=U,r.async=function(C,S,b,O,w){w===void 0&&(w=Promise);var D=new U(d(C,S,b,O),w);return r.isGeneratorFunction(S)?D:D.next().then(function(Q){return Q.done?Q.value:D.next()})},B(M),c(M,l,"Generator"),c(M,u,function(){return this}),c(M,"toString",function(){return"[object Generator]"}),r.keys=function(C){var S=Object(C),b=[];for(var O in S)b.push(O);return b.reverse(),function w(){for(;b.length;){var D=b.pop();if(D in S)return w.value=D,w.done=!1,w}return w.done=!0,w}},r.values=J,Z.prototype={constructor:Z,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(re),!S)for(var b in this)b.charAt(0)==="t"&&n.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=e)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var b=this;function O(me,ve){return Q.type="throw",Q.arg=S,b.next=me,ve&&(b.method="next",b.arg=e),!!ve}for(var w=this.tryEntries.length-1;w>=0;--w){var D=this.tryEntries[w],Q=D.completion;if(D.tryLoc==="root")return O("end");if(D.tryLoc<=this.prev){var W=n.call(D,"catchLoc"),$=n.call(D,"finallyLoc");if(W&&$){if(this.prev<D.catchLoc)return O(D.catchLoc,!0);if(this.prev<D.finallyLoc)return O(D.finallyLoc)}else if(W){if(this.prev<D.catchLoc)return O(D.catchLoc,!0)}else{if(!$)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return O(D.finallyLoc)}}}},abrupt:function(S,b){for(var O=this.tryEntries.length-1;O>=0;--O){var w=this.tryEntries[O];if(w.tryLoc<=this.prev&&n.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var D=w;break}}D&&(S==="break"||S==="continue")&&D.tryLoc<=b&&b<=D.finallyLoc&&(D=null);var Q=D?D.completion:{};return Q.type=S,Q.arg=b,D?(this.method="next",this.next=D.finallyLoc,_):this.complete(Q)},complete:function(S,b){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&b&&(this.next=b),_},finish:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),re(O),_}},catch:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.tryLoc===S){var w=O.completion;if(w.type==="throw"){var D=w.arg;re(O)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(S,b,O){return this.delegate={iterator:J(S),resultName:b,nextLoc:O},this.method==="next"&&(this.arg=e),_}},r}function t5e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Cde(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a5e(n.key),n)}}function n5e(e,r,t){return r&&Cde(e.prototype,r),t&&Cde(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function a5e(e){var r=i5e(e,"string");return typeof r=="symbol"?r:String(r)}function i5e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var mVr=BD.StateProvider=function(){function e(r,t){var n=this;t5e(this,e),this.hostState={errorState:void 0,isFeedbackAllowed:!0},this.ServiceInfo=$6e.ServiceInfos.DataCleansingStateService,this.onStateChange=new bde.UxppEvent(this.ServiceInfo,(0,bde.nameOfEvent)("onStateChange")),this.annotationsProvider=r,this.logger=t,(0,e5e.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansingDesktop",!1)&&this.annotationsProvider.registerOnClose(function(a){return n.connectionClosed(a)})}return n5e(e,[{key:"getState",value:function(){return Rde().async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.hostState);case 1:case"end":return n.stop()}},null,this,null,Promise)}},{key:"connectionClosed",value:function(t){this.logger.sendTraceTag(508703253,J6e.LogCategory.msoulscat_ES_EWAJS,Z6e.TraceLevel.Info,"StateProvider.connectionClosed: Got "+t),this.hostState.errorState=t,this.onStateChange.trigger(this.hostState)}}]),e}()});var Pde=T(RP=>{p();Object.defineProperty(RP,"__esModule",{value:!0});RP.nativeNamespace=RP.TaskPaneId=void 0;var hVr=RP.nativeNamespace="Uxpp.TaskPanes",SVr=RP.TaskPaneId=function(e){return e[e.PowerOptionsTaskPane=0]="PowerOptionsTaskPane",e[e.DataCleansingTaskPane=1]="DataCleansingTaskPane",e[e.PowerQueryTaskPane=2]="PowerQueryTaskPane",e[e.NumOfTaskPanes=3]="NumOfTaskPanes",e}({})});var PP=T(u0=>{p();Object.defineProperty(u0,"__esModule",{value:!0});u0.countBy=o5e;u0.difference=d5e;u0.flat=s5e;u0.getOrCreateMapItem=Ade;u0.groupBy=u5e;u0.mapReplacer=l5e;u0.objectFromEntries=Fde;u0.sum=c5e;var EP=fe();function o5e(e,r,t){return t===void 0&&(t=new Map),e.reduce(function(n,a){var o=r(a),u=n.get(o);return u?n.set(o,u+1):n.set(o,1),n},t)}function u5e(e,r,t){var n,a;t===void 0&&(t=new Map);try{for(var o=(0,EP.__values)(e),u=o.next();!u.done;u=o.next()){var s=u.value,l=r(s),c=Ade(t,l,function(){return[]});c.push(s)}}catch(d){n={error:d}}finally{try{u&&!u.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return t}function Ade(e,r,t){return e.has(r)||e.set(r,t()),e.get(r)}function s5e(e){var r=[];return e.forEach(function(t){return r.push.apply(r,(0,EP.__spreadArray)([],(0,EP.__read)(t),!1))}),r}function Fde(e){return Array.from(e).reduce(function(r,t){var n,a=(0,EP.__read)(t,2),o=a[0],u=a[1];return(0,EP.__assign)((0,EP.__assign)({},r),(n={},n[o]=u,n))},{})}function l5e(e,r){return r instanceof Map?Fde(r.entries()):r}function c5e(e){var r=0;return Array.from(e).forEach(function(t){r+=t}),r}function d5e(e,r){return e.filter(function(t){return!r.includes(t)})}});var jk=T(Q_=>{p();Object.defineProperty(Q_,"__esModule",{value:!0});Q_.getAggregateAnnotation=f5e;Q_.getColumnAnnotations=p5e;Q_.getSuggestionAffectedRanges=v5e;Q_.getSuggestionsAnnotations=Nde;Q_.suggestionCountByType=m5e;Q_.suggestionsToShowCountByType=g5e;var UD=Vk(),AP=Kk(),KD=PP();function f5e(e){return e.find(UD.CleanDataResolverAnnotation.typeGuard)}function p5e(e){return e.filter(AP.TableLintColumnAnnotation.typeGuard)}function Nde(e){return(0,KD.flat)([e.filter(AP.TableLintColumnAnnotation.typeGuard),e.filter(UD.ExtraSpacesTableAnnotation.typeGuard)])}function m5e(e){var r=Ode(e);return(0,KD.countBy)(r,kde)}function g5e(e,r){var t=Ode(e),n=t.filter(function(a){return r.indexOf(a.id)===-1});return(0,KD.countBy)(n,kde)}function Ode(e){return(0,KD.flat)(Nde(e).map(function(r){return AP.TableLintColumnAnnotation.typeGuard(r)?r.suggestions:[r]}))}function kde(e){return UD.ExtraSpacesTableAnnotation.typeGuard(e)?"ExtraSpaces":e.type}function v5e(e){var r=new Set;return e.forEach(function(t){h5e(t).forEach(function(n){return r.add(n)})}),r}function h5e(e){var r=new Set;return AP.TableLintColumnAnnotation.typeGuard(e)?e.suggestions.forEach(function(t){AP.TableLintTextInconsistencySuggestion.typeGuard(t)?S5e(t).forEach(function(n){return r.add(n)}):AP.TableLintNumberFormattingInconsistencySuggestion.typeGuard(t)&&y5e(t).forEach(function(n){return r.add(n)})}):UD.ExtraSpacesTableAnnotation.typeGuard(e)&&_5e(e).forEach(function(t){return r.add(t)}),r}function S5e(e){var r=new Set;return e.variations.forEach(function(t){t.value!==e.suggestedValue.value&&t.ranges.forEach(function(n){return r.add(n)})}),r}function y5e(e){var r=new Set;return e.otherFormats.forEach(function(t){t.value!==e.suggestedFormat.value&&t.ranges.forEach(function(n){return r.add(n)})}),r}function _5e(e){var r=new Set;return e.rangesWithLeading.forEach(function(t){return r.add(t)}),e.rangesWithTrailing.forEach(function(t){return r.add(t)}),e.rangesWithInBetween.forEach(function(t){return r.add(t)}),r}});var KH=T(jD=>{p();Object.defineProperty(jD,"__esModule",{value:!0});jD.logDependentSuggestionsInfo=C5e;jD.logPotentialSuggestionsInfo=b5e;var VD=jk(),Y_=PP(),X_=od();function b5e(e,r,t){var n;X_.ULS.sendTraceTag(509698241,X_.LogCategory.msoulscat_ES_EWAJS,t?X_.TraceLevel.Important:X_.TraceLevel.Info,"SuggestionsTelemetry.logPotentialSuggestionsInfo: ".concat(JSON.stringify((n={},n.sheetId=e,n.suggestionsInfo=T5e((0,VD.getSuggestionsAnnotations)(r)),n.numberFormatTypes=R5e((0,VD.getColumnAnnotations)(r)),n),Y_.mapReplacer)))}function C5e(e,r,t,n){var a,o=P5e((0,VD.getColumnAnnotations)(r));X_.ULS.sendTraceTag(507561155,X_.LogCategory.msoulscat_ES_EWAJS,t?X_.TraceLevel.Important:X_.TraceLevel.Info,"SuggestionsTelemetry.logDependentSuggestions: ".concat(JSON.stringify((a={},a.sheetId=e,a.dependentPivotTablesSuggestionsInfo=o,a.dependentFormulasSuggestionsInfo=n,a),Y_.mapReplacer)))}function T5e(e){var r=new Map,t=(0,Y_.groupBy)(e,function(n){return n.tableIdentifier});return t.forEach(function(n,a){r.set(a,(0,VD.suggestionCountByType)(n))}),r}function R5e(e){var r=(0,Y_.flat)(e.map(function(t){return t.suggestions.filter(E5e)}));return(0,Y_.countBy)(r,function(t){return t.variationsType})}function E5e(e){return e.type==="NumberFormattingInconsistency"}function P5e(e){var r=new Map,t=(0,Y_.groupBy)(e,function(n){return n.tableIdentifier});return t.forEach(function(n,a){var o=new Set((0,Y_.flat)((0,Y_.flat)(n.map(function(u){return u.suggestions})).map(function(u){var s;return(s=u.dependentPivotTableNames)!==null&&s!==void 0?s:[]})));o.size>0&&r.set(a,o.size)}),r}});var xde=T(FP=>{p();Object.defineProperty(FP,"__esModule",{value:!0});FP.importantEventFlags=FP.createActivatedEventsEvent=void 0;var Mde=fe(),Wk=JS(),A5e=[(0,Wk.makeStringDataField)("featureNameField","DataCleansing"),(0,Wk.makeStringDataField)("ver","1.0.0")],F5e=FP.importantEventFlags={dataCategories:Wk.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:Wk.EnumObjects.SamplingPolicy.CriticalBusinessImpact,diagnosticLevel:Wk.EnumObjects.DiagnosticLevel.RequiredServiceData},AVr=FP.createActivatedEventsEvent=function(){return{eventName:"Office.Excel.Client.DataCleansing.ActivatedEvents",eventFlags:F5e,dataFields:(0,Mde.__spreadArray)([],(0,Mde.__read)(A5e),!1)}}});var Dde=T(HD=>{p();Object.defineProperty(HD,"__esModule",{value:!0});HD.AnnotationsManager=void 0;var J_=fe(),Pa=od(),VH=Vk(),jH=Kk(),WD=mi(),N5e=KH(),Hk=PP(),O5e=w1(),k5e=xde(),M5e=x5e(jk());function wde(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,t=new WeakMap;return(wde=function(a){return a?t:r})(e)}function x5e(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=wde(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}var Ide="sheetAnnotationsChanged",OVr=HD.AnnotationsManager=function(){function e(r,t,n){var a=this;this.annotationsProvider=r,this.sessionStorage=t,this.annotationsHostCallbacks=n,this.eventTarget=new EventTarget,this.sheetsWithPotentialSuggestion=[],this.resolverAnnotationBySheet=new Map,this.pendingSuggestionsAnnotations=new Map,this.suggestionsAnnotationsByResolverAnnotationId=new Map,this.pauseAnnotationsCount=0,this.resumeAnnotationsCount=0,this.annotationsCountSinceLastResume=0,this.getSheetVisibleSuggestionCountByType=function(o){return(0,J_.__awaiter)(a,void 0,void 0,function(){var u,s,l,c;return(0,J_.__generator)(this,function(d){switch(d.label){case 0:return u=this.sheetAnnotations(o),this.sessionStorage?[4,this.sessionStorage.getIgnoredSuggestions()]:[3,2];case 1:return l=d.sent(),[3,3];case 2:l=[],d.label=3;case 3:return s=l,c=M5e.suggestionsToShowCountByType(u,s),(0,WD.getBooleanFeatureGate)("Microsoft.Office.Excel.AugLoop.TableLint_EnableDateFormat")&&(Pa.ULS.sendTraceTag(507040399,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Info,"Discoverability.getSheetVisibleSuggestionCountByType: Detected date format."),c.has("DateFormat")&&this.shouldIgnoreDateFormatSuggestions()&&c.delete("DateFormat")),[2,c]}})})},this.onSuggestionsAnnotationReceived=function(o){a.annotationsCountSinceLastResume++,a.pendingSuggestionsAnnotations.set(o.id,o),Pa.ULS.sendTraceTag(508343936,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Verbose,"AnnotationsManager.onColumnAnnotationReceived: Received ".concat(o.id))},this.shouldIgnoreDateFormatSuggestions=function(){var o=a.annotationsHostCallbacks?a.annotationsHostCallbacks.getDataCulture():void 0;return!(0,WD.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansing_ShowDateFormat")||!o||o!=="en-US"},this.onAggregateAnnotationReceived=function(o){var u;a.annotationsCountSinceLastResume++;var s=a.resolverAnnotationBySheet.get(o.worksheetId);(0,WD.getBooleanFeatureGate)("Microsoft.Office.Excel.AugLoop.sendCleanDataAnnotationsInResolver",!1)&&a.compareResolverAndPendingAnnotations(o),(0,WD.getBooleanFeatureGate)("Microsoft.Office.Excel.RegisterOnlyResolverAnnotation",!1)&&a.populatePendingSuggestionAnnotations(o),Pa.ULS.sendTraceTag(508343907,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Info,"AnnotationsManager.onAggregateAnnotationReceived: Received ".concat(JSON.stringify((u={},u.id=o.id,u.sheetId=o.worksheetId,u.previous=s==null?void 0:s.id,u)))),(s==null?void 0:s.id)===o.id&&Pa.ULS.sendTraceTag(508343906,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Info,"AnnotationsManager.onAggregateAnnotationReceived: Received duplicate ".concat(o.id)),a.resolverAnnotationBySheet.set(o.worksheetId,o);var l=a.getRelatedPendingAnnotations(o);l.forEach(function(c){a.pendingSuggestionsAnnotations.delete(c.id)}),a.suggestionsAnnotationsByResolverAnnotationId.set(o.id,l),a.logPotentialSuggestions(l,o.worksheetId),a.annotationsChanged(o.worksheetId)},Pa.ULS.sendTraceTag(507777626,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Info,"AnnotationsManager.constructor: AnnotationsManager is created.")}return e.prototype.registerSheetAnnotationsChanged=function(r){this.eventTarget.addEventListener(Ide,function(t){r(t==null?void 0:t.detail)})},e.prototype.pauseAugmentationLoop=function(r){this.pauseAnnotationsCount++,Pa.ULS.sendTraceTag(507881231,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Info,"AnnotationsManager.pauseAugmentationLoop: pausing augmentation loop count: ".concat(this.pauseAnnotationsCount,", reason: ").concat(r,", annotationsCountSinceLastResume: ").concat(this.annotationsCountSinceLastResume)),this.annotationsProvider.deactivateEvents()},e.prototype.resumeAugmentationLoop=function(r){this.resumeAnnotationsCount++,this.annotationsCountSinceLastResume=0,Pa.ULS.sendTraceTag(507881230,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Info,"AnnotationsManager.resumeAugmentationLoop: resuming augmentation loop count: ".concat(this.resumeAnnotationsCount,", reason: ").concat(r)),this.annotationsProvider.activateEvents()},e.prototype.activateEvents=function(){return(0,J_.__awaiter)(this,void 0,void 0,function(){return(0,J_.__generator)(this,function(r){return this.annotationsProvider?(this.annotationsProvider.registerSuggestionsAnnotationReceived(this.onSuggestionsAnnotationReceived),this.annotationsProvider.registerResolverAnnotationReceived(this.onAggregateAnnotationReceived),this.annotationsProvider.activateEvents(),Pa.ULS.sendTraceTag(508343939,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Important,"AnnotationsManager.activateEvents: events activated"),(0,O5e.getTelemetryLogger)().sendTelemetryEvent((0,k5e.createActivatedEventsEvent)())):Pa.ULS.sendTraceTag(508343938,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Error,"AnnotationsManager.activateEvents: no annotationsProvider"),[2]})})},e.prototype.sheetAnnotations=function(r){var t,n=this.resolverAnnotationBySheet.get(r);if(n){var a=(t=this.suggestionsAnnotationsByResolverAnnotationId.get(n.id))!==null&&t!==void 0?t:[];return(0,J_.__spreadArray)([n],(0,J_.__read)(a),!1)}return[]},e.prototype.allAnnotations=function(){var r=this,t=[];return this.resolverAnnotationBySheet.forEach(function(n){var a,o=(a=r.suggestionsAnnotationsByResolverAnnotationId.get(n.id))!==null&&a!==void 0?a:[];t.push.apply(t,(0,J_.__spreadArray)([n],(0,J_.__read)(o),!1))}),t},e.prototype.annotationsChanged=function(r){var t={sheetId:r,annotations:this.sheetAnnotations(r)};this.eventTarget.dispatchEvent(new CustomEvent(Ide,{detail:t}))},e.prototype.compareResolverAndPendingAnnotations=function(r){var t=this.getRelatedPendingAnnotations(r),n=t.filter(VH.ExtraSpacesTableAnnotation.typeGuard).map(function(c){return c.id}),a=t.filter(jH.TableLintColumnAnnotation.typeGuard).map(function(c){return c.id}),o=r.cleanDataAnnotations.filter(VH.ExtraSpacesTableAnnotation.typeGuard).map(function(c){return c.id}),u=(0,Hk.flat)(r.cleanDataAnnotations.filter(jH.TableLintWorksheetAggregateAnnotation.typeGuard).map(function(c){return c.columnAnnotations})).map(function(c){return c.id}),s=l();Pa.ULS.sendTraceTag(507327824,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Info,JSON.stringify(s));function l(){var c={error:!1,extraSpacesInResolverButNotInPending:(0,Hk.difference)(o,n).length,tableLintInResolverButNotInPending:(0,Hk.difference)(u,a).length,extraSpacesInPendingButNotInResolver:(0,Hk.difference)(n,o).length,tableLintInPendingButNotInResolver:(0,Hk.difference)(a,u).length};return c.error=c.extraSpacesInResolverButNotInPending+c.tableLintInResolverButNotInPending+c.extraSpacesInPendingButNotInResolver+c.tableLintInPendingButNotInResolver>0,c}},e.prototype.populatePendingSuggestionAnnotations=function(r){var t=this,n={extraSpacesInResolver:0,tableLintInResolver:0};r.cleanDataAnnotations.forEach(function(a){VH.ExtraSpacesTableAnnotation.typeGuard(a)?(n.extraSpacesInResolver++,t.pendingSuggestionsAnnotations.set(a.id,a)):jH.TableLintWorksheetAggregateAnnotation.typeGuard(a)&&a.columnAnnotations.forEach(function(o){n.tableLintInResolver++,t.pendingSuggestionsAnnotations.set(o.id,o)})}),Pa.ULS.sendTraceTag(507327771,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Info,JSON.stringify(n))},e.prototype.logPotentialSuggestions=function(r,t){var n=!this.sheetsWithPotentialSuggestion.includes(t);(0,N5e.logPotentialSuggestionsInfo)(t,r,n),n&&this.sheetsWithPotentialSuggestion.push(t)},e.prototype.getRelatedPendingAnnotations=function(r){var t=Array.from(this.pendingSuggestionsAnnotations.values()).filter(function(u){return u.worksheetId===r.worksheetId});if(!t.length)return Pa.ULS.sendTraceTag(508343905,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Info,"AnnotationsManager.getRelatedPendingAnnotations: No pending sheet annotations"),[];var n=new Set(r.aggregatedAnnotations),a=t.filter(function(u){return n.has(u.id)}),o=t.filter(function(u){return!n.has(u.id)});return o.length&&Pa.ULS.sendTraceTag(508343903,Pa.LogCategory.msoulscat_ES_EWAJS,Pa.TraceLevel.Info,"AnnotationsManager.getRelatedPendingAnnotations: Found ".concat(o.length," unrelated annotations")),a},e}()});var Lde=T(WH=>{p();Object.defineProperty(WH,"__esModule",{value:!0});WH.initializeExcelCleanData=w5e;var I5e=od();function w5e(e){(0,I5e.initializeLogger)(e)}});var Ude=T(zD=>{p();Object.defineProperty(zD,"__esModule",{value:!0});zD.SessionStorage=void 0;var Tc=fe(),D5e=mi(),NP=od(),qde=100,Gde="ignoredSuggestionsChanged",Bde="appliedSuggestionsChanged",wVr=zD.SessionStorage=function(){function e(r){this.roamingOperations=r,this._ignoredSuggestionsIds=new Set,this._appliedSuggestionsIds=new Set,this.eventTarget=new EventTarget,this.isSessionStorageReady=this.initialize()}return Object.defineProperty(e.prototype,"ignoredSuggestionsIds",{get:function(){return this._ignoredSuggestionsIds},set:function(t){this._ignoredSuggestionsIds=t,this.eventTarget.dispatchEvent(new CustomEvent(Gde,{detail:Array.from(this.ignoredSuggestionsIds)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appliedSuggestionsIds",{get:function(){return this._appliedSuggestionsIds},set:function(t){this._appliedSuggestionsIds=t,(0,D5e.getBooleanFeatureGate)("Microsoft.Office.Excel.AddAppliedIdsToProps",!1)&&this.eventTarget.dispatchEvent(new CustomEvent(Bde,{detail:Array.from(this.appliedSuggestionsIds)}))},enumerable:!1,configurable:!0}),e.getInstance=function(r){return e.instance||(e.instance=new e(r)),e.instance},e.prototype.registerIgnoredSuggestionsChanged=function(r){this.eventTarget.addEventListener(Gde,function(t){r(t==null?void 0:t.detail)})},e.prototype.registerAppliedSuggestionsChanged=function(r){this.eventTarget.addEventListener(Bde,function(t){r(t==null?void 0:t.detail)})},e.prototype.getIgnoredSuggestions=function(){return(0,Tc.__awaiter)(this,void 0,void 0,function(){return(0,Tc.__generator)(this,function(r){switch(r.label){case 0:return[4,this.isSessionStorageReady];case 1:return r.sent(),[2,Array.from(this.ignoredSuggestionsIds)]}})})},e.prototype.addToIgnoredSuggestions=function(r){return(0,Tc.__awaiter)(this,void 0,void 0,function(){return(0,Tc.__generator)(this,function(t){switch(t.label){case 0:return[4,this.isSessionStorageReady];case 1:return t.sent(),this.writeIgnoredSuggestionInMemory(r),this.writeIgnoredSuggestionsInRoaming(),[2]}})})},e.prototype.getAppliedSuggestions=function(){return(0,Tc.__awaiter)(this,void 0,void 0,function(){return(0,Tc.__generator)(this,function(r){switch(r.label){case 0:return[4,this.isSessionStorageReady];case 1:return r.sent(),[2,Array.from(this.appliedSuggestionsIds)]}})})},e.prototype.addToAppliedSuggestions=function(r){return(0,Tc.__awaiter)(this,void 0,void 0,function(){return(0,Tc.__generator)(this,function(t){switch(t.label){case 0:return[4,this.isSessionStorageReady];case 1:return t.sent(),this.appliedSuggestionsIds=new Set((0,Tc.__spreadArray)((0,Tc.__spreadArray)([],(0,Tc.__read)(Array.from(this.appliedSuggestionsIds)),!1),[r],!1)),[2]}})})},e.prototype.removeFromAppliedSuggestions=function(r){return(0,Tc.__awaiter)(this,void 0,void 0,function(){return(0,Tc.__generator)(this,function(t){switch(t.label){case 0:return[4,this.isSessionStorageReady];case 1:return t.sent(),this.appliedSuggestionsIds=new Set(Array.from(this.appliedSuggestionsIds).filter(function(n){return n!==r})),[2]}})})},e.prototype.writeIgnoredSuggestionInMemory=function(r){this.ignoredSuggestionsIds=new Set((0,Tc.__spreadArray)((0,Tc.__spreadArray)([],(0,Tc.__read)(Array.from(this.ignoredSuggestionsIds)),!1),[r],!1))},e.prototype.writeIgnoredSuggestionsInRoaming=function(){var r=0;this.ignoredSuggestionsIds.size>qde&&(r=this.ignoredSuggestionsIds.size-qde,NP.ULS.sendTraceTag(507577610,NP.LogCategory.msoulscat_ES_EWAJS,NP.TraceLevel.Important,"SessionStorage.writeIgnoredSuggestionsInRoaming: amount of ignored suggestions has crossed the limit, deleted ".concat(r," ids.")));var t=new Set(Array.from(this.ignoredSuggestionsIds).slice(r)),n=Array.from(t);NP.ULS.sendTraceTag(507339908,NP.LogCategory.msoulscat_ES_EWAJS,NP.TraceLevel.Info,"SessionStorage.writeIgnoredSuggestionsInRoaming: ignoredSuggestions.size: ".concat(n.length));var a=JSON.stringify(n);this.roamingOperations.writeIgnoredSuggestionsString(a)},e.prototype.initialize=function(){return(0,Tc.__awaiter)(this,void 0,void 0,function(){var r,t,n;return(0,Tc.__generator)(this,function(a){switch(a.label){case 0:return[4,this.roamingOperations.readIgnoredSuggestionsString()];case 1:return r=a.sent(),t=r?JSON.parse(r):[],n=new Set(t),n&&(this.ignoredSuggestionsIds=n),[2]}})})},e}()});var Vde=T(Kde=>{p();Object.defineProperty(Kde,"__esModule",{value:!0})});var Wde=T(QD=>{p();Object.defineProperty(QD,"__esModule",{value:!0});QD.DiscoverabilityAction=void 0;var jde;(function(e){e.None="None",e.ShowBusinessBar="ShowBusinessBar",e.HideBusinessBar="HideBusinessBar"})(jde||(QD.DiscoverabilityAction=jde={}))});var zde=T(Hde=>{p();Object.defineProperty(Hde,"__esModule",{value:!0})});var Xde=T(Qde=>{p();Object.defineProperty(Qde,"__esModule",{value:!0})});var Jde=T(Yde=>{p();Object.defineProperty(Yde,"__esModule",{value:!0})});var $de=T(Zde=>{p();Object.defineProperty(Zde,"__esModule",{value:!0})});var rfe=T(efe=>{p();Object.defineProperty(efe,"__esModule",{value:!0})});var tfe=T(us=>{p();Object.defineProperty(us,"__esModule",{value:!0});var HH=Vde();Object.keys(HH).forEach(function(e){e==="default"||e==="__esModule"||e in us&&us[e]===HH[e]||Object.defineProperty(us,e,{enumerable:!0,get:function(){return HH[e]}})});var zH=Wde();Object.keys(zH).forEach(function(e){e==="default"||e==="__esModule"||e in us&&us[e]===zH[e]||Object.defineProperty(us,e,{enumerable:!0,get:function(){return zH[e]}})});var QH=zde();Object.keys(QH).forEach(function(e){e==="default"||e==="__esModule"||e in us&&us[e]===QH[e]||Object.defineProperty(us,e,{enumerable:!0,get:function(){return QH[e]}})});var XH=Xde();Object.keys(XH).forEach(function(e){e==="default"||e==="__esModule"||e in us&&us[e]===XH[e]||Object.defineProperty(us,e,{enumerable:!0,get:function(){return XH[e]}})});var YH=Jde();Object.keys(YH).forEach(function(e){e==="default"||e==="__esModule"||e in us&&us[e]===YH[e]||Object.defineProperty(us,e,{enumerable:!0,get:function(){return YH[e]}})});var JH=$de();Object.keys(JH).forEach(function(e){e==="default"||e==="__esModule"||e in us&&us[e]===JH[e]||Object.defineProperty(us,e,{enumerable:!0,get:function(){return JH[e]}})});var ZH=rfe();Object.keys(ZH).forEach(function(e){e==="default"||e==="__esModule"||e in us&&us[e]===ZH[e]||Object.defineProperty(us,e,{enumerable:!0,get:function(){return ZH[e]}})})});var ife=T(XD=>{p();Object.defineProperty(XD,"__esModule",{value:!0});XD.DiscoverabilityEngine=void 0;var og=fe(),L5e=afe(PP()),q5e=afe(jk()),Xv=tfe(),G1=mi(),$H=od();function nfe(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,t=new WeakMap;return(nfe=function(a){return a?t:r})(e)}function afe(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=nfe(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}var ejr=XD.DiscoverabilityEngine=function(){function e(r,t){var n=this;this.annotationsManager=r,this.sessionStorage=t,this.businessBarDataBySheetId=new Map,this.getBusinessBarActionAndData=function(a,o,u,s){return(0,og.__awaiter)(n,void 0,void 0,function(){var l,c,d,f,m,v,h;return(0,og.__generator)(this,function(y){switch(y.label){case 0:return l=(0,G1.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansingBusinessBarOnDifferentSheet",!1),l?(0,G1.isChangeGateEnabled)("OfficeVSO:8971982_DataCleansingFixBBAppearingInNSVAndProtected")?s?[4,this.updateBusinessBarDataMap(s)]:[3,2]:[3,3]:[3,5];case 1:y.sent(),y.label=2;case 2:return[3,5];case 3:return o?[4,this.getActionAndSuggetionCount(o)]:[3,5];case 4:c=y.sent(),d=c.action,f=c.suggestionCount,d===Xv.DiscoverabilityAction.ShowBusinessBar&&this.businessBarDataBySheetId.set(o,{suggestionCount:f,sheetName:u}),y.label=5;case 5:return this.didSheetReceiveAnnotations(a)?[4,this.getActionAndSuggetionCount(a)]:[2,{action:Xv.DiscoverabilityAction.None}];case 6:return m=y.sent(),v=m.action,h=m.suggestionCount,v===Xv.DiscoverabilityAction.ShowBusinessBar?[2,{action:v,businessBarData:{suggestionCount:h,isDifferentThanActiveSheet:!1}}]:l?[2,this.getDataForSheetWithMaxSuggestions(a)]:[2,{action:Xv.DiscoverabilityAction.None}]}})})},this.updateBusinessBarDataMap=function(a){return(0,og.__awaiter)(n,void 0,void 0,function(){var o,u,s;return(0,og.__generator)(this,function(l){switch(l.label){case 0:return a.sheetId?(0,G1.isChangeGateEnabled)("OfficeVSO:9009903_DataCleansingFixHiddenSheetBug")||!a.isProtected&&!a.isInNamedSheetView?[4,this.getActionAndSuggetionCount(a.sheetId)]:[3,2]:[3,2];case 1:o=l.sent(),u=o.action,s=o.suggestionCount,u===Xv.DiscoverabilityAction.ShowBusinessBar?(0,G1.isChangeGateEnabled)("OfficeVSO:9009903_DataCleansingFixHiddenSheetBug")&&(a.isProtected||a.isInNamedSheetView||a.isHidden)?$H.ULS.sendTraceTag(507015510,$H.LogCategory.msoulscat_ES_EWAJS,$H.TraceLevel.Info,"Discoverability.updateBusinessBarDataMap: Found suggestions for disqualified sheet. SheetId: [".concat(a.sheetId,"] suggestionCount: [").concat(s,"] isProtected: [").concat(a.isProtected,"] isInNamedSheetView: [").concat(a.isInNamedSheetView,"] isHidden: [").concat(a.isHidden,"]")):this.businessBarDataBySheetId.set(a.sheetId,{suggestionCount:s,sheetName:a.sheetName}):(0,G1.isChangeGateEnabled)("OfficeVSO:8994627_DataCleansingMinorCodeImprovements")&&this.businessBarDataBySheetId.delete(a.sheetId),l.label=2;case 2:return[2]}})})},this.getDataForSheetWithMaxSuggestions=function(a){var o,u;if((0,G1.isChangeGateEnabled)("OfficeVSO:8994627_DataCleansingMinorCodeImprovements")){var s=void 0,l=0,c=void 0;try{for(var d=(0,og.__values)(n.businessBarDataBySheetId),f=d.next();!f.done;f=d.next()){var m=(0,og.__read)(f.value,2),v=m[0],h=m[1];h.suggestionCount>l&&(s=v,l=h.suggestionCount,c=h.sheetName)}}catch(_){o={error:_}}finally{try{f&&!f.done&&(u=d.return)&&u.call(d)}finally{if(o)throw o.error}}return l>0?{action:Xv.DiscoverabilityAction.ShowBusinessBar,businessBarData:{suggestionCount:l,isDifferentThanActiveSheet:s!==a,sheetName:c}}:{action:Xv.DiscoverabilityAction.None}}var y=Array.from(n.businessBarDataBySheetId.values()).reduce(function(_,E){return E.suggestionCount>_.suggestionCount?E:_},{suggestionCount:0});return y.suggestionCount!==0?{action:Xv.DiscoverabilityAction.ShowBusinessBar,businessBarData:(0,og.__assign)((0,og.__assign)({},y),{isDifferentThanActiveSheet:!0})}:{action:Xv.DiscoverabilityAction.None}},this.getActionAndSuggetionCount=function(a){return(0,og.__awaiter)(n,void 0,void 0,function(){var o,u,s,l;return(0,og.__generator)(this,function(c){switch(c.label){case 0:return(0,G1.isChangeGateEnabled)("OfficeVSO:8986384_sessionStorageAtAnnotationManager")?[4,this.annotationsManager.getSheetVisibleSuggestionCountByType(a)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,this.sheetSuggestionCounts(a)];case 3:u=c.sent(),c.label=4;case 4:return o=u,s=L5e.sum(o.values()),l=s>=2&&o.get("TextInconsistency")?Xv.DiscoverabilityAction.ShowBusinessBar:Xv.DiscoverabilityAction.None,[2,{action:l,suggestionCount:s}]}})})},this.didSheetReceiveAnnotations=function(a){return n.annotationsManager.sheetAnnotations(a).length>0},this.sheetSuggestionCounts=function(a){return(0,og.__awaiter)(n,void 0,void 0,function(){var o,u;return(0,og.__generator)(this,function(s){switch(s.label){case 0:return o=this.annotationsManager.sheetAnnotations(a),[4,this.sessionStorage.getIgnoredSuggestions()];case 1:return u=s.sent(),[2,q5e.suggestionsToShowCountByType(o,u)]}})})}}return e}()});var ofe=T(Cs=>{p();Object.defineProperty(Cs,"__esModule",{value:!0});var OP={ExcelCleanDataGlobal:!0};Cs.ExcelCleanDataGlobal=void 0;var YD=Dde();Object.keys(YD).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(OP,e)||e in Cs&&Cs[e]===YD[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return YD[e]}})});var ry=jk();Object.keys(ry).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(OP,e)||e in Cs&&Cs[e]===ry[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return ry[e]}})});var s0=PP();Object.keys(s0).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(OP,e)||e in Cs&&Cs[e]===s0[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return s0[e]}})});var JD=KH();Object.keys(JD).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(OP,e)||e in Cs&&Cs[e]===JD[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return JD[e]}})});var ZD=Lde();Object.keys(ZD).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(OP,e)||e in Cs&&Cs[e]===ZD[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return ZD[e]}})});var $D=Ude();Object.keys($D).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(OP,e)||e in Cs&&Cs[e]===$D[e]||Object.defineProperty(Cs,e,{enumerable:!0,get:function(){return $D[e]}})});var G5e=ife(),njr=Cs.ExcelCleanDataGlobal={annotationsUtils:{getAggregateAnnotation:ry.getAggregateAnnotation,getColumnAnnotations:ry.getColumnAnnotations,getSuggestionsAnnotations:ry.getSuggestionsAnnotations,suggestionCountByType:ry.suggestionCountByType,suggestionsToShowCountByType:ry.suggestionsToShowCountByType,getSuggestionAffectedRanges:ry.getSuggestionAffectedRanges},listsUtils:{countBy:s0.countBy,groupBy:s0.groupBy,getOrCreateMapItem:s0.getOrCreateMapItem,flat:s0.flat,objectFromEntries:s0.objectFromEntries,mapReplacer:s0.mapReplacer,sum:s0.sum},suggestionsTelemetryUtils:{logDependentSuggestionsInfo:JD.logDependentSuggestionsInfo},createAnnotationsManger:function(r,t,n){return new YD.AnnotationsManager(r,t,n)},createDiscoverabilityEngine:function(r,t){return new G5e.DiscoverabilityEngine(r,t)},init:function(r){(0,ZD.initializeExcelCleanData)(r)},getOrCreateSessionStorage:function(r){return $D.SessionStorage.getInstance(r)}}});var ufe=T(kP=>{p();Object.defineProperty(kP,"__esModule",{value:!0});kP.nativeNamespace=kP.RoamingType=void 0;var ojr=kP.nativeNamespace="Uxpp.Internal.RekaServices",ujr=kP.RoamingType=function(e){return e[e.DataCleansingIgnoredSuggestions=0]="DataCleansingIgnoredSuggestions",e}({})});var lfe=T(B1=>{p();Object.defineProperty(B1,"__esModule",{value:!0});B1.NativeServices=void 0;Object.defineProperty(B1,"RoamingType",{enumerable:!0,get:function(){return U5e.RoamingType}});B1.ServiceInfos=void 0;var B5e=rl(),U5e=ufe();function K5e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function sfe(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j5e(n.key),n)}}function V5e(e,r,t){return r&&sfe(e.prototype,r),t&&sfe(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function j5e(e){var r=W5e(e,"string");return typeof r=="symbol"?r:String(r)}function W5e(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var H5e=B1.ServiceInfos={UxppRoamingService:["Uxpp::Internal::RekaServices::UxppRoamingService",{read:["ReturnsPromiseMethod","$string",["$number"]],write:["ReturnsPromiseMethod","$any",["$number","$string"]]}]},cjr=B1.NativeServices=function(){function e(){K5e(this,e)}return V5e(e,null,[{key:"UxppRoamingService",get:function(){return e._UxppRoamingService??=B5e.RekaServiceRegistry.getNativeService(H5e.UxppRoamingService)}}]),e}()});var cfe=T(n7=>{p();Object.defineProperty(n7,"__esModule",{value:!0});n7.initDataCleansing=tVe;var z5e=ode(),Q5e=pde(),X5e=Sde(),Y5e=lP(),J5e=i0(),Z5e=Ede(),e7=od(),$5e=w1(),eVe=Pde(),r7=JS(),t7=ofe(),rVe=mi(),eL=lfe();function MP(){"use strict";MP=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(C,S,b){C[S]=b.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(C,S,b){return Object.defineProperty(C,S,{value:b,enumerable:!0,configurable:!0,writable:!0}),C[S]}try{c({},"")}catch(C){c=function(b,O,w){return b[O]=w}}function d(C,S,b,O){var w=S&&S.prototype instanceof E?S:E,D=Object.create(w.prototype),Q=new Z(O||[]);return a(D,"_invoke",{value:j(C,b,Q)}),D}function f(C,S,b){try{return{type:"normal",arg:C.call(S,b)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var m="suspendedStart",v="suspendedYield",h="executing",y="completed",_={};function E(){}function N(){}function k(){}var q={};c(q,u,function(){return this});var V=Object.getPrototypeOf,I=V&&V(V(J([])));I&&I!==t&&n.call(I,u)&&(q=I);var M=k.prototype=E.prototype=Object.create(q);function B(C){["next","throw","return"].forEach(function(S){c(C,S,function(b){return this._invoke(S,b)})})}function U(C,S){function b(w,D,Q,W){var $=f(C[w],C,D);if($.type!=="throw"){var me=$.arg,ve=me.value;return ve&&typeof ve=="object"&&n.call(ve,"__await")?S.resolve(ve.__await).then(function(Pe){b("next",Pe,Q,W)},function(Pe){b("throw",Pe,Q,W)}):S.resolve(ve).then(function(Pe){me.value=Pe,Q(me)},function(Pe){return b("throw",Pe,Q,W)})}W($.arg)}var O;a(this,"_invoke",{value:function(D,Q){function W(){return new S(function($,me){b(D,Q,$,me)})}return O=O?O.then(W,W):W()}})}function j(C,S,b){var O=m;return function(w,D){if(O===h)throw new Error("Generator is already running");if(O===y){if(w==="throw")throw D;return{value:e,done:!0}}for(b.method=w,b.arg=D;;){var Q=b.delegate;if(Q){var W=X(Q,b);if(W){if(W===_)continue;return W}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(O===m)throw O=y,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);O=h;var $=f(C,S,b);if($.type==="normal"){if(O=b.done?y:v,$.arg===_)continue;return{value:$.arg,done:b.done}}$.type==="throw"&&(O=y,b.method="throw",b.arg=$.arg)}}}function X(C,S){var b=S.method,O=C.iterator[b];if(O===e)return S.delegate=null,b==="throw"&&C.iterator.return&&(S.method="return",S.arg=e,X(C,S),S.method==="throw")||b!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+b+"' method")),_;var w=f(O,C.iterator,S.arg);if(w.type==="throw")return S.method="throw",S.arg=w.arg,S.delegate=null,_;var D=w.arg;return D?D.done?(S[C.resultName]=D.value,S.next=C.nextLoc,S.method!=="return"&&(S.method="next",S.arg=e),S.delegate=null,_):D:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,_)}function ee(C){var S={tryLoc:C[0]};1 in C&&(S.catchLoc=C[1]),2 in C&&(S.finallyLoc=C[2],S.afterLoc=C[3]),this.tryEntries.push(S)}function re(C){var S=C.completion||{};S.type="normal",delete S.arg,C.completion=S}function Z(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(ee,this),this.reset(!0)}function J(C){if(C||C===""){var S=C[u];if(S)return S.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var b=-1,O=function w(){for(;++b<C.length;)if(n.call(C,b))return w.value=C[b],w.done=!1,w;return w.value=e,w.done=!0,w};return O.next=O}}throw new TypeError(typeof C+" is not iterable")}return N.prototype=k,a(M,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:N,configurable:!0}),N.displayName=c(k,l,"GeneratorFunction"),r.isGeneratorFunction=function(C){var S=typeof C=="function"&&C.constructor;return!!S&&(S===N||(S.displayName||S.name)==="GeneratorFunction")},r.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,k):(C.__proto__=k,c(C,l,"GeneratorFunction")),C.prototype=Object.create(M),C},r.awrap=function(C){return{__await:C}},B(U.prototype),c(U.prototype,s,function(){return this}),r.AsyncIterator=U,r.async=function(C,S,b,O,w){w===void 0&&(w=Promise);var D=new U(d(C,S,b,O),w);return r.isGeneratorFunction(S)?D:D.next().then(function(Q){return Q.done?Q.value:D.next()})},B(M),c(M,l,"Generator"),c(M,u,function(){return this}),c(M,"toString",function(){return"[object Generator]"}),r.keys=function(C){var S=Object(C),b=[];for(var O in S)b.push(O);return b.reverse(),function w(){for(;b.length;){var D=b.pop();if(D in S)return w.value=D,w.done=!1,w}return w.done=!0,w}},r.values=J,Z.prototype={constructor:Z,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(re),!S)for(var b in this)b.charAt(0)==="t"&&n.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=e)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var b=this;function O(me,ve){return Q.type="throw",Q.arg=S,b.next=me,ve&&(b.method="next",b.arg=e),!!ve}for(var w=this.tryEntries.length-1;w>=0;--w){var D=this.tryEntries[w],Q=D.completion;if(D.tryLoc==="root")return O("end");if(D.tryLoc<=this.prev){var W=n.call(D,"catchLoc"),$=n.call(D,"finallyLoc");if(W&&$){if(this.prev<D.catchLoc)return O(D.catchLoc,!0);if(this.prev<D.finallyLoc)return O(D.finallyLoc)}else if(W){if(this.prev<D.catchLoc)return O(D.catchLoc,!0)}else{if(!$)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return O(D.finallyLoc)}}}},abrupt:function(S,b){for(var O=this.tryEntries.length-1;O>=0;--O){var w=this.tryEntries[O];if(w.tryLoc<=this.prev&&n.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var D=w;break}}D&&(S==="break"||S==="continue")&&D.tryLoc<=b&&b<=D.finallyLoc&&(D=null);var Q=D?D.completion:{};return Q.type=S,Q.arg=b,D?(this.method="next",this.next=D.finallyLoc,_):this.complete(Q)},complete:function(S,b){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&b&&(this.next=b),_},finish:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),re(O),_}},catch:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.tryLoc===S){var w=O.completion;if(w.type==="throw"){var D=w.arg;re(O)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(S,b,O){return this.delegate={iterator:J(S),resultName:b,nextLoc:O},this.method==="next"&&(this.arg=e),_}},r}function tVe(e,r,t){var n,a,o,u,s,l,c;return MP().async(function(f){for(;;)switch(f.prev=f.next){case 0:if((0,rVe.getBooleanFeatureGate)("Microsoft.Office.Excel.DataCleansingDesktop",!1)){f.next=2;break}return f.abrupt("return");case 2:console.log("init DataCleansing"),n=new Q5e.AnnotationsProvider(e,r),a=t7.ExcelCleanDataGlobal.getOrCreateSessionStorage(nVe()),o=new X5e.SessionStorage(a),(0,t7.initializeExcelCleanData)(r),u=t7.ExcelCleanDataGlobal.createAnnotationsManger(n,o),s=new z5e.DataCleansingHostManager(u,r),l=new Z5e.StateProvider(n,r),t(s,l,o),c=new Y5e.PaneLifecycleManager(r),aVe(c);case 13:case"end":return f.stop()}},null,null,null,Promise)}function nVe(){var e="<Value>",r="</Value>";return{readIgnoredSuggestionsString:function(){var n,a,o;return MP().async(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,n=eL.NativeServices.UxppRoamingService,s.next=4,MP().awrap(n.read(eL.RoamingType.DataCleansingIgnoredSuggestions));case 4:return a=s.sent,o=a.substring(e.length,a.length-r.length),s.abrupt("return",o);case 9:return s.prev=9,s.t0=s.catch(0),console.error(s.t0),s.abrupt("return","[]");case 13:case"end":return s.stop()}},null,null,[[0,9]],Promise)},writeIgnoredSuggestionsString:function(n){var a;return MP().async(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,a=eL.NativeServices.UxppRoamingService,u.next=4,MP().awrap(a.write(eL.RoamingType.DataCleansingIgnoredSuggestions,e+n+r));case 4:u.next=9;break;case 6:u.prev=6,u.t0=u.catch(0),console.error(u.t0);case 9:case"end":return u.stop()}},null,null,[[0,6]],Promise)}}}function aVe(e){e.registerOnClose(function(r){r.taskPaneId===eVe.TaskPaneId.DataCleansingTaskPane&&((0,$5e.getTelemetryLogger)().sendTelemetryEvent({eventName:"Office.Excel.DataCleansing.UserClosedTaskPaneDesktopFloodgate",eventFlags:(0,J5e.getFilledEventFlags)(r7.EnumObjects.DataCategories.ProductServiceUsage,r7.EnumObjects.DiagnosticLevel.RequiredServiceData,r7.EnumObjects.SamplingPolicy.CriticalBusinessImpact)}),e7.ULS.sendTraceTag(508703251,e7.LogCategory.msoulscat_ES_EWAJS,e7.TraceLevel.Info,"init.registerOnClose: data cleansing survey, user closed the TP, was triggered"))})}});var dfe=T(i7=>{p();Object.defineProperty(i7,"__esModule",{value:!0});i7.default=uVe;var iVe=Rle(),oVe=cfe();function a7(){"use strict";a7=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(C,S,b){C[S]=b.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(C,S,b){return Object.defineProperty(C,S,{value:b,enumerable:!0,configurable:!0,writable:!0}),C[S]}try{c({},"")}catch(C){c=function(b,O,w){return b[O]=w}}function d(C,S,b,O){var w=S&&S.prototype instanceof E?S:E,D=Object.create(w.prototype),Q=new Z(O||[]);return a(D,"_invoke",{value:j(C,b,Q)}),D}function f(C,S,b){try{return{type:"normal",arg:C.call(S,b)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var m="suspendedStart",v="suspendedYield",h="executing",y="completed",_={};function E(){}function N(){}function k(){}var q={};c(q,u,function(){return this});var V=Object.getPrototypeOf,I=V&&V(V(J([])));I&&I!==t&&n.call(I,u)&&(q=I);var M=k.prototype=E.prototype=Object.create(q);function B(C){["next","throw","return"].forEach(function(S){c(C,S,function(b){return this._invoke(S,b)})})}function U(C,S){function b(w,D,Q,W){var $=f(C[w],C,D);if($.type!=="throw"){var me=$.arg,ve=me.value;return ve&&typeof ve=="object"&&n.call(ve,"__await")?S.resolve(ve.__await).then(function(Pe){b("next",Pe,Q,W)},function(Pe){b("throw",Pe,Q,W)}):S.resolve(ve).then(function(Pe){me.value=Pe,Q(me)},function(Pe){return b("throw",Pe,Q,W)})}W($.arg)}var O;a(this,"_invoke",{value:function(D,Q){function W(){return new S(function($,me){b(D,Q,$,me)})}return O=O?O.then(W,W):W()}})}function j(C,S,b){var O=m;return function(w,D){if(O===h)throw new Error("Generator is already running");if(O===y){if(w==="throw")throw D;return{value:e,done:!0}}for(b.method=w,b.arg=D;;){var Q=b.delegate;if(Q){var W=X(Q,b);if(W){if(W===_)continue;return W}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(O===m)throw O=y,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);O=h;var $=f(C,S,b);if($.type==="normal"){if(O=b.done?y:v,$.arg===_)continue;return{value:$.arg,done:b.done}}$.type==="throw"&&(O=y,b.method="throw",b.arg=$.arg)}}}function X(C,S){var b=S.method,O=C.iterator[b];if(O===e)return S.delegate=null,b==="throw"&&C.iterator.return&&(S.method="return",S.arg=e,X(C,S),S.method==="throw")||b!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+b+"' method")),_;var w=f(O,C.iterator,S.arg);if(w.type==="throw")return S.method="throw",S.arg=w.arg,S.delegate=null,_;var D=w.arg;return D?D.done?(S[C.resultName]=D.value,S.next=C.nextLoc,S.method!=="return"&&(S.method="next",S.arg=e),S.delegate=null,_):D:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,_)}function ee(C){var S={tryLoc:C[0]};1 in C&&(S.catchLoc=C[1]),2 in C&&(S.finallyLoc=C[2],S.afterLoc=C[3]),this.tryEntries.push(S)}function re(C){var S=C.completion||{};S.type="normal",delete S.arg,C.completion=S}function Z(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(ee,this),this.reset(!0)}function J(C){if(C||C===""){var S=C[u];if(S)return S.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var b=-1,O=function w(){for(;++b<C.length;)if(n.call(C,b))return w.value=C[b],w.done=!1,w;return w.value=e,w.done=!0,w};return O.next=O}}throw new TypeError(typeof C+" is not iterable")}return N.prototype=k,a(M,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:N,configurable:!0}),N.displayName=c(k,l,"GeneratorFunction"),r.isGeneratorFunction=function(C){var S=typeof C=="function"&&C.constructor;return!!S&&(S===N||(S.displayName||S.name)==="GeneratorFunction")},r.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,k):(C.__proto__=k,c(C,l,"GeneratorFunction")),C.prototype=Object.create(M),C},r.awrap=function(C){return{__await:C}},B(U.prototype),c(U.prototype,s,function(){return this}),r.AsyncIterator=U,r.async=function(C,S,b,O,w){w===void 0&&(w=Promise);var D=new U(d(C,S,b,O),w);return r.isGeneratorFunction(S)?D:D.next().then(function(Q){return Q.done?Q.value:D.next()})},B(M),c(M,l,"Generator"),c(M,u,function(){return this}),c(M,"toString",function(){return"[object Generator]"}),r.keys=function(C){var S=Object(C),b=[];for(var O in S)b.push(O);return b.reverse(),function w(){for(;b.length;){var D=b.pop();if(D in S)return w.value=D,w.done=!1,w}return w.done=!0,w}},r.values=J,Z.prototype={constructor:Z,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(re),!S)for(var b in this)b.charAt(0)==="t"&&n.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=e)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var b=this;function O(me,ve){return Q.type="throw",Q.arg=S,b.next=me,ve&&(b.method="next",b.arg=e),!!ve}for(var w=this.tryEntries.length-1;w>=0;--w){var D=this.tryEntries[w],Q=D.completion;if(D.tryLoc==="root")return O("end");if(D.tryLoc<=this.prev){var W=n.call(D,"catchLoc"),$=n.call(D,"finallyLoc");if(W&&$){if(this.prev<D.catchLoc)return O(D.catchLoc,!0);if(this.prev<D.finallyLoc)return O(D.finallyLoc)}else if(W){if(this.prev<D.catchLoc)return O(D.catchLoc,!0)}else{if(!$)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return O(D.finallyLoc)}}}},abrupt:function(S,b){for(var O=this.tryEntries.length-1;O>=0;--O){var w=this.tryEntries[O];if(w.tryLoc<=this.prev&&n.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var D=w;break}}D&&(S==="break"||S==="continue")&&D.tryLoc<=b&&b<=D.finallyLoc&&(D=null);var Q=D?D.completion:{};return Q.type=S,Q.arg=b,D?(this.method="next",this.next=D.finallyLoc,_):this.complete(Q)},complete:function(S,b){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&b&&(this.next=b),_},finish:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),re(O),_}},catch:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.tryLoc===S){var w=O.completion;if(w.type==="throw"){var D=w.arg;re(O)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(S,b,O){return this.delegate={iterator:J(S),resultName:b,nextLoc:O},this.method==="next"&&(this.arg=e),_}},r}function uVe(e){var r;return a7().async(function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("init DC module"),r=new iVe.AnnotationsProxy(e.logger),n.next=4,a7().awrap((0,oVe.initDataCleansing)(r,e.logger,e.registerServiceInstances));case 4:case"end":return n.stop()}},null,null,null,Promise)}});var Pfe=T(Yi=>{"use strict";p();Object.defineProperty(Yi,"__esModule",{value:!0});Yi.TableOrientation=Yi.RecognizedTablesMetadataState=Yi.ColumnFormulaSuggestionUpdateKind=Yi.SchedulerFeature=Yi.GotoCtrlClickResultKind=Yi.ValuePreviewResultKind=Yi.PositionKind=Yi.HighlightKind=Yi.PerCharacterExperimentResultKind=Yi.PluginAttachGroup=Yi.PluginGroup=Yi.PluginFactoryName=Yi.MessageType=Yi.EditorMessageType=void 0;var ffe;(function(e){e[e.FunctionMessage=0]="FunctionMessage"})(ffe||(Yi.EditorMessageType=ffe={}));var pfe;(function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"})(pfe||(Yi.MessageType=pfe={}));var mfe;(function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.GotoCtrlClickPlugin=18]="GotoCtrlClickPlugin",e[e.AutocompleteEnumPlugin=19]="AutocompleteEnumPlugin",e[e.FormulaByExamplePlugin=20]="FormulaByExamplePlugin",e[e.SetCellPrefetchPlugin=21]="SetCellPrefetchPlugin",e[e.FormulaTranspilerPlugin=22]="FormulaTranspilerPlugin",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin",e[e.EventsTestPlugin=2006]="EventsTestPlugin"})(mfe||(Yi.PluginFactoryName=mfe={}));var gfe;(function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"})(gfe||(Yi.PluginGroup=gfe={}));var vfe;(function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"})(vfe||(Yi.PluginAttachGroup=vfe={}));var hfe;(function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"})(hfe||(Yi.PerCharacterExperimentResultKind=hfe={}));var Sfe;(function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"})(Sfe||(Yi.HighlightKind=Sfe={}));var yfe;(function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"})(yfe||(Yi.PositionKind=yfe={}));var _fe;(function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"})(_fe||(Yi.ValuePreviewResultKind=_fe={}));var bfe;(function(e){e[e.ReferenceFound=0]="ReferenceFound",e[e.NoReferenceFound=1]="NoReferenceFound",e[e.Failure=2]="Failure",e[e.RangeResolutionFailure=3]="RangeResolutionFailure",e[e.NotAFormula=4]="NotAFormula"})(bfe||(Yi.GotoCtrlClickResultKind=bfe={}));var Cfe;(function(e){e[e.ArgumentAssistance=0]="ArgumentAssistance",e[e.SimpleAutoComplete=1]="SimpleAutoComplete",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete",e[e.ValuePreview=3]="ValuePreview",e[e.ColoredReferences=4]="ColoredReferences",e[e.ParenthesisCoupling=5]="ParenthesisCoupling",e[e.SyntaxErrors=6]="SyntaxErrors",e[e.GotoCtrlClick=7]="GotoCtrlClick",e[e.EnumAutoComplete=8]="EnumAutoComplete"})(Cfe||(Yi.SchedulerFeature=Cfe={}));var Tfe;(function(e){e[e.Accept=0]="Accept",e[e.Decline=1]="Decline",e[e.Ignore=2]="Ignore"})(Tfe||(Yi.ColumnFormulaSuggestionUpdateKind=Tfe={}));var Rfe;(function(e){e[e.Valid=2]="Valid",e[e.Invalid=4]="Invalid",e[e.All=6]="All"})(Rfe||(Yi.RecognizedTablesMetadataState=Rfe={}));var Efe;(function(e){e[e.none=0]="none",e[e.rowMajor=1]="rowMajor",e[e.columnMajor=2]="columnMajor"})(Efe||(Yi.TableOrientation=Efe={}))});var Ffe=T(va=>{"use strict";p();function sVe(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Afe(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cVe(n.key),n)}}function lVe(e,r,t){return r&&Afe(e.prototype,r),t&&Afe(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cVe(e){var r=dVe(e,"string");return typeof r=="symbol"?r:String(r)}function dVe(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}Object.defineProperty(va,"__esModule",{value:!0});va.ValuePreviewResultKind=va.TableOrientation=va.SchedulerFeature=va.RecognizedTablesMetadataState=va.PositionKind=va.PluginGroup=va.PluginFactoryName=va.PluginAttachGroup=va.PerCharacterExperimentResultKind=va.MessageType=va.HighlightKind=va.GotoCtrlClickResultKind=va.EditorMessageType=va.ColumnFormulaSuggestionUpdateKind=va.NativeServices=va.ServiceInfos=void 0;var U1=rl();U1.CustomTypeRegistry.registerTypeInfos({"X10::AnyObject":{},"X10::TestEventInput":{payload:"X10::AnyObject"},"X10::FormulaTranspilerInitEventInput":{payload:"X10::FormulaTranspilerInitEventPayload"},"X10::TableInterpretation":{tableLocation:"X10::RangeObject",confidence:"$number",headerRowCount:"$number",headerColumnCount:"$number",orientation:"$number"},"X10::RangeTableInfo":{sheetId:"$string",analyzedRange:"X10::RangeObject",interpretations:["$array","X10::TableInterpretation"]},"X10::RecognizedRangeTablesInfo":{rangeTableInfo:"X10::RangeTableInfo",metadataState:"$number"},"X10::InCellSuggestionResult":{completionItem:["opt-field","X10::CompletionItem"],data:["opt-field","X10::Data"]},"X10::ChatGPTQueryResult":{result:"$string",details:"$string"},"X10::SuggestionResult":{items:["$array","X10::CompletionItem"],data:["opt-field","X10::Data"]},"X10::RunExperimentResult":{},"X10::StringObject":{kind:"$string",text:"$string"},"X10::BooleanObject":{kind:"$string",flag:"$boolean"},"X10::NumberObject":{kind:"$string",num:"$number"},"X10::ErrorValueObject":{kind:"$string",errorValue:"$number"},"X10::FormulaSuggestionEvalSuccessResult":{kind:"$string",cell:"X10::RangeObject",value:["$union",["X10::StringObject","X10::BooleanObject","X10::NumberObject","X10::ErrorValueObject"]],formatted:["opt-field","X10::AnyObject"]},"X10::FormulaSuggestionEvalFailureResult":{kind:"$string",cell:"X10::RangeObject",error:"$string",innerErrorHint:["opt-field","$string"]},"X10::ColumnFormulaSuggestion":{kind:"$string",suggestionID:"$string",columnRange:"X10::RangeObject",tableName:"$string",tableColumnName:"$string",formula:"$string",evalResults:["$array",["$union",["X10::FormulaSuggestionEvalSuccessResult","X10::FormulaSuggestionEvalFailureResult"]]],metadata:"X10::AnyObject"},"X10::ColumnFormulaSuggestionFailure":{kind:"$string",suggestionID:"$string",reason:"$string",metadata:"X10::AnyObject"},"X10::ColumnFormulaSuggestionResult":{suggestions:["$array",["$union",["X10::ColumnFormulaSuggestion","X10::ColumnFormulaSuggestionFailure"]]]},"X10::ColumnFormulaSuggestionUpdate":{suggestionID:"$string",userResponse:"$number"},"X10::RunPerCharacterExperimentResult":{kind:"$number",value:["opt-field","X10::AnyObject"]},"X10::RunPerCharacterExperimentResults":{results:["$array","X10::RunPerCharacterExperimentResult"]},"X10::EvalOnCloneSuccessResult":{cell:"X10::RangeObject",value:"X10::AnyObject",formatted:"X10::AnyObject"},"X10::SetCellPrefetchResult":{evaluatedResult:["opt-field","X10::EvalOnCloneSuccessResult"],numberFormattedText:["opt-field","$string"],failureMessage:["opt-field","$string"]},"X10::GetTranspiledFormulasResult":{transpiledFormulas:["$array","X10::TranspilationResult"]},"X10::DoneSetCellPrefetchResult":{kind:"$string",payload:["opt-field","X10::SetCellPrefetchResult"]},"X10::Span":{start:"$number",end:"$number"},"X10::PositionKindInfo":{firstRow:"$number",firstColumn:"$number",secondRow:"$number",secondColumn:"$number"},"X10::RangeInfo":{range:["opt-field","X10::RangeObject"],positionKindInfo:["opt-field","X10::PositionKindInfo"]},"X10::FormulaHighlight":{kind:"$number",span:"X10::Span",rangeInfo:["opt-field","X10::RangeInfo"]},"X10::FormulaHighlightingResult":{formulaHighlights:["opt-field",["$array","X10::FormulaHighlight"]]},"X10::RunExperimentResults":{results:["$array","X10::RunExperimentResult"]},"X10::AnyObjectResults":{results:["$array","X10::AnyObject"]},"X10::FunctionSuggestionAndArgumentAssistanceResult":{functionSuggestion:["opt-field","X10::SuggestionResult"],argumentAssistance:["opt-field",["$union",["X10::MinimalFunctionRenderingInfo","X10::FullFunctionRenderingInfo"]]],inCellSuggestion:["opt-field","X10::InCellSuggestionResult"]},"X10::RunExperimentRequest":{},"X10::RunAuthoringExperimentRequest":{content:"$string",isCellContentOnlyEqualDuringEdit:"$boolean"},"X10::RunTestRequest":{content:["opt-field","$string"]},"X10::SuggestionRequest":{content:"$string",caretPosition:"$number"},"X10::ChatGPTQueryRequest":{query:"$string",context:"X10::AnyObject"},"X10::RunPerCharacterExperimentRequest":{content:"$string",caretPosition:"$number",enableAutocompleteWrapperPlugin:"$boolean"},"X10::ArgumentAssistanceRequest":{content:"$string",caretPosition:"$number"},"X10::ColumnFormulaSuggestionRequest":{context:"X10::RangeObject"},"X10::SetCellPrefetchRequest":{text:"$string",textMaxWidth:"$number",ifmt:"$number",font:"$string"},"X10::GetTranspiledFormulasRequest":{formulaBatch:["$array","X10::IncompatibleFormulaObject"]},"X10::FunctionSuggestionRequest":{content:"$string",caretPosition:"$number"},"X10::InCellSuggestionRequest":{content:"$string",caretPosition:"$number"},"X10::FunctionSuggestionAndArgumentAssistanceRequest":{functionSuggestion:"X10::FunctionSuggestionRequest",argumentAssistance:"X10::ArgumentAssistanceRequest",inCellSuggestion:"X10::InCellSuggestionRequest"},"X10::FormulaHighlightingRequest":{content:"$string",caretPosition:"$number",selectionLength:["opt-field","$number"]},"X10::DisplayObject":{value:"$string",help:"$string",toolTip:"$string"},"X10::FormatMessage":{formatString:["opt-field","$string"],builtIn:["opt-field","$boolean"]},"X10::CellMessage":{formatString:["opt-field","$string"],builtIn:["opt-field","$boolean"],colIndex:"$number",rowIndex:"$number",sheetIndex:"$string",docPath:["opt-field","$string"],docName:"$string"},"X10::FunctionShortDescriptionsMap":{descriptionMap:["opt-field",["$indexer","$string"]]},"X10::ContextualText":{text:"$string",index:"$number",length:"$number"},"X10::ValuePreviewBaseResult":{evaluatedFormula:["opt-field","$string"],index:"$number",length:"$number"},"X10::ValuePreviewSuccessResult":{kind:"$string",evaluatedFormula:["opt-field","$string"],index:"$number",length:"$number",value:"$string",unformattedValue:["opt-field","$string"],color:["opt-field","X10::AnyObject"],operKind:"$number",isVolatile:"$boolean"},"X10::ValuePreviewFailureResult":{kind:"$string",evaluatedFormula:["opt-field","$string"],index:"$number",length:"$number",reason:"$string"},"X10::ValuePreviewUnavailableResult":{kind:"$string",evaluatedFormula:["opt-field","$string"],index:"$number",length:"$number",reason:"$string",isVolatile:"$boolean"},"X10::GotoCtrlClickResult":{kind:"$number",sheetRange:["opt-field","X10::SheetRange"],span:["opt-field","X10::Span"]},"X10::FormulaRepairRequest":{formula:"$string"},"X10::ValuePreviewRequest":{text:"$string",index:"$number",length:"$number",activeCell:["opt-field","X10::SheetCell"]},"X10::GotoCtrlClickRequest":{text:"$string",index:"$number",length:"$number"},"X10::DoneSuggestionResult":{kind:"$string",payload:["opt-field","X10::SuggestionResult"]},"X10::Superseded":{kind:"$string"},"X10::DoneInCellSuggestionResult":{kind:"$string",payload:["opt-field","X10::InCellSuggestionResult"]},"X10::DoneFormulaHighlightingResult":{kind:"$string",payload:["opt-field","X10::FormulaHighlightingResult"]},"X10::DoneArgumentAssistanceResult":{kind:"$string",payload:["opt-field",["$union",["X10::MinimalFunctionRenderingInfo","X10::FullFunctionRenderingInfo"]]]},"X10::DoneRunExperimentResult":{kind:"$string",payload:["opt-field","X10::RunExperimentResults"]},"X10::DoneRunPerCharacterExperimentResult":{kind:"$string",payload:["opt-field","X10::RunPerCharacterExperimentResults"]},"X10::DoneRunTestResult":{kind:"$string",payload:["opt-field","X10::AnyObjectResults"]},"X10::DoneValuePreviewResult":{kind:"$string",payload:["opt-field",["$union",["X10::ValuePreviewSuccessResult","X10::ValuePreviewFailureResult","X10::ValuePreviewUnavailableResult"]]]},"X10::DoneGotoCtrlClickResult":{kind:"$string",payload:["opt-field","X10::GotoCtrlClickResult"]},"X10::DoneFormulaRepairResult":{kind:"$string",payload:["opt-field","X10::FormulaRepairResult"]},"X10::DoneChatGPTQueryResult":{kind:"$string",payload:["opt-field","X10::ChatGPTQueryResult"]},"X10::DoneColumnFormulaSuggestionResult":{kind:"$string",payload:["opt-field","X10::ColumnFormulaSuggestionResult"]},"X10::DoneGetTranspiledFormulasResult":{kind:"$string",payload:["opt-field","X10::GetTranspiledFormulasResult"]},"X10::DoneFunctionSuggestionAndArgumentAssistanceResult":{kind:"$string",payload:"X10::FunctionSuggestionAndArgumentAssistanceResult"}});va.ServiceInfos={TableIntelligenceProvider:["X10::TableIntelligenceProvider",{getRecognizedRangeTablesInfo:["ReturnsPromiseMethod",["$array","X10::RecognizedRangeTablesInfo"],["$string","X10::RangeObject","$number","$number","$number"]]}],EventCallbacksManager:["X10::EventCallbacksManager",{TestEvent:["FireAndForgetMethod",["X10::TestEventInput"]]}],ChatGPTProvider:["X10::ChatGPTProvider",{openChat:["ReturnsPromiseMethod","$number",["X10::AnyObject"]],send:["ReturnsPromiseMethod","$string",["$number","$string"]],close:["FireAndForgetMethod",["$number"]]}],Notifier:["X10::Notifier",{doNothing:["FireAndForgetMethod",["$string"]],setActiveCell:["FireAndForgetMethod",["X10::CellMessage"]],setActiveCellFormat:["FireAndForgetMethod",["X10::FormatMessage"]],setFunctionsInfo:["FireAndForgetMethod",[["$array","X10::FunctionInfo"]]],setDefinedNamesInfo:["FireAndForgetMethod",[["$array","X10::DefinedNameInfo"]]],notifyWorkbookClosing:["FireAndForgetMethod",[]],setSchedulerFeatures:["FireAndForgetMethod",[["$array","$number"]]],setA1ReferenceStyle:["FireAndForgetMethod",["$boolean"]],setLocale:["FireAndForgetMethod",["X10::LocaleData"]],setWorkbookProps:["FireAndForgetMethod",["X10::WorkbookProps"]],updateSheetNames:["FireAndForgetMethod",["$number",["$array","X10::SheetName"]]],updateNamedObjects:["FireAndForgetMethod",["$number",["$array","X10::NamedObjectsUpdate"]]],writeRange:["FireAndForgetMethod",["$number","X10::WriteRangeMessage"]],setNumberFormats:["FireAndForgetMethod",[["$array","X10::NativeFormatMessage"],"$boolean"]]}],Requester:["X10::Requester",{functionSuggestion:["ReturnsPromiseMethod",["$union",["X10::DoneSuggestionResult","X10::Superseded"]],["X10::FunctionSuggestionRequest","$number",["$optional","$string"]]],inCellSuggestion:["ReturnsPromiseMethod",["$union",["X10::DoneInCellSuggestionResult","X10::Superseded"]],["X10::InCellSuggestionRequest","$number",["$optional","$string"]]],formulaHighlighting:["ReturnsPromiseMethod",["$union",["X10::DoneFormulaHighlightingResult","X10::Superseded"]],["X10::FormulaHighlightingRequest","$number",["$optional","$string"]]],argumentAssistance:["ReturnsPromiseMethod",["$union",["X10::DoneArgumentAssistanceResult","X10::Superseded"]],["X10::ArgumentAssistanceRequest","$number",["$optional","$string"]]],runExperiment:["ReturnsPromiseMethod",["$union",["X10::DoneRunExperimentResult","X10::Superseded"]],["X10::RunExperimentRequest","$number",["$optional","$string"]]],runAuthoringExperiment:["ReturnsPromiseMethod",["$union",["X10::DoneRunExperimentResult","X10::Superseded"]],["X10::RunAuthoringExperimentRequest","$number",["$optional","$string"]]],runPerCharacterExperiment:["ReturnsPromiseMethod",["$union",["X10::DoneRunPerCharacterExperimentResult","X10::Superseded"]],["X10::RunPerCharacterExperimentRequest","$number",["$optional","$string"]]],runTest:["ReturnsPromiseMethod",["$union",["X10::DoneRunTestResult","X10::Superseded"]],["X10::RunTestRequest","$number",["$optional","$string"]]],valuePreview:["ReturnsPromiseMethod",["$union",["X10::DoneValuePreviewResult","X10::Superseded"]],["X10::ValuePreviewRequest","$number",["$optional","$string"]]],gotoCtrlClick:["ReturnsPromiseMethod",["$union",["X10::DoneGotoCtrlClickResult","X10::Superseded"]],["X10::GotoCtrlClickRequest","$number",["$optional","$string"]]],formulaRepair:["ReturnsPromiseMethod",["$union",["X10::DoneFormulaRepairResult","X10::Superseded"]],["X10::FormulaRepairRequest","$number",["$optional","$string"]]],chatGPTQuery:["ReturnsPromiseMethod",["$union",["X10::DoneChatGPTQueryResult","X10::Superseded"]],["X10::ChatGPTQueryRequest","$number",["$optional","$string"]]],columnFormulaSuggestion:["ReturnsPromiseMethod",["$union",["X10::DoneColumnFormulaSuggestionResult","X10::Superseded"]],["X10::ColumnFormulaSuggestionRequest","$number",["$optional","$string"]]],setCellPrefetch:["ReturnsPromiseMethod",["$union",["X10::DoneSetCellPrefetchResult","X10::Superseded"]],["X10::SetCellPrefetchRequest","$number",["$optional","$string"]]],getTranspiledFormulas:["ReturnsPromiseMethod",["$union",["X10::DoneGetTranspiledFormulasResult","X10::Superseded"]],["X10::GetTranspiledFormulasRequest","$number",["$optional","$string"]]]}],EventEmitter:["X10::EventEmitter",{TestEvent:["ReturnsPromiseMethod","$any",["X10::TestEventInput"]],FBEOutcomeUpdate:["ReturnsPromiseMethod","$any",["X10::SuggestionOutcomeEventInput"]],FormulaTranspilerInitEvent:["ReturnsPromiseMethod","$any",["X10::FormulaTranspilerInitEventInput"]]}],MessageBridgeJs:["X10::MessageBridgeJs",{SendMessage:["FireAndForgetMethod",["$string"]]}],MessageBridgeNative:["X10::MessageBridgeNative",{SendMessage:["FireAndForgetMethod",["$string"]]}],BatchRequester:["X10::BatchRequester",{functionSuggestionAndArgumentAssistance:["ReturnsPromiseMethod",["$union",["X10::DoneFunctionSuggestionAndArgumentAssistanceResult","X10::Superseded"]],["X10::FunctionSuggestionAndArgumentAssistanceRequest","$number",["$optional","$string"]]]}],ServerDataProvider:["X10::ServerDataProvider",{getRichValueFieldListContext:["ReturnsPromiseMethod",["$array","X10::FieldInfoListContextData"],["X10::SheetRange","$string","$boolean","$boolean"]],getTableColHeaders:["ReturnsPromiseMethod",["$array","$string"],["$string"]]}]};var fVe=function(){function e(){sVe(this,e)}return lVe(e,null,[{key:"TableIntelligenceProvider",get:function(){var t;return(t=e._TableIntelligenceProvider)!==null&&t!==void 0?t:e._TableIntelligenceProvider=U1.RekaServiceRegistry.getNativeService(va.ServiceInfos.TableIntelligenceProvider)}},{key:"EventCallbacksManager",get:function(){var t;return(t=e._EventCallbacksManager)!==null&&t!==void 0?t:e._EventCallbacksManager=U1.RekaServiceRegistry.getNativeService(va.ServiceInfos.EventCallbacksManager)}},{key:"ChatGPTProvider",get:function(){var t;return(t=e._ChatGPTProvider)!==null&&t!==void 0?t:e._ChatGPTProvider=U1.RekaServiceRegistry.getNativeService(va.ServiceInfos.ChatGPTProvider)}},{key:"MessageBridgeNative",get:function(){var t;return(t=e._MessageBridgeNative)!==null&&t!==void 0?t:e._MessageBridgeNative=U1.RekaServiceRegistry.getNativeService(va.ServiceInfos.MessageBridgeNative)}},{key:"BatchRequester",get:function(){var t;return(t=e._BatchRequester)!==null&&t!==void 0?t:e._BatchRequester=U1.RekaServiceRegistry.getNativeService(va.ServiceInfos.BatchRequester)}},{key:"ServerDataProvider",get:function(){var t;return(t=e._ServerDataProvider)!==null&&t!==void 0?t:e._ServerDataProvider=U1.RekaServiceRegistry.getNativeService(va.ServiceInfos.ServerDataProvider)}}]),e}();va.NativeServices=fVe;var bp=Pfe();Object.defineProperty(va,"ColumnFormulaSuggestionUpdateKind",{enumerable:!0,get:function(){return bp.ColumnFormulaSuggestionUpdateKind}});Object.defineProperty(va,"EditorMessageType",{enumerable:!0,get:function(){return bp.EditorMessageType}});Object.defineProperty(va,"GotoCtrlClickResultKind",{enumerable:!0,get:function(){return bp.GotoCtrlClickResultKind}});Object.defineProperty(va,"HighlightKind",{enumerable:!0,get:function(){return bp.HighlightKind}});Object.defineProperty(va,"MessageType",{enumerable:!0,get:function(){return bp.MessageType}});Object.defineProperty(va,"PerCharacterExperimentResultKind",{enumerable:!0,get:function(){return bp.PerCharacterExperimentResultKind}});Object.defineProperty(va,"PluginAttachGroup",{enumerable:!0,get:function(){return bp.PluginAttachGroup}});Object.defineProperty(va,"PluginFactoryName",{enumerable:!0,get:function(){return bp.PluginFactoryName}});Object.defineProperty(va,"PluginGroup",{enumerable:!0,get:function(){return bp.PluginGroup}});Object.defineProperty(va,"PositionKind",{enumerable:!0,get:function(){return bp.PositionKind}});Object.defineProperty(va,"RecognizedTablesMetadataState",{enumerable:!0,get:function(){return bp.RecognizedTablesMetadataState}});Object.defineProperty(va,"SchedulerFeature",{enumerable:!0,get:function(){return bp.SchedulerFeature}});Object.defineProperty(va,"TableOrientation",{enumerable:!0,get:function(){return bp.TableOrientation}});Object.defineProperty(va,"ValuePreviewResultKind",{enumerable:!0,get:function(){return bp.ValuePreviewResultKind}})});var Nfe=T(o7=>{"use strict";p();Object.defineProperty(o7,"__esModule",{value:!0});var pVe=fe();pVe.__exportStar(Ffe(),o7)});var Ofe=T(rL=>{"use strict";p();Object.defineProperty(rL,"__esModule",{value:!0});rL.packageVersion=void 0;rL.packageVersion="56.3.1"});var kfe=T(tL=>{"use strict";p();Object.defineProperty(tL,"__esModule",{value:!0});tL.fnv1a=void 0;var mVe=2166136261;function gVe(e){for(var r=mVe,t=e.length,n=0;n<t;n+=1)r^=e.charCodeAt(n),r+=(r<<1)+(r<<4)+(r<<7)+(r<<8)+(r<<24);return r>>>0}tL.fnv1a=gVe});var u7=T(nL=>{"use strict";p();Object.defineProperty(nL,"__esModule",{value:!0});nL.JSF32=void 0;var Mfe=function(r,t){return(r<<t|r>>>32-t)>>>0},vVe=function(){function e(r){this.x=new Uint32Array([4058668781,r,r,r]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*23283064365386963e-26},e.prototype.nextU32=function(){var r=this.x[0]-Mfe(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^Mfe(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+r>>>0,this.x[3]=r+this.x[0]>>>0},e}();nL.JSF32=vVe});var xfe=T(aL=>{"use strict";p();Object.defineProperty(aL,"__esModule",{value:!0});aL.findIsomorphicSubtrees=void 0;function hVe(e,r,t,n){t===void 0&&(t=function(){return""}),n===void 0&&(n=function(){return 1});for(var a=[e],o=new Set(a),u=0;u<a.length;u+=1)for(var s=0,l=r(a[u]);s<l.length;s++){var c=l[s];o.has(c)||(o.add(c),a.push(c))}o.clear(),a.reverse();var d=new Map,f=[],m=new Map;function v(V){var I=m.get(V);return I!==void 0||(I=m.size,m.set(V,I)),I}var h=[];a.forEach(function(V,I){var M=r(V).map(function(Z){return d.get(Z)});if(M.some(function(Z){return Z===void 0}))throw new Error("Circular references in the tree");var B=M.map(function(Z){return f[Z]}),U=B.join("/")+"/"+t(V),j=v(U);if(f.push(j),h[j]===void 0){var X=B.map(function(Z){return h[Z]}),ee=X.map(function(Z){return Z.size}).reduce(function(Z,J){return Z+J},n(V)),re=X.map(function(Z){return Z.depth}).reduce(function(Z,J){return Math.max(Z,J)},0)+1;h[j]={subtrees:[V],size:ee,depth:re}}else h[j].subtrees.push(V);d.set(V,I)});for(var y=0,_=h;y<_.length;y++){var E=_[y];E.subtrees.reverse()}for(var N=new Array(a.length),k=0,q=h;k<q.length;k++){var E=q[k];N[N.length-d.get(E.subtrees[0])-1]=E}return SVe(N)}aL.findIsomorphicSubtrees=hVe;function SVe(e){return e.filter(function(r){return r!==void 0})}});var wfe=T(iL=>{"use strict";p();Object.defineProperty(iL,"__esModule",{value:!0});iL.combinations=void 0;var yVe=fe();function Ife(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(e.length===0)return[[]];for(var t=e[0],n=e.slice(1),a=Ife.apply(void 0,n),o=[],u=0,s=t;u<s.length;u++)for(var l=s[u],c=0,d=a;c<d.length;c++){var f=d[c];o.push(yVe.__spreadArray([l],f,!0))}return o}iL.combinations=Ife});var Dfe=T(oL=>{"use strict";p();Object.defineProperty(oL,"__esModule",{value:!0});oL.capitalize=void 0;function _Ve(e){return e.charAt(0).toUpperCase()+e.slice(1)}oL.capitalize=_Ve});var l7=T(uL=>{"use strict";p();var s7;Object.defineProperty(uL,"__esModule",{value:!0});uL.mathLog2=void 0;uL.mathLog2=(s7=Math.log2)!==null&&s7!==void 0?s7:function(e){return Math.log(e)*Math.LOG2E}});var sL=T(Yv=>{"use strict";p();Object.defineProperty(Yv,"__esModule",{value:!0});Yv.anonymizeFormulaString=Yv.anonymizeMagnitude=Yv.kindAnonymizers=Yv.anonymize=void 0;var bVe=l7();function CVe(e){if(typeof e=="object"&&e!==null){var r=e.kind;if(typeof r=="string")return r}}function TVe(e){var r=typeof e;if(r==="object"){if(e===null)return"null";if(Array.isArray(e))return"Array"}return r}function c7(e){return e}function RVe(e){return typeof e!="number"?"<unexpected>":isFinite(e)?"<number>":e}function EVe(e){return typeof e!="bigint"?"<unexpected>":"<bigint>"}function PVe(e){return typeof e!="string"?"<unexpected>":e.length>0?"<string>":e}function AVe(e){if(typeof e!="function")return"<unexpected>";var r=e.name;return typeof r=="string"&&r.length>0?"<function ".concat(r,">"):"<function>"}function FVe(e){if(typeof e!="object")return"<unexpected>";var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=d7(e[t],t));return r}function NVe(e){return typeof e!="object"||!Array.isArray(e)?"<unexpected>":e.map(d7)}function OVe(e){return typeof e!="symbol"?"<unexpected>":"<symbol ".concat(String(e),">")}function d7(e,r){if(typeof r=="string"&&MVe[r]!=null)return e;var t=CVe(e),n=t!==void 0?Yv.kindAnonymizers[t]:void 0;return n===void 0&&(n=xVe[TVe(e)]),n!==void 0?n(e,r):"<unexpected>"}function kVe(e){try{return String(JSON.stringify(d7(e,void 0)))}catch(n){if(n==null||typeof n!="object")return"<error: ".concat(String(JSON.stringify(n)),">");var r=String(n.name),t=String(n.message);return t.indexOf(r)>=0?"<error ".concat(t,">"):"<error ".concat(r,": ").concat(t,">")}}Yv.anonymize=kVe;var MVe={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},xVe={boolean:c7,symbol:OVe,undefined:c7,null:c7,number:RVe,bigint:EVe,string:PVe,function:AVe,object:FVe,Array:NVe};Yv.kindAnonymizers=Object.create(null);function IVe(e){var r=Math.abs(e);return r===0?-1e4:Math.floor((0,bVe.mathLog2)(r))}Yv.anonymizeMagnitude=IVe;var wVe="[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$\x80\xA2\xA3\xA4\xA5\u20A0\u20A1\u20A2\u20A3\u20A4\u20A5\u20A6\u20A7\u20A8\u20A9\u20AA\u20AB\u20AC\u20AD\u20AE\u20AF\u20B0\u20B1\u20B2\u20B3\u20B4\u20B5\u20B6\u20B7\u20B8\u20B9\\s\uA0C2d]",DVe=new RegExp(wVe,"g"),LVe=/[0-9]/g,qVe=/d/g;function GVe(e){var r=e.toLowerCase().replace(qVe,"w"),t=r.replace(LVe,"d");return t.replace(DVe,"w")}Yv.anonymizeFormulaString=GVe});var cL=T(Ts=>{"use strict";p();Object.defineProperty(Ts,"__esModule",{value:!0});Ts.values=Ts.prependErrorMessage=Ts.messageFromError=Ts.partialArray=Ts.arrayFill=Ts.repeat=Ts.stringEndsWith=Ts.stringStartsWith=Ts.isInteger=Ts.mathLog2=void 0;var BVe=sL(),UVe=l7();Object.defineProperty(Ts,"mathLog2",{enumerable:!0,get:function(){return UVe.mathLog2}});function lL(e){try{return e()}catch(r){return!1}}Ts.isInteger=typeof Number.isInteger=="function"&&lL(function(){return!Number.isInteger(1.1)})?function(e){return Number.isInteger(e)}:function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Ts.stringStartsWith=lL(function(){return!"ab".startsWith("b")&&"abc".startsWith("b",1)&&!"abc".startsWith("a",1)})?function(e,r,t){return t===void 0&&(t=0),e.startsWith(r,t)}:function(e,r,t){return t===void 0&&(t=0),t+r.length<=e.length&&e.substring(t,t+r.length)===r};Ts.stringEndsWith=lL(function(){return!"ab".endsWith("a")})?function(e,r){return e.endsWith(r)}:function(e,r){return r.length<=e.length&&e.substring(e.length-r.length,e.length)===r};Ts.repeat=lL(function(){return"a".repeat(3)==="aaa"})?function(e,r){return e.repeat(r)}:function(e,r){return Array(r+1).join(e)};function KVe(e,r){for(var t=0;t<e.length;t+=1)e[t]=r;return e}Ts.arrayFill=KVe;function VVe(e){var r=[];return Object.keys(e).map(Number).forEach(function(t){return r[t]=e[t]}),r}Ts.partialArray=VVe;function jVe(e){if(e==null||typeof e!="object")return(0,BVe.anonymize)(e);var r=e,t=String(r.name),n=String(r.message);if(r.stack!=null){var a=String(r.stack);return a.indexOf(n)>=0&&a.indexOf(t)>=0?a:"".concat(t,": ").concat(n,"\n").concat(a)}return n.indexOf(t)>=0?n:"".concat(t,": ").concat(n)}Ts.messageFromError=jVe;function WVe(e,r){if(e==null||typeof e!="object")return e;var t=e;return t.message="".concat(r," ").concat(String(t.message)),t}Ts.prependErrorMessage=WVe;function HVe(e){var r=[];for(var t in e)Object.hasOwnProperty.call(e,t)&&r.push(e[t]);return r}Ts.values=HVe});var qfe=T(tl=>{"use strict";p();Object.defineProperty(tl,"__esModule",{value:!0});tl.calcHashCode=tl.decodeHtml=tl.getQueryParameterByName=tl.chainFallbackPromises=tl.retry=tl.getPerfWatchMarkName=tl.getStringifiedError=tl.defaultToJSONResultWhenStringifyFails=tl.forEachPromise=void 0;function zVe(e,r,t){return e.reduce(function(n,a){return n.then(function(){return!t||!t.stop?r(a,t):Promise.resolve(void 0)})},Promise.resolve(void 0))}tl.forEachPromise=zVe;tl.defaultToJSONResultWhenStringifyFails="...";function QVe(e){if(e===0)return"0";if(!e)return"";try{var r=JSON.stringify(Lfe(e));return r}catch(t){return tl.defaultToJSONResultWhenStringifyFails}}tl.getStringifiedError=QVe;var XVe=5;function Lfe(e,r){if(r===void 0&&(r=0),r<0||r>XVe||e==null||typeof e!="object")return e;var t={};Object.getOwnPropertyNames(e).forEach(function(o){o!=="stack"&&o.toUpperCase()!==o&&(t[o]=e[o])});var n=Object.getPrototypeOf(e);n&&typeof n=="object"&&Object.keys(n).forEach(function(o){o!=="stack"&&o.toUpperCase()!==o&&(t[o]=e[o])});var a={};return Object.keys(t).forEach(function(o){a[o]=Lfe(t[o],r+1)}),a}var f7="_",YVe="\\W",JVe=new RegExp("".concat(YVe,"+"),"g");function ZVe(e){if(!e)return"";var r=e.trim().substring(0,200).trim().replace(JVe,f7).substring(0,80);return r&&r.length>0&&r.substr(r.length-1,1)===f7&&(r=r.substr(0,r.length-1)),r&&r.length>0&&r.substr(0,1)===f7&&(r=r.substr(1)),r}tl.getPerfWatchMarkName=ZVe;function $Ve(e,r){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(r<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(r)));for(var t=Promise.reject(),n=function(u){t=t.catch(function(s){return e(u,s)})},a=1;a<=r;a+=1)n(a);return t}tl.retry=$Ve;function eje(e,r){if(!e||e.length===0)return Promise.reject();for(var t=r(e[0]),n=function(u){var s=e[u];t=t.catch(function(){return r(s)})},a=1;a<e.length;a+=1)n(a);return t}tl.chainFallbackPromises=eje;function rje(e,r){var t=new RegExp("[?&]".concat(r,"(=([^&#]*)|&|#|$)")),n=t.exec(e);if(n)return n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):""}tl.getQueryParameterByName=rje;function tje(e){return typeof e=="string"?new DOMParser().parseFromString(e,"text/html").documentElement.textContent:e}tl.decodeHtml=tje;function nje(e){if(!e)return 0;for(var r=5381,t=r,n=e.length,a=0;a<n&&(r=((r<<5)+r^e.charCodeAt(a))&4294967295,a!==n-1);a+=2)t=((t<<5)+t^e.charCodeAt(a+1))&4294967295;var o=t*35685,u=t*23896<<16,s=r+o+u&4294967295;return s<0&&(s+=4294967296),s}tl.calcHashCode=nje});var dL=T(ug=>{"use strict";p();Object.defineProperty(ug,"__esModule",{value:!0});ug.NulLogger=ug.ConsoleLogger=ug.ULS=ug.LogCategory=ug.TraceLevel=void 0;var Gfe;(function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"})(Gfe||(ug.TraceLevel=Gfe={}));var Bfe;(function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"})(Bfe||(ug.LogCategory=Bfe={}));function aje(e){var r=e;return{ULS:{trace:function(n,a,o){return r.traceTag(0,n,a,o)},traceTag:function(n,a,o,u){return r.traceTag(n,a,o,u)},debugTrace:function(n,a,o){return r.debugTraceTag(0,n,a,o)},debugTraceTag:function(n,a,o,u){return r.debugTraceTag(n,a,o,u)},assert:function(n,a,o){return r.assertTag(0,n,a,o)},assertTag:function(n,a,o,u){return r.assertTag(n,a,o,u)},shipAssert:function(n,a,o){return r.shipAssertTag(0,n,a,o)},shipAssertTag:function(n,a,o,u){return r.shipAssertTag(n,a,o,u)},dnmTrace:function(n,a,o){return r.dnmTraceTag(0,n,a,o)},dnmTraceTag:function(n,a,o,u){return r.dnmTraceTag(n,a,o,u)}}}}ug.ULS={getFromExternalLogger:aje};var ije=function(){function e(){}return e.prototype.shipAssertTag=function(r,t,n,a){console.assert(n,"shipAssertTag:",r,t,a)},e.prototype.assertTag=function(r,t,n,a){console.assert(n,"assertTag",r,t,a)},e.prototype.traceTag=function(r,t,n,a){console.log("traceTag",r,a,t,n)},e.prototype.dnmTraceTag=function(r,t,n,a){console.log("dnmTraceTag",r,a,t,n)},e.prototype.debugTraceTag=function(r,t,n,a){console.log("debugTraceTag",r,a,t,n)},e}();ug.ConsoleLogger=ije;var oje=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();ug.NulLogger=oje});var Ufe=T(fL=>{"use strict";p();Object.defineProperty(fL,"__esModule",{value:!0});fL.promises=void 0;var p7={},m7="promises";function uje(){return p7[m7]===void 0&&(p7[m7]=typeof Promise<"u"&&typeof Promise.resolve=="function"&&typeof Promise.resolve(0).then=="function"),p7[m7]}fL.promises=uje});var Vfe=T(Cp=>{"use strict";p();Object.defineProperty(Cp,"__esModule",{value:!0});Cp.timeStamp=Cp.failure=Cp.success=Cp.end=Cp.mark=Cp.start=void 0;function sje(e){var r=g7(),t=e,n=r,a={},o=function(l,c,d){return pje(a,t,n,l,c,d)},u=function(l){return Kfe(a,l,n)};return a.start=0,{mark:function(l){return u(l)},end:function(l){return o(!0,l)},success:function(l,c){return o(!0,l,c)},failure:function(l,c){return o(!1,l,c)}}}Cp.start=sje;function lje(e,r){e!==void 0&&e.mark(r)}Cp.mark=lje;function cje(e,r){e!==void 0&&e.end(r)}Cp.end=cje;function dje(e,r,t){e!==void 0&&e.success(r,t)}Cp.success=dje;function fje(e,r,t){e!==void 0&&e.failure(r,t)}Cp.failure=fje;function g7(){var e=typeof self<"u"?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}Cp.timeStamp=g7;function Kfe(e,r,t){e[r]=g7()-t}function pje(e,r,t,n,a,o){Kfe(e,"end",t);var u={sessionName:r,result:n?"success":"failure",message:o,marks:e},s=JSON.stringify(u);a(s)}});var jfe=T(mL=>{"use strict";p();Object.defineProperty(mL,"__esModule",{value:!0});mL.initStopwatchFactory=void 0;var pL=function(){return Date.now()};function mje(e,r){return r===void 0&&(r=1),typeof self<"u"&&self.performance&&self.performance.now&&(pL=function(){return self.performance.now()}),function(t){var n=pL(),a=t;return{reset:function(u){u!=null&&(a=u),n=pL()},stop:function(u){var s=pL()-n,l=JSON.stringify({Target:a,Duration:s.toFixed(r),StopInfo:u});e(l)}}}}mL.initStopwatchFactory=mje});var Wfe=T(gL=>{"use strict";p();Object.defineProperty(gL,"__esModule",{value:!0});gL.TelemetryCollector=void 0;var gje=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(r,t){r==null||t===null||t===void 0||(this.events[r]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(r){r!=null&&(this.counters.hasOwnProperty(r)?this.counters[r]+=1:this.counters[r]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(r){r!=null&&(this.timers[r]={name:r,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(r){r!=null&&this.timers.hasOwnProperty(r)&&(this.timers[r].endTime=Date.now(),this.timers[r].isRunning=!1,this.timers[r].duration=this.timers[r].endTime-this.timers[r].startTime)},e.prototype.getTimerDuration=function(r){return r==null?"-1":this.timers.hasOwnProperty(r)&&this.timers[r].duration!==void 0?this.timers[r].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();gL.TelemetryCollector=gje});var Hfe=T(vL=>{"use strict";p();Object.defineProperty(vL,"__esModule",{value:!0});vL.getNewGuid=void 0;function vje(){var e=new Uint8Array(31),r=hje(e),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n=0,a=t.replace(/[xy]/g,function(o){var u=e[n]&15;n+=1;var s=o==="x"?u:u&3|8;return s.toString(16)});return[a,r]}vL.getNewGuid=vje;function hje(e){var r={crypto:!1,perfNow:!1,exceptions:[]},t=typeof self<"u"?self:window,n=t.crypto||t.msCrypto;if(n){r.crypto=!0;try{return n.getRandomValues(e),r}catch(c){r.exceptions.push("crypto: ".concat(JSON.stringify(c)))}}var a=!1,o=t.performance;try{o&&o.now&&o.now()!==1/0&&(a=!0)}catch(c){r.exceptions.push("perfNow: ".concat(JSON.stringify(c)))}for(var u=0;u<e.length;u+=1){try{if(a){r.perfNow=!0;var s=Math.floor(o.now()*100)%10;(s<0||s>9)&&(s=0);for(var l=0;l<s;l+=1)Math.random()}}catch(c){r.exceptions.push("Math.random: ".concat(JSON.stringify(c)))}e[u]=Math.floor(Math.random()*16)}return r}});var Xfe=T(xP=>{"use strict";p();Object.defineProperty(xP,"__esModule",{value:!0});xP.TextAreaInputMode=xP.TextAreaVirtualKeyboardPolicy=void 0;var zfe;(function(e){e.Auto="auto",e.Manual="manual"})(zfe||(xP.TextAreaVirtualKeyboardPolicy=zfe={}));var Qfe;(function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"})(Qfe||(xP.TextAreaInputMode=Qfe={}))});var Yfe=T(K1=>{"use strict";p();Object.defineProperty(K1,"__esModule",{value:!0});K1.isReplaceChildrenSupported=K1.replaceChildren=void 0;var Sje=function(r){if(r)if((0,K1.isReplaceChildrenSupported)(r))r.replaceChildren();else for(;r.lastChild;)r.removeChild(r.lastChild)};K1.replaceChildren=Sje;var yje=function(r){return!!r.replaceChildren};K1.isReplaceChildrenSupported=yje});var nl=T(Ji=>{"use strict";p();Object.defineProperty(Ji,"__esModule",{value:!0});Ji.TelemetryCollector=Ji.initStopwatchFactory=Ji.ConsoleLogger=Ji.NulLogger=Ji.perfWatch=Ji.browserSupport=Ji.LogCategory=Ji.TraceLevel=Ji.ULS=Ji.utils=Ji.replaceChildren=Ji.TextAreaInputMode=Ji.TextAreaVirtualKeyboardPolicy=Ji.getNewGuid=void 0;var _je=qfe();Ji.utils=_je;var zk=dL();Object.defineProperty(Ji,"ULS",{enumerable:!0,get:function(){return zk.ULS}});Object.defineProperty(Ji,"TraceLevel",{enumerable:!0,get:function(){return zk.TraceLevel}});Object.defineProperty(Ji,"LogCategory",{enumerable:!0,get:function(){return zk.LogCategory}});Object.defineProperty(Ji,"NulLogger",{enumerable:!0,get:function(){return zk.NulLogger}});Object.defineProperty(Ji,"ConsoleLogger",{enumerable:!0,get:function(){return zk.ConsoleLogger}});var bje=Ufe();Ji.browserSupport=bje;var Cje=Vfe();Ji.perfWatch=Cje;var Tje=jfe();Object.defineProperty(Ji,"initStopwatchFactory",{enumerable:!0,get:function(){return Tje.initStopwatchFactory}});var Rje=Wfe();Object.defineProperty(Ji,"TelemetryCollector",{enumerable:!0,get:function(){return Rje.TelemetryCollector}});var Eje=Hfe();Object.defineProperty(Ji,"getNewGuid",{enumerable:!0,get:function(){return Eje.getNewGuid}});var Jfe=Xfe();Object.defineProperty(Ji,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return Jfe.TextAreaVirtualKeyboardPolicy}});Object.defineProperty(Ji,"TextAreaInputMode",{enumerable:!0,get:function(){return Jfe.TextAreaInputMode}});var Pje=Yfe();Object.defineProperty(Ji,"replaceChildren",{enumerable:!0,get:function(){return Pje.replaceChildren}})});var ty=T(Lu=>{"use strict";p();Object.defineProperty(Lu,"__esModule",{value:!0});Lu.assertPositiveLength=Lu.assertIndex=Lu.assertPositiveInteger=Lu.assertNatural=Lu.assertInteger=Lu.assertTrue=Lu.assertFalse=Lu.assertNever=Lu.ulsLogger=void 0;var hL=nl(),Xk=cL(),Z_=sL();function Zfe(e,r){function t(n,a,o,u){if(e(n,a,o,u),!o)throw new Error("".concat(r," ").concat(n," ").concat(a," ").concat(u))}return t}function $fe(e){return{shipAssertTag:Zfe(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:Zfe(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function Qk(e){return function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];try{return e.apply(void 0,r)}catch(n){}}}function Aje(e){return{shipAssertTag:Qk(e.shipAssertTag.bind(e)),assertTag:Qk(e.assertTag.bind(e)),traceTag:Qk(e.traceTag.bind(e)),debugTraceTag:Qk(e.debugTraceTag.bind(e)),dnmTraceTag:Qk(e.dnmTraceTag.bind(e))}}var epe=function(){function e(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}return e.prototype.createBufferingCallback=function(r){var t=this;return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];t.callBuffer.length<t.callBufferCapacity&&t.callBuffer.push({method:r,args:n})}},e.prototype.invokeBufferedCalls=function(){var r;if(this.callBuffer.length!==0){var t=this.callBuffer;this.callBuffer=[];var n="calc.common.DefaultLogger.invokeBufferedCalls: ".concat(t.length," calls before initLogger");Lu.ulsLogger.ULS.traceTag(579736781,hL.LogCategory.msoulscat_ES_EWAJS,hL.TraceLevel.Warning,n);for(var a=0,o=t;a<o.length;a++){var u=o[a];(r=Lu.ulsLogger.noThrowLogger)[u.method].apply(r,u.args)}}},e}(),Fje=function(){function e(){this.logger=new epe,this.ULS=$fe(this.logger),this.noThrowLogger=this.logger}return e.prototype.setLogger=function(r){var t=this.logger;this.logger=r,this.ULS=$fe(r),this.noThrowLogger=Aje(r),t instanceof epe&&t.invokeBufferedCalls()},e}();Lu.ulsLogger=new Fje;function Nje(e,r){var t=(0,Z_.anonymize)(r),n="".concat(e,": code should be unreachable because a value has type 'never'; given ").concat(t);return Lu.ulsLogger.ULS.assertTag(595980872,hL.LogCategory.msoulscat_ES_EWAJS,!1,n)}Lu.assertNever=Nje;function V1(e){return Lu.ulsLogger.ULS.assertTag(595980873,hL.LogCategory.msoulscat_ES_EWAJS,!1,e)}Lu.assertFalse=V1;function Oje(e,r){r||V1("".concat(e,": expected condition to be true"))}Lu.assertTrue=Oje;function kje(e,r){(0,Xk.isInteger)(r)||V1("".concat(e,": expected integer; given ").concat((0,Z_.anonymize)(r)))}Lu.assertInteger=kje;function Mje(e,r){(!(0,Xk.isInteger)(r)||r<0)&&V1("".concat(e,": expected natural number; given ").concat((0,Z_.anonymize)(r)))}Lu.assertNatural=Mje;function xje(e,r){(!(0,Xk.isInteger)(r)||r<=0)&&V1("".concat(e,": expected positive integer; given ").concat((0,Z_.anonymize)(r)))}Lu.assertPositiveInteger=xje;function Ije(e,r,t){(!(0,Xk.isInteger)(r)||r<0||r>=t)&&V1("".concat(e,": expected natural number less than ").concat((0,Z_.anonymize)(t),"; given ").concat((0,Z_.anonymize)(r)))}Lu.assertIndex=Ije;function wje(e,r,t){(!(0,Xk.isInteger)(r)||r<=0||r>t)&&V1("".concat(e,": expected positive integer at most ").concat((0,Z_.anonymize)(t),"; given ").concat((0,Z_.anonymize)(r)))}Lu.assertPositiveLength=wje});var yL=T(Rc=>{"use strict";p();Object.defineProperty(Rc,"__esModule",{value:!0});Rc.isTypedChangeGateEnabled=Rc.setFeatureGateDictionaryGetter=Rc.overrideTypedFeatureGates=Rc.getTypedFeatureGate=Rc.getFeatures=Rc.isFeatureEnabled=Rc.initFeatureConfiguration=Rc.FeatureName=void 0;var Dje=ty(),rpe=nl(),tpe=mi(),SL;(function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting"})(SL||(Rc.FeatureName=SL={}));var npe=function(r){var t="calc.common.isFeatureEnabledCallback: called with ".concat(r," before initCalc");return Dje.ulsLogger.ULS.traceTag(526989323,rpe.LogCategory.msoulscat_ES_EWAJS,rpe.TraceLevel.Warning,t),!1},v7={};function Lje(e){typeof e=="function"&&(npe=e)}Rc.initFeatureConfiguration=Lje;function ape(e){return v7[e]===void 0&&(v7[e]=npe(e)),v7[e]}Rc.isFeatureEnabled=ape;function qje(){var e={};for(var r in SL){var t=SL[r];t!=null&&(e[t]=ape(t))}return e}Rc.getFeatures=qje;var Gje={"Microsoft.Office.Excel.ProseFormulaRepairExperimentLogBuggyIsEnabled":!1,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin":!1,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.UnitlessTimeAndDate":!1,"Microsoft.Office.Excel.UnitExpIgnoreDivMul":!1,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled":!1,"Microsoft.Office.Excel.MockWorkerThreadPlugin":!1,"Microsoft.Office.Excel.EnableFullSessionLogging":!0,"Microsoft.Office.Excel.ChatGPTPluginEnabled":!1,"Microsoft.Office.Excel.FormulaRepairSuggestionsLimit":1,"Microsoft.Office.Excel.ProseExcelRepairEngineV34":!1,"Microsoft.Office.Excel.FormulaByExamplePluginSuggestionShowing":!1,"Microsoft.Office.Excel.SetCellPrefetchPluginEnabled":!1,"Microsoft.Office.Excel.FormulaRemediation":!1,"Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension":0,"Microsoft.Office.Excel.FormulaByExampleConditionals":!1,"Microsoft.Office.Excel.FormulaByExampleReferenceRowFormula":!1,"Microsoft.Office.Excel.CalcTsDec2023Funcs":!1,"Microsoft.Office.Excel.GotoCtrlClick":!1,"Microsoft.Office.Excel.CalcEtaLambda":!1,"Microsoft.Office.Excel.EtaReducedLambdas":!1,"Microsoft.Office.Excel.DesktopX10VPEnabled":!1};Rc.getTypedFeatureGate=(0,tpe.makeGetTypedFeatureGate)(Gje);var ipe=mi();Object.defineProperty(Rc,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return ipe.overrideTypedFeatureGates}});Object.defineProperty(Rc,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return ipe.setFeatureGateDictionaryGetter}});Rc.isTypedChangeGateEnabled=(0,tpe.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","OfficeVSO:6476056_OnlySendNestedDotNotationPath","OfficeVSO:7396249_getTableHeadersFromServer","OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures","OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces","Microsoft.Office.Excel.X10IntelligentPythonWP5","OfficeVSO:8501373_CalcTsFuncsFirstSlice","OfficeVSO_8554430_CalcTsColRowSumProdFuncs","OfficeVSO:8557722_x10GetNumOfComputationsFromFrame","OfficeVSO:8579351_x10ProcessNotificationsAfterShouldRunPlugin","OfficeVSO:8575821_x10MapGetRichValueFieldListContext","OfficeVSO:8620448_x10SchedulerThrowsFailures","OfficeVSO:8786821_x10SendLoggerMessagesToMainThread","OfficeVSO:8846142_x10SendTelemetryWithUTel","Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions","Microsoft.Office.Excel.CalcTsLstr","Microsoft.Office.Excel.CalcTsInvalidChartMacro","OfficeVSO:8927842_CalcWP5ES6"])});var sg=T($t=>{"use strict";p();Object.defineProperty($t,"__esModule",{value:!0});$t.mapFromArrayOfPairs=$t.singleton=$t.now=$t.typedInstanceCreator=$t.makeStringCompareCI=$t.fastAbs=$t.fastMax=$t.fastMin=$t.pair=$t.filterOutNones=$t.isNone=$t.isDefined=$t.safeConcat=$t.safePush=$t.strEnumArray=$t.numEnumMap=$t.numEnumArray=$t.cloneStringMap=$t.makeStringMap=$t.identity=$t.staticAssertIsOptional=$t.staticAssertIs=$t.staticAssertSame=$t.staticAssertExtends=$t.makeNewtypeIso=void 0;function Bje(e,r){return{wrap:e,unwrap:r}}$t.makeNewtypeIso=Bje;function Uje(){}$t.staticAssertExtends=Uje;function Kje(){}$t.staticAssertSame=Kje;function ope(){return function(e){return e}}$t.staticAssertIs=ope;$t.staticAssertIsOptional=ope();function Vje(e){return e}$t.identity=Vje;function upe(){var e=Object.create(null);return e.___=void 0,delete e.___,e}$t.makeStringMap=upe;function jje(e){var r=upe();for(var t in e)r[t]=e[t];return r}$t.cloneStringMap=jje;function spe(e){return Object.keys(e).map(function(r){return Number(r)}).filter(function(r){return!isNaN(r)})}$t.numEnumArray=spe;function Wje(e,r){for(var t={},n=0,a=spe(e);n<a.length;n++){var o=a[n];t[o]=r(o)}return t}$t.numEnumMap=Wje;function Hje(e){return Object.keys(e).map(function(r){return r}).map(function(r){return e[r]}).sort()}$t.strEnumArray=Hje;function h7(e,r){for(var t=0,n=r;t<n.length;t++){var a=n[t];e.push(a)}return e}$t.safePush=h7;function zje(e,r){var t=[];h7(t,e);for(var n=0,a=r;n<a.length;n++){var o=a[n];h7(t,o)}return t}$t.safeConcat=zje;function lpe(e){return e!=null}$t.isDefined=lpe;function Qje(e){return e==null}$t.isNone=Qje;function Xje(e){return e.filter(lpe)}$t.filterOutNones=Xje;var dWr=function(){function e(){}return e}();function Yje(e,r){return[e,r]}$t.pair=Yje;function Jje(e,r){return e<r?e:r}$t.fastMin=Jje;function Zje(e,r){return e<r?r:e}$t.fastMax=Zje;function $je(e){return e<0?-e:e}$t.fastAbs=$je;function eWe(e){var r=[e],t=e.indexOf("-");return t>0&&r.push(e.substring(0,t)),r[r.length-1]!=="en"&&r.push("en"),r}function rWe(e){var r={sensitivity:"accent"};try{var t=new Intl.Collator(eWe(e),r);return t.compare.bind(t)}catch(n){return function(o,u){return o===u?0:o.toLocaleUpperCase().localeCompare(u.toLocaleUpperCase())}}}$t.makeStringCompareCI=rWe;function tWe(){return function(e){return e}}$t.typedInstanceCreator=tWe;$t.now=typeof self<"u"&&self.performance!=null&&self.performance.now!=null?function(){return self.performance.now()}:typeof process<"u"&&process.hrtime!=null?function(){var e=process.hrtime(),r=e[0],t=e[1];return r*1e3+t/1e6}:function(){return Date.now()};function nWe(e){var r=function(){function t(){}return t.instance=function(){return t.value===void 0&&(t.value=e()),t.value},t.prototype.instance=function(){return t.instance()},t.value=void 0,t}();return r}$t.singleton=nWe;function aWe(e){return e.reduce(function(r,t){var n=t[0],a=t[1];return r[n]=a,r},{})}$t.mapFromArrayOfPairs=aWe});var dpe=T(l0=>{"use strict";p();Object.defineProperty(l0,"__esModule",{value:!0});l0.randomElement=l0.randomShuffled=l0.randomIndex=l0.randomFloat=void 0;var iWe=ty(),oWe=u7(),S7=uWe(.4531024141007942);function uWe(e){var r=process.env.BXL_RUN!=null?e:Math.random()*Date.now();return new oWe.JSF32(r)}function sWe(){return S7.next()}l0.randomFloat=sWe;function cpe(e){return(0,iWe.assertTrue)("calc.common.randomIndex",e>0),Math.min(e-1,Math.floor(S7.next()*e))}l0.randomIndex=cpe;function lWe(e){var r=e.map(function(n){return[S7.next(),n]}),t=r.sort(function(n,a){return n[0]<a[0]?-1:n[0]===a[0]?0:1});return t.map(function(n){return n[1]})}l0.randomShuffled=lWe;function cWe(e){return e[cpe(e.length)]}l0.randomElement=cWe});var wP=T(IP=>{"use strict";p();Object.defineProperty(IP,"__esModule",{value:!0});IP.entry=IP.makeEmptyTable=void 0;var dWe={getCount:function(){return 0},getValue:function(){},getEntry:function(){},contains:function(){return!1},forEach:function(){return!0}};function fWe(){return dWe}IP.makeEmptyTable=fWe;function pWe(e,r){return{key:e,value:r}}IP.entry=pWe});var mpe=T(Tp=>{"use strict";p();Object.defineProperty(Tp,"__esModule",{value:!0});Tp.enumerateKeysInOrder=Tp.enumerateInOrder=Tp.RootPointer=Tp.ArrayMapTree=Tp.floorToPowerOf2=void 0;var mWe=wP();function fpe(e){if(e===0)return 0;var r=e;return r=(r|r>>>1)>>>0,r=(r|r>>>2)>>>0,r=(r|r>>>4)>>>0,r=(r|r>>>8)>>>0,r=(r|r>>>16)>>>0,r+=1,r/2}Tp.floorToPowerOf2=fpe;var gWe=function(){function e(r,t,n){this.keyCompare=r,this.keys=t,this.values=n}return e.create=function(r){return new e(r,[],[])},e.prototype.setValue=function(r,t){return this.setValues([[r,t]])},e.prototype.remove=function(r){var t=this.getKeyIndex(r);return t===void 0?this:this.filter(function(n){return n!==r})},e.prototype.getOrSetValue=function(r,t){var n=this.getKeyIndex(r);if(n===void 0){var a=t();return[this.setValue(r,a),a]}return[this,this.values[n]]},e.prototype.filter=function(r){for(var t=[],n=0;n<this.keys.length;n+=1){var a=this.keys[n],o=this.values[n];r(a,o)&&t.push([a,o])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(r){var t=this.getKeyIndex(r);if(t!==void 0)return this.values[t]},e.prototype.getEntry=function(r){var t=this.getKeyIndex(r);if(t!==void 0)return(0,mWe.entry)(this.keys[t],this.values[t])},e.prototype.contains=function(r){return this.getKeyIndex(r)!==void 0},e.prototype.forEach=function(r){for(var t=0;t<this.keys.length;t+=1)if(!r(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(r){var t=this,n=this.keys.map(function(f,m){return[f,t.values[m],m]}),a=n.length;r.forEach(function(f,m){var v=f[0],h=f[1];return n.push([v,h,m+a])}),n.sort(function(f,m){var v=f[0],h=f[2],y=m[0],_=m[2],E=t.keyCompare(v,y);return E!==0?E:h-_});for(var o=[],u=void 0,s=0;s<n.length;s+=1){var l=n[s],c=l[0],d=l[1];u===void 0||this.keyCompare(c,u)!==0?(o.push([c,d]),u=c):o[o.length-1]=[c,d]}return this.ofSequence(o)},e.prototype.getKeyIndex=function(r){for(var t=Tp.RootPointer;t>=0&&t<this.keys.length;){var n=this.keyCompare(r,this.keys[t]);if(n===0)return t;if(n<0){t=b7(t);continue}if(n>0){t=C7(t);continue}}},e.prototype.ofSequence=function(r){var t=this,n=r.slice();n.sort(function(f,m){var v=f[0],h=m[0];return t.keyCompare(v,h)});for(var a=new Array(n.length),o=new Array(n.length),u=hWe(n.length),s=0;s<n.length;s+=1){var l=n[u[s]],c=l[0],d=l[1];a[s]=c,o[s]=d}return new e(this.keyCompare,a,o)},e}();Tp.ArrayMapTree=gWe;Tp.RootPointer=0;function ppe(e,r){var t=[];return y7(e,r,t),t}Tp.enumerateInOrder=ppe;function y7(e,r,t){r<0||r>=e.keys.length||(y7(e,b7(r),t),t.push([e.keys[r],e.values[r]]),y7(e,C7(r),t))}function vWe(e,r){return ppe(e,r).map(function(t){var n=t[0];return n})}Tp.enumerateKeysInOrder=vWe;function hWe(e){var r=new Array(e);return _7(Tp.RootPointer,r,0,e),r}function _7(e,r,t,n){if(!(e>=r.length)){var a=SWe(n);r[e]=t+a,_7(b7(e),r,t,a),_7(C7(e),r,t+a+1,n-a-1)}}function SWe(e){var r=fpe(e);return r/2-1<=e-r?r-1:e-r/2}function b7(e){return 2*e+1}function C7(e){return 2*e+2}});var T7=T(_L=>{"use strict";p();Object.defineProperty(_L,"__esModule",{value:!0});_L.BinaryHeap=void 0;var yWe=function(){function e(r){this.items=[],this.cmp=r}return e.prototype.insert=function(r){this.items.push(r);for(var t=this.getCount()-1;t>0;){var n=t-1>>>1,a=this.items[n];if(this.cmp(a,r)>0)this.items[t]=a;else break;t=n}this.items[t]=r},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var r=this.peek(),t=this.items.pop(),n=this.getCount()-1;if(n<0||t===void 0)return r;var a=0;for(this.items[0]=t;a<n;){var o=a,u=(a<<1)+1,s=(a<<1)+2;if(u<=n&&this.cmp(this.items[u],t)<0&&(o=u),s<=n&&this.cmp(this.items[s],o===u?this.items[o]:t)<0&&(o=s),a!==o)this.items[a]=this.items[o],a=o;else break}return this.items[a]=t,r},e.prototype.getCount=function(){return this.items.length},e.prototype.clear=function(){this.items.length=0},e.prototype.forEach=function(r){for(var t=0,n=this.items;t<n.length;t++){var a=n[t];if(!r(a))return}},e}();_L.BinaryHeap=yWe});var E7=T(Ge=>{"use strict";p();Object.defineProperty(Ge,"__esModule",{value:!0});Ge.forEachKeyUntyped=Ge.forEachKey=Ge.getNodeCount=Ge.complement=Ge.symmetricDiff=Ge.lazy=Ge.empty=Ge.dense=Ge.compareUntyped=Ge.combineCmp=Ge.compare=Ge.exceptUntyped=Ge.except=Ge.meetsUntyped=Ge.meets=Ge.intersectUntyped=Ge.intersect=Ge.unionUntyped=Ge.union=Ge.fromUntyped=Ge.createFromKey=Ge.cacheKeySplitting=Ge.SetKind=void 0;var gpe=fe(),_We=fe(),bWe=_We.__assign,bL;(function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"})(bL||(Ge.SetKind=bL={}));function vpe(e,r,t){return t===void 0&&(t=10),function(n){if(n.split!==void 0)return n.split;var a=e(n),o=n===r?0:n.depth;return o!==void 0&&o<t&&(n.split=a,a[0][0].depth=o+1,a[1][0].depth=o+1),a}}Ge.cacheKeySplitting=vpe;function CWe(e){var r=gpe.__assign(gpe.__assign({},e),{split:vpe(e.split,e.top)});return function(t){return LP(r,AL(r,r.top,t))}}Ge.createFromKey=CWe;function LP(e,r){return r===Ge.empty?Ge.empty:r===Ge.dense?Ge.dense:{setOperations:e,root:r}}Ge.fromUntyped=LP;function hpe(e,r){return r===Ge.empty?e:r===Ge.dense||e===Ge.empty?r:e===Ge.dense?e:LP(e.setOperations,CL(e.setOperations,e.setOperations.top,e.root,r.root))}Ge.union=hpe;function CL(e,r,t,n){if(n===Ge.empty)return t;if(n===Ge.dense||t===Ge.empty)return n;if(t===Ge.dense)return t;if(t.isExact&&n.isExact){var a=TWe(e,r,t,n);if(a!==void 0)return a}var o=lg(e,r,t),u=lg(e,r,n),s=e.split(r),l=s[0][0],c=s[1][0],d=CL(e,l,o.left,u.left),f=CL(e,c,o.right,u.right);return Yk(e,l,c,d,f)}Ge.unionUntyped=CL;function TWe(e,r,t,n){var a=t.key,o=n.key,u=e.compare(a,o);if(u!==void 0)return u<0?n:t;var s=e.union(a,o);if(s!==void 0){var l=e.compare(s,r);return l!==void 0&&l===0?Ge.dense:DP(e,r,s,!0)}}function RWe(e,r){return e===Ge.empty?e:r===Ge.empty||e===Ge.dense?r:r===Ge.dense?e:LP(e.setOperations,TL(e.setOperations,e.setOperations.top,e.root,r.root))}Ge.intersect=RWe;function TL(e,r,t,n){if(t===Ge.empty)return t;if(n===Ge.empty||t===Ge.dense)return n;if(n===Ge.dense)return t;if(t.isExact&&n.isExact){var a=EWe(e,r,t,n);if(a!==void 0)return a}var o=lg(e,r,t),u=lg(e,r,n),s=e.split(r),l=s[0][0],c=s[1][0],d=TL(e,l,o.left,u.left),f=TL(e,c,o.right,u.right);return Yk(e,l,c,d,f)}Ge.intersectUntyped=TL;function EWe(e,r,t,n){var a=t.key,o=n.key;if(!e.meets(a,o))return Ge.empty;var u=e.compare(a,o);if(u!==void 0)return u<0?t:n;var s=e.intersect(a,o);if(s!==void 0)return DP(e,r,s,!0)}function PWe(e,r){return e===Ge.empty||r===Ge.empty?!1:e===Ge.dense||r===Ge.dense?!0:RL(e.setOperations,e.setOperations.top,e.root,r.root)}Ge.meets=PWe;function RL(e,r,t,n){if(t===Ge.empty||n===Ge.empty)return!1;if(t===Ge.dense||n===Ge.dense)return!0;if(t.isExact&&n.isExact)return e.meets(t.key,n.key);var a=lg(e,r,t),o=lg(e,r,n),u=e.split(r),s=u[0][0],l=u[1][0];return RL(e,s,a.left,o.left)||RL(e,l,a.right,o.right)}Ge.meetsUntyped=RL;function EL(e,r){return e===Ge.empty||r===Ge.empty?e:r===Ge.dense?Ge.empty:e===Ge.dense?LP(r.setOperations,j1(r.setOperations,r.setOperations.top,e,r.root)):LP(e.setOperations,j1(e.setOperations,e.setOperations.top,e.root,r.root))}Ge.except=EL;function j1(e,r,t,n){if(t===Ge.empty||n===Ge.empty)return t;if(n===Ge.dense)return Ge.empty;if(t===Ge.dense){var a=lg(e,r,n),o=e.split(r),u=o[0][0],s=o[1][0],l=j1(e,u,Ge.dense,a.left),c=j1(e,s,Ge.dense,a.right);return Yk(e,u,s,l,c)}if(t.isExact&&n.isExact){var d=AWe(e,r,t,n);if(d!==void 0)return d}var f=lg(e,r,t),m=lg(e,r,n),v=e.split(r),h=v[0][0],y=v[1][0],_=j1(e,h,f.left,m.left),E=j1(e,y,f.right,m.right);return Yk(e,h,y,_,E)}Ge.exceptUntyped=j1;function AWe(e,r,t,n){var a=t.key,o=n.key;if(!e.meets(a,o))return t;var u=e.except(a,o);if(u!==void 0)return DP(e,r,u,!0)}function FWe(e,r){return e===r?0:e===Ge.empty?-1:r===Ge.empty?1:e===Ge.dense?r===Ge.dense?0:1:r===Ge.dense?-1:PL(e.setOperations,e.setOperations.top,e.root,r.root)}Ge.compare=FWe;function Spe(e,r){if(!(e===void 0||r===void 0))return e===0?r:r===0||e===r?e:void 0}Ge.combineCmp=Spe;function PL(e,r,t,n){if(t===n)return 0;if(t===Ge.empty)return-1;if(n===Ge.empty)return 1;if(t===Ge.dense)return n===Ge.dense?0:1;if(n===Ge.dense)return-1;if(t.isExact&&n.isExact)return NWe(e,t,n);var a=lg(e,r,t),o=lg(e,r,n),u=e.split(r),s=u[0][0],l=u[1][0],c=PL(e,s,a.left,o.left);if(c!==void 0){var d=PL(e,l,a.right,o.right);if(d!==void 0)return Spe(c,d)}}Ge.compareUntyped=PL;function NWe(e,r,t){return e.compare(r.key,t.key)}function Yk(e,r,t,n,a){return n===Ge.empty?a===Ge.empty?Ge.empty:a===Ge.dense?ny(n,a,void 0,!1,e.infimum(t,t),e.supremum(t,t)):ny(n,a,void 0,!1,a.infimum,a.supremum):a===Ge.empty?n===Ge.dense?ny(n,a,void 0,!1,e.infimum(r,r),e.supremum(r,r)):ny(n,a,void 0,!1,n.infimum,n.supremum):n===Ge.dense?a===Ge.dense?Ge.dense:ny(n,a,void 0,!1,e.combineInfima(e.infimum(r,r),a.infimum),e.combineSuprema(e.supremum(r,r),a.supremum)):a===Ge.dense?ny(n,a,void 0,!1,e.combineInfima(n.infimum,e.infimum(t,t)),e.combineSuprema(n.supremum,e.supremum(t,t))):ny(n,a,void 0,!1,e.combineInfima(n.infimum,a.infimum),e.combineSuprema(n.supremum,a.supremum))}Ge.dense=bL.Dense;Ge.empty=bL.Empty;function ny(e,r,t,n,a,o){return{key:t,left:e,right:r,isExact:n,infimum:a,supremum:o}}function AL(e,r,t){if(!e.meets(r,t))return Ge.empty;var n=e.compare(r,t);if(n!==void 0)return n<=0?Ge.dense:DP(e,r,t,!0);var a=e.intersect(r,t);return a!==void 0?DP(e,r,a,!0):DP(e,r,t,!1)}Ge.lazy=AL;function DP(e,r,t,n){return n?ny(void 0,void 0,t,!0,e.infimum(t,r),e.supremum(t,r)):ny(void 0,void 0,t,!1,e.infimum(t,r),e.supremum(t,r))}function lg(e,r,t){if(t.left!==void 0)return t;var n=e.split(r),a=n[0][0],o=n[1][0],u=AL(e,a,t.key),s=AL(e,o,t.key),l=Yk(e,a,o,u,s);if(l===Ge.empty||l===Ge.dense)throw new Error("incorrect set operations implementation");var c=l,d=t;return bWe(d,{left:c.left,right:c.right})}function OWe(e,r){return hpe(EL(e,r),EL(r,e))}Ge.symmetricDiff=OWe;function kWe(e){return EL(Ge.dense,e)}Ge.complement=kWe;function MWe(e){return e===Ge.empty||e===Ge.dense?0:R7(e.root)}Ge.getNodeCount=MWe;function R7(e){return e===void 0||e===Ge.empty||e===Ge.dense?0:R7(e.left)+R7(e.right)+1}function xWe(e,r){return e===Ge.empty?!0:ype(e.setOperations,e.root,r)}Ge.forEachKey=xWe;function ype(e,r,t){function n(a,o){if(o===Ge.empty)return!0;if(o===Ge.dense)return t(a);if(o.isExact)return t(o.key);var u=lg(e,a,o),s=e.split(a),l=s[0][0],c=s[1][0];return n(l,u.left)&&n(c,u.right)}return n(e.top,r)}Ge.forEachKeyUntyped=ype});var _pe=T(FL=>{"use strict";p();Object.defineProperty(FL,"__esModule",{value:!0});FL.Deque=void 0;function c0(e,r){return e&r-1}var IWe=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var r=this.values.length;if(this.count>=r){this.values.length=r<<1;for(var t=0;t<this.front;t+=1)this.values[r+t]=this.values[t],this.values[t]=void 0;return}var n=r>>4;if(n>=1&&this.count<n){for(var t=0;t<this.count;t+=1)this.values[c0(this.front+t,n)]=this.values[c0(this.front+t,r)];this.values.length=n,this.front=c0(this.front,n)}},e.prototype.pushBack=function(r){this.maybeResize(),this.values[c0(this.front+this.count,this.values.length)]=r,this.count+=1},e.prototype.pushFront=function(r){this.maybeResize();var t=c0(this.front-1,this.values.length);this.values[t]=r,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[c0(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.peekPos=function(r){if(!(r<0||r>=this.count))return this.values[c0(this.front+r,this.values.length)]},e.prototype.popBack=function(){var r=c0(this.front+this.count-1,this.values.length),t=this.values[r];return t!==void 0&&(this.values[r]=void 0,this.count-=1),t},e.prototype.popFront=function(){var r=this.values[this.front];return r!==void 0&&(this.values[this.front]=void 0,this.front=c0(this.front+1,this.values.length),this.count-=1),r},e.prototype.forEach=function(r){for(var t=this.values.length,n=0;n<this.count;n+=1){var a=this.values[c0(this.front+n,t)];if(!r(a))return!1}return!0},e}();FL.Deque=IWe});var bpe=T($_=>{"use strict";p();Object.defineProperty($_,"__esModule",{value:!0});$_.makeNumberDict=$_.makeStringDict=$_.makeDictionary=void 0;var P7=wP(),W1=sg();function A7(e){function r(t,n){return Object.prototype.hasOwnProperty.call(t,n)}return{entries:(0,W1.makeStringMap)(),keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(n){var a=this.keyToString(n),o=r(this.entries,a)?this.entries[a]:void 0;return(0,W1.isDefined)(o)?o.value:void 0},getEntry:function(n){var a=this.getValue(n);return a===void 0?void 0:(0,P7.entry)(n,a)},setValue:function(n,a){var o=this.keyToString(n),u=r(this.entries,o)?this.entries[o]:void 0;(0,W1.isDefined)(u)?u.value=a:this.entries[o]=(0,P7.entry)(n,a)},contains:function(n){var a=this.keyToString(n),o=r(this.entries,a)?this.entries[a]:void 0;return(0,W1.isDefined)(o)},remove:function(n){var a=this.keyToString(n);return r(this.entries,a)?(delete this.entries[a],!0):!1},getOrSetValue:function(n,a){var o=this.keyToString(n),u=r(this.entries,o)?this.entries[o]:void 0;if((0,W1.isDefined)(u))return u.value;var s=a();return delete this.entries[o],this.entries[o]=(0,P7.entry)(n,s),s},forEach:function(n){for(var a in this.entries){var o=r(this.entries,a)?this.entries[a]:void 0;if((0,W1.isDefined)(o)&&!n(o.key,o.value))return!1}return!0},filter:function(n){var a=[];this.forEach(function(l,c){return n(l,c)||a.push(l),!0});for(var o=0,u=a;o<u.length;o++){var s=u[o];this.remove(s)}}}}$_.makeDictionary=A7;function wWe(){return A7(W1.identity)}$_.makeStringDict=wWe;function DWe(){return A7(function(e){return String(e)})}$_.makeNumberDict=DWe});var F7=T(OL=>{"use strict";p();Object.defineProperty(OL,"__esModule",{value:!0});OL.logCollisionKey=void 0;var Cpe=nl(),LWe=ty(),NL={},Tpe=0;function qWe(e){var r=NL[e];NL[e]=(r===void 0?0:r)+1,Tpe+=1,Tpe%100===0&&(LWe.ulsLogger.ULS.traceTag(595858520,Cpe.LogCategory.msoulscat_ES_EWAJS,Cpe.TraceLevel.Info,"calc.common.hashUtils.logCollision: ".concat(JSON.stringify(NL),".")),NL={})}function GWe(e){qWe(BWe(e))}OL.logCollisionKey=GWe;function BWe(e){return typeof e=="object"?e===null?"null":"Object {".concat(Object.keys(e),"}"):typeof e}});var Rpe=T(kL=>{"use strict";p();Object.defineProperty(kL,"__esModule",{value:!0});kL.makeHashSet=void 0;var N7=sg(),O7=F7();function UWe(e,r){return{map:{},keyToHash:e,keyEquals:r,nelements:0,add:function(n){var a=this.keyToHash(n);if((0,N7.isNone)(this.map[a]))this.map[a]=[n],this.nelements+=1;else{for(var o=this.map[a],u=0;u<o.length;u+=1)if(this.keyEquals(n,o[u]))return;(0,O7.logCollisionKey)(n),o.push(n),this.nelements+=1}},contains:function(n){var a=this.keyToHash(n),o=this.map[a];if((0,N7.isNone)(o))return!1;for(var u=0;u<o.length;u+=1)if(this.keyEquals(n,o[u]))return!0;return(0,O7.logCollisionKey)(n),!1},forEach:function(n){var a=this,o=Object.keys(this.map);o.forEach(function(u){var s=a.map[Number(u)];s.forEach(function(l){n(l)})})},size:function(){return this.nelements},remove:function(n){var a=this,o=this.keyToHash(n),u=this.map[o];if((0,N7.isNone)(u))return!1;var s=[],l=!1;return u.forEach(function(c){a.keyEquals(n,c)?(a.nelements-=1,l=!0):s.push(c)}),this.map[o]=s,l||(0,O7.logCollisionKey)(n),l}}}kL.makeHashSet=UWe});var Epe=T(IL=>{"use strict";p();Object.defineProperty(IL,"__esModule",{value:!0});IL.makeHashTable=void 0;var ML=wP(),xL=F7(),k7=sg();function KWe(e,r){return{map:{},nentries:0,keyToHash:e,keyEquals:r,getCount:function(){return this.nentries},getValue:function(n){var a=this.getEntry(n);return a===void 0?void 0:a.value},getEntry:function(n){var a=this.keyToHash(n),o=this.map[a];if(!(0,k7.isNone)(o)){for(var u=0;u<o.length;u+=1){var s=o[u];if(this.keyEquals(n,s.key))return s}(0,xL.logCollisionKey)(n)}},contains:function(n){return this.getValue(n)!==void 0},setValue:function(n,a){var o=this.keyToHash(n),u=this.map[o];if(u==null)this.map[o]=[(0,ML.entry)(n,a)],this.nentries+=1;else{for(var s=0;s<u.length;s+=1){var l=u[s];if(this.keyEquals(l.key,n)){l.value=a;return}}u.push((0,ML.entry)(n,a)),this.nentries+=1,(0,xL.logCollisionKey)(n)}},remove:function(n){var a=this.keyToHash(n),o=this.map[a];if((0,k7.isNone)(o))return!1;for(var u=[],s=!1,l=0;l<o.length;l+=1){var c=o[l];this.keyEquals(n,c.key)?(this.nentries-=1,s=!0):u.push(c)}return this.map[a]=u,s||(0,xL.logCollisionKey)(n),s},getOrSetValue:function(n,a){var o=this.keyToHash(n),u=this.map[o];if((0,k7.isNone)(u)){var s=a();return this.map[o]=[(0,ML.entry)(n,s)],this.nentries+=1,s}for(var l=0;l<u.length;l+=1){var c=u[l];if(this.keyEquals(n,c.key))return c.value}var d=a();return u.push((0,ML.entry)(n,d)),this.nentries+=1,(0,xL.logCollisionKey)(n),d},forEach:function(n){var a=this,o=Object.keys(this.map);return o.every(function(u){var s=a.map[Number(u)];return s.every(function(l){return n(l.key,l.value)})})},filter:function(n){var a=[];this.forEach(function(l,c){return n(l,c)||a.push(l),!0});for(var o=0,u=a;o<u.length;o++){var s=u[o];this.remove(s)}}}}IL.makeHashTable=KWe});var Ape=T(d0=>{"use strict";p();Object.defineProperty(d0,"__esModule",{value:!0});d0.binarySearch=d0.exponentialBuckets=d0.linearBuckets=d0.Histogram=void 0;var VWe=function(){function e(r){var t=this;this.buckets=r,this.createSampleCounts=function(){return new Array(t.buckets.length+1).fill(0)},this.sampleCounts=this.createSampleCounts(),this.findBucket=function(){var n=function(u,s){return u-s},a=t.buckets.length;return function(o){return Ppe(t.buckets,0,a,o,n)}}()}return e.prototype.addSample=function(r){var t=this.findBucket(r);t<0&&(t=~t),this.sampleCounts[t]+=1},e.prototype.reset=function(){var r={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),r},e}();d0.Histogram=VWe;function jWe(e,r,t){for(var n=(r-e)/(t-1),a=[],o=e,u=0;u<t;o+=n,u+=1)a.push(o);return a}d0.linearBuckets=jWe;function WWe(e,r,t){for(var n=Math.log(e),a=(Math.log(r)-n)/(t-1),o=[],u=0,s=0;s<t;u+=a,s+=1)o.push(Math.exp(n+u));return o}d0.exponentialBuckets=WWe;function Ppe(e,r,t,n,a){for(var o=r,u=r+t-1;o<=u;){var s=o+(u-o>>>1),l=a(e[s],n);if(l===0)return s;l<0?o=s+1:u=s-1}return~o}d0.binarySearch=Ppe});var M7=T(Ud=>{"use strict";p();Object.defineProperty(Ud,"__esModule",{value:!0});Ud.ivlCompare=Ud.ivlExcept=Ud.ivlMeetsOrTouches=Ud.ivlMeets=Ud.ivlDistance=Ud.ivlMeet=Ud.ivlJoin=void 0;var ay=sg();function HWe(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];return[(0,ay.fastMin)(t,a),(0,ay.fastMax)(n,o)]}Ud.ivlJoin=HWe;function zWe(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];return[(0,ay.fastMax)(t,a),(0,ay.fastMin)(n,o)]}Ud.ivlMeet=zWe;function QWe(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];return(0,ay.fastAbs)(t+n-(a+o))*.5}Ud.ivlDistance=QWe;function XWe(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];return(0,ay.fastMax)(t,a)<(0,ay.fastMin)(n,o)}Ud.ivlMeets=XWe;function YWe(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];return(0,ay.fastMax)(t,a)<=(0,ay.fastMin)(n,o)}Ud.ivlMeetsOrTouches=YWe;function JWe(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];if(t<a&&o>=n)return[t,a];if(t>=a&&o<n)return[o,n]}Ud.ivlExcept=JWe;function ZWe(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];if(t===a&&n===o)return 0;if(t>=a&&n<=o)return-1;if(t<=a&&n>=o)return 1}Ud.ivlCompare=ZWe});var Fpe=T(wL=>{"use strict";p();Object.defineProperty(wL,"__esModule",{value:!0});wL.PriorityQueue=void 0;var $We=T7(),e9e=function(){function e(r){this.min=0,this.max=0,this.heap=new $We.BinaryHeap(function(t,n){var a=t[0],o=t[1],u=n[0],s=n[1],l=r(a,u);return l!==0?l:o-s})}return e.prototype.peek=function(){var r=this.heap.peek();if(r!==void 0)return r[0]},e.prototype.enqueue=function(r){this.max+=1,this.heap.insert([r,this.max])},e.prototype.push=function(r){this.min-=1,this.heap.insert([r,this.min])},e.prototype.pop=function(){var r=this.heap.removeMin();if(r===void 0){this.min=0,this.max=0;return}return r[0]},e.prototype.getCount=function(){return this.heap.getCount()},e.prototype.clear=function(){this.heap.clear()},e}();wL.PriorityQueue=e9e});var Gpe=T(Zi=>{"use strict";p();Object.defineProperty(Zi,"__esModule",{value:!0});Zi.productSetSerializer=Zi.ProductSetSerializer=Zi.getSubspaceCount=Zi.forEachProduct=Zi.getSubspaces=Zi.symmetricDiffProduct=Zi.complementProduct=Zi.meetsProduct=Zi.compareProduct=Zi.exceptProduct=Zi.intersectProduct=Zi.unionProduct=Zi.project=Zi.createFromProduct=void 0;var gi=fe(),qe=E7(),r9e=function(r,t){return r<t?-1:r>t?1:0},t9e=function(r,t){var n=r[0],a=t[0];return r9e(String(n),String(a))},Npe={};function n9e(e){for(var r="",t=0,n=e;t<n.length;t++){var a=n[t];r+=String(a[0]),r+="\0",r+=String(a[1]),r+="\0"}return r}var H1=function(r){for(var t=[],n=0,a=Object.keys(r);n<a.length;n++){var o=a[n],u=o;t.push([u,r[u].id])}var s=n9e(t.sort(t9e)),l=Npe[s];return l===void 0&&(l={box:{},probabilities:{},depth:1},Npe[s]=l),l};function Mpe(e){return Object.getOwnPropertyNames(e).length>0}function Jv(e){return Mpe(e)?{isSubspace:!0,bounds:e}:qe.dense}function w7(e){return e.isSubspace?1:e.subspaceCount}var Ope=function(r,t,n){return{isSubspace:!1,left:r,right:t,bounds:n,subspaceCount:w7(r)+w7(t)}};function qP(e,r){if(r===qe.dense)return r;if(r.isSubspace){for(var t=!1,n=0,a=Object.keys(r.bounds);n<a.length;n++){var o=a[n];if(Object.prototype.hasOwnProperty.call(e,o)){t=!0;break}}if(!t)return qe.dense}return{productOperations:e,root:r}}function jf(e){return e===void 0?qe.dense:e}var cg={unzip:function(r){for(var t={},n={},a=0,o=Object.keys(r);a<o.length;a++){var u=o[a],s=u;if(Object.prototype.hasOwnProperty.call(r,s)){var l=r[s];if(l===qe.empty)return qe.empty;if(l===qe.dense)continue;t[s]=l.setOperations,n[s]=l.root}}return qP(t,Jv(n))},combineProduct:function(r,t,n,a){for(var o={},u=0,s=Object.keys(r);u<s.length;u++){var l=s[u],c=l;if(Object.prototype.hasOwnProperty.call(r,c)){var d=a(r[c],r[c].top,jf(t[c]),jf(n[c]));if(d===qe.empty)return qe.empty;if(d===qe.dense)continue;o[c]=d}}return o},restrict:function(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a={},o=0,u=t;o<u.length;o++){var s=u[o];if(Object.prototype.hasOwnProperty.call(r,s)){var l=r[s];a[s]=l}}return a},fromUntypedProduct:function(r,t,n){for(var a={},o=0,u=n;o<u.length;o++){var s=u[o],l=t[s];a[s]=(0,qe.fromUntyped)(r[s],l!==void 0?l:qe.dense)}return a},denseProduct:function(r){for(var t={},n=0,a=r;n<a.length;n++){var o=a[n];t[o]=qe.dense}return t}};Zi.createFromProduct=cg.unzip.bind(cg);function kpe(e,r,t){var n=cg.combineProduct(e,r,t,qe.unionUntyped);if(n===qe.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function BL(e,r,t){for(var n=0,a=0,o=Object.keys(e);a<o.length;a++){var u=o[a],s=u;if(Object.prototype.hasOwnProperty.call(e,s)){var l=jf(r[s]),c=jf(t[s]),d=e[s];if(n=(0,qe.combineCmp)(n,(0,qe.compareUntyped)(d,d.top,l,c)),n===void 0)return}}return n}var xpe=function(){var e={};return function(r,t,n){var a;if(t===e.left&&n===e.right)return e.res;e.left=t,e.right=n;var o=BL(r,t.bounds,n.bounds);if(o!==void 0)return e.res=o<=0?n:t;for(var u,s=Object.keys(r),l=0,c=s;l<c.length;l++){var d=c[l];if(Object.prototype.hasOwnProperty.call(r,d)){var f=(0,qe.compareUntyped)(r[d],r[d].top,jf(t.bounds[d]),jf(n.bounds[d]));if(f!==0){if(u!==void 0)return e.res=void 0;u=d}}}if(u!==void 0){var m=(0,qe.unionUntyped)(r[u],r[u].top,jf(t.bounds[u]),jf(n.bounds[u]));if(m===qe.empty)return e.res=qe.empty;if(m===qe.dense){var v=t.bounds,h=u,y=v[h],_=gi.__rest(v,[typeof h=="symbol"?h:h+""]);return e.res=Jv(_)}var E=gi.__assign(gi.__assign({},t.bounds),(a={},a[u]=m,a));return e.res=Jv(E)}return e.res=void 0}}();function DL(e,r,t){if(t===qe.empty)return r;if(t===qe.dense||r===qe.empty)return t;if(r===qe.dense)return r;if(!r.isSubspace||!t.isSubspace)return Ope(r,t,kpe(e,r.bounds,t.bounds));var n=xpe(e,r,t);return n!==void 0?n:Ope(r,t,kpe(e,r.bounds,t.bounds))}function D7(e,r,t){for(var n=[],a=3;a<arguments.length;a++)n[a-3]=arguments[a];if(r===qe.empty||r===qe.dense)return r;if(r.isSubspace){var o=cg.restrict.apply(cg,gi.__spreadArray([r.bounds],n,!1));return Jv(o)}var u=UL(e,t),s=u[0],l=u[1],c=z1(e,r,s,l),d=c[0],f=c[1],m=D7.apply(void 0,gi.__spreadArray([e,d,s],n,!1)),v=D7.apply(void 0,gi.__spreadArray([e,f,l],n,!1));return DL(e,m,v)}function Ipe(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];if(e===qe.dense||e===qe.empty)return e;var n=cg.restrict.apply(cg,gi.__spreadArray([e.productOperations],r,!1));if(!Mpe(n))return qe.dense;var a=D7.apply(void 0,gi.__spreadArray([n,e.root,H1(n)],r,!1));return a===qe.empty?a:qP(n,a)}Zi.project=Ipe;function UL(e,r){var t,n,a,o;if(r.children!==void 0)return r.children;for(var u=r.box,s=r.probabilities,l,c,d=0,f=Object.keys(e),m=0,v=f;m<v.length;m++){var h=v[m];if(Object.prototype.hasOwnProperty.call(e,h)){var y=s[h],_=e[h];if(y===void 0){l=h,c=_.top;break}if(y>d){var E=jf(u[h]);if(E===qe.empty)throw new Error("the key split can never return empty");var N=_.top;if(E!==qe.dense){if(!E.isExact)throw new Error("the key can always be represented exactly");N=E.key}if(!_.canSplit(N))continue;l=h,d=y,c=N}}}if(l===void 0||c===void 0)throw new Error("there has to be at least one dimension");var k=e[l],q=k.split(c),V=q[0],I=V[0],M=V[1],B=q[1],U=B[0],j=B[1],X=[{box:gi.__assign(gi.__assign({},u),(t={},t[l]=(0,qe.lazy)(k,k.top,I),t)),probabilities:gi.__assign(gi.__assign({},s),(n={},n[l]=M,n)),depth:r.depth+1},{box:gi.__assign(gi.__assign({},u),(a={},a[l]=(0,qe.lazy)(k,k.top,U),a)),probabilities:gi.__assign(gi.__assign({},s),(o={},o[l]=j,o)),depth:r.depth+1}];return r.depth<10&&(r.children=X),X}function L7(e,r,t,n){if(r===qe.empty)return[qe.empty,qe.empty];if(r===qe.dense)return[Jv(t),Jv(n)];var a=BL(e,r.bounds,t);if(a!==void 0&&a<=0)return[r,qe.empty];var o=cg.combineProduct(e,r.bounds,t,qe.intersectUntyped);if(o===qe.empty)return[qe.empty,r];var u=cg.combineProduct(e,r.bounds,n,qe.intersectUntyped);if(r.isSubspace)return[Jv(o),u===qe.empty?qe.empty:Jv(u)];var s=L7(e,r.left,t,n),l=s[0],c=s[1],d=L7(e,r.right,t,n),f=d[0],m=d[1];return[DL(e,l,f),DL(e,c,m)]}var z1=function(r,t,n,a){var o=n.box,u=a.box;return L7(r,t,o,u)};function LL(e,r,t,n,a){var o=UL(e,n),u=o[0],s=o[1],l=z1(e,r,u,s),c=l[0],d=l[1],f=z1(e,t,u,s),m=f[0],v=f[1],h=a(e,c,m,u);if(h===qe.dense)return qe.dense;var y=a(e,d,v,s);return DL(e,h,y)}function wpe(e,r,t,n){if(t===qe.empty)return r;if(r===qe.empty)return t;if(r===qe.dense)return r;if(t===qe.dense)return t;if(r.isSubspace&&t.isSubspace){var a=xpe(e,r,t);if(a!==void 0)return a}return LL(e,r,t,n,wpe)}function Dpe(e,r){if(r===qe.empty)return e;if(r===qe.dense||e===qe.empty)return r;if(e===qe.dense)return e;var t=gi.__assign(gi.__assign({},e.productOperations),r.productOperations),n=wpe(t,e.root,r.root,H1(t));return n===qe.empty?n:qP(t,n)}Zi.unionProduct=Dpe;function Lpe(e,r,t,n){if(r===qe.empty||t===qe.empty)return qe.empty;if(r===qe.dense)return t;if(t===qe.dense)return r;if(r.isSubspace&&t.isSubspace){var a=cg.combineProduct(e,r.bounds,t.bounds,qe.intersectUntyped);return a===qe.empty?qe.empty:Jv(a)}return LL(e,r,t,n,Lpe)}function a9e(e,r){if(e===qe.empty)return e;if(r===qe.empty||e===qe.dense)return r;if(r===qe.dense)return e;var t=gi.__assign(gi.__assign({},e.productOperations),r.productOperations),n=Lpe(t,e.root,r.root,H1(t));return n===qe.empty?n:qP(t,n)}Zi.intersectProduct=a9e;function i9e(e,r,t){var n,a=BL(e,r.bounds,t.bounds);if(a===0||a===-1)return qe.empty;for(var o,u=Object.keys(e),s=0,l=u;s<l.length;s++){var c=l[s];if(Object.prototype.hasOwnProperty.call(e,c)){var d=(0,qe.compareUntyped)(e[c],e[c].top,jf(r.bounds[c]),jf(t.bounds[c]));if(d===void 0||d>0){if(o!==void 0)return;o=c}}}if(o!==void 0){var f=(0,qe.exceptUntyped)(e[o],e[o].top,jf(r.bounds[o]),jf(t.bounds[o]));if(f===qe.empty)return qe.empty;if(f===qe.dense){var m=r.bounds,v=o,h=m[v],y=gi.__rest(m,[typeof v=="symbol"?v:v+""]);return Jv(y)}var _=gi.__assign(gi.__assign({},r.bounds),(n={},n[o]=f,n));return Jv(_)}}function qL(e,r,t,n){if(r===qe.empty)return r;if(t===qe.dense)return qe.empty;if(t===qe.empty)return r;if(r===qe.dense)return LL(e,r,t,n,qL);if(r.isSubspace&&t.isSubspace){var a=i9e(e,r,t);if(a!==void 0)return a}return LL(e,r,t,n,qL)}function GL(e,r){if(e===qe.empty||r===qe.empty)return e;if(r===qe.dense)return qe.empty;if(e===qe.dense){var t=qL(r.productOperations,qe.dense,r.root,H1(r.productOperations));return t===qe.empty?t:qP(r.productOperations,t)}var n=gi.__assign(gi.__assign({},e.productOperations),r.productOperations),a=qL(n,e.root,r.root,H1(n));return a===qe.empty?a:qP(n,a)}Zi.exceptProduct=GL;function q7(e,r,t,n){if(r===t)return 0;if(r===qe.empty)return-1;if(t===qe.empty)return 1;if(r===qe.dense)return t===qe.dense?0:1;if(t===qe.dense)return-1;if(r.isSubspace&&t.isSubspace)return BL(e,r.bounds,t.bounds);var a=UL(e,n),o=a[0],u=a[1],s=z1(e,r,o,u),l=s[0],c=s[1],d=z1(e,t,o,u),f=d[0],m=d[1],v=q7(e,l,f,o);if(v!==void 0)return(0,qe.combineCmp)(v,q7(e,c,m,u))}function o9e(e,r){if(e===r)return 0;if(e===qe.empty)return-1;if(r===qe.empty)return 1;if(e===qe.dense)return r===qe.dense?0:1;if(r===qe.dense)return-1;var t=gi.__assign(gi.__assign({},e.productOperations),r.productOperations);return q7(t,e.root,r.root,H1(t))}Zi.compareProduct=o9e;function u9e(e,r,t){for(var n=0,a=Object.keys(e);n<a.length;n++){var o=a[n],u=o;if(Object.prototype.hasOwnProperty.call(e,u)){var s=jf(r[u]),l=jf(t[u]),c=e[u];if(!(0,qe.meetsUntyped)(c,c.top,s,l))return!1}}return!0}function G7(e,r,t,n){if(r===qe.empty||t===qe.empty)return!1;if(r===qe.dense||t===qe.dense)return!0;if(!u9e(e,r.bounds,t.bounds))return!1;if(r.isSubspace&&t.isSubspace)return!0;var a=UL(e,n),o=a[0],u=a[1],s=z1(e,r,o,u),l=s[0],c=s[1],d=z1(e,t,o,u),f=d[0],m=d[1];return G7(e,l,f,o)||G7(e,c,m,u)}function s9e(e,r){if(e===qe.empty||r===qe.empty)return!1;if(e===qe.dense||r===qe.dense)return!0;var t=gi.__assign(gi.__assign({},e.productOperations),r.productOperations);return G7(t,e.root,r.root,H1(t))}Zi.meetsProduct=s9e;var l9e=function(r){return GL(qe.dense,r)};Zi.complementProduct=l9e;var c9e=function(r,t){return Dpe(GL(r,t),GL(t,r))};Zi.symmetricDiffProduct=c9e;function d9e(e){if(e===qe.empty||e===qe.dense)return[];var r=[];function t(n){if(n.isSubspace){r.push(n.bounds);return}t(n.left),t(n.right)}return t(e.root),r}Zi.getSubspaces=d9e;function f9e(e,r){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var a=Ipe.apply(void 0,gi.__spreadArray([e],t,!1));if(a===qe.empty)return!0;if(a===qe.dense)return r(cg.denseProduct(t));var o=a.productOperations,u=a.root;function s(l){return l.isSubspace?r(cg.fromUntypedProduct(o,l.bounds,t)):s(l.left)&&s(l.right)}return s(u)}Zi.forEachProduct=f9e;function p9e(e){return e===qe.empty||e===qe.dense?0:w7(e.root)}Zi.getSubspaceCount=p9e;var m9e=function(){function e(r){r===void 0&&(r=[]),this.buffer=r,this.cursor=0}return e.prototype.putBack=function(r){this.cursor-=1,this.buffer[this.cursor]=r},e.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.length===0},enumerable:!1,configurable:!0}),e.prototype.pop=function(){var r=this.pick();return this.cursor+=1,r},e}(),g9e=function(){function e(){var r=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return r}}return e}();function x7(e,r){var t=function(a,o){for(var u=[],s=2;s<arguments.length;s++)u[s-2]=arguments[s];var l=r.get(a);if(l!==void 0){o.push("__cached__",l);return}e.apply(void 0,gi.__spreadArray([a,o],u,!1)),r.set(a,r.size)};return t}function I7(e,r){var t=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];if(a.pick()==="__cached__"){a.pop();var s=a.pop();return r[s]}var l=e.apply(void 0,gi.__spreadArray([a],o,!1));return r.push(l),l};return t}var qpe=function(){function e(r){var t=this,n,a,o,u;this.globalProductOperations=r,this.cached=typeof Map<"u"?new Map:new g9e,this.cache=[],this.serializers={},this.serializeProductSet=function(c,d){if(c===qe.empty||c===qe.dense){d.push(c);return}var f=c,m=t.getDims(f.productOperations);d.push(m),t.serializeUntypedSparseProductCached(f.root,d,m)},this.deserializeProductSet=function(c){var d=c.pop();if(d===qe.empty||d===qe.dense)return d;c.putBack(d);for(var f={},m=c.pop(),v=0,h=m;v<h.length;v++){var y=h[v],_=t.globalProductOperations[y];f[y]=_}var E=t.deserializeUntypedSparseProductCached(c,m);return{productOperations:f,root:E}},this.serializeUntypedSparse=function(c,d,f){d.push(c==null?void 0:c.isExact),d.push(t.serializers[f].serializeBound(c==null?void 0:c.infimum)),d.push(t.serializers[f].serializeBound(c==null?void 0:c.supremum));var m=e.normalizeKey(c==null?void 0:c.key);d.push(t.serializers[f].serializeKey(m));for(var v=0,h=[c==null?void 0:c.left,c==null?void 0:c.right];v<h.length;v++){var y=h[v];y==null||y===qe.empty||y===qe.dense?d.push(y):(d.push("us"),t.serializeUntypedSparseCached(y,d,f))}},this.deserializeUntypedSparse=function(c,d){var f=c.pop(),m=t.serializers[d].deserializeBound(c.pop()),v=t.serializers[d].deserializeBound(c.pop()),h=t.serializers[d].deserializeKey(c.pop()),y=["left","right"].map(function(N){var k=c.pop();if(k==="us"){var q=t.deserializeUntypedSparseCached(c,d);return q}return k}),_=y[0],E=y[1];return{infimum:m,supremum:v,isExact:f,key:h,left:_,right:E}},this.serializeUntypedSparseProduct=function(c,d,f){d.push(c.isSubspace);for(var m=0,v=f;m<v.length;m++){var h=v[m],y=c.bounds[h];t.serializeUntypedSparseCached(y,d,h)}c.isSubspace||(t.serializeUntypedSparseProductCached(c.left,d,f),t.serializeUntypedSparseProductCached(c.right,d,f),d.push(c.subspaceCount))},this.deserializeUntypedSparseProduct=function(c,d){for(var f=c.pop(),m={},v=0,h=d;v<h.length;v++){var y=h[v],_=t.deserializeUntypedSparseCached(c,y);m[y]=_}if(!f){var E=t.deserializeUntypedSparseProductCached(c,d),N=t.deserializeUntypedSparseProductCached(c,d),k=c.pop();return{isSubspace:f,bounds:m,left:E,right:N,subspaceCount:k}}return{isSubspace:f,bounds:m}},this.serializeUntypedSparseCached=x7(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=I7(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=x7(this.serializeProductSet,this.cached),this.deserializeProductSetCached=I7(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=x7(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=I7(this.deserializeUntypedSparseProduct,this.cache);for(var s in r){var l={serializeKey:(n=r[s].serializeKey)!==null&&n!==void 0?n:function(c){return JSON.stringify(c)},deserializeKey:(a=r[s].deserializeKey)!==null&&a!==void 0?a:function(c){return JSON.parse(c)},serializeBound:(o=r[s].serializeBound)!==null&&o!==void 0?o:function(c){return JSON.stringify(c)},deserializeBound:(u=r[s].deserializeBound)!==null&&u!==void 0?u:function(c){return JSON.parse(c)}};this.serializers[s]=l}}return e.prototype.getDims=function(r){return Object.keys(r)},e.prototype.serialize=function(r){this.cached.clear();var t=[];t.push(r.length);for(var n=0,a=r;n<a.length;n++){var o=a[n];this.serializeProductSetCached(o,t)}return JSON.stringify(t)},e.prototype.deserialize=function(r){this.cache.length=0;for(var t=new m9e(JSON.parse(r)),n=t.pop(),a=[],o=0;o<n;o+=1){var u=this.deserializeProductSetCached(t);a.push(u)}return a},e.normalizeKey=function(r){if(typeof r=="object"){var t=gi.__assign({},r);return delete t.depth,delete t.split,t}return r},e}();Zi.ProductSetSerializer=qpe;function v9e(e){return new qpe(e)}Zi.productSetSerializer=v9e});var K7=T(vo=>{"use strict";p();Object.defineProperty(vo,"__esModule",{value:!0});vo.remove=vo.removeUntyped=vo.insert=vo.insertUntyped=vo.forEach=vo.forEachUntyped=vo.find=vo.findUntyped=vo.empty=vo.emptyUntyped=vo.isLeaf=vo.fromUntyped=vo.Color=void 0;var zL=ty(),jL;(function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"})(jL||(vo.Color=jL={}));var B7;(function(e){e[e.DoubleBlack=2]="DoubleBlack"})(B7||(B7={}));var _l=jL.Red,ha=jL.Black,dg=B7.DoubleBlack,iy={c:ha,l:void 0,r:void 0},Bpe={c:dg,l:void 0,r:void 0};function QL(e,r){return{ops:e,root:r}}vo.fromUntyped=QL;function rb(e){return e.l===void 0}vo.isLeaf=rb;function ld(e){return e.c===_l}function Q1(e){return e.c===ha&&e.l!==void 0}function fg(e){return e.c===ha&&e.l===void 0}vo.emptyUntyped=iy;function h9e(e){return QL(e,vo.emptyUntyped)}vo.empty=h9e;function Di(e,r,t,n,a){return{c:e,l:r,key:t,value:n,r:a}}function BP(e,r){var t=r.l,n=r.key,a=r.value,o=r.r;return Di(e,t,n,a,o)}function GP(e){return rb(e)?iy:BP(ha,e)}function S9e(e){return Q1(e)&&e.l.c===ha&&e.r.c===ha?BP(_l,e):e}function y9e(e){return ld(e)&&(e.l.c===_l||e.r.c===_l)?BP(ha,e):e}function WL(e,r,t){if(!rb(t)){var n=e.keyCompare(r,t.key);return n<0?WL(e,r,t.l):n>0?WL(e,r,t.r):t}}vo.findUntyped=WL;function _9e(e,r){return WL(r.ops,e,r.root)}vo.find=_9e;function HL(e,r){return rb(r)?!0:!HL(e,r.l)||!e(r.key,r.value)?!1:HL(e,r.r)}vo.forEachUntyped=HL;function b9e(e,r){return HL(e,r.root)}vo.forEach=b9e;function eb(e,r,t,n,a){if(e===ha){if(ld(r)&&ld(r.l))return Di(_l,BP(ha,r.l),r.key,r.value,Di(ha,r.r,t,n,a));if(ld(a)&&ld(a.r))return Di(_l,Di(ha,r,t,n,a.l),a.key,a.value,BP(ha,a.r));if(ld(r)&&ld(r.r))return Di(_l,Di(ha,r.l,r.key,r.value,r.r.l),r.r.key,r.r.value,Di(ha,r.r.r,t,n,a));if(ld(a)&&ld(a.l))return Di(_l,Di(ha,r,t,n,a.l.l),a.l.key,a.l.value,Di(ha,a.l.r,a.key,a.value,a.r))}if(e===dg){if(ld(a)&&ld(a.l))return Di(ha,Di(ha,r,t,n,a.l.l),a.l.key,a.l.value,Di(ha,a.l.r,a.key,a.value,a.r));if(ld(r)&&ld(r.r))return Di(ha,Di(ha,r.l,r.key,r.value,r.r.l),r.r.key,r.r.value,Di(ha,r.r.r,t,n,a))}return Di(e,r,t,n,a)}function KL(e,r,t,n,a){return e===_l&&r.c===dg&&Q1(a)?eb(ha,Di(_l,GP(r),t,n,a.l),a.key,a.value,a.r):e===_l&&Q1(r)&&a.c===dg?eb(ha,r.l,r.key,r.value,Di(_l,r.r,t,n,GP(a))):e===ha&&r.c===dg&&Q1(a)?eb(dg,Di(_l,GP(r),t,n,a.l),a.key,a.value,a.r):e===ha&&Q1(r)&&a.c===dg?eb(dg,r.l,r.key,r.value,Di(_l,r.r,t,n,GP(a))):e===ha&&r.c===dg&&ld(a)&&Q1(a.l)?Di(ha,eb(ha,Di(_l,GP(r),t,n,a.l.l),a.l.key,a.l.value,a.l.r),a.key,a.value,a.r):e===ha&&ld(r)&&Q1(r.r)&&a.c===dg?Di(ha,r.l,r.key,r.value,eb(ha,r.r.l,r.r.key,r.r.value,Di(_l,r.r.r,t,n,GP(a)))):((0,zL.assertTrue)("calc.common.rbTree.rotate: expected R|B",r.c!==dg&&a.c!==dg),Di(e,r,t,n,a))}function U7(e,r,t,n){if(rb(n))return Di(_l,iy,r,t,iy);var a=e.keyCompare(r,n.key);return a<0?eb(n.c,U7(e,r,t,n.l),n.key,n.value,n.r):a>0?eb(n.c,n.l,n.key,n.value,U7(e,r,t,n.r)):Di(n.c,n.l,r,t,n.r)}function Upe(e,r,t,n){return y9e(U7(e,r,t,n))}vo.insertUntyped=Upe;function C9e(e,r,t){return QL(t.ops,Upe(t.ops,e,r,t.root))}vo.insert=C9e;function VL(e,r,t){if(rb(t))return t;if(t.c===_l&&fg(t.l)&&fg(t.r))return e.keyCompare(r,t.key)===0?iy:t;if(t.c===ha&&fg(t.l)&&fg(t.r))return e.keyCompare(r,t.key)===0?Bpe:t;if(t.c===ha&&ld(t.l)&&fg(t.l.l)&&fg(t.l.r)&&fg(t.r)){var n=e.keyCompare(r,t.key);return n<0?Di(ha,VL(e,r,t.l),t.key,t.value,iy):n>0?t:Di(ha,iy,t.l.key,t.l.value,iy)}var a=e.keyCompare(r,t.key);if(a<0)return KL(t.c,VL(e,r,t.l),t.key,t.value,t.r);if(a>0)return KL(t.c,t.l,t.key,t.value,VL(e,r,t.r));(0,zL.assertTrue)("calc.common.rbTree.rem: expected node",!rb(t.r));var o=Kpe(t.r),u=o[0],s=o[1],l=o[2];return KL(t.c,t.l,u,s,l)}function Kpe(e){if(e.c===_l&&fg(e.l)&&fg(e.r))return[e.key,e.value,iy];if(e.c===ha&&fg(e.l)&&fg(e.r))return[e.key,e.value,Bpe];if(e.c===ha&&fg(e.l)&&ld(e.r))return[e.key,e.value,BP(ha,e.r)];(0,zL.assertTrue)("calc.common.rbTree.remMin: expected node",!rb(e.l));var r=Kpe(e.l),t=r[0],n=r[1],a=r[2];return[t,n,KL(e.c,a,e.key,e.value,e.r)]}function Vpe(e,r,t){var n=VL(e,r,S9e(t));return(0,zL.assertTrue)("calc.common.rbTree.remove: expected R|B",n.c===_l||n.c===ha),n}vo.removeUntyped=Vpe;function T9e(e,r){return QL(r.ops,Vpe(r.ops,e,r.root))}vo.remove=T9e});var jpe=T(XL=>{"use strict";p();Object.defineProperty(XL,"__esModule",{value:!0});XL.RedBlackMapTree=void 0;var oy=K7(),R9e=function(){function e(r,t,n){this.root=r,this.count=t,this.keyCompare=n}return e.create=function(r){return new e(oy.emptyUntyped,0,r)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(r){var t=(0,oy.findUntyped)(this,r,this.root);return t==null?void 0:t.value},e.prototype.getEntry=function(r){return(0,oy.findUntyped)(this,r,this.root)},e.prototype.contains=function(r){return this.getValue(r)!==void 0},e.prototype.forEach=function(r){return(0,oy.forEachUntyped)(r,this.root)},e.prototype.setValue=function(r,t){return new e((0,oy.insertUntyped)(this,r,t,this.root),this.contains(r)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(r){return this.contains(r)?new e((0,oy.removeUntyped)(this,r,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(r,t){var n=this.getValue(r);if(n!==void 0)return[this,n];var a=t();return[new e((0,oy.insertUntyped)(this,r,a,this.root),this.count+1,this.keyCompare),a]},e.prototype.filter=function(r){var t=this,n=oy.emptyUntyped,a=0;return this.forEach(function(o,u){return r(o,u)&&(n=(0,oy.insertUntyped)(t,o,u,n),a+=1),!1}),new e(n,a,this.keyCompare)},e}();XL.RedBlackMapTree=R9e});var Wpe=T(YL=>{"use strict";p();Object.defineProperty(YL,"__esModule",{value:!0});YL.RingBuffer=void 0;var E9e=function(){function e(r){r===void 0&&(r=1/0),this.list=r<1/0?new Array(r):new Array,this.counter=0,this.capacity=r,this.readIndex=0,this.writeIndex=0}return e.prototype.count=function(){return this.counter},e.prototype.isEmpty=function(){return this.counter===0},e.prototype.enqueue=function(r){this.list[this.writeIndex]=r;var t=this.counter!==0&&this.writeIndex===this.readIndex;t?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity},e.prototype.dequeue=function(){if(!this.isEmpty()){var r=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,r}},e.prototype.executeOnEveryElement=function(r){for(var t=0;t<this.counter;t++){var n=(this.readIndex+t)%this.capacity,a=this.list[n];if(a!==void 0){var o=r(a);if(!o)return!1}}return!0},e}();YL.RingBuffer=E9e});var Ype=T(tb=>{"use strict";p();Object.defineProperty(tb,"__esModule",{value:!0});tb.RTree=tb.RTKind=tb.copyExcept=void 0;var Hpe=fe(),Rp=sg(),P9e=wP();function UP(e,r,t){if(t!==void 0){var n=e.slice();return n[r]=t,n}var a=e.slice(0,-1);return r<e.length-1&&(a[r]=e[e.length-1]),a}tb.copyExcept=UP;var Zv;(function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"})(Zv||(tb.RTKind=Zv={}));function Zk(e,r,t){return{kind:e,key:r,value:t}}function V7(e,r){return Zk(Zv.Ptr,e,r)}function KP(e,r){return Zk(Zv.Leaf,e,r)}function X1(e,r){return Zk(Zv.Branch,e,r)}var pg;(function(e){e[e.NotFound=1]="NotFound",e[e.Removed=2]="Removed",e[e.Delete=3]="Delete"})(pg||(pg={}));var A9e=function(){function e(r,t,n){this.lattice=r,this.root=t,this.count=n}return e.create=function(r,t,n,a,o){o===void 0&&(o=2);var u=o>1?Math.ceil(o):1,s=u*2;function l(d,f){var m=n(d,f);return m!==void 0&&m>=0}function c(d,f){var m=n(d,f);return m!==void 0&&m<=0}return new e({keyJoin:r,keyMeets:t,keyCompare:n,keyDistance:a,minChildren:u,maxChildren:s,keyGe:l,keyLe:c},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var t;return(t=this.root)===null||t===void 0?void 0:t.key},enumerable:!1,configurable:!0}),e.prototype.getValue=function(r){if(this.root===void 0)return;function t(n,a){var o=n.keyCompare(a.key,r);if(a.kind===Zv.Ptr)return o===0?a.value:void 0;if(!(o===void 0||o<0))for(var u=0,s=a.value;u<s.length;u++){var l=s[u],c=t(n,l);if(c!==void 0)return c}}return t(this.lattice,this.root)},e.prototype.getEntry=function(r){var t=this.getValue(r);return t===void 0?void 0:(0,P9e.entry)(r,t)},e.prototype.setValue=function(r,t,n){n===void 0&&(n=function(u){return!0});var a=Xpe(this.lattice,this.root,r,n,t);return a!==void 0?a===this.root?this:new e(this.lattice,a,this.count):new e(this.lattice,Qpe(this.lattice,this.root,V7(r,t)),this.count+1)},e.prototype.filter=function(r){var t=new e(this.lattice,void 0,0);return this.forEach(function(n,a){return r(n,a)&&(t=t.setValue(n,a)),!0}),t},e.prototype.contains=function(r,t){return t===void 0&&(t=function(a){return!0}),Xpe(this.lattice,this.root,r,t)!==void 0},e.prototype.getOrSetValue=function(r,t){var n=this.getValue(r);if(n===void 0){var a=t();return[this.setValue(r,a),a]}return[this,n]},e.prototype.forEach=function(r){return Jk(this.root,r)},e.prototype.forEachGe=function(r,t){var n=this;return Jk(this.root,t,function(a){return n.lattice.keyGe(a,r)},function(a){return n.lattice.keyGe(a,r)})},e.prototype.forEachLe=function(r,t){var n=this;return Jk(this.root,t,function(a){return n.lattice.keyMeets(a,r)},function(a){return n.lattice.keyLe(a,r)})},e.prototype.forEachMeets=function(r,t){var n=this;return Jk(this.root,t,function(a){return n.lattice.keyMeets(a,r)},function(a){return n.lattice.keyMeets(a,r)})},e.prototype.remove=function(r){var t=this;if(this.root==null)return this;var n=[],a=this.lattice,o=function m(v,h){var y=a.keyCompare(v.key,r);if(y===void 0||y<0)return(0,Rp.pair)(v,pg.NotFound);if(v.kind===Zv.Leaf){for(var _=v.value,E=0;E<_.length;E+=1)if(a.keyCompare(_[E].key,r)===0){var N=UP(_,E);if(N.length<h){var k=KP(v.key,N);return n.push(k),(0,Rp.pair)(k,pg.Delete)}return(0,Rp.pair)(KP(JL(a,N),N),pg.Removed)}}else for(var _=v.value,E=0;E<_.length;E+=1){var q=m(_[E],a.minChildren),V=q[0],I=q[1];if(I===pg.Delete){var N=UP(_,E);if(N.length>=h)return(0,Rp.pair)(X1(JL(a,N),N),pg.Removed);var k=X1(v.key,N);return n.push(k),(0,Rp.pair)(k,pg.Delete)}if(I===pg.Removed)return(0,Rp.pair)(X1(v.key,UP(_,E,V)),pg.Removed)}return(0,Rp.pair)(v,pg.NotFound)},u=this.root.kind===Zv.Leaf?1:2,s=o(this.root,u),l=s[0],c=s[1];if(l===this.root)return this;for(var d=c===pg.Delete?void 0:l,f=0;f<n.length;f+=1)Jk(n[f],function(m,v){return d=Qpe(t.lattice,d,V7(m,v)),!0});return new e(this.lattice,d,this.count-1)},e}();tb.RTree=A9e;function Jk(e,r,t,n){var a=t!==void 0?t:function(){return!0},o=n!==void 0?n:function(){return!0};if(e==null)return!0;var u=function s(l){if(!a(l.key))return!0;if(l.kind===Zv.Leaf)for(var c=l.value,d=0;d<c.length;d+=1){var f=c[d];if(o(f.key)&&!r(f.key,f.value))return!1}else for(var c=l.value,d=0;d<c.length;d+=1)if(!s(c[d]))return!1;return!0};return u(e)}function F9e(e,r,t){for(var n=0,a=e.keyDistance(r[0].key,t),o=r[0].value.length,u=1;u<r.length;u+=1){var s=r[u],l=e.keyDistance(s.key,t);(l<a||l===a&&s.value.length<o)&&(n=u,a=l,o=s.value.length)}return n}function N9e(e,r){for(var t=0,n=1,a=e.keyDistance(r[0].key,r[1].key),o=2;o<r.length;o+=1)for(var u=0;u<o;u+=1){var s=e.keyDistance(r[u].key,r[o].key);s>a&&(t=u,n=o,a=s)}return(0,Rp.pair)(t,n)}function O9e(e,r){for(var t=N9e(e,r),n=t[0],a=t[1],o=r[n].key,u=r[a].key,s=[],l=0;l<r.length;l+=1){var c=r[l];s.push([c,e.keyDistance(o,c.key)-e.keyDistance(u,c.key)])}s.sort(function(v,h){return v[1]-h[1]});for(var d=e.minChildren;d<r.length-e.minChildren&&s[d][1]<0;d+=1);for(var f=[],m=[],l=0;l<d;l+=1)f.push(s[l][0]);for(var l=d;l<r.length;l+=1)m.push(s[l][0]);return(0,Rp.pair)(f,m)}function JL(e,r){for(var t=r[0].key,n=1;n<r.length;n+=1)t=e.keyJoin(t,r[n].key);return t}function zpe(e,r,t){var n=O9e(e,t),a=n[0],o=n[1];return(0,Rp.pair)(Zk(r,JL(e,a),a),Zk(r,JL(e,o),o))}function Qpe(e,r,t){if(r==null)return KP(t.key,[t]);function n(s){if(s.kind===Zv.Leaf){var l=Hpe.__spreadArray(Hpe.__spreadArray([],s.value,!0),[t],!1);if(l.length>e.maxChildren){var c=zpe(e,s.kind,l),d=c[0],f=c[1];return(0,Rp.pair)(KP(d.key,d.value),f)}return(0,Rp.pair)(KP(e.keyJoin(s.key,t.key),l),void 0)}var m=s.value.slice(),v=F9e(e,m,t.key),h=n(m[v]),y=h[0],_=h[1];if(m[v]=y,_!=null&&(m.push(_),m.length>e.maxChildren)){var E=zpe(e,s.kind,m),N=E[0],f=E[1];return(0,Rp.pair)(X1(N.key,N.value),f)}return(0,Rp.pair)(X1(e.keyJoin(s.key,t.key),m),void 0)}var a=n(r),o=a[0],u=a[1];return u!=null?X1(e.keyJoin(o.key,u.key),[o,u]):o}function Xpe(e,r,t,n,a){if(r===void 0)return;function o(s){if(e.keyCompare(s.key,t)===0)return a===void 0||s.value===a||!n(s.value)?s:V7(s.key,a)}function u(s){if(s.kind===Zv.Leaf){for(var l=0;l<s.value.length;l+=1){var c=s.value[l],d=o(c);if(d!==void 0)return KP(s.key,UP(s.value,l,d))}return}for(var l=0;l<s.value.length;l+=1){var c=s.value[l];if(e.keyMeets(c.key,t)){var d=u(c);if(d!==void 0)return X1(s.key,UP(s.value,l,d))}}}return u(r)}});var $pe=T(nb=>{"use strict";p();Object.defineProperty(nb,"__esModule",{value:!0});nb.boundedParetoSetOperations=nb.boundedParetoSplitter=nb.boundedPareto=void 0;var ZL=sg(),VP=M7();function Jpe(e,r,t){var n=Math.pow(r,e),a=1-Math.pow(r/t,e),o=Math.pow(t,e),u=o*n,s=o-n,l=-1/e,c=e===1?function(f){return(1-n/f)/a}:function(f){return(1-n*Math.pow(f,-e))/a},d=e===1?function(f){return 1/((o-f*s)/u)}:function(f){return Math.pow((o-f*s)/u,l)};return{cdf:c,invCdf:d}}nb.boundedPareto=Jpe;function Zpe(e,r,t){var n=Jpe(e,r,t);return{canSplit:function(o){var u=o[0],s=o[1];return s-u>1},split:function(o){var u=o[0],s=o[1],l=n.cdf(s),c=n.cdf(u+1),d=n.invCdf((l+c)/2),f=(0,ZL.fastMin)((0,ZL.fastMax)(Math.round(d),u+1),s-1),m=n.cdf(f)-n.cdf(u+1),v=n.cdf(s)-n.cdf(f),h=[[[u,f],m],[[f,s],v]];return h}}}nb.boundedParetoSplitter=Zpe;function k9e(e,r,t,n,a){var o=Zpe(e,r,t);return{id:a,split:function(s){return o.split(s)},canSplit:function(s){return o.canSplit(s)},meets:VP.ivlMeets,intersect:VP.ivlMeet,union:function(s,l){return(0,VP.ivlMeetsOrTouches)(s,l)?(0,VP.ivlJoin)(s,l):void 0},except:VP.ivlExcept,compare:VP.ivlCompare,top:n,infimum:function(s){var l=s[0];return l},supremum:function(s){var l=s[1];return l},combineInfima:function(s,l){return(0,ZL.fastMin)(s,l)},combineSuprema:function(s,l){return(0,ZL.fastMax)(s,l)}}}nb.boundedParetoSetOperations=k9e});var ame=T(xa=>{"use strict";p();Object.defineProperty(xa,"__esModule",{value:!0});xa.broadcastArray2D=xa.broadcastArray=xa.sparseArray2DTo1D=xa.transposeSparseArray2D=xa.transposeArray2D=xa.colArray2D=xa.rowArray2D=xa.singletonArray2D=xa.constantArray2D=xa.constantArray=xa.array2DToJaggedArray=xa.jaggedArray=xa.array2DForall2=xa.array2DForall=xa.NonstrictSparseArray2D=xa.NonstrictArray2D=xa.StrictSparseArray2D=xa.StrictArray2D=void 0;var pu=ty(),eme=sg(),rme=function(){function e(r,t,n){(0,pu.assertNatural)("calc.common.StrictArray2D",r),(0,pu.assertNatural)("calc.common.StrictArray2D",t);var a=n.length;a<r&&(0,pu.assertFalse)("calc.common.StrictArray2D: expected elements.length >= ".concat(r,"; given ").concat(a));for(var o=0;o<a;o+=1){var u=n[o].length;u<t&&(0,pu.assertFalse)("calc.common.StrictArray2D: expected elements[".concat(o,"].length >= ").concat(r,"; given ").concat(u))}this.rows=r,this.cols=t,this.elements=n}return e.prototype.get=function(r,t){return(0,pu.assertIndex)("calc.common.StrictArray2D.get",r,this.rows),(0,pu.assertIndex)("calc.common.StrictArray2D.get",t,this.cols),this.elements[r][t]},e.prototype.strict=function(){return this},e.prototype.map=function(r){var t=this;return new uy(this.rows,this.cols,function(n,a){return r(t.elements[n][a])})},e}();xa.StrictArray2D=rme;var tme=function(){function e(r,t,n,a,o,u){(0,pu.assertNatural)("calc.common.StrictSparseArray2D",r),(0,pu.assertNatural)("calc.common.StrictSparseArray2D",t),(0,pu.assertIndex)("calc.common.StrictSparseArray2D",n,r+1),(0,pu.assertIndex)("calc.common.StrictSparseArray2D",a,t+1);var s=o.length;s<n&&(0,pu.assertFalse)("calc.common.StrictSparseArray2D: expected elements.length >= ".concat(n,"; given ").concat(s));for(var l=0;l<s;l+=1){var c=o[l].length;c<a&&(0,pu.assertFalse)("calc.common.StrictSparseArray2D: expected elements[".concat(l,"].length >= ").concat(a,"; given ").concat(c))}this.rows=r,this.cols=t,this.denseRows=n,this.denseCols=a,this.denseElements=o,this.sparseElement=u}return e.prototype.get=function(r,t){return(0,pu.assertIndex)("calc.common.StrictSparseArray2D.get",r,this.rows),(0,pu.assertIndex)("calc.common.StrictSparseArray2D.get",t,this.cols),r<this.denseRows&&t<this.denseCols?this.denseElements[r][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(r){var t=this;return new j7(this.rows,this.cols,this.denseRows,this.denseCols,function(n,a){return r(t.denseElements[n][a])},function(){return r(t.sparseElement)})},e}();xa.StrictSparseArray2D=tme;var uy=function(){function e(r,t,n){(0,pu.assertNatural)("calc.common.NonstrictArray2D",r),(0,pu.assertNatural)("calc.common.NonstrictArray2D",t),this.rows=r,this.cols=t,this.func=n}return e.prototype.get=function(r,t){return(0,pu.assertIndex)("calc.common.NonstrictArray2D.get",r,this.rows),(0,pu.assertIndex)("calc.common.NonstrictArray2D.get",t,this.cols),this.func(r,t)},e.prototype.strict=function(){var r=$L(this.rows,this.cols,this.func);return new rme(this.rows,this.cols,r)},e.prototype.map=function(r){var t=this;return new e(this.rows,this.cols,function(n,a){return r(t.func(n,a))})},e}();xa.NonstrictArray2D=uy;var j7=function(){function e(r,t,n,a,o,u){(0,pu.assertNatural)("calc.common.NonstrictSparseArray2D",r),(0,pu.assertNatural)("calc.common.NonstrictSparseArray2D",t),(0,pu.assertIndex)("calc.common.NonstrictSparseArray2D",n,r+1),(0,pu.assertIndex)("calc.common.NonstrictSparseArray2D",a,t+1),this.rows=r,this.cols=t,this.denseRows=n,this.denseCols=a,this.denseFunc=o,this.sparseFunc=u}return e.prototype.get=function(r,t){return(0,pu.assertIndex)("calc.common.NonstrictSparseArray2D.get",r,this.rows),(0,pu.assertIndex)("calc.common.NonstrictSparseArray2D.get",t,this.cols),r<this.denseRows&&t<this.denseCols?this.denseFunc(r,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var r=$L(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new tme(this.rows,this.cols,this.denseRows,this.denseCols,r,t)},e.prototype.map=function(r){var t=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,function(n,a){return r(t.denseFunc(n,a))},function(){return r(t.sparseFunc())})},e}();xa.NonstrictSparseArray2D=j7;function M9e(e,r){for(var t=0;t<r.rows;t+=1)for(var n=0;n<r.cols;n+=1)if(!e(r.get(t,n)))return!1;return!0}xa.array2DForall=M9e;function x9e(e,r,t){for(var n=(0,eme.fastMin)(r.rows,t.rows),a=(0,eme.fastMin)(r.cols,t.cols),o=0;o<n;o+=1)for(var u=0;u<a;u+=1)if(!e(r.get(o,u),t.get(o,u)))return!1;return!0}xa.array2DForall2=x9e;function $L(e,r,t){for(var n=[],a=0;a<e;a+=1){for(var o=[],u=0;u<r;u+=1)o[u]=t(a,u);n[a]=o}return n}xa.jaggedArray=$L;function I9e(e){return $L(e.rows,e.cols,e.get.bind(e))}xa.array2DToJaggedArray=I9e;function nme(e,r,t){for(var n=[],a=[],o=0;o<r;o+=1)a[o]=t;for(var u=0;u<e;u+=1)n[u]=a;return n}xa.constantArray=nme;function W7(e,r,t){return new uy(e,r,function(n,a){return t})}xa.constantArray2D=W7;function w9e(e){return W7(1,1,e)}xa.singletonArray2D=w9e;function D9e(e){return new uy(1,e.length,function(r,t){return e[t]})}xa.rowArray2D=D9e;function L9e(e){return new uy(e.length,1,function(r,t){return e[r]})}xa.colArray2D=L9e;function q9e(e){return new uy(e.cols,e.rows,function(r,t){return e.get(t,r)})}xa.transposeArray2D=q9e;function G9e(e){return new j7(e.cols,e.rows,e.denseCols,e.denseRows,function(r,t){return e.get(t,r)},function(){return e.getSparse()})}xa.transposeSparseArray2D=G9e;function B9e(e,r){var t=e.getSparse.bind(e);return(0,pu.assertTrue)("calc.common.sparseArray2DTo1D",r?e.cols===0||e.rows>0:e.rows===0||e.cols>0),r?{length:e.cols,denseLength:e.denseCols,get:function(a){return e.get(0,a)},getSparse:t}:{length:e.rows,denseLength:e.denseRows,get:function(a){return e.get(a,0)},getSparse:t}}xa.sparseArray2DTo1D=B9e;function U9e(e,r,t,n,a,o){if(e===t&&r===n)return a;if(e===1&&r===1)return nme(t,n,a[0]===void 0?o:a[0][0]);var u=[],s;e===1?s=function(f,m){return m<r?a[0][m]:o}:r===1?s=function(f,m){return f<e?a[f][0]:o}:s=function(f,m){return f<e&&m<r?a[f][m]:o};for(var l=0;l<t;l+=1){u.push([]);for(var c=0;c<n;c+=1)u[l][c]=s(l,c)}return u}xa.broadcastArray=U9e;function K9e(e,r,t,n){return t.rows===e&&t.cols===r?t:t.rows===1&&t.cols===1?W7(e,r,t.get(0,0)):t.rows===1?new uy(e,r,function(a,o){return o<t.cols?t.get(0,o):n}):t.cols===1?new uy(e,r,function(a,o){return a<t.rows?t.get(a,0):n}):new uy(e,r,function(a,o){return a<t.rows&&o<t.cols?t.get(a,o):n})}xa.broadcastArray2D=K9e});var ome=T(ime=>{"use strict";p();Object.defineProperty(ime,"__esModule",{value:!0})});var eM=T(Rs=>{"use strict";p();Object.defineProperty(Rs,"__esModule",{value:!0});Rs.MaybeThenable=Rs.collapseThenable=Rs.bindMaybeThenable=Rs.isThenable=Rs.promiseLoop=Rs.newPromise=Rs.promiseFinally=Rs.ResolvablePromiseWithTimeout=Rs.ResolvablePromiseWithSyncValue=Rs.ResolvablePromise=void 0;var ume=fe(),V9e=sg(),$k=function(){function e(){var r=this;this.promise=new Promise(function(t,n){r._resolve=t,r._reject=n})}return e.prototype.then=function(r,t){return this.promise.then(r,t)},e.prototype.toPromise=function(){return this.promise},e.prototype.resolve=function(r){return this._resolve(r),Y1(r)?this.promise.then():void 0},e.prototype.reject=function(r){return this._reject(r),Y1(r)?this.promise.then():void 0},e}();Rs.ResolvablePromise=$k;var j9e=function(e){ume.__extends(r,e);function r(){var t=e.call(this)||this;return t.value=void 0,t.isUninitialized=!0,t.then(function(n){return t.value=n}),t}return r.prototype.getCurrentValue=function(){return this.value},r.prototype.resolve=function(t){return Y1(t)?e.prototype.resolve.call(this,t):(this.isUninitialized&&(this.value=t,this.isUninitialized=!1),e.prototype.resolve.call(this,t))},r}($k);Rs.ResolvablePromiseWithSyncValue=j9e;var W9e=function(e){ume.__extends(r,e);function r(t,n){var a=e.call(this)||this;return n.setTimeout(function(){var o=new Error("Promise timeout");o.name="TimeoutError",a.reject(o)},t),a}return r}($k);Rs.ResolvablePromiseWithTimeout=W9e;function H9e(e,r){return e.then(function(t){return r(),t},function(t){return r(),Promise.reject(t)})}Rs.promiseFinally=H9e;function z9e(){var e,r=new Promise(function(t,n){return e=[t,n]});return[r,e]}Rs.newPromise=z9e;function Q9e(e,r){var t;return new Promise(function(n,a){function o(u){if(u!==void 0){t=u;try{Promise.resolve(e(t)).then(o,a)}catch(s){a(s)}}else n(t)}Promise.resolve(r).then(o,a)})}Rs.promiseLoop=Q9e;function Y1(e){return(0,V9e.isDefined)(e)&&typeof e.then=="function"}Rs.isThenable=Y1;function X9e(e,r,t){return Y1(e)?e.then(r,t):r(e)}Rs.bindMaybeThenable=X9e;function Y9e(e){return e}Rs.collapseThenable=Y9e;Rs.MaybeThenable={all:function(r){var t=new Array(r.length),n=new $k,a=0;return r.forEach(function(o,u){Y1(o)?o.then(function(s){t[u]=s,++a===r.length&&n.resolve(t)},function(s){n.reject(s)}):t[u]=o}),n},any:function(r){var t=new $k;return r.forEach(function(n,a){if(Y1(n))n.then(function(o){t.resolve({result:o,resolvedIndex:a})},function(o){t.reject(o)});else return t.resolve({result:n,resolvedIndex:a})}),t}}});var z7=T(ab=>{"use strict";p();Object.defineProperty(ab,"__esModule",{value:!0});ab.defaultSetTimeoutInterface=ab.clearTimerUnified=ab.setImmediateUnified=void 0;var sme=fe(),J9e=ty();function Z9e(e,r){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return{kind:"Timeout",timer:setTimeout.apply(void 0,sme.__spreadArray([e,r],t,!1))}}function lme(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return{kind:"Immediate",timer:setImmediate.apply(void 0,sme.__spreadArray([e],r,!1))}}ab.setImmediateUnified=lme;function H7(e){switch(e.kind){case"Immediate":clearImmediate(e.timer);break;case"Timeout":clearTimeout(e.timer);break;case"Mocking":e.delayedCallback.isValid=!1;break;default:(0,J9e.assertNever)("unknown timer.kind",e)}}ab.clearTimerUnified=H7;ab.defaultSetTimeoutInterface={setImmediate:lme,setTimeout:Z9e,clearImmediate:H7,clearTimeout:H7}});var fme=T(ib=>{"use strict";p();Object.defineProperty(ib,"__esModule",{value:!0});ib.asyncLoop=ib.asyncLoopFactory=ib.delayPromiseImpl=void 0;var Q7=sg(),$9e=eM(),e8e=z7();function cme(e){return function(r){return new Promise(function(t){return e.setTimeout(t,r,void 0)})}}ib.delayPromiseImpl=cme;function dme(e){return function(r,t){var n,a,o,u=(n=t==null?void 0:t.timeThreshold)!==null&&n!==void 0?n:10,s=(a=t==null?void 0:t.costThreshold)!==null&&a!==void 0?a:1,l=(o=t==null?void 0:t.macrotaskDelay)!==null&&o!==void 0?o:0,c={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},d=(0,$9e.newPromise)(),f=d[0],m=d[1],v=m[0],h=m[1];function y(){try{for(var V=0;V<s;){c.iterations+=1;var I=r();if(I===void 0)return!1;V+=I}return!0}catch(M){return h(M),!1}}var _=!0;function E(){_=!1}var N=e(l),k=(0,Q7.now)();function q(){if(!_||!y())return v();var V=(0,Q7.now)();V-k<u?(Promise.resolve().then(q),c.microtaskContinues+=1):(N.then(function(){N=e(l),k=(0,Q7.now)(),c.macrotaskTotalDelay+=k-V,q()}),c.macrotaskContinues+=1)}return q(),{promise:f,stop:E,stats:c}}}ib.asyncLoopFactory=dme;ib.asyncLoop=dme(cme(e8e.defaultSetTimeoutInterface))});var pme=T(ie=>{"use strict";p();Object.defineProperty(ie,"__esModule",{value:!0});ie.codePointCapitalD=ie.codePointCapitalC=ie.codePointCapitalB=ie.codePointCapitalA=ie.codePointTilde=ie.codePointRightCurlyBracket=ie.codePointPipe=ie.codePointLeftCurlyBracket=ie.codePointBacktick=ie.codePointUnderscore=ie.codePointCircumflexAccent=ie.codePointRightSquareBracket=ie.codePointBackslash=ie.codePointLeftSquareBracket=ie.codePointAtSign=ie.codePointQuestionMark=ie.codePointGreaterThanSign=ie.codePointEqualsSign=ie.codePointLessThanSign=ie.codePointSemicolon=ie.codePointColon=ie.codePointDigitNine=ie.codePointDigitEight=ie.codePointDigitSeven=ie.codePointDigitSix=ie.codePointDigitFive=ie.codePointDigitFour=ie.codePointDigitThree=ie.codePointDigitTwo=ie.codePointDigitOne=ie.codePointDigitZero=ie.codePointSlash=ie.codePointFullStop=ie.codePointMinusSign=ie.codePointComma=ie.codePointPlusSign=ie.codePointAsterisk=ie.codePointRightParen=ie.codePointLeftParen=ie.codePointSingleQuote=ie.codePointAmpersand=ie.codePointPercentSign=ie.codePointDollarSign=ie.codePointHash=ie.codePointDoubleQuote=ie.codePointExclamationMark=ie.codePointSpace=ie.codePointCR=ie.codePointLF=ie.codePointTab=void 0;ie.codePointThaiDigitNine=ie.codePointThaiDigitZero=ie.codePointSmallZ=ie.codePointSmallY=ie.codePointSmallX=ie.codePointSmallW=ie.codePointSmallV=ie.codePointSmallU=ie.codePointSmallT=ie.codePointSmallS=ie.codePointSmallR=ie.codePointSmallQ=ie.codePointSmallP=ie.codePointSmallO=ie.codePointSmallN=ie.codePointSmallM=ie.codePointSmallL=ie.codePointSmallK=ie.codePointSmallJ=ie.codePointSmallI=ie.codePointSmallH=ie.codePointSmallG=ie.codePointSmallF=ie.codePointSmallE=ie.codePointSmallD=ie.codePointSmallC=ie.codePointSmallB=ie.codePointSmallA=ie.codePointCapitalZ=ie.codePointCapitalY=ie.codePointCapitalX=ie.codePointCapitalW=ie.codePointCapitalV=ie.codePointCapitalU=ie.codePointCapitalT=ie.codePointCapitalS=ie.codePointCapitalR=ie.codePointCapitalQ=ie.codePointCapitalP=ie.codePointCapitalO=ie.codePointCapitalN=ie.codePointCapitalM=ie.codePointCapitalL=ie.codePointCapitalK=ie.codePointCapitalJ=ie.codePointCapitalI=ie.codePointCapitalH=ie.codePointCapitalG=ie.codePointCapitalF=ie.codePointCapitalE=void 0;ie.codePointInvertedQuestionMark=ie.codePointInvertedExclamationMark=ie.codePointRightSingleQuotationMark=ie.codePointLeftSingleQuotationMark=ie.codePointEuroSign=ie.codePointFullwidthLatinSmallZ=ie.codePointFullwidthLatinSmallA=ie.codePointFullwidthLatinCapitalZ=ie.codePointFullwidthLatinCapitalA=ie.codePointFullwidthDigitNine=ie.codePointFullwidthDigitZero=void 0;ie.codePointTab=9;ie.codePointLF=10;ie.codePointCR=13;ie.codePointSpace=32;ie.codePointExclamationMark=33;ie.codePointDoubleQuote=34;ie.codePointHash=35;ie.codePointDollarSign=36;ie.codePointPercentSign=37;ie.codePointAmpersand=38;ie.codePointSingleQuote=39;ie.codePointLeftParen=40;ie.codePointRightParen=41;ie.codePointAsterisk=42;ie.codePointPlusSign=43;ie.codePointComma=44;ie.codePointMinusSign=45;ie.codePointFullStop=46;ie.codePointSlash=47;ie.codePointDigitZero=48;ie.codePointDigitOne=49;ie.codePointDigitTwo=50;ie.codePointDigitThree=51;ie.codePointDigitFour=52;ie.codePointDigitFive=53;ie.codePointDigitSix=54;ie.codePointDigitSeven=55;ie.codePointDigitEight=56;ie.codePointDigitNine=57;ie.codePointColon=58;ie.codePointSemicolon=59;ie.codePointLessThanSign=60;ie.codePointEqualsSign=61;ie.codePointGreaterThanSign=62;ie.codePointQuestionMark=63;ie.codePointAtSign=64;ie.codePointLeftSquareBracket=91;ie.codePointBackslash=92;ie.codePointRightSquareBracket=93;ie.codePointCircumflexAccent=94;ie.codePointUnderscore=95;ie.codePointBacktick=96;ie.codePointLeftCurlyBracket=123;ie.codePointPipe=124;ie.codePointRightCurlyBracket=125;ie.codePointTilde=126;ie.codePointCapitalA=65;ie.codePointCapitalB=66;ie.codePointCapitalC=67;ie.codePointCapitalD=68;ie.codePointCapitalE=69;ie.codePointCapitalF=70;ie.codePointCapitalG=71;ie.codePointCapitalH=72;ie.codePointCapitalI=73;ie.codePointCapitalJ=74;ie.codePointCapitalK=75;ie.codePointCapitalL=76;ie.codePointCapitalM=77;ie.codePointCapitalN=78;ie.codePointCapitalO=79;ie.codePointCapitalP=80;ie.codePointCapitalQ=81;ie.codePointCapitalR=82;ie.codePointCapitalS=83;ie.codePointCapitalT=84;ie.codePointCapitalU=85;ie.codePointCapitalV=86;ie.codePointCapitalW=87;ie.codePointCapitalX=88;ie.codePointCapitalY=89;ie.codePointCapitalZ=90;ie.codePointSmallA=97;ie.codePointSmallB=98;ie.codePointSmallC=99;ie.codePointSmallD=100;ie.codePointSmallE=101;ie.codePointSmallF=102;ie.codePointSmallG=103;ie.codePointSmallH=104;ie.codePointSmallI=105;ie.codePointSmallJ=106;ie.codePointSmallK=107;ie.codePointSmallL=108;ie.codePointSmallM=109;ie.codePointSmallN=110;ie.codePointSmallO=111;ie.codePointSmallP=112;ie.codePointSmallQ=113;ie.codePointSmallR=114;ie.codePointSmallS=115;ie.codePointSmallT=116;ie.codePointSmallU=117;ie.codePointSmallV=118;ie.codePointSmallW=119;ie.codePointSmallX=120;ie.codePointSmallY=121;ie.codePointSmallZ=122;ie.codePointThaiDigitZero=3664;ie.codePointThaiDigitNine=3673;ie.codePointFullwidthDigitZero=65296;ie.codePointFullwidthDigitNine=65305;ie.codePointFullwidthLatinCapitalA=65313;ie.codePointFullwidthLatinCapitalZ=65338;ie.codePointFullwidthLatinSmallA=65345;ie.codePointFullwidthLatinSmallZ=65370;ie.codePointEuroSign=8364;ie.codePointLeftSingleQuotationMark=8216;ie.codePointRightSingleQuotationMark=8217;ie.codePointInvertedExclamationMark=161;ie.codePointInvertedQuestionMark=191});var jP=T(ob=>{p();Object.defineProperty(ob,"__esModule",{value:!0});ob.asError=t8e;ob.encodeError=Y7;ob.encodeResultValue=n8e;ob.encodeWorkerErrorInfo=gme;ob.isError=eq;ob.isWorkerError=X7;var mme=fe();function X7(e){return eq(e)&&e.name==="WorkerError"&&typeof e.info=="object"}function eq(e){if(e==null)return!1;if(e instanceof Error)return!0;var r=e;return typeof r.name=="string"&&typeof r.message=="string"&&(r.stack==null||typeof r.stack=="string")}function r8e(e){var r=typeof e;switch(r){case"function":case"symbol":case"undefined":return"<".concat(r,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}function t8e(e){return eq(e)?e:new Error("(non-Error object) ".concat(r8e(e)))}function gme(e){return(0,mme.__assign)((0,mme.__assign)({},e),{error:e.error?Y7(e.error):void 0})}function Y7(e){return{name:e.name,message:X7(e)?e.baseMessage:e.message,stack:e.stack,info:X7(e)?gme(e.info):void 0}}function n8e(e){return eq(e)?{isError:!0,value:Y7(e)}:{isError:!1,value:e}}});var WP=T(f0=>{p();Object.defineProperty(f0,"__esModule",{value:!0});f0.WorkerError=void 0;f0.decodeError=Z7;f0.decodeResultValue=o8e;f0.decodeWorkerErrorInfo=vme;f0.getErrorEventWorkerError=a8e;f0.knownErrorClasses=void 0;var rM=fe(),J7=jP(),rq=f0.WorkerError=function(e){(0,rM.__extends)(r,e);function r(t,n){var a=this.constructor,o,u=e.call(this,"".concat(t,"; info = ").concat(JSON.stringify((0,rM.__assign)((0,rM.__assign)({},n),{error:(o=n.error)===null||o===void 0?void 0:o.message}))))||this;u.baseMessage=t,u.info=n,u.name="WorkerError";var s=a.prototype;return Object.getPrototypeOf(u)!==s&&(Object.setPrototypeOf!=null?Object.setPrototypeOf(u,s):u.__proto__=s),u}return r.isWorkerError=J7.isWorkerError,r}(Error);function a8e(e,r,t){if((0,J7.isError)(t.error)){if((0,J7.isWorkerError)(t.error))return t.error;var n={cause:"UnhandledError",idInfo:e,error:t.error};return new rq("".concat(r," received an unhandled error"),n)}if(t.message==null){var a={cause:"UnhandledError",idInfo:e};return new rq("".concat(r," received a non-error (worker script fetch probably failed)"),a)}var o={cause:"UnhandledError",idInfo:e},u="".concat(t.message," at ").concat(t.filename,":").concat(t.lineno,":").concat(t.colno);return new rq("".concat(r," received an unhandled error: ").concat(u),o)}var i8e=f0.knownErrorClasses={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError};function Z7(e){var r;if(e.name==="WorkerError")r=new rq(e.message,vme(e.info));else{var t=i8e[e.name];t?r=new t(e.message):(r=new Error(e.message),r.name=e.name)}return e.stack!=null&&(r.stack=e.stack),r}function vme(e){return(0,rM.__assign)((0,rM.__assign)({},e),{error:e.error?Z7(e.error):void 0})}function o8e(e){return e.isError?Z7(e.value):e.value}});var HP=T($v=>{p();Object.defineProperty($v,"__esModule",{value:!0});$v.ThreadMessageKind=void 0;$v.dispatchCreateWorker=S8e;$v.dispatchWorkerError=v8e;$v.getCreateMode=m8e;$v.getCreateTimeout=p8e;$v.getSafeParams=f8e;$v.isThreadingSupported=hme;$v.setConfig=d8e;var u8e=fe(),s8e=jP(),l8e=3e5,c8e="Thread",tq;(function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"})(tq||($v.ThreadMessageKind=tq={}));function hme(){return typeof Blob<"u"&&typeof URL<"u"&&URL.createObjectURL!==void 0&&URL.revokeObjectURL!==void 0&&typeof Worker<"u"}var cd;function d8e(e){if(cd)throw new TypeError("setConfig has already been called");cd=e}function f8e(){var e=cd??{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?(0,u8e.__spreadArray)([],e.importScriptUrls,!0):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}}function p8e(e){var r,t;return(t=(r=e==null?void 0:e.createTimeout)!==null&&r!==void 0?r:cd==null?void 0:cd.createTimeout)!==null&&t!==void 0?t:l8e}function m8e(e){var r,t,n=(t=(r=e==null?void 0:e.createMode)!==null&&r!==void 0?r:cd==null?void 0:cd.createMode)!==null&&t!==void 0?t:c8e;return n==="ThreadOrLocal"?hme()?"Thread":"Local":n}function Sme(e){setTimeout(function(){throw e})}function yme(){return typeof self<"u"&&"__typed_workers_thread"in self?self:void 0}function g8e(e){var r=yme();if(r!==void 0){var t={kind:tq.WorkerError,error:(0,s8e.encodeResultValue)(e)};r.postMessage(t)}else console.warn(e)}function v8e(e){var r;try{((r=cd==null?void 0:cd.onWorkerError)!==null&&r!==void 0?r:g8e)(e)}catch(t){console.warn(e),Sme(t)}}function h8e(e){var r=yme();if(r!==void 0){var t={kind:tq.CreateWorker,stats:e};r.postMessage(t)}}function S8e(e){var r;try{((r=cd==null?void 0:cd.onCreateWorker)!==null&&r!==void 0?r:h8e)(e)}catch(t){Sme(t)}}});var nq=T(tM=>{p();Object.defineProperty(tM,"__esModule",{value:!0});tM.indexObject=b8e;tM.paramInsideDef=void 0;var y8e=fe();function _8e(e){throw new ReferenceError("".concat(e," is not defined"))}function b8e(e,r,t){t===void 0&&(t=_8e);try{for(var n=r.split("."),a=0,o=n;a<o.length;a++){var u=o[a];e=e[u]}return e??t(r)}catch(s){return t(r)}}var C8e=tM.paramInsideDef=function e(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.transfer.apply(e,(0,y8e.__spreadArray)([r,void 0],t,!1))};C8e.transfer=function(e,r){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return{def:e,args:t,transferables:r??[]}}});var bme=T(zP=>{p();Object.defineProperty(zP,"__esModule",{value:!0});zP.isTypedChangeGateEnabled=zP.getTypedFeatureGate=void 0;var _me=mi(),S9r=zP.isTypedChangeGateEnabled=(0,_me.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]),y9r=zP.getTypedFeatureGate=(0,_me.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0})});var nM=T(p0=>{p();Object.defineProperty(p0,"__esModule",{value:!0});p0.createEmptyRecord=$7;p0.createObjectFromFunction=O8e;p0.getFunctionPropertyNames=A8e;p0.haveNativeProxy=F8e;p0.maxTimeout=void 0;p0.promiseFinally=R8e;p0.setCallbacksTimeout=P8e;var T8e=bme();function R8e(e,r){return e.then(function(t){return r(),t},function(t){return r(),Promise.reject(t)})}var E8e=p0.maxTimeout=1073741824;function P8e(e,r,t){if(e>E8e)return t;var n=setTimeout(r,Math.max(0,e));return{resolve:function(o){clearTimeout(n),t.resolve(o)},reject:function(o){clearTimeout(n),t.reject(o)}}}function $7(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function A8e(e){for(var r=$7();e!=null;){for(var t=0,n=Object.getOwnPropertyNames(e);t<n.length;t++){var a=n[t];try{typeof e[a]=="function"&&(r[a]=!0)}catch(o){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(r)}var aq;function F8e(){return aq??(aq=N8e())}function N8e(){try{return typeof Proxy=="function"&&new Proxy({},{get:function(){return!0}}).k===!0}catch(e){return!1}}function O8e(e,r){var t=$7(),n=(0,T8e.isTypedChangeGateEnabled)("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(a,o){var u;return o==="then"?void 0:(u=a[o])!==null&&u!==void 0?u:a[o]=e(o)}:function(a,o){var u;return(u=a[o])!==null&&u!==void 0?u:a[o]=e(o)};return r?(r.forEach(function(a){return n(t,a)}),t):new Proxy(t,{get:n})}});var Tme=T(iM=>{p();Object.defineProperty(iM,"__esModule",{value:!0});iM.EndpointState=void 0;iM.throwWorkerError=Cme;var iq=fe(),oq=HP(),aM=jP(),eh=WP(),J1=nM(),Wf;(function(e){e[e.Invoke=0]="Invoke",e[e.Result=1]="Result",e[e.Names=2]="Names",e[e.Close=3]="Close"})(Wf||(Wf={}));function Cme(e){throw e}var k8e=-1,R9r=iM.EndpointState=function(){function e(r,t){var n,a,o=this;this.idInfo=r,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=(0,J1.createEmptyRecord)();var u=function(f){var m,v=f.funcNames;(m=o.onImports)===null||m===void 0||m.call(o,(0,J1.createObjectFromFunction)(o.createPostProxy.bind(o),v),(0,J1.createObjectFromFunction)(o.createCallProxy.bind(o),v))},s=function(){var f;return(f=o.onClose)===null||f===void 0?void 0:f.call(o)},l=(n={},n[Wf.Invoke]=this.onInvoke.bind(this),n[Wf.Result]=this.onResult.bind(this),n[Wf.Names]=u,n[Wf.Close]=s,n),c=(a={},a[Wf.Invoke]=this.onSendInvokeFailed.bind(this),a[Wf.Result]=this.onSendResultFailed.bind(this),a[Wf.Names]=s,a[Wf.Close]=s,a);this.port.onmessage=function(d){var f=d.data;return l[f.kind](f)},this.port.onmessageerror=function(d){var f=d.data;return c[f.kind](f)}}return e.prototype.setExports=function(r){this.exports=r;var t=(0,J1.haveNativeProxy)()?void 0:(0,J1.getFunctionPropertyNames)(r),n={kind:Wf.Names,funcNames:t};this.port.postMessage(n)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;var r={kind:Wf.Close};this.port.postMessage(r),this.port.close();for(var t in this.unresolvedCalls){var n=this.unresolvedCalls[t],a=n.reject,o=n.funcName,u={cause:"Connection",idInfo:this.idInfo,funcName:o},s=new eh.WorkerError("Importing Endpoint closed while waiting for ".concat(o," result"),u);a(s)}}},e.prototype.onInvoke=function(r){var t=this,n=r.callId,a=r.funcName,o=r.args,u=Promise.resolve().then(function(){var s=t.exports[a];if(s)return s.apply(t.exports,o);var l=n>=0?"call":"post",c={cause:"Connection",idInfo:t.idInfo,callId:n,funcName:a};throw new eh.WorkerError("Exporting Endpoint received a ".concat(l," to unknown function ").concat(a),c)});n>=0?u.then(function(s){return t.sendResult(n,a,!0,s)},function(s){return t.sendResult(n,a,!1,s)}):u.catch(function(s){var l=(0,aM.asError)(s),c={cause:"UnhandledError",idInfo:t.idInfo,error:l,callId:n,funcName:a};(0,oq.dispatchWorkerError)(new eh.WorkerError("Exporting Endpoint's ".concat(a," implementation threw or rejected"),c))})},e.prototype.sendResult=function(r,t,n,a){var o=(0,aM.encodeResultValue)(a),u={kind:Wf.Result,callId:r,funcName:t,isFulfilled:n,resultValue:o};try{this.port.postMessage(u,void 0)}catch(s){this.onSendResultFailed(u,(0,aM.asError)(s))}},e.prototype.onSendResultFailed=function(r,t){var n=r.callId,a=r.funcName,o=r.resultValue,u=t?"Exporting Endpoint failed to send ".concat(a," result"):"Importing Endpoint failed to deserialize ".concat(a," result"),s={cause:"MessageError",idInfo:this.idInfo,error:t,callId:n,funcName:a},l=new eh.WorkerError(u,s);o.isError?(0,oq.dispatchWorkerError)(l):this.sendResult(n,a,!1,l)},e.prototype.takeCallbacks=function(r){var t=this.unresolvedCalls[r];return t&&delete this.unresolvedCalls[r],t},e.prototype.setCallTimeout=function(r,t,n,a){var o=this;if(n>J1.maxTimeout)return a;var u=function(){var l=o.takeCallbacks(r);if(l){var c={cause:"Timeout",idInfo:o.idInfo,timeout:n,callId:r,funcName:t};l.reject(new eh.WorkerError("Importing Endpoint's call to ".concat(t," timed out"),c))}};return(0,J1.setCallbacksTimeout)(n,u,a)},e.prototype.sendCall=function(r,t,n,a){var o=this;return new Promise(function(u,s){var l=k8e+=1,c={kind:Wf.Invoke,callId:l,funcName:r,args:t};o.unresolvedCalls[l]=(0,iq.__assign)((0,iq.__assign)({},o.setCallTimeout(l,r,n,{resolve:u,reject:s})),{funcName:r});try{o.port.postMessage(c,a)}catch(v){var d=o.takeCallbacks(l);if(d){var f=(0,aM.asError)(v),m={cause:"MessageError",idInfo:o.idInfo,error:f,callId:l,funcName:r};d.reject(new eh.WorkerError("Importing Endpoint failed to send call to ".concat(r),m))}}})},e.prototype.sendPost=function(r,t,n,a){var o={kind:Wf.Invoke,callId:-1,funcName:r,args:t};try{this.port.postMessage(o,a)}catch(l){var u=(0,aM.asError)(l),s={cause:"MessageError",idInfo:this.idInfo,error:u,callId:-1,funcName:r};n(new eh.WorkerError("Importing Endpoint failed to post to ".concat(r),s))}},e.prototype.onSendInvokeFailed=function(r){var t,n=r.callId,a=r.funcName,o=n>=0?"call":"post",u={cause:"MessageError",idInfo:this.idInfo,callId:n,funcName:a},s=new eh.WorkerError("Exporting Endpoint failed to deserialize ".concat(o," to ").concat(a),u),l=n>=0?this.takeCallbacks(n):void 0,c=(t=l==null?void 0:l.reject)!==null&&t!==void 0?t:oq.dispatchWorkerError;c(s)},e.prototype.onResult=function(r){var t=r.callId,n=r.funcName,a=r.isFulfilled,o=r.resultValue;if(t>=0){var u=this.takeCallbacks(t);if(u){var s=a?u.resolve:u.reject;s((0,eh.decodeResultValue)(o))}}else{var l={cause:"InternalError",idInfo:this.idInfo,callId:t,funcName:n};(0,oq.dispatchWorkerError)(new eh.WorkerError("Exporting Endpoint sent a result for a post to ".concat(n),l))}},e.prototype.createPostProxy=function(r){var t=this,n=function a(){for(var o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];return a.transfer.apply(a,(0,iq.__spreadArray)([void 0],o,!1))};return n.transfer=function(a){for(var o,u,s,l=[],c=1;c<arguments.length;c++)l[c-1]=arguments[c];if(!t.isClosed){var d=(s=(o=n.onPostMessageError)!==null&&o!==void 0?o:(u=t.getOnPostMessageError)===null||u===void 0?void 0:u.call(t))!==null&&s!==void 0?s:Cme;t.sendPost(r,l,d,a)}},n},e.prototype.createCallProxy=function(r){var t=this,n=function a(){for(var o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];return a.transfer.apply(a,(0,iq.__spreadArray)([void 0],o,!1))};return n.transfer=function(a){for(var o,u,s,l=[],c=1;c<arguments.length;c++)l[c-1]=arguments[c];if(t.isClosed){var d={cause:"Connection",idInfo:t.idInfo,funcName:r};return Promise.reject(new eh.WorkerError("".concat(t.idInfo.side," Endpoint's call.").concat(r," called after close"),d))}var f=(s=(o=n.callTimeout)!==null&&o!==void 0?o:(u=t.getCallTimeout)===null||u===void 0?void 0:u.call(t))!==null&&s!==void 0?s:1/0;return t.sendCall(r,l,f,a)},n.callTimeout=void 0,n},e}()});var ez=T(oM=>{p();Object.defineProperty(oM,"__esModule",{value:!0});oM.Endpoint=void 0;oM.getSafeOptions=I8e;var Rme=HP(),M8e=jP(),uq=WP(),Eme=Tme(),x8e=nM();function I8e(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}}var A9r=oM.Endpoint=function(){function e(r,t,n){this.callTimeout=1/0,this.onPostMessageError=Eme.throwWorkerError,this._idInfo=r,this._state=t,this.createMode=n;var a=function(u){return function(){var s=r.side==="Outside"?"inside":"outside",l={cause:"Connection",idInfo:r};throw new uq.WorkerError("".concat(r.side," Endpoint's ").concat(u," referenced before the ").concat(s," Endpoint started"),l)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:a("post")},call:{configurable:!0,enumerable:!1,get:a("call")}})}return e._create=function(r,t,n){var a=t.port,o=t.options,u=t.createMode,s={type:"Endpoint",side:r,id:o==null?void 0:o.id},l,c;try{l=new Eme.EndpointState(s,a),c=new e(s,l,u)}catch(d){return Promise.reject(d)}return new Promise(function(d,f){var m;l.getCallTimeout=function(){return c.callTimeout},l.getOnPostMessageError=function(){return c.onPostMessageError},l.onImports=function(_,E){Object.defineProperties(c,{post:{configurable:!0,enumerable:!1,writable:!1,value:_},call:{configurable:!0,enumerable:!1,writable:!1,value:E}}),h.resolve()},l.onClose=function(){return c.close("Force")};var v=(0,Rme.getCreateTimeout)(o),h=(0,x8e.setCallbacksTimeout)(v,function(){var _=r==="Outside"?"inside":"outside",E={cause:"Timeout",idInfo:s,timeout:v},N=new uq.WorkerError("".concat(r," Endpoint timed out waiting for the ").concat(_," to start"),E);h.reject(N)},{resolve:d,reject:f});c._closedDuringCreate=function(){h.resolve()};var y;try{y=n(c)}catch(_){return h.reject(_)}(m=c._state)===null||m===void 0||m.setExports(y)}).then(function(){return c._closedDuringCreate=void 0,c},function(d){return c._closedDuringCreate=void 0,c.close(),Promise.reject(d)})},e.prototype.hasBeenClosed=function(){return this._state===void 0},e.prototype.close=function(r){var t,n;if(this._state){if(this._closedDuringCreate)if(r==="Force")this._closedDuringCreate();else{var a={cause:"Connection",idInfo:this._idInfo};throw new uq.WorkerError("".concat(this._idInfo.side," Endpoint's close called during creation"),a)}var o=this._state;this._state=void 0;try{o.close(),(t=this._onClose)===null||t===void 0||t.call(this),(n=this.onClose)===null||n===void 0||n.call(this)}catch(u){var a={cause:"Connection",idInfo:this._idInfo,error:(0,M8e.asError)(u)};(0,Rme.dispatchWorkerError)(new uq.WorkerError("".concat(this._idInfo.side," Endpoint's close threw an error"),a))}}},e.createOutside=function(r,t){return t===void 0&&(t=function(){}),e._create("Outside",r,t)},e.createInside=function(r,t){return e._create("Inside",r,t)},e}()});var Pme=T(rz=>{p();Object.defineProperty(rz,"__esModule",{value:!0});rz.importScriptsWithRetry=L8e;function w8e(e,r,t){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(r,"=").concat(t);for(var a=e.slice(0,n+1),o=e.slice(n+1).split("&"),u=0;u<o.length&&!(o[u][r.length]==="="&&o[u].slice(0,r.length)===r);u+=1);return o[u]="".concat(r,"=").concat(t),a+o.join("&")}function D8e(e,r){for(var t,n=0;n<=r;n+=1)try{importScripts(n>0?w8e(e,"retries",String(n)):e);return}catch(a){t=a}throw t}function L8e(e,r){if(r===0){importScripts.apply(void 0,e);return}for(var t=0,n=e;t<n.length;t++){var a=n[t];D8e(a,r)}}});var Ame=T(sq=>{p();Object.defineProperty(sq,"__esModule",{value:!0});sq.isWorkerThread=q8e;sq.workerName=G8e;function q8e(){return typeof WorkerGlobalScope<"u"}function G8e(){return self.name}});var nz=T(rh=>{p();Object.defineProperty(rh,"__esModule",{value:!0});Object.defineProperty(rh,"Endpoint",{enumerable:!0,get:function(){return K8e.Endpoint}});Object.defineProperty(rh,"WorkerError",{enumerable:!0,get:function(){return B8e.WorkerError}});Object.defineProperty(rh,"dispatchWorkerError",{enumerable:!0,get:function(){return tz.dispatchWorkerError}});Object.defineProperty(rh,"importScriptsWithRetry",{enumerable:!0,get:function(){return V8e.importScriptsWithRetry}});Object.defineProperty(rh,"isThreadingSupported",{enumerable:!0,get:function(){return tz.isThreadingSupported}});Object.defineProperty(rh,"isWorkerThread",{enumerable:!0,get:function(){return Fme.isWorkerThread}});Object.defineProperty(rh,"paramInsideDef",{enumerable:!0,get:function(){return U8e.paramInsideDef}});Object.defineProperty(rh,"setConfig",{enumerable:!0,get:function(){return tz.setConfig}});Object.defineProperty(rh,"workerName",{enumerable:!0,get:function(){return Fme.workerName}});var B8e=WP(),tz=HP(),U8e=nq(),K8e=ez(),V8e=Pme(),Fme=Ame()});var Nme=T(lq=>{p();Object.defineProperty(lq,"__esModule",{value:!0});lq.default=void 0;var D9r=lq.default='!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__esDecorate",(function(){return f})),r.d(t,"__runInitializers",(function(){return l})),r.d(t,"__propKey",(function(){return s})),r.d(t,"__setFunctionName",(function(){return d})),r.d(t,"__metadata",(function(){return p})),r.d(t,"__awaiter",(function(){return y})),r.d(t,"__generator",(function(){return v})),r.d(t,"__createBinding",(function(){return _})),r.d(t,"__exportStar",(function(){return g})),r.d(t,"__values",(function(){return b})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return m})),r.d(t,"__spreadArrays",(function(){return w})),r.d(t,"__spreadArray",(function(){return O})),r.d(t,"__await",(function(){return j})),r.d(t,"__asyncGenerator",(function(){return G})),r.d(t,"__asyncDelegator",(function(){return S})),r.d(t,"__asyncValues",(function(){return P})),r.d(t,"__makeTemplateObject",(function(){return T})),r.d(t,"__importStar",(function(){return E})),r.d(t,"__importDefault",(function(){return F})),r.d(t,"__classPrivateFieldGet",(function(){return k})),r.d(t,"__classPrivateFieldSet",(function(){return C})),r.d(t,"__classPrivateFieldIn",(function(){return D}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var u,c=n.kind,f="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,s=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var y={};for(var v in n)y[v]="access"===v?{}:n[v];for(var v in n.access)y.access[v]=n.access[v];y.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var _=(0,r[p])("accessor"===c?{get:s.get,set:s.set}:s[f],y);if("accessor"===c){if(void 0===_)continue;if(null===_||"object"!=typeof _)throw new TypeError("Object expected");(u=a(_.get))&&(s.get=u),(u=a(_.set))&&(s.set=u),(u=a(_.init))&&o.push(u)}else(u=a(_))&&("field"===c?o.push(u):s[f]=u)}l&&Object.defineProperty(l,n.name,s),d=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function s(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}var _=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||_(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function j(e){return this instanceof j?(this.v=e,this):new j(e)}function G(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof j?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function S(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:j(e[n](t)),done:!1}:o?o(t):t}:o}}function P(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&_(t,e,r);return x(t,e),t}function F(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function C(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n={};function o(){return void 0===globalThis.__get_feature_gate_dictionary_variable?n:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){var r;return null!==(r=o()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=o,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";function n(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0,t.getChangeGateDictionary=n,t.isChangeGateEnabled=function(e){var t;return null===(t=n()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(4),t),n.__exportStar(r(2),t),n.__exportStar(r(5),t),n.__exportStar(r(6),t),n.__exportStar(r(7),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){return i(e)?{isError:!0,value:u(e)}:{isError:!1,value:e}}function f(e){throw new ReferenceError("".concat(e," is not defined"))}function l(e,t,r){void 0===r&&(r=f);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var s=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return s.transfer.apply(s,Object(n.__spreadArray)([e,void 0],t,!1))};s.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var d;!function(e){e[e.InitResult=0]="InitResult",e[e.WorkerError=1]="WorkerError",e[e.CreateWorker=2]="CreateWorker"}(d||(d={}));var p="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function y(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:p()))}function v(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function _(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?v(e,"retries",String(n)):e)}catch(e){r=e}throw r}function g(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){_(n[r],t)}else importScripts.apply(void 0,e)}var b=r(3);self.onmessage=function(e){var t,r,i=e.data,u=i.config,f=i.port,s=i.options,v=i.script,_=i.args,h=i.featureGateDictionary,m=i.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(b.setFeatureGateDictionaryGetter)((function(){return h})),Object(b.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=s.importScriptsMaxRetries)&&void 0!==t?t:u.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===u.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return g([u.typedWorkersUrl],O),(w=l(self,null!==(e=u.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(u),w}var G={status:"Pending",start:p()};function S(e,t){var r=e?void 0:c(a(t)),n={kind:d.InitResult,error:r,stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw y(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=y(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return g(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==s?void 0:s.importScriptUrls)&&void 0!==e?e:u.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==v.scriptUrl?[v.scriptUrl]:[],!0),O),l(self,v.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:u,importTypedWorkers:j,connection:{port:f,options:s,createMode:"Thread"}}],_,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);'});var Mme=T(cq=>{p();Object.defineProperty(cq,"__esModule",{value:!0});cq.Thread=void 0;var j8e=fe(),Z1=HP(),az=WP(),W8e=nq(),Ome=z8e(Nme()),H8e=nM(),kme=mi();function z8e(e){return e&&e.__esModule?e:{default:e}}var Q8e=-1;function X8e(e){var r="def"in e?e:(0,W8e.paramInsideDef)(e),t=r.def,n=r.args,a=r.transferables;if(typeof t!="function")return[t,n,a,void 0];var o="__generatedInsideInit".concat(Q8e+=1),u="var ".concat(o," = ").concat(t.toString(),";");return[{scriptUrl:void 0,insideInitName:o},n,a,u]}var G9r=cq.Thread=function(){function e(r,t){var n,a;try{var o=void 0;n=X8e(t),this.script=n[0],this.args=n[1],this.transferables=n[2],o=n[3];var u=o===void 0?[Ome.default]:[o,"\n\n",Ome.default];this.blobUrl=URL.createObjectURL(new Blob(u,{type:"application/javascript"}));var s={};r.id!=null&&(s.name=r.id),this.worker=new Worker(this.blobUrl,s)}catch(l){throw(a=this.worker)===null||a===void 0||a.terminate(),this.revokeBlobUrl(),l}}return e.prototype.revokeBlobUrl=function(){this.blobUrl!==void 0&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(r,t){var n=this,a=r.port,o=r.options,u={type:"Thread",side:"Outside",id:o.id},s=this.worker,l=new Promise(function(c,d){n.createCallbacks={resolve:c,reject:d};var f={config:(0,Z1.getSafeParams)(),port:a,options:o,script:n.script,args:n.args,featureGateDictionary:(0,kme.getFeatureGateDictionary)(),changeGateDictionary:(0,kme.getChangeGateDictionary)()};s.postMessage(f,(0,j8e.__spreadArray)([a],n.transferables,!0)),s.onerror=function(m){m.preventDefault();var v=(0,az.getErrorEventWorkerError)(u,"worker.onerror",m);n.createCallbacks?n.createCallbacks.reject(v):(0,Z1.dispatchWorkerError)(v)},s.onmessage=function(m){var v,h,y=m.data;switch(y.kind){case Z1.ThreadMessageKind.InitResult:return t.insideInit=y.stopwatch,y.error===void 0?(v=n.createCallbacks)===null||v===void 0?void 0:v.resolve():(h=n.createCallbacks)===null||h===void 0?void 0:h.reject((0,az.decodeResultValue)(y.error));case Z1.ThreadMessageKind.WorkerError:return(0,Z1.dispatchWorkerError)((0,az.decodeResultValue)(y.error));case Z1.ThreadMessageKind.CreateWorker:return(0,Z1.dispatchCreateWorker)(y.stats)}}});return(0,H8e.promiseFinally)(l,function(){return void(n.createCallbacks=void 0)})},e.prototype.terminate=function(){var r;if(this.worker){var t=this.worker;this.worker=void 0,(r=this.createCallbacks)===null||r===void 0||r.resolve(),t.terminate(),this.revokeBlobUrl()}},e}()});var wme=T(QP=>{p();Object.defineProperty(QP,"__esModule",{value:!0});QP.createWorkerStats=$8e;QP.startStopwatch=J8e;QP.stopStopwatch=oz;QP.timePromise=Z8e;var Y8e=jP(),Ime=typeof performance<"u"&&performance.timeOrigin!==void 0?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function J8e(){return{status:"Pending",start:Ime()}}function oz(e,r,t){e.status==="Pending"&&(e.status=r,e.end=Math.max(e.start,t??Ime()))}function Z8e(e,r){function t(n){throw oz(e,(0,Y8e.isWorkerError)(n)&&n.info.cause==="Timeout"?"Timeout":"Error"),n}try{return r().then(function(n){var a;return(a=oz(e,"Success"))!==null&&a!==void 0?a:n},t)}catch(n){t(n)}}function dq(e){var r=1e3;return Math.round(e*r)/r}function xme(e,r,t){return e<r?r:e>t?t:e}function iz(e,r,t){var n,a,o,u=xme((n=e==null?void 0:e.start)!==null&&n!==void 0?n:1/0,r,t),s=xme((a=e==null?void 0:e.end)!==null&&a!==void 0?a:1/0,r,t);return{status:(o=e==null?void 0:e.status)!==null&&o!==void 0?o:"Pending",start:dq(u-r),end:dq(s-r),duration:dq(s-u)}}function $8e(e){var r=e.id,t=e.createMode,n=e.createWorker,a=e.insideInit,o=e.createOutside,u=e.createThread,s=n.status,l=n.start,c=n.end;if(!(s==="Pending"||c===void 0)){var d=c-l,f={id:r,createMode:t,createWorker:{status:s,absStart:l,duration:dq(d)},createThread:t==="Thread"?iz(u,l,c):void 0,createOutside:iz(o,l,c),insideInit:iz(a,l,c)};return f}}});var Bme=T(lz=>{p();Object.defineProperty(lz,"__esModule",{value:!0});lz.createWorker=Gme;var uz=fe(),eHe=nq(),Dme=ez(),sz=HP(),rHe=Mme(),tHe=WP(),m0=wme(),nHe=nM(),aHe=iHe(nz());function Lme(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,t=new WeakMap;return(Lme=function(a){return a?t:r})(e)}function iHe(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=Lme(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}var oHe=(0,uz.__assign)((0,uz.__assign)({},aHe),{createWorker:Gme});function uHe(e,r,t){var n="def"in t?t:(0,eHe.paramInsideDef)(t),a=n.def,o=n.args;if(typeof a!="function"){var u={type:"Endpoint",side:"Inside",id:e.options.id},s={cause:"InternalError",idInfo:u};return Promise.reject(new tHe.WorkerError("Loading an InsideScript to create a local worker is unimplemented",s))}return Promise.resolve().then(function(){return(0,m0.timePromise)(r.insideInit=(0,m0.startStopwatch)(),function(){return a.apply(void 0,(0,uz.__spreadArray)([{config:(0,sz.getSafeParams)(),importTypedWorkers:function(){return oHe},connection:e}],o,!1)).then(function(){})})})}function qme(e,r,t,n,a){var o=new MessageChannel,u=o.port1,s=o.port2,l;return Promise.all([n({port:u,options:e,createMode:r}),(0,m0.timePromise)(t.createOutside=(0,m0.startStopwatch)(),function(){return Dme.Endpoint.createOutside({port:s,options:e,createMode:r},function(c){return a(l=c)})})]).then(function(){return l},function(c){return l?l.close("Force"):s.close(),Promise.reject(c)})}function sHe(e,r,t,n){return qme(e,"Local",r,function(a){return uHe(a,r,t)},n)}function lHe(e,r,t,n){r.createThread=(0,m0.startStopwatch)();var a;try{a=new rHe.Thread(e,t)}catch(o){return(0,m0.stopStopwatch)(r.createThread,"Error"),Promise.reject(o)}return(0,m0.stopStopwatch)(r.createThread,"Success"),qme(e,"Thread",r,function(o){return a.createInside(o,r)},n).then(function(o){return o.hasBeenClosed()?a.terminate():o._onClose=a.terminate.bind(a),o},function(o){return a.terminate(),Promise.reject(o)})}function Gme(e,r,t){t===void 0&&(t=function(){});var n=(0,sz.getCreateMode)(e),a="local"in r?n==="Local"?r.local:r.thread:r,o=n==="Local"?sHe:lHe,u={id:e.id,createMode:n,createWorker:(0,m0.startStopwatch)()},s=(0,m0.timePromise)(u.createWorker,function(){return o((0,Dme.getSafeOptions)(e),u,a,t)});return(0,nHe.promiseFinally)(s,function(){var l=(0,m0.createWorkerStats)(u);l&&(0,sz.dispatchCreateWorker)(l)})}});var sy=T(XP=>{p();Object.defineProperty(XP,"__esModule",{value:!0});var cHe={createWorker:!0};Object.defineProperty(XP,"createWorker",{enumerable:!0,get:function(){return dHe.createWorker}});var cz=nz();Object.keys(cz).forEach(function(e){e==="default"||e==="__esModule"||Object.prototype.hasOwnProperty.call(cHe,e)||e in XP&&XP[e]===cz[e]||Object.defineProperty(XP,e,{enumerable:!0,get:function(){return cz[e]}})});var dHe=Bme()});var dz=T(YP=>{"use strict";p();Object.defineProperty(YP,"__esModule",{value:!0});YP.initStopwatch=YP.ulsStopwatchFactory=void 0;var fq=nl(),Ume={ULS:new fq.NulLogger},fHe=function(r){return Ume.ULS.traceTag(595948114,fq.LogCategory.msoulscat_ES_EWAJS,fq.TraceLevel.Info,r)};YP.ulsStopwatchFactory=(0,fq.initStopwatchFactory)(fHe);function pHe(e){Ume.ULS=e}YP.initStopwatch=pHe});var Kme=T(pq=>{"use strict";p();Object.defineProperty(pq,"__esModule",{value:!0});pq.packageVersion=void 0;pq.packageVersion="7.5.49"});var zme=T(bl=>{"use strict";p();Object.defineProperty(bl,"__esModule",{value:!0});bl.initCalcThread=bl.initCalcInThread=bl.initCalc=bl.getCalcAbsUrlOrThrow=bl.getCalcAbsUrl=bl.isCalcInit=bl.maxRetriesForLoadingScript=bl.initCalcCalled=void 0;var uM=fe(),g0=nl(),pz=uM.__importStar(sy()),$1=ty(),mHe=dz(),jme=yL(),Vme=cL(),gHe=eM(),vHe=Kme();bl.initCalcCalled=new gHe.ResolvablePromise;bl.maxRetriesForLoadingScript=9;var hHe=/^(https)|(http)|(file):\/\//,fz=!1,mq=void 0;function SHe(){return fz}bl.isCalcInit=SHe;function yHe(){return mq}bl.getCalcAbsUrl=yHe;function Wme(){if(mq==null)throw new Error("initCalc was not passed calcAbsUrl");return mq}bl.getCalcAbsUrlOrThrow=Wme;function _He(e,r,t){Hme(e,r,t,void 0)}bl.initCalc=_He;function Hme(e,r,t,n){if(fz){var a="calc.config.initCalc: Calc is already initialized";$1.ulsLogger.ULS.traceTag(595910878,g0.LogCategory.msoulscat_ES_EWAJS,g0.TraceLevel.Info,a);return}if($1.ulsLogger.setLogger(e),(0,mHe.initStopwatch)(e),(0,jme.initFeatureConfiguration)(r),t!=null&&!hHe.test(t)){var o="calc.config.initCalc: calcAbsUrl is not absolute: ".concat(t);$1.ulsLogger.ULS.traceTag(595910879,g0.LogCategory.msoulscat_ES_EWAJS,g0.TraceLevel.Warning,o)}pz.setConfig(n??{importScriptsMaxRetries:bl.maxRetriesForLoadingScript,onWorkerError:function(c){var d={error:(0,Vme.messageFromError)(c),innerError:c.info.error?(0,Vme.messageFromError)(c.info.error):void 0},f="calc.onWorkerError: ".concat(JSON.stringify(d));$1.ulsLogger.ULS.traceTag(593335298,g0.LogCategory.msoulscat_ES_EWAJS,g0.TraceLevel.Warning,f)},onCreateWorker:function(c){var d="calc.onCreateWorker: ".concat(JSON.stringify(c));$1.ulsLogger.ULS.traceTag(593335299,g0.LogCategory.msoulscat_ES_EWAJS,g0.TraceLevel.Info,d)}}),mq=t,fz=!0;var u=" (".concat("production",")"),s="calc.config.initCalc: package version ".concat(vHe.packageVersion).concat(u," initialized");$1.ulsLogger.ULS.traceTag(594642132,g0.LogCategory.msoulscat_ES_EWAJS,g0.TraceLevel.Info,s),bl.initCalcCalled.resolve(void 0)}function bHe(e,r,t,n){return uM.__awaiter(this,void 0,void 0,function(){var a;return uM.__generator(this,function(o){switch(o.label){case 0:return[4,pz.Endpoint.createOutside(e)];case 1:return a=o.sent(),Hme(THe(a.post),function(u){return r[u]===!0},t,n),[2]}})})}bl.initCalcInThread=bHe;function CHe(e){return uM.__awaiter(this,void 0,void 0,function(){var r,t,n,a,o,u;return uM.__generator(this,function(s){switch(s.label){case 0:r=Wme(),t=new MessageChannel,n={port:t.port1,options:{id:"WorkerThreadLogger"}},a={port:t.port2,options:{id:"WorkerThreadLogger"}},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Promise.all([pz.Endpoint.createInside(n,function(){return $1.ulsLogger.noThrowLogger}),e.call.initCalcThreadInside.transfer([a.port],a,(0,jme.getFeatures)(),r)])];case 2:return o=s.sent()[0],[2,o];case 3:throw u=s.sent(),n.port.close(),u;case 4:return[2]}})})}bl.initCalcThread=CHe;function THe(e){var r=function(n){return"[".concat(new Date().toISOString(),"] ").concat(n)};return{shipAssertTag:function(n,a,o,u){e.shipAssertTag(n,a,o,r(u))},assertTag:function(n,a,o,u){e.assertTag(n,a,o,r(u))},traceTag:function(n,a,o,u){e.traceTag(n,a,o,r(u))},debugTraceTag:function(n,a,o,u){e.debugTraceTag(n,a,o,r(u))},dnmTraceTag:function(n,a,o,u){e.dnmTraceTag(n,a,o,r(u))}}}});var Qme=T(gq=>{"use strict";p();Object.defineProperty(gq,"__esModule",{value:!0});gq.mixin=void 0;var RHe=fe();function EHe(e,r,t){var n=function(a){RHe.__extends(o,a);function o(){for(var u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];for(var l=a.apply(this,u)||this,c=r(l),d=0,f=t;d<f.length;d++){var m=f[d];Object.defineProperty(l,m,{value:c[m].bind(c),enumerable:!1,configurable:!1})}return l}return o}(e);return n}gq.mixin=EHe});var vq=T(Kd=>{"use strict";p();Object.defineProperty(Kd,"__esModule",{value:!0});Kd.javaScriptError=Kd.ReasonKind=Kd.isSuccess=Kd.failure=Kd.successUndefined=Kd.success=Kd.ResultKind=void 0;var sM;(function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"})(sM||(Kd.ResultKind=sM={}));function Xme(e){return{kind:sM.Success,value:e}}Kd.success=Xme;Kd.successUndefined=Xme(void 0);function PHe(e){return{kind:sM.Failure,reason:e}}Kd.failure=PHe;function AHe(e){return e.kind===sM.Success}Kd.isSuccess=AHe;var mz;(function(e){e.JavaScriptError="JavaScriptError"})(mz||(Kd.ReasonKind=mz={}));function FHe(e){return{kind:mz.JavaScriptError,error:e}}Kd.javaScriptError=FHe});var ige=T(Po=>{"use strict";p();Object.defineProperty(Po,"__esModule",{value:!0});Po.makeIsInClass=Po.forEachClassInterval=Po.codePointIterator=Po.numCodeUnits=Po.stringCodePointAt=Po.countCodePoints=Po.scanCodePointsBack=Po.scanCodePoints=Po.stringFromCodePoint=Po.surrogatePairToCodePoint=Po.isAnySurrogate=Po.isLowSurrogate=Po.isHighSurrogate=void 0;var Yme=sg(),Zme=55296,$me=56320,Jme=65533;function cM(e){return(e&64512)===Zme}Po.isHighSurrogate=cM;function dM(e){return(e&64512)===$me}Po.isLowSurrogate=dM;function ege(e){return(e&63488)===55296}Po.isAnySurrogate=ege;function rge(e,r){if(!(!cM(e)||!dM(r)))return((e&1023)<<10|r&1023)+65536}Po.surrogatePairToCodePoint=rge;function NHe(e){if(e<=65535)return String.fromCharCode(e);var r=e-65536;return String.fromCharCode(r>>10|Zme,r&1023|$me)}Po.stringFromCodePoint=NHe;function OHe(e,r,t){for(var n=r,a=0;a<t;a+=1){if(n>=e.length)return;var o=e.charCodeAt(n);cM(o)&&n+1<e.length&&dM(e.charCodeAt(n+1))?n+=2:n+=1}return n}Po.scanCodePoints=OHe;function kHe(e,r,t){for(var n=r,a=0;a<t;a+=1){if(n-1<0)return;var o=e.charCodeAt(n-1);dM(o)&&n-2>=0&&cM(e.charCodeAt(n-2))?n-=2:n-=1}return n}Po.scanCodePointsBack=kHe;function MHe(e,r,t){for(var n=0,a=r;a<t;n+=1){var o=e.charCodeAt(a);cM(o)&&a+1<t&&dM(e.charCodeAt(a+1))?a+=2:a+=1}return n}Po.countCodePoints=MHe;function tge(e,r){var t=e.charCodeAt(r);if(!ege(t))return t;if(r+1>=e.length)return Jme;var n=e.charCodeAt(r+1),a=rge(t,n);return a??Jme}Po.stringCodePointAt=tge;function nge(e){return e>=65536?2:1}Po.numCodeUnits=nge;function xHe(e,r){r===void 0&&(r=0);for(var t=[],n=r;n<e.length;){var a=tge(e,n);t.push(a),n+=nge(a)}return t}Po.codePointIterator=xHe;function age(e,r){if((e.length&1)===1)throw new Error("Invalid class length");for(var t=0;t<e.length;t+=2){var n=e[t],a=e[t+1];r(n,a)}}Po.forEachClassInterval=age;var lM=7;function IHe(e){for(var r=[],t=0;t<512;++t)r.push([]);return age(e,function(n,a){for(var o=n>>lM,u=a-1>>lM,s=o;s<=u;++s){var l=s<<lM,c=s+1<<lM;r[s].push((0,Yme.fastMax)(n,l),(0,Yme.fastMin)(a,c))}}),r}function wHe(e){var r=IHe(e);return function(t){if(t<0||t>65535)return!1;for(var n=r[t>>>lM],a=0;a<n.length;a+=2){var o=n[a],u=n[a+1];if(t>=o&&t<u)return!0}return!1}}Po.makeIsInClass=wHe});var uge=T(JP=>{"use strict";p();Object.defineProperty(JP,"__esModule",{value:!0});JP.wrapIntoAsync=JP.wrapIntoAsyncClass=void 0;function DHe(e){for(var r=function(){function s(l){this.obj=l}return s}(),t=r,n=function(l){t.prototype[l]=function(){for(var c,d=[],f=0;f<arguments.length;f++)d[f]=arguments[f];var m=(c=this.obj)[l].apply(c,d);return Promise.resolve(m)}},a=0,o=e;a<o.length;a++){var u=o[a];n(u)}return t}function oge(){return function(e){return DHe(e)}}JP.wrapIntoAsyncClass=oge;function LHe(e,r){var t=oge()(r);return new t(e)}JP.wrapIntoAsync=LHe});var sge=T(hq=>{"use strict";p();Object.defineProperty(hq,"__esModule",{value:!0});hq.createArrayLogger=void 0;var qHe=fe();function GHe(e,r,t){e===void 0&&(e=!1),r===void 0&&(r=function(){return!0});function n(u){t===void 0?u():setTimeout(function(){return u()},t)}var a=new Set,o=new Set;return{log:[],addTriggerListener:function(s){a.add(s)},waitForMessage:function(s,l){var c=this;return new Promise(function(d){var f=setTimeout(function(){console.warn("ArrayLogger.waitForMessage: timed out waiting for message; timeout = ".concat(l)),d(!1)},l);c.addTriggerListener(function(m){var v=s(m);return v&&(clearTimeout(f),d(!0)),v})})},waitForReceivedButDelayedMessages:function(){var s=[];return o.forEach(function(l){return s.push(l)}),Promise.all(s).then(function(){})},addLogMessage:function(s){var l=this;if(r(s)){var c=new Promise(function(d){n(function(){l.log.push(s),e&&console.log.apply(console,qHe.__spreadArray([new Date().toISOString()],s,!1)),a.forEach(function(f){f(s)&&a.delete(f)}),d()})}).then(function(){o.delete(c)});o.add(c)}},shipAssertTag:function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];this.addLogMessage(["shipAssertTag",s]);var c=s[2],d=s[3];if(!c)throw new TypeError("shipAssertTag: ".concat(d))},assertTag:function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];this.addLogMessage(["assertTag",s]);var c=s[2],d=s[3];if(!c)throw new TypeError("assertTag: ".concat(d))},traceTag:function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];this.addLogMessage(["traceTag",s])},dnmTraceTag:function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];this.addLogMessage(["dnmTraceTag",s])},debugTraceTag:function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];this.addLogMessage(["debugTraceTag",s])}}}hq.createArrayLogger=GHe});var lge=T(sb=>{"use strict";p();Object.defineProperty(sb,"__esModule",{value:!0});sb.featureEnabledDummyCallback=sb.AssertLogger=sb.ConsoleLogger=void 0;var ub=yL(),BHe=function(){function e(){}return e.prototype.shipAssertTag=function(r,t,n,a){if(console.assert(n,"shipAssertTag2 ".concat(r," ").concat(t," ").concat(a)),!n)throw new Error("shipAssertTag2 ".concat(r," ").concat(t," ").concat(a))},e.prototype.assertTag=function(r,t,n,a){if(console.assert(n,"assertTag2 ".concat(r," ").concat(t," ").concat(a)),!n)throw new Error("assertTag2 ".concat(r," ").concat(t," ").concat(a))},e.prototype.traceTag=function(r,t,n,a){console.log("traceTag2",r,a,t,n)},e.prototype.dnmTraceTag=function(r,t,n,a){console.log("dnmTraceTag2",r,a,t,n)},e.prototype.debugTraceTag=function(r,t,n,a){console.log("debugTraceTag2",r,a,t,n)},e}();sb.ConsoleLogger=BHe;var UHe=function(){function e(){this.traceTag=function(){},this.debugTraceTag=function(){},this.dnmTraceTag=function(){}}return e.prototype.shipAssertTag=function(r,t,n,a){if(!n)throw new Error("shipAssertTag2 ".concat(r," ").concat(t," ").concat(a))},e.prototype.assertTag=function(r,t,n,a){if(!n)throw new Error("assertTag2 ".concat(r," ").concat(t," ").concat(a))},e}();sb.AssertLogger=UHe;function KHe(e){switch(e){case ub.FeatureName.FeatureCheckingEnabled:return!0;case ub.FeatureName.CalcRecordFunctions:case ub.FeatureName.CalcNestedRecordFunction:case ub.FeatureName.CalcLetRecFunction:case ub.FeatureName.CalcLambdaBasicFunctions:case ub.FeatureName.CalcLambdaDefaultParameters:case ub.FeatureName.CalcLambdaCellValues:case ub.FeatureName.CalcLambdaArrayLifting:return!0;default:return e.startsWith("OfficeVSO:")}}sb.featureEnabledDummyCallback=KHe});var vz=T(Vo=>{"use strict";p();Object.defineProperty(Vo,"__esModule",{value:!0});Vo.VoidMachine=Vo.AllMachine=Vo.MachineRuntime=Vo.MachineCycle=Vo.nextOnSuccessReceiver=Vo.callMachineTransition=Vo.breakTransition=Vo.nextTransition=Vo.TransitionKind=void 0;var VHe=fe(),th=vq(),nh;(function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine",e[e.Break=3]="Break"})(nh||(Vo.TransitionKind=nh={}));function gz(e,r,t){return{kind:e,machine:r,receiver:t}}Vo.nextTransition=gz(nh.Next,void 0,void 0);Vo.breakTransition=gz(nh.Break,void 0,void 0);function Sq(e,r){return gz(nh.CallMachine,e,r)}Vo.callMachineTransition=Sq;var jHe={receiveResult:function(r){return(0,th.isSuccess)(r)?Vo.nextTransition:r}};function WHe(){return jHe}Vo.nextOnSuccessReceiver=WHe;var cge=function(e){VHe.__extends(r,e);function r(t,n){var a=this.constructor,o=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;o.machine=t,o.stackDepth=n;var u=a.prototype;return Object.getPrototypeOf(o)!==u&&(Object.setPrototypeOf!=null?Object.setPrototypeOf(o,u):o.__proto__=u),o}return r}(Error);Vo.MachineCycle=cge;var HHe=function(){function e(r){this.numSteps=0,this.stack=[];try{this.pushFrame(Sq(r,{receiveResult:function(n){return n}})),this.transition=Vo.nextTransition}catch(t){this.transition=(0,th.failure)((0,th.javaScriptError)(t))}}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(r){var t=this.stack.length,n=r.machine;if(n.runStatus===!0)throw e.numCycles+=1,new cge(n,t);n.runStatus===!1&&(n.runStatus=!0),this.stack.push(r),e.maxStackDepth<t+1&&(e.maxStackDepth=t+1)},e.prototype.advanceTopFrame=function(){var r=this.stack[this.stack.length-1].machine;return typeof r.runStatus!="boolean"?r.runStatus:r.next()},e.prototype.step=function(){this.numSteps+=1;var r=this.transition;try{switch(r.kind){case nh.Next:return this.transition=this.advanceTopFrame(),Vo.nextTransition;case nh.CallMachine:return this.pushFrame(r),this.transition=this.advanceTopFrame(),Vo.nextTransition;case nh.Break:return this.transition=Vo.nextTransition,r;default:var t=this.stack.pop();return t?(t.machine.runStatus=r,this.transition=t.receiver.receiveResult(r),Vo.nextTransition):r}}catch(n){return this.transition=(0,th.failure)((0,th.javaScriptError)(n)),Vo.nextTransition}},e.prototype.run=function(r){if(r===void 0&&(r=function(){return!1}),this.result)return this.result;try{for(;;){var t=this.step();if(t.kind===nh.Break)return t;if(t.kind!==nh.Next)return this.result=t;if(r())return e.numPauses+=1,t}}catch(n){return this.result=(0,th.failure)((0,th.javaScriptError)(n))}},e.prototype.runToResult=function(){for(;;){var r=this.run();if(r.kind!==nh.Break)return r}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}();Vo.MachineRuntime=HHe;var zHe=function(){function e(r){this.machines=r,this.runStatus=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?Sq(this.machines[this.values.length],this):(0,th.success)(this.values)},e.prototype.receiveResult=function(r){return(0,th.isSuccess)(r)?(this.values.push(r.value),this.next()):r},e}();Vo.AllMachine=zHe;var QHe=function(){function e(r){this.machine=r,this.runStatus=!1}return e.prototype.next=function(){return Sq(this.machine,this)},e.prototype.receiveResult=function(r){return(0,th.isSuccess)(r)?th.successUndefined:r},e}();Vo.VoidMachine=QHe});var dge=T(yq=>{"use strict";p();Object.defineProperty(yq,"__esModule",{value:!0});yq.Pledge=void 0;var eT=vz(),ly=vq(),XHe=function(){function e(r,t,n){this.transition=r,this.onFulfilled=t,this.onRejected=n,this.runStatus=r instanceof e||r.kind===eT.TransitionKind.CallMachine?!1:r}return e.prototype.setState=function(r,t,n){return this.onFulfilled=t,this.onRejected=n,this.transition=r,r},e.prototype.next=function(){return this.transition instanceof e?this.transition=(0,eT.callMachineTransition)(this.transition,this):this.transition},e.prototype.receiveResult=function(r){var t;try{if((0,ly.isSuccess)(r)){if(!this.onFulfilled)return this.setState(r,void 0,void 0);t=this.onFulfilled(r.value)}else{if(!this.onRejected)return this.setState(r,void 0,void 0);t=this.onRejected(r.reason)}}catch(n){return this.setState((0,ly.failure)((0,ly.javaScriptError)(n)),void 0,void 0)}return t instanceof e?(this.setState(t.transition,t.onFulfilled,t.onRejected),t.setState(this,void 0,void 0),this.next()):this.setState((0,ly.success)(t),void 0,void 0)},e.prototype.bind=function(r){return new e(this,r,void 0)},e.prototype.catch=function(r){return new e(this,void 0,r)},e.prototype.finally=function(r){return new e(this,function(t){return r(),t},function(t){return r(),e.reject(t)})},e.all=function(r){return e.fromMachine(new eT.AllMachine(r.map(e.resolve)))},e.prototype.settle=function(){return new eT.MachineRuntime(this).runToResult()},e.settleOrThrow=function(r){var t=r.settle();if((0,ly.isSuccess)(t))return t.value;throw t.reason.error},e.resolve=function(r){return r instanceof e?r:new e((0,ly.success)(r),void 0,void 0)},e.reject=function(r){return new e((0,ly.failure)(r),void 0,void 0)},e.undefinedPledge=e.resolve(void 0),e.fromMachine=function(r){if(r instanceof e)return r;var t=new e(e.undefinedPledge,void 0,void 0);return t.transition=(0,eT.callMachineTransition)(r,t),t},e.try=function(r){return e.undefinedPledge.bind(r)},e.RepeatMachine=function(){function r(t,n){this.onLoop=t,this.accum=n,this.runStatus=!1}return r.prototype.next=function(){var t=this.onLoop(this.accum);return t instanceof e?(0,eT.callMachineTransition)(t,this):this.receiveSuccess(t)},r.prototype.receiveResult=function(t){return(0,ly.isSuccess)(t)?this.receiveSuccess(t.value):t},r.prototype.receiveSuccess=function(t){return t===void 0?(0,ly.success)(this.accum):(this.accum=t,eT.nextTransition)},r}(),e.repeat=function(r,t){return e.resolve(t).bind(function(n){return e.fromMachine(new e.RepeatMachine(r,n))})},e}();yq.Pledge=XHe});var fge=T(ZP=>{"use strict";p();Object.defineProperty(ZP,"__esModule",{value:!0});ZP.throwAfterSteps=ZP.pauseAfterSteps=void 0;function YHe(e){var r=Math.max(1,Math.floor(e)),t=0;return function(){return t+=1,t>=r}}ZP.pauseAfterSteps=YHe;function JHe(e){var r=Math.max(1,Math.floor(e)),t=0;return function(){if(t+=1,t<r)return!1;throw r}}ZP.throwAfterSteps=JHe});var mge=T(_q=>{"use strict";p();Object.defineProperty(_q,"__esModule",{value:!0});_q.RevocableSingleton=void 0;var pge=function(){function e(r,t){var n=this;this.target=r,this.isRevoked=!1;var a=function(u){if(n.isRevoked)throw new TypeError("".concat(String(u),": ").concat(t))};this.proxy=typeof Proxy>"u"?r:new Proxy(r,{get:function(u,s,l){return a(s),Reflect.get(u,s,l)},set:function(u,s,l,c){return a(s),Reflect.set(u,s,l,c)}})}return e.prototype.revoke=function(){this.isRevoked=!0},e}(),ZHe=function(){function e(r){this.message=r}return e.prototype.getInstance=function(){var r;return(r=this.instance)===null||r===void 0?void 0:r.proxy},e.prototype.setInstance=function(r){var t;return(t=this.instance)===null||t===void 0||t.revoke(),r===void 0?this.instance=void 0:(this.instance=new pge(r,this.message),this.instance.proxy)},e.prototype.revokeInstance=function(){if(this.instance)return this.instance.revoke(),this.instance=new pge(this.instance.target,this.message),this.instance.proxy},e}();_q.RevocableSingleton=ZHe});var pr=T(lr=>{"use strict";p();Object.defineProperty(lr,"__esModule",{value:!0});lr.revocableSingleton=lr.testUtils=lr.pledge=lr.machine=lr.testConfig=lr.arrayLogger=lr.wrapIntoAsyncModule=lr.unicode=lr.result=lr.mixin=lr.promise=lr.stopwatch=lr.resolvablePromise=lr.config=lr.codePoint=lr.setTimeoutInterfaceModule=lr.asyncLoopModule=lr.async=lr.arrayUtils=lr.table=lr.split=lr.rTree=lr.ringBuffer=lr.rbTree=lr.rbMapTree=lr.productSet=lr.priorityQueue=lr.interval=lr.histogram=lr.hashTable=lr.hashSet=lr.dictionary=lr.deque=lr.bspSet=lr.binaryHeap=lr.arrayMapTree=lr.testUtil=lr.core=lr.featureConfiguration=lr.assertions=lr.util=lr.anonymizer=lr.combinations=lr.findIsomorphicSubtrees=lr.JSF32=lr.fnv1a=lr.PackageName=void 0;var ea=fe();lr.PackageName="excel-online-calc-common";var $He=kfe();Object.defineProperty(lr,"fnv1a",{enumerable:!0,get:function(){return $He.fnv1a}});var e7e=u7();Object.defineProperty(lr,"JSF32",{enumerable:!0,get:function(){return e7e.JSF32}});var r7e=xfe();Object.defineProperty(lr,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return r7e.findIsomorphicSubtrees}});var t7e=wfe();Object.defineProperty(lr,"combinations",{enumerable:!0,get:function(){return t7e.combinations}});ea.__exportStar(Dfe(),lr);var n7e=ea.__importStar(sL());lr.anonymizer=n7e;var a7e=ea.__importStar(cL());lr.util=a7e;var i7e=ea.__importStar(ty());lr.assertions=i7e;var o7e=ea.__importStar(yL());lr.featureConfiguration=o7e;var u7e=ea.__importStar(sg());lr.core=u7e;var s7e=ea.__importStar(dpe());lr.testUtil=s7e;var l7e=ea.__importStar(mpe());lr.arrayMapTree=l7e;var c7e=ea.__importStar(T7());lr.binaryHeap=c7e;var d7e=ea.__importStar(E7());lr.bspSet=d7e;var f7e=ea.__importStar(_pe());lr.deque=f7e;var p7e=ea.__importStar(bpe());lr.dictionary=p7e;var m7e=ea.__importStar(Rpe());lr.hashSet=m7e;var g7e=ea.__importStar(Epe());lr.hashTable=g7e;var v7e=ea.__importStar(Ape());lr.histogram=v7e;var h7e=ea.__importStar(M7());lr.interval=h7e;var S7e=ea.__importStar(Fpe());lr.priorityQueue=S7e;var y7e=ea.__importStar(Gpe());lr.productSet=y7e;var _7e=ea.__importStar(jpe());lr.rbMapTree=_7e;var b7e=ea.__importStar(K7());lr.rbTree=b7e;var C7e=ea.__importStar(Wpe());lr.ringBuffer=C7e;var T7e=ea.__importStar(Ype());lr.rTree=T7e;var R7e=ea.__importStar($pe());lr.split=R7e;var E7e=ea.__importStar(wP());lr.table=E7e;lr.arrayUtils=ea.__importStar(ame());lr.async=ea.__importStar(ome());lr.asyncLoopModule=ea.__importStar(fme());lr.setTimeoutInterfaceModule=ea.__importStar(z7());lr.codePoint=ea.__importStar(pme());lr.config=ea.__importStar(zme());lr.resolvablePromise=ea.__importStar(eM());lr.stopwatch=ea.__importStar(dz());lr.promise=ea.__importStar(eM());var P7e=Qme();Object.defineProperty(lr,"mixin",{enumerable:!0,get:function(){return P7e.mixin}});lr.result=ea.__importStar(vq());lr.unicode=ea.__importStar(ige());lr.wrapIntoAsyncModule=ea.__importStar(uge());lr.arrayLogger=ea.__importStar(sge());lr.testConfig=ea.__importStar(lge());lr.machine=ea.__importStar(vz());lr.pledge=ea.__importStar(dge());lr.testUtils=ea.__importStar(fge());lr.revocableSingleton=ea.__importStar(mge())});var Ar=T(en=>{"use strict";p();Object.defineProperty(en,"__esModule",{value:!0});en.now=en.mapFromArrayOfPairs=en.singleton=en.typedInstanceCreator=en.makeStringCompareCI=en.fastAbs=en.fastMax=en.fastMin=en.pair=en.filterOutNones=en.isNone=en.isDefined=en.safeConcat=en.safePush=en.strEnumArray=en.numEnumMap=en.numEnumArray=en.cloneStringMap=en.makeStringMap=en.identity=en.staticAssertIsOptional=en.staticAssertIs=en.staticAssertSame=en.staticAssertExtends=en.makeNewtypeIso=void 0;var mu=pr();en.makeNewtypeIso=mu.core.makeNewtypeIso;en.staticAssertExtends=mu.core.staticAssertExtends;en.staticAssertSame=mu.core.staticAssertSame;en.staticAssertIs=mu.core.staticAssertIs;en.staticAssertIsOptional=mu.core.staticAssertIsOptional;en.identity=mu.core.identity;en.makeStringMap=mu.core.makeStringMap;en.cloneStringMap=mu.core.cloneStringMap;en.numEnumArray=mu.core.numEnumArray;en.numEnumMap=mu.core.numEnumMap;en.strEnumArray=mu.core.strEnumArray;en.safePush=mu.core.safePush;en.safeConcat=mu.core.safeConcat;en.isDefined=mu.core.isDefined;en.isNone=mu.core.isNone;en.filterOutNones=mu.core.filterOutNones;en.pair=mu.core.pair;en.fastMin=mu.core.fastMin;en.fastMax=mu.core.fastMax;en.fastAbs=mu.core.fastAbs;en.makeStringCompareCI=mu.core.makeStringCompareCI;en.typedInstanceCreator=mu.core.typedInstanceCreator;en.singleton=mu.core.singleton;en.mapFromArrayOfPairs=mu.core.mapFromArrayOfPairs;en.now=mu.core.now});var Ba=T(Cl=>{"use strict";p();Object.defineProperty(Cl,"__esModule",{value:!0});Cl.assertPositiveLength=Cl.assertPositiveInteger=Cl.assertInteger=Cl.assertIndex=Cl.assertNatural=Cl.assertNever=Cl.assertFalse=Cl.assertTrue=Cl.ulsLogger=void 0;var cy=pr();Cl.ulsLogger=cy.assertions.ulsLogger;Cl.assertTrue=cy.assertions.assertTrue;Cl.assertFalse=cy.assertions.assertFalse;Cl.assertNever=cy.assertions.assertNever;Cl.assertNatural=cy.assertions.assertNatural;Cl.assertIndex=cy.assertions.assertIndex;Cl.assertInteger=cy.assertions.assertInteger;Cl.assertPositiveInteger=cy.assertions.assertPositiveInteger;Cl.assertPositiveLength=cy.assertions.assertPositiveLength});var Hf=T(Es=>{"use strict";p();Object.defineProperty(Es,"__esModule",{value:!0});Es.values=Es.stringStartsWith=Es.stringEndsWith=Es.repeat=Es.prependErrorMessage=Es.partialArray=Es.messageFromError=Es.mathLog2=Es.isInteger=Es.arrayFill=void 0;var v0=pr();Es.arrayFill=v0.util.arrayFill;Es.isInteger=v0.util.isInteger;Es.mathLog2=v0.util.mathLog2;Es.messageFromError=v0.util.messageFromError;Es.partialArray=v0.util.partialArray;Es.prependErrorMessage=v0.util.prependErrorMessage;Es.repeat=v0.util.repeat;Es.stringEndsWith=v0.util.stringEndsWith;Es.stringStartsWith=v0.util.stringStartsWith;Es.values=v0.util.values});var hz=T(bq=>{"use strict";p();Object.defineProperty(bq,"__esModule",{value:!0});bq.Deque=void 0;var A7e=pr();bq.Deque=A7e.deque.Deque});var Tq=T(Cq=>{"use strict";p();Object.defineProperty(Cq,"__esModule",{value:!0});Cq.Pledge=void 0;var F7e=pr();Cq.Pledge=F7e.pledge.Pledge});var pM=T($r=>{"use strict";p();Object.defineProperty($r,"__esModule",{value:!0});$r.ds=$r.ResultKind=$r.arrayFill=$r.stringEndsWith=$r.stringStartsWith=$r.isInteger=$r.messageFromError=$r.assertIndex=$r.assertPositiveInteger=$r.assertPositiveLength=$r.assertFalse=$r.assertTrue=$r.assertNatural=$r.assertNever=$r.Pledge=$r.JSF32=$r.staticAssertIsOptional=$r.staticAssertIs=$r.staticAssertSame=$r.staticAssertExtends=$r.now=$r.makeStringMap=$r.isNone=$r.isDefined=$r.safeConcat=$r.safePush=$r.numEnumMap=$r.numEnumArray=$r.identity=$r.fastAbs=$r.fastMax=$r.fastMin=void 0;var $P=fe(),Vd=$P.__importStar(Ar()),rT=$P.__importStar(Ba()),fM=$P.__importStar(Hf()),N7e=$P.__importStar(hz()),gge=$P.__importStar(pr()),O7e=$P.__importStar(Tq());$r.fastMin=Vd.fastMin;$r.fastMax=Vd.fastMax;$r.fastAbs=Vd.fastAbs;$r.identity=Vd.identity;$r.numEnumArray=Vd.numEnumArray;$r.numEnumMap=Vd.numEnumMap;$r.safePush=Vd.safePush;$r.safeConcat=Vd.safeConcat;$r.isDefined=Vd.isDefined;$r.isNone=Vd.isNone;$r.makeStringMap=Vd.makeStringMap;$r.now=Vd.now;$r.staticAssertExtends=Vd.staticAssertExtends;$r.staticAssertSame=Vd.staticAssertSame;$r.staticAssertIs=Vd.staticAssertIs;$r.staticAssertIsOptional=Vd.staticAssertIsOptional;$r.JSF32=gge.JSF32;$r.Pledge=O7e.Pledge;$r.assertNever=rT.assertNever;$r.assertNatural=rT.assertNatural;$r.assertTrue=rT.assertTrue;$r.assertFalse=rT.assertFalse;$r.assertPositiveLength=rT.assertPositiveLength;$r.assertPositiveInteger=rT.assertPositiveInteger;$r.assertIndex=rT.assertIndex;$r.messageFromError=fM.messageFromError;$r.isInteger=fM.isInteger;$r.stringStartsWith=fM.stringStartsWith;$r.stringEndsWith=fM.stringEndsWith;$r.arrayFill=fM.arrayFill;$r.ResultKind=gge.result.ResultKind;$r.ds=N7e});var dy=T(mg=>{"use strict";p();Object.defineProperty(mg,"__esModule",{value:!0});mg.functionType=mg.FunctionFlags=mg.SpecialPrecs=mg.SignatureType=mg.OperKind=void 0;var Sz=pr(),k7e=Sz.assertions.assertNatural,vge=Sz.assertions.assertFalse,M7e=Sz.assertions.assertIndex,hge;(function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"})(hge||(mg.OperKind=hge={}));var Sge;(function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"})(Sge||(mg.SignatureType=Sge={}));var yge;(function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"})(yge||(mg.SpecialPrecs=yge={}));var _ge;(function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.Chart=4]="Chart",e[e.OnlyParsedDuringLoad=8]="OnlyParsedDuringLoad",e[e.Internal=16]="Internal",e[e.Allow3dRef=32]="Allow3dRef",e[e.AllowLStrs=64]="AllowLStrs",e[e.HiddenFromUI=128]="HiddenFromUI"})(_ge||(mg.FunctionFlags=_ge={}));function x7e(e,r,t,n,a,o,u,s){if(k7e("calc.lang.functionType",r),M7e("calc.lang.functionType",e,r+1),n.length===0?a.length!==0:a.length>=n.length){var l=JSON.stringify(a);vge("calc.lang.functionType: expected tailTypes.length < restTypes.length; given ".concat(l))}if(n.length===0&&t.length+a.length<r){var l=JSON.stringify(t);vge("calc.lang.functionType: expected headTypes.length + tailTypes.length >= ".concat(r,"; given ").concat(l))}return{minArgs:e,maxArgs:r,headTypes:t,restTypes:n,tailTypes:a,returnType:o,staticPrecs:u,flags:s}}mg.functionType=x7e});var tT=T(Er=>{"use strict";p();var Ec;Object.defineProperty(Er,"__esModule",{value:!0});Er.falseOper=Er.trueOper=Er.blankOper=Er.missingOper=Er.range3DOper=Er.rangeSeqOper=Er.arrayOper=Er.externalErrorOper=Er.busyErrorOper=Er.calcErrorOper=Er.fieldErrorOper=Er.unknownErrorOper=Er.blockedErrorOper=Er.connectErrorOper=Er.spillErrorOper=Er.gettingDataErrorOper=Er.naErrorOper=Er.numErrorOper=Er.nameErrorOper=Er.refErrorOper=Er.valueErrorOper=Er.div0ErrorOper=Er.nullErrorOper=Er.errorOper=Er.stringOper=Er.booleanOper=Er.precedents=Er.ErrorType=Er.cellStringLimit=Er.PrecsBound=void 0;var Rq=pr(),bge=Rq.assertions.assertNatural,I7e=Rq.assertions.assertPositiveInteger,w7e=Rq.assertions.assertFalse,D7e=Rq.util.partialArray,fy=dy(),Cge;(function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"})(Cge||(Er.PrecsBound=Cge={}));Er.cellStringLimit=32767;var oi;(function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.SPILL=9]="SPILL",e[e.CONNECT=10]="CONNECT",e[e.BLOCKED=11]="BLOCKED",e[e.UNKNOWN=12]="UNKNOWN",e[e.FIELD=13]="FIELD",e[e.CALC=14]="CALC",e[e.BUSY=16]="BUSY",e[e.EXTERNAL=19]="EXTERNAL",e[e.TIMEOUT=20]="TIMEOUT"})(oi||(Er.ErrorType=oi={}));function L7e(e,r,t,n,a){return{cells:e,names:r,udfs:t,special:n,bound:a}}Er.precedents=L7e;function q7e(e){return e?Er.trueOper:Er.falseOper}Er.booleanOper=q7e;function G7e(e){return{kind:fy.OperKind.String,value:e}}Er.stringOper=G7e;function B7e(e){var r=U7e[e];return r!==void 0?r:dd(e)}Er.errorOper=B7e;Er.nullErrorOper=dd(oi.NULL);Er.div0ErrorOper=dd(oi.DIV0);Er.valueErrorOper=dd(oi.VALUE);Er.refErrorOper=dd(oi.REF);Er.nameErrorOper=dd(oi.NAME);Er.numErrorOper=dd(oi.NUM);Er.naErrorOper=dd(oi.NA);Er.gettingDataErrorOper=dd(oi.GETTING_DATA);Er.spillErrorOper=dd(oi.SPILL);Er.connectErrorOper=dd(oi.CONNECT);Er.blockedErrorOper=dd(oi.BLOCKED);Er.unknownErrorOper=dd(oi.UNKNOWN);Er.fieldErrorOper=dd(oi.FIELD);Er.calcErrorOper=dd(oi.CALC);Er.busyErrorOper=dd(oi.BUSY);Er.externalErrorOper=dd(oi.EXTERNAL);function dd(e){return{kind:fy.OperKind.Error,type:e}}var U7e=D7e((Ec={},Ec[oi.NULL]=Er.nullErrorOper,Ec[oi.DIV0]=Er.div0ErrorOper,Ec[oi.VALUE]=Er.valueErrorOper,Ec[oi.REF]=Er.refErrorOper,Ec[oi.NAME]=Er.nameErrorOper,Ec[oi.NUM]=Er.numErrorOper,Ec[oi.NA]=Er.naErrorOper,Ec[oi.GETTING_DATA]=Er.gettingDataErrorOper,Ec[oi.SPILL]=Er.spillErrorOper,Ec[oi.CONNECT]=Er.connectErrorOper,Ec[oi.BLOCKED]=Er.blockedErrorOper,Ec[oi.UNKNOWN]=Er.unknownErrorOper,Ec[oi.FIELD]=Er.fieldErrorOper,Ec[oi.CALC]=Er.calcErrorOper,Ec[oi.BUSY]=Er.busyErrorOper,Ec[oi.EXTERNAL]=Er.externalErrorOper,Ec));function K7e(e,r,t){return bge("calc.lang.arrayOper",e),bge("calc.lang.arrayOper",r),t.length!==e?w7e("calc.lang.arrayOper: Inconsistent row number"):{kind:fy.OperKind.Array,rows:e,cols:r,opers:t}}Er.arrayOper=K7e;function V7e(e,r){return I7e("calc.lang.rangeSeqOper",r.length),{kind:fy.OperKind.Range,sheets:e,ranges:r}}Er.rangeSeqOper=V7e;function j7e(e,r){return{kind:fy.OperKind.Range,sheets:e,ranges:[r]}}Er.range3DOper=j7e;Er.missingOper={kind:fy.OperKind.Missing};Er.blankOper={kind:fy.OperKind.Blank};Er.trueOper={kind:fy.OperKind.Boolean,value:!0};Er.falseOper={kind:fy.OperKind.Boolean,value:!1}});var gg=T(jr=>{"use strict";p();Object.defineProperty(jr,"__esModule",{value:!0});jr.isSheetGridCell=jr.isSheetGridRange=jr.isGridCell=jr.isSheetIndex=jr.userDefinedFuncLoc=jr.nameLoc=jr.nameScope=jr.documentScope=jr.originCell=jr.sheetGridCell=jr.sheetGridRange=jr.sheetGridCube=jr.gridCell=jr.gridRange=jr.unsafeGridRange=jr.sheetRangeIndexes=jr.allSheetsRange=jr.sheetIndex=jr.sheetRange=jr.structRefColumnLoc=jr.documentLoc=jr.sheetCols=jr.sheetRows=jr.lexicalSourceUDF=jr.lexicalSourceWSF=jr.lexicalSourceName=jr.lexicalSourceGrid=jr.lexicalSourceRange=jr.lexicalSourceCell=jr.NameSource=jr.LexicalKind=void 0;var yz=pr(),Eq=yz.assertions.assertIndex,Tge=yz.assertions.assertPositiveLength,W7e=yz.assertions.assertFalse,py;(function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.WSF=7]="WSF",e[e.UDF=8]="UDF",e[e.Other=9]="Other"})(py||(jr.LexicalKind=py={}));var Rge;(function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"})(Rge||(jr.NameSource=Rge={}));function Ege(e){return{kind:py.Cell,range:e}}jr.lexicalSourceCell=Ege;function Pge(e){return{kind:py.Range,range:e}}jr.lexicalSourceRange=Pge;function H7e(e,r){switch(e){case py.Cell:return Mge(r)?Ege(r):W7e("calc.lang.lexicalSourceGrid: expected cell");case py.Range:return Pge(r)}}jr.lexicalSourceGrid=H7e;function z7e(e){return{kind:py.NameManager,name:e}}jr.lexicalSourceName=z7e;function Q7e(e){return{kind:py.WSF,id:e}}jr.lexicalSourceWSF=Q7e;function X7e(e){return{kind:py.UDF,udf:e}}jr.lexicalSourceUDF=X7e;jr.sheetRows=1048576;jr.sheetCols=16384;function Y7e(e,r){return{path:e,name:r}}jr.documentLoc=Y7e;function J7e(e,r,t,n){return{name:e,range:r,hasHeadersRow:t,hasTotalsRow:n}}jr.structRefColumnLoc=J7e;function Age(e,r,t){return{document:e,index:r,index2:t}}jr.sheetRange=Age;function Fge(e,r){return Age(e,r,r)}jr.sheetIndex=Fge;function Z7e(e){return{document:e,index:void 0,index2:void 0}}jr.allSheetsRange=Z7e;function $7e(e,r){return{sheets:e,position:r}}jr.sheetRangeIndexes=$7e;function _z(e,r,t,n){return{row:e,col:r,rows:t,cols:n}}jr.unsafeGridRange=_z;function eze(e,r,t,n){return Eq("calc.lang.gridRange",e,jr.sheetRows),Eq("calc.lang.gridRange",r,jr.sheetCols),Tge("calc.lang.gridRange",t,jr.sheetRows-e),Tge("calc.lang.gridRange",n,jr.sheetCols-r),_z(e,r,t,n)}jr.gridRange=eze;function rze(e,r){return Eq("calc.lang.gridCell",e,jr.sheetRows),Eq("calc.lang.gridCell",r,jr.sheetCols),_z(e,r,1,1)}jr.gridCell=rze;function Pq(e,r){return{sheet:e,range:r}}jr.sheetGridCube=Pq;jr.sheetGridRange=Pq;jr.sheetGridCell=Pq;jr.originCell=Pq;function Nge(e){return{document:e,index:void 0}}jr.documentScope=Nge;function tze(e,r){return r===void 0?Nge(e):Fge(e,r)}jr.nameScope=tze;function nze(e,r){return{scope:e,name:r}}jr.nameLoc=nze;function aze(e,r){return{document:e,id:r}}jr.userDefinedFuncLoc=aze;function Oge(e){return e.index===e.index2}jr.isSheetIndex=Oge;function kge(e){return e.rows===1&&e.cols===1}jr.isGridCell=kge;function ize(e){return Oge(e.sheet)}jr.isSheetGridRange=ize;function Mge(e){return kge(e.range)}jr.isSheetGridCell=Mge});var Aq=T(lb=>{"use strict";p();Object.defineProperty(lb,"__esModule",{value:!0});lb.worksheetFuncTypes=lb.worksheetFuncEnglishNames=lb.WorksheetFuncId=void 0;var oze=dy(),xge;(function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.WRAPROWS=634]="WRAPROWS",e[e.VSTACK=635]="VSTACK",e[e.HSTACK=636]="HSTACK",e[e.CHOOSEROWS=637]="CHOOSEROWS",e[e.CHOOSECOLS=638]="CHOOSECOLS",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.MAKEARRAY=641]="MAKEARRAY",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.PERCENTOF=646]="PERCENTOF",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TOCOL=650]="TOCOL",e[e.TOROW=651]="TOROW",e[e.WRAPCOLS=652]="WRAPCOLS",e[e.MAP=653]="MAP",e[e.REDUCE=654]="REDUCE",e[e.SCAN=655]="SCAN",e[e.BYROW=656]="BYROW",e[e.BYCOL=657]="BYCOL",e[e.ISOMITTED=658]="ISOMITTED",e[e.EXPAND=659]="EXPAND",e[e.TAKE=660]="TAKE",e[e.DROP=661]="DROP",e[e.PY=662]="PY",e[e.IMAGE=664]="IMAGE",e[e.UNIT=665]="UNIT",e[e.GROUPBY=666]="GROUPBY",e[e.PIVOTBY=667]="PIVOTBY",e[e.PQSOURCE=668]="PQSOURCE",e[e.PYTHON_STR=669]="PYTHON_STR",e[e.PYTHON_TYPE=670]="PYTHON_TYPE",e[e.PYTHON_TYPENAME=671]="PYTHON_TYPENAME",e[e._FF=672]="_FF",e[e.FIELDFUNCTION=673]="FIELDFUNCTION",e[e.TRANSLATE=674]="TRANSLATE",e[e.DETECTLANGUAGE=675]="DETECTLANGUAGE",e[e.SUPPORTEDLANGUAGES=676]="SUPPORTEDLANGUAGES",e[e.REGEXTEST=677]="REGEXTEST",e[e.REGEXREPLACE=678]="REGEXREPLACE",e[e.REGEXEXTRACT=679]="REGEXEXTRACT",e[e.TESTFUNCTIONBEGIN=680]="TESTFUNCTIONBEGIN",e[e.GRF=681]="GRF",e[e.RICHERROR=682]="RICHERROR",e[e.COUNTER=683]="COUNTER",e[e.BROKENRECORD=684]="BROKENRECORD",e[e.STREAM=685]="STREAM",e[e.GETRICHERRORS=686]="GETRICHERRORS",e[e.DBGSTAT=687]="DBGSTAT",e[e.RICHNUMBER=688]="RICHNUMBER",e[e.RICHERNUMBER=689]="RICHERNUMBER",e[e.DBGWRITE=690]="DBGWRITE",e[e.TEST=691]="TEST",e[e.AAC=692]="AAC",e[e.AWC=693]="AWC",e[e.PARSEDEXPRESSION=694]="PARSEDEXPRESSION",e[e.AGE_CONTACTTEST=695]="AGE_CONTACTTEST",e[e.FIRSTNAME_CONTACTTEST=696]="FIRSTNAME_CONTACTTEST",e[e.FULLNAME_CONTACTTEST=697]="FULLNAME_CONTACTTEST",e[e.LASTNAME_CONTACTTEST=698]="LASTNAME_CONTACTTEST",e[e.TRANSLATENAME_CONTACTTEST=699]="TRANSLATENAME_CONTACTTEST",e[e.ARRAYVALUE=700]="ARRAYVALUE",e[e.RECORD=701]="RECORD",e[e.DISPLAYSTRING_GENERALTEST=702]="DISPLAYSTRING_GENERALTEST",e[e.LAMBDADOC=703]="LAMBDADOC",e[e.REFIDENTITY=704]="REFIDENTITY",e[e.GROUPBY2=705]="GROUPBY2",e[e.PIVOTBY2=706]="PIVOTBY2",e[e.PQEVALUATE=707]="PQEVALUATE",e[e.LETREC=750]="LETREC",e[e.NESTEDRECORD=751]="NESTEDRECORD"})(xge||(lb.WorksheetFuncId=xge={}));lb.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[669,"PYTHON_STR"],[670,"PYTHON_TYPE"],[671,"PYTHON_TYPENAME"],[672,"_FF"],[695,"AGE_CONTACTTEST"],[696,"FIRSTNAME_CONTACTTEST"],[697,"FULLNAME_CONTACTTEST"],[698,"LASTNAME_CONTACTTEST"],[699,"TRANSLATENAME_CONTACTTEST"],[702,"DISPLAYSTRING_GENERALTEST"]].reduce(function(e,r){return e[r[0]]=r[1],e},[]);var g=[];lb.worksheetFuncTypes=[[1,255,g,[57],g,1,0,32],[1,3,[36,831,831],g,g,823,0,64],[1,1,[271],g,g,4,0,64],[1,1,[271],g,g,4,0,64],[1,255,g,[305],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[0,1,[16],g,g,33,0,0],[0,1,[16],g,g,33,0,0],[0,0,g,g,g,3,0,32],[2,255,[1],[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,2,[1,1],g,g,2,0,64],[1,3,[1,65,4],g,g,2,0,64],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[0,0,g,g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,3,[263,48,48],g,g,263,0,0],[2,4,[48,1,1,1],g,g,311,0,0],[2,2,[2,1],g,g,2,0,64],[3,3,[2,1,1],g,g,2,0,64],[1,1,[2],g,g,1,0,64],[1,1,[7],g,g,1,0,64],[0,0,g,g,g,4,0,32],[0,0,g,g,g,4,0,32],[1,255,g,[52],g,4,0,32],[1,255,g,[52],g,4,0,32],[1,1,[4],g,g,4,0,32],[2,2,[1,1],g,g,1,0,0],[3,3,[16,83,18],g,g,1,0,0],[3,3,[16,19,18],g,g,1,0,0],[3,3,[16,19,18],g,g,1,0,0],[3,3,[16,19,18],g,g,1,0,0],[3,3,[16,19,18],g,g,1,0,0],[3,3,[16,19,18],g,g,1,0,0],[1,255,g,[49],g,1,0,32],[3,3,[16,19,18],g,g,1,0,0],[2,2,[263,2],g,g,2,0,64],[1,4,[48,112,84,84],g,g,32,0,0],[1,4,[48,112,112,84],g,g,32,0,0],[1,4,[48,112,84,84],g,g,32,0,0],[1,4,[48,112,112,84],g,g,32,0,0],[1,1,[16],g,g,512,0,2],[0,1,[4],g,g,512,0,2],[0,1,[575],g,g,512,0,2],[3,5,[1,1,1,1,1],g,g,1,0,0],[3,5,[1,1,1,1,1],g,g,1,0,0],[3,5,[1,1,1,1,1],g,g,1,0,0],[3,5,[1,1,1,1,1],g,g,1,0,0],[3,6,[1,1,1,1,1,1],g,g,1,0,0],[3,3,[48,1,1],g,g,1,0,32],[1,2,[48,1],g,g,1,0,0],[0,0,g,g,g,1,16383,0],[2,3,[263,305,17],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,2,[1,1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[0,0,g,g,g,1,16383,0],[1,1,[16],g,g,1,0,0],[1,1,[48],g,g,1,0,0],[1,1,[48],g,g,1,0,0],[3,5,[16,65,65,65,65],g,g,16,16383,0],[2,2,[2,16],g,g,16,0,2],[2,2,[16,16],g,g,2,0,2],[0,3,[66,81,16],g,g,4,0,2],[2,3,[2,2,1],g,g,1,0,64],[1,1,[39],g,g,32,0,0],[0,2,[1,24],g,g,4,0,2],[0,0,g,g,g,4,0,2],[1,1,[303],g,g,1,0,0],[0,1,[4],g,g,4,0,2],[1,2,[2,63],g,g,4,0,2],[0,0,g,g,g,50,0,2],[1,1,[16],g,g,47,0,2],[0,2,[65,66],g,g,32,0,2],[4,5,[87,117,117,1,117],g,g,4,0,4],[0,2,[1,66],g,g,32,0,2],[0,0,g,g,g,16,0,2],[0,0,g,g,g,16,0,2],[0,1,[1],g,g,4,0,2],[2,2,[1,1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[2,255,[33],[831],g,823,0,0],[3,4,[263,49,49,4],g,g,295,0,0],[3,4,[263,49,49,4],g,g,295,0,0],[0,2,[66,65],g,g,32,0,2],[1,7,[2,65,66,67,65,65,2],g,g,575,0,2],[1,1,[63],g,g,4,0,64],[1,1,[18],g,g,2,0,2],[1,2,[2,4],g,g,6,0,2],[2,2,[16,47],g,g,4,0,2],[1,2,[1,1],g,g,1,0,0],[1,4,[2,1,4,4],g,g,7,0,2],[1,1,[1],g,g,2,0,64],[1,1,[2],g,g,2,0,64],[1,1,[2],g,g,2,0,64],[1,1,[2],g,g,2,0,64],[1,2,[2,9],g,g,2,0,64],[1,2,[2,9],g,g,2,0,64],[2,2,[258,258],g,g,4,0,64],[1,1,[2],g,g,2,0,64],[4,4,[2,1,1,2],g,g,2,0,64],[3,4,[2,2,2,2],g,g,2,0,64],[1,1,[2],g,g,1,0,0],[0,3,[66,65,66],g,g,32,0,2],[0,1,[2],g,g,2,0,2],[2,3,[2,2,1],g,g,1,0,64],[1,2,[2,16],g,g,303,16383,0],[1,1,[271],g,g,4,0,64],[1,1,[399],g,g,4,0,64],[1,1,[399],g,g,4,0,64],[1,1,[399],g,g,4,0,64],[1,1,[23],g,g,2,0,0],[1,1,[23],g,g,1,0,0],[1,2,[2,1],g,g,1,0,2],[1,1,[1],g,g,1,0,2],[1,1,[1],g,g,1,0,2],[1,1,[1],g,g,2,0,2],[2,2,[1,1],g,g,2,0,2],[2,2,[1,2],g,g,1,0,2],[2,2,[1,2],g,g,1,0,2],[1,2,[1,1],g,g,1,0,2],[1,1,[3],g,g,1,0,64],[1,1,[3],g,g,1,0,64],[3,3,[1,1,1],g,g,1,0,0],[4,4,[1,1,1,1],g,g,1,0,0],[4,5,[1,1,1,1,1],g,g,1,0,0],[1,3,[2,66,65],g,g,2,0,2],[1,2,[16,4],g,g,2,0,2],[1,2,[2,4],g,g,16,0,2],[1,2,[2,4],g,g,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],g,3,0,2],[1,255,[3],[127],g,575,0,2],[0,1,[3],g,g,1,0,2],[2,4,[3,115,83,3],g,g,1,0,2],[3,5,[3,83,115,83,3],g,g,1,0,2],[4,5,[3,3,3,4,3],g,g,4,0,2],[4,5,[3,3,3,4,3],g,g,4,0,2],[4,5,[3,3,3,3,3],g,g,4,0,2],[0,1,[3],g,g,4,0,2],[2,3,[3,3,3],g,g,4,0,2],[3,4,[3,3,3,3],g,g,4,0,2],[1,3,[1,67,66],g,g,1,0,2],[1,1,[52],g,g,36,0,2],[1,1,[2],g,g,2,0,64],[1,1,[32],g,g,1,0,0],[1,1,[32],g,g,32,0,0],[2,2,[32,32],g,g,32,0,0],[0,2,[2,2],g,g,32,0,2],[4,6,[1,1,1,1,1,1],g,g,1,0,0],[4,6,[1,1,1,1,1,1],g,g,1,0,0],[1,255,g,[121],g,1,0,32],[0,2,[1,16],g,g,4,0,2],[3,4,[2,1,1,1],g,g,512,0,2],[1,1,[4],g,g,512,0,2],[0,0,g,g,g,512,0,2],[0,0,g,g,g,512,0,2],[2,2,[2,2],g,g,1,0,2],[2,2,[1,2],g,g,32,0,2],[3,3,[1,18,18],g,g,4,0,2],[2,2,[1,2],g,g,4,0,2],[1,1,[1],g,g,4,0,2],[0,1,[1],g,g,512,0,2],[0,1,[2],g,g,4,0,2],[0,4,[3,3,3,3],g,g,3,0,2],[1,255,g,[113],g,1,0,32],[1,1,[1],g,g,1,0,0],[1,2,[1,16],g,g,47,0,2],[1,1,[1],g,g,47,0,2],[1,2,[1,2],g,g,47,0,2],[1,2,[1,2],g,g,63,0,2],[3,3,[16,19,18],g,g,1,0,0],[1,1,[143],g,g,4,0,64],[0,3,[82,65,65],g,g,2,0,2],[0,4,[66,82,17,17],g,g,1,0,2],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[3,3,[16,19,18],g,g,1,0,0],[3,3,[16,19,18],g,g,1,0,0],[1,2,[1,1],g,g,1,0,0],[1,1,[143],g,g,4,0,64],[3,3,[16,83,18],g,g,1,0,0],[1,1,[3],g,g,4,0,2],[1,1,[3],g,g,4,0,2],void 0,void 0,[1,2,[1,1],g,g,2,0,192],[2,3,[2,2,1],g,g,1,0,192],[2,3,[2,2,1],g,g,1,0,192],[4,4,[2,1,1,2],g,g,2,0,192],[1,2,[2,9],g,g,2,0,192],[1,2,[2,9],g,g,2,0,192],[3,3,[2,1,1],g,g,2,0,192],[1,1,[2],g,g,1,0,192],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[1,1,[2],g,g,2,0,192],[1,1,[2],g,g,2,0,192],[2,3,[1,16,4],g,g,1,0,32],void 0,void 0,[2,5,[1,65,65,68,66],g,g,2,0,0],[2,3,[1,1,4],g,g,1,0,0],[0,0,g,g,g,1,16383,0],[5,7,[1,1,1,1,1,1,4],g,g,1,0,0],[0,0,g,g,g,512,0,2],[1,1,[12],g,g,512,0,2],[0,0,g,g,g,512,0,2],[1,3,[2,82,84],g,g,512,0,2],[1,255,g,[49],g,1,0,32],[1,255,g,[32],g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[3,3,[16,19,18],g,g,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],g,g,2,0,2],[0,1,[4],g,g,4,0,2],[0,0,g,g,g,16,0,2],[0,2,[2,2],g,g,4,0,2],[0,3,[2,2,2],g,g,4,0,2],[2,5,[2,23,23,23,23],g,g,2,0,66],[2,4,[2,1,1,2],g,g,1,0,2],[1,4,[2,66,65,65],g,g,1,0,2],[1,1,[2],g,g,3,16383,0],[0,0,g,g,g,2,0,2],[1,5,[1,2,1,1,1],g,g,47,0,2],[4,5,[1,1,1,1,1],g,g,1,0,0],[0,1,[4],g,g,512,0,2],void 0,void 0,[0,1,[1],g,g,512,0,2],[2,2,[48,48],g,g,32,0,32],[0,2,[66,96],g,g,2,0,2],[1,1,[2],g,g,4,0,2],[1,255,[17],[127],g,575,0,192],[1,1,[3],g,g,4,0,2],[1,1,[2],g,g,63,0,2],[1,2,[1,3],g,g,47,0,2],[1,3,[1,3,1],g,g,47,0,2],[1,3,[2,66,4],g,g,4,0,2],[1,1,[15],g,g,1,0,0],[0,1,[2],g,g,4,0,2],[0,1,[2],g,g,4,0,2],[0,2,[99,66],g,g,4,0,2],[3,3,[3,1,4],g,g,4,0,2],[3,3,[3,1,4],g,g,4,0,2],[2,3,[2,3,66],g,g,1,0,2],[1,2,[1,2],g,g,35,0,2],[1,255,g,[49],g,1,0,32],[3,5,[1,1,1,65,65],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[3,5,[1,1,1,65,65],g,g,1,0,0],[4,4,[1,1,1,4],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[3,3,[1,1,4],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[4,4,[1,1,1,4],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[4,4,[1,1,1,1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[4,4,[1,1,1,4],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[3,3,[1,1,4],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[4,4,[1,1,1,4],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[3,3,[1,32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[4,4,[32,32,1,1],g,g,1,0,0],[3,4,[32,32,1,65],g,g,1,0,0],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[2,3,[49,1,1],g,g,1,0,32],[2,2,[49,1],g,g,1,0,32],[2,2,[49,1],g,g,1,0,32],[2,2,[49,1],g,g,1,0,32],[2,2,[49,1],g,g,1,0,32],[2,3,[49,1,65],g,g,1,0,32],[1,255,g,[32],g,1,0,32],[2,2,[49,1],g,g,1,0,32],[2,2,[1,1],g,g,1,0,0],void 0,[3,4,[2,1,1,1],g,g,1,0,130],[2,3,[2,1,1],g,g,1,0,130],[1,255,g,[2],g,2,0,64],[2,2,[1,1],g,g,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],g,g,2,0,2],[1,2,[1,2],g,g,35,0,2],[1,3,[1,66,2],g,g,35,0,2],[1,4,[1,66,66,2],g,g,7,0,2],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[2,255,[1],[16],g,1,0,0],[2,3,[16,15,16],g,g,1,0,64],[2,2,[16,15],g,g,1,0,64],[1,1,[16],g,g,1,0,0],[1,2,[1,2],g,g,19,0,2],[1,1,[33],g,g,33,0,2],[4,4,[1,1,1,1],g,g,1,0,0],[3,3,[1,1,2],g,g,1,0,128],[1,1,[1],g,g,2,0,192],[2,2,[1,1],g,g,2,0,192],[1,2,[1,5],g,g,2,0,0],[0,4,[66,66,66,65],g,g,6,0,2],[0,5,[66,66,66,66,65],g,g,6,0,2],[1,2,[1,2],g,g,19,0,2],[2,255,[18,18],[2,79],g,15,0,0],[1,2,[2,39],g,g,39,0,0],[1,1,[16],g,g,2,0,128],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,255,g,[49],g,1,0,32],[1,1,[1],g,g,2,0,64],[1,1,[1],g,g,2,0,192],[1,1,[3],g,g,2,0,192],[1,1,[1],g,g,2,0,192],[1,1,[1],g,g,2,0,192],[1,1,[1],g,g,2,0,192],[1,1,[2],g,g,1,0,192],[1,1,[2],g,g,4,0,192],[1,1,[1],g,g,1,0,192],[1,1,[1],g,g,1,0,192],[1,1,[1],g,g,1,0,192],[3,255,g,[2],g,2,0,0],[1,255,[2],[50],g,15,0,0],[2,3,[2,50,2],g,g,10,0,0],[3,3,[2,2,2],g,g,15,0,0],[3,4,[2,2,1,2],g,g,10,0,0],[1,2,[95,95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,2,[95,95],g,g,9,0,0],[1,2,[95,95],g,g,9,0,0],[1,2,[95,95],g,g,9,0,0],[1,2,[95,95],g,g,9,0,0],[1,2,[95,95],g,g,9,0,0],[1,2,[95,95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,2,[95,95],g,g,9,0,0],[1,2,[95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[2,3,[95,95,95],g,g,9,0,0],[1,255,g,[127],g,9,0,0],[1,255,g,[127],g,9,0,0],[4,4,[95,95,95,127],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[1,2,[95,95],g,g,9,0,0],[1,2,[95,95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[1,2,[95,95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[2,3,[127,127,95],g,g,9,0,0],[3,3,[95,127,127],g,g,9,0,0],[5,6,[95,95,95,95,95,95],g,g,9,0,0],[5,6,[95,95,95,95,95,95],g,g,9,0,0],[4,5,[95,95,95,95,95],g,g,9,0,0],[4,5,[95,95,95,95,95],g,g,9,0,0],[4,5,[95,95,95,95,95],g,g,9,0,0],[4,5,[95,95,95,95,95],g,g,9,0,0],[4,5,[95,95,95,95,95],g,g,9,0,0],[3,3,[95,95,95],g,g,9,0,0],[3,3,[95,95,95],g,g,9,0,0],[3,3,[95,95,95],g,g,9,0,0],[6,7,[95,95,95,95,95,95,95],g,g,9,0,0],[6,7,[95,95,95,95,95,95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[6,6,[95,95,95,95,95,95],g,g,9,0,0],[6,6,[95,95,95,95,95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,0,0],[2,3,[95,95,95],g,g,9,0,0],[3,4,[95,95,95,95],g,g,9,0,0],[3,4,[95,95,95,95],g,g,9,0,0],[3,4,[95,95,95,95],g,g,9,0,0],[3,4,[95,95,95,95],g,g,9,0,0],[3,4,[95,95,95,95],g,g,9,0,0],[3,4,[95,95,95,95],g,g,9,0,0],[5,6,[95,95,95,95,95,95],g,g,9,0,0],[5,6,[95,95,95,95,95,95],g,g,9,0,0],[7,8,[95,95,95,95,95,95,95,95],g,g,9,0,0],[7,8,[95,95,95,95,95,95,95,95],g,g,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],g,g,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],g,g,9,0,0],[2,2,[95,95],g,g,9,16383,0],[1,2,[95,95],g,g,9,0,0],[6,7,[95,95,95,95,95,95,95],g,g,9,0,128],[6,7,[95,95,95,95,95,95,95],g,g,9,0,0],[3,3,[95,95,95],g,g,9,0,0],[6,8,[95,95,95,95,95,95,95,95],g,g,9,0,0],[4,5,[95,95,95,95,95],g,g,9,0,0],[2,3,[95,95,127],g,g,9,0,0],[2,3,[95,95,127],g,g,9,0,0],[1,255,g,[127],g,9,0,0],[1,255,g,[127],g,9,0,0],[1,255,g,[127],g,9,0,0],[2,2,[95,127],g,g,9,0,0],[3,4,[2,2,1,2],g,g,10,0,0],[2,5,[2,50,2,1,2],g,g,10,0,64],[1,1,[2],g,g,9,0,0],[2,2,[47,575],g,g,303,0,0],[2,255,g,[16,15],g,1,0,64],[3,255,[16],[16,15],g,1,0,64],[2,3,[16,15,16],g,g,1,0,64],[3,255,[16],[16,15],g,1,0,64],[3,254,[1,1,48,17],[16],g,1,0,0],[4,4,[1,1,1,4],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[2,2,[32,32],g,g,1,0,0],[3,3,[1,1,4],g,g,1,0,0],[4,4,[1,1,1,4],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[1,254,g,[32],g,32,0,32],[1,254,g,[32],g,1,0,32],[4,4,[1,1,1,4],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[2,2,[49,1],g,g,1,0,32],[2,2,[49,1],g,g,1,0,32],[2,3,[49,1,65],g,g,1,0,32],[2,3,[49,1,65],g,g,1,0,32],[3,3,[1,1,4],g,g,1,0,0],[2,2,[49,1],g,g,1,0,32],[2,2,[49,1],g,g,1,0,32],[2,3,[1,16,4],g,g,1,0,32],[2,3,[1,16,4],g,g,1,0,32],[1,254,g,[49],g,1,0,32],[1,254,g,[49],g,1,0,32],[3,3,[1,1,4],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[1,254,g,[49],g,1,0,32],[1,254,g,[49],g,1,0,32],[4,4,[1,1,1,4],g,g,1,0,0],[2,4,[95,95,75,127],g,g,9,0,0],[2,4,[95,95,75,127],g,g,9,0,0],[2,2,[1,1],g,g,1,0,128],[1,2,[1,65],g,g,1,0,128],void 0,[4,6,[1,1,1,4,65,65],g,g,1,0,0],[3,5,[1,1,1,65,65],g,g,1,0,0],[3,3,[1,1,4],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[4,4,[1,1,1,4],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[5,5,[1,1,1,1,4],g,g,1,0,0],[4,4,[1,1,1,4],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[4,4,[1,1,1,4],g,g,1,0,0],[2,2,[1,4],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[4,4,[32,32,1,1],g,g,1,0,0],[2,3,[49,1,1],g,g,1,0,32],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[1],g,g,1,0,0],[1,2,[1,65],g,g,1,0,128],[1,2,[1,65],g,g,1,0,128],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[2,2,[1,1],g,g,1,0,0],[1,254,g,[52],g,4,0,32],[3,3,[1,1,1],g,g,1,0,0],[2,3,[1,1,65],g,g,2,0,0],[2,2,[2,1],g,g,1,0,0],[2,2,[3,3],g,g,1,0,64],[3,4,[1,1,1,65],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,254,g,[49],g,1,0,32],[1,1,[1],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[3,3,[1,1,1],g,g,1,0,0],[1,1,[1],g,g,2,0,0],[1,1,[2],g,g,1,0,0],[1,1,[1],g,g,32,0,0],[1,1,[2],g,g,1,0,0],[1,1,[1],g,g,1,0,0],[1,3,[2,66,66],g,g,1,0,0],[0,1,[50],g,g,1,16383,32],[0,1,[48],g,g,1,16383,32],[1,1,[16],g,g,2,16383,0],[1,1,[16],g,g,4,0,0],[2,2,[47,575],g,g,303,0,0],[1,3,[1,65,65],g,g,1,0,0],[1,3,[1,65,65],g,g,1,0,0],[1,1,[95],g,g,9,0,0],[1,1,[95],g,g,9,0,0],[2,2,[2,2],g,g,47,0,64],[1,1,[2],g,g,10,0,64],[1,1,[2],g,g,10,0,64],[3,6,[1,48,48,65,65,65],g,g,1,0,0],[3,7,[1,48,48,65,65,65,65],g,g,1,0,0],[2,4,[48,48,65,65],g,g,1,0,0],[3,3,[1,32,32],g,g,1,0,0],[3,6,[48,48,1,65,65,65],g,g,1,0,0],[3,254,[16],[16,15],g,1,0,64],[3,254,[16],[16,15],g,1,0,64],[3,254,[114,68],[114],g,2,0,96],[1,254,g,[114],g,2,0,96],[2,254,g,[44,575],g,831,0,64],[3,254,[47],[575,575],[575],831,0,64],[1,1,[1527],g,g,1503,0,233],[2,254,g,[113,113],g,1,0,33],[1,1,[16],g,g,48,0,41],[2,3,[271,2,4],g,g,303,0,105],[2,2,[271,2],g,g,303,0,97],[2,3,[48,48,111],g,g,303,0,65],[1,4,[160,96,96,4],g,g,32,0,65],[1,3,[160,4,4],g,g,32,0,65],[2,2,[2,256],g,g,1,0,80],[3,3,[2,49,1],g,g,1,0,48],[3,3,[2,49,1],g,g,1,0,48],[2,254,[2],[49],g,1,0,48],[2,7,[34,2,65,65,65,74,68],g,g,1,0,65],[1,3,[2,65,65],g,g,2,0,65],[2,6,[2,34,65,65,65,74],g,g,2,0,65],[2,6,[2,34,65,65,65,74],g,g,2,0,65],[2,6,[2,98,98,68,65,495],g,g,32,0,65],[1,4,[32,96,96,4],g,g,32,0,81],[2,2,[4,16],g,g,32,0,49],[2,4,[391,48,65,65],g,g,1,0,65],[3,6,[391,48,48,511,65,65],g,g,319,0,65],[2,254,[160],[160,65],g,32,0,65],[0,5,[65,65,65,65,68],g,g,32,16383,1],[1,4,[65,65,65,65],g,g,32,0,1],[2,254,[258,1,65,65,65],[65],g,32,0,97],[2,3,[32,1,463],g,g,32,0,65],[1,254,g,[48],g,32,0,33],[1,254,g,[48],g,32,0,33],[2,254,[48],[33],g,32,0,1],[2,254,[48],[33],g,32,0,1],[3,254,g,[319,319],[319],319,0,1],[1,254,g,[319],g,319,0,1],[3,3,[65,65,319],g,g,32,0,1],[1,254,g,[319],g,319,0,1],[1,1,[271],g,g,4,0,1],[1,1,[271],g,g,9,0,1],[0,0,g,g,g,319,0,1],[2,2,[49,49],g,g,9,0,1],[1,2,[399,1],g,g,2,0,65],[1,2,[32,1],g,g,2,0,65],[2,2,[15,2],g,g,256,0,97],[1,3,[48,65,68],g,g,32,0,97],[1,3,[48,65,68],g,g,32,0,97],[2,3,[32,1,463],g,g,32,0,65],[2,254,[48],[319],g,32,0,65],[3,3,[511,48,271],g,g,319,0,65],[3,3,[511,48,271],g,g,32,0,65],[1,2,[48,271],g,g,32,0,65],[1,2,[48,271],g,g,32,0,65],[1,1,[1535],g,g,4,0,65],[2,4,[32,65,65,495],g,g,32,0,65],[2,3,[48,65,65],g,g,48,0,65],[2,3,[48,65,65],g,g,48,0,65],[2,254,[1,1],[447],g,303,0,97],void 0,[1,5,[2,66,65,65,65],g,g,264,0,65],[2,2,[15,2],g,g,271,0,97],[3,7,[112,96,96,65,65,96,96],g,g,32,0,65],[4,10,[112,112,96,96,65,65,96,65,96,96],g,g,32,0,65],[1,1,[2],g,g,264,0,9],[1,1,[256],g,g,2,0,97],[1,1,[256],g,g,2,0,97],[1,1,[256],g,g,2,0,97],[3,254,[256,2,4],[47],g,303,0,105],[2,254,[256,2],[47],g,303,0,97],[2,3,[2,2,2],g,g,2,0,65],[2,2,[2,1],g,g,2,0,65],[2,2,[2,1],g,g,32,0,65],[2,3,[2,2,4],g,g,4,0,65],[3,5,[2,2,2,1,4],g,g,2,0,65],[2,4,[2,2,1,4],g,g,32,0,65],[0,0,g,g,g,1,0,1],[1,2,[287,2],g,g,288,0,97],[1,2,[1,1],g,g,10,0,97],[0,0,g,g,g,1,0,1],[3,254,[47],[2,47],g,47,0,97],[0,1,[1],g,g,1,0,1],[0,1,[1],g,g,32,0,1],[1,2,[2,1],g,g,47,0,1],[1,1,[1],g,g,264,0,97],[1,1,[1],g,g,264,0,97],[2,2,[2,47],g,g,47,0,1],[1,254,[2],[1151],g,1087,0,96],[1,254,[1],[1151],g,1087,0,0],[1,254,[1],[1151],g,1087,0,0],[1,1,[16],g,g,32,0,1],[1,1,[256],g,g,2,0,97],[1,1,[256],g,g,2,0,97],[1,1,[256],g,g,2,0,97],[1,1,[256],g,g,2,0,97],[2,2,[256,2],g,g,2,0,97],[1,1,[32],g,g,256,0,97],[3,254,[15],[2,47],g,303,0,97],[1,1,[256],g,g,2,0,97],[4,254,[256,66,66,66],[66,96],g,319,0,1],[1,1,[48],g,g,16,0,97],[3,8,[112,96,96,65,65,96,96,68],g,g,32,0,65],[4,11,[112,112,96,96,65,65,96,65,96,96,65],g,g,32,0,65],[2,2,[2,2],g,g,2,0,65],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,g,[319,319],[319],319,0,1],[3,254,[15],[2,303],g,303,0,97]].map(function(e){return e===void 0?void 0:oze.functionType.apply(void 0,e)})});var pm=T(Tl=>{"use strict";p();Object.defineProperty(Tl,"__esModule",{value:!0});Tl.assertPositiveLength=Tl.assertPositiveInteger=Tl.assertInteger=Tl.assertIndex=Tl.assertNatural=Tl.assertNever=Tl.assertFalse=Tl.assertTrue=Tl.ulsLogger=void 0;var my=pr();Tl.ulsLogger=my.assertions.ulsLogger;Tl.assertTrue=my.assertions.assertTrue;Tl.assertFalse=my.assertions.assertFalse;Tl.assertNever=my.assertions.assertNever;Tl.assertNatural=my.assertions.assertNatural;Tl.assertIndex=my.assertions.assertIndex;Tl.assertInteger=my.assertions.assertInteger;Tl.assertPositiveInteger=my.assertions.assertPositiveInteger;Tl.assertPositiveLength=my.assertions.assertPositiveLength});var jd=T(rn=>{"use strict";p();Object.defineProperty(rn,"__esModule",{value:!0});rn.now=rn.mapFromArrayOfPairs=rn.singleton=rn.typedInstanceCreator=rn.makeStringCompareCI=rn.fastAbs=rn.fastMax=rn.fastMin=rn.pair=rn.filterOutNones=rn.isNone=rn.isDefined=rn.safeConcat=rn.safePush=rn.strEnumArray=rn.numEnumMap=rn.numEnumArray=rn.cloneStringMap=rn.makeStringMap=rn.identity=rn.staticAssertIsOptional=rn.staticAssertIs=rn.staticAssertSame=rn.staticAssertExtends=rn.makeNewtypeIso=void 0;var gu=pr();rn.makeNewtypeIso=gu.core.makeNewtypeIso;rn.staticAssertExtends=gu.core.staticAssertExtends;rn.staticAssertSame=gu.core.staticAssertSame;rn.staticAssertIs=gu.core.staticAssertIs;rn.staticAssertIsOptional=gu.core.staticAssertIsOptional;rn.identity=gu.core.identity;rn.makeStringMap=gu.core.makeStringMap;rn.cloneStringMap=gu.core.cloneStringMap;rn.numEnumArray=gu.core.numEnumArray;rn.numEnumMap=gu.core.numEnumMap;rn.strEnumArray=gu.core.strEnumArray;rn.safePush=gu.core.safePush;rn.safeConcat=gu.core.safeConcat;rn.isDefined=gu.core.isDefined;rn.isNone=gu.core.isNone;rn.filterOutNones=gu.core.filterOutNones;rn.pair=gu.core.pair;rn.fastMin=gu.core.fastMin;rn.fastMax=gu.core.fastMax;rn.fastAbs=gu.core.fastAbs;rn.makeStringCompareCI=gu.core.makeStringCompareCI;rn.typedInstanceCreator=gu.core.typedInstanceCreator;rn.singleton=gu.core.singleton;rn.mapFromArrayOfPairs=gu.core.mapFromArrayOfPairs;rn.now=gu.core.now});var Ep=T(ye=>{"use strict";p();Object.defineProperty(ye,"__esModule",{value:!0});ye.wsfNode=ye.operatorNode=ye.lambdaNode=ye.lambdaParam=ye.paramNode=ye.paramDefault=ye.paramName=ye.flattenLambdaArgs=ye.letNode=ye.letVar=ye.varNode=ye.indexedArg=ye.flattenLetArgs=ye.appNode=ye.arrayNode=ye.literalNode=ye.formulaRootAnnotation=ye.localNameDeclAnnotation=ye.localNameUseAnnotation=ye.formulaSpan=ye.multiLineComment=ye.singleLineComment=ye.formula=ye.cellRefBad=ye.cellRefCol=ye.cellRefRow=ye.cellRefRange=ye.cellRefSingle=ye.cellRefError=ye.pos=ye.badQualifier=ye.sheetRangeQualifier=ye.identQualifier=ye.sheetQualifier=ye.documentQualifier=ye.relativeQualifier=ye.errorQualifier=ye.BadType=ye.StructRefKind=ye.SpecialRefId=ye.NamePartKind=ye.NodeKind=ye.appHeadNameAnnotation=ye.AnnotationKind=ye.CommentKind=ye.PosKind=ye.CellRefKind=ye.QualifierKind=ye.SyntaxFeature=ye.RefStyle=void 0;ye.getDepthUpperBound=ye.badSequenceNode=ye.badCharsNode=ye.missingNode=ye.identNode=ye.structRef=ye.badRef=ye.missingRef=ye.thisRowOpRef=ye.commaOpRef=ye.rangeOpRef=ye.columnRef=ye.specialRef=ye.structRefNode=ye.fieldRef=ye.fieldRefNode=ye.cellRefNode=ye.contextNameNode=ye.headNamePart=ye.flattenNameParts=ye.fieldRefNamePart=ye.cellRefNamePart=ye.identNamePart=ye.nameNode=ye.parenNode=void 0;var mM=fe(),db=pm(),bz=jd(),uze=jd(),Ige;(function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"})(Ige||(ye.RefStyle=Ige={}));var wge;(function(e){e.Comments="Comments",e.Statements="Statements"})(wge||(ye.SyntaxFeature=wge={}));var gy;(function(e){e.Error="ErrorQualifier",e.Relative="RelativeQualifier",e.Document="DocumentQualifier",e.Sheet="SheetQualifier",e.Ident="IdentQualifier",e.SheetRange="SheetRangeQualifier",e.Bad="BadQualifier"})(gy||(ye.QualifierKind=gy={}));var fb;(function(e){e.Error="CellRefError",e.Single="CellRefSingle",e.Range="CellRefRange",e.Row="CellRefRow",e.Col="CellRefCol",e.Bad="CellRefBad"})(fb||(ye.CellRefKind=fb={}));var Dge;(function(e){e.Abs="Abs",e.Rel="Rel"})(Dge||(ye.PosKind=Dge={}));var Fq;(function(e){e.SingleLine="SingleLineComment",e.MultiLine="MultiLineComment"})(Fq||(ye.CommentKind=Fq={}));var rA;(function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"})(rA||(ye.AnnotationKind=rA={}));ye.appHeadNameAnnotation={kind:rA.AppHeadName};var Kn;(function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Missing="Missing",e.BadChars="BadChars",e.BadSequence="BadSequence",e.Operator="Operator",e.WSF="WSF",e.Var="Var",e.Param="Param",e.ContextName="ContextName",e.Ident="Ident",e.ParamName="ParamName",e.ParamDef="ParamDef",e.FieldRefRHS="FieldRefRHS",e.StructRefRHS="StructRefRHS"})(Kn||(ye.NodeKind=Kn={}));var aT;(function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"})(aT||(ye.NamePartKind=aT={}));var nT;(function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"})(nT||(ye.SpecialRefId=nT={}));var vg;(function(e){e.SpecialRef="SpecialStructRef",e.ColumnRef="ColumnStructRef",e.RangeOpRef="RangeOpStructRef",e.CommaOpRef="CommaOpStructRef",e.ThisRowOpRef="ThisRowOpStructRef",e.MissingRef="MissingStructRef",e.BadRef="BadStructRef"})(vg||(ye.StructRefKind=vg={}));var Lge;(function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.StructRef="StructRef",e.FieldRef="FieldRef"})(Lge||(ye.BadType=Lge={}));function sze(e){return e===void 0&&(e=0),{kind:gy.Error,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}}ye.errorQualifier=sze;function lze(e){return e===void 0&&(e=0),{kind:gy.Relative,isQuoted:!1,isClosed:!0,isTerminated:!0,label:e}}ye.relativeQualifier=lze;function cze(e,r,t,n){return t===void 0&&(t=!1),n===void 0&&(n=0),{kind:gy.Document,isQuoted:t,isClosed:!0,isTerminated:!0,label:n,document:e,path:r}}ye.documentQualifier=cze;function dze(e,r,t,n){return t===void 0&&(t=!1),n===void 0&&(n=0),{kind:gy.Sheet,isQuoted:t,isClosed:!0,isTerminated:!0,label:n,sheet:e,document:r}}ye.sheetQualifier=dze;function fze(e,r,t){return r===void 0&&(r=!1),t===void 0&&(t=0),{kind:gy.Ident,isQuoted:r,isClosed:!0,isTerminated:!0,label:t,name:e}}ye.identQualifier=fze;function pze(e,r,t,n,a){return n===void 0&&(n=!1),a===void 0&&(a=0),{kind:gy.SheetRange,isQuoted:n,isClosed:!0,isTerminated:!0,label:a,sheet1:e,sheet2:r,document:t}}ye.sheetRangeQualifier=pze;function mze(e,r,t,n,a){return r===void 0&&(r=!1),t===void 0&&(t=!0),n===void 0&&(n=!0),a===void 0&&(a=0),{kind:gy.Bad,isQuoted:r,isClosed:t,isTerminated:n,label:a,chars:e}}ye.badQualifier=mze;function gze(e,r){return{kind:e,index:r}}ye.pos=gze;function vze(e){e===void 0&&(e=0);var r=!1;return{kind:fb.Error,label:e,isBracketed:r}}ye.cellRefError=vze;function hze(e,r,t,n){return t===void 0&&(t=!1),n===void 0&&(n=0),{kind:fb.Single,label:n,row:e,col:r,isBracketed:t}}ye.cellRefSingle=hze;function Sze(e,r,t){t===void 0&&(t=0);var n=e.isBracketed||r.isBracketed;return{kind:fb.Range,label:t,ref1:e,ref2:r,isBracketed:n}}ye.cellRefRange=Sze;function yze(e,r,t,n){return t===void 0&&(t=!1),n===void 0&&(n=0),{kind:fb.Row,label:n,row1:e,row2:r,isBracketed:t}}ye.cellRefRow=yze;function _ze(e,r,t,n){return t===void 0&&(t=!1),n===void 0&&(n=0),{kind:fb.Col,label:n,col1:e,col2:r,isBracketed:t}}ye.cellRefCol=_ze;function bze(e,r,t){return r===void 0&&(r=!1),t===void 0&&(t=0),{kind:fb.Bad,label:t,chars:e,isBracketed:r}}ye.cellRefBad=bze;function Cze(e,r,t,n){return{node:e,spans:r,annotations:t,depthUpperBound:n??Vge(e)}}ye.formula=Cze;function Tze(e,r){return r===void 0&&(r=0),{kind:Fq.SingleLine,label:r,chars:e,isClosed:!0}}ye.singleLineComment=Tze;function Rze(e,r,t){return r===void 0&&(r=!0),t===void 0&&(t=0),{kind:Fq.MultiLine,label:t,chars:e,isClosed:r}}ye.multiLineComment=Rze;function Eze(e,r,t,n,a,o){return(0,db.assertNatural)("calc.lang.formulaSpan",e),(0,db.assertInteger)("calc.lang.formulaSpan",r),r<e&&(0,db.assertFalse)("calc.lang.formulaSpan: expected end >= ".concat(e,"; given ").concat(r)),{start:e,end:r,pre:t,post:n,preComments:a,postComments:o}}ye.formulaSpan=Eze;function Pze(e,r,t){return{kind:rA.LocalNameUse,name:e,whole:r,label:t}}ye.localNameUseAnnotation=Pze;function Aze(e,r,t){return t===void 0&&(t=[]),{kind:rA.LocalNameDecl,name:e,whole:r,uses:t}}ye.localNameDeclAnnotation=Aze;function Fze(e,r){return{kind:rA.FormulaRoot,contextNames:e,syntaxFeatures:r}}ye.formulaRootAnnotation=Fze;function Nze(e,r,t){return r===void 0&&(r=!0),t===void 0&&(t=0),{kind:Kn.Literal,label:t,oper:e,isClosed:r}}ye.literalNode=Nze;function Oze(e,r,t){return r===void 0&&(r=!0),t===void 0&&(t=0),{kind:Kn.Array,label:t,nodes:e,isClosed:r}}ye.arrayNode=Oze;function kze(e,r,t,n){return t===void 0&&(t=!0),n===void 0&&(n=0),{kind:Kn.App,label:n,head:e,args:r,isClosed:t}}ye.appNode=kze;function Mze(e){return Array.isArray(e)}function Cz(e){return e.kind!==void 0}function qge(e){for(var r=[],t=0,n=e;t<n.length;t++){var a=n[t],o=a.arg,u=a.index;(0,db.assertIndex)("calc.lang.flattenNumberedArgs: idx",u,e.length),(0,db.assertTrue)("calc.lang.flattenNumberedArgs: repetition",r[u]===void 0),r[u]=o}return r}function Gge(e,r,t){return qge((0,uze.safeConcat)(mM.__spreadArray(mM.__spreadArray([],r===void 0?[]:[r],!0),t,!0),e.map(function(n){var a=n.name,o=n.binder;return[a,o]})))}ye.flattenLetArgs=Gge;function eA(e,r){return(0,db.assertNatural)("calc.lang.indexedArg: index",r),{arg:e,index:r}}ye.indexedArg=eA;function xze(e,r){return r===void 0&&(r=0),{kind:Kn.Var,label:r,name:e,wholeName:e.whole}}ye.varNode=xze;function Bge(e,r){return{name:e,binder:r}}ye.letVar=Bge;function Ize(e,r,t,n,a,o){n===void 0&&(n=[]),a===void 0&&(a=!0),o===void 0&&(o=0);var u=r.map(function(c,d){return Mze(c)?Bge(eA(c[0],d*2),eA(c[1],d*2+1)):c}).sort(function(c,d){return c.name.index-d.name.index}),s=t===void 0||!Cz(t)?t:eA(t,u.length*2),l=Gge(u,s,n);return{kind:Kn.Let,label:o,head:e,args:l,isClosed:a,vars:u,body:s,badArgs:n}}ye.letNode=Ize;function Uge(e,r,t){return t===void 0&&(t=[]),qge(mM.__spreadArray(mM.__spreadArray(mM.__spreadArray([],e.map(function(n){return n.name}),!0),r===void 0?[]:[r],!0),t,!0))}ye.flattenLambdaArgs=Uge;function wze(e,r,t,n){return t===void 0&&(t=!0),n===void 0&&(n=0),{kind:Kn.ParamName,label:n,name:e,isBracketed:r,isClosed:t}}ye.paramName=wze;function Dze(e,r){return r===void 0&&(r=0),{kind:Kn.ParamDef,label:r,rhs:e}}ye.paramDefault=Dze;function Lze(e,r,t){return t===void 0&&(t=0),{kind:Kn.Param,label:t,name:e,wholeName:e.name.kind===Kn.Ident?e.name.whole:void 0,def:r,isOptional:e.isBracketed||r!==void 0}}ye.paramNode=Lze;function Kge(e){return{name:e}}ye.lambdaParam=Kge;function qze(e,r,t,n,a,o){n===void 0&&(n=[]),a===void 0&&(a=!0),o===void 0&&(o=0);var u=r.map(function(c,d){return Cz(c)?Kge(eA(c,d)):c}).sort(function(c,d){return c.name.index-d.name.index}),s=t===void 0||!Cz(t)?t:eA(t,u.length),l=Uge(u,s,n);return{kind:Kn.Lambda,label:o,head:e,args:l,isClosed:a,params:u,body:s,badArgs:n}}ye.lambdaNode=qze;function Gze(e,r){return r===void 0&&(r=0),{kind:Kn.Operator,label:r,id:e}}ye.operatorNode=Gze;function Bze(e,r,t){return t===void 0&&(t=0),{kind:Kn.WSF,label:t,id:e,whole:r}}ye.wsfNode=Bze;function Uze(e,r,t){return r===void 0&&(r=!0),t===void 0&&(t=0),{kind:Kn.Paren,label:t,node:e,isClosed:r}}ye.parenNode=Uze;function Kze(e,r,t){return t===void 0&&(t=0),{kind:Kn.Name,label:t,whole:e.asWhole,parts:e,qualifier:r}}ye.nameNode=Kze;function Vze(e,r,t,n){return r===void 0&&(r=!0),t===void 0&&(t=0),n===void 0&&(n=0),{kind:aT.IdentNamePart,label:t,qualifiedLabel:n,asWhole:e,canDenoteNamedObject:r}}ye.identNamePart=Vze;function jze(e,r,t,n){return t===void 0&&(t=0),n===void 0&&(n=0),{kind:aT.CellRefNamePart,label:t,qualifiedLabel:n,asWhole:r,canDenoteNamedObject:!1,ref:e}}ye.cellRefNamePart=jze;function Wze(e,r,t,n,a){return t===void 0&&(t=!0),n===void 0&&(n=0),a===void 0&&(a=0),(0,db.assertTrue)("calc.lang.fieldRefNamePart",r.isClosed&&!r.isBracketed),{kind:aT.FieldRefNamePart,label:n,qualifiedLabel:a,asWhole:e.asWhole+"."+(r.field.kind===Kn.Ident?r.field.whole:r.field.chars),canDenoteNamedObject:t,lhs:e,rhs:r}}ye.fieldRefNamePart=Wze;function Hze(e){for(var r=[e],t=r[0];t.kind===aT.FieldRefNamePart;)r.push(t.lhs),t=t.lhs;return r.reverse(),{kind:t.kind,parts:r}}ye.flattenNameParts=Hze;function zze(e){for(var r=e;r.kind===aT.FieldRefNamePart;)r=r.lhs;return r}ye.headNamePart=zze;function Qze(e,r){return r===void 0&&(r=0),{kind:Kn.ContextName,label:r,whole:e}}ye.contextNameNode=Qze;function Xze(e,r,t){return t===void 0&&(t=0),{kind:Kn.CellRef,label:t,ref:e,qualifier:r}}ye.cellRefNode=Xze;function Yze(e,r,t){return t===void 0&&(t=0),{kind:Kn.FieldRef,label:t,lhs:e,rhs:r}}ye.fieldRefNode=Yze;function Jze(e,r,t,n,a){return r===void 0&&(r=!1),t===void 0&&(t=!0),n===void 0&&(n=!1),a===void 0&&(a=0),{kind:Kn.FieldRefRHS,label:a,field:e,isBracketed:r,isClosed:t,shouldBeBracketed:n}}ye.fieldRef=Jze;function Zze(e,r,t){return t===void 0&&(t=0),{kind:Kn.StructRef,label:t,lhs:e,rhs:r}}ye.structRefNode=Zze;function $ze(e,r,t,n){return r===void 0&&(r=!1),t===void 0&&(t=!0),n===void 0&&(n=0),{kind:vg.SpecialRef,label:n,id:e,isBracketed:r,isClosed:t}}ye.specialRef=$ze;function eQe(e,r,t,n){return r===void 0&&(r=!1),t===void 0&&(t=!0),n===void 0&&(n=0),{kind:vg.ColumnRef,label:n,name:e,isBracketed:r,isClosed:t}}ye.columnRef=eQe;function rQe(e,r,t){return t===void 0&&(t=0),{kind:vg.RangeOpRef,label:t,lhs:e,rhs:r}}ye.rangeOpRef=rQe;function tQe(e,r){var t;r===void 0&&(r=0);for(var n=(t={},t[nT.All]=!1,t[nT.Data]=!1,t[nT.Headers]=!1,t[nT.Totals]=!1,t[nT.ThisRow]=!1,t),a=[],o=0,u=e;o<u.length;o++){var s=u[o];switch(s.kind){case vg.SpecialRef:n[s.id]=!0;break;case vg.ColumnRef:case vg.RangeOpRef:a.push(s);break}}return{kind:vg.CommaOpRef,label:r,refs:e,specialRefs:n,columnRefs:a}}ye.commaOpRef=tQe;function nQe(e,r){return r===void 0&&(r=0),{kind:vg.ThisRowOpRef,label:r,ref:e}}ye.thisRowOpRef=nQe;function aQe(e){return e===void 0&&(e=0),{kind:vg.MissingRef,label:e}}ye.missingRef=aQe;function iQe(e,r,t,n){return r===void 0&&(r=!1),t===void 0&&(t=!0),n===void 0&&(n=0),{kind:vg.BadRef,chars:e,isBracketed:r,isClosed:t,label:n}}ye.badRef=iQe;function oQe(e,r,t){return r===void 0&&(r=!0),t===void 0&&(t=0),{kind:Kn.StructRefRHS,label:t,isClosed:r,innerRef:e}}ye.structRef=oQe;function uQe(e,r){return r===void 0&&(r=0),{kind:Kn.Ident,label:r,whole:e}}ye.identNode=uQe;function sQe(e,r){return e===void 0&&(e=""),r===void 0&&(r=0),{kind:Kn.Missing,label:r,chars:e}}ye.missingNode=sQe;function lQe(e,r,t){return t===void 0&&(t=0),{kind:Kn.BadChars,label:t,type:e,chars:r}}ye.badCharsNode=lQe;function cQe(e,r,t){return t===void 0&&(t=0),{kind:Kn.BadSequence,label:t,type:e,contents:r}}ye.badSequenceNode=cQe;var dQe=50;function cb(e,r){if(r>dQe)return 1/0;switch(e.kind){case Kn.Array:{for(var t=0,n=0,a=e.nodes;n<a.length;n++)for(var o=a[n],u=0,s=o;u<s.length;u++){var l=s[u];t=(0,bz.fastMax)(t,cb(l,r+1))}return t+1}case Kn.Param:return e.def===void 0?1:cb(e.def.rhs,r+1)+1;case Kn.Let:case Kn.Lambda:case Kn.App:{for(var t=cb(e.head,r+1),c=0,d=e.args;c<d.length;c++){var f=d[c];t=(0,bz.fastMax)(t,cb(f,r+1))}return t+1}case Kn.Paren:return cb(e.node,r+1)+1;case Kn.FieldRef:return cb(e.lhs,r+1)+1;case Kn.Var:case Kn.Name:case Kn.CellRef:case Kn.StructRef:case Kn.Literal:case Kn.Operator:case Kn.WSF:case Kn.Missing:case Kn.BadChars:return 1;case Kn.BadSequence:{for(var t=0,m=0,v=e.contents;m<v.length;m++){var h=v[m];t=(0,bz.fastMax)(t,cb(h,r+1))}return t+1}default:return(0,db.assertNever)("calc.lang.getDepthUpperBound",e)}}function Vge(e){return cb(e,0)}ye.getDepthUpperBound=Vge});var oT=T(Wd=>{"use strict";p();Object.defineProperty(Wd,"__esModule",{value:!0});Wd.successUndefined=Wd.success=Wd.javaScriptError=Wd.isSuccess=Wd.failure=Wd.ResultKind=Wd.ReasonKind=void 0;var iT=pr();Wd.ReasonKind=iT.result.ReasonKind;Wd.ResultKind=iT.result.ResultKind;Wd.failure=iT.result.failure;Wd.isSuccess=iT.result.isSuccess;Wd.javaScriptError=iT.result.javaScriptError;Wd.success=iT.result.success;Wd.successUndefined=iT.result.successUndefined});var jge=T(Hd=>{"use strict";p();Object.defineProperty(Hd,"__esModule",{value:!0});Hd.ivlCompare=Hd.ivlExcept=Hd.ivlMeetsOrTouches=Hd.ivlMeets=Hd.ivlDistance=Hd.ivlMeet=Hd.ivlJoin=void 0;var uT=pr();Hd.ivlJoin=uT.interval.ivlJoin;Hd.ivlMeet=uT.interval.ivlMeet;Hd.ivlDistance=uT.interval.ivlDistance;Hd.ivlMeets=uT.interval.ivlMeets;Hd.ivlMeetsOrTouches=uT.interval.ivlMeetsOrTouches;Hd.ivlExcept=uT.interval.ivlExcept;Hd.ivlCompare=uT.interval.ivlCompare});var Tz=T(Pc=>{"use strict";p();Object.defineProperty(Pc,"__esModule",{value:!0});Pc.setFeatureGateDictionaryGetter=Pc.overrideTypedFeatureGates=Pc.isTypedChangeGateEnabled=Pc.getTypedFeatureGate=Pc.getFeatures=Pc.isFeatureEnabled=Pc.initFeatureConfiguration=Pc.FeatureName=void 0;var tA=pr();Pc.FeatureName=tA.featureConfiguration.FeatureName;Pc.initFeatureConfiguration=tA.featureConfiguration.initFeatureConfiguration;Pc.isFeatureEnabled=tA.featureConfiguration.isFeatureEnabled;Pc.getFeatures=tA.featureConfiguration.getFeatures;Pc.getTypedFeatureGate=tA.featureConfiguration.getTypedFeatureGate;Pc.isTypedChangeGateEnabled=tA.featureConfiguration.isTypedChangeGateEnabled;var Wge=mi();Object.defineProperty(Pc,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return Wge.overrideTypedFeatureGates}});Object.defineProperty(Pc,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return Wge.setFeatureGateDictionaryGetter}})});var aA=T(Ps=>{"use strict";p();Object.defineProperty(Ps,"__esModule",{value:!0});Ps.isVolatileFunc=Ps.getWorksheetFuncEnglishName=Ps.getWorksheetFuncType=Ps.getOperatorType=Ps.operatorStrings=Ps.OperatorId=Ps.higherOrderFunctionType=Ps.unknownFunctionType=Ps.WorksheetFuncId=void 0;var or=dy(),jo=Aq();Object.defineProperty(Ps,"WorksheetFuncId",{enumerable:!0,get:function(){return jo.WorksheetFuncId}});var Nq=Tz();Ps.unknownFunctionType=(0,or.functionType)(0,254,[],[or.SignatureType.All],[],or.SignatureType.All,or.SpecialPrecs.All,or.FunctionFlags.AllowLStrs);function fQe(){var e=or.OperKind.Number|or.OperKind.String|or.OperKind.Boolean|or.OperKind.Rich|or.OperKind.Error|or.OperKind.Blank|((0,Nq.isFeatureEnabled)(Nq.FeatureName.CalcLambdaCellValues)?0:or.OperKind.Range)|((0,Nq.isFeatureEnabled)(Nq.FeatureName.CalcLambdaArrayLifting)?0:or.OperKind.Array),r=or.OperKind.Number|or.OperKind.String|or.OperKind.Boolean|or.OperKind.Rich|or.OperKind.Error|or.OperKind.Blank|or.OperKind.Missing|or.OperKind.Array|or.OperKind.Range;return(0,or.functionType)(1,255,[e],[r],[],or.SignatureType.All,or.SpecialPrecs.None,or.FunctionFlags.Allow3dRef|or.FunctionFlags.AllowLStrs)}Ps.higherOrderFunctionType=fQe;var Wo;(function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"})(Wo||(Ps.OperatorId=Wo={}));Ps.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];var Hge=or.OperKind.Number|or.OperKind.String|or.OperKind.Boolean|or.OperKind.Blank,zge=or.OperKind.Number|or.OperKind.String|or.OperKind.Boolean|or.OperKind.Blank,sT=(0,or.functionType)(2,2,[or.OperKind.Number,or.OperKind.Number],[],[],or.OperKind.Number,or.SpecialPrecs.None,or.FunctionFlags.None),Qge=(0,or.functionType)(1,1,[or.OperKind.Number],[],[],or.OperKind.Number,or.SpecialPrecs.None,or.FunctionFlags.None),pQe=(0,or.functionType)(1,1,[Hge],[],[],Hge,or.SpecialPrecs.None,or.FunctionFlags.AllowLStrs),mQe=(0,or.functionType)(2,2,[or.OperKind.String,or.OperKind.String],[],[],or.OperKind.String,or.SpecialPrecs.None,or.FunctionFlags.AllowLStrs),nA=(0,or.functionType)(2,2,[zge,zge],[],[],or.OperKind.Boolean,or.SpecialPrecs.None,or.FunctionFlags.AllowLStrs),gQe=(0,or.functionType)(2,2,[or.OperKind.Range,or.OperKind.Range],[],[],or.OperKind.Range,or.SpecialPrecs.AllCells,or.FunctionFlags.None),Xge=(0,or.functionType)(2,2,[or.OperKind.Range,or.OperKind.Range],[],[],or.OperKind.Range,or.SpecialPrecs.None,or.FunctionFlags.None),Rz=(0,or.functionType)(2,2,[or.OperKind.Boolean,or.OperKind.Boolean],[],[],or.OperKind.Boolean,or.SpecialPrecs.None,or.FunctionFlags.None),eu=[];eu[Wo.Add]=sT;eu[Wo.Sub]=sT;eu[Wo.Mul]=sT;eu[Wo.Div]=sT;eu[Wo.Pow]=sT;eu[Wo.Percent]=Qge;eu[Wo.Neg]=Qge;eu[Wo.At]=jo.worksheetFuncTypes[jo.WorksheetFuncId.SINGLE];eu[Wo.Pound]=jo.worksheetFuncTypes[jo.WorksheetFuncId.ANCHORARRAY];eu[Wo.Pos]=pQe;eu[Wo.Concat]=mQe;eu[Wo.Eq]=nA;eu[Wo.Ne]=nA;eu[Wo.Lt]=nA;eu[Wo.Le]=nA;eu[Wo.Gt]=nA;eu[Wo.Ge]=nA;eu[Wo.Range]=gQe;eu[Wo.Isect]=Xge;eu[Wo.Union]=Xge;eu[Wo.And]=Rz;eu[Wo.Or]=Rz;eu[Wo.Xor]=Rz;eu[Wo.Min]=sT;eu[Wo.Max]=sT;function vQe(e){var r=eu[e];return r??Ps.unknownFunctionType}Ps.getOperatorType=vQe;function Yge(e){var r=jo.worksheetFuncTypes[e];return r??Ps.unknownFunctionType}Ps.getWorksheetFuncType=Yge;function hQe(e){return jo.worksheetFuncEnglishNames[e]}Ps.getWorksheetFuncEnglishName=hQe;function SQe(e){return(Yge(e).staticPrecs&(or.SpecialPrecs.Time|or.SpecialPrecs.Calc))!==0}Ps.isVolatileFunc=SQe;function Yl(e,r){var t=jo.worksheetFuncTypes[e];t!=null&&(t.staticPrecs=r)}Yl(jo.WorksheetFuncId.ROW,or.SpecialPrecs.OwnRow);Yl(jo.WorksheetFuncId.COLUMN,or.SpecialPrecs.OwnCol);Yl(jo.WorksheetFuncId.SHEET,or.SpecialPrecs.OwnDocSheets);Yl(jo.WorksheetFuncId.SHEETS,or.SpecialPrecs.OwnDocSheets);Yl(jo.WorksheetFuncId.OFFSET,or.SpecialPrecs.AllCells);Yl(jo.WorksheetFuncId.INDIRECT,or.SpecialPrecs.AllCells);Yl(jo.WorksheetFuncId.SUMIF,or.SpecialPrecs.AllCells);Yl(jo.WorksheetFuncId.AVERAGEIF,or.SpecialPrecs.AllCells);Yl(jo.WorksheetFuncId.LOOKUP,or.SpecialPrecs.AllCells);Yl(jo.WorksheetFuncId.ADDRESS,or.SpecialPrecs.RefStyle);Yl(jo.WorksheetFuncId.FORMULATEXT,or.SpecialPrecs.RefStyle);Yl(jo.WorksheetFuncId.NOW,or.SpecialPrecs.Time);Yl(jo.WorksheetFuncId.TODAY,or.SpecialPrecs.Time);Yl(jo.WorksheetFuncId.RAND,or.SpecialPrecs.Calc);Yl(jo.WorksheetFuncId.RANDBETWEEN,or.SpecialPrecs.Calc);Yl(jo.WorksheetFuncId.RANDARRAY,or.SpecialPrecs.Calc);Yl(jo.WorksheetFuncId.SUBTOTAL,or.SpecialPrecs.CellProps);Yl(jo.WorksheetFuncId.CELL,or.SpecialPrecs.CellProps|or.SpecialPrecs.AllCells);Yl(jo.WorksheetFuncId.INFO,or.SpecialPrecs.None)});var S0=T(Ae=>{"use strict";p();var lT;Object.defineProperty(Ae,"__esModule",{value:!0});Ae.isReadOperEqual=Ae.isWriteOper=Ae.isPrimitiveOper=Ae.isRichOper=Ae.isBlankOper=Ae.isMissingOper=Ae.isArrayOper=Ae.isRangeOper=Ae.isErrorOper=Ae.isBooleanOper=Ae.isStringOper=Ae.isNumberOper=Ae.shouldFieldRefBeBracketed=Ae.isValidArgsLength=Ae.getArgType=Ae.isBooleanLiteralNode=Ae.isNumberLiteralNode=Ae.isMissingLiteralNode=Ae.isMissingNode=Ae.isUnqualifiedNameNode=Ae.isWSFNode=Ae.isOperatorNode=Ae.getArguments=Ae.gridCellRange=Ae.sheetGridRangeAnchor=Ae.gridRangeAnchor=Ae.isSheetGridRangeEqual=Ae.isSheetGridCellEqual=Ae.isGridRangeEqual=Ae.isGridCellEqual=Ae.isNameScopeEqual=Ae.sheetRangeToSheetIndex=Ae.isSheetIndexEqual=Ae.isDocumentLocEqual=Ae.gridRangeSize=Ae.gridRangeExcept=Ae.gridRangeCompare=Ae.gridCellImplicitIsect=Ae.gridRangeIsects=Ae.gridRangeIsect=Ae.gridRangesJoin=Ae.gridRangeJoinOpt=Ae.gridRangeJoin=Ae.forEachTileInRange=Ae.forEachCellInRange=Ae.isWellFormed=Ae.isSheetGridRange=Ae.isSheetIndex=Ae.isSheetGridCell=Ae.isGridCell=void 0;Ae.applyComparison=Ae.normalizeCommaOpRef=Ae.isRangeOpNoMissing=Ae.isRangeOpClosed=Ae.isCommaOpNoBadOrMissing=Ae.isCommaOpClosed=Ae.isCommaOpRefWellFormed=Ae.getBoundName=Ae.getEtaFuncId=Ae.getUserDefinedFuncName=Ae.getWorksheetFuncId=Ae.createFailureErrorClass=Ae.internal=Ae.unavailable=Ae.notImplemented=Ae.ReasonKind=Ae.LangReasonKind=void 0;var Dq=fe(),h0=pm(),As=gg();Object.defineProperty(Ae,"isGridCell",{enumerable:!0,get:function(){return As.isGridCell}});Object.defineProperty(Ae,"isSheetGridCell",{enumerable:!0,get:function(){return As.isSheetGridCell}});var Ri=Ep(),vu=dy(),yQe=oT(),zd=jd(),Oq=jge(),pb=aA(),Zge=gg();Object.defineProperty(Ae,"isSheetIndex",{enumerable:!0,get:function(){return Zge.isSheetIndex}});Object.defineProperty(Ae,"isSheetGridRange",{enumerable:!0,get:function(){return Zge.isSheetGridRange}});function _Qe(e){return e.isWellFormed}Ae.isWellFormed=_Qe;function bQe(e,r){if((0,As.isGridCell)(e))return r(e,0,0);for(var t=e.row,n=e.rows,a=e.col,o=e.cols,u=0;u<n;u+=1)for(var s=0;s<o;s+=1)if(!r((0,As.gridCell)(t+u,a+s),u,s))return!1;return!0}Ae.forEachCellInRange=bQe;function CQe(e,r,t){var n=e.row,a=e.rows,o=e.col,u=e.cols;(0,h0.assertPositiveInteger)("calc.lang.forEachTileInRange",r),(0,h0.assertIndex)("calc.lang.forEachTileInRange",n,As.sheetRows),(0,h0.assertIndex)("calc.lang.forEachTileInRange",o,As.sheetCols),(0,h0.assertPositiveLength)("calc.lang.forEachTileInRange",a,As.sheetRows-n),(0,h0.assertPositiveLength)("calc.lang.forEachTileInRange",u,As.sheetCols-o);for(var s=n;s<n+a;s+=r)for(var l=o;l<o+u;l+=r)if(!t((0,As.unsafeGridRange)(s,l,(0,zd.fastMin)(r,a+n-s),(0,zd.fastMin)(r,u+o-l))))return!1;return!0}Ae.forEachTileInRange=CQe;function Az(e,r){var t=e.row,n=e.col,a=e.rows,o=e.cols,u=r.row,s=r.col,l=r.rows,c=r.cols,d=(0,zd.fastMin)(t,u),f=(0,zd.fastMin)(n,s),m=(0,zd.fastMax)(t+a,u+l)-d,v=(0,zd.fastMax)(n+o,s+c)-f;return(0,As.unsafeGridRange)(d,f,m,v)}Ae.gridRangeJoin=Az;function TQe(e,r){return e?r?Az(e,r):e:r}Ae.gridRangeJoinOpt=TQe;function RQe(e){return e.length===0&&(0,h0.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(Az)}Ae.gridRangesJoin=RQe;function EQe(e,r){var t=e.row,n=e.col,a=e.rows,o=e.cols,u=r.row,s=r.col,l=r.rows,c=r.cols,d=(0,zd.fastMax)(t,u),f=(0,zd.fastMax)(n,s),m=(0,zd.fastMin)(t+a,u+l)-d,v=(0,zd.fastMin)(n+o,s+c)-f;if(!(m<=0||v<=0))return(0,As.unsafeGridRange)(d,f,m,v)}Ae.gridRangeIsect=EQe;function PQe(e,r){var t=e.row,n=e.col,a=e.rows,o=e.cols,u=r.row,s=r.col,l=r.rows,c=r.cols;return(0,zd.fastMax)(t,u)<(0,zd.fastMin)(t+a,u+l)&&(0,zd.fastMax)(n,s)<(0,zd.fastMin)(n+o,s+c)}Ae.gridRangeIsects=PQe;function AQe(e,r){var t=e.row,n=e.col,a=r.row,o=r.col,u=r.rows,s=r.cols,l=a<=t&&t<a+u,c=o<=n&&n<o+s;if(l&&c)return(0,As.gridCell)(t,n);if(l&&s===1)return(0,As.gridCell)(t,o);if(c&&u===1)return(0,As.gridCell)(a,n);if(s===1&&u===1)return(0,As.gridCell)(a,o)}Ae.gridCellImplicitIsect=AQe;function FQe(e,r){var t=e.row,n=e.col,a=e.rows,o=e.cols,u=r.row,s=r.col,l=r.rows,c=r.cols,d=t+a,f=u+l,m=n+o,v=s+c;if(t===u&&d===f&&n===s&&m===v)return 0;if(t<=u&&d>=f&&n<=s&&m>=v)return 1;if(t>=u&&d<=f&&n>=s&&m<=v)return-1}Ae.gridRangeCompare=FQe;function NQe(e,r){var t=[e.row,e.row+e.rows],n=[e.col,e.col+e.cols],a=[r.row,r.row+r.rows],o=[r.col,r.col+r.cols],u=(0,Oq.ivlCompare)(t,a),s=(0,Oq.ivlCompare)(n,o);if(u!==void 0&&u<=0){var l=(0,Oq.ivlExcept)(n,o);if(l!==void 0)return(0,As.gridRange)(e.row,l[0],e.rows,l[1]-l[0])}if(s!==void 0&&s<=0){var c=(0,Oq.ivlExcept)(t,a);if(c!==void 0)return(0,As.gridRange)(c[0],e.col,c[1]-c[0],e.cols)}}Ae.gridRangeExcept=NQe;function OQe(e){return e.rows*e.cols}Ae.gridRangeSize=OQe;function Fz(e,r){return e===r?!0:e.name===r.name&&e.path===r.path}Ae.isDocumentLocEqual=Fz;function Nz(e,r){return Fz(e.document,r.document)&&e.index===r.index}Ae.isSheetIndexEqual=Nz;function kQe(e){if(e.index===e.index2)return Dq.__assign(Dq.__assign({},e),{__isRange:!1})}Ae.sheetRangeToSheetIndex=kQe;function MQe(e,r){return Fz(e.document,r.document)&&e.index===r.index}Ae.isNameScopeEqual=MQe;function $ge(e,r){return e.row===r.row&&e.col===r.col}Ae.isGridCellEqual=$ge;function eve(e,r){return e.row===r.row&&e.col===r.col&&e.rows===r.rows&&e.cols===r.cols}Ae.isGridRangeEqual=eve;function xQe(e,r){return Nz(e.sheet,r.sheet)&&$ge(e.range,r.range)}Ae.isSheetGridCellEqual=xQe;function IQe(e,r){return Nz(e.sheet,r.sheet)&&eve(e.range,r.range)}Ae.isSheetGridRangeEqual=IQe;function rve(e){return(0,As.isGridCell)(e)?e:(0,As.unsafeGridRange)(e.row,e.col,1,1)}Ae.gridRangeAnchor=rve;function wQe(e){return(0,As.isSheetGridCell)(e)?e:(0,As.sheetGridCell)(e.sheet,rve(e.range))}Ae.sheetGridRangeAnchor=wQe;function DQe(e,r){var t=e.row,n=e.col,a=r.row,o=r.col;return(0,As.unsafeGridRange)((0,zd.fastMin)(t,a),(0,zd.fastMin)(n,o),Math.abs(a-t)+1,Math.abs(o-n)+1)}Ae.gridCellRange=DQe;function LQe(e){return e.length===1&&tve(e[0])?0:e.length}var qQe=[];function GQe(e){return LQe(e)===0?qQe:e}Ae.getArguments=GQe;function BQe(e){return e.kind===Ri.NodeKind.Operator}Ae.isOperatorNode=BQe;function UQe(e){return e.kind===Ri.NodeKind.WSF}Ae.isWSFNode=UQe;function KQe(e){return e.kind===Ri.NodeKind.Name&&e.qualifier===void 0}Ae.isUnqualifiedNameNode=KQe;function VQe(e){return e.kind===Ri.NodeKind.Missing}Ae.isMissingNode=VQe;function tve(e){return e.kind===Ri.NodeKind.Literal&&ove(e.oper)}Ae.isMissingLiteralNode=tve;function jQe(e){return e.kind===Ri.NodeKind.Literal&&ave(e.oper)}Ae.isNumberLiteralNode=jQe;function nve(e){return e.kind===Ri.NodeKind.Literal&&ive(e.oper)}Ae.isBooleanLiteralNode=nve;function WQe(e,r,t){var n=e.maxArgs,a=e.headTypes,o=e.restTypes,u=e.tailTypes;if((0,h0.assertPositiveInteger)("calc.runtime.getArgType: n",t),(0,h0.assertIndex)("calc.runtime.getArgType: i",r,t),r>=n)return vu.SignatureType.None;if(r<a.length)return a[r];if(o.length===0)return vu.SignatureType.None;if(r<a.length+o.length)return o[r-a.length];var s=(t-a.length)%o.length;return s>u.length?vu.SignatureType.None:r>=t-s?u[r-(t-s)]:o[(r-a.length)%o.length]}Ae.getArgType=WQe;function HQe(e,r){var t=e.minArgs,n=e.maxArgs,a=e.headTypes,o=e.restTypes,u=e.tailTypes;if(r<t||r>n)return!1;if(r<=a.length+o.length)return!0;if(o.length===0)return!1;var s=(r-a.length)%o.length;return s<=u.length}Ae.isValidArgsLength=HQe;function zQe(e,r,t){if(t.length===0||r.field.kind!==Ri.NodeKind.Ident)return!1;for(var n=e;!(n.kind!==Ri.NodeKind.App||n.head.kind!==Ri.NodeKind.Operator);){var a=n.head.id;if((a===pb.OperatorId.Range||a===pb.OperatorId.Isect)&&n.args.length===2){n=n.args[1];continue}break}return nve(n)||n.kind===Ri.NodeKind.Name||n.kind===Ri.NodeKind.CellRef}Ae.shouldFieldRefBeBracketed=zQe;function ave(e){return e.kind===vu.OperKind.Number}Ae.isNumberOper=ave;function QQe(e){return e.kind===vu.OperKind.String}Ae.isStringOper=QQe;function ive(e){return e.kind===vu.OperKind.Boolean}Ae.isBooleanOper=ive;function XQe(e){return e.kind===vu.OperKind.Error}Ae.isErrorOper=XQe;function YQe(e){return e.kind===vu.OperKind.Range}Ae.isRangeOper=YQe;function JQe(e){return e.kind===vu.OperKind.Array}Ae.isArrayOper=JQe;function ove(e){return e.kind===vu.OperKind.Missing}Ae.isMissingOper=ove;function ZQe(e){return e.kind===vu.OperKind.Blank}Ae.isBlankOper=ZQe;function $Qe(e){return e.kind===vu.OperKind.Rich}Ae.isRichOper=$Qe;var uve=vu.OperKind.Number|vu.OperKind.String|vu.OperKind.Boolean;function eXe(e){return(e.kind&uve)!==0}Ae.isPrimitiveOper=eXe;var rXe=uve|vu.OperKind.Error|vu.OperKind.Array|vu.OperKind.Rich;function tXe(e){return(e.kind&rXe)!==0}Ae.isWriteOper=tXe;function sve(e,r,t,n){if(t.kind!==r.kind)return!1;switch(t.kind){case vu.OperKind.Boolean:case vu.OperKind.String:return t.value===r.value;case vu.OperKind.Number:return e.cond2(t,r)===0;case vu.OperKind.Error:return t.type===r.type;case vu.OperKind.Rich:return n;case vu.OperKind.Array:var a=r;if(t.cols!==a.cols||t.rows!==a.rows)return!1;for(var o=0;o<t.rows;o+=1)for(var u=t.opers[o],s=a.opers[o],l=0;l<t.cols;l+=1)if(!sve(e,s[l],u[l],n))return!1;return!0;case vu.OperKind.Blank:return!0;default:return(0,h0.assertNever)("calc.lang.readOperEq",t)}}Ae.isReadOperEqual=sve;var Ez;(function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"})(Ez||(Ae.LangReasonKind=Ez={}));Ae.ReasonKind=Dq.__assign(Dq.__assign({},yQe.ReasonKind),Ez);function nXe(e){return{kind:Ae.ReasonKind.NotImplemented,features:e}}Ae.notImplemented=nXe;function aXe(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return e.length===0&&(0,h0.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:Ae.ReasonKind.Unavailable,objects:e}}Ae.unavailable=aXe;function iXe(e){return{kind:Ae.ReasonKind.Internal,message:e}}Ae.internal=iXe;function oXe(e){var r=function(n){this.reason=n,this.name=e,this.stack=e,this.message=n.kind};return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}Ae.createFailureErrorClass=oXe;var kq="_xlfn.",Mq="_xlws.";function uXe(e,r){var t=r;return t.length>kq.length&&e.stringCompareCI(t.substring(0,kq.length),kq)===0&&(t=t.substring(kq.length),t.length>Mq.length&&e.stringCompareCI(t.substring(0,Mq.length),Mq)===0&&(t=t.substring(Mq.length))),e.getWorksheetFuncId(t)}Ae.getWorksheetFuncId=uXe;var xq="_xludf.";function sXe(e,r){var t=r;return t.length>xq.length&&e.stringCompareCI(t.substring(0,xq.length),xq)===0&&(t=t.substring(xq.length)),t}Ae.getUserDefinedFuncName=sXe;var Iq="_xleta.";function lXe(e,r){var t=r;return t.length>Iq.length&&e.stringCompareCI(t.substring(0,Iq.length),Iq)===0&&(t=t.substring(Iq.length)),e.getWorksheetFuncId(t)}Ae.getEtaFuncId=lXe;var wq="_xlpm.";function cXe(e,r){var t=r;return t.length>wq.length&&e.stringCompareCI(t.substring(0,wq.length),wq)===0&&(t=t.substring(wq.length)),t}Ae.getBoundName=cXe;function dXe(e){var r=e.specialRefs,t=Object.keys(r).reduce(function(n,a){return n+(r[Number(a)]?1:0)},0);return t===1||t===2&&r[Ri.SpecialRefId.Data]&&(r[Ri.SpecialRefId.Headers]||r[Ri.SpecialRefId.Totals])}function fXe(e){return e.kind!==Ri.StructRefKind.SpecialRef&&e.kind!==Ri.StructRefKind.BadRef||e.isBracketed}function Pz(e){return e.kind===Ri.StructRefKind.MissingRef||e.kind===Ri.StructRefKind.BadRef}function pXe(e){return e.columnRefs.length<=1&&e.refs.every(fXe)&&dXe(e)}Ae.isCommaOpRefWellFormed=pXe;function mXe(e){return e.refs.every(gM)}Ae.isCommaOpClosed=mXe;function gXe(e){return!e.refs.some(Pz)}Ae.isCommaOpNoBadOrMissing=gXe;function vXe(e){return gM(e.lhs)&&gM(e.rhs)}Ae.isRangeOpClosed=vXe;function hXe(e){return!Pz(e.lhs)&&!Pz(e.rhs)}Ae.isRangeOpNoMissing=hXe;function gM(e){switch(e.kind){case Ri.StructRefKind.SpecialRef:return e.isClosed;case Ri.StructRefKind.ColumnRef:return e.isClosed;case Ri.StructRefKind.RangeOpRef:return gM(e.lhs)&&gM(e.rhs);case Ri.StructRefKind.MissingRef:return!0;case Ri.StructRefKind.BadRef:return e.isClosed}}var SXe=(lT={},lT[Ri.SpecialRefId.All]=1,lT[Ri.SpecialRefId.Headers]=2,lT[Ri.SpecialRefId.Data]=3,lT[Ri.SpecialRefId.Totals]=4,lT[Ri.SpecialRefId.ThisRow]=5,lT),Jge=function(r){return r.kind===Ri.StructRefKind.MissingRef?7:r.kind!==Ri.StructRefKind.SpecialRef?6:SXe[r.id]};function yXe(e,r){return Jge(e)-Jge(r)}function _Xe(e){for(var r={},t=[],n=0,a=e.refs;n<a.length;n++){var o=a[n];o.kind!==Ri.StructRefKind.SpecialRef?t.push(o):r[o.id]===void 0&&(r[o.id]=!0,t.push(o))}return t.sort(yXe),t}Ae.normalizeCommaOpRef=_Xe;function bXe(e,r){switch(e){case pb.OperatorId.Eq:return r===0;case pb.OperatorId.Ne:return r!==0;case pb.OperatorId.Lt:return r<0;case pb.OperatorId.Gt:return r>0;case pb.OperatorId.Le:return r<=0;case pb.OperatorId.Ge:return r>=0}}Ae.applyComparison=bXe});var cT=T(Fs=>{"use strict";p();Object.defineProperty(Fs,"__esModule",{value:!0});Fs.values=Fs.stringStartsWith=Fs.stringEndsWith=Fs.repeat=Fs.prependErrorMessage=Fs.partialArray=Fs.messageFromError=Fs.mathLog2=Fs.isInteger=Fs.arrayFill=void 0;var y0=pr();Fs.arrayFill=y0.util.arrayFill;Fs.isInteger=y0.util.isInteger;Fs.mathLog2=y0.util.mathLog2;Fs.messageFromError=y0.util.messageFromError;Fs.partialArray=y0.util.partialArray;Fs.prependErrorMessage=y0.util.prependErrorMessage;Fs.repeat=y0.util.repeat;Fs.stringEndsWith=y0.util.stringEndsWith;Fs.stringStartsWith=y0.util.stringStartsWith;Fs.values=y0.util.values});var iA=T(Ao=>{"use strict";p();Object.defineProperty(Ao,"__esModule",{value:!0});Ao.surrogatePairToCodePoint=Ao.stringFromCodePoint=Ao.stringCodePointAt=Ao.scanCodePointsBack=Ao.scanCodePoints=Ao.numCodeUnits=Ao.makeIsInClass=Ao.isLowSurrogate=Ao.isHighSurrogate=Ao.isAnySurrogate=Ao.forEachClassInterval=Ao.countCodePoints=Ao.codePointIterator=void 0;var mm=pr();Ao.codePointIterator=mm.unicode.codePointIterator;Ao.countCodePoints=mm.unicode.countCodePoints;Ao.forEachClassInterval=mm.unicode.forEachClassInterval;Ao.isAnySurrogate=mm.unicode.isAnySurrogate;Ao.isHighSurrogate=mm.unicode.isHighSurrogate;Ao.isLowSurrogate=mm.unicode.isLowSurrogate;Ao.makeIsInClass=mm.unicode.makeIsInClass;Ao.numCodeUnits=mm.unicode.numCodeUnits;Ao.scanCodePoints=mm.unicode.scanCodePoints;Ao.scanCodePointsBack=mm.unicode.scanCodePointsBack;Ao.stringCodePointAt=mm.unicode.stringCodePointAt;Ao.stringFromCodePoint=mm.unicode.stringFromCodePoint;Ao.surrogatePairToCodePoint=mm.unicode.surrogatePairToCodePoint});var Lq=T(hg=>{"use strict";p();Object.defineProperty(hg,"__esModule",{value:!0});hg.KnownFormat=hg.Calendar=hg.NumberShape=hg.DateOrder=hg.CurrencyFormat=void 0;var lve;(function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"})(lve||(hg.CurrencyFormat=lve={}));var cve;(function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"})(cve||(hg.DateOrder=cve={}));var dve;(function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"})(dve||(hg.NumberShape=dve={}));var fve;(function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew",e.GregorianMEFrench="GregorianMEFrench",e.GregorianArabic="GregorianArabic",e.GregorianXlitEnglish="GregorianXlitEnglish",e.GregorianXlitFrench="GregorianXlitFrench",e.Persian="Persian",e.UmAlQura="UmAlQura"})(fve||(hg.Calendar=fve={}));var pve;(function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text",e[e.USCoCurrency=-1037]="USCoCurrency",e[e.USCoCurrencyDec=-1039]="USCoCurrencyDec",e[e.NoComFixed0_Tha=-2036]="NoComFixed0_Tha",e[e.NoComFixed_Tha=-2037]="NoComFixed_Tha",e[e.Fixed0_Tha=-2038]="Fixed0_Tha",e[e.Fixed_Tha=-2039]="Fixed_Tha",e[e.CoCurrency_Tha=-2041]="CoCurrency_Tha",e[e.CoCurrencyDec_Tha=-2043]="CoCurrencyDec_Tha",e[e.Pct0_Tha=-2044]="Pct0_Tha",e[e.Pct_Tha=-2045]="Pct_Tha",e[e.MMDDYY_Tha=-2048]="MMDDYY_Tha",e[e.DDMMMYY_Tha=-2049]="DDMMMYY_Tha",e[e.DDMMM_Tha=-2050]="DDMMM_Tha",e[e.MMMYY_Tha=-2051]="MMMYY_Tha",e[e.HHMM_Tha=-2052]="HHMM_Tha",e[e.HHMMSS_Tha=-2053]="HHMMSS_Tha",e[e.MDYHMS_Tha=-2054]="MDYHMS_Tha",e[e.AbsHMMSS_Tha=-2055]="AbsHMMSS_Tha",e[e.MMSS_Tha=-2056]="MMSS_Tha",e[e.SS0_Tha=-2057]="SS0_Tha",e[e.DMBB_Tha=-2058]="DMBB_Tha"})(pve||(hg.KnownFormat=pve={}))});var vM=T(se=>{"use strict";p();Object.defineProperty(se,"__esModule",{value:!0});se.codePointExclamationMark=se.codePointEuroSign=se.codePointEqualsSign=se.codePointDoubleQuote=se.codePointDollarSign=se.codePointDigitZero=se.codePointDigitTwo=se.codePointDigitThree=se.codePointDigitSix=se.codePointDigitSeven=se.codePointDigitOne=se.codePointDigitNine=se.codePointDigitFour=se.codePointDigitFive=se.codePointDigitEight=se.codePointComma=se.codePointColon=se.codePointCircumflexAccent=se.codePointCapitalZ=se.codePointCapitalY=se.codePointCapitalX=se.codePointCapitalW=se.codePointCapitalV=se.codePointCapitalU=se.codePointCapitalT=se.codePointCapitalS=se.codePointCapitalR=se.codePointCapitalQ=se.codePointCapitalP=se.codePointCapitalO=se.codePointCapitalN=se.codePointCapitalM=se.codePointCapitalL=se.codePointCapitalK=se.codePointCapitalJ=se.codePointCapitalI=se.codePointCapitalH=se.codePointCapitalG=se.codePointCapitalF=se.codePointCapitalE=se.codePointCapitalD=se.codePointCapitalC=se.codePointCapitalB=se.codePointCapitalA=se.codePointCR=se.codePointBacktick=se.codePointBackslash=se.codePointAtSign=se.codePointAsterisk=se.codePointAmpersand=void 0;se.codePointSmallW=se.codePointSmallV=se.codePointSmallU=se.codePointSmallT=se.codePointSmallS=se.codePointSmallR=se.codePointSmallQ=se.codePointSmallP=se.codePointSmallO=se.codePointSmallN=se.codePointSmallM=se.codePointSmallL=se.codePointSmallK=se.codePointSmallJ=se.codePointSmallI=se.codePointSmallH=se.codePointSmallG=se.codePointSmallF=se.codePointSmallE=se.codePointSmallD=se.codePointSmallC=se.codePointSmallB=se.codePointSmallA=se.codePointSlash=se.codePointSingleQuote=se.codePointSemicolon=se.codePointRightSquareBracket=se.codePointRightParen=se.codePointRightCurlyBracket=se.codePointQuestionMark=se.codePointPlusSign=se.codePointPipe=se.codePointPercentSign=se.codePointMinusSign=se.codePointLessThanSign=se.codePointLeftSquareBracket=se.codePointLeftParen=se.codePointLeftCurlyBracket=se.codePointLF=se.codePointInvertedQuestionMark=se.codePointInvertedExclamationMark=se.codePointHash=se.codePointGreaterThanSign=se.codePointFullwidthLatinSmallZ=se.codePointFullwidthLatinSmallA=se.codePointFullwidthLatinCapitalZ=se.codePointFullwidthLatinCapitalA=se.codePointFullwidthDigitZero=se.codePointFullwidthDigitNine=se.codePointFullStop=void 0;se.codePointUnderscore=se.codePointTilde=se.codePointThaiDigitZero=se.codePointThaiDigitNine=se.codePointTab=se.codePointSpace=se.codePointSmallZ=se.codePointSmallY=se.codePointSmallX=void 0;var Qe=pr();se.codePointAmpersand=Qe.codePoint.codePointAmpersand;se.codePointAsterisk=Qe.codePoint.codePointAsterisk;se.codePointAtSign=Qe.codePoint.codePointAtSign;se.codePointBackslash=Qe.codePoint.codePointBackslash;se.codePointBacktick=Qe.codePoint.codePointBacktick;se.codePointCR=Qe.codePoint.codePointCR;se.codePointCapitalA=Qe.codePoint.codePointCapitalA;se.codePointCapitalB=Qe.codePoint.codePointCapitalB;se.codePointCapitalC=Qe.codePoint.codePointCapitalC;se.codePointCapitalD=Qe.codePoint.codePointCapitalD;se.codePointCapitalE=Qe.codePoint.codePointCapitalE;se.codePointCapitalF=Qe.codePoint.codePointCapitalF;se.codePointCapitalG=Qe.codePoint.codePointCapitalG;se.codePointCapitalH=Qe.codePoint.codePointCapitalH;se.codePointCapitalI=Qe.codePoint.codePointCapitalI;se.codePointCapitalJ=Qe.codePoint.codePointCapitalJ;se.codePointCapitalK=Qe.codePoint.codePointCapitalK;se.codePointCapitalL=Qe.codePoint.codePointCapitalL;se.codePointCapitalM=Qe.codePoint.codePointCapitalM;se.codePointCapitalN=Qe.codePoint.codePointCapitalN;se.codePointCapitalO=Qe.codePoint.codePointCapitalO;se.codePointCapitalP=Qe.codePoint.codePointCapitalP;se.codePointCapitalQ=Qe.codePoint.codePointCapitalQ;se.codePointCapitalR=Qe.codePoint.codePointCapitalR;se.codePointCapitalS=Qe.codePoint.codePointCapitalS;se.codePointCapitalT=Qe.codePoint.codePointCapitalT;se.codePointCapitalU=Qe.codePoint.codePointCapitalU;se.codePointCapitalV=Qe.codePoint.codePointCapitalV;se.codePointCapitalW=Qe.codePoint.codePointCapitalW;se.codePointCapitalX=Qe.codePoint.codePointCapitalX;se.codePointCapitalY=Qe.codePoint.codePointCapitalY;se.codePointCapitalZ=Qe.codePoint.codePointCapitalZ;se.codePointCircumflexAccent=Qe.codePoint.codePointCircumflexAccent;se.codePointColon=Qe.codePoint.codePointColon;se.codePointComma=Qe.codePoint.codePointComma;se.codePointDigitEight=Qe.codePoint.codePointDigitEight;se.codePointDigitFive=Qe.codePoint.codePointDigitFive;se.codePointDigitFour=Qe.codePoint.codePointDigitFour;se.codePointDigitNine=Qe.codePoint.codePointDigitNine;se.codePointDigitOne=Qe.codePoint.codePointDigitOne;se.codePointDigitSeven=Qe.codePoint.codePointDigitSeven;se.codePointDigitSix=Qe.codePoint.codePointDigitSix;se.codePointDigitThree=Qe.codePoint.codePointDigitThree;se.codePointDigitTwo=Qe.codePoint.codePointDigitTwo;se.codePointDigitZero=Qe.codePoint.codePointDigitZero;se.codePointDollarSign=Qe.codePoint.codePointDollarSign;se.codePointDoubleQuote=Qe.codePoint.codePointDoubleQuote;se.codePointEqualsSign=Qe.codePoint.codePointEqualsSign;se.codePointEuroSign=Qe.codePoint.codePointEuroSign;se.codePointExclamationMark=Qe.codePoint.codePointExclamationMark;se.codePointFullStop=Qe.codePoint.codePointFullStop;se.codePointFullwidthDigitNine=Qe.codePoint.codePointFullwidthDigitNine;se.codePointFullwidthDigitZero=Qe.codePoint.codePointFullwidthDigitZero;se.codePointFullwidthLatinCapitalA=Qe.codePoint.codePointFullwidthLatinCapitalA;se.codePointFullwidthLatinCapitalZ=Qe.codePoint.codePointFullwidthLatinCapitalZ;se.codePointFullwidthLatinSmallA=Qe.codePoint.codePointFullwidthLatinSmallA;se.codePointFullwidthLatinSmallZ=Qe.codePoint.codePointFullwidthLatinSmallZ;se.codePointGreaterThanSign=Qe.codePoint.codePointGreaterThanSign;se.codePointHash=Qe.codePoint.codePointHash;se.codePointInvertedExclamationMark=Qe.codePoint.codePointInvertedExclamationMark;se.codePointInvertedQuestionMark=Qe.codePoint.codePointInvertedQuestionMark;se.codePointLF=Qe.codePoint.codePointLF;se.codePointLeftCurlyBracket=Qe.codePoint.codePointLeftCurlyBracket;se.codePointLeftParen=Qe.codePoint.codePointLeftParen;se.codePointLeftSquareBracket=Qe.codePoint.codePointLeftSquareBracket;se.codePointLessThanSign=Qe.codePoint.codePointLessThanSign;se.codePointMinusSign=Qe.codePoint.codePointMinusSign;se.codePointPercentSign=Qe.codePoint.codePointPercentSign;se.codePointPipe=Qe.codePoint.codePointPipe;se.codePointPlusSign=Qe.codePoint.codePointPlusSign;se.codePointQuestionMark=Qe.codePoint.codePointQuestionMark;se.codePointRightCurlyBracket=Qe.codePoint.codePointRightCurlyBracket;se.codePointRightParen=Qe.codePoint.codePointRightParen;se.codePointRightSquareBracket=Qe.codePoint.codePointRightSquareBracket;se.codePointSemicolon=Qe.codePoint.codePointSemicolon;se.codePointSingleQuote=Qe.codePoint.codePointSingleQuote;se.codePointSlash=Qe.codePoint.codePointSlash;se.codePointSmallA=Qe.codePoint.codePointSmallA;se.codePointSmallB=Qe.codePoint.codePointSmallB;se.codePointSmallC=Qe.codePoint.codePointSmallC;se.codePointSmallD=Qe.codePoint.codePointSmallD;se.codePointSmallE=Qe.codePoint.codePointSmallE;se.codePointSmallF=Qe.codePoint.codePointSmallF;se.codePointSmallG=Qe.codePoint.codePointSmallG;se.codePointSmallH=Qe.codePoint.codePointSmallH;se.codePointSmallI=Qe.codePoint.codePointSmallI;se.codePointSmallJ=Qe.codePoint.codePointSmallJ;se.codePointSmallK=Qe.codePoint.codePointSmallK;se.codePointSmallL=Qe.codePoint.codePointSmallL;se.codePointSmallM=Qe.codePoint.codePointSmallM;se.codePointSmallN=Qe.codePoint.codePointSmallN;se.codePointSmallO=Qe.codePoint.codePointSmallO;se.codePointSmallP=Qe.codePoint.codePointSmallP;se.codePointSmallQ=Qe.codePoint.codePointSmallQ;se.codePointSmallR=Qe.codePoint.codePointSmallR;se.codePointSmallS=Qe.codePoint.codePointSmallS;se.codePointSmallT=Qe.codePoint.codePointSmallT;se.codePointSmallU=Qe.codePoint.codePointSmallU;se.codePointSmallV=Qe.codePoint.codePointSmallV;se.codePointSmallW=Qe.codePoint.codePointSmallW;se.codePointSmallX=Qe.codePoint.codePointSmallX;se.codePointSmallY=Qe.codePoint.codePointSmallY;se.codePointSmallZ=Qe.codePoint.codePointSmallZ;se.codePointSpace=Qe.codePoint.codePointSpace;se.codePointTab=Qe.codePoint.codePointTab;se.codePointThaiDigitNine=Qe.codePoint.codePointThaiDigitNine;se.codePointThaiDigitZero=Qe.codePoint.codePointThaiDigitZero;se.codePointTilde=Qe.codePoint.codePointTilde;se.codePointUnderscore=Qe.codePoint.codePointUnderscore});var xz=T(Sg=>{"use strict";p();Object.defineProperty(Sg,"__esModule",{value:!0});Sg.parseSignedLiteral=Sg.parseNumberLiteral=Sg.parseUint=Sg.isLineBreak=Sg.isSpace=void 0;var CXe=fe(),gve=jd(),Gq=pm(),qq=cT(),fd=iA(),ah=Lq(),hM=CXe.__importStar(vM()),Oz=S0(),TXe=hM.codePointSpace,vve=hM.codePointLF,kz=hM.codePointMinusSign,hve=hM.codePointPlusSign,RXe=hM.codePointSlash;function Mz(e){return e===TXe||e===vve}Sg.isSpace=Mz;function EXe(e){return e===vve}Sg.isLineBreak=EXe;function Bq(e,r,t,n){(0,Gq.assertIndex)("calc.parse.parseUint",r,16);for(var a=0,o=n,u=t.length;o<u;){var s=(0,fd.stringCodePointAt)(t,o);if(!e.isNumeral(s))break;var l=e.getOrdinal(s);a===0&&l!==0&&(u=(0,gve.fastMin)(u,o+r)),a=a*10+l,o+=(0,fd.numCodeUnits)(s)}return o===u&&o<t.length&&e.isNumeral((0,fd.stringCodePointAt)(t,o))?[0,n]:[a,o]}Sg.parseUint=Bq;function PXe(e,r,t){var n=t;if(n<r.length&&e.stringCompareCI("E",r.substring(n,n+1))===0)n+=1;else if((0,qq.stringStartsWith)(r,"**",n))n+=2;else return[0,t];var a=!1;if(n<r.length){var o=(0,fd.stringCodePointAt)(r,n);((a=o===kz)||o===hve)&&(n+=(0,fd.numCodeUnits)(o))}if(n>=r.length||!e.isNumeral((0,fd.stringCodePointAt)(r,n)))return!1;var u=2147483647,s=Bq(e,10,r,n),l=s[0],c=s[1];return c===n||l>u?!1:[a?-l:l,c]}function mve(e,r,t,n){var a=n,o=32767,u=Bq(e,5,t,a),s=u[0],l=u[1];if(l===a||s>o||(a=l,!(a<t.length&&t.charCodeAt(a)===RXe)))return!1;a+=1;var c=Bq(e,5,t,a),d=c[0],f=c[1];if(f===a||d>o)return!1;if(a=f,d===0)return[!1,0,a];var m=r.div(r.fromNumber(s),r.fromNumber(d));return(0,Gq.assertTrue)("calc.lang.tryTokenizeFrac",(0,Oz.isNumberOper)(m)),[m,d,a]}function AXe(e,r,t){for(var n=t,a="",o=0;o<r.length;){var u=(0,fd.stringCodePointAt)(r,o);if(e.isNumeral(u)){var s=(0,fd.numCodeUnits)(u);a+=r.substring(o,o+s),o+=s,n-=1;continue}if(n===0||!e.isThousandsPosition(n))return;o+=e.thousandsSeparator.length}return a}function Sve(e,r,t,n,a,o,u){var s=n,l=0,c="",d,f=!1,m=!1,v=0,h=0,y=ah.NumberShape.ASCII,_,E;if(!(!(0,qq.stringStartsWith)(t,e.decimalSeparator,n)&&!(n<t.length&&e.isNumeral((0,fd.stringCodePointAt)(t,n))))){for(var N=function(){if((o||a&&t.indexOf("%",s)>=0)&&(l-=2,d!==void 0)){var Z=r.div(d,r.fromNumber(100));(0,Gq.assertTrue)("calc.lang.parseNumberLiteral",(0,Oz.isNumberOper)(Z)),d=Z,E=ah.KnownFormat.Pct}if((0,gve.fastAbs)(l)>=309)return{value:void 0,i:s,consumedThousands:f,consumedDecimal:m,numDigDec:v,numShape:y,format:E};var J=r.parse(e,!0,l,c);if(d!==void 0){var C=r.add(J,d);(0,Gq.assertTrue)("calc.lang.parseNumberLiteral",(0,Oz.isNumberOper)(C)),J=C}return{value:J,i:s,consumedThousands:f,consumedDecimal:m,numDigDec:v,numShape:y,format:E}};s<t.length;){var k=(0,fd.stringCodePointAt)(t,s);if(!e.isNumeral(k)||e.getOrdinal(k)!==0)break;(_=e.getNumberShape(k))!==ah.NumberShape.ASCII&&(y=_),s+=(0,fd.numCodeUnits)(k)}if(u){var q=mve(e,r,t,s);if(q!==!1){var V=q[0],I=q[1],M=q[2];return s=M,V===!1?{value:void 0,i:s,consumedThousands:f,consumedDecimal:m,numDigDec:v,numShape:y,format:E}:(E=I>=10?ah.KnownFormat.FractBond:ah.KnownFormat.Fract,d=V,N())}}for(var B=s;s<t.length;){var k=(0,fd.stringCodePointAt)(t,s);if(e.isNumeral(k)){l+=1,(_=e.getNumberShape(k))!==ah.NumberShape.ASCII&&(y=_),s+=(0,fd.numCodeUnits)(k);continue}if(a&&l>0&&(0,qq.stringStartsWith)(t,e.thousandsSeparator,s)){f=!0,s+=e.thousandsSeparator.length;continue}break}if(c+=t.substring(B,s),f){var U=AXe(e,c,l);if(U===void 0)return;c=U}if(n<s&&s<t.length&&Mz(t.charCodeAt(s))){var q=mve(e,r,t,s+1);if(q!==!1){var V=q[0],I=q[1],M=q[2];return s=M,V===!1?{value:void 0,i:s,consumedThousands:f,consumedDecimal:m,numDigDec:v,numShape:y,format:E}:(E=I>=10?ah.KnownFormat.FractBond:ah.KnownFormat.Fract,d=V,N())}}var j=!1;if((0,qq.stringStartsWith)(t,e.decimalSeparator,s)&&(j=s===n,m=!0,s+=e.decimalSeparator.length),l===0)for(;s<t.length;){var k=(0,fd.stringCodePointAt)(t,s);if(!e.isNumeral(k)||e.getOrdinal(k)!==0)break;l-=1,(_=e.getNumberShape(k))!==ah.NumberShape.ASCII&&(y=_),h+=1,s+=(0,fd.numCodeUnits)(k)}for(B=s;s<t.length;){var k=(0,fd.stringCodePointAt)(t,s);if(!e.isNumeral(k))break;(_=e.getNumberShape(k))!==ah.NumberShape.ASCII&&(y=_),v+=1,s+=(0,fd.numCodeUnits)(k)}if(c+=t.substring(B,s),v>0&&(v+=h),!(j&&s<=n+e.decimalSeparator.length)){var X=PXe(e,t,s);if(X!==!1){var ee=X[0],M=X[1];l+=ee,M!==s&&(E=ah.KnownFormat.Exp),s=M}return X===!1?{value:void 0,i:s,consumedThousands:f,consumedDecimal:m,numDigDec:v,numShape:y,format:E}:N()}}}Sg.parseNumberLiteral=Sve;function FXe(e,r,t,n,a){var o=n,u=!1;if(o<t.length){var s=t.charCodeAt(o);if((s===hve||s===kz)&&(u=s===kz,o+=1,a))for(;o<t.length&&Mz(t.charCodeAt(o));)o+=1}var l=Sve(e,r,t,o,!1,!1,!1);return(l==null?void 0:l.value)===void 0?[r.zero,n]:(o=l.i,[u?r.neg(l.value):l.value,o])}Sg.parseSignedLiteral=FXe});var Wq=T(Qd=>{"use strict";p();Object.defineProperty(Qd,"__esModule",{value:!0});Qd.wrapPosition=Qd.parseQualifier=Qd.parseGridRangeA1=Qd.parseGridCellA1=Qd.parseCellRef=Qd.isR1C1IdentStart=Qd.SpecialPos=void 0;var NXe=fe(),yM=gg(),SM=jd(),Jl=Ep(),Iz=xz(),fT=NXe.__importStar(vM()),dT=cT(),Lz=iA(),Vq=yM.sheetRows,qz=Vq.toString(10).length,_M=yM.sheetCols,OXe=_M.toString(26).length,bve=_M.toString(10).length,Cve=fT.codePointCapitalA,kXe=fT.codePointCapitalZ,wz=fT.codePointSmallA,MXe=fT.codePointSmallZ,xXe=fT.codePointPlusSign,IXe=fT.codePointMinusSign,Dz=fT.codePointColon;function yve(e){return e>=wz&&e<=MXe||e>=Cve&&e<=kXe}function wXe(e){return(e>=wz?e-wz:e-Cve)+1}function DXe(e,r,t){for(var n=0,a=t,o=(0,SM.fastMin)(r.length,t+e);a<o;a+=1){var u=r.charCodeAt(a);if(!yve(u))break;n=n*26+wXe(u)}return a===o&&a<r.length&&yve(r.charCodeAt(a))?[0,t]:[n,a]}function LXe(e,r){return(0,dT.stringStartsWith)(e,"$",r)?[Jl.PosKind.Abs,r+1]:[Jl.PosKind.Rel,r]}function Tve(e,r,t,n){return function(a,o,u,s,l){var c=LXe(u,s),d=c[0],f=c[1],m=e(a,t,u,f),v=m[0],h=m[1];if(h>f){if(v<1||v>r)return d===Jl.PosKind.Abs||(n===!0?typeof l=="object"&&l.kind===Jl.PosKind.Abs||l===mb.A1BadDollar:(0,dT.stringStartsWith)(u,"$",h))?[mb.A1BadDollar,!0,h]:void 0;var y=d===Jl.PosKind.Rel?v-o:v;return[(0,Jl.pos)(d,y-1),d===Jl.PosKind.Abs,h]}return d===Jl.PosKind.Abs&&(n===!0||h===u.length||!a.isNumeral((0,Lz.stringCodePointAt)(u,h)))?[mb.A1BadDollar,!0,h]:[void 0,!1,s]}}function _ve(e,r,t){var n=Eve(e,r,t);return n-e}function jq(e,r,t,n){return function(a,o,u,s){var l=r?e?"R":a.rowLetter:e?"C":a.columnLetter;if(s>=u.length||a.stringCompareCI(l,u[s])!==0)return[void 0,!1,s];var c=s+l.length,d=(0,Iz.parseUint)(a,n,u,c),f=d[0],m=d[1];if(m>c&&f>=1&&f<=t)return[(0,Jl.pos)(Jl.PosKind.Abs,f-1),!1,m];if((0,dT.stringStartsWith)(u,a.rcLeftBracket,c)){if(c+=a.rcLeftBracket.length,(0,dT.stringStartsWith)(u,a.rcRightBracket,c))return[(0,Jl.pos)(Jl.PosKind.Rel,_ve(o,0,t)),!0,c+a.rcRightBracket.length];var v=1,h=u.charCodeAt(c);h===xXe?c+=1:h===IXe&&(v=-1,c+=1);var y=(0,Iz.parseUint)(a,n,u,c),_=y[0],E=y[1];if(E>c&&_<t&&(0,dT.stringStartsWith)(u,a.rcRightBracket,E))return[(0,Jl.pos)(Jl.PosKind.Rel,_ve(o,_*v,t)),!0,E+a.rcRightBracket.length]}return[mb.RCNoNum,!1,s+l.length]}}function oA(e,r,t,n,a,o,u){var s=n(e,r,o,u,void 0);if(s==null)return[void 0,void 0,u];var l=s[0],c=s[1],d=s[2];if(d>u){var f=a(e,t,o,d,l);if(f==null)return c?[l,void 0,d]:[void 0,void 0,u];var m=f[0],v=f[2];return v>d?[l,m,v]:[l,void 0,d]}var h=a(e,t,o,u,l);if(h==null)return[void 0,void 0,u];var y=h[0],_=h[2];return _>u?[void 0,y,_]:[void 0,void 0,u]}var Uq=Tve(Iz.parseUint,Vq,qz,!0),Kq=Tve(function(e,r,t,n){return DXe(r,t,n)},_M,OXe,!1),qXe=jq(!1,!0,Vq,qz),GXe=jq(!1,!1,_M,bve),BXe=jq(!0,!0,Vq,qz),UXe=jq(!0,!1,_M,bve),mb;(function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"})(mb||(Qd.SpecialPos=mb={}));function Rve(e,r){return typeof e!="object"&&typeof r!="object"}Qd.isR1C1IdentStart=Rve;function KXe(e,r,t,n,a){var o=t.col,u=t.row,s=oA(e,o,u,Kq,Uq,n,a),l=s[0],c=s[1],d=s[2],f=typeof c=="object"&&c.kind===Jl.PosKind.Abs||c===mb.A1BadDollar||typeof l=="object"&&l.kind===Jl.PosKind.Abs||l===mb.A1BadDollar;if(c!=null&&l!=null||f||(c!=null||l!=null)&&(a-1>=0&&n.charCodeAt(a-1)===Dz||d<n.length&&n.charCodeAt(d)===Dz))return d<n.length&&e.isIdentContinue((0,Lz.stringCodePointAt)(n,d))||r!==Jl.RefStyle.A1&&!f?void 0:{refStyle:Jl.RefStyle.A1,row:c,col:l,i:d}}function VXe(e,r,t,n,a){var o,u=t.col,s=t.row,l=!1,c=oA(e,s,u,qXe,GXe,n,a),d=c[0],f=c[1],m=c[2];if(d==null&&f==null&&(e.rowLetter!=="R"||e.columnLetter!=="C")&&(l=!0,o=oA(e,s,u,BXe,UXe,n,a),d=o[0],f=o[1],m=o[2]),(d!=null||f!=null)&&(m>=n.length||!Rve(d,f)||!e.isIdentContinue((0,Lz.stringCodePointAt)(n,m))))return{refStyle:Jl.RefStyle.R1C1,row:d,col:f,i:m,enLocale:l}}function jXe(e,r,t,n,a){var o=KXe(e,r,t,n,a);return o!==void 0?o:VXe(e,r,t,n,a)}Qd.parseCellRef=jXe;function WXe(e,r){var t=oA(e,0,0,Kq,Uq,r,0),n=t[0],a=t[1],o=t[2];return typeof n=="object"&&typeof a=="object"&&o===r.length?(0,yM.gridCell)(a.index,n.index):void 0}Qd.parseGridCellA1=WXe;function HXe(e,r){var t=oA(e,0,0,Kq,Uq,r,0),n=t[0],a=t[1],o=t[2];if(!(typeof n!="object"||typeof a!="object")){if(o===r.length)return(0,yM.gridCell)(a.index,n.index);if(r.charCodeAt(o)===Dz){var u=oA(e,0,0,Kq,Uq,r,o+1),s=u[0],l=u[1],c=u[2];if(!(typeof s!="object"||typeof l!="object")&&c===r.length){var d=(0,SM.fastMin)(a.index,l.index),f=(0,SM.fastMin)(n.index,s.index);return(0,yM.gridRange)(d,f,(0,SM.fastMax)(a.index,l.index)+1-d,(0,SM.fastMax)(n.index,s.index)+1-f)}}}}Qd.parseGridRangeA1=HXe;function zXe(e){var r=e.lastIndexOf("!");if(!(r<0||r===0||r===e.length-1)){var t=e.substring(0,r),n=e.substring(r+1);if(t.indexOf("'")<0)return{qualifier:t,unqualified:n};if(!(!(0,dT.stringStartsWith)(t,"'")||!(0,dT.stringEndsWith)(t,"'"))){for(var a=[],o=1;o<t.length-1;++o){var u=t.charAt(o);if(u!=="'"){a.push(u);continue}if(o+1>=t.length-1||t.charAt(o+1)!=="'")return;a.push(u),++o}return{qualifier:a.join(""),unqualified:n}}}}Qd.parseQualifier=zXe;function Eve(e,r,t){return e+r&t-1}Qd.wrapPosition=Eve});var CM=T(pn=>{"use strict";p();Object.defineProperty(pn,"__esModule",{value:!0});pn.formatName=pn.formatGridRange=pn.quoteQualifier=pn.formatQualifier=pn.shouldQuoteQualifier=pn.canonicaliseRangePos=pn.formatRangePos=pn.canonicaliseCellPos=pn.formatCellPos=pn.canonicaliseColRange=pn.canonicaliseRowRange=pn.formatColRange=pn.formatRowRange=pn.canonicaliseCol=pn.canonicaliseRow=pn.formatCol=pn.formatRow=pn.resolvePosition=pn.canonicaliseBrackets=pn.columnName=void 0;var QXe=fe(),Ns=gg(),Ei=Ep(),Gz=Wq(),XXe=pm(),Ave=QXe.__importStar(vM()),pT=iA(),Pve=cT(),Fve=(0,Ei.pos)(Ei.PosKind.Abs,0),Nve=(0,Ei.pos)(Ei.PosKind.Abs,Ns.sheetRows-1),YXe=Ave.codePointCapitalA,JXe=Ave.codePointFullStop;function Ove(e){for(var r=e+1,t="";r>0;){var n=(r-1)%26;t=String.fromCharCode(YXe+n)+t,r=Math.floor((r-n)/26)}return t}pn.columnName=Ove;function ZXe(e,r){return e===Ei.RefStyle.R1C1&&r.kind===Ei.PosKind.Rel&&r.index!==0}pn.canonicaliseBrackets=ZXe;function mT(e,r,t,n){if(r.kind===Ei.PosKind.Abs)return r.index;if(n)return(0,Gz.wrapPosition)(e,r.index,t);var a=e+r.index;return 0<=a&&a<t?a:void 0}pn.resolvePosition=mT;function $Xe(e,r,t){var n=mT(e,r,Ns.sheetCols,t);if(n!==void 0){var a=Ove(n);return r.kind===Ei.PosKind.Abs?"$"+a:a}}function eYe(e,r,t){var n=mT(e,r,Ns.sheetRows,t);if(n!==void 0){var a=(n+1).toFixed();return r.kind===Ei.PosKind.Abs?"$"+a:a}}function kve(e,r,t,n,a,o){var u=mT(t,n,a,o);if(u!==void 0){if(n.kind===Ei.PosKind.Abs)return r+(u+1).toFixed();var s=u-t;return s===0?r:r+e.rcLeftBracket+s.toFixed()+e.rcRightBracket}}function Uz(e,r,t,n,a){return r===Ei.RefStyle.A1?eYe(t,n,a):kve(e,e.rowLetter,t,n,Ns.sheetRows,a)}pn.formatRow=Uz;function Kz(e,r,t,n,a){return r===Ei.RefStyle.A1?$Xe(t,n,a):kve(e,e.columnLetter,t,n,Ns.sheetCols,a)}pn.formatCol=Kz;function Hq(e,r,t,n){if(t.kind===Ei.PosKind.Abs)return t;var a=mT(r,t,e,n);if(a!==void 0){var o=a-r;return o===t.index?t:(0,Ei.pos)(Ei.PosKind.Rel,o)}}pn.canonicaliseRow=Hq.bind(void 0,Ns.sheetRows);pn.canonicaliseCol=Hq.bind(void 0,Ns.sheetCols);function uA(e,r,t,n,a){var o=mT(e,r,n,a),u=mT(e,t,n,a);if(!(o===void 0||u===void 0))return o<=u?[r,t,o,u]:[t,r,u,o]}function Mve(e,r,t,n,a,o,u,s,l){var c=uA(o,u,s,t,l);if(c!==void 0){var d=c[0],f=c[1],m=c[2],v=c[3];if(r!==void 0&&m===0&&v===t-1&&u.kind===s.kind)return r(n,a,l);var h=e(n,a,o,d,l);if(h!==void 0){if(a===Ei.RefStyle.R1C1&&d.kind===f.kind&&d.index===f.index)return h;var y=e(n,a,o,f,l);if(y!==void 0)return h+":"+y}}}pn.formatRowRange=Mve.bind(void 0,Uz,void 0,Ns.sheetRows);pn.formatColRange=Mve.bind(void 0,Kz,function(e,r,t){return(0,pn.formatRowRange)(e,r,0,Fve,Nve,t)},Ns.sheetCols);function xve(e,r,t,n,a,o){var u=uA(t,n,a,r,o);if(u!==void 0){var s=u[0],l=u[1],c=u[2],d=u[3];if(e!==void 0&&c===0&&d===r-1&&n.kind===a.kind)return e;var f=Hq(r,t,s,o),m=Hq(r,t,l,o);if(!(f===void 0||m===void 0))return[!1,f,m]}}pn.canonicaliseRowRange=xve.bind(void 0,void 0,Ns.sheetRows);pn.canonicaliseColRange=xve.bind(void 0,[!0,Fve,Nve],Ns.sheetCols);function zq(e,r,t,n,a,o){var u=Uz(e,r,t.row,n,o),s=Kz(e,r,t.col,a,o);if(!(u===void 0||s===void 0))return r===Ei.RefStyle.A1?s+u:u+s}pn.formatCellPos=zq;function rYe(e,r,t,n){var a=(0,pn.canonicaliseRow)(e.row,r,n),o=(0,pn.canonicaliseCol)(e.col,t,n);if(!(a===void 0||o===void 0))return{row:a,col:o}}pn.canonicaliseCellPos=rYe;function Ive(e,r,t,n,a,o,u,s){var l=uA(t.row,n,o,Ns.sheetRows,s),c=uA(t.col,a,u,Ns.sheetCols,s);if(!(l===void 0||c===void 0)){var d=l[0],f=l[1],m=l[2],v=l[3],h=c[0],y=c[1],_=c[2],E=c[3];if(_===0&&E===Ns.sheetCols-1&&a.kind===u.kind)return(0,pn.formatRowRange)(e,r,t.row,d,f,s);if(m===0&&v===Ns.sheetRows-1&&n.kind===o.kind)return(0,pn.formatColRange)(e,r,t.col,h,y,s);var N=zq(e,r,t,d,h,s),k=zq(e,r,t,f,y,s);if(!(N===void 0||k===void 0))return N+":"+k}}pn.formatRangePos=Ive;function tYe(e,r,t,n,a,o){var u=uA(e.row,r,n,Ns.sheetRows,o),s=uA(e.col,t,a,Ns.sheetCols,o);if(!(u===void 0||s===void 0)){var l=u[0],c=u[1],d=u[2],f=u[3],m=s[0],v=s[1],h=s[2],y=s[3],_=(0,pn.canonicaliseRow)(e.row,l,o),E=(0,pn.canonicaliseCol)(e.col,m,o),N=(0,pn.canonicaliseRow)(e.row,c,o),k=(0,pn.canonicaliseCol)(e.col,v,o);if(!(_===void 0||E===void 0||N===void 0||k===void 0))return h===0&&y===Ns.sheetCols-1&&t.kind===a.kind?{row1:_,row2:N,col1:void 0,col2:void 0}:d===0&&f===Ns.sheetRows-1&&r.kind===n.kind?{col1:E,col2:k,row1:void 0,row2:void 0}:{row1:_,col1:E,row2:N,col2:k}}}pn.canonicaliseRangePos=tYe;function Bz(e,r){return r===JXe||e.isIdentContinue(r)}var nYe=/'/g;function bM(e,r){if(r.length===0)return!1;var t=0,n=(0,pT.stringCodePointAt)(r,t);if(!e.isIdentStart(n))return!1;t+=(0,pT.numCodeUnits)(n);for(var a=0,o=(0,pT.codePointIterator)(r,t);a<o.length;a++){var u=o[a];if(!Bz(e,u))return!1}return!0}function aYe(e,r){var t=0;if(!(0,Pve.stringStartsWith)(r,e.leftBracket,t)||(t+=e.leftBracket.length,t===r.length))return!1;var n=(0,pT.stringCodePointAt)(r,t);if(!Bz(e,n))return!1;for(t+=(0,pT.numCodeUnits)(n);;){if((0,Pve.stringStartsWith)(r,e.rightBracket,t)){t+=e.rightBracket.length;break}if(t===r.length)return!1;var a=(0,pT.stringCodePointAt)(r,t);if(!Bz(e,a))return!1;t+=(0,pT.numCodeUnits)(a)}var o=r.indexOf(":",t);return o<0?bM(e,r.substring(t)):bM(e,r.substring(t,o))&&bM(e,r.substring(o+1))}function iYe(e,r){var t=e.leftBracket.length,n=e.rightBracket.length;return r.length<t+n||r.substring(0,t)!==e.leftBracket||r.substring(r.length-n)!==e.rightBracket?!1:bM(e,r.substring(t,r.length-n))}var oYe=(0,Ns.gridCell)(0,0);function Qq(e,r,t){if(e.stringCompareCI(t,e.trueName)===0||e.stringCompareCI(t,e.falseName)===0)return!0;var n=(0,Gz.parseCellRef)(e,r,oYe,t,0);if(n!==void 0){if(n.refStyle===Ei.RefStyle.A1){var a=n.i;if(a>=t.length&&e.getWorksheetFuncId(t.substring(0,a))===void 0)return!0}else if(!(0,Gz.isR1C1IdentStart)(n.row,n.col))return!0}return!(bM(e,t)||aYe(e,t)||iYe(e,t))}pn.shouldQuoteQualifier=Qq;function Vz(e,r,t){return Qq(e,r,t)?jz(t):t}pn.formatQualifier=Vz;function jz(e){return"'".concat(e.replace(nYe,"''"),"'")}pn.quoteQualifier=jz;function uYe(e,r,t,n,a){t===void 0&&(t=Ei.RefStyle.A1);var o=r.cols===1&&r.rows===1?zq(e,t,(0,Ns.gridCell)(0,0),(0,Ei.pos)(Ei.PosKind.Rel,r.row),(0,Ei.pos)(Ei.PosKind.Rel,r.col),!1):Ive(e,t,(0,Ns.gridCell)(0,0),(0,Ei.pos)(Ei.PosKind.Rel,r.row),(0,Ei.pos)(Ei.PosKind.Rel,r.col),(0,Ei.pos)(Ei.PosKind.Rel,r.row+r.rows-1),(0,Ei.pos)(Ei.PosKind.Rel,r.col+r.cols-1),!1);if((0,XXe.assertTrue)("calc.lang.formatGridRange",o!==void 0),n===void 0&&a===void 0)return o;if(n===void 0||a===void 0)return Vz(e,t,n??a)+"!"+o;var u=n+":"+a;return(Qq(e,t,n)||Qq(e,t,a)?jz(u):u)+"!"+o}pn.formatGridRange=uYe;function sYe(e,r,t,n){return t===void 0&&(t=Ei.RefStyle.A1),n===void 0?r:Vz(e,t,n)+"!"+r}pn.formatName=sYe});var sA=T(Sa=>{"use strict";p();Object.defineProperty(Sa,"__esModule",{value:!0});Sa.resolvedDottedName=Sa.resolvedNever=Sa.resolvedStructRef=Sa.resolvedLocalName=Sa.resolvedWorksheetFunc=Sa.resolvedUserDefinedFunc=Sa.resolvedCellRef=Sa.resolvedName=Sa.ResolvedKind=Sa.emptyIntersection=Sa.invalidStructRef=Sa.InvalidStructRefReason=Sa.invalidCellRef=Sa.InvalidCellRefReason=Sa.invalidQualifier=Sa.InvalidQualifierReason=Sa.noOriginSheet=Sa.ResolveReasonKind=Sa.resolveLocalsGrid=void 0;var Wz=oT(),gb=jd();function lYe(e){return{originGridCell:(0,Wz.success)(e.range),originSheet:(0,Wz.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}Sa.resolveLocalsGrid=lYe;var gT;(function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"})(gT||(Sa.ResolveReasonKind=gT={}));function cYe(e){return{kind:gT.NoOriginSheet,origin:e}}Sa.noOriginSheet=cYe;var wve;(function(e){e.UndefinedDocument="UndefinedDocument",e.UndefinedSheetName="UndefinedSheetName",e.SheetRangeName="SheetRangeName",e.DocumentCellRef="DocumentCellRef",e.BadQualifier="BadQualifier"})(wve||(Sa.InvalidQualifierReason=wve={}));function dYe(e){return{kind:gT.InvalidQualifier,reason:e}}Sa.invalidQualifier=dYe;var Dve;(function(e){e.BadCellRef="BadCellRef"})(Dve||(Sa.InvalidCellRefReason=Dve={}));function fYe(e){return{kind:gT.InvalidCellRef,reason:e}}Sa.invalidCellRef=fYe;var Lve;(function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidOp="InvalidOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"})(Lve||(Sa.InvalidStructRefReason=Lve={}));function pYe(e){return{kind:gT.InvalidStructRef,reason:e}}Sa.invalidStructRef=pYe;Sa.emptyIntersection={kind:gT.EmptyIntersection};var _0;(function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedWorksheetFunc="ResolvedWorksheetFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"})(_0||(Sa.ResolvedKind=_0={}));Sa.resolvedName=(0,gb.typedInstanceCreator)()(function(e,r,t,n){return{kind:_0.ResolvedName,node:e,resolution:r,qualifierResolution:t,precedents:n}});Sa.resolvedCellRef=(0,gb.typedInstanceCreator)()(function(e,r){return{kind:_0.ResolvedCellRef,node:e,resolution:r}});Sa.resolvedUserDefinedFunc=(0,gb.typedInstanceCreator)()(function(e,r,t,n){return{kind:_0.ResolvedUserDefinedFunc,node:e,resolution:r,precedents:t,name:n}});Sa.resolvedWorksheetFunc=(0,gb.typedInstanceCreator)()(function(e,r){return{kind:_0.ResolvedWorksheetFunc,node:e,resolution:r}});Sa.resolvedLocalName=(0,gb.typedInstanceCreator)()(function(e,r){return{kind:_0.ResolvedLocalName,node:e,resolution:r}});Sa.resolvedStructRef=(0,gb.typedInstanceCreator)()(function(e,r,t,n){return{kind:_0.ResolvedStructRef,node:e,table:r,resolution:t,precedents:n}});Sa.resolvedNever=(0,gb.typedInstanceCreator)()(function(e){return{kind:_0.ResolvedNever,node:e,resolution:Wz.successUndefined}});Sa.resolvedDottedName=(0,gb.typedInstanceCreator)()(function(e,r,t,n){return{kind:_0.ResolvedDottedName,node:e,headResolved:r,fieldsResolved:t,precedents:n}})});var Yq=T(yg=>{"use strict";p();Object.defineProperty(yg,"__esModule",{value:!0});yg.createResolver=yg.resolveGridRef=yg.canDenoteCellRef=yg.canDenoteUserDefinedFunc=yg.canDenoteLocalName=void 0;var qve=jd(),lA=jd(),cA=pm(),mYe=CM(),tr=Ep(),Hz=S0(),vy=S0(),zz=gg(),ui=gg(),cr=oT(),gYe=sA(),nt=sA(),Gve=Tz();function Xq(e){return(0,cr.isSuccess)(e)&&(0,lA.isNone)(e.value)?cr.successUndefined:e}function Pp(e){return!(0,cr.isSuccess)(e)||e.value===void 0}var Uve=function(r){return r.rhs.field.kind===tr.NodeKind.Ident},Bve=function(r){return r.rhs.field.whole},vYe=function(r,t){return(0,tr.fieldRefNamePart)(r,t.rhs,t.canDenoteNamedObject,t.label,t.qualifiedLabel)};function Kve(e,r){var t=r[0],n=r.slice(1);return t.kind===tr.NamePartKind.IdentNamePart&&e==null&&n.every(Uve)}yg.canDenoteLocalName=Kve;function Vve(e,r,t){return t.canDenoteNamedObject&&e&&(r===void 0||r.kind===tr.QualifierKind.Document||r.kind===tr.QualifierKind.Ident)}yg.canDenoteUserDefinedFunc=Vve;function jve(e,r,t){var n=t[0],a=t.slice(1);return n.kind===tr.NamePartKind.CellRefNamePart&&(r==null&&e.allowUnqualifiedCell||r!=null&&r.kind!==tr.QualifierKind.Document)&&a.every(Uve)}yg.canDenoteCellRef=jve;function dA(e,r,t,n,a){return t.kind===tr.PosKind.Abs?(0,cr.success)(t.index):(0,cr.isSuccess)(e)?(0,cr.success)((0,mYe.resolvePosition)(r(e.value),t,n,a)):e}var Xz=function(r){var t=r.row;return t},Yz=function(r){var t=r.col;return t};function Qz(e,r,t){var n=dA(e,Xz,r.row,ui.sheetRows,t),a=dA(e,Yz,r.col,ui.sheetCols,t);return(0,cr.isSuccess)(n)?(0,cr.isSuccess)(a)?n.value===void 0||a.value===void 0?cr.successUndefined:(0,cr.success)((0,ui.gridCell)(n.value,a.value)):a:n}function Jz(e,r){if(r.kind===tr.CellRefKind.Error)return cr.successUndefined;var t=e.originGridCell,n=e.wrapCellReferences;switch(r.kind){case tr.CellRefKind.Single:return Qz(t,r,n);case tr.CellRefKind.Range:{var a=Qz(t,r.ref1,n),o=Qz(t,r.ref2,n);return(0,cr.isSuccess)(a)?(0,cr.isSuccess)(o)?a.value===void 0||o.value===void 0?cr.successUndefined:(0,cr.success)((0,vy.gridCellRange)(a.value,o.value)):o:a}case tr.CellRefKind.Row:{var u=dA(t,Xz,r.row1,ui.sheetRows,n),s=dA(t,Xz,r.row2,ui.sheetRows,n);return(0,cr.isSuccess)(u)?(0,cr.isSuccess)(s)?u.value===void 0||s.value===void 0?cr.successUndefined:(0,cr.success)((0,vy.gridCellRange)((0,ui.gridCell)(u.value,0),(0,ui.gridCell)(s.value,ui.sheetCols-1))):s:u}case tr.CellRefKind.Col:{var l=dA(t,Yz,r.col1,ui.sheetCols,n),c=dA(t,Yz,r.col2,ui.sheetCols,n);return(0,cr.isSuccess)(l)?(0,cr.isSuccess)(c)?l.value===void 0||c.value===void 0?cr.successUndefined:(0,cr.success)((0,vy.gridCellRange)((0,ui.gridCell)(0,l.value),(0,ui.gridCell)(ui.sheetRows-1,c.value))):c:l}case tr.CellRefKind.Bad:return(0,cr.failure)((0,nt.invalidCellRef)(nt.InvalidCellRefReason.BadCellRef));default:return(0,cA.assertNever)("calc.lang.Resolver.resolveGridRef",r)}}yg.resolveGridRef=Jz;function hYe(e){function r(I,M){if(M===void 0){var B=I.originSheet;return(0,cr.isSuccess)(B)?[M,(0,cr.success)(B.value.document)]:[M,B]}var U=e.getDocumentLoc(M.path,M.document);if(!(0,cr.isSuccess)(U))return[M,U];if((0,lA.isNone)(U.value))return[M,(0,cr.failure)((0,nt.invalidQualifier)(nt.InvalidQualifierReason.UndefinedDocument))];var j=M.path==null?void 0:U.value.path,X=U.value.name;return[(0,tr.documentQualifier)(X,j,M.isQuoted,M.label),(0,cr.success)(U.value)]}function t(I,M){if(Pp(M))return[I,M];var B=Xq(e.getSheetIndex(M.value,I));if(!(0,cr.isSuccess)(B))return[I,B];if((0,lA.isNone)(B.value))return[I,(0,cr.failure)((0,nt.invalidQualifier)(nt.InvalidQualifierReason.UndefinedSheetName))];var U=e.getSheetName(M.value,B.value);return(0,cr.isSuccess)(U)?[U.value,(0,cr.success)((0,ui.sheetIndex)(M.value,B.value))]:[I,U]}function n(I,M){var B=r(I,M.document),U=B[0],j=B[1],X=t(M.sheet,j),ee=X[0],re=X[1];return[(0,tr.sheetQualifier)(ee,U,M.isQuoted,M.label),re]}function a(I,M){var B=r(I,M.document),U=B[0],j=B[1],X=t(M.sheet1,j),ee=X[0],re=X[1],Z=t(M.sheet2,j),J=Z[0],C=Z[1],S=ee,b=J,O;if(Pp(j))O=j;else if(Pp(re))O=re;else if(Pp(C))O=C;else{if((0,vy.isSheetIndexEqual)(re.value,C.value))return[(0,tr.sheetQualifier)(S,U,M.isQuoted,M.label),(0,cr.success)((0,ui.sheetIndex)(j.value,re.value.index))];var w=e.getSheetRangeIndexes(re.value),D=e.getSheetRangeIndexes(C.value);(0,cr.isSuccess)(w)?(0,cr.isSuccess)(D)?D.value.position<w.value.position&&(S=J,b=ee):O=D:O=w,O=(0,cr.success)((0,ui.sheetRange)(j.value,re.value.index,C.value.index))}return[(0,tr.sheetRangeQualifier)(S,b,U,M.isQuoted,M.label),O]}function o(I,M){switch(M.kind){case tr.QualifierKind.Error:return[M,cr.successUndefined];case tr.QualifierKind.Sheet:return n(I,M);case tr.QualifierKind.SheetRange:return a(I,M);case tr.QualifierKind.Document:return[M,(0,cr.failure)((0,nt.invalidQualifier)(nt.InvalidQualifierReason.SheetRangeName))];case tr.QualifierKind.Bad:return[M,(0,cr.failure)((0,nt.invalidQualifier)(nt.InvalidQualifierReason.BadQualifier))];default:return(0,cA.assertNever)("calc.lang.Resolver.resolveCellRefQualifier",M)}}function u(I,M){var B,U=M.qualifier,j=M.ref,X=Jz(I,j),ee,re;if(U===void 0||U.kind===tr.QualifierKind.Relative){ee=U;var Z=I.originSheet;if(!(0,cr.isSuccess)(Z))re=Z;else{var J=Z.value;J.index===void 0?re=(0,cr.failure)((0,nt.noOriginSheet)(J)):re=(0,cr.success)(J)}}else B=o(I,U),ee=B[0],re=B[1];var C;return Pp(X)?C=X:Pp(re)?C=re:C=(0,cr.success)((0,ui.sheetGridCube)(re.value,X.value)),(0,nt.resolvedCellRef)((0,tr.cellRefNode)(j,ee,M.label),C)}function s(I,M){switch(M.kind){case tr.QualifierKind.Document:{var B=r(I,M),U=B[0],j=B[1];return[U,U.kind,Pp(j)?j:(0,cr.success)((0,ui.documentScope)(j.value))]}case tr.QualifierKind.Sheet:{var X=n(I,M),ee=X[0],re=X[1];return[ee,ee.kind,re]}case tr.QualifierKind.SheetRange:return[M,M.kind,(0,cr.failure)((0,nt.invalidQualifier)(nt.InvalidQualifierReason.SheetRangeName))];case tr.QualifierKind.Ident:{var Z=(0,tr.sheetQualifier)(M.name,void 0,M.isQuoted,M.label),J=n(I,Z),ee=J[0],re=J[1];if(!(0,cr.isSuccess)(re)&&re.reason.kind!==nt.ResolveReasonKind.InvalidQualifier)return[M,M.kind,re];if((0,cr.isSuccess)(re)&&re.value!==void 0)return[(0,tr.identQualifier)(ee.sheet,ee.isQuoted,ee.label),ee.kind,re];var C=(0,tr.documentQualifier)(M.name,void 0,M.isQuoted,M.label),S=r(I,C),U=S[0],j=S[1];return Pp(j)?[M,M.kind,j]:[(0,tr.identQualifier)(U.document,U.isQuoted,U.label),U.kind,(0,cr.success)((0,ui.documentScope)(j.value))]}case tr.QualifierKind.Bad:return[M,M.kind,(0,cr.failure)((0,nt.invalidQualifier)(nt.InvalidQualifierReason.BadQualifier))];default:return(0,cA.assertNever)("calc.lang.Resolver.resolveNameQualifier",M)}}function l(I,M){switch(M.kind){case tr.QualifierKind.Document:return r(I,M);case tr.QualifierKind.Ident:{var B=(0,tr.documentQualifier)(M.name,void 0,M.isQuoted,M.label),U=r(I,B),j=U[0],X=U[1];return[(0,tr.identQualifier)(j.document,j.isQuoted,j.label),X]}default:return(0,cA.assertNever)("calc.lang.Resolver.resolveUserDefinedFuncQualifier",M)}}function c(I,M,B){var U,j,X,ee=M.qualifier,re=M.parts,Z,J,C,S=[];if(ee===void 0||ee.kind===tr.QualifierKind.Relative){var b=I.originSheet;if(!(0,cr.isSuccess)(b))return(0,nt.resolvedName)(M,b,(j=M.qualifier)===null||j===void 0?void 0:j.kind,S);var O=b.value;if(B!==ui.NameSource.StructRef&&O.index===void 0)return(0,nt.resolvedName)(M,(0,cr.failure)((0,nt.noOriginSheet)(O)),(X=M.qualifier)===null||X===void 0?void 0:X.kind,S);Z=ee,C=ee==null?void 0:ee.kind,J=(0,cr.success)(O)}else U=s(I,ee),Z=U[0],C=U[1],J=U[2];B===ui.NameSource.StructRef&&(0,cr.isSuccess)(J)&&J.value.index!==void 0&&(J=(0,cr.success)((0,ui.documentScope)(J.value.document)));var w=re,D;return Pp(J)?D=J:(S.push((0,zz.nameLoc)(J.value,re.asWhole)),D=Xq(e.getNameLoc(J.value,re.asWhole,B)),(0,cr.isSuccess)(D)&&D.value===void 0&&J.value.index!==void 0&&(J=(0,cr.success)((0,ui.documentScope)(J.value.document)),S.push((0,zz.nameLoc)(J.value,re.asWhole)),D=Xq(e.getNameLoc(J.value,re.asWhole,B))),Pp(D)||(w=(0,tr.identNamePart)(D.value.name,re.canDenoteNamedObject,re.label,re.qualifiedLabel))),(0,nt.resolvedName)((0,tr.nameNode)(w,Z,M.label),D,C,S)}function d(I,M,B){B===void 0&&(B=!1);var U=e.getStructRefColumn(I,M.name);if(!(0,cr.isSuccess)(U))return{kind:tr.StructRefKind.ColumnRef,innerRef:M,resolution:U};var j=U.value;if((0,lA.isNone)(j))return{kind:tr.StructRefKind.ColumnRef,innerRef:M,resolution:(0,cr.failure)((0,nt.invalidStructRef)(nt.InvalidStructRefReason.UndefinedColumnName))};var X=j.range.range;return B&&(X=(0,ui.gridRange)(X.row-(j.hasHeadersRow?1:0),X.col,X.rows+(j.hasHeadersRow?1:0)+(j.hasTotalsRow?1:0),X.cols)),{kind:tr.StructRefKind.ColumnRef,innerRef:(0,tr.columnRef)(j.name,M.isBracketed,M.isClosed,M.label),resolution:(0,cr.success)((0,ui.sheetGridRange)(j.range.sheet,X))}}function f(I,M,B){if(B===tr.SpecialRefId.ThisRow){if(!(0,cr.isSuccess)(I.originGridCell))return I.originGridCell;var U=f(I,M,tr.SpecialRefId.Data);if(Pp(U))return U;var j=U.value.range,X=I.originGridCell.value.row;return X<j.row||X>=j.row+j.rows?(0,cr.failure)(nt.emptyIntersection):(0,cr.success)((0,ui.sheetGridRange)(U.value.sheet,(0,ui.gridRange)(X,j.col,1,j.cols)))}return Xq(e.getStructRefSpecialRef(M,B))}function m(I,M,B){switch(M.kind){case tr.StructRefKind.ColumnRef:return d(I,M,B);case tr.StructRefKind.MissingRef:return{kind:tr.StructRefKind.MissingRef,innerRef:M,resolution:cr.successUndefined}}}function v(I,M,B){var U;B===void 0&&(B=!1);var j=m(I,M.lhs,B),X=j.innerRef,ee=j.resolution,re=m(I,M.rhs,B),Z=re.innerRef,J=re.resolution,C=(0,tr.rangeOpRef)(X,Z,M.label);if(!(0,cr.isSuccess)(ee)&&ee.reason.kind!==nt.ResolveReasonKind.InvalidStructRef)return{kind:tr.StructRefKind.RangeOpRef,innerRef:C,resolution:ee};if(!(0,cr.isSuccess)(J)&&J.reason.kind!==nt.ResolveReasonKind.InvalidStructRef)return{kind:tr.StructRefKind.RangeOpRef,innerRef:C,resolution:J};if(!(0,cr.isSuccess)(ee))return{kind:tr.StructRefKind.RangeOpRef,innerRef:C,resolution:ee};if(!(0,cr.isSuccess)(J))return{kind:tr.StructRefKind.RangeOpRef,innerRef:C,resolution:J};var S,b;if(ee.value!==void 0)S=ee.value.sheet,b=(0,vy.gridRangeJoinOpt)(ee.value.range,(U=J.value)===null||U===void 0?void 0:U.range);else if(J.value!==void 0)S=J.value.sheet,b=J.value.range;else return{kind:tr.StructRefKind.RangeOpRef,innerRef:C,resolution:(0,cr.failure)((0,nt.invalidStructRef)(nt.InvalidStructRefReason.InvalidOp))};return{kind:tr.StructRefKind.RangeOpRef,innerRef:C,resolution:(0,cr.success)((0,ui.sheetGridRange)(S,b))}}function h(I,M,B){switch(B.kind){case tr.StructRefKind.ColumnRef:return d(M,B,!0);case tr.StructRefKind.SpecialRef:return{kind:tr.StructRefKind.SpecialRef,innerRef:B,resolution:f(I,M,B.id)};case tr.StructRefKind.RangeOpRef:return v(M,B,!0);case tr.StructRefKind.MissingRef:return{kind:tr.StructRefKind.MissingRef,innerRef:B,resolution:cr.successUndefined};case tr.StructRefKind.BadRef:return{kind:tr.StructRefKind.BadRef,innerRef:B,resolution:(0,cr.failure)((0,nt.invalidStructRef)(nt.InvalidStructRefReason.InvalidOp))}}}function y(I,M){var B=M.lhs,U=M.rhs,j=B,X,ee;if(B!==void 0){var re=c(I,B,ui.NameSource.StructRef),Z=re.node,J=re.resolution,C=re.precedents,S=J;if(!(0,cr.isSuccess)(S))return(0,nt.resolvedStructRef)(M,void 0,S,C);if((0,lA.isNone)(S.value))return(0,nt.resolvedStructRef)(M,void 0,(0,cr.failure)((0,nt.invalidStructRef)(nt.InvalidStructRefReason.UndefinedTableName)),C);j=Z,X=S.value,ee=C}else{var b=I.originGridCell,O=I.originSheet;if(!(0,cr.isSuccess)(b))return(0,nt.resolvedStructRef)(M,void 0,b,[]);if(!(0,cr.isSuccess)(O))return(0,nt.resolvedStructRef)(M,void 0,O,[]);if(O.value.index===void 0)return(0,nt.resolvedStructRef)(M,void 0,(0,cr.failure)((0,nt.invalidStructRef)(nt.InvalidStructRefReason.InvalidOriginSheet)),[]);var S=e.getContainingTable((0,ui.sheetGridCell)(O.value,b.value));if(!(0,cr.isSuccess)(S))return(0,nt.resolvedStructRef)(M,void 0,S,[]);if((0,lA.isNone)(S.value))return(0,nt.resolvedStructRef)(M,void 0,(0,cr.failure)((0,nt.invalidStructRef)(nt.InvalidStructRefReason.MissingTableName)),[]);X=S.value,ee=[X]}var w=E(I,X,U),D=w.structRef,Q=w.resolution;return(0,nt.resolvedStructRef)(Q.kind===cr.ResultKind.Failure&&Q.reason.kind!==nt.ResolveReasonKind.EmptyIntersection?M:(0,tr.structRefNode)(j,D,M.label),X,Q,ee)}function _(I,M,B){for(var U,j,X=B.refs.map(function(ve){return h(I,M,ve)}),ee=(0,tr.commaOpRef)(X.map(function(ve){return ve.innerRef}),B.label),re=0,Z=X;re<Z.length;re++){var J=Z[re].resolution;if(!(0,cr.isSuccess)(J)&&J.reason.kind!==nt.ResolveReasonKind.InvalidStructRef)return{commaOpRef:ee,resolution:J}}for(var C=[],S=0,b=X;S<b.length;S++){var O=b[S];if(!(0,cr.isSuccess)(O.resolution)||O.kind===tr.StructRefKind.BadRef)return{commaOpRef:ee,resolution:O.resolution};C.push(O.kind===tr.StructRefKind.SpecialRef?{kind:O.kind,resolution:O.resolution}:O.kind===tr.StructRefKind.MissingRef?{kind:O.kind,resolution:O.resolution}:{kind:O.kind,resolution:O.resolution})}if(!(0,vy.isCommaOpRefWellFormed)(B))return{commaOpRef:ee,resolution:(0,cr.failure)((0,nt.invalidStructRef)(nt.InvalidStructRefReason.InvalidOp))};for(var w,D,Q=0,W=C;Q<W.length;Q++){var O=W[Q];O.kind===tr.StructRefKind.SpecialRef&&(w=(0,vy.gridRangeJoinOpt)(w,(U=O.resolution.value)===null||U===void 0?void 0:U.range),D===void 0&&(D=(j=O.resolution.value)===null||j===void 0?void 0:j.sheet))}if(w===void 0||D===void 0)return{commaOpRef:ee,resolution:cr.successUndefined};for(var $=0,me=C;$<me.length;$++){var O=me[$];if(O.kind!==tr.StructRefKind.SpecialRef&&O.kind!==tr.StructRefKind.MissingRef&&(w=(0,vy.gridRangeIsect)(w,O.resolution.value.range),w===void 0))return{commaOpRef:ee,resolution:(0,cr.failure)((0,nt.invalidStructRef)(nt.InvalidStructRefReason.InvalidOp))}}return{commaOpRef:ee,resolution:(0,cr.success)((0,ui.sheetGridRange)(D,w))}}function E(I,M,B){var U;switch((U=B.innerRef)===null||U===void 0?void 0:U.kind){case tr.StructRefKind.ColumnRef:{var j=d(M,B.innerRef),X=j.innerRef,ee=j.resolution;return{structRef:(0,tr.structRef)(X,B.isClosed,B.label),resolution:ee}}case tr.StructRefKind.RangeOpRef:{var re=v(M,B.innerRef),X=re.innerRef,ee=re.resolution;return{structRef:(0,tr.structRef)(X,B.isClosed,B.label),resolution:ee}}case void 0:{var ee=f(I,M,tr.SpecialRefId.Data);return{structRef:B,resolution:ee}}case tr.StructRefKind.SpecialRef:{var ee=f(I,M,B.innerRef.id);return{structRef:B,resolution:ee}}case tr.StructRefKind.CommaOpRef:{var Z=_(I,M,B.innerRef),X=Z.commaOpRef,ee=Z.resolution;return{structRef:(0,tr.structRef)(X,B.isClosed,B.label),resolution:ee}}case tr.StructRefKind.ThisRowOpRef:{var J=f(I,M,tr.SpecialRefId.ThisRow);if(Pp(J)||B.innerRef.ref===void 0)return{structRef:B,resolution:J};var C=B.innerRef.ref.kind===tr.StructRefKind.ColumnRef?d(M,B.innerRef.ref):v(M,B.innerRef.ref),X=C.innerRef,S=C.resolution,b=(0,tr.thisRowOpRef)(X,X.label);if(Pp(S))return{structRef:(0,tr.structRef)(b,B.isClosed,B.label),resolution:S};var O=(0,vy.gridRangeIsect)(J.value.range,S.value.range);return O?{structRef:(0,tr.structRef)(b,B.isClosed,B.label),resolution:(0,cr.success)((0,ui.sheetGridRange)(J.value.sheet,O))}:{structRef:B,resolution:(0,cr.failure)((0,nt.invalidStructRef)(nt.InvalidStructRefReason.InvalidOp))}}case tr.StructRefKind.BadRef:return{structRef:B,resolution:(0,cr.failure)((0,nt.invalidStructRef)(nt.InvalidStructRefReason.InvalidOp))}}}function N(I,M){var B,U,j,X=M.qualifier,ee=M.parts,re=(j=(U=I.config)===null||U===void 0?void 0:U.localeInfo)!==null&&j!==void 0?j:e.config.localeInfo,Z,J,C;if(X===void 0){var S=I.originSheet;if(!(0,cr.isSuccess)(S))return(0,nt.resolvedUserDefinedFunc)(M,S,[],ee.asWhole);Z=X,J=(0,cr.success)(S.value.document)}else B=l(I,X),Z=B[0],J=B[1];var b,O=ee.asWhole;if(Pp(J))b=J,C=[];else{O=(0,Hz.getUserDefinedFuncName)(re,ee.asWhole);var w=e.getUserDefinedFuncLoc(J.value,O);C=[(0,zz.userDefinedFuncLoc)(J.value,O)],(0,cr.isSuccess)(w)?w.value.length!==0?b=w:b=cr.successUndefined:b=w}return(0,nt.resolvedUserDefinedFunc)((0,tr.nameNode)((0,tr.identNamePart)(O,ee.canDenoteNamedObject,ee.label,ee.qualifiedLabel),Z,M.label),b,C,O)}function k(I,M){var B,U,j=(U=(B=I.config)===null||B===void 0?void 0:B.localeInfo)!==null&&U!==void 0?U:e.config.localeInfo,X=(0,Hz.getEtaFuncId)(j,M.whole),ee=M.parts;return(0,gYe.resolvedWorksheetFunc)((0,tr.nameNode)((0,tr.identNamePart)(X!==void 0?j.getWorksheetFuncName(X):ee.asWhole,ee.canDenoteNamedObject,ee.label,ee.qualifiedLabel),void 0,ee.qualifiedLabel),(0,cr.success)(X))}function q(I,M){var B,U=M[I.label],j=(U==null?void 0:U.kind)===tr.AnnotationKind.LocalNameUse?U:void 0;return(0,nt.resolvedLocalName)((0,tr.nameNode)((0,tr.identNamePart)((B=j==null?void 0:j.name)!==null&&B!==void 0?B:I.asWhole,I.canDenoteNamedObject,I.label,I.qualifiedLabel),void 0,I.qualifiedLabel),(0,cr.success)(j))}function V(I,M,B){var U=M.parts,j=M.qualifier,X={names:new Array,udfs:new Array},ee=B[M.label],re=(ee==null?void 0:ee.kind)===tr.AnnotationKind.AppHeadName,Z=(0,tr.flattenNameParts)(U).parts,J=(0,tr.nameNode)((0,tr.identNamePart)(U.asWhole,U.canDenoteNamedObject,U.label,U.qualifiedLabel),j,M.label);if(Kve(j,Z)){var C=Z[0],S=Z.slice(1),b=q(C,B);if(b.resolution.value!==void 0)return(0,nt.resolvedDottedName)((0,tr.nameNode)(S.reduce(vYe,b.node.parts),j,M.label),b,S.map(Bve),X)}var O,w=function(){if(!O)return!1;var Qi=O.headResolved.resolution;return Qi.kind!==cr.ResultKind.Success&&Qi.reason.kind!==nt.ResolveReasonKind.InvalidQualifier||Qi.kind===cr.ResultKind.Success&&Qi.value!==void 0};if(U.canDenoteNamedObject){var D=c(I,J,re?ui.NameSource.AppHead:ui.NameSource.Plain);if((0,qve.safePush)(X.names,D.precedents),O=(0,nt.resolvedDottedName)(D.node,D,[],X),w())return O}if(Vve(re,j,U)){var Q=N(I,J);if((0,qve.safePush)(X.udfs,Q.precedents),O=(0,nt.resolvedDottedName)(Q.node,Q,[],X),w())return O}if(jve(I,j,Z)){var C=Z[0],S=Z.slice(1),W=j!=null&&j.kind===tr.QualifierKind.Ident?(0,tr.sheetQualifier)(j.name,void 0,j.isQuoted,j.label):j,$=(0,tr.cellRefNode)(C.ref,W,C.qualifiedLabel),me=u(I,$),ve=me.node.qualifier;return(0,cA.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't generate ErrorQualifier",(ve==null?void 0:ve.kind)!==tr.QualifierKind.Error),(0,cA.assertTrue)("calc.lang.Resolver.resolveDottedName: resolveCellRef doesn't touch ref",me.node.ref===C.ref),O=(0,nt.resolvedDottedName)((0,tr.nameNode)(U,ve,M.label),me,S.map(Bve),X),O}if((0,Hz.isUnqualifiedNameNode)(M)&&(0,Gve.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,Gve.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){var Pe=k(I,M);if(Pe.resolution.value!==void 0)return(0,nt.resolvedDottedName)(Pe.node,Pe,[],X)}return O!==void 0?O:(0,nt.resolvedDottedName)(M,(0,nt.resolvedNever)(J),[],X)}return{resolveGridRef:Jz,resolveCellRef:u,resolveName:c,resolveStructRef:y,resolveUserDefinedFunc:N,resolveDottedName:V}}yg.createResolver=hYe});var Zz=T(Jq=>{"use strict";p();Object.defineProperty(Jq,"__esModule",{value:!0});Jq.Pledge=void 0;var SYe=pr();Jq.Pledge=SYe.pledge.Pledge});var gA=T(Mt=>{"use strict";p();Object.defineProperty(Mt,"__esModule",{value:!0});Mt.reducePledge=Mt.reduceTopDown_Pledge=Mt.reduceBottomUp=Mt.reduceBottomUp_MaxDepth=Mt.reduceBottomUp_Pledge=Mt.PledgeReducer=Mt.reduceBottomUp_CPS=Mt.reduceBottomUp_Recursive=Mt.zipVisitor=Mt.ZipVisitor=Mt.depthVisitor=Mt.composeVisitor=Mt.ComposeVisitor=Mt.binaryVisitor=Mt.BinaryVisitor=Mt.DelegatingVisitor=Mt.voidVisitor=Mt.constVisitor=Mt.ConstVisitor=Mt.identityVisitor=Mt.IdentityVisitor=Mt.bindVisitor=Mt.visitCellRef=Mt.visitQualifier=Mt.visitAppHeadNode=Mt.visitWSFNode=Mt.visitOperatorNode=Mt.visitFormulaNode=void 0;var vT=fe(),hT=pm(),zve=jd(),qu=Zz(),Wve=Ep(),ur=Ep();function $q(e,r){switch(r.kind){case ur.NodeKind.Literal:{var t=r.oper,n=r.isClosed,a=r.label;return e.literalNode(t,n,a)}case ur.NodeKind.Array:{var o=r.nodes,n=r.isClosed,a=r.label;return e.arrayNode(o,n,a)}case ur.NodeKind.App:{var u=r.head,s=r.args,n=r.isClosed,a=r.label;return e.appNode(u,s,n,a)}case ur.NodeKind.Let:{var u=r.head,l=r.vars,c=r.body,d=r.badArgs,n=r.isClosed,a=r.label;return e.letNode(u,l,c,d,n,a)}case ur.NodeKind.Lambda:{var u=r.head,f=r.params,c=r.body,d=r.badArgs,n=r.isClosed,a=r.label;return e.lambdaNode(u,f,c,d,n,a)}case ur.NodeKind.Paren:{var m=r.node,n=r.isClosed,a=r.label;return e.parenNode(m,n,a)}case ur.NodeKind.Name:{var v=r.parts,h=r.qualifier,a=r.label;return e.nameNode(v,h,a)}case ur.NodeKind.CellRef:{var y=r.ref,h=r.qualifier,a=r.label;return e.cellRefNode(y,h,a)}case ur.NodeKind.FieldRef:{var _=r.lhs,E=r.rhs,a=r.label;return e.fieldRefNode(_,E,a)}case ur.NodeKind.StructRef:{var _=r.lhs,E=r.rhs,a=r.label;return e.structRefNode(_,E,a)}case ur.NodeKind.Missing:{var N=r.chars,a=r.label;return e.missingNode(N,a)}case ur.NodeKind.BadChars:{var k=r.type,N=r.chars,a=r.label;return e.badCharsNode(k,N,a)}case ur.NodeKind.BadSequence:{var k=r.type,q=r.contents,a=r.label;return e.badSequenceNode(k,q,a)}default:return(0,hT.assertNever)("calc.lang.visitFormulaNode",r)}}Mt.visitFormulaNode=$q;function rQ(e,r){var t=r.id,n=r.label;return e.operatorNode(t,n)}Mt.visitOperatorNode=rQ;function pA(e,r){var t=r.id,n=r.whole,a=r.label;return e.wsfNode(t,n,a)}Mt.visitWSFNode=pA;function Qve(e,r){switch(r.kind){case ur.NodeKind.Operator:return rQ(e,r);case ur.NodeKind.WSF:return pA(e,r);default:return $q(e,r)}}Mt.visitAppHeadNode=Qve;function yYe(e,r){switch(r.kind){case ur.QualifierKind.Error:{var t=r.label;return e.errorQualifier(t)}case ur.QualifierKind.Relative:{var t=r.label;return e.relativeQualifier(t)}case ur.QualifierKind.Document:{var n=r.document,a=r.path,o=r.isQuoted,t=r.label;return e.documentQualifier(n,a,o,t)}case ur.QualifierKind.Sheet:{var u=r.sheet,s=r.document,o=r.isQuoted,t=r.label;return e.sheetQualifier(u,s,o,t)}case ur.QualifierKind.Ident:{var l=r.name,o=r.isQuoted,t=r.label;return e.identQualifier(l,o,t)}case ur.QualifierKind.SheetRange:{var c=r.sheet1,d=r.sheet2,f=r.document,o=r.isQuoted,t=r.label;return e.sheetRangeQualifier(c,d,f,o,t)}case ur.QualifierKind.Bad:{var m=r.chars,o=r.isQuoted,v=r.isClosed,h=r.isTerminated,t=r.label;return e.badQualifier(m,o,v,h,t)}default:return(0,hT.assertNever)("calc.lang.visitQualifier",r)}}Mt.visitQualifier=yYe;function _Ye(e,r){switch(r.kind){case ur.CellRefKind.Error:{var t=r.label;return e.cellRefError(t)}case ur.CellRefKind.Single:{var n=r.row,a=r.col,o=r.isBracketed,t=r.label;return e.cellRefSingle(n,a,o,t)}case ur.CellRefKind.Range:{var u=r.ref1,s=r.ref2,t=r.label;return e.cellRefRange(u,s,t)}case ur.CellRefKind.Row:{var l=r.row1,c=r.row2,o=r.isBracketed,t=r.label;return e.cellRefRow(l,c,o,t)}case ur.CellRefKind.Col:{var d=r.col1,f=r.col2,o=r.isBracketed,t=r.label;return e.cellRefCol(d,f,o,t)}case ur.CellRefKind.Bad:{var m=r.chars,o=r.isBracketed,t=r.label;return e.cellRefBad(m,o,t)}default:return(0,hT.assertNever)("calc.lang.visitCellRef",r)}}Mt.visitCellRef=_Ye;function mA(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),missingNode:e.missingNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badCharsNode:e.badCharsNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}Mt.bindVisitor=mA;var Xve=function(){function e(){}return e.prototype.literalNode=function(r,t,n){return(0,ur.literalNode)(r,t,n)},e.prototype.arrayNode=function(r,t,n){return(0,ur.arrayNode)(r,t,n)},e.prototype.appNode=function(r,t,n,a){return(0,ur.appNode)(r,t,n,a)},e.prototype.letNode=function(r,t,n,a,o,u){return(0,ur.letNode)(r,t,n,a,o,u)},e.prototype.lambdaNode=function(r,t,n,a,o,u){return(0,ur.lambdaNode)(r,t,n,a,o,u)},e.prototype.parenNode=function(r,t,n){return(0,ur.parenNode)(r,t,n)},e.prototype.nameNode=function(r,t,n){return(0,ur.nameNode)(r,t,n)},e.prototype.cellRefNode=function(r,t,n){return(0,ur.cellRefNode)(r,t,n)},e.prototype.fieldRefNode=function(r,t,n){return(0,ur.fieldRefNode)(r,t,n)},e.prototype.structRefNode=function(r,t,n){return(0,ur.structRefNode)(r,t,n)},e.prototype.missingNode=function(r,t){return(0,ur.missingNode)(r,t)},e.prototype.badSequenceNode=function(r,t,n){return(0,Wve.badSequenceNode)(r,t,n)},e.prototype.badCharsNode=function(r,t,n){return(0,Wve.badCharsNode)(r,t,n)},e.prototype.operatorNode=function(r,t){return(0,ur.operatorNode)(r,t)},e.prototype.wsfNode=function(r,t,n){return(0,ur.wsfNode)(r,t,n)},e}();Mt.IdentityVisitor=Xve;Mt.identityVisitor=mA(new Xve);var Yve=function(){function e(r){this.value=r}return e.prototype.literalNode=function(r,t,n){return this.value},e.prototype.arrayNode=function(r,t,n){return this.value},e.prototype.appNode=function(r,t,n,a){return this.value},e.prototype.letNode=function(r,t,n,a,o,u){return this.value},e.prototype.lambdaNode=function(r,t,n,a,o,u){return this.value},e.prototype.parenNode=function(r,t,n){return this.value},e.prototype.nameNode=function(r,t,n){return this.value},e.prototype.cellRefNode=function(r,t,n){return this.value},e.prototype.fieldRefNode=function(r,t,n){return this.value},e.prototype.structRefNode=function(r,t,n){return this.value},e.prototype.missingNode=function(r,t){return this.value},e.prototype.badSequenceNode=function(r,t,n){return this.value},e.prototype.badCharsNode=function(r,t,n){return this.value},e.prototype.operatorNode=function(r,t){return this.value},e.prototype.wsfNode=function(r,t,n){return this.value},e}();Mt.ConstVisitor=Yve;function tQ(e){return mA(new Yve(e))}Mt.constVisitor=tQ;Mt.voidVisitor=tQ(void 0);var Jve=function(){function e(r){this.visitor=r}return e.prototype.literalNode=function(r,t,n){return this.visitor.literalNode(r,t,n)},e.prototype.arrayNode=function(r,t,n){return this.visitor.arrayNode(r,t,n)},e.prototype.appNode=function(r,t,n,a){return this.visitor.appNode(r,t,n,a)},e.prototype.letNode=function(r,t,n,a,o,u){return this.visitor.letNode(r,t,n,a,o,u)},e.prototype.lambdaNode=function(r,t,n,a,o,u){return this.visitor.lambdaNode(r,t,n,a,o,u)},e.prototype.parenNode=function(r,t,n){return this.visitor.parenNode(r,t,n)},e.prototype.nameNode=function(r,t,n){return this.visitor.nameNode(r,t,n)},e.prototype.cellRefNode=function(r,t,n){return this.visitor.cellRefNode(r,t,n)},e.prototype.fieldRefNode=function(r,t,n){return this.visitor.fieldRefNode(r,t,n)},e.prototype.structRefNode=function(r,t,n){return this.visitor.structRefNode(r,t,n)},e.prototype.missingNode=function(r,t){return this.visitor.missingNode(r,t)},e.prototype.badSequenceNode=function(r,t,n){return this.visitor.badSequenceNode(r,t,n)},e.prototype.badCharsNode=function(r,t,n){return this.visitor.badCharsNode(r,t,n)},e.prototype.operatorNode=function(r,t){return this.visitor.operatorNode(r,t)},e.prototype.wsfNode=function(r,t,n){return this.visitor.wsfNode(r,t,n)},e}();Mt.DelegatingVisitor=Jve;var Zve=function(e){vT.__extends(r,e);function r(t,n){var a=e.call(this,t)||this;return a.reducer=function(o,u){return n(o,u)},a}return r.prototype.arrayNode=function(t,n,a){var o=this;return(0,hT.assertTrue)("calc.lang.binaryVisitor: non-empty array",t.length>0&&t[0].length>0),t.map(function(u){return u.reduce(o.reducer)}).reduce(this.reducer)},r.prototype.appNode=function(t,n,a,o){return n.reduce(this.reducer,t)},r.prototype.letNode=function(t,n,a,o,u,s){return vT.__spreadArray(vT.__spreadArray(vT.__spreadArray([],n.map(function(l){var c=l.binder;return c.arg}),!0),a===void 0?[]:[a.arg],!0),o.map(function(l){return l.arg}),!0).reduce(this.reducer,t)},r.prototype.lambdaNode=function(t,n,a,o,u,s){return vT.__spreadArray(vT.__spreadArray(vT.__spreadArray([],n.map(function(l){var c,d=l.name;return(c=d.arg.def)===null||c===void 0?void 0:c.rhs}).filter(zve.isDefined),!0),a===void 0?[]:[a.arg],!0),o.map(function(l){return l.arg}),!0).reduce(this.reducer,t)},r.prototype.parenNode=function(t,n,a){return t},r.prototype.fieldRefNode=function(t,n,a){return t},r.prototype.badSequenceNode=function(t,n,a){return(0,hT.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",n.length>0),n.reduce(this.reducer)},r}(Jve);Mt.BinaryVisitor=Zve;function $ve(e,r){return mA(new Zve(e,r))}Mt.binaryVisitor=$ve;var ehe=function(){function e(r,t){this.a=r,this.b=t}return e.prototype.literalNode=function(r,t,n){return this.b(this.a.literalNode(r,t,n))},e.prototype.arrayNode=function(r,t,n){return this.b(this.a.arrayNode(r,t,n))},e.prototype.appNode=function(r,t,n,a){return this.b(this.a.appNode(r,t,n,a))},e.prototype.letNode=function(r,t,n,a,o,u){return this.b(this.a.letNode(r,t,n,a,o,u))},e.prototype.lambdaNode=function(r,t,n,a,o,u){return this.b(this.a.lambdaNode(r,t,n,a,o,u))},e.prototype.parenNode=function(r,t,n){return this.b(this.a.parenNode(r,t,n))},e.prototype.nameNode=function(r,t,n){return this.b(this.a.nameNode(r,t,n))},e.prototype.cellRefNode=function(r,t,n){return this.b(this.a.cellRefNode(r,t,n))},e.prototype.fieldRefNode=function(r,t,n){return this.b(this.a.fieldRefNode(r,t,n))},e.prototype.structRefNode=function(r,t,n){return this.b(this.a.structRefNode(r,t,n))},e.prototype.missingNode=function(r,t){return this.b(this.a.missingNode(r,t))},e.prototype.badSequenceNode=function(r,t,n){return this.b(this.a.badSequenceNode(r,t,n))},e.prototype.badCharsNode=function(r,t,n){return this.b(this.a.badCharsNode(r,t,n))},e.prototype.operatorNode=function(r,t){return this.b(this.a.operatorNode(r,t))},e.prototype.wsfNode=function(r,t,n){return this.b(this.a.wsfNode(r,t,n))},e}();Mt.ComposeVisitor=ehe;function rhe(e,r){return mA(new ehe(e,r))}Mt.composeVisitor=rhe;Mt.depthVisitor=rhe($ve(tQ(0),zve.fastMax),function(e){return e+1});var the=function(){function e(r){this.visitors=r,this.keys=Object.keys(r)}return e.prototype.literalNode=function(r,t,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var s=u[o];a[s]=this.visitors[s].literalNode(r,t,n)}return a},e.prototype.arrayNode=function(r,t,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var s=u[o];a[s]=this.visitors[s].arrayNode(r,t,n)}return a},e.prototype.appNode=function(r,t,n,a){for(var o={},u=0,s=this.keys;u<s.length;u++){var l=s[u];o[l]=this.visitors[l].appNode(r,t,n,a)}return o},e.prototype.letNode=function(r,t,n,a,o,u){for(var s={},l=0,c=this.keys;l<c.length;l++){var d=c[l];s[d]=this.visitors[d].letNode(r,t,n,a,o,u)}return s},e.prototype.lambdaNode=function(r,t,n,a,o,u){for(var s={},l=0,c=this.keys;l<c.length;l++){var d=c[l];s[d]=this.visitors[d].lambdaNode(r,t,n,a,o,u)}return s},e.prototype.parenNode=function(r,t,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var s=u[o];a[s]=this.visitors[s].parenNode(r,t,n)}return a},e.prototype.nameNode=function(r,t,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var s=u[o];a[s]=this.visitors[s].nameNode(r,t,n)}return a},e.prototype.cellRefNode=function(r,t,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var s=u[o];a[s]=this.visitors[s].cellRefNode(r,t,n)}return a},e.prototype.fieldRefNode=function(r,t,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var s=u[o];a[s]=this.visitors[s].fieldRefNode(r,t,n)}return a},e.prototype.structRefNode=function(r,t,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var s=u[o];a[s]=this.visitors[s].structRefNode(r,t,n)}return a},e.prototype.missingNode=function(r,t){for(var n={},a=0,o=this.keys;a<o.length;a++){var u=o[a];n[u]=this.visitors[u].missingNode(r,t)}return n},e.prototype.badSequenceNode=function(r,t,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var s=u[o];a[s]=this.visitors[s].badSequenceNode(r,t,n)}return a},e.prototype.badCharsNode=function(r,t,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var s=u[o];a[s]=this.visitors[s].badCharsNode(r,t,n)}return a},e.prototype.operatorNode=function(r,t){for(var n={},a=0,o=this.keys;a<o.length;a++){var u=o[a];n[u]=this.visitors[u].operatorNode(r,t)}return n},e.prototype.wsfNode=function(r,t,n){for(var a={},o=0,u=this.keys;o<u.length;o++){var s=u[o];a[s]=this.visitors[s].wsfNode(r,t,n)}return a},e}();Mt.ZipVisitor=the;function bYe(e){return mA(new the(e))}Mt.zipVisitor=bYe;function nhe(e,r){var t=function(o){switch(o.kind){case ur.NodeKind.Operator:return rQ(e,o);case ur.NodeKind.WSF:return pA(e,o);default:return n(o)}},n=function a(o){switch(o.kind){case ur.NodeKind.Literal:{var u=o.oper,s=o.isClosed,l=o.label;return e.literalNode(u,s,l)}case ur.NodeKind.Array:{var c=o.nodes,s=o.isClosed,l=o.label;return e.arrayNode(c.map(function(X){return X.map(a)}),s,l)}case ur.NodeKind.App:{var d=o.head,f=o.args,s=o.isClosed,l=o.label;return e.appNode(t(d),f.map(a),s,l)}case ur.NodeKind.Let:{var d=o.head,m=o.vars,v=o.body,h=o.badArgs,s=o.isClosed,l=o.label;return e.letNode(pA(e,d),m.map(function(ee){var re=ee.name,Z=ee.binder;return(0,ur.letVar)(re,(0,ur.indexedArg)(a(Z.arg),Z.index))}),v===void 0?void 0:(0,ur.indexedArg)(a(v.arg),v.index),h.map(function(ee){return(0,ur.indexedArg)(a(ee.arg),ee.index)}),s,l)}case ur.NodeKind.Lambda:{var d=o.head,y=o.params,v=o.body,h=o.badArgs,s=o.isClosed,l=o.label;return e.lambdaNode(pA(e,d),y.map(function(Z){var J=Z.name;return J.arg.def===void 0?(0,ur.lambdaParam)(J):(0,ur.lambdaParam)((0,ur.indexedArg)((0,ur.paramNode)(J.arg.name,(0,ur.paramDefault)(a(J.arg.def.rhs),J.arg.def.label),J.arg.label),J.index))}),v===void 0?void 0:(0,ur.indexedArg)(a(v.arg),v.index),h.map(function(Z){return(0,ur.indexedArg)(a(Z.arg),Z.index)}),s,l)}case ur.NodeKind.Paren:{var _=o.node,s=o.isClosed,l=o.label;return e.parenNode(a(_),s,l)}case ur.NodeKind.Name:{var E=o.parts,N=o.qualifier,l=o.label;return e.nameNode(E,N,l)}case ur.NodeKind.CellRef:{var k=o.ref,N=o.qualifier,l=o.label;return e.cellRefNode(k,N,l)}case ur.NodeKind.FieldRef:{var q=o.lhs,V=o.rhs,l=o.label;return e.fieldRefNode(a(q),V,l)}case ur.NodeKind.StructRef:{var q=o.lhs,V=o.rhs,l=o.label;return e.structRefNode(q,V,l)}case ur.NodeKind.Missing:{var I=o.chars,l=o.label;return e.missingNode(I,l)}case ur.NodeKind.BadChars:{var M=o.type,I=o.chars,l=o.label;return e.badCharsNode(M,I,l)}case ur.NodeKind.BadSequence:{var M=o.type,B=o.contents,l=o.label;return e.badSequenceNode(M,B.map(a),l)}default:return(0,hT.assertNever)("calc.lang.reduceBottomUp_Recursive",o)}};return n(r)}Mt.reduceBottomUp_Recursive=nhe;function CYe(e){for(var r=e;r!=null;)r=r();return r}function fA(e,r,t,n){var a=[],o=function(l){return a.push(l),u},u=function(){return a.length<r.length?t(e,r[a.length],o):n(a)};return u}function $z(e,r,t){return fA(e,r,vb,t)}function Hve(e,r,t,n){return function(){return r!==void 0?t(e,r,n):n(void 0)}}function TYe(e,r,t){switch(r.kind){case ur.NodeKind.Operator:{var n=r.id,a=r.label;return function(){return t(e.operatorNode(n,a))}}case ur.NodeKind.WSF:return eQ(e,r,t);default:return vb(e,r,t)}}function eQ(e,r,t){var n=r.id,a=r.whole,o=r.label;return function(){return t(e.wsfNode(n,a,o))}}function RYe(e,r,t){var n=r.name,a=r.binder;return vb(e,a.arg,function(o){return t((0,ur.letVar)(n,(0,ur.indexedArg)(o,a.index)))})}function EYe(e,r,t){var n=r.name,a=n.arg;return a.def===void 0?function(){return t((0,ur.lambdaParam)(n))}:vb(e,a.def.rhs,function(o){return t((0,ur.lambdaParam)((0,ur.indexedArg)((0,ur.paramNode)(a.name,(0,ur.paramDefault)(o,a.def.label),a.label),n.index)))})}function Zq(e,r,t){var n=r.arg,a=r.index;return vb(e,n,function(o){return t((0,ur.indexedArg)(o,a))})}function vb(e,r,t){switch(r.kind){case ur.NodeKind.Literal:{var n=r.oper,a=r.isClosed,o=r.label;return function(){return t(e.literalNode(n,a,o))}}case ur.NodeKind.Array:{var u=r.nodes,s=r.isClosed,l=r.label;return fA(e,u,$z,function($n){return t(e.arrayNode($n,s,l))})}case ur.NodeKind.App:{var c=r.head,d=r.args,f=r.isClosed,m=r.label;return function(){return TYe(e,c,function($n){return $z(e,d,function(ns){return t(e.appNode($n,ns,f,m))})})}}case ur.NodeKind.Let:{var v=r.head,h=r.vars,y=r.body,_=r.badArgs,E=r.isClosed,N=r.label;return function(){return eQ(e,v,function($n){return fA(e,h,RYe,function(ns){return Hve(e,y,Zq,function(Iu){return fA(e,_,Zq,function(wi){return t(e.letNode($n,ns,Iu,wi,E,N))})})})})}}case ur.NodeKind.Lambda:{var k=r.head,q=r.params,V=r.body,I=r.badArgs,M=r.isClosed,B=r.label;return function(){return eQ(e,k,function($n){return function(){return fA(e,q,EYe,function(ns){return Hve(e,V,Zq,function(Iu){return fA(e,I,Zq,function(wi){return t(e.lambdaNode($n,ns,Iu,wi,M,B))})})})}})}}case ur.NodeKind.Paren:{var U=r.node,j=r.isClosed,X=r.label;return function(){return vb(e,U,function($n){return function(){return t(e.parenNode($n,j,X))}})}}case ur.NodeKind.Name:{var ee=r.parts,re=r.qualifier,Z=r.label;return function(){return t(e.nameNode(ee,re,Z))}}case ur.NodeKind.CellRef:{var J=r.ref,C=r.qualifier,S=r.label;return function(){return t(e.cellRefNode(J,C,S))}}case ur.NodeKind.FieldRef:{var b=r.lhs,O=r.rhs,w=r.label;return function(){return vb(e,b,function($n){return function(){return t(e.fieldRefNode($n,O,w))}})}}case ur.NodeKind.StructRef:{var D=r.lhs,Q=r.rhs,W=r.label;return function(){return t(e.structRefNode(D,Q,W))}}case ur.NodeKind.Missing:{var $=r.chars,me=r.label;return function(){return t(e.missingNode($,me))}}case ur.NodeKind.BadChars:{var ve=r.type,Pe=r.chars,ua=r.label;return function(){return t(e.badCharsNode(ve,Pe,ua))}}case ur.NodeKind.BadSequence:{var Qi=r.type,go=r.contents,Ro=r.label;return $z(e,go,function($n){return t(e.badSequenceNode(Qi,$n,Ro))})}default:return(0,hT.assertNever)("calc.lang.reduceBottomUp_CPS",r)}}function ahe(e,r){var t;return CYe(vb(e,r,function(n){return void(t=n)})),t}Mt.reduceBottomUp_CPS=ahe;var ihe=function(){function e(r){var t=this;this.visitor=r,this.visitFormulaNode=function(n){return $q(t,n)},this.lazyVisitFormulaNode=function(n){return qu.Pledge.resolve(n).bind(t.visitFormulaNode)},this.visitAppHeadNode=function(n){return Qve(t,n)},this.lazyVisitAppHeadNode=function(n){return qu.Pledge.resolve(n).bind(t.visitAppHeadNode)},this.visitWSFNode=function(n){return pA(t,n)},this.lazyVisitWSFNode=function(n){return qu.Pledge.resolve(n).bind(t.visitWSFNode)},this.lazyVisitVar=function(n){var a=n.name,o=n.binder;return t.lazyVisitFormulaNode(o.arg).bind(function(u){return(0,ur.letVar)(a,(0,ur.indexedArg)(u,o.index))})},this.lazyVisitParam=function(n){var a=n.name,o=a.arg;return o.def===void 0?qu.Pledge.resolve((0,ur.lambdaParam)(a)):t.lazyVisitFormulaNode(o.def.rhs).bind(function(u){return(0,ur.lambdaParam)((0,ur.indexedArg)((0,ur.paramNode)(o.name,(0,ur.paramDefault)(u,o.def.label),o.label),a.index))})},this.lazyVisitIndexedArg=function(n){var a=n.arg,o=n.index;return t.lazyVisitFormulaNode(a).bind(function(u){return(0,ur.indexedArg)(u,o)})}}return e.prototype.literalNode=function(r,t,n){var a=this;return qu.Pledge.try(function(){return a.visitor.literalNode(r,t,n)})},e.prototype.arrayNode=function(r,t,n){var a=this;return qu.Pledge.all(r.map(function(o){return qu.Pledge.all(o.map(a.lazyVisitFormulaNode))})).bind(function(o){return a.visitor.arrayNode(o,t,n)})},e.prototype.appNode=function(r,t,n,a){var o=this;return this.lazyVisitAppHeadNode(r).bind(function(u){return qu.Pledge.all(t.map(o.lazyVisitFormulaNode)).bind(function(s){return o.visitor.appNode(u,s,n,a)})})},e.prototype.letNode=function(r,t,n,a,o,u){var s=this;return this.lazyVisitWSFNode(r).bind(function(l){return qu.Pledge.all(t.map(s.lazyVisitVar)).bind(function(c){return(n===void 0?qu.Pledge.resolve(void 0):s.lazyVisitIndexedArg(n)).bind(function(d){return qu.Pledge.all(a.map(s.lazyVisitIndexedArg)).bind(function(f){return s.visitor.letNode(l,c,d,f,o,u)})})})})},e.prototype.lambdaNode=function(r,t,n,a,o,u){var s=this;return this.lazyVisitWSFNode(r).bind(function(l){return qu.Pledge.all(t.map(s.lazyVisitParam)).bind(function(c){return(n===void 0?qu.Pledge.resolve(void 0):s.lazyVisitIndexedArg(n)).bind(function(d){return qu.Pledge.all(a.map(s.lazyVisitIndexedArg)).bind(function(f){return s.visitor.lambdaNode(l,c,d,f,o,u)})})})})},e.prototype.parenNode=function(r,t,n){var a=this;return this.lazyVisitFormulaNode(r).bind(function(o){return a.visitor.parenNode(o,t,n)})},e.prototype.nameNode=function(r,t,n){var a=this;return qu.Pledge.try(function(){return a.visitor.nameNode(r,t,n)})},e.prototype.cellRefNode=function(r,t,n){var a=this;return qu.Pledge.try(function(){return a.visitor.cellRefNode(r,t,n)})},e.prototype.fieldRefNode=function(r,t,n){var a=this;return this.lazyVisitFormulaNode(r).bind(function(o){return a.visitor.fieldRefNode(o,t,n)})},e.prototype.structRefNode=function(r,t,n){var a=this;return qu.Pledge.try(function(){return a.visitor.structRefNode(r,t,n)})},e.prototype.missingNode=function(r,t){var n=this;return qu.Pledge.try(function(){return n.visitor.missingNode(r,t)})},e.prototype.badSequenceNode=function(r,t,n){var a=this;return qu.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind(function(o){return a.visitor.badSequenceNode(r,o,n)})},e.prototype.badCharsNode=function(r,t,n){var a=this;return qu.Pledge.try(function(){return a.visitor.badCharsNode(r,t,n)})},e.prototype.operatorNode=function(r,t){var n=this;return qu.Pledge.try(function(){return n.visitor.operatorNode(r,t)})},e.prototype.wsfNode=function(r,t,n){var a=this;return qu.Pledge.try(function(){return a.visitor.wsfNode(r,t,n)})},e}();Mt.PledgeReducer=ihe;function PYe(e,r){return nQ(new ihe(e),r)}Mt.reduceBottomUp_Pledge=PYe;var AYe=50;function ohe(e,r,t){return t<=AYe?nhe(e,r):ahe(e,r)}Mt.reduceBottomUp_MaxDepth=ohe;function FYe(e,r){return ohe(e,r.node,r.depthUpperBound)}Mt.reduceBottomUp=FYe;function nQ(e,r){return qu.Pledge.settleOrThrow(qu.Pledge.resolve($q(e,r)))}Mt.reduceTopDown_Pledge=nQ;function NYe(e,r){return nQ(e,r.node)}Mt.reducePledge=NYe});var dhe=T(rG=>{"use strict";p();Object.defineProperty(rG,"__esModule",{value:!0});rG.adjustFormulaOrigin=void 0;var oQ=fe(),vA=gg(),Gu=Ep(),she=S0(),hA=CM(),OYe=Wq(),eG=oT(),kYe=pm(),aQ=sA(),uhe=Yq(),lhe=gA();function SA(e,r,t,n){if(t.kind===Gu.PosKind.Abs)return t;var a=(0,OYe.wrapPosition)(e,t.index,n),o=a-r;return o===t.index?t:(0,Gu.pos)(Gu.PosKind.Rel,o)}function iQ(e,r,t,n){var a=SA(r.row,t.row,n.row,vA.sheetRows),o=SA(r.col,t.col,n.col,vA.sheetCols),u=(0,hA.canonicaliseBrackets)(e,a)||(0,hA.canonicaliseBrackets)(e,o);return(0,Gu.cellRefSingle)(a,o,u,n.label)}function MYe(e,r,t,n){switch(n.kind){case Gu.CellRefKind.Error:case Gu.CellRefKind.Bad:return n;case Gu.CellRefKind.Single:return iQ(e,r,t,n);case Gu.CellRefKind.Range:{var a=iQ(e,r,t,n.ref1),o=iQ(e,r,t,n.ref2);return a===n.ref1&&o===n.ref2?n:(0,Gu.cellRefRange)(a,o,n.label)}case Gu.CellRefKind.Row:{var u=SA(r.row,t.row,n.row1,vA.sheetRows),s=SA(r.row,t.row,n.row2,vA.sheetRows),l=(0,hA.canonicaliseBrackets)(e,u)||(0,hA.canonicaliseBrackets)(e,s);return(0,Gu.cellRefRow)(u,s,l,n.label)}case Gu.CellRefKind.Col:{var c=SA(r.col,t.col,n.col1,vA.sheetCols),d=SA(r.col,t.col,n.col2,vA.sheetCols),l=(0,hA.canonicaliseBrackets)(e,c)||(0,hA.canonicaliseBrackets)(e,d);return(0,Gu.cellRefCol)(c,d,l,n.label)}}}var che=(0,she.createFailureErrorClass)("TransformRefsError"),xYe=function(e){oQ.__extends(r,e);function r(t,n,a,o){var u=e.call(this)||this;return u.fn=t,u.locals=a,u.annotations=o,u.resolver=(0,uhe.createResolver)(n),u}return r.prototype.nameNode=function(t,n,a){var o=(0,Gu.nameNode)(t,n,a),u=this.resolver.resolveDottedName(this.locals,o,this.annotations),s=u.headResolved,l=u.fieldsResolved,c=(0,Gu.flattenNameParts)(t).parts;if((0,uhe.canDenoteCellRef)(this.locals,n,c)){var d=c[0],f=c[1],m=c.slice(2);if(s.kind===aQ.ResolvedKind.ResolvedCellRef){(0,kYe.assertTrue)("calc.analyze.adjustFormulaOrigin: all flattened field parts resolved",c.length===1+l.length);var v=this.fn(d.ref);if(v.kind===Gu.CellRefKind.Single||v.kind===Gu.CellRefKind.Row||v.kind===Gu.CellRefKind.Col){var h=function(E,N){return(0,Gu.fieldRefNamePart)(E,N.rhs,N.canDenoteNamedObject,N.label,N.qualifiedLabel)};return(0,Gu.nameNode)(m.reduce(h,h((0,Gu.cellRefNamePart)(v,d.asWhole,d.label,d.qualifiedLabel),f)),n,a)}var y=function(E,N){var k=N.rhs,q=N.qualifiedLabel;return(0,Gu.fieldRefNode)(E,k,q)};return m.reduce(y,y((0,Gu.cellRefNode)(v,s.node.qualifier,s.node.label),f))}if(s.resolution.kind!==eG.ResultKind.Success&&s.resolution.reason.kind!==aQ.ResolveReasonKind.NoOriginSheet&&s.resolution.reason.kind!==aQ.ResolveReasonKind.InvalidQualifier)throw new che(s.resolution.reason)}return o},r.prototype.cellRefNode=function(t,n,a){return(0,Gu.cellRefNode)(this.fn(t),n,a)},r}(lhe.IdentityVisitor);function IYe(e,r,t,n){var a=r.originGridCell.value;if((0,she.isGridCellEqual)(a,t))return(0,eG.success)(n);try{var o=(0,lhe.reduceBottomUp)(new xYe(MYe.bind(void 0,e.config.refStyle,a,t),e,r,n.annotations),n);return(0,eG.success)(oQ.__assign(oQ.__assign({},n),{node:o}))}catch(u){if(u instanceof che)return(0,eG.failure)(u.reason);throw u}}rG.adjustFormulaOrigin=IYe});var fhe=T(tG=>{"use strict";p();Object.defineProperty(tG,"__esModule",{value:!0});tG.RedBlackMapTree=void 0;var wYe=pr();tG.RedBlackMapTree=wYe.rbMapTree.RedBlackMapTree});var mhe=T(nG=>{"use strict";p();Object.defineProperty(nG,"__esModule",{value:!0});nG.buildAnnotations=void 0;var DYe=fe(),LYe=pm(),qYe=fhe(),gm=Zz(),phe=Aq(),hb=Ep(),uQ=S0(),b0=gA(),GYe=function(e){DYe.__extends(r,e);function r(t,n,a){var o=e.call(this,b0.voidVisitor)||this;return o.localeInfo=t,o.annotations=n,o.names=a,o}return r.prototype.appNode=function(t,n,a,o){var u=this;return gm.Pledge.try(function(){return t.kind===hb.NodeKind.Name&&(u.annotations[t.label]=hb.appHeadNameAnnotation),e.prototype.appNode.call(u,t,n,a,o)})},r.prototype.letNode=function(t,n,a,o){var u=this,s=t.id===phe.WorksheetFuncId.LETREC?!0:t.id===phe.WorksheetFuncId.LET?!1:(0,LYe.assertFalse)("calc.lang.buildAnnotations"),l=this.bindNames(n),c=l[n.length];return this.lazyVisitAppHeadNode(t).bind(function(d){return s?gm.Pledge.all(n.map(function(f){var m=f.binder;return gm.Pledge.try(function(){return(0,b0.visitFormulaNode)(c,m.arg)})})):gm.Pledge.all(n.map(function(f,m){var v=f.binder,h=l[m];return gm.Pledge.try(function(){return(0,b0.visitFormulaNode)(h,v.arg)})}))}).bind(function(d){return a===void 0?void 0:(0,b0.visitFormulaNode)(c,a.arg)}).bind(function(d){return gm.Pledge.all(o.map(function(f){return gm.Pledge.try(function(){return(0,b0.visitFormulaNode)(u,f.arg)})}))}).bind(function(d){})},r.prototype.lambdaNode=function(t,n,a,o){var u=this,s=this.bindNames(n),l=s[n.length];return this.lazyVisitAppHeadNode(t).bind(function(c){return gm.Pledge.all(n.map(function(d,f){var m=d.name;if(m.arg.def===void 0)return gm.Pledge.resolve(void 0);var v=s[f],h=m.arg.def;return gm.Pledge.try(function(){return(0,b0.visitFormulaNode)(v,h.rhs)})}))}).bind(function(c){return a===void 0?void 0:(0,b0.visitFormulaNode)(l,a.arg)}).bind(function(c){return gm.Pledge.all(o.map(function(d){return gm.Pledge.try(function(){return(0,b0.visitFormulaNode)(u,d.arg)})}))}).bind(function(c){})},r.prototype.bindNames=function(t){var n=this,a=[this];return t.reduce(function(o,u){var s=u.name;if(s.arg.wholeName===void 0)return a.push(new r(n.localeInfo,n.annotations,o)),o;var l=(0,uQ.getBoundName)(n.localeInfo,s.arg.wholeName),c=o.setValue(l,s.arg);return a.push(new r(n.localeInfo,n.annotations,c)),n.annotations[s.arg.label]=(0,hb.localNameDeclAnnotation)(l,s.arg.wholeName),c},this.names),a},r.prototype.nameNode=function(t,n,a){var o=this;return gm.Pledge.try(function(){if(n===void 0){var u=(0,hb.headNamePart)(t),s=o.names.getEntry((0,uQ.getBoundName)(o.localeInfo,u.asWhole));if(s!==void 0)if(s.value.kind===hb.NodeKind.ContextName)o.annotations[u.label]=(0,hb.localNameUseAnnotation)(s.key,s.value.whole,s.value.label);else{o.annotations[u.label]=(0,hb.localNameUseAnnotation)(s.key,s.value.wholeName,s.value.label);var l=o.annotations[s.value.label];l.uses.push({label:u.label})}}return e.prototype.nameNode.call(o,t,n,a)})},r}(b0.PledgeReducer);function BYe(e,r,t,n){var a=[];return(0,b0.reduceTopDown_Pledge)(new GYe(e,a,(t??[]).reduce(function(o,u){var s=(0,uQ.getBoundName)(e,u.whole);return o.setValue(s,u)},qYe.RedBlackMapTree.create(e.stringCompareCI))),r),a[r.label]=(0,hb.formulaRootAnnotation)(t,n),a}nG.buildAnnotations=BYe});var vhe=T(yA=>{"use strict";p();Object.defineProperty(yA,"__esModule",{value:!0});yA.isIdentContinue=yA.isIdentStart=void 0;var UYe=pr(),ghe=UYe.unicode.makeIsInClass;yA.isIdentStart=ghe([65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,697,699,706,711,712,713,716,717,718,720,722,728,732,733,734,736,741,750,751,880,884,886,888,890,894,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1316,1329,1367,1369,1370,1377,1416,1488,1515,1520,1523,1569,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2308,2362,2365,2366,2384,2385,2392,2402,2417,2419,2427,2432,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3134,3160,3162,3168,3170,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3333,3341,3342,3345,3346,3369,3370,3386,3389,3390,3424,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3806,3840,3841,3904,3912,3913,3949,3976,3980,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5109,5121,5741,5743,5751,5761,5787,5792,5867,5870,5873,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6264,6272,6313,6314,6315,6400,6429,6480,6510,6512,6517,6528,6570,6593,6600,6656,6679,6917,6964,6981,6988,7043,7073,7086,7088,7168,7204,7245,7248,7258,7294,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8208,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8232,8240,8241,8242,8244,8245,8246,8251,8252,8305,8306,8308,8309,8319,8320,8321,8325,8336,8341,8450,8452,8453,8454,8455,8456,8457,8468,8469,8471,8473,8478,8481,8483,8484,8485,8486,8487,8488,8489,8490,8494,8495,8506,8508,8512,8517,8522,8526,8527,8531,8533,8539,8543,8544,8585,8592,8602,8658,8659,8660,8661,8704,8705,8706,8708,8711,8713,8715,8716,8719,8720,8721,8722,8725,8726,8730,8731,8733,8737,8739,8740,8741,8742,8743,8749,8750,8751,8756,8760,8764,8766,8776,8777,8780,8781,8786,8787,8800,8802,8804,8808,8810,8812,8814,8816,8834,8836,8838,8840,8853,8854,8857,8858,8869,8870,8895,8896,8978,8979,9312,9398,9424,9450,9472,9548,9552,9589,9601,9616,9618,9622,9632,9634,9635,9642,9650,9652,9654,9656,9660,9662,9664,9666,9670,9673,9675,9676,9678,9682,9698,9702,9711,9712,9733,9735,9737,9738,9742,9744,9756,9757,9758,9759,9792,9793,9794,9795,9824,9826,9827,9830,9831,9835,9836,9838,9839,9840,11264,11311,11312,11359,11360,11376,11377,11390,11392,11493,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12288,12292,12293,12312,12317,12320,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12544,12549,12590,12593,12687,12704,12728,12784,12829,12832,12842,12849,12851,12857,12858,12896,12924,12927,12928,12963,12969,13059,13060,13069,13070,13076,13077,13080,13081,13090,13092,13094,13096,13099,13100,13110,13111,13115,13116,13129,13131,13133,13134,13137,13138,13143,13144,13179,13183,13184,13189,13192,13259,13261,13268,13269,13271,13272,13273,13275,13278,13312,19894,19968,40900,40960,42125,42240,42509,42512,42528,42538,42540,42560,42592,42594,42607,42624,42648,42786,42888,42891,42893,43003,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43274,43302,43312,43335,43520,43561,43584,43587,43588,43596,44032,55204,57344,63561,63744,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511]);yA.isIdentContinue=ghe([48,58,63,64,65,91,92,93,95,96,97,123,161,162,164,165,167,169,170,171,173,174,175,187,188,888,890,894,900,903,904,907,908,909,910,930,931,1316,1329,1367,1369,1370,1377,1416,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1520,1523,1536,1540,1542,1545,1547,1548,1550,1563,1567,1568,1569,1631,1632,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2305,2362,2364,2382,2384,2389,2392,2404,2406,2416,2417,2419,2427,2432,2433,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2555,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2930,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3073,3076,3077,3085,3086,3089,3090,3113,3114,3124,3125,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3162,3168,3172,3174,3184,3192,3200,3202,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3330,3332,3333,3341,3342,3345,3346,3369,3370,3386,3389,3397,3398,3401,3402,3406,3415,3416,3424,3428,3430,3446,3449,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3719,3721,3722,3723,3725,3726,3732,3736,3737,3744,3745,3748,3749,3750,3751,3752,3754,3756,3757,3770,3771,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3806,3840,3844,3859,3898,3902,3912,3913,3949,3953,3973,3974,3980,3984,3992,3993,4029,4030,4045,4046,4048,4096,4170,4176,4250,4254,4294,4304,4347,4348,4349,4352,4442,4447,4515,4520,4602,4608,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4959,4961,4969,4989,4992,5018,5024,5109,5121,5741,5743,5751,5760,5787,5792,5867,5870,5873,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6264,6272,6315,6400,6429,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6570,6576,6602,6608,6618,6624,6684,6912,6988,6992,7002,7009,7037,7040,7083,7086,7098,7168,7224,7232,7242,7245,7294,7424,7655,7678,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8192,8209,8211,8215,8216,8218,8220,8222,8224,8226,8229,8241,8242,8244,8245,8246,8251,8252,8260,8261,8274,8275,8287,8293,8298,8306,8308,8317,8319,8333,8336,8341,8352,8374,8400,8433,8448,8528,8531,8585,8592,9001,9003,9192,9216,9255,9280,9291,9312,9886,9888,9917,9920,9924,9985,9989,9990,9994,9996,10024,10025,10060,10061,10062,10063,10067,10070,10071,10072,10079,10081,10088,10102,10133,10136,10160,10161,10175,10176,10181,10183,10187,10188,10189,10192,10214,10224,10627,10649,10712,10716,10748,10750,11085,11088,11093,11264,11311,11312,11359,11360,11376,11377,11390,11392,11499,11517,11518,11520,11558,11568,11622,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12288,12312,12317,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12544,12549,12590,12593,12687,12688,12728,12736,12772,12784,12831,12832,12868,12880,13055,13056,19894,19904,40900,40960,42125,42128,42183,42240,42509,42512,42540,42560,42592,42594,42611,42620,42622,42623,42648,42752,42893,43003,43052,43072,43124,43136,43205,43216,43226,43264,43311,43312,43348,43520,43575,43584,43598,43600,43610,44032,55204,57344,64046,64048,64107,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65063,65072,65074,65075,65093,65097,65107,65108,65112,65113,65127,65128,65132,65136,65141,65142,65277,65279,65280,65281,65375,65377,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534])});var hhe=T(_g=>{"use strict";p();Object.defineProperty(_g,"__esModule",{value:!0});_g.enumerateKeysInOrder=_g.enumerateInOrder=_g.RootPointer=_g.ArrayMapTree=_g.floorToPowerOf2=void 0;var TM=pr();_g.floorToPowerOf2=TM.arrayMapTree.floorToPowerOf2;_g.ArrayMapTree=TM.arrayMapTree.ArrayMapTree;_g.RootPointer=TM.arrayMapTree.RootPointer;_g.enumerateInOrder=TM.arrayMapTree.enumerateInOrder;_g.enumerateKeysInOrder=TM.arrayMapTree.enumerateKeysInOrder});var She=T(aG=>{"use strict";p();Object.defineProperty(aG,"__esModule",{value:!0});aG.Math=void 0;var KYe=function(e){if(e.imul&&e.fround&&e.clz32)return e;function r(o,u){u|=0;var s=(o&4194303)*u;return o&4290772992&&(s+=(o&4290772992)*u|0),s|0}var t=new Float32Array(1);function n(o){return t[0]=o,t[0]}function a(o){var u=o>>>0;return u===0?32:31-(e.log(u)/e.LN2|0)|0}return Object.create(e,{imul:{value:r},fround:{value:n},clz32:{value:a}})}(Math);aG.Math=KYe});var oG=T(Ap=>{"use strict";p();Object.defineProperty(Ap,"__esModule",{value:!0});Ap.isSupported=Ap.fastMin=Ap.Base_LocaleDecimalSeparator=Ap.Base_LocaleGetOrdinal=Ap.Base_LocaleIsNumeral=Ap.setLocale=void 0;var iG=void 0;function VYe(e){iG=e}Ap.setLocale=VYe;var jYe=46;function WYe(e){return iG.isNumeral(e)?1:0}Ap.Base_LocaleIsNumeral=WYe;function HYe(e){return iG.getOrdinal(e)}Ap.Base_LocaleGetOrdinal=HYe;function zYe(){var e=iG.decimalSeparator;return e.length===0?jYe:e.charCodeAt(0)}Ap.Base_LocaleDecimalSeparator=zYe;function QYe(e,r){return e<r?e:r}Ap.fastMin=QYe;function XYe(){var e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,new Uint8Array(e)[0]===1}Ap.isSupported=XYe});var _he=T(ss=>{"use strict";p();Object.defineProperty(ss,"__esModule",{value:!0});Object.defineProperty(ss,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return sQ.Base_LocaleDecimalSeparator}});Object.defineProperty(ss,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return sQ.Base_LocaleGetOrdinal}});Object.defineProperty(ss,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return sQ.Base_LocaleIsNumeral}});ss.Math_tan=ss.Math_sqrt=ss.Math_sin=ss.Math_log10=ss.Math_log=ss.Math_exp=ss.Math_cos=ss.Math_atan=void 0;ss.getTempRet0=aJe;ss.setTempRet0=iJe;var sQ=oG(),YYe=Math.sqrt;ss.Math_sqrt=YYe;var JYe=Math.log10||function(r){return Math.log(r)*Math.LOG10E};ss.Math_log10=JYe;var ZYe=Math.log;ss.Math_log=ZYe;var $Ye=Math.exp;ss.Math_exp=$Ye;var eJe=Math.sin;ss.Math_sin=eJe;var rJe=Math.cos;ss.Math_cos=rJe;var tJe=Math.tan;ss.Math_tan=tJe;var nJe=Math.atan;ss.Math_atan=nJe;var yhe=0;function aJe(){return yhe}function iJe(e){yhe=e}});var bhe=T(lQ=>{"use strict";p();Object.defineProperty(lQ,"__esModule",{value:!0});lQ.proc_exit=oJe;function oJe(e){throw new Error("unexpected process termination: "+e)}});var RM=T(_e=>{"use strict";p();Object.defineProperty(_e,"__esModule",{value:!0});_e.stackSave=_e.stackRestore=_e.stackAlloc=_e.setThrew=_e.memory=_e._start=_e.__growWasmMemory=_e.__errno_location=_e.Mathpack_Zero=_e.Mathpack_ViewRound=_e.Mathpack_Trunc=_e.Mathpack_TenTo=_e.Mathpack_Tan=_e.Mathpack_TakeMathError=_e.Mathpack_Sub=_e.Mathpack_Sqrt=_e.Mathpack_Sin=_e.Mathpack_SFloat=_e.Mathpack_SFix=_e.Mathpack_RoundUp=_e.Mathpack_RoundDown=_e.Mathpack_Round=_e.Mathpack_Power=_e.Mathpack_Pi=_e.Mathpack_Pack=_e.Mathpack_One=_e.Mathpack_Neg=_e.Mathpack_Mul=_e.Mathpack_Mod=_e.Mathpack_Log=_e.Mathpack_Ln=_e.Mathpack_LFix=_e.Mathpack_GetExp32=_e.Mathpack_FormatScientific=_e.Mathpack_FormatGetSign=_e.Mathpack_FormatGetExponent=_e.Mathpack_FormatGeneral=_e.Mathpack_FormatFixed=_e.Mathpack_Floor=_e.Mathpack_Float=_e.Mathpack_Fix=_e.Mathpack_Exp=_e.Mathpack_Equal=_e.Mathpack_Div=_e.Mathpack_Cos=_e.Mathpack_Cond2=_e.Mathpack_Cond=_e.Mathpack_Compare=_e.Mathpack_Ceil=_e.Mathpack_Atan2=_e.Mathpack_Atan=_e.Mathpack_Asin=_e.Mathpack_Add=_e.Mathpack_Acos=_e.Mathpack_Abs=_e.Dtr_Yr=_e.Dtr_Write=_e.Dtr_Wdy=_e.Dtr_UtcToLocal=_e.Dtr_ToTime=_e.Dtr_ToNumWithDuration=_e.Dtr_ToNum=_e.Dtr_ToDays=_e.Dtr_Sec=_e.Dtr_Rounding=_e.Dtr_Mon=_e.Dtr_Min=_e.Dtr_Hour=_e.Dtr_FromNum=_e.Dtr_FracSec=_e.Dtr_DaysPerMonth=_e.Dtr_Days=_e.Dtr_DOM=_e.Base_StrBufSize=_e.Base_StrBuf=void 0;var uJe=She(),bg=_he(),sJe=bhe(),cQ=new ArrayBuffer(8),_A=new Int32Array(cQ),jHr=new Float32Array(cQ),Che=new Float64Array(cQ);function Be(e){return _A[e]}function Fo(e,r){_A[e]=r}function Fp(){return Che[0]}function Ft(e){Che[0]=e}function lJe(){return typeof setTempRet0=="function"&&setTempRet0(_A[1]),_A[0]}function cJe(e,r){_A[0]=e,_A[1]=r}function dJe(e,r,t){var n=new e.Int8Array(t),a=new e.Int16Array(t),o=new e.Int32Array(t),u=new e.Uint8Array(t),s=new e.Uint16Array(t),l=new e.Uint32Array(t),c=new e.Float32Array(t),d=new e.Float64Array(t),f=e.Math.imul,m=e.Math.fround,v=e.Math.abs,h=e.Math.clz32,y=e.Math.min,_=e.Math.max,E=e.Math.floor,N=e.Math.ceil,j=e.Math.sqrt,N1=r.abort,k=e.NaN,q=e.Infinity,V=r.Base_LocaleIsNumeral,I=r.Base_LocaleGetOrdinal,M=r.Base_LocaleDecimalSeparator,B=r.Math_log10,U=r.Math_log,j=r.Math_sqrt,X=r.Math_sin,ee=r.Math_cos,re=r.Math_tan,Z=r.Math_atan,J=r.Math_exp,C=r.proc_exit,S=r.getTempRet0,b=20288,O=3892,w=0;function D(){}function Q(){return 3280}function W(){return 255}function $(R,x,A){e:{if(R>>>0<=x>>>0){if(!A)break e;for(;n[R|0]=u[x|0],R=R+1|0,x=x+1|0,A=A+-1|0,!!A;);break e}if(!A)break e;for(R=R+A|0,x=x+A|0;R=R+-1|0,x=x+-1|0,n[R|0]=u[x|0],A=A+-1|0,!!A;);}}function me(R,x){return R=R|0,x=x|0,(V(x|0)|0)!=0|0}function ve(R,x){return R=R|0,x=x|0,I(x|0)|0}function Pe(R){return R=R|0,M()|0}function ua(R,x,A){return R=R|0,x=x|0,A=A|0,B2e(R,x,(A|0)!=0)|0}function Qi(R,x,A,P,F){return R=+R,x=x|0,A=A|0,P=P|0,F=F|0,A=f(A,20)+3792|0,a[A>>1]=0,x=D2e(A,R,x,(P|0)!=0,(F|0)!=0),o[966]=0,x|0}function go(R){return R=R|0,a[f(R,20)+3792>>1]}function Ro(R){return R=R|0,a[f(R,20)+3794>>1]}function $n(R){return R=R|0,o[f(R,20)+3796>>2]}function ns(R){return R=R|0,a[f(R,20)+3800>>1]}function Iu(R){return R=R|0,a[f(R,20)+3802>>1]}function wi(R){return R=R|0,a[f(R,20)+3804>>1]}function mp(R){return R=R|0,a[f(R,20)+3806>>1]}function zl(R){return R=R|0,a[f(R,20)+3808>>1]}function Ql(R){return R=R|0,a[f(R,20)+3810>>1]}function _c(R,x,A,P,F,K,H,de,ge,Me){R=R|0,x=x|0,A=A|0,P=P|0,F=F|0,K=K|0,H=H|0,de=de|0,ge=ge|0,Me=Me|0,Me=f(Me,20),a[Me+3810>>1]=ge,a[Me+3808>>1]=de,a[Me+3806>>1]=H,a[Me+3804>>1]=K,a[Me+3802>>1]=F,a[Me+3800>>1]=P,o[Me+3796>>2]=A,a[Me+3794>>1]=x,a[Me+3792>>1]=R}function Gd(R,x,A){return R=R|0,x=x|0,A=A|0,o[964]=0,o[965]=0,G2e(f(R,20)+3792|0,(x|0)!=0,(A|0)!=0),+d[482]}function vl(R,x,A,P,F){return R=R|0,x=x|0,A=A|0,P=P|0,F=F|0,o[964]=0,o[965]=0,q2e(f(R,20)+3792|0,(x|0)!=0,(A|0)!=0,+(F|0),P),+d[482]}function wu(){return o[963]}function bs(R,x,A){return R=R|0,x=x|0,A=A|0,ow(f(R,20)+3792|0,(x|0)!=0,(A|0)!=0,3852)|0}function hl(R,x,A){return R=+R,x=x|0,A=A|0,L2e(R,x,A),+d[482]}function id(R,x,A,P,F,K,H,de){R=R|0,x=x|0,A=A|0,P=P|0,F=F|0,K=K|0,H=H|0,de=de|0;var ge=0;return ge=b-32|0,b=ge,o[ge+24>>2]=K,o[ge+16>>2]=P,o[ge+8>>2]=x,o[ge+20>>2]=(F|0)>-1?f(F,20)+3792|0:0,o[ge+12>>2]=(A|0)>-1?f(A,20)+3792|0:0,R=U2e(f(R,20)+3792|0,(H|0)!=0,(de|0)!=0,ge+8|0),b=ge+32|0,R|0}function as(){return+d[396]}function Lv(){return+d[395]}function qv(){return+d[391]}function e0(R,x){return R=+R,x=+x,+sk(R,x)}function tk(R,x){return R=+R,x=+x,+sw(R,x)}function PE(R,x){return R=+R,x=+x,+kE(R,x)}function J2(R,x){return R=+R,x=+x,+Zte(R,x)}function Z2(R,x){return R=+R,x=+x,+I2e(R,x)}function iV(R){R=+R;var x=0,A=0;return Ft(+R),x=Be(1)|0,Be(0)|0,A=x&-65536,A?(x&2146435072)==2146435072?(o[966]=1,0):((A|0)<1?-1:1)|0:0}function Zm(R,x){R=+R,x=+x;var A=0,P=0,F=0,K=0,H=0,de=0,ge=0;Ft(+R),A=Be(1)|0,K=Be(0)|0,H=A,ge=A,Ft(+x),de=Be(1)|0,A=Be(0)|0,P=de,F=-1;e:{r:{if((H|0)<(P|0)||(F=1,(ge|0)>(P|0)))break r;if(P=0,(A|0)==(K|0))break e;F=K>>>0<A>>>0?-1:1}A=F,P=(de&H)>-1?A:0-A|0}return P|0}function r0(){var R=0;return R=o[966],o[966]=0,R|0}function qf(R){return R=+R,+mV(R)}function nk(R){return R=+R,d[482]=R,Q2e(),+d[482]}function O_(R){return R=+R,d[482]=R,Jte(),+d[482]}function t0(R){R=+R;var x=0,A=0;return Ft(+R),x=Be(1)|0,A=Be(0)|0,x=x&2147483647,Fo(0,A|0),Fo(1,x|0),+Fp()}function $2(R){R=+R;var x=0,A=0,P=0,F=0,K=0,H=0;return Ft(+R),x=Be(1)|0,A=Be(0)|0,P=x^-2147483648,Fo(0,A|0),Fo(1,P|0),F=+Fp(),K=R,H=(x|0)==65535&A>>>0>4294967295|x>>>0>65535,+(H?F:K)}function ew(R){return R=R|0,+(R>>>0)}function ak(R){return R=R|0,+(R|0)}function $m(R){return R=+R,lw(R)|0}function AE(R){return R=+R,ene(R)|0}function oV(R){return R=+R,d[482]=R,pV()|0}function uV(R,x){return R=+R,x=+x,+O2e(R,x)}function ik(R,x){return R=+R,x=+x,+N2e(R,x)}function sV(R,x){R=+R,x=+x;var A=0;return R=Qte(R,x),Ft(+R),A=Be(1)|0,Be(0)|0,(A&2146435072)==2146435072&&(o[966]=1,R=-1),+R}function lV(R){return R=R|0,gV(R),+d[482]}function rw(R,x){return R=+R,x=+x,+(F2e(R,x)|0)}function FE(R){R=+R;var x=0;return Ft(+R),x=Be(1)|0,Be(0)|0,x&2146435072}function lm(R,x){R=+R,x=+x;var A=0,P=0,F=0;return Ft(+R),A=Be(1)|0,P=Be(0)|0,Ft(+x),F=Be(1)|0,(P|0)==(Be(0)|0)?A=(A|0)==(F|0):A=0,A|0}function tw(R){R=+R;var x=0;return Ft(+R),x=Be(1)|0,Be(0)|0,(x&2146435072)==2146435072?(o[966]=1,-1):+A1(R)}function cV(R){return R=+R,d[482]=R,SV(),+d[482]}function nw(R){return R=+R,d[482]=R,_V(),+d[482]}function dV(R){return R=+R,d[482]=R,hV(),+d[482]}function aw(R){return R=+R,d[482]=R,X2e(),+d[482]}function fV(R){return R=+R,d[482]=R,Y2e(),+d[482]}function ok(R){return R=+R,d[482]=R,J2e(),+d[482]}function el(R){return R=+R,d[482]=R,Z2e(),+d[482]}function NE(R){return R=+R,+Xte(R,0)}function iw(R){return R=+R,+Xte(R,1)}function y2e(R){return R=+R,d[482]=R,yV(),+d[482]}function _2e(R,x){return R=+R,x=+x,+k2e(R,x)}function b2e(R,x){return R=+R,x=+x,+M2e(R,x)}function C2e(R,x){R=+R,x=x|0;var A=0,P=0,F=0,K=0,H=0;if(Ft(+R),F=Be(1)|0,H=Be(0)|0,(F&2146435072)==2146435072)return o[966]=1,-1;d[482]=R,P=F,K=P&-65536,A=3280;e:{if(!K)break e;if((P&2146435072)==2146435072){o[966]=1,A=3280;break e}if(A=3280,(K|0)>0||(P>>>0>=65536&&(o[965]=P^-2147483648),A=3280,!H&(F|0)==-2147483648))break e;a[1640]=45,A=3282}return P=A,x=(x|0)<255?x:255,x=z2e(o[256],P,3790-P>>1,(x|0)>0?x:0),o[964]=0,o[965]=0,x-3280>>1}function T2e(){return o[968]}function R2e(){return o[969]}function E2e(R,x,A){R=+R,x=x|0,A=A|0;var P=0,F=0,K=0;P=b+-64|0,b=P,Ft(+R),F=Be(1)|0,Be(0)|0;e:{if((F&2146435072)==2146435072){o[966]=1,A=-1;break e}o[P+56>>2]=0,a[P+46>>1]=0,a[P+48>>1]=0,F=x+A|0,lk(R,P+56|0,P+16|0,F>>>0<15?F:15),K=a[P+56>>1],F=a[P+58>>1],o[P+8>>2]=F,x=x+K|0,o[P+12>>2]=x,x=x+A|0,(x|0)<(F|0)&&(vV(P+16|0,P+12|0,P+8|0,x),F=o[P+8>>2]);r:{if(!F){F=0,o[P+12>>2]=0,x=0;break r}if(x=o[P+12>>2],A=A+x|0,(A|0)<(F|0)&&(o[P+8>>2]=A,F=A),(F|0)>-1)break r;o[966]=1}o[968]=x,o[969]=s[P+48>>1]>>>15^1,A=F,F>>>0>=256&&(N1(),A=o[P+8>>2]),$(3280,P+16|0,F<<1)}return b=P- -64|0,A|0}function P2e(R,x,A){R=+R,x=x|0,A=A|0;var P=0,F=0,K=0,H=0;F=b+-64|0,b=F,Ft(+R),K=Be(1)|0,Be(0)|0;e:{if((K&2146435072)==2146435072){o[966]=1,P=-1;break e}o[F+56>>2]=0,a[F+46>>1]=0,a[F+48>>1]=0,lk(R,F+56|0,F+16|0,15),H=a[F+56>>1],o[F+12>>2]=H,K=a[F+58>>1],o[F+8>>2]=K,P=x,(P|0)>=2&&(P=(H|0)%(x|0)|0,P=((H|0)<1?x:P?0:x)+P|0),P=A+P|0;r:{if((P|0)>=(K|0))break r;for(vV(F+16|0,F+12|0,F+8|0,P),K=o[F+8>>2],P=(P|0)<(K|0)?P:K;K=P,(P|0)>=1&&(P=K+-1|0,s[(F+16|0)+(P<<1)>>1]==48););if(o[F+8>>2]=K,(x|0)<2||(P=o[F+12>>2],(P|0)==(H|0))||(H=A,A=(P|0)%(x|0)|0,((H+A|0)+((P|0)<1?x:A?0:x)|0)>=(K|0)))break r;N1(),K=o[F+8>>2]}(K|0)<=-1&&(o[966]=1),o[968]=o[F+12>>2],o[969]=s[F+48>>1]>>>15^1,P=K,P>>>0>=256&&(N1(),P=o[F+8>>2]),$(3280,F+16|0,K<<1)}return b=F- -64|0,P|0}function A2e(R,x,A){R=R|0,x=x|0,A=A|0;var P=0;return P=b-48|0,b=P,n[P+39|0]=0,A=(A|0)<15?A:15,$(P+8|0,3280,A<<1),a[P+40>>1]=x+16384&32767|!R<<15,n[P+38|0]=A,o[P>>2]=0,o[P+4>>2]=0,bV(o[256],P,P+8|0)&&(o[966]=1),b=P+48|0,+d[P>>3]}function F2e(R,x){var A=0,P=0,F=0,K=0,H=0,de=0;P=b-16|0,b=P,d[P+8>>3]=R,d[P>>3]=x,Ft(+R),A=Be(1)|0,F=Be(0)|0,K=A,Ft(+x),A=Be(1)|0,H=Be(0)|0,de=A;e:{if(!((F|0)==(H|0)&&(K|0)==(A|0))){if((de+2097152&2146435072)-(K&2146435072)>>>0<=5242879&&(R=A1(R),d[P+8>>3]=R,Ft(+R),A=Be(1)|0,Be(0)|0,K=A,R=A1(x),d[P>>3]=R,Ft(+R),A=Be(1)|0,Be(0)|0,de=A),A=1,F=(de&K)>-1,H=F?P+8|0:P,K=o[H+4>>2],F=F?P:P+8|0,de=o[F+4>>2],(K|0)>(de|0))break e;if((K|0)<(de|0)){A=-1;break e}if(H=o[H>>2],F=o[F>>2],H>>>0>F>>>0||(A=-1,H>>>0<F>>>0))break e}A=0}return b=P+16|0,A}function Qte(R,x){var A=0,P=0,F=0,K=0,H=0,de=0;if(F=3856,A=b-48|0,b=A,o[A+40>>2]=0,a[A+30>>1]=0,a[A+32>>1]=0,d[482]=R,K=A1(R),d[482]=K,lk(K,A+40|0,A,15),s[A+42>>1]){P=lw(x)<<16,P=(P|0)<0?100:P>>16,Ft(+x),H=Be(1)|0,Be(0)|0,de=H&-65536;e:{if(!de)break e;if((H&2146435072)==2146435072){o[966]=1;break e}P=(de|0)<1?0-P|0:P}P=a[A+40>>1]+P|0;e:{r:{if((P|0)>=a[A+42>>1])break r;if((P|0)<1){F=3168;break e}if((P&255)>>>0>=u[A+30|0])break r;n[A+30|0]=P}bV(3276,3856,A)}R=d[F>>3]}return b=A+48|0,R}function N2e(R,x){var A=0,P=0,F=0,K=0,H=0;Ft(+R),A=Be(1)|0,Be(0)|0,P=A&-65536;e:{if(!P)break e;if((A&2146435072)==2146435072){o[966]=1;break e}H=(P|0)<1?-1:1}if(F=Qte(R,x),d[482]=R,d[482]=A1(R),F1(F),A=o[965],A>>>0>=65536){if((A&2146435072)==2146435072)return o[966]=1,F;A=lw(x)<<16,A=(A|0)<0?309:A>>16,Ft(+x),P=Be(1)|0,Be(0)|0,K=P&-65536;e:{if(!K)break e;if((P&2146435072)==2146435072){o[966]=1;break e}A=(K|0)<1?0-A|0:A}if((A|0)<=-309)return zS(8),0;gV(0-A|0);e:{if((H|0)>-1||(A=o[965],A>>>0<65536))break e;o[965]=A^-2147483648}Du(F),F=d[482]}return F}function O2e(R,x){var A=0,P=0,F=0,K=0,H=0;A=b+-64|0,b=A,o[A+56>>2]=0,a[A+46>>1]=0,a[A+48>>1]=0,d[482]=R,Ft(+R),P=Be(1)|0,Be(0)|0,F=P&-65536;e:{if(!F)break e;if((P&2146435072)==2146435072){o[966]=1;break e}r:{if((F|0)>0||(H=32768,P>>>0<65536))break r;o[965]=P^-2147483648,R=d[482]}lk(R,A+56|0,A+16|0,15),s[A+58>>1]||(a[A+56>>1]=1),d[482]=x,P=pV(),P=(P|0)<0?100:P;r:{F=o[965],K=F&-65536;t:{if(!K)break t;if((F&2146435072)==2146435072){o[966]=1;break t}if((K|0)>0)break t;if(P=o[965],P>>>0>=65536&&(o[965]=P^-2147483648),P=pV(),(P|0)<=-1)break r;P=0-P|0}F=a[A+56>>1],K=P+F|0,P=a[A+58>>1],(K|0)<(P|0)&&(o[A+12>>2]=P,o[A+8>>2]=F,vV(A+16|0,A+8|0,A+12|0,K),P=o[A+12>>2],a[A+58>>1]=P,F=o[A+8>>2],a[A+56>>1]=F),n[A+46|0]=P,a[A+48>>1]=F+16384&32767|H,bV(3276,3856,A+16|0),R=d[482];break e}R=d[396]}return b=A- -64|0,R}function Xte(R,x){var A=0,P=0,F=0,K=0;d[482]=R,Ft(+R),P=Be(1)|0,Be(0)|0,F=P,A=F&-65536,P=0;e:{if(!A)break e;if((F&2146435072)==2146435072){o[966]=1,P=0;break e}P=(A|0)<1}o[965]=F&2147483647,F1(d[395]);e:{if(F=o[965],A=F&-65536,!A)break e;if((F&2146435072)==2146435072){o[966]=1;break e}if((A|0)<1)break e;return zS(8),0}K=kE(d[395],R),TV(d[393],K),eg(K),SV();e:{r:{if(A=o[965],A>>>0>=65536){if((A&2146435072)!=2146435072)break r;o[966]=1}if(x){if(o[964]=0,o[965]=0,!P)break e;return x=o[783],o[964]=o[782],o[965]=x,d[482]}if(A=o[789],o[964]=o[788],o[965]=A,x=A,P^1|A>>>0<65536)break e;return o[965]=x^-2147483648,d[482]}if(tne(R),yV(),!x)break e;d[482]=kE(d[394],d[482])}return d[482]}function k2e(R,x){var A=0,P=0,F=0,K=0,H=0,de=0,ge=0;d[482]=R;e:{if(Ft(+R),A=Be(1)|0,Be(0)|0,A>>>0>=65536){if((A&2146435072)!=2146435072)break e;o[966]=1}d[482]=x;r:{if(Ft(+x),A=Be(1)|0,Be(0)|0,P=A&-65536,P){if((A&2146435072)!=2146435072)break r;o[966]=1}return zS(4),0}return cm((P|0)<1?-1:1),eg(d[391]),uk(d[393]),d[482]}e:{if((A|0)<=-1){Ft(+x),A=Be(1)|0,Be(0)|0;r:{P=A&-65536;t:{if(!P)break t;if((A&2146435072)==2146435072){o[966]=1;break t}if((P|0)<1)break r}F=d[391];break e}F=d[391],Ft(+F),A=Be(1)|0,P=Be(0)|0,K=A^-2147483648,Fo(0,P|0),Fo(1,K|0),F=(H=+Fp(),de=F,ge=(A|0)==65535&P>>>0>4294967295|A>>>0>65535,ge?H:de);break e}F=d[396]}return RV(x,R),yV(),Du(F),d[482]}function M2e(R,x){var A=0,P=0,F=0,K=0,H=0,de=0,ge=0,Me=0,mr=0,Cr=0,Ut=0,Bn=0,Eo=0,is=0,vp=0,hp=0,n0=0,dk=0,fk=0,pk=0,dw=0,fw=0,pw=0,EV=0,PV=0,AV=0,FV=0,une=0,sne=0;A=b+-64|0,b=A,d[482]=R,Ft(+R),P=Be(1)|0,Be(0)|0,vp=P&-65536;e:{if(!vp)break e;if((P&2146435072)==2146435072){o[966]=1;break e}une=(vp|0)<1?-1:1}o[965]=P&2147483647,Ft(+x),P=Be(1)|0,vp=Be(0)|0,K=P;e:{r:{if(dw=P&-65536,dw){if((P&2146435072)!=2146435072)break r;o[966]=1}zS(4),R=0;break e}P=K&2147483647,de=P,Fo(0,vp|0),Fo(1,P|0),R=+Fp(),x=d[482],Ft(+x),P=Be(1)|0,F=Be(0)|0,Bn=P;r:{t:{ge=P,EV=de;n:{if((P|0)<(de|0))break n;a:{if((ge|0)<=(EV|0)){if(P=F,ge=vp,(P|0)==(ge|0))break a;if(P>>>0<ge>>>0)break n}fw=mV(ck(R)),TV(fw,d[390]),P=o[965],ge=P&-65536;i:{if(!ge)break i;if((P&2146435072)==2146435072){o[966]=1;break i}H=(ge|0)<1}if(o[966]){zS(0);break t}if(!H||(P=K&2147483647,Fo(0,vp&-134217728),Fo(1,P|0),PV=+Fp(),TV(R,PV),P=o[965],P|o[964]&&!(P&2146435072)))break t;sne=rne(fw),d[482]=sw(fw,PV),P=o[965],P>>>0>=65536&&(o[965]=P^-2147483648),Du(x),F1(sne);break n}o[964]=0,o[965]=0}P=o[964],K=o[792],H=o[965],mr=H,ge=o[793],de=ge,F=-1;n:{if((H|0)<(de|0)||(F=1,(mr|0)>(de|0)))break n;if((P|0)==(K|0))break r;F=P>>>0<K>>>0?-1:1}if((((H&ge)>-1?F:0-F|0)|0)!=-1)break r;Du(R);break r}RV(x,R),o[965]=o[965]&2147483647;t:{P=o[964],ge=o[816],Ut=o[965],n0=Ut,mr=o[817],Cr=mr,H=-1;n:{if((Ut|0)<(mr|0)||(H=1,(n0|0)>(Cr|0)))break n;if((P|0)==(ge|0))break t;H=P>>>0<ge>>>0?-1:1}if((((mr&Ut)>-1?H:0-H|0)|0)!=-1)break t;if(ge=0,H=0,P=vp,Ut=P,mr=K&1048575|1048576,K=mr,Bd(0-P&P,0-((0<P>>>0)+K|0)&K,-1261761911,66559345),n0=s[(w>>>26<<1)+1088>>1],P=n0,mr=P&31,32<=(P&63)>>>0?(P=0,mr=K>>>mr):(P=K>>>mr,mr=((1<<mr)-1&K)<<32-mr|Ut>>>mr),Ut=P,K=F,P=Bn&1048575|1048576,AV=de>>>20,Eo=(Bn>>>20&2047)-AV|0,dk=n0-Eo|0,(dk|0)>=1&&(de=P,F=64-dk|0,Cr=F&31,Bn=K,hp=K,32<=(F&63)>>>0?(F=0,Cr=-1>>>Cr):(F=-1>>>Cr,Cr=(1<<Cr)-1<<32-Cr|-1>>>Cr),fk=Cr&K,Cr=fk,K=hp-Cr|0,pw=P&F,P=de-(pw+(Bn>>>0<Cr>>>0)|0)|0),F=mr,de=o[(F<<1&28)+1056>>2],de=de-f(de,f(F,de)+-1&240)&255,Bn=A,hp=A,F=de|0-f(de,f(F,de)+-1&65280)&65280,de=F,Cr=Bd(mr,Ut,F,0),Me=w+-1|0,Cr=Cr+-1|0,Cr>>>0<4294967295&&(Me=Me+1|0),F=0-F|0,de=Bd(Cr&-65536,Me,F,F>>31)|de,Cr=w,Me=Bd(de,Cr,mr,Ut),F=w+-1|0,F=Bd(0,Me+-1>>>0<4294967295?F+1|0:F,de,Cr),pk=F-de|0,o[hp+56>>2]=pk,Cr=w-((F>>>0<de>>>0)+Cr|0)|0,o[Bn+60>>2]=Cr,o[A+48>>2]=mr,o[A+52>>2]=Ut,gp(A+56|0,A+48|0,A+8|0,A+40|0),Me=o[A+12>>2],de=o[A+8>>2]+1|0,de>>>0<1&&(Me=Me+1|0),o[A+8>>2]=de,o[A+12>>2]=Me,F=mr,de=cw(0-F|0,0-((0<F>>>0)+Ut|0)|0,F,Ut),Bn=w,Eo=(Eo-n0|0)- -64|0,F=(Eo|0)%64|0,Me=F&31,32<=(F&63)>>>0?(F=1<<Me,hp=0):(F=(1<<Me)-1&1>>>32-Me,hp=1<<Me),Me=F,o[A+32>>2]=K,o[A+36>>2]=P,P|K)for(;o[A+56>>2]=K,o[A+60>>2]=P,o[A+48>>2]=de,o[A+52>>2]=Bn,gp(A+56|0,A+48|0,A+32|0,A+40|0),K=o[A+32>>2],P=o[A+36>>2],is=o[A+44>>2],F=H+is|0,FV=o[A+40>>2],H=ge+FV|0,H>>>0<ge>>>0&&(F=F+1|0),ge=H,H=F,(is|0)==(F|0)&ge>>>0<FV>>>0|F>>>0<is>>>0&&(K=K+1|0,K>>>0<1&&(P=P+1|0),o[A+32>>2]=K,o[A+36>>2]=P),!!(K|P););if(o[A+56>>2]=cw(ge,H,mr,Ut),o[A+60>>2]=w,o[A+48>>2]=hp,o[A+52>>2]=Me,gp(A+56|0,A+48|0,A+16|0,A+40|0),K=o[A+44>>2],F=o[A+40>>2],o[A+56>>2]=F,o[A+60>>2]=K,o[A+48>>2]=pk,o[A+52>>2]=Cr,gp(A+56|0,A+48|0,A+24|0,A+40|0),P=o[A+44>>2],o[A+56>>2]=o[A+40>>2],o[A+60>>2]=P,o[A+48>>2]=mr,o[A+52>>2]=Ut,ge=0,H=0,gp(A+56|0,A+48|0,A+32|0,A+40|0),is=o[A+36>>2],Me=o[A+20>>2],K=(F|0)!=0|(K|0)!=0,F=K+o[A+16>>2]|0,F>>>0<K>>>0&&(Me=Me+1|0),hp=F,K=F+o[A+32>>2]|0,F=Me+is|0,o[A>>2]=K,o[A+4>>2]=K>>>0<hp>>>0?F+1|0:F,o[A+32>>2]=de,o[A+36>>2]=Bn,de|Bn)for(K=de,P=Bn;o[A+56>>2]=K,o[A+60>>2]=P,o[A+48>>2]=de,o[A+52>>2]=Bn,gp(A+56|0,A+48|0,A+32|0,A+40|0),K=o[A+32>>2],P=o[A+36>>2],Me=o[A+44>>2],F=H+Me|0,is=o[A+40>>2],H=ge+is|0,H>>>0<ge>>>0&&(F=F+1|0),ge=H,H=F,(Me|0)==(F|0)&ge>>>0<is>>>0|F>>>0<Me>>>0&&(K=K+1|0,K>>>0<1&&(P=P+1|0),o[A+32>>2]=K,o[A+36>>2]=P),!!(K|P););if((Eo|0)>=64)for(K=cw(ge,H,mr,Ut),P=w,H=Eo>>>6;H&1&&(F=o[A+4>>2],o[A+56>>2]=o[A>>2],o[A+60>>2]=F,o[A+48>>2]=K,o[A+52>>2]=P,gp(A+56|0,A+48|0,A+16|0,A+40|0),F=o[A+44>>2],Me=F,Eo=o[A+40>>2],o[A+56>>2]=Eo,o[A+60>>2]=F,o[A+48>>2]=pk,o[A+52>>2]=Cr,gp(A+56|0,A+48|0,A+24|0,A+40|0),F=o[A+44>>2],o[A+56>>2]=o[A+40>>2],o[A+60>>2]=F,o[A+48>>2]=mr,o[A+52>>2]=Ut,gp(A+56|0,A+48|0,A+32|0,A+40|0),is=o[A+36>>2],F=o[A+20>>2],Me=(Eo|0)!=0|(Me|0)!=0,Eo=Me+o[A+16>>2]|0,Eo>>>0<Me>>>0&&(F=F+1|0),Me=Eo+o[A+32>>2]|0,F=F+is|0,o[A>>2]=Me,o[A+4>>2]=Me>>>0<Eo>>>0?F+1|0:F),o[A+56>>2]=K,o[A+60>>2]=P,o[A+48>>2]=K,o[A+52>>2]=P,gp(A+56|0,A+48|0,A+16|0,A+40|0),K=o[A+44>>2],F=o[A+40>>2],o[A+56>>2]=F,o[A+60>>2]=K,o[A+48>>2]=pk,o[A+52>>2]=Cr,gp(A+56|0,A+48|0,A+24|0,A+40|0),P=o[A+44>>2],o[A+56>>2]=o[A+40>>2],o[A+60>>2]=P,o[A+48>>2]=mr,o[A+52>>2]=Ut,gp(A+56|0,A+48|0,A+32|0,A+40|0),ge=o[A+36>>2],P=o[A+20>>2],K=(F|0)!=0|(K|0)!=0,F=K+o[A+16>>2]|0,F>>>0<K>>>0&&(P=P+1|0),K=F+o[A+32>>2]|0,P=P+ge|0,P=K>>>0<F>>>0?P+1|0:P,H=H>>>1,!!H;);if(P=o[A+8>>2],K=o[A+12>>2],F=o[A+4>>2],o[A+56>>2]=o[A>>2],o[A+60>>2]=F,o[A+48>>2]=P,o[A+52>>2]=K,gp(A+56|0,A+48|0,A,A+40|0),ge=o[A+40>>2],H=o[A+44>>2],P=o[A+4>>2],K=o[A>>2],o[A+32>>2]=K,o[A+36>>2]=P,P|K)for(;o[A+56>>2]=K,o[A+60>>2]=P,o[A+48>>2]=de,o[A+52>>2]=Bn,gp(A+56|0,A+48|0,A+32|0,A+40|0),K=o[A+32>>2],P=o[A+36>>2],Cr=o[A+44>>2],F=H+Cr|0,Me=o[A+40>>2],H=ge+Me|0,H>>>0<ge>>>0&&(F=F+1|0),ge=H,H=F,(Cr|0)==(F|0)&ge>>>0<Me>>>0|F>>>0<Cr>>>0&&(F=P,P=K+1|0,P>>>0<1&&(F=F+1|0),K=P,o[A+32>>2]=P,P=F,o[A+36>>2]=P),!!(K|P););if(K=cw(ge,H,mr,Ut),F=w,P=F,o[A>>2]=K,o[A+4>>2]=P,H=(n0+AV|0)+-52|0,fk|pw&&(de=K,K=dk,mr=K&31,32<=(K&63)>>>0?(F=de<<mr,P=0):(F=(1<<mr)-1&de>>>32-mr|P<<mr,P=de<<mr),P=P+fk|0,F=F+pw|0,K=P,o[A>>2]=P,P=P>>>0<fk>>>0?F+1|0:F,o[A+4>>2]=P,H=H-dk|0),!(P|K)){o[964]=0,o[965]=0;break r}n:{if((P|0)>=1){k_(P),P=o[964],ge=o[965],k_(K),F=ge+33554432|0,K=0,F=(P>>>0<0?F+1|0:F)&2146435072|ge&-2146435073,Fo(0,P|K),Fo(1,F|0),Du(+Fp());break n}k_(K)}if(P=o[965],K=P,F=o[964],P=(P>>>20&2047)+H|0,(P|0)<=1023){o[964]=0,o[965]=0,o[966]=2;break r}o[964]=F,o[965]=K&-2146435073|(P+1025&2047)<<20;break r}zS(2),R=0;break e}r:{if((((dw|0)<1?-2147483648:1)^une)>-1||(P=o[965],P>>>0>=65536&&(o[965]=P^-2147483648),Du(R),o[965]!=(EV|0)|(vp|0)!=o[964]))break r;o[964]=0,o[965]=0}r:{if((dw|0)>=1){H=o[965];break r}if(H=o[965],H>>>0<65536)break r;H=H^-2147483648,o[965]=H}!(o[964]|H)|H&2146435072||(o[966]=2),R=d[482]}return b=A- -64|0,R}function x2e(R,x){return R=R|0,x=x|0,x+-48|0}function I2e(R,x){var A=0,P=0,F=0,K=0;d[482]=x,Ft(+x),A=Be(1)|0,Be(0)|0,F=A,o[965]=A&2147483647,x=d[482];e:{Ft(+CV(d[392])),A=Be(1)|0,P=Be(0)|0;r:{if((A|0)==65535&P>>>0<=4294967295|A>>>0<65535){d[482]=R,SV();break r}Gv(),Ft(+CV(x)),A=Be(1)|0,P=Be(0)|0;t:{if((A|0)==65535&P>>>0>4294967295|A>>>0>65535||(A=M_(),(A|0)==-1))break t;d[482]=R,W2e(A);break r}if(d[482]=R,Ft(+R),P=Be(1)|0,Be(0)|0,A=P,P=A>>>16<<16,(P|0)>=1){hV(),eg(x),_V();break r}if((P|0)>-1)break r;if(RV(d[395],x),K=A1(d[482]),d[482]=K,Gv(),Ft(+CV(K)),P=Be(1)|0,(P|0)==65535&Be(0)>>>0>4294967295|P>>>0>65535||(P=$te(),(P|0)==2147483647|!(P&1)))break e;if(d[482]=R,o[965]=A&2147483647,hV(),eg(x),_V(),A=o[965],A>>>0<65536)break r;o[965]=A^-2147483648}if(F>>>16<<16>>16<=-1){if(F=o[966],F&1)return o[964]=0,o[965]=0,o[966]=F&-2,d[482];tne(d[395])}return d[482]}return o[966]=8,d[482]}function w2e(R,x,A){var P=0,F=0,K=0,H=0,de=0,ge=0,Me=0,mr=0,Cr=0,Ut=0,Bn=0,Eo=0,is=0;if(P=b-96|0,b=P,o[P+64>>2]=a[x>>1],o[P+68>>2]=a[x+2>>1],o[P+72>>2]=o[x+4>>2],o[P+76>>2]=a[x+8>>1],o[P+80>>2]=a[x+10>>1],o[P+84>>2]=a[x+12>>1],o[P+92>>2]=a[x+14>>1]+-1,F=a[x+18>>1],F>>>0<=3){e:{r:switch(F-1|0){case 0:F=f(a[x+16>>1],100);break e;case 1:F=f(a[x+16>>1],10);break e;case 2:break r;default:break e}F=a[x+16>>1]}o[P+88>>2]=F}x=0;e:{if(!OE(P- -64|0,P+40|0))break e;H=f(o[R>>2],60),H=Bd(H,H>>31,1e7,0),ge=w,K=o[R+4>>2];r:{if(!K||(de=o[R+12>>2],!de))break r;if(o[P+64>>2]=a[K>>1],o[P+68>>2]=a[K+2>>1],o[P+72>>2]=o[K+4>>2],o[P+76>>2]=a[K+8>>1],o[P+80>>2]=a[K+10>>1],o[P+84>>2]=a[K+12>>1],o[P+92>>2]=a[K+14>>1]+-1,F=a[K+18>>1],F>>>0<=3){t:{n:switch(F-1|0){case 0:F=f(a[K+16>>1],100);break t;case 1:F=f(a[K+16>>1],10);break t;case 2:break n;default:break t}F=a[K+16>>1]}o[P+88>>2]=F}if(o[P+8>>2]=a[de>>1],o[P+12>>2]=a[de+2>>1],o[P+16>>2]=o[de+4>>2],o[P+20>>2]=a[de+8>>1],o[P+24>>2]=a[de+10>>1],o[P+28>>2]=a[de+12>>1],o[P+36>>2]=a[de+14>>1]+-1,F=a[de+18>>1],F>>>0<=3){t:{n:switch(F-1|0){case 0:F=f(a[de+16>>1],100);break t;case 1:F=f(a[de+16>>1],10);break t;case 2:break n;default:break t}F=a[de+16>>1]}o[P+32>>2]=F}if(K=o[P+44>>2],de=K,F=o[P+40>>2],!Yte(P- -64|0,P+56|0,F,K)||!Yte(P+8|0,P+48|0,F,de))break e;Ut=o[P+40>>2],mr=o[P+44>>2],Bn=H,Eo=R+16|0,is=R+8|0,de=ge,Cr=de+o[P+52>>2]|0,F=H,Me=F+o[P+48>>2]|0,Me>>>0<F>>>0&&(Cr=Cr+1|0),K=Me,F=f(o[R+8>>2],60),Me=Bd(F,F>>31,1e7,0),K=K+Me|0,F=w+Cr|0,Cr=K,F=K>>>0<Me>>>0?F+1|0:F,Me=F,K=ge+o[P+60>>2]|0,ge=H+o[P+56>>2]|0,ge>>>0<H>>>0&&(K=K+1|0),R=f(o[R+16>>2],60),H=Bd(R,R>>31,1e7,0),ge=H+ge|0,R=w+K|0,R=ge>>>0<H>>>0?R+1|0:R,H=ge;t:{if((F|0)<(R|0)||(F|0)<=(R|0)&&!(Cr>>>0>=H>>>0)&&1){R=((mr|0)<(R|0)?1:(mr|0)<=(R|0)?Ut>>>0>=H>>>0?0:1:0)&((mr|0)>(Me|0)?1:(mr|0)>=(Me|0)?Ut>>>0<Cr>>>0?0:1:0);break t}R=((mr|0)<(R|0)?1:(mr|0)<=(R|0)?Ut>>>0>=H>>>0?0:1:0)|((mr|0)>(Me|0)?1:(mr|0)>=(Me|0)?Ut>>>0<Cr>>>0?0:1:0)}R=f(o[(R?Eo:is)>>2],60),R=Bd(R,R>>31,1e7,0),H=Bn+R|0,F=w+de|0,F=H>>>0<R>>>0?F+1|0:F,ge=F}if(R=o[P+40>>2],F=o[P+44>>2]-(ge+(R>>>0<H>>>0)|0)|0,H=R-H|0,R=F,(R|0)<0||(R|0)<=0&&!(H>>>0>=0)&&1)break e;uw(H,R,P- -64|0),a[A>>1]=o[P+64>>2],a[A+2>>1]=o[P+68>>2],o[A+4>>2]=o[P+72>>2],x=1,a[A+14>>1]=s[P+92>>1]+1,a[A+8>>1]=o[P+76>>2],a[A+10>>1]=o[P+80>>2],a[A+12>>1]=o[P+84>>2],R=o[P+88>>2],a[A+18>>1]=3,a[A+16>>1]=R}return b=P+96|0,x}function D2e(R,x,A,P,F){var K=0,H=0,de=0,ge=0,Me=0,mr=0,Cr=0,Ut=0,Bn=0;e:{if(s[R>>1])break e;d[482]=x,Ft(+x),K=Be(1)|0,de=Be(0)|0;r:{if(mr=K,Bn=K&-65536,!Bn)break r;if((K&2146435072)==2146435072){o[966]=1;break r}if((Bn|0)>=1)break r;return-2147467259}Me=o[812],Cr=o[813],H=Cr,ge=-1;r:{t:{if((K|0)<(H|0)||(ge=1,(K|0)>(H|0)))break t;if(H=de,(Me|0)==(H|0))break r;ge=H>>>0<Me>>>0?-1:1}if(H=-2147467259,(((mr&Cr)>-1?ge:0-ge|0)|0)==1)break e}r:{Me=o[814],H=o[815],Cr=H,ge=-1;t:{if((K|0)<(H|0)||(ge=1,(K|0)>(Cr|0)))break t;if((de|0)==(Me|0))break r;ge=de>>>0<Me>>>0?-1:1}if(Me=ge,(((H&mr)>-1?Me:0-Me|0)|0)!=-1)break r;return-2147467259}r:{t:{n:{if(F|!Bn)break n;if((K&2146435072)==2146435072){o[966]=1;break n}if((Bn|0)<1)break t}Du(d[o[(A<<2)+1216>>2]>>3]),Ut=d[482];break r}Jte(),F1(x),mr=o[965],de=mr,K=o[964],Fo(0,K|0),Fo(1,de|0),Ut=+Fp();t:{if(o[792]==(K|0)&&o[793]==(de|0)||(H=o[965],H>>>0<65536))break t;o[965]=H^-2147483648,Ut=d[482],Ft(+Ut),de=Be(1)|0,K=Be(0)|0}mr=de,Me=de,de=o[(A<<2)+1216>>2],Cr=o[de+4>>2],H=o[de>>2],de=Cr,ge=-1;t:{n:{if((Me|0)<(de|0)||(ge=1,(Me|0)>(de|0)))break n;if((K|0)==(H|0)){d[482]=x;break t}ge=K>>>0<H>>>0?-1:1}if(Me=ge,d[482]=x,(((mr&Cr)>-1?Me:0-Me|0)|0)==-1)break r}F1(d[395])}if(a[R+18>>1]=A,K=$te(),H=-2147467259,zS(0))break e;r:{if(P){if((K|0)>2957003)break e;K=K+1462|0;break r}if(K+4346018>>>0>7304483)break e}a[R+14>>1]=((K+6|0)%7|0)+1;r:{if(!(!F|K)){o[R>>2]=67436;break r}if(!K){o[R>>2]=788331,P=30;break r}t:{if((K|0)<=-1){P=(K^-1)/1461|0,de=-4-(P<<2)|0,H=(f(P,1461)+K|0)+1461|0;break t}P=(K+-1|0)/1461|0,de=P<<2,H=f(P,-1461)+K|0}t:{if(F&&(de|0)<=199)break t;if(P=de+-101|0,H=(((P|0)/100|0)-((P|0)/400|0)|0)+H|0,(H|0)>=1462){P=de+1900|0,K=P&3;n:{if(F){if(K|(de|0)<200)break n;K=!((P>>>0)%100)&((P>>>0)%400|0)!=0;break n}if(K)break n;K=!((P|0)%100)&((P|0)%400|0)!=0}de=de+4|0,H=((f(K,12)|0)==12?-1460:-1461)+H|0;break t}if((H|0)>0)break t;de=de+-4|0,H=H+1461|0}P=de+1900|0,K=P&3;t:{if(F){if(K|(de|0)<200)break t;K=!((P>>>0)%100)&((P>>>0)%400|0)!=0;break t}if(K)break t;K=!((P|0)%100)&((P|0)%400|0)!=0}for(mr=f(K,12),K=mr;F=K,K=K+1|0,P=H,H=P-u[F+1232|0]|0,(H|0)>0;);H=F,F=F+-11|0,F=(H-((mr|0)<(F|0)?mr:F)>>>0)/12|0,a[R>>1]=(F+de|0)+1900,a[R+2>>1]=(f(F,-12)+K|0)-mr}if(o[R+4>>2]=P,d[482]=Ut,Gv(),P=o[965],P>>>0>=65536&&(o[965]=P^-2147483648),Du(Ut),eg(d[400]),x=d[482],P=M_(),a[R+8>>1]=P,k_(P<<16>>16),P=o[965],P>>>0>=65536&&(o[965]=P^-2147483648),Du(x),eg(d[401]),x=d[482],P=M_(),a[R+10>>1]=P,k_(P<<16>>16),P=o[965],P>>>0>=65536&&(o[965]=P^-2147483648),Du(x),eg(d[401]),!A)return A=M_(),a[R+16>>1]=0,a[R+12>>1]=A,0;x=d[482],P=M_(),a[R+12>>1]=P,k_(P<<16>>16),P=o[965],P>>>0>=65536&&(o[965]=P^-2147483648),Du(x),eg(d[o[(A<<2)+1312>>2]>>3]),d[482]=A1(d[482]),a[R+16>>1]=M_(),H=0}return H}function L2e(R,x,A){d[482]=R,Du(d[o[(A<<2)+1216>>2]>>3]);e:{r:{if(x>>>0<=1){if(x-1)break e;break r}eg(d[401])}eg(d[401])}eg(d[400]),Gv()}function ow(R,x,A,P){var F=0,K=0,H=0,de=0,ge=0,Me=0,mr=0,Cr=0;F=o[R+4>>2],Me=-2146827284,K=s[R>>1],H=a[R+2>>1];e:{if((H|0)>=1){R=(H+-1|0)/12|0;break e}R=(H|0)/-12^-1}de=K+R<<16>>16;e:{if((de|0)>9999|((A?1900:-9999)+(x?4:0)|0)>(de|0)||(H=H+f(R,-12)<<16>>16,(H+-1&65535)>>>0>11|(!F|(de|0)==1900&(H|0)==2&(F|0)==29?!A:0)))break e;if(K=de+1e4|0,ge=(K|0)/4|0,R=ge<<2,mr=(R|0)%100|0,Cr=(R|0)%400|0,ge=f(ge,1461)+F|0,F=R+-1|0,F=((ge+((F|0)/-100|0)|0)+((F|0)/400|0)|0)+-1|0,K=(f(K-R|0,12)+H|0)+-1|0,K)for(R=Cr?mr?0:12:0,K=K+R|0;F=u[R+1232|0]+F|0,R=R+1|0,(K|0)!=(R|0););r:{if(!(!A&&!x)){if(R=F+-4346385|0,!((de|0)>1900|(H|0)>=3))break r;R=F+-4346384|0;break r}R=F+-4346384|0}if(R>>>0>2958465)break e;o[P>>2]=R,Me=0}return Me}function q2e(R,x,A,P,F){var K=0,H=0;H=b-16|0,b=H;e:{r:{t:{if((s[R+2>>1]+-32767&65535)>>>0>1){n:{if(a[R+18>>1]>=1){if(cm(a[R+16>>1]),uk(d[o[(a[R+18>>1]<<2)+1312>>2]>>3]),K=d[482],(F|0)==2){d[482]=P,Du(K);break n}cm(a[R+12>>1]),Du(K);break n}if((F|0)==2){d[482]=P;break n}cm(a[R+12>>1])}uk(d[401]),K=d[482];n:{if((F|0)==1){d[482]=P;break n}cm(a[R+10>>1])}Du(K),uk(d[401]),K=d[482];n:{if(!F){d[482]=P;break n}cm(a[R+8>>1])}Du(K),uk(d[400]),P=d[482];n:{if((ow(R,x,A,H+12|0)|0)<0)break n;if(R=o[H+12>>2],!x)break t;if(cm(R+-1462|0),(R|0)<1462)break n;if(R=o[965],x=R&-65536,!x)break r;if((R&2146435072)==2146435072){o[966]=1;break r}if((x|0)>=1)break r}o[964]=0,o[965]=0}o[964]=0,o[965]=0,zS(8);break e}k_(R)}Du(P)}b=H+16|0}function G2e(R,x,A){var P=0,F=0;F=b-16|0,b=F;e:{r:{t:{if((s[R+2>>1]+-32767&65535)>>>0>1){n:{if(a[R+18>>1]>=1){cm(a[R+16>>1]),P=ck(d[o[(a[R+18>>1]<<2)+1312>>2]>>3]),cm(a[R+12>>1]),Du(P);break n}cm(a[R+12>>1])}P=ck(d[401]),cm(a[R+10>>1]),Du(P),P=ck(d[401]),cm(a[R+8>>1]),Du(P),P=ck(d[400]);n:{if((ow(R,x,A,F+12|0)|0)<0)break n;if(R=o[F+12>>2],!x)break t;if(cm(R+-1462|0),(R|0)<1462)break n;if(R=o[965],x=R&-65536,!x)break r;if((R&2146435072)==2146435072){o[966]=1;break r}if((x|0)>=1)break r}o[964]=0,o[965]=0}o[964]=0,o[965]=0,zS(8);break e}k_(R)}Du(P)}b=F+16|0}function B2e(R,x,A){var P=0;P=x&3;e:{if(A){if(P|(x|0)<2100)break e;P=!((x>>>0)%100)&((x>>>0)%400|0)!=0;break e}if(P)break e;P=!((x|0)%100)&((x|0)%400|0)!=0}return u[(((f(P,12)+R|0)+-1|0)%48|0)+1232|0]}function U2e(R,x,A,P){var F=0,K=0;if(F=b-32|0,b=F,w2e(P,R,F+8|0)){P=o[F+12>>2],o[R>>2]=o[F+8>>2],o[R+4>>2]=P,o[R+16>>2]=o[F+24>>2],P=o[F+20>>2],o[R+8>>2]=o[F+16>>2],o[R+12>>2]=P,P=R;e:{if((ow(R,x,A,F+28|0)|0)>=0){R=((o[F+28>>2]+6|0)%7|0)+1|0;break e}o[F+28>>2]=-1,R=6}a[P+14>>1]=R,K=1}return b=F+32|0,K}function uw(R,x,A){var P=0,F=0,K=0,H=0,de=0,ge=0;K=ane(R,x,711573504,201),F=K,o[A+28>>2]=(F+1>>>0)%7,H=(F>>>0)/146097|0,P=F+f(H,-146097)|0,de=(f(P,100)+75>>>0)/3652425|0,ge=f(de,-36524)+P|0,P=(ge>>>0)/1461|0,P=((f(de,100)+f(H,400)|0)+(P<<2)|0)+((f(ge+f(P,-1461)|0,100)+75>>>0)/36525|0)|0,F=(((F+((P>>>0)/100|0)|0)-(P>>>2)|0)-((P>>>0)/400|0)|0)+f(P,-365)|0,K=Bd(K,w,-864e5,-1),R=ane(R,x,1e4,0)+K|0,x=P+1|0;e:{if(!(!((x>>>0)%100)|x&3&&(x>>>0)%400|0)){x=u[F+1328|0],K=(x<<1)+1696|0;break e}x=u[F+1728|0],K=(x<<1)+2096|0}o[A+12>>2]=(R>>>0)/36e5,o[A+4>>2]=x+1,o[A>>2]=P+1601,x=(R>>>0)/1e3|0,o[A+20>>2]=(x>>>0)%60,o[A+16>>2]=((R>>>0)/6e4>>>0)%60,o[A+24>>2]=R-f(x,1e3),o[A+8>>2]=(F-a[K>>1]|0)+1}function OE(R,x){var A=0,P=0,F=0,K=0,H=0,de=0,ge=0,Me=0,mr=0,Cr=0,Ut=0,Bn=0;K=o[R+4>>2];e:{if((K|0)<1||(Me=K+-1|0,Me>>>0>11)||(A=o[R>>2],P=A+-1601|0,P>>>0>29226)||(H=o[R+8>>2],(H|0)<1))break e;mr=o[R+24>>2],de=A&65535,F=1696;r:{if(!((de>>>0)%400))break r;F=A&3?2096:(de>>>0)%100|0?1696:2096}if(mr>>>0>999||(de=o[R+20>>2],de>>>0>59)||(Cr=o[R+16>>2],Cr>>>0>59)||(Ut=o[R+12>>2],Ut>>>0>23)||(H=H+-1|0,H>>>0>=a[F+(K<<1)>>1]-a[F+(Me<<1)>>1]>>>0))break e;F=P>>>2,K=f(P,365),R=P&65535,P=(R>>>0)/400|0,Bn=(R>>>0)/100|0,A=A+-1600|0,ge=A&65535;r:{if((ge>>>0)%400&&(R=2096,!((ge>>>0)%100)|A&3))break r;R=1696}ge=1,A=f(f(f(Ut,60)+Cr|0,60)+de|0,1e3)+mr|0,R=a[(Me<<1)+R>>1]+(P+((H+(K+F|0)|0)-Bn|0)|0)|0,P=Bd(R,R>>31,864e5,0),A=A+P|0,R=w,o[x>>2]=Bd(A,A>>>0<P>>>0?R+1|0:R,1e4,0),o[x+4>>2]=w}return ge}function Yte(R,x,A,P){var F=0,K=0,H=0,de=0,ge=0;F=b-112|0,b=F,uw(A,P,F+80|0);e:{r:{if(o[R>>2]){if(!OE(R,x))break e;break r}if(H=o[R+8>>2],(H|0)>5|!H)break e;if(A=o[R+4>>2],P=o[R+28>>2],K=o[F+80>>2],o[F+56>>2]=1,o[F+52>>2]=A,o[F+48>>2]=K,o[F+60>>2]=o[R+12>>2],o[F+64>>2]=o[R+16>>2],o[F+68>>2]=o[R+20>>2],R=o[R+24>>2],o[F+76>>2]=0,o[F+72>>2]=R,!OE(F+48|0,F+8|0)){K=0;break e}R=P+8|0,A=P+1|0,de=(H|0)<2,uw(o[F+8>>2],o[F+12>>2],F+16|0),ge=F,K=o[F+44>>2];t:{n:{if((P|0)<(K|0)){R=R-K|0;break n}if(R=1,(P|0)<=(K|0))break t;R=A-K|0}o[ge+56>>2]=R}t:{if(de||(A=R+7|0,o[F+56>>2]=A,K=1,!OE(F+48|0,F+8|0)))break t;for(;;){if(uw(o[F+8>>2],o[F+12>>2],F+16|0),R=o[F+24>>2],K=K+1|0,(H|0)==(K|0))break t;if(A=A+7|0,o[F+56>>2]=A,!OE(F+48|0,F+8|0))break}}if(o[F+56>>2]=R,!OE(F+48|0,F+8|0)){K=0;break e}R=o[F+12>>2],o[x>>2]=o[F+8>>2],o[x+4>>2]=R}K=1}return b=F+112|0,K}function K2e(R,x,A,P){var F=0,K=0,H=0,de=0,ge=0,Me=0,mr=0,Cr=0,Ut=0,Bn=0,Eo=0,is=0;de=b-16|0,b=de,d[de+8>>3]=R,Eo=x,Ft(+R),K=Be(1)|0,H=Be(0)|0,F=K,ge=F,K=F&2146435072;e:{if(!K){n[A+30|0]=0,a[A+32>>1]=0,a[x+2>>1]=0,x=0;break e}if(Me=(K>>>20)+-1022|0,K=f(Me,39457)>>17,a[A+32>>1]=K+16385|F>>>16&32768,(P|0)<=14){if(P=(P+K|0)+1|0,(P|0)<=-1){n[A+30|0]=0,a[A+32>>1]=0,a[x+2>>1]=0,x=0;break e}P=(P|0)<15?P:15}if(o[de+8>>2]=H<<11,o[de+12>>2]=ge<<11|H>>>21|-2147483648,F=P1(de+8|0,Me,K^-1),(F|0)>=1)for(H=A+32|0;K=s[H>>1],a[H>>1]=K+1&32767|K&32768,F=P1(de+8|0,F,-1),(F|0)>0;);r:{if(!F){F=o[de+8>>2],K=o[de+12>>2];break r}H=o[de+12>>2],ge=0-F|0,K=H>>>ge,o[de+12>>2]=K,F=H<<F+32|o[de+8>>2]>>>ge,o[de+8>>2]=F}H=K>>>0<(F>>>0<2576980377?429496730:429496729)>>>0?922:9223,F=H+F|0,o[de+8>>2]=F,F>>>0<H>>>0&&(K=K+1|0,o[de+12>>2]=K);r:{if((P|0)<1){H=A;break r}for(mr=F>>>16,Cr=s[de+14>>1],Ut=A+32|0,is=(P|0)==15,H=A,ge=1;;){Me=P;t:{n:{for(;;){if(P=f(mr,10)+(f(F&65535,10)>>>16)>>>16,Bn=f(Cr,10)+(P+f(K&65535,10)>>>16)>>>16|48,a[H>>1]=Bn,K=P+f(K,10)|0,Cr=K>>>16,F=f(F,10),mr=F>>>16,(ge^-1|(Bn|0)!=48)&1)break n;if(P=s[Ut>>1],a[Ut>>1]=P+-1&32767|P&32768,!is)break}ge=1;break t}H=H+2|0,ge=0}if(P=Me+-1|0,!((Me|0)>1))break}o[de+12>>2]=K,o[de+8>>2]=F}P=H-A|0,F=P>>1;r:{if((P|0)<=29){if((K|0)<=-1){a[H>>1]=57,K=F+1|0;break r}a[H>>1]=48}for(;;){if(K=F,(F|0)<1)break r;if(F=K+-1|0,H=H+-2|0,s[H>>1]!=48)break}}n[A+30|0]=K,a[x+2>>1]=K,x=(s[A+32>>1]&32767)+-16384|0}a[Eo>>1]=x,b=de+16|0}function P1(R,x,A){var P=0,F=0,K=0,H=0,de=0,ge=0;P=b-16|0,b=P;e:{if(!A||(H=A>>31,H=H+A^H,!H))break e;for(A=(A|0)>0?2112:2608;;){if(F=H&15,F){F=(F<<4)+A|0,K=a[F+8>>1],ge=V2e(d[R>>3],d[F>>3],P),x=x+K|0;r:{if(a[P+14>>1]<=0){F=s[P+6>>1],K=s[P+8>>1];break r}K=o[P+4>>2],F=s[P+6>>1]<<1,a[P+6>>1]=F,de=o[P+8>>2],o[P+12>>2]=o[P+12>>2]<<1|de>>>31,K=de<<1|K>>>31,o[P+8>>2]=K,x=x+-1|0}r:{if((F&65535|(K&1|(ge|0)!=0))>>>0<32769||(F=o[P+8>>2],K=F+1|0,o[P+8>>2]=K,K>>>0>=F>>>0)||(F=o[P+12>>2],K=F+1|0,o[P+12>>2]=K,K>>>0>=F>>>0))break r;o[P+12>>2]=-2147483648,x=x+1|0}F=o[P+12>>2],o[R>>2]=o[P+8>>2],o[R+4>>2]=F}if(A=A+240|0,H=H>>4,!H)break}}return b=P+16|0,x}function V2e(R,x,A){var P=0,F=0,K=0,H=0,de=0,ge=0,Me=0,mr=0,Cr=0,Ut=0,Bn=0,Eo=0,is=0,vp=0,hp=0,n0=0;return Ft(+x),H=Be(1)|0,F=Be(0)|0,de=F&65535,Ft(+R),Ut=Be(1)|0,P=Be(0)|0,K=Ut,mr=P&65535,vp=f(mr,de),a[A>>1]=vp,Cr=P>>>16,Bn=f(Cr,de),F=F>>>16,Me=f(F,mr),hp=((Bn&65535)+(vp>>>16)|0)+(Me&65535)|0,a[A+2>>1]=hp,Eo=K&65535,P=f(Eo,de),ge=((P&65535)+(Bn>>>16)|0)+(Me>>>16)|0,Me=f(F,Cr),Ut=H&65535,is=f(Ut,mr),Bn=((ge+(Me&65535)|0)+(is&65535)|0)+(hp>>>16)|0,a[A+4>>1]=Bn,H=H>>>16,ge=f(H,mr),n0=(ge&65535)+(P>>>16)|0,P=K>>>16,K=f(P,de),de=f(Ut,Cr),mr=f(F,Eo),Me=(((((n0+(K&65535)|0)+(Me>>>16)|0)+(is>>>16)|0)+(de&65535)|0)+(mr&65535)|0)+(Bn>>>16)|0,a[A+6>>1]=Me,is=(K>>>16)+(ge>>>16)|0,K=f(H,Cr),ge=f(P,F),F=f(Ut,Eo),Cr=(((((is+(K&65535)|0)+(de>>>16)|0)+(mr>>>16)|0)+(ge&65535)|0)+(F&65535)|0)+(Me>>>16)|0,a[A+8>>1]=Cr,de=f(H,Eo),F=(((de&65535)+(K>>>16)|0)+(ge>>>16)|0)+(F>>>16)|0,K=f(P,Ut),ge=(F+(K&65535)|0)+(Cr>>>16)|0,a[A+10>>1]=ge,H=f(P,H),P=(((H&65535)+(de>>>16)|0)+(K>>>16)|0)+(ge>>>16)|0,a[A+12>>1]=P,a[A+14>>1]=(P>>>16)+(H>>>16),(vp|hp|Bn)&65535}function j2e(R,x,A){var P=0,F=0,K=0,H=0;e:{if(P=u[A+30|0],!P)break e;for(F=A;H=H*10+ +(one[o[o[R>>2]+4>>2]](R,s[F>>1])|0),F=F+2|0,K=(P|0)>1,P=P+-1|0,!!K;);Ft(+H),P=Be(1)|0,R=Be(0)|0,o[x>>2]=R<<11,o[x+4>>2]=((P&2097151)<<11|R>>>21)&2147481600|R>>>21|-2147483648,P=P1(x,(P>>>20&2047)+-1022|0,((s[A+32>>1]&32767)-u[A+30|0]|0)+-16384|0),F=o[x>>2];r:{if(!(F&3071)){R=F;break r}if(R=F+1024|0,o[x>>2]=R,F>>>0<4294966272)break r;F=o[x+4>>2],K=F+1|0,o[x+4>>2]=K,P=(K>>>0<F>>>0)+P|0}if((P|0)<=-1022)break e;return F=(P<<20)+1071644672|0,(F|0)<0?1:(P=o[x+4>>2],o[x>>2]=P<<21|R>>>11,o[x+4>>2]=a[A+32>>1]&-2147483648|(F|P>>>11&1048575),0)}return o[x>>2]=0,o[x+4>>2]=0,0}function A1(R){var x=0,A=0,P=0,F=0,K=0,H=0,de=0,ge=0;if(x=b-16|0,b=x,d[x+8>>3]=R,Ft(+R),A=Be(1)|0,P=Be(0)|0,H=A,A=A&2146435072,A){o[x+8>>2]=P<<11,o[x+12>>2]=H<<11|P>>>21|-2147483648,P=(A>>>20)+-1022|0,A=f(P,39457)>>17,K=A+-14|0,F=P1(x+8|0,P,14-A|0),P=o[x+8>>2];e:{if((F|0)>=((l[x+12>>2]<(P>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47)|0))break e;F=P1(x+8|0,F,1),P=o[x+8>>2],K=A+-15|0}A=K,K=P,P=-2147483648>>>(F&31),K=K+P|0,o[x+8>>2]=K;e:{if(K>>>0>=P>>>0||(de=o[x+12>>2],ge=de+1|0,o[x+12>>2]=ge,ge>>>0>=de>>>0))break e;o[x+12>>2]=-2147483648,F=F+1|0}o[x+8>>2]=K&0-(P<<1),F=P1(x+8|0,F,A),A=o[x+8>>2];e:{if(!(A&3071)){P=A;break e}if(P=A+1024|0,o[x+8>>2]=P,A>>>0<4294966272)break e;A=o[x+12>>2],K=A+1|0,o[x+12>>2]=K,F=(K>>>0<A>>>0)+F|0}e:{if((F|0)<=-1023){o[x+8>>2]=0,o[x+12>>2]=0;break e}if(A=(F<<20)+1071644672|0,(A|0)<=-1)break e;F=o[x+12>>2],o[x+8>>2]=F<<21|P>>>11,o[x+12>>2]=F>>>11&1048575|(A|H&-2147483648)}R=d[x+8>>3]}return b=x+16|0,R}function zS(R){var x=0;return x=o[966],o[966]=R,x}function pV(){var R=0,x=0,A=0;return R=o[964],x=o[965],Du(1048576),Du(2146435072),a[1931]<0?(o[964]=R,o[965]=x,-2147483648):(A=M_(),o[964]=R,o[965]=x,A^-2147483648)}function mV(R){var x=0,A=0,P=0,F=0,K=0;Ft(+R),x=Be(1)|0,K=Be(0)|0,F=x,A=x>>>20,x=A&2047,P=0;e:{if(x>>>0<1023||(P=R,x>>>0>1075))break e;if(A=-1<<(19-A&31),x>>>0>=1044)return Fo(0,A&K),Fo(1,F|0),+Fp();F=F&A,Fo(0,0),Fo(1,F|0),P=+Fp()}return P}function gV(R){var x=0,A=0,P=0;if(R+307>>>0<=615){o[964]=0,o[965]=-2147483648,P=P1(3856,1,R),A=o[964],R=o[965];e:{if(!(A&3071))break e;x=o[965],R=o[964]+1024|0,R>>>0<1024&&(x=x+1|0),o[964]=R,o[965]=x,A=R,R=x}o[964]=R<<21|A>>>11,o[965]=(R>>>11&1048575|P<<20)+1071644672;return}(R|0)>=309&&(o[966]=1),o[964]=0,o[965]=0}function W2e(R){var x=0,A=0;if(A=a[1931],!(A|R)){o[966]=o[966]&4?4:64;return}e:{if((A|0)<1||(M_()|0)!=10)break e;if(x=d[482],Gv(),F1(x),!s[1931]){gV(R);return}d[482]=x}for(x=1;;){if(R&1&&(x=rne(x)),R=R>>>1,R){eg(d[482]);continue}break}d[482]=x}function H2e(R,x,A,P,F,K){var H=0,de=0,ge=0,Me=0,mr=0,Cr=0,Ut=0,Bn=0;mr=b-16|0,b=mr,ge=(x<<1)+R|0,Cr=mr+12|0;e:{r:{t:{n:{if(de=F?P:1,Me=(A|0)<5&de+3>>>0<8,Me)break n;a:{if((de|0)>(A|0))break a;if(P=A+de|0,(P|0)>=3){if((A|0)<5|(de|0)>-4)break n;if((P+-2|0)<(F|0))break a;break n}if((A|0)<5)break n}if(Ut=1,P=1,(A|0)<7)break t;P=A-(de+97>>>0>196?6:5)|0;break t}if((A|0)==1&&(P=0,!de))break t;P=A-((de|0)<(A|0)?(de|0)<1?2-de|0:1:0)|0}t:{if((P|0)<(F|0)){H=1,F=0;n:{if((x|0)<1)break n;a:{i:{if(!P){if(s[R>>1]>52)break i;break n}if((P|0)<1|(P|0)>=(x|0))break n;if(s[(P<<1)+R>>1]<=52)break a;for(;;){if(F=P+-1|0,H=(F<<1)+R|0,Bn=s[H>>1]+1|0,a[H>>1]=Bn,(Bn&65535)!=58)break a;if(P=F,!F)break}}a[R>>1]=49,F=1,H=de+1|0;break n}for(;F=P,(F|0)>=2&&(P=F+-1|0,s[(P<<1)+R>>1]==48););H=de}if((Me^-1)&(H|0)>(A|0)|Ut)break t;break r}if(H=de,!Ut)break r}o[Cr>>2]=32768,A=R+2|0;t:{if((F|0)<2){P=A;break t}if(P=A+(F<<1)|0,P>>>0>=ge>>>0){P=A;break t}F=F+-1|0,o[Cr>>2]=F|32768,R=R+4|0,(x<<1)+-4>>1>>>0<F>>>0&&N1(),$(R,A,F<<1),a[A>>1]=K}P>>>0<ge>>>0&&(a[P>>1]=69,P=P+2|0);t:{if(P>>>0>=ge>>>0){F=P;break t}if(F=P+2|0,(H|0)<=0){a[P>>1]=45,H=1-H|0;break t}a[P>>1]=43,H=H+-1|0}if((H|0)<100|F>>>0>=ge>>>0||(R=(H>>>0)/100|0,a[F>>1]=R+48,H=H-f(R,100)|0,F=F+2|0),F>>>0<ge>>>0&&(a[F>>1]=((H|0)/10|0)+48,F=F+2|0),F>>>0>=ge>>>0)break e;a[F>>1]=((H|0)%10|0)+48,F=F+2|0;break e}if(!((F|0)<0|(F|0)>(H|0))){if(P=(H|0)>(x|0)?x:H,A=P-F|0,A)for(x=(F<<1)+R|0,F=0;a[x+(F<<1)>>1]=48,F=F+1|0,(A|0)!=(F|0););F=(P<<1)+R|0;break e}if(A=F-H|0,o[Cr>>2]=A,(H|0)>=1){if(de=(H|0)>(x|0)?x:H,A=de<<1,Me=A+R|0,P=(Me+(F<<1)|0)-A|0,A=P+-2|0,!(A>>>0<R>>>0|P>>>0>=ge>>>0))for(;a[P>>1]=s[A>>1],P=P+-2|0,A=A+-2|0,A>>>0>=Me>>>0;);(H|0)<(x|0)&&(a[Me>>1]=K),x=F-de|0,R=ge-Me>>1,F=Me+(((R|0)>(x|0)?x+1|0:R)<<1)|0;break e}P=((R-(H<<1)|0)+(F<<1)|0)+2|0;r:{if(P>>>0>=ge>>>0||(F=((F<<1)+R|0)+-2|0,F>>>0<R>>>0))break r;for(;a[P>>1]=s[F>>1],P=P+-2|0,F=F+-2|0,F>>>0>=R>>>0;);}(x|0)>=1&&(a[R>>1]=48,R=R+2|0),R>>>0<ge>>>0&&(a[R>>1]=K,R=R+2|0),P=ge-R>>1;r:{if(!H||(x=0-H|0,x=(P|0)<(x|0)?P:x,!x))break r;for(F=0;a[(F<<1)+R>>1]=48,F=F+1|0,(x|0)!=(F|0););}F=(((P|0)<(A|0)?P:A)<<1)+R|0}return b=mr+16|0,F}function vV(R,x,A,P){var F=0,K=0,H=0;e:{r:{t:{n:{if(!P){if(s[R>>1]<=52)break n;break r}if((P|0)<1)break n;if((P|0)<15)break t}o[x>>2]=1,o[A>>2]=0;return}if(s[(P<<1)+R>>1]<=52)break e;for(;;){if(F=P+-1|0,K=(F<<1)+R|0,H=s[K>>1]+1|0,a[K>>1]=H,(H&65535)!=58)break e;if(P=F,!P)break}}a[R>>1]=49,o[x>>2]=o[x>>2]+1,o[A>>2]=1;return}for(;x=P,(P|0)>=2&&(P=x+-1|0,s[(P<<1)+R>>1]==48););o[A>>2]=x}function z2e(R,x,A,P){var F=0;F=b-16|0,b=F,R=one[o[o[R>>2]+8>>2]](R)|0,o[F+8>>2]=0;e:{if(A<<1>>>0<=33){if((A|0)<1)break e;a[x>>1]=0;break e}lk(d[482],F+8|0,x,15),x=H2e(x,A,P,a[F+8>>1],a[F+10>>1],R)}return b=F+16|0,x}function Jte(){var R=0,x=0,A=0;e:{if(A=o[964],R=o[965],x=R&-65536,x){if((R&2146435072)==2146435072){o[966]=1,Gv();return}if((x|0)<1)break e}Gv();return}Gv(),(A|0)==o[964]&&o[965]==(R|0)||F1(1)}function Q2e(){var R=0,x=0,A=0;e:{if(A=o[964],R=o[965],x=R&-65536,x){if((R&2146435072)==2146435072){o[966]=1,Gv();return}if((x|0)>0)break e}Gv();return}Gv(),(A|0)==o[964]&&o[965]==(R|0)||Du(1)}function Du(R){d[482]=Zte(d[482],R)}function Zte(R,x){var A=0;return R=R+x,Ft(+R),A=Be(1)|0,Be(0)|0,(A&2146435072)==2146435072&&(o[966]=1,R=d[396]),R}function F1(R){d[482]=kE(d[482],R)}function kE(R,x){var A=0;return R=R-x,Ft(+R),A=Be(1)|0,Be(0)|0,(A&2146435072)==2146435072&&(o[966]=1,R=d[396]),R}function eg(R){d[482]=sw(d[482],R)}function sw(R,x){var A=0,P=0,F=0,K=0;return Ft(+(R*x)),A=Be(1)|0,K=Be(0)|0,P=A&2146435072,0|(P|0)!=2146435072?(P=!(P|F),F=P?o[792]:K,A=P?o[793]:A,Fo(0,F|0),Fo(1,A|0),+Fp()):(o[966]=1,A=o[793],Fo(0,o[792]),Fo(1,A|0),+Fp())}function uk(R){d[482]=sk(d[482],R)}function sk(R,x){var A=0,P=0,F=0,K=0,H=0,de=0;e:{if(Ft(+x),A=Be(1)|0,Be(0)|0,!(A&2146435072)){P=4;break e}if(P=1,Ft(+(R/x)),A=Be(1)|0,F=Be(0)|0,K=A&2146435072,H=K,!0&(K|0)==2146435072)break e;return P=!(H|de),F=P?o[792]:F,A=P?o[793]:A,Fo(0,F|0),Fo(1,A|0),+Fp()}return o[966]=P,A=o[793],Fo(0,o[792]),Fo(1,A|0),+Fp()}function k_(R){d[482]=R>>>0}function cm(R){d[482]=R|0}function X2e(){var R=0,x=0;R=+B(+d[482]),d[482]=R,Ft(+R),x=Be(1)|0,Be(0)|0,(x&2146435072)==2146435072&&(o[966]=8)}function hV(){var R=0,x=0;R=+U(+d[482]),d[482]=R,Ft(+R),x=Be(1)|0,Be(0)|0,(x&2146435072)==2146435072&&(o[966]=8)}function M_(){return lw(d[482])}function lw(R){var x=0,A=0,P=0,F=0,K=0;Ft(+R),x=Be(1)|0,A=Be(0)|0,P=x&2146435072,F=(P|0)==1106247680&F>>>0<0|P>>>0<1106247680,x=x&2147483647,K=x,Fo(0,A|0),Fo(1,x|0),R=+Fp();e:{if(R<18446744073709552e3&R>=0){P=v(R)>=1?R>0?~~y(E(R/4294967296),4294967295)>>>0:~~N((R-+(~~R>>>0>>>0))/4294967296)>>>0:0,x=~~R>>>0;break e}P=0,x=0}return A=F?x:A,x=F?P:K,!x&A>>>0<4294967295|x>>>0<0?A:-1}function $te(){return ene(d[482])}function ene(R){var x=0,A=0;return Ft(+R),x=Be(1)|0,Be(0)|0,x=x&2145386496,A=(x|0)==1105199104&A>>>0<0|x>>>0<1105199104,v(R)<2147483648?x=~~R:x=-2147483648,A?x:-2147483648}function SV(){var R=0,x=0;R=+j(+d[482]),d[482]=R,Ft(+R),x=Be(1)|0,Be(0)|0,(x&2146435072)==2146435072&&(o[966]=8)}function Y2e(){var R=0,x=0,A=0;e:{if(x=d[482],Ft(+x),R=Be(1)|0,Be(0)|0,R=R&2145386496,(R|0)==1101004799&!0|R>>>0<1101004799&&(x=+X(+x),d[482]=x,Ft(+x),R=Be(1)|0,Be(0)|0,(R&2146435072)!=2146435072))break e;o[966]=8}}function J2e(){var R=0,x=0,A=0;e:{if(x=d[482],Ft(+x),R=Be(1)|0,Be(0)|0,R=R&2145386496,(R|0)==1101004799&!0|R>>>0<1101004799&&(x=+ee(+x),d[482]=x,Ft(+x),R=Be(1)|0,Be(0)|0,(R&2146435072)!=2146435072))break e;o[966]=8}}function Z2e(){var R=0,x=0,A=0,P=0;A=8,x=d[482],Ft(+x),R=Be(1)|0,Be(0)|0,R=R&2145386496;e:{if((R|0)==1101004799&!0|R>>>0<1101004799&&(x=+re(+x),d[482]=x,A=4,Ft(+x),R=Be(1)|0,Be(0)|0,(R&2146435072)!=2146435072))break e;o[966]=A}}function yV(){var R=0,x=0;R=+Z(+d[482]),d[482]=R,Ft(+R),x=Be(1)|0,Be(0)|0,(x&2146435072)==2146435072&&(o[966]=8)}function Gv(){d[482]=mV(d[482])}function _V(){var R=0,x=0;R=+J(+d[482]),d[482]=R,Ft(+R),x=Be(1)|0,Be(0)|0,(x&2146435072)==2146435072&&(o[966]=1)}function bV(R,x,A){return j2e(R,x,A)}function lk(R,x,A,P){K2e(R,x,A,P)}function gp(R,x,A,P){var F=0,K=0,H=0,de=0,ge=0,Me=0,mr=0,Cr=0;ge=o[x+4>>2],Cr=o[x>>2],de=H,H=o[R>>2],F=o[R+4>>2],x=0,R=Bd(Cr,de,F,x),K=w,de=ge,ge=0,F=Bd(de,ge,F,x),K=K+F|0,x=w+Me|0,x=K>>>0<F>>>0?x+1|0:x,F=K,Me=x,K=H,x=Bd(de,ge,K,0),H=F,F=w,de=H+F|0,H=Me,H=de>>>0<F>>>0?H+1|0:H,F=0,Me=Bd(Cr,mr,K,ge),mr=w,K=mr+R|0,R=K>>>0<mr>>>0?F+1|0:F,ge=x,K=x+K|0,x=R,x=K>>>0<ge>>>0?x+1|0:x,R=de,de=x,x=R+x|0,x>>>0<de>>>0&&(H=H+1|0),o[A>>2]=x,o[A+4>>2]=H,o[P>>2]=Me,o[P+4>>2]=K}function CV(R){return kE(d[482],R)}function TV(R,x){d[482]=kE(R,x)}function rne(R){return sw(d[482],R)}function ck(R){return sk(d[482],R)}function tne(R){d[482]=sk(R,d[482])}function RV(R,x){d[482]=sk(R,x)}function N1(){C(1),N1()}function $2e(R,x){R=R|0,x=x|0,o[970]||(o[971]=x,o[970]=R)}function ewe(){return 3888}function rwe(){return b|0}function twe(R){return R=R|0,R=b-R&-16,b=R,R|0}function nwe(R){R=R|0,b=R}function awe(R){return R=R|0,N1()|0}function ME(R,x){cJe(R|0,x|0)}function iwe(R,x,A,P){var F=0,K=0,H=0,de=0,ge=0,Me=0;return F=A>>>16,K=R>>>16,Me=f(F,K),H=A&65535,de=R&65535,ge=f(H,de),K=(ge>>>16)+f(K,H)|0,F=(K&65535)+f(F,de)|0,R=(((f(x,A)+Me|0)+f(R,P)|0)+(K>>>16)|0)+(F>>>16)|0,x=ge&65535|F<<16,w=R,x}function owe(R,x,A,P){var F=0,K=0,H=0;return F=x>>31,R=R^F,H=R-F|0,K=x>>31,K=(K^x)-((R>>>0<F>>>0)+K|0)|0,R=P>>31,A=A^R,F=P>>31,A=nne(H,K,A-R|0,(F^P)-((A>>>0<R>>>0)+F|0)|0),x=x^P,R=x>>31,x=x>>31,A=A^x,P=A-x|0,w=(R^w)-((A>>>0<x>>>0)+R|0)|0,P}function nne(R,x,A,P){var F=0,K=0,H=0,de=0,ge=0,Me=0,mr=0,Cr=0,Ut=0,Bn=0,Eo=0;e:{r:{t:{n:{a:{i:{o:{u:{s:{l:{if(H=x,H){if(F=A,!F)break l;if(K=P,!K)break s;if(F=h(K)-h(H)|0,F>>>0<=31)break u;break r}if((P|0)==1&A>>>0>=0|P>>>0>1)break r;return x=(R>>>0)/(A>>>0)|0,ME(R-f(x,A)|0,0),w=0,x}if(F=P,!R)break o;if(!F||(K=F+-1|0,K&F))break i;return ME(R,H&K),R=H>>>(ine(F)&31),w=0,R}if(K=F+-1|0,!(K&F))break a;ge=(h(F)+33|0)-h(H)|0,Me=0-ge|0;break t}ge=F+1|0,Me=63-F|0;break t}return R=(H>>>0)/(F>>>0)|0,ME(0,H-f(R,F)|0),w=0,R}if(F=h(F)-h(H)|0,F>>>0<31)break n;break r}if(ME(R&K,0),(F|0)==1)break e;return A=ine(F),P=R,R=A&31,32<=(A&63)>>>0?(F=0,R=x>>>R):(F=x>>>R,R=((1<<R)-1&x)<<32-R|P>>>R),w=F,R}ge=F+1|0,Me=63-F|0}if(K=x,Ut=R,F=ge&63,H=F&31,32<=(F&63)>>>0?(F=0,de=K>>>H):(F=K>>>H,de=((1<<H)-1&K)<<32-H|Ut>>>H),K=F,H=R,F=Me&63,R=F&31,32<=(F&63)>>>0?(F=H<<R,R=0):(F=(1<<R)-1&H>>>32-R|x<<R,R=H<<R),x=F,ge)for(F=P+-1|0,H=A+-1|0,H>>>0<4294967295&&(F=F+1|0),Me=F;F=K<<1|de>>>31,K=de<<1,Ut=F,K=x>>>31|K,Cr=K,de=Me-((H>>>0<K>>>0)+F|0)|0,F=de>>31,mr=de>>31,K=A&mr,de=Cr-K|0,K=Ut-((P&F)+(Cr>>>0<K>>>0)|0)|0,F=x<<1|R>>>31,R=Bn|R<<1,x=F|Eo,Cr=0,mr=mr&1,Bn=mr,ge=ge+-1|0,!!ge;);return ME(de,K),F=x<<1|R>>>31,R=mr|R<<1,w=F|Cr,R}ME(R,x),R=0,x=0}return w=x,R}function Bd(R,x,A,P){return R=iwe(R,x,A,P),R}function ane(R,x,A,P){return R=owe(R,x,A,P),R}function cw(R,x,A,P){return nne(R,x,A,P),x=lJe()|0,R=S()|0,x=x|0,w=R,x}function ine(R){return R?31-h(R+-1^R)|0:32}var one=[null,me,ve,Pe,x2e,D];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return t}}}),Base_StrBuf:Q,Base_StrBufSize:W,Dtr_DaysPerMonth:ua,Dtr_FromNum:Qi,Dtr_Yr:go,Dtr_Mon:Ro,Dtr_DOM:$n,Dtr_Hour:ns,Dtr_Min:Iu,Dtr_Sec:wi,Dtr_Wdy:mp,Dtr_FracSec:zl,Dtr_Rounding:Ql,Dtr_Write:_c,Dtr_ToNum:Gd,Dtr_ToNumWithDuration:vl,Dtr_Days:wu,Dtr_ToDays:bs,Dtr_ToTime:hl,Dtr_UtcToLocal:id,Mathpack_Zero:as,Mathpack_One:Lv,Mathpack_Pi:qv,Mathpack_Div:e0,Mathpack_Mul:tk,Mathpack_Sub:PE,Mathpack_Add:J2,Mathpack_Power:Z2,Mathpack_Cond:iV,Mathpack_Cond2:Zm,Mathpack_TakeMathError:r0,Mathpack_Trunc:qf,Mathpack_Ceil:nk,Mathpack_Floor:O_,Mathpack_Abs:t0,Mathpack_Neg:$2,Mathpack_Float:ew,Mathpack_SFloat:ak,Mathpack_Fix:$m,Mathpack_LFix:AE,Mathpack_SFix:oV,Mathpack_Round:uV,Mathpack_RoundUp:ik,Mathpack_RoundDown:sV,Mathpack_TenTo:lV,Mathpack_Compare:rw,Mathpack_GetExp32:FE,Mathpack_Equal:lm,Mathpack_ViewRound:tw,Mathpack_Sqrt:cV,Mathpack_Exp:nw,Mathpack_Ln:dV,Mathpack_Log:aw,Mathpack_Sin:fV,Mathpack_Cos:ok,Mathpack_Tan:el,Mathpack_Asin:NE,Mathpack_Acos:iw,Mathpack_Atan:y2e,Mathpack_Atan2:_2e,Mathpack_Mod:b2e,Mathpack_FormatGeneral:C2e,Mathpack_FormatGetExponent:T2e,Mathpack_FormatGetSign:R2e,Mathpack_FormatFixed:E2e,Mathpack_FormatScientific:P2e,Mathpack_Pack:A2e,_start:D,__errno_location:ewe,setThrew:$2e,stackSave:rwe,stackAlloc:twe,stackRestore:nwe,__growWasmMemory:awe}}var The=new ArrayBuffer(65536),Bu=function(e){var r=new Uint8Array(e);return function(t,n){var a,o;if(typeof Buffer>"u")for(a=atob(n),o=0;o<a.length;o++)r[t+o]=a.charCodeAt(o);else for(a=Buffer.from(n,"base64"),o=0;o<a.length;o++)r[t+o]=a[o]}}(The);Bu(1024,"yAwAAAEAAAACAAAAAwAAAAAAAAAE");Bu(1056,"AQAAAAsAAAANAAAABwAAAAkAAAADAAAABQAAAA8AAAAAAAEAMAACADkAMQAcAAMAPQA6ADIAKgAmAB0AEQAEAD4ANwA7ACQANQAzACsAFgAtACcAIQAeABgAEgAMAAUAPwAvADgAGwA8ACkAJQAQADYAIwA0ABUALAAgABcACwAuABoAKAAPACIAFAAfAAoAGQAOABMACQANAAgABwAGAJAMAACYDAAAoAwAAKgMAAAfHR8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHB8eHx4fHx4fHh8fHR8eHx4fHx4fHh8=");Bu(1312,"WAwAAHAMAABoDAAAeAw=");Bu(1359,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B");Bu(1759,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B");Bu(2135,"oAQ=");Bu(2151,"yAc=");Bu(2167,"+go=");Bu(2182,"QJwO");Bu(2198,"UMMR");Bu(2214,"JPQU");Bu(2229,"gJaYGA==");Bu(2245,"ILy+Gw==");Bu(2261,"KGvuHg==");Bu(2277,"+QKVIg==");Bu(2292,"QLdDuiU=");Bu(2308,"EKXU6Cg=");Bu(2324,"KueEkSw=");Bu(2339,"gPQg5rUv");Bu(2355,"oDGpX+My");Bu(2371,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//w==");Bu(3126,"kEEYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/");Bu(3182,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQAAsOlNYnBCBAQAABAE");Bu(3904,"4E8=");var xr=dJe({Math:uJe.Math,Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:bg.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:bg.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:bg.Base_LocaleDecimalSeparator,Math_log10:bg.Math_log10,Math_log:bg.Math_log,Math_sqrt:bg.Math_sqrt,Math_sin:bg.Math_sin,Math_cos:bg.Math_cos,Math_tan:bg.Math_tan,Math_atan:bg.Math_atan,Math_exp:bg.Math_exp,proc_exit:sJe.proc_exit,getTempRet0:bg.getTempRet0},The),fJe=xr.memory;_e.memory=fJe;var pJe=xr.Base_StrBuf;_e.Base_StrBuf=pJe;var mJe=xr.Base_StrBufSize;_e.Base_StrBufSize=mJe;var gJe=xr.Dtr_DaysPerMonth;_e.Dtr_DaysPerMonth=gJe;var vJe=xr.Dtr_FromNum;_e.Dtr_FromNum=vJe;var hJe=xr.Dtr_Yr;_e.Dtr_Yr=hJe;var SJe=xr.Dtr_Mon;_e.Dtr_Mon=SJe;var yJe=xr.Dtr_DOM;_e.Dtr_DOM=yJe;var _Je=xr.Dtr_Hour;_e.Dtr_Hour=_Je;var bJe=xr.Dtr_Min;_e.Dtr_Min=bJe;var CJe=xr.Dtr_Sec;_e.Dtr_Sec=CJe;var TJe=xr.Dtr_Wdy;_e.Dtr_Wdy=TJe;var RJe=xr.Dtr_FracSec;_e.Dtr_FracSec=RJe;var EJe=xr.Dtr_Rounding;_e.Dtr_Rounding=EJe;var PJe=xr.Dtr_Write;_e.Dtr_Write=PJe;var AJe=xr.Dtr_ToNum;_e.Dtr_ToNum=AJe;var FJe=xr.Dtr_ToNumWithDuration;_e.Dtr_ToNumWithDuration=FJe;var NJe=xr.Dtr_Days;_e.Dtr_Days=NJe;var OJe=xr.Dtr_ToDays;_e.Dtr_ToDays=OJe;var kJe=xr.Dtr_ToTime;_e.Dtr_ToTime=kJe;var MJe=xr.Dtr_UtcToLocal;_e.Dtr_UtcToLocal=MJe;var xJe=xr.Mathpack_Zero;_e.Mathpack_Zero=xJe;var IJe=xr.Mathpack_One;_e.Mathpack_One=IJe;var wJe=xr.Mathpack_Pi;_e.Mathpack_Pi=wJe;var DJe=xr.Mathpack_Div;_e.Mathpack_Div=DJe;var LJe=xr.Mathpack_Mul;_e.Mathpack_Mul=LJe;var qJe=xr.Mathpack_Sub;_e.Mathpack_Sub=qJe;var GJe=xr.Mathpack_Add;_e.Mathpack_Add=GJe;var BJe=xr.Mathpack_Power;_e.Mathpack_Power=BJe;var UJe=xr.Mathpack_Cond;_e.Mathpack_Cond=UJe;var KJe=xr.Mathpack_Cond2;_e.Mathpack_Cond2=KJe;var VJe=xr.Mathpack_TakeMathError;_e.Mathpack_TakeMathError=VJe;var jJe=xr.Mathpack_Trunc;_e.Mathpack_Trunc=jJe;var WJe=xr.Mathpack_Ceil;_e.Mathpack_Ceil=WJe;var HJe=xr.Mathpack_Floor;_e.Mathpack_Floor=HJe;var zJe=xr.Mathpack_Abs;_e.Mathpack_Abs=zJe;var QJe=xr.Mathpack_Neg;_e.Mathpack_Neg=QJe;var XJe=xr.Mathpack_Float;_e.Mathpack_Float=XJe;var YJe=xr.Mathpack_SFloat;_e.Mathpack_SFloat=YJe;var JJe=xr.Mathpack_Fix;_e.Mathpack_Fix=JJe;var ZJe=xr.Mathpack_LFix;_e.Mathpack_LFix=ZJe;var $Je=xr.Mathpack_SFix;_e.Mathpack_SFix=$Je;var eZe=xr.Mathpack_Round;_e.Mathpack_Round=eZe;var rZe=xr.Mathpack_RoundUp;_e.Mathpack_RoundUp=rZe;var tZe=xr.Mathpack_RoundDown;_e.Mathpack_RoundDown=tZe;var nZe=xr.Mathpack_TenTo;_e.Mathpack_TenTo=nZe;var aZe=xr.Mathpack_Compare;_e.Mathpack_Compare=aZe;var iZe=xr.Mathpack_GetExp32;_e.Mathpack_GetExp32=iZe;var oZe=xr.Mathpack_Equal;_e.Mathpack_Equal=oZe;var uZe=xr.Mathpack_ViewRound;_e.Mathpack_ViewRound=uZe;var sZe=xr.Mathpack_Sqrt;_e.Mathpack_Sqrt=sZe;var lZe=xr.Mathpack_Exp;_e.Mathpack_Exp=lZe;var cZe=xr.Mathpack_Ln;_e.Mathpack_Ln=cZe;var dZe=xr.Mathpack_Log;_e.Mathpack_Log=dZe;var fZe=xr.Mathpack_Sin;_e.Mathpack_Sin=fZe;var pZe=xr.Mathpack_Cos;_e.Mathpack_Cos=pZe;var mZe=xr.Mathpack_Tan;_e.Mathpack_Tan=mZe;var gZe=xr.Mathpack_Asin;_e.Mathpack_Asin=gZe;var vZe=xr.Mathpack_Acos;_e.Mathpack_Acos=vZe;var hZe=xr.Mathpack_Atan;_e.Mathpack_Atan=hZe;var SZe=xr.Mathpack_Atan2;_e.Mathpack_Atan2=SZe;var yZe=xr.Mathpack_Mod;_e.Mathpack_Mod=yZe;var _Ze=xr.Mathpack_FormatGeneral;_e.Mathpack_FormatGeneral=_Ze;var bZe=xr.Mathpack_FormatGetExponent;_e.Mathpack_FormatGetExponent=bZe;var CZe=xr.Mathpack_FormatGetSign;_e.Mathpack_FormatGetSign=CZe;var TZe=xr.Mathpack_FormatFixed;_e.Mathpack_FormatFixed=TZe;var RZe=xr.Mathpack_FormatScientific;_e.Mathpack_FormatScientific=RZe;var EZe=xr.Mathpack_Pack;_e.Mathpack_Pack=EZe;var PZe=xr._start;_e._start=PZe;var AZe=xr.__errno_location;_e.__errno_location=AZe;var FZe=xr.setThrew;_e.setThrew=FZe;var NZe=xr.stackSave;_e.stackSave=NZe;var OZe=xr.stackAlloc;_e.stackAlloc=OZe;var kZe=xr.stackRestore;_e.stackRestore=kZe;var MZe=xr.__growWasmMemory;_e.__growWasmMemory=MZe});var fQ=T(vr=>{"use strict";p();var bA;Object.defineProperty(vr,"__esModule",{value:!0});vr.pack=vr.formatScientific=vr.formatFixed=vr.formatGeneral=vr.mod=vr.atan2=vr.atan=vr.acos=vr.asin=vr.tan=vr.cos=vr.sin=vr.log=vr.ln=vr.exp=vr.sqrt=vr.viewRound=vr.cond2=vr.cond=vr.power=vr.add=vr.sub=vr.mul=vr.div=vr.compare=vr.tenTo=vr.roundDown=vr.roundUp=vr.round=vr.sfix=vr.lfix=vr.fix=vr.float=vr.neg=vr.abs=vr.floor=vr.ceil=vr.trunc=vr.equal=vr.exp32=vr.pi=vr.one=vr.zero=vr.mathError=vr.MathErrorNum=void 0;var At=RM(),PM=oG(),Rhe=RM();function dQ(e,r){for(var t=new Uint16Array(Rhe.memory.buffer),n="",a=0;a<r;a+=1)n+=String.fromCharCode(t[e+(a<<1)>>1]);return n}function xZe(e,r){for(var t=new Uint16Array(Rhe.memory.buffer),n=0;n<r.length;n+=1)t[e+(n<<1)>>1]=r.charCodeAt(n)}var Ac;(function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"})(Ac||(vr.MathErrorNum=Ac={}));function EM(e){return{num:e}}var IZe=(bA={},bA[Ac.Over]=EM(Ac.Over),bA[Ac.Under]=EM(Ac.Under),bA[Ac.DivBy0]=EM(Ac.DivBy0),bA[Ac.Trans]=EM(Ac.Trans),bA);function C0(e){var r;return(r=IZe[e])!==null&&r!==void 0?r:EM(e)}vr.mathError=C0;function Np(e){return function(r){var t=e(r),n=(0,At.Mathpack_TakeMathError)();return n===Ac.None?t:C0(n)}}function T0(e){return function(r,t){var n=e(r,t),a=(0,At.Mathpack_TakeMathError)();return a===Ac.None?n:C0(a)}}vr.zero=At.Mathpack_Zero;vr.one=At.Mathpack_One;vr.pi=At.Mathpack_Pi;vr.exp32=At.Mathpack_GetExp32;function wZe(e,r){return(0,At.Mathpack_Equal)(e,r)!==0}vr.equal=wZe;vr.trunc=At.Mathpack_Trunc;vr.ceil=Np(At.Mathpack_Ceil);vr.floor=Np(At.Mathpack_Floor);vr.abs=At.Mathpack_Abs;vr.neg=At.Mathpack_Neg;function DZe(e){return e<0?(0,At.Mathpack_SFloat)(e):(0,At.Mathpack_Float)(e)}vr.float=DZe;function LZe(e){return(0,At.Mathpack_Fix)(e)>>>0}vr.fix=LZe;vr.lfix=At.Mathpack_LFix;vr.sfix=Np(At.Mathpack_SFix);vr.round=T0(At.Mathpack_Round);vr.roundUp=T0(At.Mathpack_RoundUp);vr.roundDown=T0(At.Mathpack_RoundDown);function qZe(e){if(e<-1e3)return 0;if(e>1e3||!isFinite(e))return C0(Ac.Over);var r=(0,At.Mathpack_TenTo)(e),t=(0,At.Mathpack_TakeMathError)();return t===Ac.None?r:C0(t)}vr.tenTo=qZe;vr.compare=At.Mathpack_Compare;vr.div=T0(At.Mathpack_Div);vr.mul=T0(At.Mathpack_Mul);vr.sub=T0(At.Mathpack_Sub);vr.add=T0(At.Mathpack_Add);vr.power=T0(At.Mathpack_Power);function GZe(e){var r=(0,At.Mathpack_Cond)(e),t=(0,At.Mathpack_TakeMathError)();return t===Ac.None?r:C0(t)}vr.cond=GZe;vr.cond2=At.Mathpack_Cond2;vr.viewRound=Np(At.Mathpack_ViewRound);vr.sqrt=Np(At.Mathpack_Sqrt);vr.exp=Np(At.Mathpack_Exp);vr.ln=Np(At.Mathpack_Ln);vr.log=Np(At.Mathpack_Log);vr.sin=Np(At.Mathpack_Sin);vr.cos=Np(At.Mathpack_Cos);vr.tan=Np(At.Mathpack_Tan);vr.asin=Np(At.Mathpack_Asin);vr.acos=Np(At.Mathpack_Acos);vr.atan=Np(At.Mathpack_Atan);vr.atan2=T0(At.Mathpack_Atan2);vr.mod=T0(At.Mathpack_Mod);function BZe(e,r,t){try{(0,PM.setLocale)(e);var n=(0,At.Mathpack_FormatGeneral)(r,t);return n<0?C0((0,At.Mathpack_TakeMathError)()):dQ((0,At.Base_StrBuf)(),n)}finally{(0,PM.setLocale)(void 0)}}vr.formatGeneral=BZe;function UZe(e,r,t){var n=(0,At.Mathpack_FormatFixed)(e,r,t);if(n<0)return(0,At.Mathpack_TakeMathError)();var a=dQ((0,At.Base_StrBuf)(),n),o=(0,At.Mathpack_FormatGetExponent)(),u=(0,At.Mathpack_FormatGetSign)()!==0;return{sign:u,mantissa:a,exponent:o}}vr.formatFixed=UZe;function KZe(e,r,t){var n=(0,At.Mathpack_FormatScientific)(e,r,t);if(n<0)return(0,At.Mathpack_TakeMathError)();var a=dQ((0,At.Base_StrBuf)(),n),o=(0,At.Mathpack_FormatGetExponent)(),u=(0,At.Mathpack_FormatGetSign)()!==0;return{sign:u,mantissa:a,exponent:o}}vr.formatScientific=KZe;function VZe(e,r,t,n){try{(0,PM.setLocale)(e);var a=(0,PM.fastMin)(n.length,(0,At.Base_StrBufSize)());xZe((0,At.Base_StrBuf)(),n.substring(0,a));var o=(0,At.Mathpack_Pack)(!!r,t,a),u=(0,At.Mathpack_TakeMathError)();return u!==Ac.None?C0(u):isNaN(o)?C0(Ac.Over):o}finally{(0,PM.setLocale)(void 0)}}vr.pack=VZe});var Nhe=T(Os=>{"use strict";p();Object.defineProperty(Os,"__esModule",{value:!0});Os.utcToLocal=Os.toTime=Os.TimeDivision=Os.toDays=Os.toNumWithDuration=Os.toNum=Os.fromNum=Os.dtr=Os.Rounding=Os.daysPerMonth=void 0;var al=RM(),AM=fQ();function jZe(e,r,t){return(0,al.Dtr_DaysPerMonth)(e,r,t?1:0)}Os.daysPerMonth=jZe;var Ehe;(function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"})(Ehe||(Os.Rounding=Ehe={}));function Ahe(e,r,t,n,a,o,u,s,l){return{yr:e,mon:r,dom:t,hour:n,min:a,sec:o,wdy:u,fracSec:s,rounding:l}}Os.dtr=Ahe;function Fhe(e){return Ahe((0,al.Dtr_Yr)(e),(0,al.Dtr_Mon)(e),(0,al.Dtr_DOM)(e),(0,al.Dtr_Hour)(e),(0,al.Dtr_Min)(e),(0,al.Dtr_Sec)(e),(0,al.Dtr_Wdy)(e),(0,al.Dtr_FracSec)(e),(0,al.Dtr_Rounding)(e))}function CA(e,r){(0,al.Dtr_Write)(r.yr,r.mon,r.dom,r.hour,r.min,r.sec,r.wdy,r.fracSec,r.rounding,e)}function WZe(e,r,t,n){var a=r,o=0,u=(0,al.Dtr_FromNum)(e,a,o,t?1:0,n?1:0);return u===0?Fhe(o):!1}Os.fromNum=WZe;function HZe(e,r,t){var n=0;CA(n,e);var a=(0,al.Dtr_ToNum)(n,r?1:0,t?1:0),o=(0,al.Mathpack_TakeMathError)();return o===AM.MathErrorNum.None?a:(0,AM.mathError)(o)}Os.toNum=HZe;function zZe(e,r,t,n,a){var o=0;CA(o,e);var u=n,s=(0,al.Dtr_ToNumWithDuration)(o,r?1:0,t?1:0,u,a),l=(0,al.Mathpack_TakeMathError)();return l===AM.MathErrorNum.None?s:(0,AM.mathError)(l)}Os.toNumWithDuration=zZe;function QZe(e,r,t){var n=0;CA(n,e);var a=(0,al.Dtr_ToDays)(n,r?1:0,t?1:0);return a===0?(0,al.Dtr_Days)():!1}Os.toDays=QZe;var Phe;(function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"})(Phe||(Os.TimeDivision=Phe={}));function XZe(e,r,t){var n=r,a=t,o=(0,al.Dtr_ToTime)(e,n,a),u=(0,al.Mathpack_TakeMathError)();return u===AM.MathErrorNum.None?o:!1}Os.toTime=XZe;function YZe(e,r,t,n){var a=0;CA(a,e);var o=1;r.standardDate!=null&&CA(o,r.standardDate);var u=2;r.daylightDate!=null&&CA(u,r.daylightDate);var s=(0,al.Dtr_UtcToLocal)(a,r.bias,r.standardDate!=null?o:-1,r.standardBias,r.daylightDate!=null?u:-1,r.daylightBias,t?1:0,n?1:0);return s===0?!1:Fhe(a)}Os.utcToLocal=YZe});var pQ=T(Sb=>{"use strict";p();Object.defineProperty(Sb,"__esModule",{value:!0});Sb.isSupported=Sb.dtr=Sb.mathpack=void 0;var JZe=fQ();Sb.mathpack=JZe;var ZZe=Nhe();Sb.dtr=ZZe;var $Ze=oG();Object.defineProperty(Sb,"isSupported",{enumerable:!0,get:function(){return $Ze.isSupported}});var e$e=RM();(0,e$e._start)()});var mQ=T(pd=>{"use strict";p();Object.defineProperty(pd,"__esModule",{value:!0});pd.xlDatepack=pd.TimeGranularity=pd.TimeDivision=pd.dateTime=pd.Rounding=pd.tzUTC=pd.tzData=void 0;var R0=pQ(),khe=tT(),r$e=jd();pd.tzData=(0,r$e.typedInstanceCreator)()(function(e,r,t,n,a){return{bias:e,standardDate:r,standardBias:t,daylightDate:n,daylightBias:a}});pd.tzUTC=(0,pd.tzData)(0,void 0,0,void 0,0);pd.Rounding=R0.dtr.Rounding;pd.dateTime=R0.dtr.dtr;pd.TimeDivision=R0.dtr.TimeDivision;var Ohe;(function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"})(Ohe||(pd.TimeGranularity=Ohe={}));function t$e(e,r,t){return R0.dtr.fromNum(e.mathpack.toNumber(r),t,e.date1904,e.dateCompatibility)}function n$e(e,r){var t=R0.dtr.toNum(r,e.date1904,e.dateCompatibility);return typeof t=="number"?e.mathpack.fromNumber(t):khe.numErrorOper}function a$e(e,r,t,n){var a=R0.dtr.toNumWithDuration(r,e.date1904,e.dateCompatibility,t,n);return typeof a=="number"?e.mathpack.fromNumber(a):khe.numErrorOper}function i$e(e,r){return R0.dtr.toDays(r,e.date1904,e.dateCompatibility)}function o$e(e,r,t,n){return R0.dtr.toTime(e.mathpack.toNumber(r),t,n)}function u$e(e,r,t){return R0.dtr.utcToLocal(r,t,e.date1904,e.dateCompatibility)}pd.xlDatepack={fromNum:t$e,toNum:n$e,toNumWithDuration:a$e,daysPerMonth:R0.dtr.daysPerMonth,toDays:i$e,toTime:o$e,utcToLocal:u$e}});var vQ=T(uG=>{"use strict";p();Object.defineProperty(uG,"__esModule",{value:!0});uG.xlMathpack=void 0;var Nn=pQ(),Mhe=tT(),yb=pm(),s$e=dy(),gQ=jd();function vi(e){var r={kind:s$e.OperKind.Number,_valueXL:e};return r}var xhe=vi(Nn.mathpack.zero()),l$e=vi(Nn.mathpack.one()),c$e=vi(Nn.mathpack.pi());function il(e){return e.num&Nn.mathpack.MathErrorNum.DivBy0?Mhe.div0ErrorOper:Mhe.numErrorOper}function ST(e){return function(r){return(0,yb.assertFalse)("calc.lang.".concat(e,": error ").concat(JSON.stringify(r)))}}function Xd(e,r,t){return function(n){var a=e(n._valueXL);return typeof a=="number"?r(a):t(a)}}function ih(e,r,t){return function(n,a){var o=e(n._valueXL,a._valueXL);return typeof o=="number"?r(o):t(o)}}var d$e=ih(function(e,r){return Nn.mathpack.equal(r,2)?Nn.mathpack.mul(e,e):Nn.mathpack.power(e,r)},vi,il),f$e=Xd(function(e){return Nn.mathpack.div(e,100)},vi,ST("xlPercent"));function p$e(e){return Ihe(e)!==0?vi(Nn.mathpack.neg(e._valueXL)):e}function m$e(e,r,t){var n=r._valueXL,a=Nn.mathpack.formatGeneral(e,n,t);return typeof a!="string"?(0,yb.assertFalse)("calc.lang.xlFormatGeneral: error ".concat(JSON.stringify(a))):a}function g$e(e,r,t){var n=e._valueXL,a=Nn.mathpack.formatFixed(n,r,t);return typeof a!="object"?(0,yb.assertFalse)("calc.lang.xlFormatFixed: error ".concat(JSON.stringify(a))):a}function v$e(e,r,t){var n=e._valueXL,a=Nn.mathpack.formatScientific(n,r,t);return typeof a!="object"?(0,yb.assertFalse)("calc.lang.xlFormatScientific: error ".concat(JSON.stringify(a))):a}function h$e(e,r,t,n){var a=Nn.mathpack.pack(e,r,t,n);return typeof a!="number"?(0,yb.assertFalse)("calc.lang.xlParse: error ".concat(JSON.stringify(a))):vi(a)}var S$e=Xd(Nn.mathpack.ceil,vi,ST("xlCeil")),y$e=Xd(Nn.mathpack.floor,vi,ST("xlFloor")),Ihe=Xd(Nn.mathpack.cond,gQ.identity,ST("xlCond, isSupported = ".concat((0,Nn.isSupported)()))),_$e=ih(Nn.mathpack.cond2,gQ.identity,ST("xlCond2"));function b$e(e,r){var t=e._valueXL,n=r._valueXL;return Nn.mathpack.exp32(t)-Nn.mathpack.exp32(n)>=52428800?xhe:r}var C$e=Xd(Nn.mathpack.sfix,gQ.identity,ST("xlSfix")),T$e=Xd(Nn.mathpack.viewRound,vi,ST("xlViewRound"));function R$e(e){(0,yb.assertInteger)("calc.lang.xlTenTo",e);var r=Nn.mathpack.tenTo(e);return typeof r=="number"?vi(r):il(r)}function E$e(e){return(0,yb.assertTrue)("calc.lang.xlFromNumber",isFinite(e)),vi(e)}function P$e(e){var r=e._valueXL;return(0,yb.assertTrue)("calc.lang.xlToNumber",isFinite(r)),r}uG.xlMathpack={zero:xhe,one:l$e,pi:c$e,add:ih(Nn.mathpack.add,vi,il),sub:ih(Nn.mathpack.sub,vi,il),mul:ih(Nn.mathpack.mul,vi,il),div:ih(Nn.mathpack.div,vi,il),power:d$e,percent:f$e,neg:p$e,compare:function(r,t){return Nn.mathpack.compare(r._valueXL,t._valueXL)},formatGeneral:m$e,formatFixed:g$e,formatScientific:v$e,parse:h$e,trunc:function(r){return vi(Nn.mathpack.trunc(r._valueXL))},ceil:S$e,floor:y$e,abs:function(r){return vi(Nn.mathpack.abs(r._valueXL))},cond:Ihe,cond2:_$e,fromNumber:E$e,toNumber:P$e,sqrt:Xd(Nn.mathpack.sqrt,vi,il),exp:Xd(Nn.mathpack.exp,vi,il),ln:Xd(Nn.mathpack.ln,vi,il),log:Xd(Nn.mathpack.log,vi,il),sin:Xd(Nn.mathpack.sin,vi,il),cos:Xd(Nn.mathpack.cos,vi,il),tan:Xd(Nn.mathpack.tan,vi,il),asin:Xd(Nn.mathpack.asin,vi,il),acos:Xd(Nn.mathpack.acos,vi,il),atan:Xd(Nn.mathpack.atan,vi,il),atan2:ih(Nn.mathpack.atan2,vi,il),mod:ih(Nn.mathpack.mod,vi,il),round:ih(Nn.mathpack.round,vi,il),roundUp:ih(Nn.mathpack.roundUp,vi,il),roundDown:ih(Nn.mathpack.roundDown,vi,il),tenTo:R$e,checkAlmostCancellation:b$e,fix:function(r){return Nn.mathpack.fix(r._valueXL)},lfix:function(r){return Nn.mathpack.lfix(r._valueXL)},sfix:C$e,viewRound:T$e}});var TQ=T(Fr=>{"use strict";p();var Fc,yT,_T,On,oh,TA;Object.defineProperty(Fr,"__esModule",{value:!0});Fr.getEnglishLocaleInfo=Fr.createIsThousandsPositionCallback=Fr.createWorksheetFuncNameCallbacks=Fr.getEnglishWorksheetFuncIdToName=Fr.operatorIdToName=Fr.englishOperatorIdToName=Fr.englishErrorTypeToName=Fr.englishWorksheetFuncIdToName=Fr.englishSysTimeFormat=Fr.englishSysDateFormat=Fr.englishPictureDbnum=Fr.englishPictureColor=Fr.englishPictureSingle=Fr.englishPictureSpecial=Fr.englishSpecialRefNames=Fr.englishErrorNames=Fr.isIdentContinue=Fr.isIdentStart=Fr.getNumberShape=Fr.getOrdinal=Fr.isNumeral=Fr.PictureDbnum=Fr.PictureColor=Fr.PictureSingle=Fr.PictureSpecial=Fr.LCID=Fr.Country=Fr.localeInfo=Fr.calcConfig=Fr.ulsLogger=Fr.NulLogger=Fr.TraceLevel=Fr.LogCategory=void 0;var _Q=nl();Object.defineProperty(Fr,"LogCategory",{enumerable:!0,get:function(){return _Q.LogCategory}});Object.defineProperty(Fr,"TraceLevel",{enumerable:!0,get:function(){return _Q.TraceLevel}});Object.defineProperty(Fr,"NulLogger",{enumerable:!0,get:function(){return _Q.NulLogger}});var Dhe=jd(),_b=pm();Object.defineProperty(Fr,"ulsLogger",{enumerable:!0,get:function(){return _b.ulsLogger}});var hy=aA(),PA=cT(),Lhe=vhe(),A$e=hhe(),Yd=tT(),RA=Ep(),ol=Lq(),whe=mQ(),F$e=vQ();function N$e(e,r,t,n,a,o,u){return r===void 0&&(r=RA.RefStyle.A1),t===void 0&&(t=F$e.xlMathpack),n===void 0&&(n=!1),a===void 0&&(a=!0),o===void 0&&(o=whe.tzUTC),u===void 0&&(u=whe.xlDatepack),{localeInfo:e,refStyle:r,mathpack:t,date1904:n,dateCompatibility:a,timezone:o,datepack:u}}Fr.calcConfig=N$e;function qhe(e,r,t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N,k,q,V,I,M,B,U,j,X,ee,re,Z,J,C,S,b,O,w,D,Q,W,$,me,ve,Pe,ua,Qi,go,Ro,$n,ns,Iu,wi,mp,zl,Ql,_c,Gd,vl,wu,bs,hl,id,as,Lv,qv,e0,tk,PE){return{getWorksheetFuncId:e,getWorksheetFuncName:r,isNumeral:t,getOrdinal:n,getNumberShape:a,isThousandsPosition:o,isIdentStart:u,isIdentContinue:s,stringCompareCI:l,errorNames:c,specialRefNames:d,trueName:f,falseName:m,rowLetter:v,columnLetter:h,leftBrace:y,rightBrace:_,leftBracket:E,rightBracket:N,rcLeftBracket:k,rcRightBracket:q,decimalSeparator:V,listSeparator:I,columnSeparator:M,rowSeparator:B,thousandsSeparator:U,statementSeparator:j,lcid:X,country:ee,isThai:re,isEastAsia:Z,isKorea:J,isJapan:C,isChinaT:S,isChinaS:b,isComplexScript:O,numberDecimals:w,isExpSepBySpace:D,fractionSeparator:Q,isPercentSepBySpace:W,currencyFormat:$,isCurrencySymbolLead:me,isCurrencySepBySpace:ve,currencySymbol:Pe,currencyDecimals:ua,dateOrder:Qi,dateSeparator:go,dateAltSeparator:Ro,year4Digits:$n,month2Digits:ns,day2Digits:Iu,longDateFormat:wi,timeSeparator:mp,timeAltSeparator:zl,hour2Digits:Ql,clock24Hour:_c,isAMPMSepBySpace:Gd,ampmSymbols:vl,dayNameShort:wu,dayNameLong:bs,monthNameShort:hl,monthNameLong:id,pictureSpecial:as,pictureSingle:Lv,pictureColor:qv,pictureDbnum:e0,sysDateFormat:tk,sysTimeFormat:PE}}Fr.localeInfo=qhe;var SQ;(function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"})(SQ||(Fr.Country=SQ={}));var yQ;(function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.Indonesia=1057]="Indonesia",e[e.EnglishIndonesia=14345]="EnglishIndonesia",e[e.EnglishIndia=16393]="EnglishIndia",e[e.Singapore=4100]="Singapore",e[e.EnglishSingapore=18441]="EnglishSingapore",e[e.Serbia=9242]="Serbia",e[e.Mexico=2058]="Mexico",e[e.Ireland=6153]="Ireland",e[e.EnglishZimbabwe=12297]="EnglishZimbabwe",e[e.Belgium=2067]="Belgium",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"})(yQ||(Fr.LCID=yQ={}));var bT;(function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"})(bT||(Fr.PictureSpecial=bT={}));var kn;(function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"})(kn||(Fr.PictureSingle=kn={}));var uh;(function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"})(uh||(Fr.PictureColor=uh={}));var EA;(function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"})(EA||(Fr.PictureDbnum=EA={}));function bQ(e){var r=e|0;if(r<128)return r>=48&&r<58;var t=r&2147483632,n=r&15;switch(t){case 1632:case 1776:return n<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return n>=6&&n<=15;case 3664:case 3792:case 3872:case 4160:return n<=9;case 4960:return n>=9;case 4976:return n<=1;case 6112:case 6160:return n<=9;default:return!1}}Fr.isNumeral=bQ;function Ghe(e){var r=e|0;if(r<128)return(r<48||r>=58)&&(0,_b.assertFalse)("calc.config.getOrdinal"),r&15;var t=r&2147483632,n=r&15,a;switch(t){case 1632:case 1776:a=n;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:a=n-6;break;case 3664:case 3792:case 3872:case 4160:a=n;break;case 4960:a=n-8;break;case 4976:a=n+8;break;case 6112:case 6160:a=n;break;default:return(0,_b.assertFalse)("calc.config.getOrdinal")}return(a<0||a>9||r===4968)&&(0,_b.assertFalse)("calc.config.getOrdinal"),a}Fr.getOrdinal=Ghe;function Bhe(e){var r=e|0;if(r<128)return(r<48||r>=58)&&(0,_b.assertFalse)("calc.config.getNumberShape"),ol.NumberShape.ASCII;switch(bQ(r)||(0,_b.assertFalse)("calc.config.getNumberShape"),r&2147483632){case 1632:return ol.NumberShape.ArabicIndic;case 1776:return ol.NumberShape.ExtendedArabicIndic;case 2400:return ol.NumberShape.Devanagari;case 2528:return ol.NumberShape.Bengali;case 2656:return ol.NumberShape.Gurmukhi;case 2784:return ol.NumberShape.Gujarati;case 2912:return ol.NumberShape.Oriya;case 3040:return ol.NumberShape.Tamil;case 3168:return ol.NumberShape.Telugu;case 3296:return ol.NumberShape.Kannada;case 3424:return ol.NumberShape.Malayalam;case 3664:return ol.NumberShape.Thai;case 3792:return ol.NumberShape.Lao;case 3872:return ol.NumberShape.Tibetan;case 4160:return ol.NumberShape.Myanmar;case 4960:case 4976:return ol.NumberShape.Ethiopic;case 6112:return ol.NumberShape.Khmer;case 6160:return ol.NumberShape.Mongolian;default:return(0,_b.assertFalse)("calc.config.getNumberShape")}}Fr.getNumberShape=Bhe;var Uhe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,0,0,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0]);function Khe(e){var r=e|0;return r>=0&&r<128?Uhe[r]>=2:(0,Lhe.isIdentStart)(r)}Fr.isIdentStart=Khe;function Vhe(e){var r=e|0;return r>=0&&r<128?Uhe[r]>=1:(0,Lhe.isIdentContinue)(r)}Fr.isIdentContinue=Vhe;Fr.englishErrorNames=(0,PA.partialArray)((Fc={},Fc[Yd.ErrorType.NULL]="#NULL!",Fc[Yd.ErrorType.DIV0]="#DIV/0!",Fc[Yd.ErrorType.VALUE]="#VALUE!",Fc[Yd.ErrorType.REF]="#REF!",Fc[Yd.ErrorType.NAME]="#NAME?",Fc[Yd.ErrorType.NUM]="#NUM!",Fc[Yd.ErrorType.NA]="#N/A",Fc[Yd.ErrorType.GETTING_DATA]="#GETTING_DATA",Fc[Yd.ErrorType.SPILL]="#SPILL!",Fc[Yd.ErrorType.CONNECT]="#CONNECT!",Fc[Yd.ErrorType.BLOCKED]="#BLOCKED!",Fc[Yd.ErrorType.UNKNOWN]="#UNKNOWN!",Fc[Yd.ErrorType.FIELD]="#FIELD!",Fc[Yd.ErrorType.CALC]="#CALC!",Fc[Yd.ErrorType.BUSY]="#BUSY!",Fc[Yd.ErrorType.EXTERNAL]="#EXTERNAL!",Fc));Fr.englishSpecialRefNames=(0,PA.partialArray)((yT={},yT[RA.SpecialRefId.All]="#All",yT[RA.SpecialRefId.Data]="#Data",yT[RA.SpecialRefId.Headers]="#Headers",yT[RA.SpecialRefId.Totals]="#Totals",yT[RA.SpecialRefId.ThisRow]="#This Row",yT));Fr.englishPictureSpecial=(0,PA.partialArray)((_T={},_T[bT.AP1]="AM/PM",_T[bT.AP2]="A/P",_T[bT.AP3]="\u4E0A\u5348/\u4E0B\u5348",_T[bT.General]="General",_T[bT.Currency]="$",_T));Fr.englishPictureSingle=(0,PA.partialArray)((On={},On[kn.Sep]=";",On[kn.Hash]="#",On[kn.Zero]="0",On[kn.Decimal]=".",On[kn.Percent]="%",On[kn.Comma]=",",On[kn.Colon]=":",On[kn.DateSep]="/",On[kn.Slash]="/",On[kn.Space]=" ",On[kn.Minus]="-",On[kn.Plus]="+",On[kn.OpenParen]="(",On[kn.CloseParen]=")",On[kn.Backslash]="\\",On[kn.Star]="*",On[kn.Year]="y",On[kn.Month]="m",On[kn.Day]="d",On[kn.Hour]="h",On[kn.Minute]="m",On[kn.Second]="s",On[kn.E]="E",On[kn.APDelim]="/",On[kn.Quote]='"',On[kn.ColorStart]="[",On[kn.ColorEnd]="]",On[kn.Text]="@",On[kn.Question]="?",On[kn.Underscore]="_",On[kn.Reign]="r",On[kn.LocDay]="a",On[kn.Era]="g",On[kn.EraYear]="e",On[kn.BidiDate]="B",On[kn.BidiNum]="N",On[kn.DayTh]="\u0E27",On[kn.MonthTh]="\u0E14",On[kn.YearTh]="\u0E1B",On[kn.EngYearTh]="b",On[kn.ThYear]="\u0E04",On[kn.HourTh]="\u0E0A",On[kn.MinuteTh]="\u0E19",On[kn.SecondTh]="\u0E17",On[kn.ZeroTh]="\u0E50",On));Fr.englishPictureColor=(0,PA.partialArray)((oh={},oh[uh.Black]="Black",oh[uh.White]="White",oh[uh.Red]="Red",oh[uh.Green]="Green",oh[uh.Blue]="Blue",oh[uh.Yellow]="Yellow",oh[uh.Magenta]="Magenta",oh[uh.Cyan]="Cyan",oh[uh.Color]="Color",oh));Fr.englishPictureDbnum=(0,PA.partialArray)((TA={},TA[EA.DBNUM1]="DBNum1",TA[EA.DBNUM2]="DBNum2",TA[EA.DBNUM3]="DBNum3",TA[EA.DBNUM4]="DBNum4",TA));Fr.englishSysDateFormat="dddd, mmmm dd, yyyy";Fr.englishSysTimeFormat="h:mm:ss AM/PM";var sG=void 0;function O$e(e){var r=CQ()[e];return r===void 0?"wsf:".concat(e):r}Fr.englishWorksheetFuncIdToName=O$e;function k$e(e){var r=Fr.englishErrorNames[e];return r===void 0?"error.type:".concat(e):r}Fr.englishErrorTypeToName=k$e;function M$e(e){if(e===hy.OperatorId.Isect)return" ";if(e===hy.OperatorId.Union)return",";var r=hy.operatorStrings[e];return r===void 0?"op:".concat(e):r}Fr.englishOperatorIdToName=M$e;function x$e(e,r,t){return r===hy.OperatorId.Isect?t:r===hy.OperatorId.Union?e.listSeparator:hy.operatorStrings[r]}Fr.operatorIdToName=x$e;var I$e=/_/g;function CQ(){if(sG==null){sG=[];for(var e=0,r=(0,Dhe.numEnumArray)(hy.WorksheetFuncId);e<r.length;e++){var t=r[e],n=(0,hy.getWorksheetFuncEnglishName)(t),a=n??hy.WorksheetFuncId[t].replace(I$e,".");sG[t]=a}}return sG}Fr.getEnglishWorksheetFuncIdToName=CQ;function w$e(e,r){var t=[];return r.forEach(function(n,a){n!=null&&t.push([n,a])}),A$e.ArrayMapTree.create(e).setValues(t)}function jhe(e,r){var t=w$e(e,r);return{getWorksheetFuncId:function(a){return t.getValue(a)},getWorksheetFuncName:function(a){var o=r[a];return o??(0,_b.assertFalse)("calc.config.getWorksheetFuncName: unknown function ID ".concat(a))}}}Fr.createWorksheetFuncNameCallbacks=jhe;function D$e(e){if(e.length===0||e[0]===0)return function(){return!1};if(e.length===2&&e[1]===0){var r=e[0];return function(n){return n>0&&n%r===0}}var t=e[e.length-1]===0&&e.length>=2;return function(n){if(n<=0)return!1;for(var a=n,o=0;o<e.length&&(a-=e[o],!(a<=0));o+=1);if(a>0&&t){var u=e[e.length-2];return a%u===0}return a===0}}Fr.createIsThousandsPositionCallback=D$e;var hQ=void 0;function L$e(){return hQ==null&&(hQ=q$e()),hQ}Fr.getEnglishLocaleInfo=L$e;function q$e(){var e="en-US",r=CQ(),t=(0,Dhe.makeStringCompareCI)(e),n=jhe(t,r),a=n.getWorksheetFuncId,o=n.getWorksheetFuncName;return qhe(a,o,bQ,Ghe,Bhe,function(u){return u>0&&u%3===0},Khe,Vhe,t,Fr.englishErrorNames,Fr.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]","[","]",".",",",",",";",",",";",yQ.USA,SQ.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,ol.CurrencyFormat.Paren,!0,!1,"$",2,ol.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],Fr.englishPictureSpecial,Fr.englishPictureSingle,Fr.englishPictureColor,Fr.englishPictureDbnum,Fr.englishSysDateFormat,Fr.englishSysTimeFormat)}});var RQ=T(AA=>{"use strict";p();Object.defineProperty(AA,"__esModule",{value:!0});AA.formatScientificLeft=AA.numberComponents=void 0;var G$e=jd();AA.numberComponents=(0,G$e.typedInstanceCreator)()(function(e,r,t){return{sign:e,mantissa:r,exponent:t}});function B$e(e,r){if(r<=1)return r;var t=e%r;return t===0?r:t<0?t+r:t}AA.formatScientificLeft=B$e});var Whe=T(lG=>{"use strict";p();Object.defineProperty(lG,"__esModule",{value:!0});lG.relabelFormula=void 0;var Op=fe(),Jr=Ep(),U$e=gA();function K$e(){var e=1;return function(){return e++}}function V$e(e,r){r===void 0&&(r=K$e());var t=e.spans,n=e.annotations,a=e.depthUpperBound,o=[],u=[],s=[],l=[];function c(W){var $=r(),me=t[W];me!=null&&(o[$]=me);var ve=n[W];return ve!=null&&(u[$]=ve),s[W]=$,l[$]=W,$}function d(W){return Op.__assign(Op.__assign({},W),{label:c(W.label)})}function f(W){if(W.kind===Jr.CellRefKind.Range){var $=W;return(0,Jr.cellRefRange)(f($.ref1),f($.ref2),c(W.label))}return Op.__assign(Op.__assign({},W),{label:c(W.label)})}function m(W){return W!=null?(0,Jr.documentQualifier)(W.document,W.path,W.isQuoted,c(W.label)):void 0}function v(W){if(W!=null)return W.kind===Jr.QualifierKind.Sheet||W.kind===Jr.QualifierKind.SheetRange?Op.__assign(Op.__assign({},W),{document:m(W.document),label:c(W.label)}):Op.__assign(Op.__assign({},W),{label:c(W.label)})}function h(W){if(W!=null)return W.kind===Jr.QualifierKind.Sheet||W.kind===Jr.QualifierKind.SheetRange?Op.__assign(Op.__assign({},W),{document:m(W.document),label:c(W.label)}):Op.__assign(Op.__assign({},W),{label:c(W.label)})}function y(W){var $=(0,Jr.flattenNameParts)(W),me=function(mp,zl){var Ql=zl.rhs,_c=zl.canDenoteNamedObject,Gd=zl.label,vl=zl.qualifiedLabel;return(0,Jr.fieldRefNamePart)(mp,E(Ql),_c,c(Gd),c(vl))};if($.kind===Jr.NamePartKind.IdentNamePart){var ve=$.parts,Pe=ve[0],ua=ve.slice(1),Qi=(0,Jr.identNamePart)(Pe.asWhole,Pe.canDenoteNamedObject,c(Pe.label),c(Pe.qualifiedLabel));return ua.reduce(me,Qi)}var go=$.parts,Ro=go[0],$n=go[1],ns=go.slice(2),Iu=(0,Jr.cellRefNamePart)(f(Ro.ref),Ro.asWhole,c(Ro.label),c(Ro.qualifiedLabel));return ns.reduce(me,me(Iu,$n))}function _(W){switch(W.kind){case Jr.NodeKind.Ident:return V(W);case Jr.NodeKind.Missing:return(0,Jr.missingNode)(W.chars,c(W.label));case Jr.NodeKind.BadChars:return(0,Jr.badCharsNode)(W.type,W.chars,c(W.label))}}function E(W){return(0,Jr.fieldRef)(_(W.field),W.isBracketed,W.isClosed,W.shouldBeBracketed,c(W.label))}function N(W){switch(W==null?void 0:W.kind){case void 0:return;case Jr.StructRefKind.SpecialRef:return(0,Jr.specialRef)(W.id,W.isBracketed,W.isClosed,c(W.label));case Jr.StructRefKind.ColumnRef:return(0,Jr.columnRef)(W.name,W.isBracketed,W.isClosed,c(W.label));case Jr.StructRefKind.RangeOpRef:return(0,Jr.rangeOpRef)(N(W.lhs),N(W.rhs),c(W.label));case Jr.StructRefKind.CommaOpRef:return(0,Jr.commaOpRef)(W.refs.map(N),c(W.label));case Jr.StructRefKind.ThisRowOpRef:return(0,Jr.thisRowOpRef)(W.ref!==void 0?N(W.ref):void 0,c(W.label));case Jr.StructRefKind.MissingRef:return(0,Jr.missingRef)(c(W.label));case Jr.StructRefKind.BadRef:return(0,Jr.badRef)(W.chars,W.isBracketed,W.isClosed,c(W.label))}}function k(W,$,me){return(0,Jr.nameNode)(y(W),h($),c(me))}function q(W){var $=W.parts,me=W.qualifier,ve=W.label;return k($,me,ve)}function V(W){var $=W.whole,me=W.label;return(0,Jr.identNode)($,c(me))}function I(W){var $=W.name,me=W.label;return(0,Jr.varNode)(V($),c(me))}function M(W){switch(W.kind){case Jr.NodeKind.Ident:return V(W);case Jr.NodeKind.Missing:return(0,Jr.missingNode)(W.chars,c(W.label));case Jr.NodeKind.BadChars:return(0,Jr.badCharsNode)(W.type,W.chars,c(W.label))}}function B(W){var $=(0,Jr.paramName)(M(W.name.name),W.name.isBracketed,W.name.isClosed,c(W.name.label)),me=W.def===void 0?void 0:(0,Jr.paramDefault)(W.def.rhs,c(W.def.label));return(0,Jr.paramNode)($,me,c(W.label))}function U(W){return(0,Jr.structRef)(N(W.innerRef),W.isClosed,c(W.label))}for(var j={literalNode:function($,me,ve){return(0,Jr.literalNode)($,me,c(ve))},arrayNode:function($,me,ve){return(0,Jr.arrayNode)($,me,c(ve))},appNode:function($,me,ve,Pe){return(0,Jr.appNode)($,me,ve,c(Pe))},letNode:function($,me,ve,Pe,ua,Qi){return(0,Jr.letNode)($,me.map(function(go){var Ro=go.name,$n=go.binder;return(0,Jr.letVar)((0,Jr.indexedArg)(I(Ro.arg),Ro.index),$n)}),ve,Pe,ua,c(Qi))},lambdaNode:function($,me,ve,Pe,ua,Qi){return(0,Jr.lambdaNode)($,me.map(function(go){var Ro=go.name;return(0,Jr.lambdaParam)((0,Jr.indexedArg)(B(Ro.arg),Ro.index))}),ve,Pe,ua,c(Qi))},parenNode:function($,me,ve){return(0,Jr.parenNode)($,me,c(ve))},nameNode:function($,me,ve){return k($,me,ve)},cellRefNode:function($,me,ve){return(0,Jr.cellRefNode)(f($),v(me),c(ve))},fieldRefNode:function($,me,ve){return(0,Jr.fieldRefNode)($,E(me),c(ve))},structRefNode:function($,me,ve){return(0,Jr.structRefNode)($===void 0?void 0:q($),U(me),c(ve))},missingNode:function($,me){return(0,Jr.missingNode)($,c(me))},badSequenceNode:function($,me,ve){return(0,Jr.badSequenceNode)($,me,c(ve))},badCharsNode:function($,me,ve){return(0,Jr.badCharsNode)($,me,c(ve))},operatorNode:function($,me){return(0,Jr.operatorNode)($,c(me))},wsfNode:function($,me,ve){return(0,Jr.wsfNode)($,me,c(ve))}},X=(0,Jr.formula)((0,U$e.reduceBottomUp)(j,e),o,u,a),ee=0,re=Object.keys(u);ee<re.length;ee++){var Z=re[ee],J=Number(Z),C=u[J];switch(C==null?void 0:C.kind){case Jr.AnnotationKind.LocalNameUse:u[J]=(0,Jr.localNameUseAnnotation)(C.name,C.whole,s[C.label]);break;case Jr.AnnotationKind.LocalNameDecl:u[J]=(0,Jr.localNameDeclAnnotation)(C.name,C.whole,C.uses.map(function(W){var $=W.label;return{label:s[$]}}));break}}for(var S=0,b=Object.keys(o).map(Number);S<b.length;S++){var O=b[S],w=o[O],D=w==null?void 0:w.preComments,Q=w==null?void 0:w.postComments;(D||Q)&&(o[O]=Op.__assign(Op.__assign({},w),{preComments:D?D.map(d):void 0,postComments:Q?Q.map(d):void 0}))}return{formula:X,oldToNewLabel:s,newToOldLabel:l}}lG.relabelFormula=V$e});var Xhe=T(dG=>{"use strict";p();Object.defineProperty(dG,"__esModule",{value:!0});dG.ieeeMathpack=void 0;var j$e=fe(),cG=tT(),W$e=jd(),bb=RQ(),H$e=j$e.__importStar(vM()),z$e=cT(),Hhe=pm(),Q$e=dy(),X$e=iA(),zhe=H$e.codePointDigitZero;function Nc(e){var r={kind:Q$e.OperKind.Number,_valueIEEE:e};return r}var CT=Nc(0),Y$e=Nc(1),J$e=Nc(Math.PI);function md(e){return isFinite(e)?Nc(e):cG.numErrorOper}function Z$e(e,r){var t=e._valueIEEE,n=r._valueIEEE;return n===0?cG.div0ErrorOper:md(t/n)}function $$e(e,r){var t=e._valueIEEE,n=r._valueIEEE,a=Math.pow(t,n);return isFinite(a)?Nc(a):isNaN(a)?cG.div0ErrorOper:cG.numErrorOper}function EQ(e,r){var t=e._valueIEEE,n=r._valueIEEE;return t<n?-1:t>n?1:0}function eer(e,r,t){var n=e.decimalSeparator,a=r._valueIEEE,o=String(a).replace("e","E");return n!=="."&&(o=o.replace(".",n)),o}function rer(e){for(var r=0;r<e.length;r+=1)if(e.charCodeAt(r)!==zhe)return!1;return!0}function TT(e,r){var t=r===void 0?e.toExponential():e.toExponential(r),n=t.indexOf("e"),a=!(0,z$e.stringStartsWith)(t,"-"),o=t.substring(a?0:1,n).replace(".",""),u=parseInt(t.substring(n+1),10)+1;return rer(o)?{sign:a,mantissa:"",exponent:0}:{sign:a,mantissa:o,exponent:u}}function ter(e,r,t){var n,a=e._valueIEEE,o=TT(a),u=o.sign,s=o.mantissa,l=o.exponent,c=t+(l+r);if(c===0){var d=parseFloat("5e"+String(l-1));if(Math.abs(a)>=d)return(0,bb.numberComponents)(u,"1",l+r+1)}if(c<1)return(0,bb.numberComponents)(!0,"",0);c<=21&&(n=TT(a,c-1),u=n.sign,s=n.mantissa,l=n.exponent,c=t+(l+r));var f=s.substring(0,c);return(0,bb.numberComponents)(u,f,f.length===0?0:l+r)}function ner(e,r,t){var n,a=e._valueIEEE,o=TT(a),u=o.sign,s=o.mantissa,l=o.exponent,c=(0,bb.formatScientificLeft)(l,r),d=c+t;if((0,Hhe.assertTrue)("calc.lang.ieeeFormatScientific",d>0),d===0){var f=parseFloat("5e"+String(l-1));if(Math.abs(a)>=f)return(0,bb.numberComponents)(u,"",l+1)}if(d<1)return(0,bb.numberComponents)(!0,"",0);d<=21&&(n=TT(a,d-1),u=n.sign,s=n.mantissa,l=n.exponent,c=(0,bb.formatScientificLeft)(l,r),d=c+t);var m=s.substring(0,d);return(0,bb.numberComponents)(u,m,m.length===0?0:l)}var aer=["0","1","2","3","4","5","6","7","8","9"];function ier(e,r){for(var t=e.getOrdinal,n="",a=0,o=(0,X$e.codePointIterator)(r);a<o.length;a++){var u=o[a];n+=aer[t(u)]}return n}function oer(e,r,t,n){return Nc(+((r?"":"-")+"0."+ier(e,n)+"E"+String(t)))}function FM(e){var r=e._valueIEEE;return Nc(r<0?Math.ceil(r):Math.floor(r))}function Qhe(e){var r=e._valueIEEE;return Nc(Math.floor(r))}function uer(e){var r=e._valueIEEE;return Nc(Math.ceil(r))}function ser(e,r){var t=e._valueIEEE;if(t===0)return CT;var n=TT(t).exponent,a=FM(r)._valueIEEE+n;if(a===0){var o=parseFloat("5e"+String(n-1));if(Math.abs(t)>=o)return md((t<0?-1:1)*parseFloat("10e"+String(n-1)))}return a<1?CT:a>21?e:md(parseFloat(t.toExponential(a-1)))}function PQ(e){return e.substring(0,1)+"."+e.substring(1)}function ler(e,r){if(e.length<=r)return PQ(e);for(var t=e.substring(0,r),n=0,a=t.length-1;a>=0&&t.charCodeAt(a)-zhe===9;a-=1)n+=1;if(n===t.length)return"10";var o=t.substring(0,t.length-n-1)+String.fromCharCode(t.charCodeAt(t.length-n-1)+1);return PQ(o)}function cer(e,r){var t=e._valueIEEE;if(t===0)return CT;var n=TT(t),a=n.sign,o=n.mantissa,u=n.exponent,s=FM(r)._valueIEEE+u;return s<1?md(parseFloat((a?"":"-")+"10e"+String(u-1-s))):s>21?e:md(parseFloat((a?"":"-")+ler(o,s)+"e"+String(u-1)))}function der(e,r){var t=e._valueIEEE;if(t===0)return CT;var n=TT(t),a=n.sign,o=n.mantissa,u=n.exponent,s=FM(r)._valueIEEE+u;if(s<1)return CT;if(s>21)return e;var l=o.substring(0,s);return md(parseFloat((a?"":"-")+PQ(l)+"e"+String(u-1)))}function fer(e){return(0,Hhe.assertInteger)("calc.lang.ieeeTenTo",e),md(Math.pow(10,e))}function per(e){var r=e._valueIEEE,t=Math.abs(r);return t>=4294967296?4294967295:Math.floor(t)}function mer(e){var r=FM(e)._valueIEEE;return r<-2147483648||r>2147483647?-2147483648:r}function ger(e){var r=Qhe(e)._valueIEEE;return r<-2147483648?-2147483648:r>2147483647?2147483647:r}dG.ieeeMathpack={zero:CT,one:Y$e,pi:J$e,add:function(r,t){return md(r._valueIEEE+t._valueIEEE)},sub:function(r,t){return md(r._valueIEEE-t._valueIEEE)},mul:function(r,t){return md(r._valueIEEE*t._valueIEEE)},div:Z$e,power:$$e,percent:function(r){return Nc(r._valueIEEE/100)},neg:function(r){return Nc(-r._valueIEEE)},compare:EQ,formatGeneral:eer,formatFixed:ter,formatScientific:ner,parse:oer,trunc:FM,ceil:uer,floor:Qhe,abs:function(r){return Nc(Math.abs(r._valueIEEE))},cond:function(r){return EQ(r,CT)},cond2:EQ,fromNumber:Nc,toNumber:function(r){return r._valueIEEE},sqrt:function(r){return md(Math.sqrt(r._valueIEEE))},exp:function(r){return md(Math.exp(r._valueIEEE))},ln:function(r){return md(Math.log(r._valueIEEE))},log:function(r){return md(Math.log(r._valueIEEE)/Math.LN10)},sin:function(r){return Nc(Math.sin(r._valueIEEE))},cos:function(r){return Nc(Math.cos(r._valueIEEE))},tan:function(r){return Nc(Math.tan(r._valueIEEE))},asin:function(r){return md(Math.asin(r._valueIEEE))},acos:function(r){return md(Math.acos(r._valueIEEE))},atan:function(r){return md(Math.atan(r._valueIEEE))},atan2:function(r,t){return Nc(Math.atan2(t._valueIEEE,r._valueIEEE))},mod:function(r,t){return Nc(r._valueIEEE%t._valueIEEE)},round:ser,roundUp:cer,roundDown:der,tenTo:fer,checkAlmostCancellation:function(r,t){return t},fix:per,lfix:mer,sfix:ger,viewRound:W$e.identity}});var Yhe=T(E0=>{"use strict";p();Object.defineProperty(E0,"__esModule",{value:!0});E0.kindAnonymizers=E0.anonymizeMagnitude=E0.anonymizeFormulaString=E0.anonymize=void 0;var fG=pr();E0.anonymize=fG.anonymizer.anonymize;E0.anonymizeFormulaString=fG.anonymizer.anonymizeFormulaString;E0.anonymizeMagnitude=fG.anonymizer.anonymizeMagnitude;E0.kindAnonymizers=fG.anonymizer.kindAnonymizers});var Zhe=T(FA=>{"use strict";p();Object.defineProperty(FA,"__esModule",{value:!0});FA.entry=FA.makeEmptyTable=void 0;var Jhe=pr();FA.makeEmptyTable=Jhe.table.makeEmptyTable;FA.entry=Jhe.table.entry});var FQ=T(Cb=>{"use strict";p();Object.defineProperty(Cb,"__esModule",{value:!0});Cb.printLocalsName=Cb.printLocalsGrid=Cb.createSimplePrintGlobals=void 0;var AQ=gg(),zf=oT(),ver=S0(),her=function(){function e(r){this.config=r}return e.prototype.getDocumentLoc=function(r,t){return(0,zf.success)((0,AQ.documentLoc)(r,t))},e.prototype.getSheetIndex=function(r,t){return(0,zf.success)(t)},e.prototype.getSheetName=function(r,t){return(0,zf.success)(t)},e.prototype.getNameLoc=function(r,t){return(0,zf.success)(t.indexOf(".")>=0?void 0:(0,AQ.nameLoc)(r,t))},e.prototype.getUserDefinedFuncLoc=function(r,t){return(0,zf.success)([])},e.prototype.getSheetRangeIndexes=function(r){if(r.index===void 0)return(0,zf.failure)((0,ver.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));var t=[r.index];return r.index2!==r.index&&t.push(r.index2),(0,zf.success)((0,AQ.sheetRangeIndexes)(t,0))},e.prototype.getContainingTable=function(r){return zf.successUndefined},e.prototype.getStructRefColumn=function(r,t){return zf.successUndefined},e.prototype.getStructRefSpecialRef=function(r,t){return zf.successUndefined},e.prototype.getNamedRanges=function(r){return(0,zf.success)([])},e}();function Ser(e){return new her(e)}Cb.createSimplePrintGlobals=Ser;function yer(e,r,t){return{config:t??void 0,lexicalSource:e,originGridCell:(0,zf.success)(r.range),originSheet:(0,zf.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1,printRowsAsAbsoluteReferences:!1,printColsAsAbsoluteReferences:!1}}Cb.printLocalsGrid=yer;function _er(e,r,t){return{config:t??void 0,lexicalSource:e,originGridCell:(0,zf.success)(r.range),originSheet:(0,zf.success)(r.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0,printRowsAsAbsoluteReferences:!0,printColsAsAbsoluteReferences:!0}}Cb.printLocalsName=_er});var i0e=T(OA=>{"use strict";p();Object.defineProperty(OA,"__esModule",{value:!0});OA.createPrinter=OA.anonymizeFormula=void 0;var IM=fe(),hr=Ep(),$he=tT(),NM=aA(),PT=pm(),$i=S0(),Tg=gg(),xM=TQ(),t0e=Yhe(),Sy=CM(),mG=cT(),Tb=sA(),ber=Yq(),hu=oT(),RT=gA(),OM=dy(),Cer=Zhe(),NQ=FQ(),yy=iA(),kM=/'/g,Ter=/"/g,Rer=(0,Tg.sheetGridCell)((0,Tg.sheetIndex)((0,Tg.documentLoc)(void 0,"Book1"),0),(0,Tg.gridCell)(0,0));function OQ(e){if(!(0,hu.isSuccess)(e)&&e.reason.kind!==Tb.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==Tb.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==Tb.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==Tb.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==Tb.ResolveReasonKind.EmptyIntersection)throw new ET(e.reason)}var ho;(function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"})(ho||(ho={}));function kQ(e){for(var r=[],t=[],n=0,a=e;n<a.length;n++){var o=a[n];o.length>0&&(0,yy.numCodeUnits)((0,yy.stringCodePointAt)(o,0))===o.length?r[(0,yy.stringCodePointAt)(o,0)]=!0:t.push(o)}return function(u,s){var l=(0,yy.stringCodePointAt)(u,s);if(r[l]===!0)return!0;for(var c=0,d=t;c<d.length;c++){var f=d[c];if((0,mG.stringStartsWith)(u,f,s))return!0}return!1}}function e0e(e,r){for(var t="",n=0;n<e.length;){r(e,n)&&(t+="'");var a=(0,yy.stringCodePointAt)(e,n);t+=(0,yy.stringFromCodePoint)(a),n+=(0,yy.numCodeUnits)(a)}return t}function Eer(e,r){for(var t=0;t<e.length;){if(r(e,t))return!0;t+=(0,yy.numCodeUnits)((0,yy.stringCodePointAt)(e,t))}return!1}var za=function(){function e(r){this.str=r,this.append=a0e,this.length=r.length}return e}(),n0e=function(){function e(r,t){this.lhs=r,this.rhs=t,this.append=a0e,this.length=r.length+t.length}return e}();function a0e(e){return new n0e(this,typeof e=="string"?new za(e):e)}function MM(e,r){return e.length===0?new za(""):e.reduce(function(t,n){return t.append(r).append(n)})}function Per(e){for(var r=new Map,t=[],n=0,a=[e];a.length>0;){var o=a.pop();r.set(o,{start:n,end:n+o.length}),o instanceof n0e?a.push(o.rhs,o.lhs):(t.push(o.str),n+=o.str.length)}return{str:t.join(""),ropeToSpan:r}}var vm={pre:"",preComments:void 0},MQ={pre:" ",preComments:void 0},Cg={post:"",postComments:void 0},Aer={literalNode:function(r,t,n){return n},arrayNode:function(r,t,n){return n},appNode:function(r,t,n,a){return a},letNode:function(r,t,n,a,o,u){return u},lambdaNode:function(r,t,n,a,o,u){return u},parenNode:function(r,t,n){return n},nameNode:function(r,t,n){return n},cellRefNode:function(r,t,n){return n},fieldRefNode:function(r,t,n){return n},structRefNode:function(r,t,n){return n},missingNode:function(r,t){return t},badSequenceNode:function(r,t,n){return n},badCharsNode:function(r,t,n){return n},operatorNode:function(r,t){return t},wsfNode:function(r,t,n){return n}},Fer=IM.__assign(IM.__assign({},(0,RT.constVisitor)(void 0)),{operatorNode:function(r){return r}}),Ner=function(){function e(r,t,n,a){var o=this,u,s,l,c;this.root=n,this.anonymize=a,this.labelToRope=[],this.anon=function(m){return o.anonymize?(0,t0e.anonymizeFormulaString)(m):m},this.locals=t,this.localeInfo=(s=(u=t.config)===null||u===void 0?void 0:u.localeInfo)!==null&&s!==void 0?s:r.config.localeInfo,this.mathpack=r.config.mathpack,this.refStyle=(c=(l=t.config)===null||l===void 0?void 0:l.refStyle)!==null&&c!==void 0?c:r.config.refStyle,this.resolver=(0,ber.createResolver)(r),this.spans=n.spans,this.annotations=n.annotations;var d=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],f=IM.__spreadArray(IM.__spreadArray([],d,!0),["	","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"],!1);this.isStructRefEscapable=kQ(d),this.isStructRefBracketedThisRef=kQ(f),this.isFieldRefEscapable=kQ(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}return e.prototype.print=function(){var r=this,t=new RT.ComposeVisitor(new RT.ZipVisitor({str:this,label:Aer,op:Fer}),function(o){return r.record(o.label,o.str),o}),n=(0,RT.reduceBottomUp)(t,this.root),a=new za("=").append(this.recordPrePost(n.label,this.pre(n.label,vm),n.str,this.postIfComments(n.label)));return this.printRope(a)},e.prototype.pre=function(r,t){var n;return this.anonymize?t:(n=this.spans[r])!==null&&n!==void 0?n:t},e.prototype.post=function(r,t){var n;return this.anonymize?t:(n=this.spans[r])!==null&&n!==void 0?n:t},e.prototype.preIfComments=function(r){if(this.anonymize)return vm;var t=this.spans[r];return(t==null?void 0:t.preComments)!=null&&t.preComments.length>0?t:vm},e.prototype.postIfComments=function(r){if(this.anonymize)return Cg;var t=this.spans[r];return(t==null?void 0:t.postComments)!=null&&t.postComments.length>0?t:Cg},e.prototype.printRef=function(r,t){var n=new za("");switch(r.kind){case hr.StructRefKind.SpecialRef:{(t===ho.Original&&r.isBracketed||t===ho.Bracketed)&&(n=n.append(this.localeInfo.leftBracket));var a=this.localeInfo.specialRefNames[r.id];if(a==null)throw new ET((0,$i.internal)("No locale data for specialRefName"));n=n.append(a),(t===ho.Original&&r.isBracketed&&r.isClosed||t===ho.Bracketed)&&(n=n.append(this.localeInfo.rightBracket));break}case hr.StructRefKind.ColumnRef:{var o=r.name.length===0||(0,mG.stringStartsWith)(r.name," ")||(0,mG.stringEndsWith)(r.name," ");(t===ho.Original&&r.isBracketed||t===ho.Bracketed||t===ho.Unbracketed&&o)&&(n=n.append(this.localeInfo.leftBracket));var u=e0e(r.name,this.isStructRefEscapable);n=n.append(this.anon(u)),(t===ho.Original&&r.isBracketed&&r.isClosed||t===ho.Bracketed||t===ho.Unbracketed&&o)&&(n=n.append(this.localeInfo.rightBracket));break}case hr.StructRefKind.RangeOpRef:{n=n.append(this.printRef(r.lhs,t===ho.Original?t:ho.Bracketed)).append(":").append(this.printRef(r.rhs,t===ho.Original?t:ho.Bracketed));break}case hr.StructRefKind.MissingRef:break;case hr.StructRefKind.BadRef:r.isBracketed&&(n=n.append(this.localeInfo.leftBracket)),n=n.append(this.anon(r.chars)),r.isBracketed&&r.isClosed&&(n=n.append(this.localeInfo.rightBracket));break}return this.record(r.label,n)},e.prototype.printThisRowOpRef=function(r,t){var n=new za("@");return r&&(r.kind===hr.StructRefKind.ColumnRef?n=n.append(this.printRef(r,r.isClosed?Eer(r.name,this.isStructRefBracketedThisRef)?ho.Bracketed:ho.Unbracketed:ho.Original)):n=n.append(this.printRef(r,(0,$i.isRangeOpClosed)(r)&&(0,$i.isRangeOpNoMissing)(r)?ho.Bracketed:ho.Original))),this.record(t,n)},e.prototype.printApplication=function(r,t,n,a){var o=this,u=t.map(function(s,l,c){return o.recordPrePost(s.label,o.pre(s.label,l===0||s.str.length===0?vm:MQ),s.str,l===c.length-1?o.post(s.label,Cg):o.postIfComments(s.label))});return r.str.append("(").append(MM(u,this.localeInfo.listSeparator)).append(n?")":"")},e.prototype.printCellRef=function(r){var t=r.ref,n=r.qualifier;return(n!==void 0?this.recordPrePost(n.label,vm,(0,RT.visitQualifier)(this,n).str,this.postIfComments(n.label)):new za("")).append((0,RT.visitCellRef)(this,t).str)},e.prototype.printName=function(r,t){for(var n=r.qualifier,a=r.parts,o=n!==void 0?this.recordPrePost(n.label,vm,(0,RT.visitQualifier)(this,n).str,this.postIfComments(n.label)):new za(""),u=new za(""),s=0,l=(0,hr.flattenNameParts)(a).parts;s<l.length;s++){var c=l[s],d=void 0;if(c.kind===hr.NamePartKind.FieldRefNamePart){var f=c.rhs.field;d=this.record(c.rhs.label,new za(".").append(this.record(f.label,this.anon(f.kind===hr.NodeKind.Ident?f.whole:f.chars))))}else c.kind===hr.NamePartKind.CellRefNamePart&&t===Tb.ResolvedKind.ResolvedCellRef?d=this.printCellRef((0,hr.cellRefNode)(c.ref,void 0,c.label)):d=new za(this.anon(c.asWhole));u=this.record(c.label,u.append(d)),this.recordQualified(c.qualifiedLabel,o,u)}return o.append(u)},e.prototype.printUnrecordedDocQual=function(r){if(r===void 0)return r;var t=r.path,n=r.document;return this.anon((t??"")+this.localeInfo.leftBracket+n+this.localeInfo.rightBracket)},e.prototype.printParamNameIdent=function(r){return r.kind===hr.NodeKind.Ident?this.record(r.label,this.anon((0,$i.getBoundName)(this.localeInfo,r.whole))):this.recordPrePost(r.label,this.pre(r.label,vm),this.anon(r.chars),this.post(r.label,Cg))},e.prototype.printParamName=function(r){return this.record(r.label,new za(r.isBracketed?this.localeInfo.leftBracket:"").append(this.printParamNameIdent(r.name)).append(r.isBracketed&&r.isClosed?this.localeInfo.rightBracket:""))},e.prototype.record=function(r,t){var n=typeof t=="string"?new za(t):t;return this.labelToRope[r]={ropeStart:n,ropeEnd:n,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0},n},e.prototype.recordQualified=function(r,t,n){this.labelToRope[r]={ropeStart:t,ropeEnd:n,startOffset:0,endOffset:0,pre:"",post:"",preComments:void 0,postComments:void 0}},e.prototype.recordPrePost=function(r,t,n,a){var o=t.pre,u=t.preComments,s=a.post,l=a.postComments,c=typeof n=="string"?new za(n):n,d=new za(o),f=new za(s);return this.labelToRope[r]={ropeStart:c,ropeEnd:c,startOffset:0,endOffset:0,pre:o,post:s,preComments:u,postComments:l},u&&this.recordComments(u,d,this.spans[r].start-o.length),l&&this.recordComments(l,f,this.spans[r].end),d.append(c).append(f)},e.prototype.recordComments=function(r,t,n){for(var a=0,o=r;a<o.length;a++){var u=o[a],s=this.spans[u.label];if(s==null)return;this.labelToRope[u.label]={ropeStart:t,ropeEnd:t,startOffset:s.start-n,endOffset:s.end-n-t.length,pre:"",post:"",preComments:void 0,postComments:void 0}}},e.prototype.printRope=function(r){for(var t=Per(r),n=t.str,a=t.ropeToSpan,o=[],u=0,s=Object.keys(this.labelToRope).map(Number);u<s.length;u++){var l=s[u],c=this.labelToRope[l],d=c.ropeStart,f=c.ropeEnd,m=c.startOffset,v=c.endOffset,h=c.pre,y=c.post,_=c.preComments,E=c.postComments,N=a.get(d).start,k=a.get(f).end;o[l]=(0,hr.formulaSpan)(N+m,k+v,h,y,_,E)}return{formula:n,spans:o}},e.prototype.literalNode=function(r,t,n){switch(r.kind){case OM.OperKind.String:return new za('"'+this.anon(r.value).replace(Ter,'""')+'"');case OM.OperKind.Boolean:return new za(r.value?this.localeInfo.trueName:this.localeInfo.falseName);case OM.OperKind.Number:var a=21;return new za(this.anon(this.mathpack.formatGeneral(this.localeInfo,r,a)));case OM.OperKind.Missing:return new za("");case OM.OperKind.Error:var o=this.localeInfo.errorNames[r.type];if(o==null)throw new ET((0,$i.internal)("No locale data for error type ".concat(r.type)));return new za(o);default:return(0,PT.assertNever)("calc.lang.printFormula",r)}},e.prototype.missingNode=function(r,t){return new za(this.anon(r))},e.prototype.arrayNode=function(r,t,n){var a=this;return new za(this.localeInfo.leftBrace).append(MM(r.map(function(o){return MM(o.map(function(u){return a.recordPrePost(u.label,a.preIfComments(u.label),u.str,a.postIfComments(u.label))}),a.localeInfo.columnSeparator)}),this.localeInfo.rowSeparator)).append(t?this.localeInfo.rightBrace:"")},e.prototype.appNode=function(r,t,n,a){if(r.op!==void 0){if(t.length===1){var o=t[0];switch(r.op){case NM.OperatorId.Percent:return o.str.append(this.recordPrePost(r.label,this.pre(r.label,vm),r.str,Cg));case NM.OperatorId.Pound:return o.str.append(this.recordPrePost(r.label,this.preIfComments(r.label),r.str,Cg));default:return this.recordPrePost(r.label,vm,r.str,this.post(r.label,Cg)).append(o.str)}}if(t.length===2){var u=t[0],s=t[1],l=" ",c=" ";switch(r.op){case NM.OperatorId.Range:l=c="";break;case NM.OperatorId.Isect:c="";break;case NM.OperatorId.Union:l="";break}return u.str.append(this.recordPrePost(r.label,this.pre(r.label,{pre:l}),r.str,this.post(r.label,{post:c}))).append(s.str)}return(0,PT.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(r,t,n,a)},e.prototype.letNode=function(r,t,n,a,o,u){var s=this,l=t.map(function(c){var d=c.name,f=c.binder;return(0,hr.letVar)((0,hr.indexedArg)({str:s.record(d.arg.label,s.record(d.arg.name.label,s.anon((0,$i.getBoundName)(s.localeInfo,d.arg.wholeName)))),label:d.arg.label,op:void 0},d.index),f)});return this.printApplication(r,(0,hr.flattenLetArgs)(l,n,a),o,u)},e.prototype.lambdaNode=function(r,t,n,a,o,u){var s=this,l=t.map(function(c){var d=c.name,f=s.printParamName(d.arg.name),m=d.arg.def===void 0?new za(""):s.recordPrePost(d.arg.def.label,s.pre(d.arg.def.label,MQ),new za(":=").append(s.recordPrePost(d.arg.def.rhs.label,s.pre(d.arg.def.rhs.label,d.arg.def.rhs.str.length===0?vm:MQ),d.arg.def.rhs.str,Cg)),Cg);return(0,hr.lambdaParam)((0,hr.indexedArg)({str:f.append(m),label:d.arg.label,op:void 0},d.index))});return this.printApplication(r,(0,hr.flattenLambdaArgs)(l,n,a),o,u)},e.prototype.parenNode=function(r,t,n){return new za("(").append(this.recordPrePost(r.label,this.pre(r.label,vm),r.str,this.post(r.label,Cg))).append(t?")":"")},e.prototype.nameNode=function(r,t,n){var a=this.resolver.resolveDottedName(this.locals,(0,hr.nameNode)(r,t,n),this.annotations),o=a.headResolved,u=a.node;return OQ(o.resolution),this.printName(u,o.kind)},e.prototype.cellRefNode=function(r,t,n){var a=this.resolver.resolveCellRef(this.locals,(0,hr.cellRefNode)(r,t,n)),o=a.node,u=a.resolution;return OQ(u),this.printCellRef(o)},e.prototype.fieldRefNode=function(r,t,n){var a=t.shouldBeBracketed,o=t.isBracketed||a?this.localeInfo.leftBracket:"",u=t.isBracketed&&t.isClosed||a?this.localeInfo.rightBracket:"",s=this.record(t.field.label,this.anon(t.field.kind===hr.NodeKind.Ident?e0e(t.field.whole,this.isFieldRefEscapable):t.field.chars)),l=t.field.kind!==hr.NodeKind.Ident?this.pre(t.label,vm):this.preIfComments(t.label);return r.str.append(this.recordPrePost(t.label,l,new za("."+o).append(s).append(u),this.post(t.label,Cg)))},e.prototype.structRefNode=function(r,t,n){var a=this,o,u=this.resolver.resolveStructRef(this.locals,(0,hr.structRefNode)(r,t,n)),s=u.node,l=u.table,c=u.resolution;OQ(c);var d=s.rhs.innerRef,f=s.lhs===void 0?void 0:this.record(s.lhs.label,this.printName(s.lhs,Tb.ResolvedKind.ResolvedName));if(f===void 0&&l!==void 0&&s.rhs.isClosed&&!((d==null?void 0:d.kind)===hr.StructRefKind.ColumnRef||(d==null?void 0:d.kind)===hr.StructRefKind.ThisRowOpRef&&((o=d.ref)===null||o===void 0?void 0:o.kind)===hr.StructRefKind.ColumnRef)&&(f=new za(l.name)),d===void 0&&s.rhs.isClosed&&f!==void 0)return f;var m=new za(this.localeInfo.leftBracket);switch(d==null?void 0:d.kind){case hr.StructRefKind.ColumnRef:case hr.StructRefKind.SpecialRef:if(d.kind===hr.StructRefKind.SpecialRef&&d.id===hr.SpecialRefId.ThisRow&&d.isClosed){m=m.append(this.printThisRowOpRef(void 0,d.label));break}m=m.append(this.printRef(d,d.isClosed?ho.Unbracketed:ho.Original));break;case hr.StructRefKind.RangeOpRef:{var v=(0,$i.isRangeOpClosed)(d)&&(0,$i.isRangeOpNoMissing)(d),h=v?ho.Bracketed:ho.Original;m=m.append(this.printRef(d,h));break}case hr.StructRefKind.CommaOpRef:{var v=(0,$i.isCommaOpRefWellFormed)(d)&&(0,$i.isCommaOpClosed)(d)&&(0,$i.isCommaOpNoBadOrMissing)(d);if(v&&d.specialRefs[hr.SpecialRefId.ThisRow]){m=m.append(this.printThisRowOpRef(d.columnRefs.length===0?void 0:d.columnRefs[0],d.label));break}var y=v?(0,$i.normalizeCommaOpRef)(d):d.refs,_=v?y.length===1?ho.Unbracketed:ho.Bracketed:ho.Original;m=m.append(this.record(d.label,MM(y.map(function(N){return a.printRef(N,_)}),this.localeInfo.listSeparator)));break}case hr.StructRefKind.ThisRowOpRef:m=m.append(this.printThisRowOpRef(d.ref,d.label));break;case hr.StructRefKind.BadRef:m=m.append(this.printRef(d,ho.Original));break}return s.rhs.isClosed&&(m=m.append(this.localeInfo.rightBracket)),(f??new za("")).append(this.record(s.rhs.label,m))},e.prototype.badSequenceNode=function(r,t,n){var a=this;return MM(t.map(function(o){return a.recordPrePost(o.label,a.pre(o.label,vm),o.str,a.post(o.label,Cg))}),"")},e.prototype.badCharsNode=function(r,t,n){return new za(this.anon(t))},e.prototype.operatorNode=function(r,t){var n=(0,xM.operatorIdToName)(this.localeInfo,r,"");if(n===void 0)throw new ET((0,$i.internal)("Invalid operator"));return new za(n)},e.prototype.wsfNode=function(r,t,n){return new za(this.localeInfo.getWorksheetFuncName(r))},e.prototype.cellRefError=function(r){var t=this.localeInfo.errorNames[$he.ErrorType.REF];if(t==null)throw new ET((0,$i.internal)("No locale data for #REF"));return{str:this.record(r,t),label:r}},e.prototype.cellRefSingle=function(r,t,n,a){var o=(0,Sy.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,r,t,this.locals.wrapCellReferences);return o!==void 0?{str:this.record(a,this.anon(o)),label:a}:this.cellRefError(a)},e.prototype.cellRefRange=function(r,t,n){var a=(0,Sy.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,r.row,r.col,t.row,t.col,this.locals.wrapCellReferences);return a!==void 0?{str:this.record(n,this.anon(a)),label:n}:this.cellRefError(n)},e.prototype.cellRefRow=function(r,t,n,a){var o=(0,Sy.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,r,t,this.locals.wrapCellReferences);return o!==void 0?{str:this.record(a,this.anon(o)),label:a}:this.cellRefError(a)},e.prototype.cellRefCol=function(r,t,n,a){var o=(0,Sy.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,r,t,this.locals.wrapCellReferences);return o!==void 0?{str:this.record(a,this.anon(o)),label:a}:this.cellRefError(a)},e.prototype.cellRefBad=function(r,t,n){return{str:this.record(n,this.anon(r)),label:n}},e.prototype.errorQualifier=function(r){var t=this.localeInfo.errorNames[$he.ErrorType.REF];if(t==null)throw new ET((0,$i.internal)("No locale data for #REF"));return{str:this.record(r,t),label:r}},e.prototype.relativeQualifier=function(r){return{str:this.record(r,"!"),label:r}},e.prototype.documentQualifier=function(r,t,n,a){return{str:this.record(a,(0,Sy.quoteQualifier)(this.printUnrecordedDocQual((0,hr.documentQualifier)(r,t)))+"!"),label:a}},e.prototype.sheetQualifier=function(r,t,n,a){var o=this.printUnrecordedDocQual(t),u=this.anon(r),s=(0,Sy.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(o??"")+u);return s&&(o=o==null?void 0:o.replace(kM,"''"),u=u.replace(kM,"''")),{str:this.record(a,new za(s?"'":"").append(o===void 0?new za(""):this.record(t.label,o)).append(u).append(s?"'":"").append("!")),label:a}},e.prototype.identQualifier=function(r,t,n){return{str:this.record(n,(0,Sy.formatQualifier)(this.localeInfo,this.refStyle,this.anon(r))+"!"),label:n}},e.prototype.sheetRangeQualifier=function(r,t,n,a,o){var u=this.printUnrecordedDocQual(n),s=this.anon(r),l=this.anon(t),c=(0,Sy.shouldQuoteQualifier)(this.localeInfo,this.refStyle,(u??"")+s)||(0,Sy.shouldQuoteQualifier)(this.localeInfo,this.refStyle,l);return c&&(u=u==null?void 0:u.replace(kM,"''"),s=s.replace(kM,"''"),l=l.replace(kM,"''")),{str:this.record(o,new za(c?"'":"").append(u===void 0?new za(""):this.record(n.label,u)).append(s).append(":").append(l).append(c?"'":"").append("!")),label:o}},e.prototype.badQualifier=function(r,t,n,a,o){return{str:this.record(o,this.anon(r)),label:o}},e}(),ET=(0,$i.createFailureErrorClass)("PrintFormulaError"),sh=(0,$i.createFailureErrorClass)("PrintRangeError");function xQ(e,r,t,n){n===void 0&&(n=!1);try{return(0,hu.success)(new Ner(e,r,t,n).print())}catch(a){return a instanceof ET?(0,hu.failure)(a.reason):(0,hu.failure)((0,hu.javaScriptError)(a))}}function Oer(e,r,t){try{var n=t.kind===Tg.LexicalKind.Cell||t.kind===Tg.LexicalKind.Range?(0,NQ.printLocalsGrid)(t,(0,$i.sheetGridRangeAnchor)(t.range)):t.kind===Tg.LexicalKind.NameManager?(0,NQ.printLocalsName)(t,Rer):(0,PT.assertNever)("calc.lang.anonymizeFormula",t),a=xQ((0,NQ.createSimplePrintGlobals)((0,xM.calcConfig)((0,xM.getEnglishLocaleInfo)(),hr.RefStyle.A1,e.mathpack)),n,r,!0);if(a.kind===hu.ResultKind.Success)return a.value.formula;if(a.reason.kind===hu.ReasonKind.JavaScriptError)throw a.reason.error}catch(u){var o="calc.lang.anonymizeFormula: Format failed: "+(0,mG.messageFromError)(u);PT.ulsLogger.ULS.traceTag(507381981,xM.LogCategory.msoulscat_ES_EWAJS,xM.TraceLevel.Warning,o)}return(0,t0e.anonymize)(r)}OA.anonymizeFormula=Oer;function NA(e,r){return e===void 0?(0,hr.pos)(hr.PosKind.Abs,r):(0,hr.pos)(hr.PosKind.Rel,r-e)}function r0e(e,r,t){return(0,hr.cellRefSingle)(NA(e,t.row),NA(r,t.col))}function ker(e,r,t){return(0,hr.cellRefRow)(NA(e,r),NA(e,r+t-1))}function Mer(e,r,t){return(0,hr.cellRefCol)(NA(e,r),NA(e,r+t-1))}function xer(e,r,t){if(t.col===0&&t.cols===Tg.sheetCols)return ker(e,t.row,t.rows);if(t.row===0&&t.rows===Tg.sheetRows)return Mer(r,t.col,t.cols);var n=(0,$i.gridRangeAnchor)(t),a=r0e(e,r,n);if((0,$i.isGridCell)(t))return a;var o=(0,Tg.gridCell)(t.row+t.rows-1,t.col+t.cols-1),u=r0e(e,r,o);return(0,hr.cellRefRange)(a,u)}function Ier(e,r,t){var n=r.originSheet.value,a=r.printRowsAsAbsoluteReferences?void 0:r.originGridCell.value.row,o=r.printColsAsAbsoluteReferences?void 0:r.originGridCell.value.col,u=xer(a,o,t.range),s;if(n.index===void 0||!(0,$i.isSheetIndexEqual)(n,t.sheet)){var l=e.getSheetName(t.sheet.document,t.sheet.index);if(!(0,hu.isSuccess)(l))throw new sh(l.reason);s=(0,hr.sheetQualifier)(l.value)}return(0,hr.cellRefNode)(u,s)}function pG(e){return(0,hu.isSuccess)(e)?((0,PT.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",e.value!=null),(0,hu.success)(e.value)):e.reason.kind===Tb.ResolveReasonKind.InvalidStructRef?(0,PT.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,hu.failure)(e.reason)}function wer(e,r,t){var n=t.sheet,a=t.range,o=e.getContainingTable((0,Tg.sheetGridCell)(n,(0,$i.gridRangeAnchor)(a)));if(!(0,hu.isSuccess)(o))throw new sh(o.reason);if(o.value!=null){var u=o.value,s=pG(e.getStructRefSpecialRef(u,hr.SpecialRefId.All));if(!(0,hu.isSuccess)(s))throw new sh(s.reason);var l=s.value.range,c=s.value.sheet,d=(0,$i.gridRangeCompare)(l,a);if(!(d===void 0||d<0)){var f=pG(e.getStructRefSpecialRef(u,hr.SpecialRefId.Data));if(!(0,hu.isSuccess)(f))throw new sh(f.reason);var m=f.value.range,v=r.originGridCell.value,h=r.originSheet.value,y=h.index!==void 0&&(0,$i.isSheetIndexEqual)(h,c),_=y&&(0,$i.gridRangeIsects)(l,v)?void 0:(0,hr.nameNode)((0,hr.identNamePart)(u.name)),E=_??(0,hr.nameNode)((0,hr.identNamePart)(u.name)),N=m.cols>1&&a.col===m.col&&a.cols===m.cols,k=function(){var ee=pG(e.getStructRefColumn(u,a.col));if(!(0,hu.isSuccess)(ee))throw new sh(ee.reason);if(a.cols===1)return(0,hr.columnRef)(ee.value.name);var re=pG(e.getStructRefColumn(u,a.col+a.cols-1));if(!(0,hu.isSuccess)(re))throw new sh(re.reason);return(0,hr.rangeOpRef)((0,hr.columnRef)(ee.value.name),(0,hr.columnRef)(re.value.name))};if(a.row===l.row&&a.rows===l.rows)return(0,hr.structRefNode)(E,(0,hr.structRef)(N?(0,hr.specialRef)(hr.SpecialRefId.All):(0,hr.commaOpRef)([(0,hr.specialRef)(hr.SpecialRefId.All,!0),k()])));if(a.rows===1&&a.row===v.row&&a.row>=m.row&&a.row<m.row+m.rows)return(0,hr.structRefNode)(a.cols===1?_:E,(0,hr.structRef)((0,hr.thisRowOpRef)(N?void 0:k())));if(a.row===m.row&&a.rows===m.rows)return N?(0,hr.structRefNode)(E,(0,hr.structRef)(void 0)):(0,hr.structRefNode)(a.cols===1?_:E,(0,hr.structRef)(k()));var q=a.row===l.row&&a.row+a.rows===m.row,V=a.row===m.row+m.rows&&a.row+a.rows===l.row+l.rows;if(q||V){var I=(0,hr.specialRef)(q?hr.SpecialRefId.Headers:hr.SpecialRefId.Totals,!N);return(0,hr.structRefNode)(E,(0,hr.structRef)(N?I:(0,hr.commaOpRef)([I,k()])))}var M=a.row===l.row&&l.row<m.row&&a.row+a.rows===m.row+m.rows,B=a.row===m.row&&l.row+l.rows>m.row+m.rows&&a.row+a.rows===l.row+l.rows;if(M||B){var U=(0,hr.specialRef)(M?hr.SpecialRefId.Headers:hr.SpecialRefId.Data,!0),j=(0,hr.specialRef)(M?hr.SpecialRefId.Data:hr.SpecialRefId.Totals,!0);return(0,hr.structRefNode)(E,(0,hr.structRef)(N?(0,hr.commaOpRef)([U,j]):(0,hr.commaOpRef)([U,j,k()])))}}}}function Der(e,r,t,n){var a=r.originSheet.value,o=e.getNamedRanges(t);if(!(0,hu.isSuccess)(o))throw new sh(o.reason);if(o.value.length!==0){var u=function(m){return m.index!==void 0&&(a.index===void 0||!(0,$i.isSheetIndexEqual)(m,a))},s=o.value.filter(function(f){var m=f.scope;return m.index===void 0?(0,$i.isDocumentLocEqual)(m.document,t.sheet.document):(0,$i.isSheetIndexEqual)(m,t.sheet)}).filter(function(f){var m=f.scope,v=f.name;if(m.index!==void 0||a.index===void 0)return!0;var h=a,y=e.getNameLoc(h,v,Tg.NameSource.Plain);if(!(0,hu.isSuccess)(y))throw new sh(y.reason);return y.value==null}).filter(function(f){var m=f.scope,v=f.name;return u(m)||!n.contains(v)});if(s.length!==0){var l=s.length===1?s[0]:IM.__spreadArray([],s,!0).sort(function(f,m){return e.config.localeInfo.stringCompareCI(f.name,m.name)})[0],c;if(u(l.scope)){var d=e.getSheetName(l.scope.document,l.scope.index);if(!(0,hu.isSuccess)(d))throw new sh(d.reason);c=(0,hr.sheetQualifier)(d.value)}return(0,hr.nameNode)((0,hr.identNamePart)(l.name),c)}}}function Ler(e,r,t,n){var a,o;n===void 0&&(n=(0,Cer.makeEmptyTable)());try{var u=r.originSheet.value;if(!(0,$i.isDocumentLocEqual)(u.document,t.sheet.document))throw new sh((0,$i.notImplemented)(["printRange cross-document"]));return(0,hu.success)((o=(a=Der(e,r,t,n))!==null&&a!==void 0?a:wer(e,r,t))!==null&&o!==void 0?o:Ier(e,r,t))}catch(s){return s instanceof sh?(0,hu.failure)(s.reason):(0,hu.failure)((0,hu.javaScriptError)(s))}}var qer={getNamedRanges:function(){return(0,PT.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")}};function Ger(e){var r,t,n;return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:(r=e.getStructRefSpecialRef)===null||r===void 0?void 0:r.bind(e),getNamedRanges:(n=(t=e.getNamedRanges)===null||t===void 0?void 0:t.bind(e))!==null&&n!==void 0?n:qer.getNamedRanges}}function Ber(e){var r=Ger(e);return{printFormula:function(n,a){var o=xQ(e,n,a);return(0,hu.isSuccess)(o)?(0,hu.success)(o.value.formula):o},printFormulaEx:function(n,a){return xQ(e,n,a)},printRange:function(n,a,o){return Ler(r,n,a,o)}}}OA.createPrinter=Ber});var s0e=T(nr=>{"use strict";p();Object.defineProperty(nr,"__esModule",{value:!0});nr.fieldRef=nr.fieldRefNamePart=nr.nameNode=nr.lambdaNode=nr.letNode=nr.poundNode=nr.atNode=nr.maxNode=nr.minNode=nr.xorNode=nr.orNode=nr.andNode=nr.unionNode=nr.isectNode=nr.rangeNode=nr.geNode=nr.gtNode=nr.leNode=nr.ltNode=nr.neNode=nr.eqNode=nr.concatNode=nr.posNode=nr.negNode=nr.percentNode=nr.powNode=nr.divNode=nr.mulNode=nr.subNode=nr.addNode=nr.badBracketNode=nr.badQualNode=nr.badCellRefNode=nr.badParamNameNode=nr.badFieldNameNode=nr.badErrorLiteralNode=nr.badStringLiteralNode=nr.badNumberLiteralNode=nr.badUnexpCharsNode=nr.badFieldRefNode=nr.badStructRefNode=nr.badUnexpSeqNode=nr.absPos=nr.relPos=nr.expectTrue=nr.isNameLocEqual=nr.createSingleRange=nr.sheet1=nr.sheet1Name=nr.document1=void 0;var gG=gg(),Uer=S0(),Aa=Ep(),Su=aA();nr.document1=(0,gG.documentLoc)(void 0,"Book1");nr.sheet1Name="Sheet1";nr.sheet1=(0,gG.sheetIndex)(nr.document1,0);function Ker(e,r){var t=(0,gG.gridCell)(e,r);return(0,gG.sheetGridCell)(nr.sheet1,t)}nr.createSingleRange=Ker;function Ver(e,r,t){return(0,Uer.isNameScopeEqual)(r.scope,t.scope)&&e.stringCompareCI(r.name,t.name)===0}nr.isNameLocEqual=Ver;function jer(e){expect(e).toBeTruthy()}nr.expectTrue=jer;function Wer(e){return(0,Aa.pos)(Aa.PosKind.Rel,e)}nr.relPos=Wer;function Her(e){return(0,Aa.pos)(Aa.PosKind.Abs,e)}nr.absPos=Her;function o0e(e,r){return r===void 0&&(r=0),(0,Aa.badSequenceNode)(Aa.BadType.Unexpected,e,r)}nr.badUnexpSeqNode=o0e;function zer(e,r){return r===void 0&&(r=0),(0,Aa.badSequenceNode)(Aa.BadType.StructRef,e,r)}nr.badStructRefNode=zer;function Qer(e,r){return r===void 0&&(r=0),(0,Aa.badSequenceNode)(Aa.BadType.FieldRef,e,r)}nr.badFieldRefNode=Qer;function IQ(e,r){return r===void 0&&(r=0),(0,Aa.badCharsNode)(Aa.BadType.Unexpected,e,r)}nr.badUnexpCharsNode=IQ;function Xer(e,r){return r===void 0&&(r=0),(0,Aa.badCharsNode)(Aa.BadType.NumberLiteral,e,r)}nr.badNumberLiteralNode=Xer;function Yer(e,r){return r===void 0&&(r=0),(0,Aa.badCharsNode)(Aa.BadType.StringLiteral,e,r)}nr.badStringLiteralNode=Yer;function Jer(e,r){return r===void 0&&(r=0),(0,Aa.badCharsNode)(Aa.BadType.ErrorLiteral,e,r)}nr.badErrorLiteralNode=Jer;function Zer(e,r){return r===void 0&&(r=0),(0,Aa.badCharsNode)(Aa.BadType.FieldName,e,r)}nr.badFieldNameNode=Zer;function $er(e,r){return r===void 0&&(r=0),(0,Aa.badCharsNode)(Aa.BadType.ParamName,e,r)}nr.badParamNameNode=$er;function err(e,r,t,n){return r===void 0&&(r=e.indexOf("[")>=0),t===void 0&&(t=0),n===void 0&&(n=0),(0,Aa.cellRefNode)((0,Aa.cellRefBad)(e,r,t),void 0,n)}nr.badCellRefNode=err;function rrr(e,r){return r===void 0&&(r=0),(0,Aa.badCharsNode)(Aa.BadType.Qualifier,e,r)}nr.badQualNode=rrr;function trr(e,r){r===void 0&&(r=!0);var t=[IQ("["),e];return r&&t.push(IQ("]")),o0e(t)}nr.badBracketNode=trr;function yu(e){return function(r){return r===void 0&&(r=0),(0,Aa.operatorNode)(e,r)}}nr.addNode=yu(Su.OperatorId.Add);nr.subNode=yu(Su.OperatorId.Sub);nr.mulNode=yu(Su.OperatorId.Mul);nr.divNode=yu(Su.OperatorId.Div);nr.powNode=yu(Su.OperatorId.Pow);nr.percentNode=yu(Su.OperatorId.Percent);nr.negNode=yu(Su.OperatorId.Neg);nr.posNode=yu(Su.OperatorId.Pos);nr.concatNode=yu(Su.OperatorId.Concat);nr.eqNode=yu(Su.OperatorId.Eq);nr.neNode=yu(Su.OperatorId.Ne);nr.ltNode=yu(Su.OperatorId.Lt);nr.leNode=yu(Su.OperatorId.Le);nr.gtNode=yu(Su.OperatorId.Gt);nr.geNode=yu(Su.OperatorId.Ge);nr.rangeNode=yu(Su.OperatorId.Range);nr.isectNode=yu(Su.OperatorId.Isect);nr.unionNode=yu(Su.OperatorId.Union);nr.andNode=yu(Su.OperatorId.And);nr.orNode=yu(Su.OperatorId.Or);nr.xorNode=yu(Su.OperatorId.Xor);nr.minNode=yu(Su.OperatorId.Min);nr.maxNode=yu(Su.OperatorId.Max);nr.atNode=yu(Su.OperatorId.At);nr.poundNode=yu(Su.OperatorId.Pound);function nrr(e){return Array.isArray(e)}function arr(e){return e.kind!==void 0}function irr(e,r,t,n,a,o){n===void 0&&(n=[]);var u=r.map(function(s){return nrr(s)?[s[0].kind===Aa.NodeKind.Ident?(0,Aa.varNode)(s[0]):s[0],s[1]]:s});return(0,Aa.letNode)(e,u,t,n,a,o)}nr.letNode=irr;function orr(e,r,t,n,a,o){n===void 0&&(n=[]);var u=r.map(function(s){return!arr(s)||s.kind===Aa.NodeKind.Param?s:(0,Aa.paramNode)((0,Aa.paramName)(s,!1),void 0)});return(0,Aa.lambdaNode)(e,u,t,n,a,o)}nr.lambdaNode=orr;function urr(e,r,t){var n=typeof e=="string"?(0,Aa.identNamePart)(e,!0):e;return(0,Aa.nameNode)(n,r,t)}nr.nameNode=urr;function srr(e,r,t,n,a){var o=typeof r=="string"?u0e(r,!1,!0,!1):r;return(0,Aa.fieldRefNamePart)(e,o,t,n,a)}nr.fieldRefNamePart=srr;function u0e(e,r,t,n,a){return(0,Aa.fieldRef)(typeof e=="string"?(0,Aa.identNode)(e):e,r,t,n,a)}nr.fieldRef=u0e});var v0e=T(Jd=>{"use strict";p();Object.defineProperty(Jd,"__esModule",{value:!0});Jd.VerticalAlignment=Jd.HorizontalAlignment=Jd.BorderLineType=Jd.PatternType=Jd.FillKind=Jd.FontVerticalAlignment=Jd.FontUnderline=void 0;var wM=jd(),l0e;(function(e){e.None="None",e.Single="Single",e.Double="Double",e.SingleAccounting="SingleAccounting",e.DoubleAccounting="DoubleAccounting"})(l0e||(Jd.FontUnderline=l0e={}));(0,wM.staticAssertSame)();var c0e;(function(e){e.None="None",e.Subscript="Subscript",e.Superscript="Superscript"})(c0e||(Jd.FontVerticalAlignment=c0e={}));(0,wM.staticAssertSame)();var d0e;(function(e){e.Pattern="Pattern",e.Gradient="Gradient"})(d0e||(Jd.FillKind=d0e={}));var f0e;(function(e){e.None="None",e.Solid="Solid",e.MediumGray="MediumGray",e.DarkGray="DarkGray",e.LightGray="LightGray",e.DarkHorizontal="DarkHorizontal",e.DarkVertical="DarkVertical",e.DarkDown="DarkDown",e.DarkUp="DarkUp",e.DarkGrid="DarkGrid",e.DarkTrellis="DarkTrellis",e.LightHorizontal="LightHorizontal",e.LightVertical="LightVertical",e.LightDown="LightDown",e.LightUp="LightUp",e.LightGrid="LightGrid",e.LightTrellis="LightTrellis",e.Gray125="Gray125",e.Gray0625="Gray0625"})(f0e||(Jd.PatternType=f0e={}));var p0e;(function(e){e.None="None",e.Thin="Thin",e.Medium="Medium",e.Dashed="Dashed",e.Dotted="Dotted",e.Thick="Thick",e.Double="Double",e.Hair="Hair",e.MediumDashed="MediumDashed",e.DashDot="DashDot",e.MediumDashDot="MediumDashDot",e.DashDotDot="DashDotDot",e.MediumDashDotDot="MediumDashDotDot",e.SlantDashDot="SlantDashDot"})(p0e||(Jd.BorderLineType=p0e={}));(0,wM.staticAssertSame)();var m0e;(function(e){e.Automatic="Automatic",e.Left="Left",e.Center="Center",e.Right="Right",e.Fill="Fill",e.Justify="Justify",e.CenterAcrossSelection="CenterAcrossSelection",e.Distributed="Distributed",e.JustifyDistributed="JustifyDistributed"})(m0e||(Jd.HorizontalAlignment=m0e={}));(0,wM.staticAssertSame)();var g0e;(function(e){e.Top="Top",e.Center="Center",e.Bottom="Bottom",e.Justify="Justify",e.Distributed="Distributed"})(g0e||(Jd.VerticalAlignment=g0e={}));(0,wM.staticAssertSame)()});var qr=T(Kt=>{"use strict";p();Object.defineProperty(Kt,"__esModule",{value:!0});Kt.styleServiceTypes=Kt.testUtil=Kt.printServiceTypes=Kt.printService=Kt.mathpackIEEE=Kt.relabel=Kt.visitor=Kt.mathpack=Kt.signature=Kt.literalParse=Kt.resolveServiceTypes=Kt.resolveService=Kt.util=Kt.numfmt=Kt.formulaModule=Kt.datepack=Kt.mathpackXL=Kt.config=Kt.cellParse=Kt.cellFormat=Kt.annotations=Kt.adjust=Kt.worksheetFuncTypesModule=Kt.location=Kt.value=Kt.types=Kt.PackageName=void 0;var ru=fe();Kt.PackageName="excel-online-calc-lang";Kt.types=ru.__importStar(dy());Kt.value=ru.__importStar(tT());Kt.location=ru.__importStar(gg());Kt.worksheetFuncTypesModule=ru.__importStar(Aq());Kt.adjust=ru.__importStar(dhe());Kt.annotations=ru.__importStar(mhe());Kt.cellFormat=ru.__importStar(CM());Kt.cellParse=ru.__importStar(Wq());Kt.config=ru.__importStar(TQ());Kt.mathpackXL=ru.__importStar(vQ());Kt.datepack=ru.__importStar(mQ());Kt.formulaModule=ru.__importStar(Ep());Kt.numfmt=ru.__importStar(Lq());Kt.util=ru.__importStar(S0());Kt.resolveService=ru.__importStar(Yq());Kt.resolveServiceTypes=ru.__importStar(sA());Kt.literalParse=ru.__importStar(xz());Kt.signature=ru.__importStar(aA());Kt.mathpack=ru.__importStar(RQ());Kt.visitor=ru.__importStar(gA());Kt.relabel=ru.__importStar(Whe());Kt.mathpackIEEE=ru.__importStar(Xhe());Kt.printService=ru.__importStar(i0e());Kt.printServiceTypes=ru.__importStar(FQ());Kt.testUtil=ru.__importStar(s0e());Kt.styleServiceTypes=ru.__importStar(v0e())});var No=T(ut=>{"use strict";p();Object.defineProperty(ut,"__esModule",{value:!0});ut.userDefinedFuncLoc=ut.unsafeGridRange=ut.structRefColumnLoc=ut.sheetRows=ut.sheetRangeIndexes=ut.sheetRange=ut.sheetIndex=ut.sheetGridRange=ut.sheetGridCube=ut.sheetGridCell=ut.sheetCols=ut.originCell=ut.nameScope=ut.nameLoc=ut.lexicalSourceRange=ut.lexicalSourceUDF=ut.lexicalSourceWSF=ut.lexicalSourceName=ut.lexicalSourceGrid=ut.lexicalSourceCell=ut.isSheetIndex=ut.isSheetGridRange=ut.isSheetGridCell=ut.isGridCell=ut.gridRange=ut.gridCell=ut.documentScope=ut.documentLoc=ut.allSheetsRange=ut.NameSource=ut.LexicalKind=void 0;var Li=qr();ut.LexicalKind=Li.location.LexicalKind;ut.NameSource=Li.location.NameSource;ut.allSheetsRange=Li.location.allSheetsRange;ut.documentLoc=Li.location.documentLoc;ut.documentScope=Li.location.documentScope;ut.gridCell=Li.location.gridCell;ut.gridRange=Li.location.gridRange;ut.isGridCell=Li.location.isGridCell;ut.isSheetGridCell=Li.location.isSheetGridCell;ut.isSheetGridRange=Li.location.isSheetGridRange;ut.isSheetIndex=Li.location.isSheetIndex;ut.lexicalSourceCell=Li.location.lexicalSourceCell;ut.lexicalSourceGrid=Li.location.lexicalSourceGrid;ut.lexicalSourceName=Li.location.lexicalSourceName;ut.lexicalSourceWSF=Li.location.lexicalSourceWSF;ut.lexicalSourceUDF=Li.location.lexicalSourceUDF;ut.lexicalSourceRange=Li.location.lexicalSourceRange;ut.nameLoc=Li.location.nameLoc;ut.nameScope=Li.location.nameScope;ut.originCell=Li.location.originCell;ut.sheetCols=Li.location.sheetCols;ut.sheetGridCell=Li.location.sheetGridCell;ut.sheetGridCube=Li.location.sheetGridCube;ut.sheetGridRange=Li.location.sheetGridRange;ut.sheetIndex=Li.location.sheetIndex;ut.sheetRange=Li.location.sheetRange;ut.sheetRangeIndexes=Li.location.sheetRangeIndexes;ut.sheetRows=Li.location.sheetRows;ut.structRefColumnLoc=Li.location.structRefColumnLoc;ut.unsafeGridRange=Li.location.unsafeGridRange;ut.userDefinedFuncLoc=Li.location.userDefinedFuncLoc});var vG=T(Ht=>{"use strict";p();Object.defineProperty(Ht,"__esModule",{value:!0});Ht.userDefinedFuncLoc=Ht.nameScope=Ht.nameLoc=Ht.documentScope=Ht.originCell=Ht.sheetGridCube=Ht.sheetGridRange=Ht.sheetGridCell=Ht.sheetRangeIndexes=Ht.allSheetsRange=Ht.gridRange=Ht.gridCell=Ht.sheetRange=Ht.sheetIndex=Ht.structRefColumnLoc=Ht.documentLoc=Ht.lexicalSourceUDF=Ht.lexicalSourceWSF=Ht.lexicalSourceName=Ht.lexicalSourceGrid=Ht.lexicalSourceRange=Ht.lexicalSourceCell=Ht.sheetCols=Ht.sheetRows=Ht.NameSource=Ht.LexicalKind=void 0;var lrr=fe(),tu=lrr.__importStar(No());Ht.LexicalKind=tu.LexicalKind;Ht.NameSource=tu.NameSource;Ht.sheetRows=tu.sheetRows;Ht.sheetCols=tu.sheetCols;Ht.lexicalSourceCell=tu.lexicalSourceCell;Ht.lexicalSourceRange=tu.lexicalSourceRange;Ht.lexicalSourceGrid=tu.lexicalSourceGrid;Ht.lexicalSourceName=tu.lexicalSourceName;Ht.lexicalSourceWSF=tu.lexicalSourceWSF;Ht.lexicalSourceUDF=tu.lexicalSourceUDF;Ht.documentLoc=tu.documentLoc;Ht.structRefColumnLoc=tu.structRefColumnLoc;Ht.sheetIndex=tu.sheetIndex;Ht.sheetRange=tu.sheetRange;Ht.gridCell=tu.gridCell;Ht.gridRange=tu.gridRange;Ht.allSheetsRange=tu.allSheetsRange;Ht.sheetRangeIndexes=tu.sheetRangeIndexes;Ht.sheetGridCell=tu.sheetGridCell;Ht.sheetGridRange=tu.sheetGridRange;Ht.sheetGridCube=tu.sheetGridCube;Ht.originCell=tu.originCell;Ht.documentScope=tu.documentScope;Ht.nameLoc=tu.nameLoc;Ht.nameScope=tu.nameScope;Ht.userDefinedFuncLoc=tu.userDefinedFuncLoc});var ti=T(be=>{"use strict";p();Object.defineProperty(be,"__esModule",{value:!0});be.literalNode=be.letVar=be.letNode=be.lambdaParam=be.lambdaNode=be.indexedArg=be.identQualifier=be.identNamePart=be.headNamePart=be.formulaSpan=be.singleLineComment=be.multiLineComment=be.formulaRootAnnotation=be.formula=be.flattenNameParts=be.flattenLetArgs=be.flattenLambdaArgs=be.fieldRefNode=be.contextNameNode=be.fieldRefNamePart=be.fieldRef=be.errorQualifier=be.documentQualifier=be.commaOpRef=be.columnRef=be.cellRefSingle=be.cellRefRow=be.cellRefRange=be.cellRefNode=be.cellRefNamePart=be.cellRefError=be.cellRefCol=be.cellRefBad=be.badRef=be.badQualifier=be.arrayNode=be.appNode=be.appHeadNameAnnotation=be.StructRefKind=be.SpecialRefId=be.RefStyle=be.QualifierKind=be.PosKind=be.NodeKind=be.NamePartKind=be.CommentKind=be.CellRefKind=be.BadType=be.AnnotationKind=be.SyntaxFeature=void 0;be.badSequenceNode=be.badCharsNode=be.varNode=be.identNode=be.missingNode=be.getDepthUpperBound=be.wsfNode=be.thisRowOpRef=be.structRefNode=be.structRef=be.specialRef=be.sheetRangeQualifier=be.sheetQualifier=be.relativeQualifier=be.rangeOpRef=be.pos=be.parenNode=be.paramNode=be.paramName=be.paramDefault=be.operatorNode=be.nameNode=be.missingRef=be.localNameUseAnnotation=be.localNameDeclAnnotation=void 0;var Ir=qr();be.SyntaxFeature=Ir.formulaModule.SyntaxFeature;be.AnnotationKind=Ir.formulaModule.AnnotationKind;be.BadType=Ir.formulaModule.BadType;be.CellRefKind=Ir.formulaModule.CellRefKind;be.CommentKind=Ir.formulaModule.CommentKind;be.NamePartKind=Ir.formulaModule.NamePartKind;be.NodeKind=Ir.formulaModule.NodeKind;be.PosKind=Ir.formulaModule.PosKind;be.QualifierKind=Ir.formulaModule.QualifierKind;be.RefStyle=Ir.formulaModule.RefStyle;be.SpecialRefId=Ir.formulaModule.SpecialRefId;be.StructRefKind=Ir.formulaModule.StructRefKind;be.appHeadNameAnnotation=Ir.formulaModule.appHeadNameAnnotation;be.appNode=Ir.formulaModule.appNode;be.arrayNode=Ir.formulaModule.arrayNode;be.badQualifier=Ir.formulaModule.badQualifier;be.badRef=Ir.formulaModule.badRef;be.cellRefBad=Ir.formulaModule.cellRefBad;be.cellRefCol=Ir.formulaModule.cellRefCol;be.cellRefError=Ir.formulaModule.cellRefError;be.cellRefNamePart=Ir.formulaModule.cellRefNamePart;be.cellRefNode=Ir.formulaModule.cellRefNode;be.cellRefRange=Ir.formulaModule.cellRefRange;be.cellRefRow=Ir.formulaModule.cellRefRow;be.cellRefSingle=Ir.formulaModule.cellRefSingle;be.columnRef=Ir.formulaModule.columnRef;be.commaOpRef=Ir.formulaModule.commaOpRef;be.documentQualifier=Ir.formulaModule.documentQualifier;be.errorQualifier=Ir.formulaModule.errorQualifier;be.fieldRef=Ir.formulaModule.fieldRef;be.fieldRefNamePart=Ir.formulaModule.fieldRefNamePart;be.contextNameNode=Ir.formulaModule.contextNameNode;be.fieldRefNode=Ir.formulaModule.fieldRefNode;be.flattenLambdaArgs=Ir.formulaModule.flattenLambdaArgs;be.flattenLetArgs=Ir.formulaModule.flattenLetArgs;be.flattenNameParts=Ir.formulaModule.flattenNameParts;be.formula=Ir.formulaModule.formula;be.formulaRootAnnotation=Ir.formulaModule.formulaRootAnnotation;be.multiLineComment=Ir.formulaModule.multiLineComment;be.singleLineComment=Ir.formulaModule.singleLineComment;be.formulaSpan=Ir.formulaModule.formulaSpan;be.headNamePart=Ir.formulaModule.headNamePart;be.identNamePart=Ir.formulaModule.identNamePart;be.identQualifier=Ir.formulaModule.identQualifier;be.indexedArg=Ir.formulaModule.indexedArg;be.lambdaNode=Ir.formulaModule.lambdaNode;be.lambdaParam=Ir.formulaModule.lambdaParam;be.letNode=Ir.formulaModule.letNode;be.letVar=Ir.formulaModule.letVar;be.literalNode=Ir.formulaModule.literalNode;be.localNameDeclAnnotation=Ir.formulaModule.localNameDeclAnnotation;be.localNameUseAnnotation=Ir.formulaModule.localNameUseAnnotation;be.missingRef=Ir.formulaModule.missingRef;be.nameNode=Ir.formulaModule.nameNode;be.operatorNode=Ir.formulaModule.operatorNode;be.paramDefault=Ir.formulaModule.paramDefault;be.paramName=Ir.formulaModule.paramName;be.paramNode=Ir.formulaModule.paramNode;be.parenNode=Ir.formulaModule.parenNode;be.pos=Ir.formulaModule.pos;be.rangeOpRef=Ir.formulaModule.rangeOpRef;be.relativeQualifier=Ir.formulaModule.relativeQualifier;be.sheetQualifier=Ir.formulaModule.sheetQualifier;be.sheetRangeQualifier=Ir.formulaModule.sheetRangeQualifier;be.specialRef=Ir.formulaModule.specialRef;be.structRef=Ir.formulaModule.structRef;be.structRefNode=Ir.formulaModule.structRefNode;be.thisRowOpRef=Ir.formulaModule.thisRowOpRef;be.wsfNode=Ir.formulaModule.wsfNode;be.getDepthUpperBound=Ir.formulaModule.getDepthUpperBound;be.missingNode=Ir.formulaModule.missingNode;be.identNode=Ir.formulaModule.identNode;be.varNode=Ir.formulaModule.varNode;be.badCharsNode=Ir.formulaModule.badCharsNode;be.badSequenceNode=Ir.formulaModule.badSequenceNode});var wQ=T(Te=>{"use strict";p();Object.defineProperty(Te,"__esModule",{value:!0});Te.contextNameNode=Te.fieldRefNamePart=Te.cellRefNamePart=Te.identNamePart=Te.nameNode=Te.parenNode=Te.wsfNode=Te.operatorNode=Te.lambdaNode=Te.lambdaParam=Te.paramNode=Te.paramDefault=Te.paramName=Te.flattenLambdaArgs=Te.letNode=Te.letVar=Te.indexedArg=Te.flattenLetArgs=Te.appNode=Te.arrayNode=Te.literalNode=Te.formulaSpan=Te.singleLineComment=Te.multiLineComment=Te.formula=Te.cellRefBad=Te.cellRefCol=Te.cellRefRow=Te.cellRefRange=Te.cellRefSingle=Te.cellRefError=Te.pos=Te.badQualifier=Te.sheetRangeQualifier=Te.identQualifier=Te.sheetQualifier=Te.documentQualifier=Te.relativeQualifier=Te.errorQualifier=Te.BadType=Te.StructRefKind=Te.SpecialRefId=Te.NamePartKind=Te.NodeKind=Te.CommentKind=Te.PosKind=Te.CellRefKind=Te.QualifierKind=Te.SyntaxFeature=Te.RefStyle=void 0;Te.localNameDeclAnnotation=Te.localNameUseAnnotation=Te.formulaRootAnnotation=Te.appHeadNameAnnotation=Te.AnnotationKind=Te.headNamePart=Te.flattenNameParts=Te.badSequenceNode=Te.badCharsNode=Te.missingNode=Te.identNode=Te.varNode=Te.badRef=Te.missingRef=Te.thisRowOpRef=Te.commaOpRef=Te.rangeOpRef=Te.columnRef=Te.specialRef=Te.structRef=Te.structRefNode=Te.fieldRef=Te.fieldRefNode=Te.cellRefNode=void 0;var crr=fe(),Gr=crr.__importStar(ti());Te.RefStyle=Gr.RefStyle;Te.SyntaxFeature=Gr.SyntaxFeature;Te.QualifierKind=Gr.QualifierKind;Te.CellRefKind=Gr.CellRefKind;Te.PosKind=Gr.PosKind;Te.CommentKind=Gr.CommentKind;Te.NodeKind=Gr.NodeKind;Te.NamePartKind=Gr.NamePartKind;Te.SpecialRefId=Gr.SpecialRefId;Te.StructRefKind=Gr.StructRefKind;Te.BadType=Gr.BadType;Te.errorQualifier=Gr.errorQualifier;Te.relativeQualifier=Gr.relativeQualifier;Te.documentQualifier=Gr.documentQualifier;Te.sheetQualifier=Gr.sheetQualifier;Te.identQualifier=Gr.identQualifier;Te.sheetRangeQualifier=Gr.sheetRangeQualifier;Te.badQualifier=Gr.badQualifier;Te.pos=Gr.pos;Te.cellRefError=Gr.cellRefError;Te.cellRefSingle=Gr.cellRefSingle;Te.cellRefRange=Gr.cellRefRange;Te.cellRefRow=Gr.cellRefRow;Te.cellRefCol=Gr.cellRefCol;Te.cellRefBad=Gr.cellRefBad;Te.formula=Gr.formula;Te.multiLineComment=Gr.multiLineComment;Te.singleLineComment=Gr.singleLineComment;Te.formulaSpan=Gr.formulaSpan;Te.literalNode=Gr.literalNode;Te.arrayNode=Gr.arrayNode;Te.appNode=Gr.appNode;Te.flattenLetArgs=Gr.flattenLetArgs;Te.indexedArg=Gr.indexedArg;Te.letVar=Gr.letVar;Te.letNode=Gr.letNode;Te.flattenLambdaArgs=Gr.flattenLambdaArgs;Te.paramName=Gr.paramName;Te.paramDefault=Gr.paramDefault;Te.paramNode=Gr.paramNode;Te.lambdaParam=Gr.lambdaParam;Te.lambdaNode=Gr.lambdaNode;Te.operatorNode=Gr.operatorNode;Te.wsfNode=Gr.wsfNode;Te.parenNode=Gr.parenNode;Te.nameNode=Gr.nameNode;Te.identNamePart=Gr.identNamePart;Te.cellRefNamePart=Gr.cellRefNamePart;Te.fieldRefNamePart=Gr.fieldRefNamePart;Te.contextNameNode=Gr.contextNameNode;Te.cellRefNode=Gr.cellRefNode;Te.fieldRefNode=Gr.fieldRefNode;Te.fieldRef=Gr.fieldRef;Te.structRefNode=Gr.structRefNode;Te.structRef=Gr.structRef;Te.specialRef=Gr.specialRef;Te.columnRef=Gr.columnRef;Te.rangeOpRef=Gr.rangeOpRef;Te.commaOpRef=Gr.commaOpRef;Te.thisRowOpRef=Gr.thisRowOpRef;Te.missingRef=Gr.missingRef;Te.badRef=Gr.badRef;Te.varNode=Gr.varNode;Te.identNode=Gr.identNode;Te.missingNode=Gr.missingNode;Te.badCharsNode=Gr.badCharsNode;Te.badSequenceNode=Gr.badSequenceNode;Te.flattenNameParts=Gr.flattenNameParts;Te.headNamePart=Gr.headNamePart;Te.AnnotationKind=Gr.AnnotationKind;Te.appHeadNameAnnotation=Gr.appHeadNameAnnotation;Te.formulaRootAnnotation=Gr.formulaRootAnnotation;Te.localNameUseAnnotation=Gr.localNameUseAnnotation;Te.localNameDeclAnnotation=Gr.localNameDeclAnnotation});var _y=T(Ct=>{"use strict";p();Object.defineProperty(Ct,"__esModule",{value:!0});Ct.valueErrorOper=Ct.trueOper=Ct.stringOper=Ct.refErrorOper=Ct.rangeSeqOper=Ct.range3DOper=Ct.precedents=Ct.numErrorOper=Ct.nullErrorOper=Ct.nameErrorOper=Ct.naErrorOper=Ct.missingOper=Ct.externalErrorOper=Ct.busyErrorOper=Ct.calcErrorOper=Ct.fieldErrorOper=Ct.unknownErrorOper=Ct.blockedErrorOper=Ct.connectErrorOper=Ct.spillErrorOper=Ct.gettingDataErrorOper=Ct.falseOper=Ct.errorOper=Ct.div0ErrorOper=Ct.cellStringLimit=Ct.booleanOper=Ct.blankOper=Ct.arrayOper=Ct.PrecsBound=Ct.ErrorType=void 0;var eo=qr();Ct.ErrorType=eo.value.ErrorType;Ct.PrecsBound=eo.value.PrecsBound;Ct.arrayOper=eo.value.arrayOper;Ct.blankOper=eo.value.blankOper;Ct.booleanOper=eo.value.booleanOper;Ct.cellStringLimit=eo.value.cellStringLimit;Ct.div0ErrorOper=eo.value.div0ErrorOper;Ct.errorOper=eo.value.errorOper;Ct.falseOper=eo.value.falseOper;Ct.gettingDataErrorOper=eo.value.gettingDataErrorOper;Ct.spillErrorOper=eo.value.spillErrorOper;Ct.connectErrorOper=eo.value.connectErrorOper;Ct.blockedErrorOper=eo.value.blockedErrorOper;Ct.unknownErrorOper=eo.value.unknownErrorOper;Ct.fieldErrorOper=eo.value.fieldErrorOper;Ct.calcErrorOper=eo.value.calcErrorOper;Ct.busyErrorOper=eo.value.busyErrorOper;Ct.externalErrorOper=eo.value.externalErrorOper;Ct.missingOper=eo.value.missingOper;Ct.naErrorOper=eo.value.naErrorOper;Ct.nameErrorOper=eo.value.nameErrorOper;Ct.nullErrorOper=eo.value.nullErrorOper;Ct.numErrorOper=eo.value.numErrorOper;Ct.precedents=eo.value.precedents;Ct.range3DOper=eo.value.range3DOper;Ct.rangeSeqOper=eo.value.rangeSeqOper;Ct.refErrorOper=eo.value.refErrorOper;Ct.stringOper=eo.value.stringOper;Ct.trueOper=eo.value.trueOper;Ct.valueErrorOper=eo.value.valueErrorOper});var Eg=T(Rg=>{"use strict";p();Object.defineProperty(Rg,"__esModule",{value:!0});Rg.functionType=Rg.SpecialPrecs=Rg.SignatureType=Rg.OperKind=Rg.FunctionFlags=void 0;var DM=qr();Rg.FunctionFlags=DM.types.FunctionFlags;Rg.OperKind=DM.types.OperKind;Rg.SignatureType=DM.types.SignatureType;Rg.SpecialPrecs=DM.types.SpecialPrecs;Rg.functionType=DM.types.functionType});var hG=T(st=>{"use strict";p();Object.defineProperty(st,"__esModule",{value:!0});st.blankOper=st.missingOper=st.range3DOper=st.rangeSeqOper=st.arrayOper=st.externalErrorOper=st.busyErrorOper=st.calcErrorOper=st.fieldErrorOper=st.unknownErrorOper=st.blockedErrorOper=st.connectErrorOper=st.spillErrorOper=st.gettingDataErrorOper=st.naErrorOper=st.numErrorOper=st.nameErrorOper=st.refErrorOper=st.valueErrorOper=st.div0ErrorOper=st.nullErrorOper=st.errorOper=st.booleanOper=st.stringOper=st.precedents=st.ErrorType=st.falseOper=st.trueOper=st.OperKind=st.PrecsBound=st.SpecialPrecs=void 0;var h0e=fe(),So=h0e.__importStar(_y()),S0e=h0e.__importStar(Eg());st.SpecialPrecs=S0e.SpecialPrecs;st.PrecsBound=So.PrecsBound;st.OperKind=S0e.OperKind;st.trueOper=So.trueOper;st.falseOper=So.falseOper;st.ErrorType=So.ErrorType;st.precedents=So.precedents;st.stringOper=So.stringOper;st.booleanOper=So.booleanOper;st.errorOper=So.errorOper;st.nullErrorOper=So.nullErrorOper;st.div0ErrorOper=So.div0ErrorOper;st.valueErrorOper=So.valueErrorOper;st.refErrorOper=So.refErrorOper;st.nameErrorOper=So.nameErrorOper;st.numErrorOper=So.numErrorOper;st.naErrorOper=So.naErrorOper;st.gettingDataErrorOper=So.gettingDataErrorOper;st.spillErrorOper=So.spillErrorOper;st.connectErrorOper=So.connectErrorOper;st.blockedErrorOper=So.blockedErrorOper;st.unknownErrorOper=So.unknownErrorOper;st.fieldErrorOper=So.fieldErrorOper;st.calcErrorOper=So.calcErrorOper;st.busyErrorOper=So.busyErrorOper;st.externalErrorOper=So.externalErrorOper;st.arrayOper=So.arrayOper;st.rangeSeqOper=So.rangeSeqOper;st.range3DOper=So.range3DOper;st.missingOper=So.missingOper;st.blankOper=So.blankOper});var Qf=T(Rl=>{"use strict";p();Object.defineProperty(Rl,"__esModule",{value:!0});Rl.unknownFunctionType=Rl.operatorStrings=Rl.higherOrderFunctionType=Rl.isVolatileFunc=Rl.getWorksheetFuncType=Rl.getWorksheetFuncEnglishName=Rl.getOperatorType=Rl.WorksheetFuncId=Rl.OperatorId=void 0;var by=qr();Rl.OperatorId=by.signature.OperatorId;Rl.WorksheetFuncId=by.signature.WorksheetFuncId;Rl.getOperatorType=by.signature.getOperatorType;Rl.getWorksheetFuncEnglishName=by.signature.getWorksheetFuncEnglishName;Rl.getWorksheetFuncType=by.signature.getWorksheetFuncType;Rl.isVolatileFunc=by.signature.isVolatileFunc;Rl.higherOrderFunctionType=by.signature.higherOrderFunctionType;Rl.operatorStrings=by.signature.operatorStrings;Rl.unknownFunctionType=by.signature.unknownFunctionType});var _0e=T(El=>{"use strict";p();Object.defineProperty(El,"__esModule",{value:!0});El.getWorksheetFuncType=El.getOperatorType=El.unknownFunctionType=El.functionType=El.SpecialPrecs=El.WorksheetFuncId=El.OperatorId=El.FunctionFlags=El.SignatureType=void 0;var y0e=fe(),LM=y0e.__importStar(Qf()),SG=y0e.__importStar(Eg());El.SignatureType=SG.SignatureType;El.FunctionFlags=SG.FunctionFlags;El.OperatorId=LM.OperatorId;El.WorksheetFuncId=LM.WorksheetFuncId;El.SpecialPrecs=SG.SpecialPrecs;El.functionType=SG.functionType;El.unknownFunctionType=LM.unknownFunctionType;El.getOperatorType=LM.getOperatorType;El.getWorksheetFuncType=LM.getWorksheetFuncType});var DQ=T(ra=>{"use strict";p();Object.defineProperty(ra,"__esModule",{value:!0});ra.shouldQuoteQualifier=ra.resolvePosition=ra.quoteQualifier=ra.formatRowRange=ra.formatRow=ra.formatRangePos=ra.formatQualifier=ra.formatName=ra.formatGridRange=ra.formatColRange=ra.formatCol=ra.formatCellPos=ra.columnName=ra.canonicaliseRowRange=ra.canonicaliseRow=ra.canonicaliseRangePos=ra.canonicaliseColRange=ra.canonicaliseCol=ra.canonicaliseCellPos=ra.canonicaliseBrackets=void 0;var Pl=qr();ra.canonicaliseBrackets=Pl.cellFormat.canonicaliseBrackets;ra.canonicaliseCellPos=Pl.cellFormat.canonicaliseCellPos;ra.canonicaliseCol=Pl.cellFormat.canonicaliseCol;ra.canonicaliseColRange=Pl.cellFormat.canonicaliseColRange;ra.canonicaliseRangePos=Pl.cellFormat.canonicaliseRangePos;ra.canonicaliseRow=Pl.cellFormat.canonicaliseRow;ra.canonicaliseRowRange=Pl.cellFormat.canonicaliseRowRange;ra.columnName=Pl.cellFormat.columnName;ra.formatCellPos=Pl.cellFormat.formatCellPos;ra.formatCol=Pl.cellFormat.formatCol;ra.formatColRange=Pl.cellFormat.formatColRange;ra.formatGridRange=Pl.cellFormat.formatGridRange;ra.formatName=Pl.cellFormat.formatName;ra.formatQualifier=Pl.cellFormat.formatQualifier;ra.formatRangePos=Pl.cellFormat.formatRangePos;ra.formatRow=Pl.cellFormat.formatRow;ra.formatRowRange=Pl.cellFormat.formatRowRange;ra.quoteQualifier=Pl.cellFormat.quoteQualifier;ra.resolvePosition=Pl.cellFormat.resolvePosition;ra.shouldQuoteQualifier=Pl.cellFormat.shouldQuoteQualifier});var b0e=T(Zd=>{"use strict";p();Object.defineProperty(Zd,"__esModule",{value:!0});Zd.wrapPosition=Zd.parseQualifier=Zd.parseGridRangeA1=Zd.parseGridCellA1=Zd.parseCellRef=Zd.isR1C1IdentStart=Zd.SpecialPos=void 0;var AT=qr();Zd.SpecialPos=AT.cellParse.SpecialPos;Zd.isR1C1IdentStart=AT.cellParse.isR1C1IdentStart;Zd.parseCellRef=AT.cellParse.parseCellRef;Zd.parseGridCellA1=AT.cellParse.parseGridCellA1;Zd.parseGridRangeA1=AT.cellParse.parseGridRangeA1;Zd.parseQualifier=AT.cellParse.parseQualifier;Zd.wrapPosition=AT.cellParse.wrapPosition});var qi=T(xe=>{"use strict";p();Object.defineProperty(xe,"__esModule",{value:!0});xe.isSheetGridRangeEqual=xe.isSheetGridRange=xe.isSheetGridCellEqual=xe.isSheetGridCell=xe.isRichOper=xe.isReadOperEqual=xe.isRangeOper=xe.isRangeOpNoMissing=xe.isRangeOpClosed=xe.isPrimitiveOper=xe.isOperatorNode=xe.isNumberOper=xe.isNumberLiteralNode=xe.isNameScopeEqual=xe.isMissingOper=xe.isMissingNode=xe.isGridRangeEqual=xe.isGridCellEqual=xe.isGridCell=xe.isErrorOper=xe.isDocumentLocEqual=xe.isCommaOpRefWellFormed=xe.isCommaOpNoBadOrMissing=xe.isCommaOpClosed=xe.isBooleanOper=xe.isBooleanLiteralNode=xe.isBlankOper=xe.isArrayOper=xe.internal=xe.gridRangesJoin=xe.gridRangeSize=xe.gridRangeJoinOpt=xe.gridRangeJoin=xe.gridRangeIsects=xe.gridRangeIsect=xe.gridRangeExcept=xe.gridRangeCompare=xe.gridRangeAnchor=xe.gridCellRange=xe.gridCellImplicitIsect=xe.getWorksheetFuncId=xe.getUserDefinedFuncName=xe.getBoundName=xe.getArguments=xe.getArgType=xe.forEachTileInRange=xe.forEachCellInRange=xe.createFailureErrorClass=xe.ReasonKind=xe.LangReasonKind=void 0;xe.unavailable=xe.shouldFieldRefBeBracketed=xe.sheetGridRangeAnchor=xe.notImplemented=xe.normalizeCommaOpRef=xe.isWriteOper=xe.isWellFormed=xe.isWSFNode=xe.isValidArgsLength=xe.isUnqualifiedNameNode=xe.isStringOper=xe.sheetRangeToSheetIndex=xe.isSheetIndexEqual=xe.isSheetIndex=void 0;var lt=qr();xe.LangReasonKind=lt.util.LangReasonKind;xe.ReasonKind=lt.util.ReasonKind;xe.createFailureErrorClass=lt.util.createFailureErrorClass;xe.forEachCellInRange=lt.util.forEachCellInRange;xe.forEachTileInRange=lt.util.forEachTileInRange;xe.getArgType=lt.util.getArgType;xe.getArguments=lt.util.getArguments;xe.getBoundName=lt.util.getBoundName;xe.getUserDefinedFuncName=lt.util.getUserDefinedFuncName;xe.getWorksheetFuncId=lt.util.getWorksheetFuncId;xe.gridCellImplicitIsect=lt.util.gridCellImplicitIsect;xe.gridCellRange=lt.util.gridCellRange;xe.gridRangeAnchor=lt.util.gridRangeAnchor;xe.gridRangeCompare=lt.util.gridRangeCompare;xe.gridRangeExcept=lt.util.gridRangeExcept;xe.gridRangeIsect=lt.util.gridRangeIsect;xe.gridRangeIsects=lt.util.gridRangeIsects;xe.gridRangeJoin=lt.util.gridRangeJoin;xe.gridRangeJoinOpt=lt.util.gridRangeJoinOpt;xe.gridRangeSize=lt.util.gridRangeSize;xe.gridRangesJoin=lt.util.gridRangesJoin;xe.internal=lt.util.internal;xe.isArrayOper=lt.util.isArrayOper;xe.isBlankOper=lt.util.isBlankOper;xe.isBooleanLiteralNode=lt.util.isBooleanLiteralNode;xe.isBooleanOper=lt.util.isBooleanOper;xe.isCommaOpClosed=lt.util.isCommaOpClosed;xe.isCommaOpNoBadOrMissing=lt.util.isCommaOpNoBadOrMissing;xe.isCommaOpRefWellFormed=lt.util.isCommaOpRefWellFormed;xe.isDocumentLocEqual=lt.util.isDocumentLocEqual;xe.isErrorOper=lt.util.isErrorOper;xe.isGridCell=lt.util.isGridCell;xe.isGridCellEqual=lt.util.isGridCellEqual;xe.isGridRangeEqual=lt.util.isGridRangeEqual;xe.isMissingNode=lt.util.isMissingNode;xe.isMissingOper=lt.util.isMissingOper;xe.isNameScopeEqual=lt.util.isNameScopeEqual;xe.isNumberLiteralNode=lt.util.isNumberLiteralNode;xe.isNumberOper=lt.util.isNumberOper;xe.isOperatorNode=lt.util.isOperatorNode;xe.isPrimitiveOper=lt.util.isPrimitiveOper;xe.isRangeOpClosed=lt.util.isRangeOpClosed;xe.isRangeOpNoMissing=lt.util.isRangeOpNoMissing;xe.isRangeOper=lt.util.isRangeOper;xe.isReadOperEqual=lt.util.isReadOperEqual;xe.isRichOper=lt.util.isRichOper;xe.isSheetGridCell=lt.util.isSheetGridCell;xe.isSheetGridCellEqual=lt.util.isSheetGridCellEqual;xe.isSheetGridRange=lt.util.isSheetGridRange;xe.isSheetGridRangeEqual=lt.util.isSheetGridRangeEqual;xe.isSheetIndex=lt.util.isSheetIndex;xe.isSheetIndexEqual=lt.util.isSheetIndexEqual;xe.sheetRangeToSheetIndex=lt.util.sheetRangeToSheetIndex;xe.isStringOper=lt.util.isStringOper;xe.isUnqualifiedNameNode=lt.util.isUnqualifiedNameNode;xe.isValidArgsLength=lt.util.isValidArgsLength;xe.isWSFNode=lt.util.isWSFNode;xe.isWellFormed=lt.util.isWellFormed;xe.isWriteOper=lt.util.isWriteOper;xe.normalizeCommaOpRef=lt.util.normalizeCommaOpRef;xe.notImplemented=lt.util.notImplemented;xe.sheetGridRangeAnchor=lt.util.sheetGridRangeAnchor;xe.shouldFieldRefBeBracketed=lt.util.shouldFieldRefBeBracketed;xe.unavailable=lt.util.unavailable});var kA=T(ya=>{"use strict";p();Object.defineProperty(ya,"__esModule",{value:!0});ya.resolvedUserDefinedFunc=ya.resolvedStructRef=ya.resolvedNever=ya.resolvedName=ya.resolvedWorksheetFunc=ya.resolvedLocalName=ya.resolvedDottedName=ya.resolvedCellRef=ya.resolveLocalsGrid=ya.noOriginSheet=ya.invalidStructRef=ya.invalidQualifier=ya.invalidCellRef=ya.emptyIntersection=ya.ResolvedKind=ya.ResolveReasonKind=ya.InvalidStructRefReason=ya.InvalidQualifierReason=ya.InvalidCellRefReason=void 0;var Zl=qr();ya.InvalidCellRefReason=Zl.resolveServiceTypes.InvalidCellRefReason;ya.InvalidQualifierReason=Zl.resolveServiceTypes.InvalidQualifierReason;ya.InvalidStructRefReason=Zl.resolveServiceTypes.InvalidStructRefReason;ya.ResolveReasonKind=Zl.resolveServiceTypes.ResolveReasonKind;ya.ResolvedKind=Zl.resolveServiceTypes.ResolvedKind;ya.emptyIntersection=Zl.resolveServiceTypes.emptyIntersection;ya.invalidCellRef=Zl.resolveServiceTypes.invalidCellRef;ya.invalidQualifier=Zl.resolveServiceTypes.invalidQualifier;ya.invalidStructRef=Zl.resolveServiceTypes.invalidStructRef;ya.noOriginSheet=Zl.resolveServiceTypes.noOriginSheet;ya.resolveLocalsGrid=Zl.resolveServiceTypes.resolveLocalsGrid;ya.resolvedCellRef=Zl.resolveServiceTypes.resolvedCellRef;ya.resolvedDottedName=Zl.resolveServiceTypes.resolvedDottedName;ya.resolvedLocalName=Zl.resolveServiceTypes.resolvedLocalName;ya.resolvedWorksheetFunc=Zl.resolveServiceTypes.resolvedWorksheetFunc;ya.resolvedName=Zl.resolveServiceTypes.resolvedName;ya.resolvedNever=Zl.resolveServiceTypes.resolvedNever;ya.resolvedStructRef=Zl.resolveServiceTypes.resolvedStructRef;ya.resolvedUserDefinedFunc=Zl.resolveServiceTypes.resolvedUserDefinedFunc});var zn=T($d=>{"use strict";p();Object.defineProperty($d,"__esModule",{value:!0});$d.successUndefined=$d.success=$d.javaScriptError=$d.isSuccess=$d.failure=$d.ResultKind=$d.ReasonKind=void 0;var FT=pr();$d.ReasonKind=FT.result.ReasonKind;$d.ResultKind=FT.result.ResultKind;$d.failure=FT.result.failure;$d.isSuccess=FT.result.isSuccess;$d.javaScriptError=FT.result.javaScriptError;$d.success=FT.result.success;$d.successUndefined=FT.result.successUndefined});var yG=T(Pg=>{"use strict";p();Object.defineProperty(Pg,"__esModule",{value:!0});Pg.canDenoteCellRef=Pg.canDenoteUserDefinedFunc=Pg.canDenoteLocalName=Pg.resolveGridRef=Pg.createResolver=void 0;var qM=qr();Pg.createResolver=qM.resolveService.createResolver;Pg.resolveGridRef=qM.resolveService.resolveGridRef;Pg.canDenoteLocalName=qM.resolveService.canDenoteLocalName;Pg.canDenoteUserDefinedFunc=qM.resolveService.canDenoteUserDefinedFunc;Pg.canDenoteCellRef=qM.resolveService.canDenoteCellRef});var ks=T(xt=>{"use strict";p();Object.defineProperty(xt,"__esModule",{value:!0});xt.zipVisitor=xt.voidVisitor=xt.visitWSFNode=xt.visitQualifier=xt.visitOperatorNode=xt.visitFormulaNode=xt.visitCellRef=xt.visitAppHeadNode=xt.reduceTopDown_Pledge=xt.reducePledge=xt.reduceBottomUp_Recursive=xt.reduceBottomUp_Pledge=xt.reduceBottomUp_MaxDepth=xt.reduceBottomUp_CPS=xt.reduceBottomUp=xt.identityVisitor=xt.depthVisitor=xt.constVisitor=xt.composeVisitor=xt.bindVisitor=xt.binaryVisitor=xt.ZipVisitor=xt.PledgeReducer=xt.IdentityVisitor=xt.DelegatingVisitor=xt.ConstVisitor=xt.ComposeVisitor=xt.BinaryVisitor=void 0;var Oo=qr();xt.BinaryVisitor=Oo.visitor.BinaryVisitor;xt.ComposeVisitor=Oo.visitor.ComposeVisitor;xt.ConstVisitor=Oo.visitor.ConstVisitor;xt.DelegatingVisitor=Oo.visitor.DelegatingVisitor;xt.IdentityVisitor=Oo.visitor.IdentityVisitor;xt.PledgeReducer=Oo.visitor.PledgeReducer;xt.ZipVisitor=Oo.visitor.ZipVisitor;xt.binaryVisitor=Oo.visitor.binaryVisitor;xt.bindVisitor=Oo.visitor.bindVisitor;xt.composeVisitor=Oo.visitor.composeVisitor;xt.constVisitor=Oo.visitor.constVisitor;xt.depthVisitor=Oo.visitor.depthVisitor;xt.identityVisitor=Oo.visitor.identityVisitor;xt.reduceBottomUp=Oo.visitor.reduceBottomUp;xt.reduceBottomUp_CPS=Oo.visitor.reduceBottomUp_CPS;xt.reduceBottomUp_MaxDepth=Oo.visitor.reduceBottomUp_MaxDepth;xt.reduceBottomUp_Pledge=Oo.visitor.reduceBottomUp_Pledge;xt.reduceBottomUp_Recursive=Oo.visitor.reduceBottomUp_Recursive;xt.reducePledge=Oo.visitor.reducePledge;xt.reduceTopDown_Pledge=Oo.visitor.reduceTopDown_Pledge;xt.visitAppHeadNode=Oo.visitor.visitAppHeadNode;xt.visitCellRef=Oo.visitor.visitCellRef;xt.visitFormulaNode=Oo.visitor.visitFormulaNode;xt.visitOperatorNode=Oo.visitor.visitOperatorNode;xt.visitQualifier=Oo.visitor.visitQualifier;xt.visitWSFNode=Oo.visitor.visitWSFNode;xt.voidVisitor=Oo.visitor.voidVisitor;xt.zipVisitor=Oo.visitor.zipVisitor});var C0e=T(_G=>{"use strict";p();Object.defineProperty(_G,"__esModule",{value:!0});_G.buildAnnotations=void 0;var drr=qr();_G.buildAnnotations=drr.annotations.buildAnnotations});var T0e=T(bG=>{"use strict";p();Object.defineProperty(bG,"__esModule",{value:!0});bG.relabelFormula=void 0;var frr=qr();bG.relabelFormula=frr.relabel.relabelFormula});var CG=T(Rb=>{"use strict";p();Object.defineProperty(Rb,"__esModule",{value:!0});Rb.printLocalsName=Rb.printLocalsGrid=Rb.createSimplePrintGlobals=void 0;var LQ=qr();Rb.createSimplePrintGlobals=LQ.printServiceTypes.createSimplePrintGlobals;Rb.printLocalsGrid=LQ.printServiceTypes.printLocalsGrid;Rb.printLocalsName=LQ.printServiceTypes.printLocalsName});var TG=T(MA=>{"use strict";p();Object.defineProperty(MA,"__esModule",{value:!0});MA.createPrinter=MA.anonymizeFormula=void 0;var R0e=qr();MA.anonymizeFormula=R0e.printService.anonymizeFormula;MA.createPrinter=R0e.printService.createPrinter});var P0e=T(ae=>{"use strict";p();Object.defineProperty(ae,"__esModule",{value:!0});ae.ReasonKind=ae.isSuccess=ae.successUndefined=ae.failure=ae.success=ae.ResultKind=ae.isReadOperEqual=ae.isWriteOper=ae.isPrimitiveOper=ae.isRichOper=ae.isBlankOper=ae.isMissingOper=ae.isArrayOper=ae.isRangeOper=ae.isErrorOper=ae.isBooleanOper=ae.isStringOper=ae.isNumberOper=ae.isValidArgsLength=ae.getArgType=ae.getArguments=ae.gridCellRange=ae.sheetGridRangeAnchor=ae.gridRangeAnchor=ae.isWSFNode=ae.isOperatorNode=ae.isUnqualifiedNameNode=ae.isWellFormed=ae.isSheetGridRangeEqual=ae.isSheetGridCellEqual=ae.isGridRangeEqual=ae.isGridCellEqual=ae.isNameScopeEqual=ae.isSheetIndexEqual=ae.isDocumentLocEqual=ae.gridRangeSize=ae.gridRangeExcept=ae.gridRangeCompare=ae.gridCellImplicitIsect=ae.gridRangeIsects=ae.gridRangeIsect=ae.gridRangesJoin=ae.gridRangeJoinOpt=ae.gridRangeJoin=ae.forEachTileInRange=ae.forEachCellInRange=ae.isSheetGridCell=ae.isGridCell=ae.isSheetGridRange=ae.isSheetIndex=void 0;ae.ConstVisitor=ae.identityVisitor=ae.IdentityVisitor=ae.visitCellRef=ae.visitQualifier=ae.visitAppHeadNode=ae.visitWSFNode=ae.visitOperatorNode=ae.visitFormulaNode=ae.resolveGridRef=ae.createResolver=ae.resolvedDottedName=ae.resolvedNever=ae.resolvedStructRef=ae.resolvedWorksheetFunc=ae.resolvedLocalName=ae.resolvedUserDefinedFunc=ae.resolvedCellRef=ae.resolvedName=ae.ResolvedKind=ae.emptyIntersection=ae.InvalidStructRefReason=ae.invalidStructRef=ae.InvalidCellRefReason=ae.invalidCellRef=ae.InvalidQualifierReason=ae.invalidQualifier=ae.noOriginSheet=ae.ResolveReasonKind=ae.resolveLocalsGrid=ae.wrapPosition=ae.parseQualifier=ae.parseGridRangeA1=ae.parseGridCellA1=ae.formatName=ae.formatGridRange=ae.formatQualifier=ae.formatRangePos=ae.formatCellPos=ae.formatColRange=ae.formatRowRange=ae.formatCol=ae.formatRow=ae.resolvePosition=ae.columnName=ae.createFailureErrorClass=ae.javaScriptError=ae.internal=ae.unavailable=ae.notImplemented=void 0;ae.relabelFormula=ae.createPrinter=ae.printLocalsName=ae.printLocalsGrid=ae.createSimplePrintGlobals=ae.buildAnnotations=ae.reducePledge=ae.reduceBottomUp=ae.composeVisitor=ae.ComposeVisitor=ae.binaryVisitor=ae.BinaryVisitor=ae.DelegatingVisitor=ae.voidVisitor=ae.constVisitor=void 0;var lh=fe(),ch=lh.__importStar(DQ()),RG=lh.__importStar(b0e()),_n=lh.__importStar(qi()),$l=lh.__importStar(kA()),xA=lh.__importStar(zn()),E0e=lh.__importStar(yG()),Oc=lh.__importStar(ks()),prr=lh.__importStar(C0e()),mrr=lh.__importStar(T0e()),qQ=lh.__importStar(CG()),grr=lh.__importStar(TG());ae.isSheetIndex=_n.isSheetIndex;ae.isSheetGridRange=_n.isSheetGridRange;ae.isGridCell=_n.isGridCell;ae.isSheetGridCell=_n.isSheetGridCell;ae.forEachCellInRange=_n.forEachCellInRange;ae.forEachTileInRange=_n.forEachTileInRange;ae.gridRangeJoin=_n.gridRangeJoin;ae.gridRangeJoinOpt=_n.gridRangeJoinOpt;ae.gridRangesJoin=_n.gridRangesJoin;ae.gridRangeIsect=_n.gridRangeIsect;ae.gridRangeIsects=_n.gridRangeIsects;ae.gridCellImplicitIsect=_n.gridCellImplicitIsect;ae.gridRangeCompare=_n.gridRangeCompare;ae.gridRangeExcept=_n.gridRangeExcept;ae.gridRangeSize=_n.gridRangeSize;ae.isDocumentLocEqual=_n.isDocumentLocEqual;ae.isSheetIndexEqual=_n.isSheetIndexEqual;ae.isNameScopeEqual=_n.isNameScopeEqual;ae.isGridCellEqual=_n.isGridCellEqual;ae.isGridRangeEqual=_n.isGridRangeEqual;ae.isSheetGridCellEqual=_n.isSheetGridCellEqual;ae.isSheetGridRangeEqual=_n.isSheetGridRangeEqual;ae.isWellFormed=_n.isWellFormed;ae.isUnqualifiedNameNode=_n.isUnqualifiedNameNode;ae.isOperatorNode=_n.isOperatorNode;ae.isWSFNode=_n.isWSFNode;ae.gridRangeAnchor=_n.gridRangeAnchor;ae.sheetGridRangeAnchor=_n.sheetGridRangeAnchor;ae.gridCellRange=_n.gridCellRange;ae.getArguments=_n.getArguments;ae.getArgType=_n.getArgType;ae.isValidArgsLength=_n.isValidArgsLength;ae.isNumberOper=_n.isNumberOper;ae.isStringOper=_n.isStringOper;ae.isBooleanOper=_n.isBooleanOper;ae.isErrorOper=_n.isErrorOper;ae.isRangeOper=_n.isRangeOper;ae.isArrayOper=_n.isArrayOper;ae.isMissingOper=_n.isMissingOper;ae.isBlankOper=_n.isBlankOper;ae.isRichOper=_n.isRichOper;ae.isPrimitiveOper=_n.isPrimitiveOper;ae.isWriteOper=_n.isWriteOper;ae.isReadOperEqual=_n.isReadOperEqual;ae.ResultKind=xA.ResultKind;ae.success=xA.success;ae.failure=xA.failure;ae.successUndefined=xA.successUndefined;ae.isSuccess=xA.isSuccess;ae.ReasonKind=_n.ReasonKind;ae.notImplemented=_n.notImplemented;ae.unavailable=_n.unavailable;ae.internal=_n.internal;ae.javaScriptError=xA.javaScriptError;ae.createFailureErrorClass=_n.createFailureErrorClass;ae.columnName=ch.columnName;ae.resolvePosition=ch.resolvePosition;ae.formatRow=ch.formatRow;ae.formatCol=ch.formatCol;ae.formatRowRange=ch.formatRowRange;ae.formatColRange=ch.formatColRange;ae.formatCellPos=ch.formatCellPos;ae.formatRangePos=ch.formatRangePos;ae.formatQualifier=ch.formatQualifier;ae.formatGridRange=ch.formatGridRange;ae.formatName=ch.formatName;ae.parseGridCellA1=RG.parseGridCellA1;ae.parseGridRangeA1=RG.parseGridRangeA1;ae.parseQualifier=RG.parseQualifier;ae.wrapPosition=RG.wrapPosition;ae.resolveLocalsGrid=$l.resolveLocalsGrid;ae.ResolveReasonKind=$l.ResolveReasonKind;ae.noOriginSheet=$l.noOriginSheet;ae.invalidQualifier=$l.invalidQualifier;ae.InvalidQualifierReason=$l.InvalidQualifierReason;ae.invalidCellRef=$l.invalidCellRef;ae.InvalidCellRefReason=$l.InvalidCellRefReason;ae.invalidStructRef=$l.invalidStructRef;ae.InvalidStructRefReason=$l.InvalidStructRefReason;ae.emptyIntersection=$l.emptyIntersection;ae.ResolvedKind=$l.ResolvedKind;ae.resolvedName=$l.resolvedName;ae.resolvedCellRef=$l.resolvedCellRef;ae.resolvedUserDefinedFunc=$l.resolvedUserDefinedFunc;ae.resolvedLocalName=$l.resolvedLocalName;ae.resolvedWorksheetFunc=$l.resolvedWorksheetFunc;ae.resolvedStructRef=$l.resolvedStructRef;ae.resolvedNever=$l.resolvedNever;ae.resolvedDottedName=$l.resolvedDottedName;ae.createResolver=E0e.createResolver;ae.resolveGridRef=E0e.resolveGridRef;ae.visitFormulaNode=Oc.visitFormulaNode;ae.visitOperatorNode=Oc.visitOperatorNode;ae.visitWSFNode=Oc.visitWSFNode;ae.visitAppHeadNode=Oc.visitAppHeadNode;ae.visitQualifier=Oc.visitQualifier;ae.visitCellRef=Oc.visitCellRef;ae.IdentityVisitor=Oc.IdentityVisitor;ae.identityVisitor=Oc.identityVisitor;ae.ConstVisitor=Oc.ConstVisitor;ae.constVisitor=Oc.constVisitor;ae.voidVisitor=Oc.voidVisitor;ae.DelegatingVisitor=Oc.DelegatingVisitor;ae.BinaryVisitor=Oc.BinaryVisitor;ae.binaryVisitor=Oc.binaryVisitor;ae.ComposeVisitor=Oc.ComposeVisitor;ae.composeVisitor=Oc.composeVisitor;ae.reduceBottomUp=Oc.reduceBottomUp;ae.reducePledge=Oc.reducePledge;ae.buildAnnotations=prr.buildAnnotations;ae.createSimplePrintGlobals=qQ.createSimplePrintGlobals;ae.printLocalsGrid=qQ.printLocalsGrid;ae.printLocalsName=qQ.printLocalsName;ae.createPrinter=grr.createPrinter;ae.relabelFormula=mrr.relabelFormula});var Gi=T(Qr=>{"use strict";p();Object.defineProperty(Qr,"__esModule",{value:!0});Qr.ulsLogger=Qr.operatorIdToName=Qr.localeInfo=Qr.isIdentContinue=Qr.isIdentStart=Qr.isNumeral=Qr.getOrdinal=Qr.getNumberShape=Qr.getEnglishWorksheetFuncIdToName=Qr.getEnglishLocaleInfo=Qr.englishWorksheetFuncIdToName=Qr.englishSysTimeFormat=Qr.englishSysDateFormat=Qr.englishSpecialRefNames=Qr.englishPictureSpecial=Qr.englishPictureSingle=Qr.englishPictureDbnum=Qr.englishPictureColor=Qr.englishOperatorIdToName=Qr.englishErrorTypeToName=Qr.englishErrorNames=Qr.createIsThousandsPositionCallback=Qr.createWorksheetFuncNameCallbacks=Qr.calcConfig=Qr.TraceLevel=Qr.PictureSpecial=Qr.PictureSingle=Qr.PictureDbnum=Qr.PictureColor=Qr.NulLogger=Qr.LogCategory=Qr.LCID=Qr.Country=void 0;var hi=qr();Qr.Country=hi.config.Country;Qr.LCID=hi.config.LCID;Qr.LogCategory=hi.config.LogCategory;Qr.NulLogger=hi.config.NulLogger;Qr.PictureColor=hi.config.PictureColor;Qr.PictureDbnum=hi.config.PictureDbnum;Qr.PictureSingle=hi.config.PictureSingle;Qr.PictureSpecial=hi.config.PictureSpecial;Qr.TraceLevel=hi.config.TraceLevel;Qr.calcConfig=hi.config.calcConfig;Qr.createWorksheetFuncNameCallbacks=hi.config.createWorksheetFuncNameCallbacks;Qr.createIsThousandsPositionCallback=hi.config.createIsThousandsPositionCallback;Qr.englishErrorNames=hi.config.englishErrorNames;Qr.englishErrorTypeToName=hi.config.englishErrorTypeToName;Qr.englishOperatorIdToName=hi.config.englishOperatorIdToName;Qr.englishPictureColor=hi.config.englishPictureColor;Qr.englishPictureDbnum=hi.config.englishPictureDbnum;Qr.englishPictureSingle=hi.config.englishPictureSingle;Qr.englishPictureSpecial=hi.config.englishPictureSpecial;Qr.englishSpecialRefNames=hi.config.englishSpecialRefNames;Qr.englishSysDateFormat=hi.config.englishSysDateFormat;Qr.englishSysTimeFormat=hi.config.englishSysTimeFormat;Qr.englishWorksheetFuncIdToName=hi.config.englishWorksheetFuncIdToName;Qr.getEnglishLocaleInfo=hi.config.getEnglishLocaleInfo;Qr.getEnglishWorksheetFuncIdToName=hi.config.getEnglishWorksheetFuncIdToName;Qr.getNumberShape=hi.config.getNumberShape;Qr.getOrdinal=hi.config.getOrdinal;Qr.isNumeral=hi.config.isNumeral;Qr.isIdentStart=hi.config.isIdentStart;Qr.isIdentContinue=hi.config.isIdentContinue;Qr.localeInfo=hi.config.localeInfo;Qr.operatorIdToName=hi.config.operatorIdToName;Qr.ulsLogger=hi.config.ulsLogger});var GM=T(kc=>{"use strict";p();Object.defineProperty(kc,"__esModule",{value:!0});kc.maxRetriesForLoadingScript=kc.isCalcInit=kc.initCalcThread=kc.initCalcInThread=kc.initCalcCalled=kc.initCalc=kc.getCalcAbsUrlOrThrow=kc.getCalcAbsUrl=void 0;var Eb=pr();kc.getCalcAbsUrl=Eb.config.getCalcAbsUrl;kc.getCalcAbsUrlOrThrow=Eb.config.getCalcAbsUrlOrThrow;kc.initCalc=Eb.config.initCalc;kc.initCalcCalled=Eb.config.initCalcCalled;kc.initCalcInThread=Eb.config.initCalcInThread;kc.initCalcThread=Eb.config.initCalcThread;kc.isCalcInit=Eb.config.isCalcInit;kc.maxRetriesForLoadingScript=Eb.config.maxRetriesForLoadingScript});var Ms=T(Mc=>{"use strict";p();Object.defineProperty(Mc,"__esModule",{value:!0});Mc.setFeatureGateDictionaryGetter=Mc.overrideTypedFeatureGates=Mc.isTypedChangeGateEnabled=Mc.getTypedFeatureGate=Mc.getFeatures=Mc.isFeatureEnabled=Mc.initFeatureConfiguration=Mc.FeatureName=void 0;var IA=pr();Mc.FeatureName=IA.featureConfiguration.FeatureName;Mc.initFeatureConfiguration=IA.featureConfiguration.initFeatureConfiguration;Mc.isFeatureEnabled=IA.featureConfiguration.isFeatureEnabled;Mc.getFeatures=IA.featureConfiguration.getFeatures;Mc.getTypedFeatureGate=IA.featureConfiguration.getTypedFeatureGate;Mc.isTypedChangeGateEnabled=IA.featureConfiguration.isTypedChangeGateEnabled;var A0e=mi();Object.defineProperty(Mc,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return A0e.overrideTypedFeatureGates}});Object.defineProperty(Mc,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return A0e.setFeatureGateDictionaryGetter}})});var BM=T(Tn=>{"use strict";p();Object.defineProperty(Tn,"__esModule",{value:!0});Tn.FeatureName=Tn.getCalcAbsUrl=Tn.isCalcInit=Tn.createIsThousandsPositionCallback=Tn.createWorksheetFuncNameCallbacks=Tn.operatorIdToName=Tn.englishOperatorIdToName=Tn.englishErrorTypeToName=Tn.englishWorksheetFuncIdToName=Tn.getEnglishLocaleInfo=Tn.initCalc=Tn.calcConfig=Tn.PictureDbnum=Tn.PictureColor=Tn.PictureSingle=Tn.PictureSpecial=Tn.Country=Tn.LCID=Tn.localeInfo=Tn.ulsLogger=Tn.NulLogger=Tn.TraceLevel=Tn.LogCategory=void 0;var GQ=fe(),ec=GQ.__importStar(Gi()),BQ=GQ.__importStar(GM()),vrr=GQ.__importStar(Ms());Tn.LogCategory=ec.LogCategory;Tn.TraceLevel=ec.TraceLevel;Tn.NulLogger=ec.NulLogger;Tn.ulsLogger=ec.ulsLogger;Tn.localeInfo=ec.localeInfo;Tn.LCID=ec.LCID;Tn.Country=ec.Country;Tn.PictureSpecial=ec.PictureSpecial;Tn.PictureSingle=ec.PictureSingle;Tn.PictureColor=ec.PictureColor;Tn.PictureDbnum=ec.PictureDbnum;Tn.calcConfig=ec.calcConfig;Tn.initCalc=BQ.initCalc;Tn.getEnglishLocaleInfo=ec.getEnglishLocaleInfo;Tn.englishWorksheetFuncIdToName=ec.englishWorksheetFuncIdToName;Tn.englishErrorTypeToName=ec.englishErrorTypeToName;Tn.englishOperatorIdToName=ec.englishOperatorIdToName;Tn.operatorIdToName=ec.operatorIdToName;Tn.createWorksheetFuncNameCallbacks=ec.createWorksheetFuncNameCallbacks;Tn.createIsThousandsPositionCallback=ec.createIsThousandsPositionCallback;Tn.isCalcInit=BQ.isCalcInit;Tn.getCalcAbsUrl=BQ.getCalcAbsUrl;Tn.FeatureName=vrr.FeatureName});var N0e=T(wA=>{"use strict";p();Object.defineProperty(wA,"__esModule",{value:!0});wA.numberComponents=wA.formatScientificLeft=void 0;var F0e=qr();wA.formatScientificLeft=F0e.mathpack.formatScientificLeft;wA.numberComponents=F0e.mathpack.numberComponents});var O0e=T(EG=>{"use strict";p();Object.defineProperty(EG,"__esModule",{value:!0});EG.ieeeMathpack=void 0;var hrr=qr();EG.ieeeMathpack=hrr.mathpackIEEE.ieeeMathpack});var AG=T(PG=>{"use strict";p();Object.defineProperty(PG,"__esModule",{value:!0});PG.xlMathpack=void 0;var Srr=qr();PG.xlMathpack=Srr.mathpackXL.xlMathpack});var KQ=T(P0=>{"use strict";p();Object.defineProperty(P0,"__esModule",{value:!0});P0.formatScientificLeft=P0.xlMathpack=P0.ieeeMathpack=P0.numberComponents=void 0;var UQ=fe(),k0e=UQ.__importStar(N0e()),yrr=UQ.__importStar(O0e()),_rr=UQ.__importStar(AG());P0.numberComponents=k0e.numberComponents;P0.ieeeMathpack=yrr.ieeeMathpack;P0.xlMathpack=_rr.xlMathpack;P0.formatScientificLeft=k0e.formatScientificLeft});var UM=T(ef=>{"use strict";p();Object.defineProperty(ef,"__esModule",{value:!0});ef.xlDatepack=ef.tzUTC=ef.tzData=ef.dateTime=ef.TimeGranularity=ef.TimeDivision=ef.Rounding=void 0;var NT=qr();ef.Rounding=NT.datepack.Rounding;ef.TimeDivision=NT.datepack.TimeDivision;ef.TimeGranularity=NT.datepack.TimeGranularity;ef.dateTime=NT.datepack.dateTime;ef.tzData=NT.datepack.tzData;ef.tzUTC=NT.datepack.tzUTC;ef.xlDatepack=NT.datepack.xlDatepack});var M0e=T(rf=>{"use strict";p();Object.defineProperty(rf,"__esModule",{value:!0});rf.xlDatepack=rf.TimeGranularity=rf.dateTime=rf.tzUTC=rf.tzData=rf.Rounding=rf.TimeDivision=void 0;var brr=fe(),OT=brr.__importStar(UM());rf.TimeDivision=OT.TimeDivision;rf.Rounding=OT.Rounding;rf.tzData=OT.tzData;rf.tzUTC=OT.tzUTC;rf.dateTime=OT.dateTime;rf.TimeGranularity=OT.TimeGranularity;rf.xlDatepack=OT.xlDatepack});var kp=T(Al=>{"use strict";p();Object.defineProperty(Al,"__esModule",{value:!0});Al.assertPositiveLength=Al.assertPositiveInteger=Al.assertInteger=Al.assertIndex=Al.assertNatural=Al.assertNever=Al.assertFalse=Al.assertTrue=Al.ulsLogger=void 0;var Cy=pr();Al.ulsLogger=Cy.assertions.ulsLogger;Al.assertTrue=Cy.assertions.assertTrue;Al.assertFalse=Cy.assertions.assertFalse;Al.assertNever=Cy.assertions.assertNever;Al.assertNatural=Cy.assertions.assertNatural;Al.assertIndex=Cy.assertions.assertIndex;Al.assertInteger=Cy.assertions.assertInteger;Al.assertPositiveInteger=Cy.assertions.assertPositiveInteger;Al.assertPositiveLength=Cy.assertions.assertPositiveLength});var DA=T(tn=>{"use strict";p();Object.defineProperty(tn,"__esModule",{value:!0});tn.now=tn.mapFromArrayOfPairs=tn.singleton=tn.typedInstanceCreator=tn.makeStringCompareCI=tn.fastAbs=tn.fastMax=tn.fastMin=tn.pair=tn.filterOutNones=tn.isNone=tn.isDefined=tn.safeConcat=tn.safePush=tn.strEnumArray=tn.numEnumMap=tn.numEnumArray=tn.cloneStringMap=tn.makeStringMap=tn.identity=tn.staticAssertIsOptional=tn.staticAssertIs=tn.staticAssertSame=tn.staticAssertExtends=tn.makeNewtypeIso=void 0;var _u=pr();tn.makeNewtypeIso=_u.core.makeNewtypeIso;tn.staticAssertExtends=_u.core.staticAssertExtends;tn.staticAssertSame=_u.core.staticAssertSame;tn.staticAssertIs=_u.core.staticAssertIs;tn.staticAssertIsOptional=_u.core.staticAssertIsOptional;tn.identity=_u.core.identity;tn.makeStringMap=_u.core.makeStringMap;tn.cloneStringMap=_u.core.cloneStringMap;tn.numEnumArray=_u.core.numEnumArray;tn.numEnumMap=_u.core.numEnumMap;tn.strEnumArray=_u.core.strEnumArray;tn.safePush=_u.core.safePush;tn.safeConcat=_u.core.safeConcat;tn.isDefined=_u.core.isDefined;tn.isNone=_u.core.isNone;tn.filterOutNones=_u.core.filterOutNones;tn.pair=_u.core.pair;tn.fastMin=_u.core.fastMin;tn.fastMax=_u.core.fastMax;tn.fastAbs=_u.core.fastAbs;tn.makeStringCompareCI=_u.core.makeStringCompareCI;tn.typedInstanceCreator=_u.core.typedInstanceCreator;tn.singleton=_u.core.singleton;tn.mapFromArrayOfPairs=_u.core.mapFromArrayOfPairs;tn.now=_u.core.now});var VQ=T(Tt=>{"use strict";p();Object.defineProperty(Tt,"__esModule",{value:!0});Tt.ulsLogger=Tt.operatorIdToName=Tt.localeInfo=Tt.isNumeral=Tt.getOrdinal=Tt.getNumberShape=Tt.getEnglishWorksheetFuncIdToName=Tt.getEnglishLocaleInfo=Tt.englishWorksheetFuncIdToName=Tt.englishSysTimeFormat=Tt.englishSysDateFormat=Tt.englishSpecialRefNames=Tt.englishPictureSpecial=Tt.englishPictureSingle=Tt.englishPictureDbnum=Tt.englishPictureColor=Tt.englishOperatorIdToName=Tt.englishErrorTypeToName=Tt.englishErrorNames=Tt.createWorksheetFuncNameCallbacks=Tt.calcConfig=Tt.TraceLevel=Tt.PictureSpecial=Tt.PictureSingle=Tt.PictureDbnum=Tt.PictureColor=Tt.NulLogger=Tt.LogCategory=Tt.LCID=Tt.Country=void 0;var ro=qr();Tt.Country=ro.config.Country;Tt.LCID=ro.config.LCID;Tt.LogCategory=ro.config.LogCategory;Tt.NulLogger=ro.config.NulLogger;Tt.PictureColor=ro.config.PictureColor;Tt.PictureDbnum=ro.config.PictureDbnum;Tt.PictureSingle=ro.config.PictureSingle;Tt.PictureSpecial=ro.config.PictureSpecial;Tt.TraceLevel=ro.config.TraceLevel;Tt.calcConfig=ro.config.calcConfig;Tt.createWorksheetFuncNameCallbacks=ro.config.createWorksheetFuncNameCallbacks;Tt.englishErrorNames=ro.config.englishErrorNames;Tt.englishErrorTypeToName=ro.config.englishErrorTypeToName;Tt.englishOperatorIdToName=ro.config.englishOperatorIdToName;Tt.englishPictureColor=ro.config.englishPictureColor;Tt.englishPictureDbnum=ro.config.englishPictureDbnum;Tt.englishPictureSingle=ro.config.englishPictureSingle;Tt.englishPictureSpecial=ro.config.englishPictureSpecial;Tt.englishSpecialRefNames=ro.config.englishSpecialRefNames;Tt.englishSysDateFormat=ro.config.englishSysDateFormat;Tt.englishSysTimeFormat=ro.config.englishSysTimeFormat;Tt.englishWorksheetFuncIdToName=ro.config.englishWorksheetFuncIdToName;Tt.getEnglishLocaleInfo=ro.config.getEnglishLocaleInfo;Tt.getEnglishWorksheetFuncIdToName=ro.config.getEnglishWorksheetFuncIdToName;Tt.getNumberShape=ro.config.getNumberShape;Tt.getOrdinal=ro.config.getOrdinal;Tt.isNumeral=ro.config.isNumeral;Tt.localeInfo=ro.config.localeInfo;Tt.operatorIdToName=ro.config.operatorIdToName;Tt.ulsLogger=ro.config.ulsLogger});var Pb=T(A0=>{"use strict";p();Object.defineProperty(A0,"__esModule",{value:!0});A0.kindAnonymizers=A0.anonymizeMagnitude=A0.anonymizeFormulaString=A0.anonymize=void 0;var FG=pr();A0.anonymize=FG.anonymizer.anonymize;A0.anonymizeFormulaString=FG.anonymizer.anonymizeFormulaString;A0.anonymizeMagnitude=FG.anonymizer.anonymizeMagnitude;A0.kindAnonymizers=FG.anonymizer.kindAnonymizers});var kG=T(gd=>{"use strict";p();var Un,nn;Object.defineProperty(gd,"__esModule",{value:!0});gd.convertDiagnosticToNLMessage=gd.baseNLErrors=gd.formatDiagnostic=gd.baseErrors=gd.TypeSourceKind=gd.TypeError=gd.SyntaxError=void 0;var NG=VQ(),Crr=Pb(),Ie;(function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Unclosed_comment="Unclosed_comment",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_function_name="Invalid_function_name",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Missing_binder="Missing_binder",e.Duplicate_binder="Duplicate_binder",e.Invalid_body="Invalid_body",e.Mandatory_binder_after_optional="Mandatory_binder_after_optional",e.Missing_default_expression="Missing_default_expression",e.Binder_requires_brackets="Binder_requires_brackets",e.Invalid_field_name="Invalid_field_name",e.Missing_field_name="Missing_field_name",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Missing_struct_ref_table_name="Missing_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",e.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"})(Ie||(gd.SyntaxError=Ie={}));var tf;(function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"})(tf||(gd.TypeError=tf={}));var OG;(function(e){e.WSFArgument="WSFArgument",e.OperatorArgument="OperatorArgument"})(OG||(gd.TypeSourceKind=OG={}));gd.baseErrors=(Un={},Un[Ie.Unclosed_application]={kind:Ie.Unclosed_application},Un[Ie.Unclosed_paren]={kind:Ie.Unclosed_paren},Un[Ie.Unclosed_bracket]={kind:Ie.Unclosed_bracket},Un[Ie.Unclosed_array]={kind:Ie.Unclosed_array},Un[Ie.Unclosed_literal]={kind:Ie.Unclosed_literal},Un[Ie.Unclosed_comment]={kind:Ie.Unclosed_comment},Un[Ie.Invalid_number_literal]={kind:Ie.Invalid_number_literal},Un[Ie.Invalid_string_literal]={kind:Ie.Invalid_string_literal},Un[Ie.Invalid_error_literal]={kind:Ie.Invalid_error_literal},Un[Ie.Invalid_function_name]={kind:Ie.Invalid_function_name},Un[Ie.Invalid_name]={kind:Ie.Invalid_name},Un[Ie.Illegal_array_literal_element]={kind:Ie.Illegal_array_literal_element},Un[Ie.Empty_array_literal]={kind:Ie.Empty_array_literal},Un[Ie.Irregular_array_shape]={kind:Ie.Irregular_array_shape},Un[Ie.Empty_parenthesis]={kind:Ie.Empty_parenthesis},Un[Ie.Bad_node]={kind:Ie.Bad_node},Un[Ie.Invalid_qualifier]={kind:Ie.Invalid_qualifier},Un[Ie.Invalid_cell_ref]={kind:Ie.Invalid_cell_ref},Un[Ie.Invalid_binder]={kind:Ie.Invalid_binder},Un[Ie.Missing_binder]={kind:Ie.Missing_binder},Un[Ie.Duplicate_binder]={kind:Ie.Duplicate_binder},Un[Ie.Invalid_body]={kind:Ie.Invalid_body},Un[Ie.Mandatory_binder_after_optional]={kind:Ie.Mandatory_binder_after_optional},Un[Ie.Missing_default_expression]={kind:Ie.Missing_default_expression},Un[Ie.Binder_requires_brackets]={kind:Ie.Binder_requires_brackets},Un[Ie.Invalid_field_name]={kind:Ie.Invalid_field_name},Un[Ie.Missing_field_name]={kind:Ie.Missing_field_name},Un[Ie.Empty_formula]={kind:Ie.Empty_formula},Un[Ie.Invalid_rel_sheet_qualifier_in_cell]={kind:Ie.Invalid_rel_sheet_qualifier_in_cell},Un[Ie.Invalid_rel_sheet_qualifier_in_name]={kind:Ie.Invalid_rel_sheet_qualifier_in_name},Un[Ie.Invalid_unqualified_cell]={kind:Ie.Invalid_unqualified_cell},Un[Ie.Unexpected_closing_paren]={kind:Ie.Unexpected_closing_paren},Un[Ie.Unexpected_closing_brace]={kind:Ie.Unexpected_closing_brace},Un[Ie.Unexpected_closing_bracket]={kind:Ie.Unexpected_closing_bracket},Un[Ie.Unexpected_field_ref]={kind:Ie.Unexpected_field_ref},Un[Ie.Unexpected_dot]={kind:Ie.Unexpected_dot},Un[Ie.Invalid_struct_ref_table_name]={kind:Ie.Invalid_struct_ref_table_name},Un[Ie.Missing_struct_ref_table_name]={kind:Ie.Missing_struct_ref_table_name},Un[Ie.Invalid_struct_ref_comma_parts]={kind:Ie.Invalid_struct_ref_comma_parts},Un[Ie.Invalid_struct_ref_missing_part]={kind:Ie.Invalid_struct_ref_missing_part},Un[Ie.Invalid_struct_ref_bad_part]={kind:Ie.Invalid_struct_ref_bad_part},Un[tf.Unexpected_application_head]={kind:tf.Unexpected_application_head},Un[tf.Unexpected_application_head_with_fix]={kind:tf.Unexpected_application_head_with_fix},Un);function Trr(e){var r=e.kind,t=e.argIndex;switch(e.kind){case OG.WSFArgument:return JSON.stringify({kind:r,funcId:(0,NG.englishWorksheetFuncIdToName)(e.funcId),argIndex:t});case OG.OperatorArgument:return JSON.stringify({kind:r,opId:(0,NG.englishOperatorIdToName)(e.opId),argIndex:t})}}function Rrr(e){switch(e.kind){case tf.Insufficient_function_arguments:case tf.Excess_function_arguments:return"".concat(e.kind,": ").concat((0,NG.englishWorksheetFuncIdToName)(e.funcId));case Ie.Missing_operation_argument:case tf.Incorrect_number_of_operator_arguments:return"".concat(e.kind,": ").concat((0,NG.englishOperatorIdToName)(e.opId));case Ie.Unexpected_character:return"".concat(e.kind,": ").concat((0,Crr.anonymizeFormulaString)(e.text));case tf.Types_not_related:return"".concat(e.kind,": ").concat(Trr(e.typeSource));default:return e.kind}}gd.formatDiagnostic=Rrr;var Ab="The formulas has an error";gd.baseNLErrors=(nn={},nn[Ie.Unclosed_application]="The formula is missing a parenthesis",nn[Ie.Unclosed_paren]="The formula is missing a parenthesis",nn[Ie.Unclosed_bracket]="The formula is missing a bracket",nn[Ie.Unclosed_array]="The formula is missing a brace",nn[Ie.Unclosed_literal]="The formula is missing a quote",nn[Ie.Unclosed_comment]="The formula comment is missing an end",nn[Ie.Invalid_number_literal]="The formula has an invalid number",nn[Ie.Invalid_string_literal]="The formula has an invalid string",nn[Ie.Invalid_error_literal]="The formula has an invalid value",nn[Ie.Invalid_function_name]="The formula has an invalid function name",nn[Ie.Invalid_name]="The formula has an invalid name",nn[Ie.Illegal_array_literal_element]="The formula has an invalid value",nn[Ie.Empty_array_literal]="The formula has an empty array",nn[Ie.Irregular_array_shape]="The formula has an incorrectly shaped array",nn[Ie.Empty_parenthesis]="The formula is missing values between parentheses",nn[Ie.Missing_operation_argument]="The formula has an extra operator",nn[Ie.Bad_node]=Ab,nn[Ie.Invalid_qualifier]="The formula has an invalid sheet reference",nn[Ie.Invalid_cell_ref]="The formula has an invalid cell reference",nn[Ie.Invalid_binder]=Ab,nn[Ie.Missing_binder]=Ab,nn[Ie.Duplicate_binder]=Ab,nn[Ie.Invalid_body]=Ab,nn[Ie.Mandatory_binder_after_optional]=Ab,nn[Ie.Missing_default_expression]=Ab,nn[Ie.Binder_requires_brackets]=Ab,nn[Ie.Invalid_field_name]="The formula has an invalid field name",nn[Ie.Missing_field_name]="The formula is missing a field name",nn[Ie.Empty_formula]="The formula is empty",nn[Ie.Invalid_rel_sheet_qualifier_in_cell]="The formula has an incorrect reference",nn[Ie.Invalid_rel_sheet_qualifier_in_name]="The formula has an incorrect reference",nn[Ie.Invalid_unqualified_cell]="The formula has an incorrect reference",nn[Ie.Unexpected_closing_paren]="The formula has an extra parenthesis",nn[Ie.Unexpected_closing_brace]="The formula has an extra brace",nn[Ie.Unexpected_closing_bracket]="The formula has an extra bracket",nn[Ie.Unexpected_character]="The formula has some extra characters",nn[Ie.Unexpected_field_ref]="The formula has an extra field",nn[Ie.Unexpected_dot]="The formula has an extra dot",nn[Ie.Invalid_struct_ref_table_name]="The formula has a malformed table name in a structured reference",nn[Ie.Missing_struct_ref_table_name]="The formula is missing the table name in a structured reference",nn[Ie.Invalid_struct_ref_comma_parts]="The formula has a structured reference with commas that has issues between its brackets",nn[Ie.Invalid_struct_ref_missing_part]="The formula has a structured reference with missing references between its brackets",nn[Ie.Invalid_struct_ref_bad_part]="The formula has a bad reference in a structured reference",nn[Ie.Excess_higher_order_function_arguments]="The formula has a function call with too many arguments",nn[tf.Types_not_related]="The formula has an operation using data that cannot be mixed together",nn[tf.Unexpected_application_head]="The formula has a malformed function call",nn[tf.Unexpected_application_head_with_fix]="The formula has a malformed function call",nn[tf.Incorrect_number_of_operator_arguments]="The formula has an operation with the wrong number of arguments",nn[tf.Excess_function_arguments]="The formula has a function call with too many arguments",nn[tf.Insufficient_function_arguments]="The formula has a function call with missing arguments",nn);function Err(e){return gd.baseNLErrors[e.kind]}gd.convertDiagnosticToNLMessage=Err});var x0e=T(MG=>{"use strict";p();Object.defineProperty(MG,"__esModule",{value:!0});MG.RedBlackMapTree=void 0;var Prr=pr();MG.RedBlackMapTree=Prr.rbMapTree.RedBlackMapTree});var F0=T(we=>{"use strict";p();Object.defineProperty(we,"__esModule",{value:!0});we.isSheetGridRange=we.isSheetGridCellEqual=we.isSheetGridCell=we.isRichOper=we.isReadOperEqual=we.isRangeOper=we.isRangeOpNoMissing=we.isRangeOpClosed=we.isPrimitiveOper=we.isOperatorNode=we.isNumberOper=we.isNumberLiteralNode=we.isNameScopeEqual=we.isMissingOper=we.isMissingLiteralNode=we.isMissingNode=we.isGridRangeEqual=we.isGridCellEqual=we.isGridCell=we.isErrorOper=we.isDocumentLocEqual=we.isCommaOpRefWellFormed=we.isCommaOpNoBadOrMissing=we.isCommaOpClosed=we.isBooleanOper=we.isBooleanLiteralNode=we.isBlankOper=we.isArrayOper=we.internal=we.gridRangesJoin=we.gridRangeSize=we.gridRangeJoinOpt=we.gridRangeJoin=we.gridRangeIsects=we.gridRangeIsect=we.gridRangeExcept=we.gridRangeCompare=we.gridRangeAnchor=we.gridCellRange=we.gridCellImplicitIsect=we.getWorksheetFuncId=we.getUserDefinedFuncName=we.getBoundName=we.getArguments=we.getArgType=we.forEachTileInRange=we.forEachCellInRange=we.createFailureErrorClass=we.ReasonKind=we.LangReasonKind=void 0;we.unavailable=we.shouldFieldRefBeBracketed=we.sheetGridRangeAnchor=we.notImplemented=we.normalizeCommaOpRef=we.isWriteOper=we.isWellFormed=we.isWSFNode=we.isValidArgsLength=we.isUnqualifiedNameNode=we.isStringOper=we.isSheetIndexEqual=we.isSheetIndex=we.isSheetGridRangeEqual=void 0;var ct=qr();we.LangReasonKind=ct.util.LangReasonKind;we.ReasonKind=ct.util.ReasonKind;we.createFailureErrorClass=ct.util.createFailureErrorClass;we.forEachCellInRange=ct.util.forEachCellInRange;we.forEachTileInRange=ct.util.forEachTileInRange;we.getArgType=ct.util.getArgType;we.getArguments=ct.util.getArguments;we.getBoundName=ct.util.getBoundName;we.getUserDefinedFuncName=ct.util.getUserDefinedFuncName;we.getWorksheetFuncId=ct.util.getWorksheetFuncId;we.gridCellImplicitIsect=ct.util.gridCellImplicitIsect;we.gridCellRange=ct.util.gridCellRange;we.gridRangeAnchor=ct.util.gridRangeAnchor;we.gridRangeCompare=ct.util.gridRangeCompare;we.gridRangeExcept=ct.util.gridRangeExcept;we.gridRangeIsect=ct.util.gridRangeIsect;we.gridRangeIsects=ct.util.gridRangeIsects;we.gridRangeJoin=ct.util.gridRangeJoin;we.gridRangeJoinOpt=ct.util.gridRangeJoinOpt;we.gridRangeSize=ct.util.gridRangeSize;we.gridRangesJoin=ct.util.gridRangesJoin;we.internal=ct.util.internal;we.isArrayOper=ct.util.isArrayOper;we.isBlankOper=ct.util.isBlankOper;we.isBooleanLiteralNode=ct.util.isBooleanLiteralNode;we.isBooleanOper=ct.util.isBooleanOper;we.isCommaOpClosed=ct.util.isCommaOpClosed;we.isCommaOpNoBadOrMissing=ct.util.isCommaOpNoBadOrMissing;we.isCommaOpRefWellFormed=ct.util.isCommaOpRefWellFormed;we.isDocumentLocEqual=ct.util.isDocumentLocEqual;we.isErrorOper=ct.util.isErrorOper;we.isGridCell=ct.util.isGridCell;we.isGridCellEqual=ct.util.isGridCellEqual;we.isGridRangeEqual=ct.util.isGridRangeEqual;we.isMissingNode=ct.util.isMissingNode;we.isMissingLiteralNode=ct.util.isMissingLiteralNode;we.isMissingOper=ct.util.isMissingOper;we.isNameScopeEqual=ct.util.isNameScopeEqual;we.isNumberLiteralNode=ct.util.isNumberLiteralNode;we.isNumberOper=ct.util.isNumberOper;we.isOperatorNode=ct.util.isOperatorNode;we.isPrimitiveOper=ct.util.isPrimitiveOper;we.isRangeOpClosed=ct.util.isRangeOpClosed;we.isRangeOpNoMissing=ct.util.isRangeOpNoMissing;we.isRangeOper=ct.util.isRangeOper;we.isReadOperEqual=ct.util.isReadOperEqual;we.isRichOper=ct.util.isRichOper;we.isSheetGridCell=ct.util.isSheetGridCell;we.isSheetGridCellEqual=ct.util.isSheetGridCellEqual;we.isSheetGridRange=ct.util.isSheetGridRange;we.isSheetGridRangeEqual=ct.util.isSheetGridRangeEqual;we.isSheetIndex=ct.util.isSheetIndex;we.isSheetIndexEqual=ct.util.isSheetIndexEqual;we.isStringOper=ct.util.isStringOper;we.isUnqualifiedNameNode=ct.util.isUnqualifiedNameNode;we.isValidArgsLength=ct.util.isValidArgsLength;we.isWSFNode=ct.util.isWSFNode;we.isWellFormed=ct.util.isWellFormed;we.isWriteOper=ct.util.isWriteOper;we.normalizeCommaOpRef=ct.util.normalizeCommaOpRef;we.notImplemented=ct.util.notImplemented;we.sheetGridRangeAnchor=ct.util.sheetGridRangeAnchor;we.shouldFieldRefBeBracketed=ct.util.shouldFieldRefBeBracketed;we.unavailable=ct.util.unavailable});var dh=T(Ag=>{"use strict";p();Object.defineProperty(Ag,"__esModule",{value:!0});Ag.functionType=Ag.SpecialPrecs=Ag.SignatureType=Ag.OperKind=Ag.FunctionFlags=void 0;var KM=qr();Ag.FunctionFlags=KM.types.FunctionFlags;Ag.OperKind=KM.types.OperKind;Ag.SignatureType=KM.types.SignatureType;Ag.SpecialPrecs=KM.types.SpecialPrecs;Ag.functionType=KM.types.functionType});var nf=T(Re=>{"use strict";p();Object.defineProperty(Re,"__esModule",{value:!0});Re.localNameUseAnnotation=Re.localNameDeclAnnotation=Re.literalNode=Re.letVar=Re.letNode=Re.lambdaParam=Re.lambdaNode=Re.indexedArg=Re.identQualifier=Re.identNamePart=Re.headNamePart=Re.formulaSpan=Re.multiLineComment=Re.singleLineComment=Re.formulaRootAnnotation=Re.formula=Re.flattenNameParts=Re.flattenLetArgs=Re.flattenLambdaArgs=Re.fieldRefNode=Re.fieldRefNamePart=Re.fieldRef=Re.errorQualifier=Re.documentQualifier=Re.commaOpRef=Re.columnRef=Re.cellRefSingle=Re.cellRefRow=Re.cellRefRange=Re.cellRefNode=Re.cellRefNamePart=Re.cellRefError=Re.cellRefCol=Re.cellRefBad=Re.badRef=Re.badQualifier=Re.arrayNode=Re.appNode=Re.appHeadNameAnnotation=Re.StructRefKind=Re.SpecialRefId=Re.RefStyle=Re.QualifierKind=Re.PosKind=Re.NodeKind=Re.NamePartKind=Re.CellRefKind=Re.BadType=Re.AnnotationKind=Re.SyntaxFeature=void 0;Re.badSequenceNode=Re.badCharsNode=Re.varNode=Re.identNode=Re.missingNode=Re.getDepthUpperBound=Re.wsfNode=Re.thisRowOpRef=Re.contextNameNode=Re.structRefNode=Re.structRef=Re.specialRef=Re.sheetRangeQualifier=Re.sheetQualifier=Re.relativeQualifier=Re.rangeOpRef=Re.pos=Re.parenNode=Re.paramNode=Re.paramName=Re.paramDefault=Re.operatorNode=Re.nameNode=Re.missingRef=void 0;var Br=qr();Re.SyntaxFeature=Br.formulaModule.SyntaxFeature;Re.AnnotationKind=Br.formulaModule.AnnotationKind;Re.BadType=Br.formulaModule.BadType;Re.CellRefKind=Br.formulaModule.CellRefKind;Re.NamePartKind=Br.formulaModule.NamePartKind;Re.NodeKind=Br.formulaModule.NodeKind;Re.PosKind=Br.formulaModule.PosKind;Re.QualifierKind=Br.formulaModule.QualifierKind;Re.RefStyle=Br.formulaModule.RefStyle;Re.SpecialRefId=Br.formulaModule.SpecialRefId;Re.StructRefKind=Br.formulaModule.StructRefKind;Re.appHeadNameAnnotation=Br.formulaModule.appHeadNameAnnotation;Re.appNode=Br.formulaModule.appNode;Re.arrayNode=Br.formulaModule.arrayNode;Re.badQualifier=Br.formulaModule.badQualifier;Re.badRef=Br.formulaModule.badRef;Re.cellRefBad=Br.formulaModule.cellRefBad;Re.cellRefCol=Br.formulaModule.cellRefCol;Re.cellRefError=Br.formulaModule.cellRefError;Re.cellRefNamePart=Br.formulaModule.cellRefNamePart;Re.cellRefNode=Br.formulaModule.cellRefNode;Re.cellRefRange=Br.formulaModule.cellRefRange;Re.cellRefRow=Br.formulaModule.cellRefRow;Re.cellRefSingle=Br.formulaModule.cellRefSingle;Re.columnRef=Br.formulaModule.columnRef;Re.commaOpRef=Br.formulaModule.commaOpRef;Re.documentQualifier=Br.formulaModule.documentQualifier;Re.errorQualifier=Br.formulaModule.errorQualifier;Re.fieldRef=Br.formulaModule.fieldRef;Re.fieldRefNamePart=Br.formulaModule.fieldRefNamePart;Re.fieldRefNode=Br.formulaModule.fieldRefNode;Re.flattenLambdaArgs=Br.formulaModule.flattenLambdaArgs;Re.flattenLetArgs=Br.formulaModule.flattenLetArgs;Re.flattenNameParts=Br.formulaModule.flattenNameParts;Re.formula=Br.formulaModule.formula;Re.formulaRootAnnotation=Br.formulaModule.formulaRootAnnotation;Re.singleLineComment=Br.formulaModule.singleLineComment;Re.multiLineComment=Br.formulaModule.multiLineComment;Re.formulaSpan=Br.formulaModule.formulaSpan;Re.headNamePart=Br.formulaModule.headNamePart;Re.identNamePart=Br.formulaModule.identNamePart;Re.identQualifier=Br.formulaModule.identQualifier;Re.indexedArg=Br.formulaModule.indexedArg;Re.lambdaNode=Br.formulaModule.lambdaNode;Re.lambdaParam=Br.formulaModule.lambdaParam;Re.letNode=Br.formulaModule.letNode;Re.letVar=Br.formulaModule.letVar;Re.literalNode=Br.formulaModule.literalNode;Re.localNameDeclAnnotation=Br.formulaModule.localNameDeclAnnotation;Re.localNameUseAnnotation=Br.formulaModule.localNameUseAnnotation;Re.missingRef=Br.formulaModule.missingRef;Re.nameNode=Br.formulaModule.nameNode;Re.operatorNode=Br.formulaModule.operatorNode;Re.paramDefault=Br.formulaModule.paramDefault;Re.paramName=Br.formulaModule.paramName;Re.paramNode=Br.formulaModule.paramNode;Re.parenNode=Br.formulaModule.parenNode;Re.pos=Br.formulaModule.pos;Re.rangeOpRef=Br.formulaModule.rangeOpRef;Re.relativeQualifier=Br.formulaModule.relativeQualifier;Re.sheetQualifier=Br.formulaModule.sheetQualifier;Re.sheetRangeQualifier=Br.formulaModule.sheetRangeQualifier;Re.specialRef=Br.formulaModule.specialRef;Re.structRef=Br.formulaModule.structRef;Re.structRefNode=Br.formulaModule.structRefNode;Re.contextNameNode=Br.formulaModule.contextNameNode;Re.thisRowOpRef=Br.formulaModule.thisRowOpRef;Re.wsfNode=Br.formulaModule.wsfNode;Re.getDepthUpperBound=Br.formulaModule.getDepthUpperBound;Re.missingNode=Br.formulaModule.missingNode;Re.identNode=Br.formulaModule.identNode;Re.varNode=Br.formulaModule.varNode;Re.badCharsNode=Br.formulaModule.badCharsNode;Re.badSequenceNode=Br.formulaModule.badSequenceNode});var fh=T(Rn=>{"use strict";p();Object.defineProperty(Rn,"__esModule",{value:!0});Rn.valueErrorOper=Rn.trueOper=Rn.stringOper=Rn.refErrorOper=Rn.rangeSeqOper=Rn.range3DOper=Rn.precedents=Rn.numErrorOper=Rn.nullErrorOper=Rn.nameErrorOper=Rn.naErrorOper=Rn.missingOper=Rn.gettingDataErrorOper=Rn.fieldErrorOper=Rn.falseOper=Rn.errorOper=Rn.div0ErrorOper=Rn.cellStringLimit=Rn.booleanOper=Rn.blankOper=Rn.arrayOper=Rn.PrecsBound=Rn.ErrorType=void 0;var ls=qr();Rn.ErrorType=ls.value.ErrorType;Rn.PrecsBound=ls.value.PrecsBound;Rn.arrayOper=ls.value.arrayOper;Rn.blankOper=ls.value.blankOper;Rn.booleanOper=ls.value.booleanOper;Rn.cellStringLimit=ls.value.cellStringLimit;Rn.div0ErrorOper=ls.value.div0ErrorOper;Rn.errorOper=ls.value.errorOper;Rn.falseOper=ls.value.falseOper;Rn.fieldErrorOper=ls.value.fieldErrorOper;Rn.gettingDataErrorOper=ls.value.gettingDataErrorOper;Rn.missingOper=ls.value.missingOper;Rn.naErrorOper=ls.value.naErrorOper;Rn.nameErrorOper=ls.value.nameErrorOper;Rn.nullErrorOper=ls.value.nullErrorOper;Rn.numErrorOper=ls.value.numErrorOper;Rn.precedents=ls.value.precedents;Rn.range3DOper=ls.value.range3DOper;Rn.rangeSeqOper=ls.value.rangeSeqOper;Rn.refErrorOper=ls.value.refErrorOper;Rn.stringOper=ls.value.stringOper;Rn.trueOper=ls.value.trueOper;Rn.valueErrorOper=ls.value.valueErrorOper});var Nb=T(xc=>{"use strict";p();Object.defineProperty(xc,"__esModule",{value:!0});xc.unknownFunctionType=xc.operatorStrings=xc.higherOrderFunctionType=xc.getWorksheetFuncType=xc.getWorksheetFuncEnglishName=xc.getOperatorType=xc.WorksheetFuncId=xc.OperatorId=void 0;var Fb=qr();xc.OperatorId=Fb.signature.OperatorId;xc.WorksheetFuncId=Fb.signature.WorksheetFuncId;xc.getOperatorType=Fb.signature.getOperatorType;xc.getWorksheetFuncEnglishName=Fb.signature.getWorksheetFuncEnglishName;xc.getWorksheetFuncType=Fb.signature.getWorksheetFuncType;xc.higherOrderFunctionType=Fb.signature.higherOrderFunctionType;xc.operatorStrings=Fb.signature.operatorStrings;xc.unknownFunctionType=Fb.signature.unknownFunctionType});var hm=T(af=>{"use strict";p();Object.defineProperty(af,"__esModule",{value:!0});af.successUndefined=af.success=af.javaScriptError=af.isSuccess=af.failure=af.ResultKind=af.ReasonKind=void 0;var kT=pr();af.ReasonKind=kT.result.ReasonKind;af.ResultKind=kT.result.ResultKind;af.failure=kT.result.failure;af.isSuccess=kT.result.isSuccess;af.javaScriptError=kT.result.javaScriptError;af.success=kT.result.success;af.successUndefined=kT.result.successUndefined});var VM=T(dt=>{"use strict";p();Object.defineProperty(dt,"__esModule",{value:!0});dt.userDefinedFuncLoc=dt.unsafeGridRange=dt.structRefColumnLoc=dt.sheetRows=dt.sheetRangeIndexes=dt.sheetRange=dt.sheetIndex=dt.sheetGridRange=dt.sheetGridCube=dt.sheetGridCell=dt.sheetCols=dt.originCell=dt.nameScope=dt.nameLoc=dt.lexicalSourceUDF=dt.lexicalSourceWSF=dt.lexicalSourceRange=dt.lexicalSourceName=dt.lexicalSourceGrid=dt.lexicalSourceCell=dt.isSheetIndex=dt.isSheetGridRange=dt.isSheetGridCell=dt.isGridCell=dt.gridRange=dt.gridCell=dt.documentScope=dt.documentLoc=dt.allSheetsRange=dt.NameSource=dt.LexicalKind=void 0;var Bi=qr();dt.LexicalKind=Bi.location.LexicalKind;dt.NameSource=Bi.location.NameSource;dt.allSheetsRange=Bi.location.allSheetsRange;dt.documentLoc=Bi.location.documentLoc;dt.documentScope=Bi.location.documentScope;dt.gridCell=Bi.location.gridCell;dt.gridRange=Bi.location.gridRange;dt.isGridCell=Bi.location.isGridCell;dt.isSheetGridCell=Bi.location.isSheetGridCell;dt.isSheetGridRange=Bi.location.isSheetGridRange;dt.isSheetIndex=Bi.location.isSheetIndex;dt.lexicalSourceCell=Bi.location.lexicalSourceCell;dt.lexicalSourceGrid=Bi.location.lexicalSourceGrid;dt.lexicalSourceName=Bi.location.lexicalSourceName;dt.lexicalSourceRange=Bi.location.lexicalSourceRange;dt.lexicalSourceWSF=Bi.location.lexicalSourceWSF;dt.lexicalSourceUDF=Bi.location.lexicalSourceUDF;dt.nameLoc=Bi.location.nameLoc;dt.nameScope=Bi.location.nameScope;dt.originCell=Bi.location.originCell;dt.sheetCols=Bi.location.sheetCols;dt.sheetGridCell=Bi.location.sheetGridCell;dt.sheetGridCube=Bi.location.sheetGridCube;dt.sheetGridRange=Bi.location.sheetGridRange;dt.sheetIndex=Bi.location.sheetIndex;dt.sheetRange=Bi.location.sheetRange;dt.sheetRangeIndexes=Bi.location.sheetRangeIndexes;dt.sheetRows=Bi.location.sheetRows;dt.structRefColumnLoc=Bi.location.structRefColumnLoc;dt.unsafeGridRange=Bi.location.unsafeGridRange;dt.userDefinedFuncLoc=Bi.location.userDefinedFuncLoc});var I0e=T(xG=>{"use strict";p();Object.defineProperty(xG,"__esModule",{value:!0});xG.Pledge=void 0;var Arr=pr();xG.Pledge=Arr.pledge.Pledge});var IG=T(Fg=>{"use strict";p();Object.defineProperty(Fg,"__esModule",{value:!0});Fg.canDenoteCellRef=Fg.canDenoteUserDefinedFunc=Fg.canDenoteLocalName=Fg.resolveGridRef=Fg.createResolver=void 0;var jM=qr();Fg.createResolver=jM.resolveService.createResolver;Fg.resolveGridRef=jM.resolveService.resolveGridRef;Fg.canDenoteLocalName=jM.resolveService.canDenoteLocalName;Fg.canDenoteUserDefinedFunc=jM.resolveService.canDenoteUserDefinedFunc;Fg.canDenoteCellRef=jM.resolveService.canDenoteCellRef});var WM=T(Ic=>{"use strict";p();Object.defineProperty(Ic,"__esModule",{value:!0});Ic.setFeatureGateDictionaryGetter=Ic.overrideTypedFeatureGates=Ic.isTypedChangeGateEnabled=Ic.getTypedFeatureGate=Ic.getFeatures=Ic.isFeatureEnabled=Ic.initFeatureConfiguration=Ic.FeatureName=void 0;var LA=pr();Ic.FeatureName=LA.featureConfiguration.FeatureName;Ic.initFeatureConfiguration=LA.featureConfiguration.initFeatureConfiguration;Ic.isFeatureEnabled=LA.featureConfiguration.isFeatureEnabled;Ic.getFeatures=LA.featureConfiguration.getFeatures;Ic.getTypedFeatureGate=LA.featureConfiguration.getTypedFeatureGate;Ic.isTypedChangeGateEnabled=LA.featureConfiguration.isTypedChangeGateEnabled;var w0e=mi();Object.defineProperty(Ic,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return w0e.overrideTypedFeatureGates}});Object.defineProperty(Ic,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return w0e.setFeatureGateDictionaryGetter}})});var HQ=T(GA=>{"use strict";p();Object.defineProperty(GA,"__esModule",{value:!0});GA.checkFormula=GA.checkFormulaWithDiagnostics=void 0;var Ob=fe(),MT=kp(),LG=DA(),wr=kG(),D0e=x0e(),wc=F0(),Ia=dh(),Ur=nf(),wG=fh(),Ng=Nb(),qA=hm(),q0e=VM(),Fl=I0e(),jQ=IG(),Frr=WM(),WQ={};function xs(e,r){return{context:e,result:r}}function Nrr(e){return function(r){return r.kind===Ur.NodeKind.Literal&&e(r.oper)}}var Orr=Ia.OperKind.String|Ia.OperKind.Boolean|Ia.OperKind.Error,krr=Nrr(function(e){return(e.kind&Orr)!==0});function Mrr(e){return e>wG.ErrorType.GETTING_DATA&&e!==wG.ErrorType.BUSY&&e!==wG.ErrorType.EXTERNAL}function et(e,r,t,n){n===void 0&&(n=!1),n||(e.errorData=e.reportError(r,t,e.errorData))}function G0e(e,r){return r===Ia.OperKind.Range?(e&Ia.OperKind.Range)!==0:!0}function xrr(e,r){return Fl.Pledge.try(function(){var t;if(r.kind===Ur.NodeKind.BadSequence){switch(r.type){case Ur.BadType.Unexpected:et(e,r,wr.baseErrors.Bad_node,r.contents.some(function(n){return n.kind===Ur.NodeKind.BadChars||n.kind===Ur.NodeKind.BadSequence}));break;case Ur.BadType.StructRef:et(e,(t=r.contents[0])!==null&&t!==void 0?t:r,wr.baseErrors.Invalid_struct_ref_table_name);break;case Ur.BadType.FieldRef:et(e,r,wr.baseErrors.Unexpected_field_ref);return}return Fl.Pledge.all(r.contents.map(function(n){return Ty(e,n)}))}switch(r.type){case Ur.BadType.Unexpected:switch(r.chars){case")":return et(e,r,wr.baseErrors.Unexpected_closing_paren);case e.localeInfo.rightBrace:return et(e,r,wr.baseErrors.Unexpected_closing_brace);case e.localeInfo.rightBracket:return et(e,r,wr.baseErrors.Unexpected_closing_bracket);case".":return et(e,r,wr.baseErrors.Unexpected_dot);default:return et(e,r,{kind:wr.SyntaxError.Unexpected_character,text:r.chars})}case Ur.BadType.NumberLiteral:return et(e,r,wr.baseErrors.Invalid_number_literal);case Ur.BadType.StringLiteral:return et(e,r,wr.baseErrors.Invalid_string_literal);case Ur.BadType.ErrorLiteral:return et(e,r,wr.baseErrors.Invalid_error_literal);case Ur.BadType.FieldName:case Ur.BadType.ParamName:return et(e,r,wr.baseErrors.Bad_node);case Ur.BadType.Qualifier:return et(e,r,wr.baseErrors.Invalid_qualifier);default:(0,MT.assertNever)("calc.analyze.diagnoseBadNode",r)}})}function Irr(e,r){if(r.kind===Ur.NodeKind.Literal)switch(et(e,r,wr.baseErrors.Unclosed_literal,r.isClosed),r.oper.kind){case Ia.OperKind.Number:case Ia.OperKind.Boolean:case Ia.OperKind.String:case Ia.OperKind.Error:return;case Ia.OperKind.Missing:break;default:return(0,MT.assertNever)("calc.analyze.checker.checkArrayElement: literal kind",r.oper)}et(e,r,wr.baseErrors.Illegal_array_literal_element)}function wrr(e,r){return Fl.Pledge.try(function(){et(e,r,wr.baseErrors.Unclosed_array,r.isClosed);var t=r.nodes.length>0&&!(r.nodes.length===1&&r.nodes[0].length===1&&(0,wc.isMissingNode)(r.nodes[0][0]));if(et(e,r,wr.baseErrors.Empty_array_literal,t),!t)return xs(e,Ia.OperKind.Array);for(var n=r.nodes[0].length,a=0;a<r.nodes.length;a+=1){var o=r.nodes[a],u=o.length;et(e,r,wr.baseErrors.Irregular_array_shape,u===n);for(var s=0;s<u;s+=1)Irr(e,o[s])}return xs(e,Ia.OperKind.Array)})}function qG(e,r,t,n,a){return Fl.Pledge.try(function(){if(e.earlyExit&&!e.isOk())throw WQ;return Ty(e,r,a)}).bind(function(o){return G0e(o.result,t)||((0,MT.assertTrue)("calc.analyze.checker.check: typeSource passed",n!==void 0),et(e,r,{kind:wr.TypeError.Types_not_related,typeGiven:o.result,typeExpected:t,typeSource:n})),o.result=t,o})}function Drr(e,r){return Fl.Pledge.try(function(){var t=r.head,n=r.args,a=t.id,o=(0,Ng.getOperatorType)(a),u=n.length,s=u===o.minArgs;return et(e,t,{kind:wr.TypeError.Incorrect_number_of_operator_arguments,opId:a},s),Fl.Pledge.all(n.map(function(l,c){return Fl.Pledge.try(function(){return qG(e,l,(0,wc.getArgType)(o,c,u),{kind:wr.TypeSourceKind.OperatorArgument,opId:a,argIndex:c,numArgsGiven:u},{kind:wr.SyntaxError.Missing_operation_argument,opId:a})})})).bind(function(l){return s&&!n.some(wc.isMissingNode)?xs(e,o.returnType):xs(e,Ia.SignatureType.All)})})}function L0e(e,r,t){if(t.kind===Ur.NodeKind.Ident){var n=(0,wc.getBoundName)(e.localeInfo,t.whole);return et(e,t,wr.baseErrors.Invalid_binder,n.indexOf(".")<0),et(e,t,wr.baseErrors.Duplicate_binder,!r.contains(n)),r.setValue(n,!0)}return et(e,t,t.kind===Ur.NodeKind.Missing?wr.baseErrors.Missing_binder:wr.baseErrors.Invalid_binder),r}function Lrr(e,r){var t=r.head.id,n=(0,wc.getArguments)(r.args).length;switch(t){case Ng.WorksheetFuncId.IF:var a=e.locals.lexicalKind===q0e.LexicalKind.NameManager?1:2;n<a&&et(e,DG(r),{kind:wr.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:a});return;case Ng.WorksheetFuncId._UDF:return et(e,r,wr.baseErrors.Unexpected_application_head);case Ng.WorksheetFuncId.LET:case Ng.WorksheetFuncId.LETREC:{(0,MT.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===Ur.NodeKind.Let);for(var o=D0e.RedBlackMapTree.create(e.localeInfo.stringCompareCI),u=0,s=r.vars;u<s.length;u++){var l=s[u].name;o=L0e(e,o,l.arg.name)}for(var c=0,d=r.badArgs;c<d.length;c++){var f=d[c];et(e,f.arg,wr.baseErrors.Invalid_binder)}et(e,DG(r),{kind:wr.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:(0,LG.fastMax)(3,n+1+n%2)},n>=3&&r.body!==void 0);break}case Ng.WorksheetFuncId.LAMBDA:{(0,MT.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===Ur.NodeKind.Lambda);for(var o=D0e.RedBlackMapTree.create(e.localeInfo.stringCompareCI),m=!1,v=0,h=r.params;v<h.length;v++){var y=h[v].name;et(e,y.arg.name,wr.baseErrors.Unclosed_bracket,y.arg.name.isClosed),y.arg.def!==void 0&&et(e,y.arg.name,wr.baseErrors.Binder_requires_brackets,y.arg.name.isBracketed),y.arg.isOptional?m=!0:et(e,y.arg,wr.baseErrors.Mandatory_binder_after_optional,!m),o=L0e(e,o,y.arg.name.name)}for(var _=0,E=r.badArgs;_<E.length;_++){var f=E[_];et(e,f.arg,wr.baseErrors.Invalid_binder)}var N=n>=1&&r.body!==void 0;N?r.body!==void 0&&(0,wc.isMissingLiteralNode)(r.body.arg)&&et(e,r.body.arg,wr.baseErrors.Invalid_body):et(e,DG(r),{kind:wr.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:n+1});break}}}var DG=function(r){return r.args.length===0?r:r.args[r.args.length-1]};function qrr(e,r){return Fl.Pledge.try(function(){var t=r.head.id,n=(0,Ng.getWorksheetFuncType)(t),a=n.minArgs,o=n.maxArgs,u=n.headTypes,s=n.restTypes,l=n.tailTypes,c=n.flags,d=r.args,f=d.length,m=(0,wc.getArguments)(r.args),v=m.length;if(et(e,r.head,wr.baseErrors.Invalid_function_name,(c&Ia.FunctionFlags.OnlyParsedDuringLoad)===0||e.locals.workbookLoad),(0,Frr.isTypedChangeGateEnabled)("Microsoft.Office.Excel.CalcTsInvalidChartMacro")&&et(e,r.head,wr.baseErrors.Invalid_function_name,(c&Ia.FunctionFlags.Chart)===0&&((c&Ia.FunctionFlags.Macro)===0||e.locals.lexicalKind===q0e.LexicalKind.NameManager)),v<a)switch(t){case Ng.WorksheetFuncId.IF:case Ng.WorksheetFuncId.LET:case Ng.WorksheetFuncId.LETREC:case Ng.WorksheetFuncId.LAMBDA:break;default:var h=d[f-1];et(e,h===void 0?r:h,{kind:wr.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:v,numArgsExpected:a});break}if(v>o){var y=d[f-1];et(e,y===void 0?r:y,{kind:wr.TypeError.Excess_function_arguments,funcId:t,numArgsGiven:v,numArgsExpected:o})}else if(s.length>1&&v>u.length+s.length){var _=(v-u.length)%s.length;_>l.length&&et(e,DG(r),{kind:wr.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:v,numArgsExpected:v+(s.length-_)})}var E;if(r.kind===Ur.NodeKind.App)E=(0,wc.getArguments)(r.args).map(function(V,I){return qG(e,V,(0,wc.getArgType)(n,I,v),{kind:wr.TypeSourceKind.WSFArgument,funcId:t,argIndex:I,numArgsGiven:v})});else if(r.kind===Ur.NodeKind.Let){var N=r.vars.map(function(V){var I=V.binder;return I.arg}),k=r.body?[r.body.arg]:[];E=Ob.__spreadArray(Ob.__spreadArray([],N,!0),k,!0).map(function(V){return Ty(e,V)})}else{var q=r.params.map(function(I){var M,B=I.name;return(M=B.arg.def)===null||M===void 0?void 0:M.rhs}).filter(LG.isDefined),k=r.body?[r.body.arg]:[];E=Ob.__spreadArray(Ob.__spreadArray([],q.map(function(I){return Ty(e,I,wr.baseErrors.Missing_default_expression)}),!0),k.map(function(I){return Ty(e,I)}),!0)}return Fl.Pledge.all(E).bind(function(V){return Lrr(e,r),xs(e,n.returnType)})})}function Grr(e,r){return Fl.Pledge.try(function(){var t=r.head,n=r.args,a=n.length,o=(0,wc.getArguments)(n),u=o.length,s=n[a-1],l=(0,Ng.higherOrderFunctionType)().maxArgs-1;return u>l&&et(e,s===void 0?r:s,{kind:wr.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:u,numArgsExpected:l}),Fl.Pledge.all(n.map(function(c){return qG(e,c,Ia.SignatureType.All,void 0)})).bind(function(c){return Ty(e,t).bind(function(d){return G0e(d.result,Ia.OperKind.Range)||d.result&(Ia.OperKind.Array|Ia.OperKind.Rich)||et(e,t,krr(t)||t.kind===Ur.NodeKind.Array?wr.baseErrors.Unexpected_application_head:wr.baseErrors.Unexpected_application_head_with_fix),xs(e,Ia.SignatureType.All)})})})}function Brr(e,r){return Fl.Pledge.try(function(){if(et(e,r,wr.baseErrors.Unclosed_application,r.isClosed),(0,wc.isWSFNode)(r.head)){var t=r;return qrr(e,t)}if((0,wc.isOperatorNode)(r.head)){var n=r;return Drr(e,n)}var a=r;return Grr(e,a)})}function Ty(e,r,t,n){return n===void 0&&(n=!1),Fl.Pledge.try(function(){var a,o,u;if(e.earlyExit&&!e.isOk())throw WQ;switch(r.kind){case Ur.NodeKind.App:case Ur.NodeKind.Let:case Ur.NodeKind.Lambda:return Brr(e,r);case Ur.NodeKind.Array:return wrr(e,r);case Ur.NodeKind.BadChars:case Ur.NodeKind.BadSequence:return xrr(e,r).bind(function(){return xs(e,Ia.SignatureType.All)});case Ur.NodeKind.Missing:return t!==!1&&et(e,r,t??wr.baseErrors.Bad_node),xs(e,Ia.SignatureType.All);case Ur.NodeKind.CellRef:return!e.locals.allowRelativeQualifier&&((a=r.qualifier)===null||a===void 0?void 0:a.kind)===Ur.QualifierKind.Relative?(et(e,r,wr.baseErrors.Invalid_rel_sheet_qualifier_in_cell),xs(e,Ia.SignatureType.All)):!e.locals.allowUnqualifiedCell&&r.qualifier===void 0?(et(e,r,wr.baseErrors.Invalid_unqualified_cell),xs(e,Ia.SignatureType.All)):((o=r.qualifier)===null||o===void 0?void 0:o.kind)===Ur.QualifierKind.Document||((u=r.qualifier)===null||u===void 0?void 0:u.kind)===Ur.QualifierKind.Bad?(et(e,r,wr.baseErrors.Invalid_qualifier),xs(e,Ia.SignatureType.All)):r.ref.kind===Ur.CellRefKind.Bad?(et(e,r,wr.baseErrors.Invalid_cell_ref),xs(e,Ia.SignatureType.All)):xs(e,Ia.OperKind.Range);case Ur.NodeKind.Literal:return et(e,r,wr.baseErrors.Unclosed_literal,r.isClosed),(0,wc.isErrorOper)(r.oper)&&et(e,r,wr.baseErrors.Invalid_error_literal,!Mrr(r.oper.type)),xs(e,r.oper.kind|((0,wc.isErrorOper)(r.oper)&&r.oper.type===wG.ErrorType.REF?Ia.OperKind.Range:0));case Ur.NodeKind.Name:{var s=r.qualifier;if((n||!e.locals.allowRelativeQualifier)&&(s==null?void 0:s.kind)===Ur.QualifierKind.Relative)return et(e,r,wr.baseErrors.Invalid_rel_sheet_qualifier_in_name),xs(e,Ia.SignatureType.All);if(!e.locals.workbookLoad&&(s==null?void 0:s.kind)===Ur.QualifierKind.Document&&!s.isQuoted||(s==null?void 0:s.kind)===Ur.QualifierKind.SheetRange||(s==null?void 0:s.kind)===Ur.QualifierKind.Bad)return et(e,r,wr.baseErrors.Invalid_qualifier),xs(e,Ia.SignatureType.All);var l=(0,Ur.flattenNameParts)(r.parts).parts,c=e.annotations[l[0].label],d=e.annotations[r.label],f=(d==null?void 0:d.kind)===Ur.AnnotationKind.AppHeadName;return(c==null?void 0:c.kind)===Ur.AnnotationKind.LocalNameUse?et(e,r,wr.baseErrors.Invalid_name,(0,jQ.canDenoteLocalName)(s,l)):et(e,r,n?wr.baseErrors.Invalid_struct_ref_table_name:wr.baseErrors.Invalid_name,r.parts.canDenoteNamedObject||(0,jQ.canDenoteUserDefinedFunc)(f,s,r.parts)||(0,jQ.canDenoteCellRef)(e.locals,s,l)),xs(e,Ia.SignatureType.All)}case Ur.NodeKind.Paren:return et(e,r,wr.baseErrors.Unclosed_paren,r.isClosed),et(e,r,wr.baseErrors.Empty_parenthesis,!(0,wc.isMissingNode)(r.node)),Ty(e,r.node,!1);case Ur.NodeKind.FieldRef:return et(e,r,wr.baseErrors.Unclosed_bracket,r.rhs.isClosed),et(e,r,wr.baseErrors.Unexpected_field_ref,!(0,wc.isMissingNode)(r.lhs)&&!(0,wc.isNumberLiteralNode)(r.lhs)),r.rhs.field.kind!==Ur.NodeKind.Ident&&et(e,r.rhs.field,r.rhs.field.kind===Ur.NodeKind.Missing?wr.baseErrors.Missing_field_name:wr.baseErrors.Invalid_field_name),Ty(e,r.lhs,!1).bind(function(v){return xs(e,Ia.SignatureType.All)});case Ur.NodeKind.StructRef:if(et(e,r,wr.baseErrors.Missing_struct_ref_table_name,r.lhs!==void 0||e.locals.allowImplicitTable),r.rhs.innerRef!==void 0){var m=function v(h){switch(h==null?void 0:h.kind){case void 0:break;case Ur.StructRefKind.RangeOpRef:v(h.lhs),v(h.rhs);break;case Ur.StructRefKind.CommaOpRef:et(e,h,wr.baseErrors.Invalid_struct_ref_comma_parts,(0,wc.isCommaOpRefWellFormed)(h)),h.refs.forEach(v);break;case Ur.StructRefKind.SpecialRef:case Ur.StructRefKind.ColumnRef:et(e,h,wr.baseErrors.Unclosed_bracket,h.isClosed);break;case Ur.StructRefKind.ThisRowOpRef:v(h.ref);break;case Ur.StructRefKind.MissingRef:et(e,h,wr.baseErrors.Invalid_struct_ref_missing_part);break;case Ur.StructRefKind.BadRef:et(e,h,wr.baseErrors.Unclosed_bracket,h.isClosed),et(e,h,wr.baseErrors.Invalid_struct_ref_bad_part);break}};m(r.rhs.innerRef)}return et(e,r,wr.baseErrors.Unclosed_bracket,r.rhs.isClosed),(r.lhs===void 0?Fl.Pledge.resolve(void 0):Ty(e,r.lhs,void 0,!0)).bind(function(v){return xs(e,Ia.SignatureType.All)});default:return(0,MT.assertNever)("calc.analyze.checker.infer: unhandled formula case",r)}})}function Urr(e,r){var t=r.annotations[r.node.label];if((t==null?void 0:t.kind)!==Ur.AnnotationKind.FormulaRoot||t.syntaxFeatures===void 0||!t.syntaxFeatures[Ur.SyntaxFeature.Comments])return;function n(u){for(var s=0,l=u;s<l.length;s++){var c=l[s];et(e,c,wr.baseErrors.Unclosed_comment,c.isClosed)}}function a(u){var s=r.spans[u];s!=null&&(s.preComments&&n(s.preComments),s.postComments&&n(s.postComments))}function o(u){return Fl.Pledge.try(function(){switch(a(u.label),u.kind){case Ur.NodeKind.Literal:case Ur.NodeKind.Missing:case Ur.NodeKind.BadChars:break;case Ur.NodeKind.App:case Ur.NodeKind.Let:case Ur.NodeKind.Lambda:return u.head.kind===Ur.NodeKind.Operator&&a(u.head.label),Fl.Pledge.all(u.args.map(o));case Ur.NodeKind.Array:return Fl.Pledge.all((0,LG.safeConcat)([],u.nodes.map(function(s){return s.map(o)})));case Ur.NodeKind.BadSequence:return Fl.Pledge.all(u.contents.map(o));case Ur.NodeKind.CellRef:case Ur.NodeKind.Name:u.qualifier&&a(u.qualifier.label);break;case Ur.NodeKind.Paren:return o(u.node);case Ur.NodeKind.FieldRef:return a(u.rhs.label),a(u.rhs.field.label),o(u.lhs);case Ur.NodeKind.StructRef:return u.lhs?o(u.lhs):void 0;case Ur.NodeKind.Var:a(u.name.label);break;case Ur.NodeKind.Param:if(a(u.name.label),a(u.name.name.label),u.def)return a(u.def.label),o(u.def.rhs);break;default:return(0,MT.assertNever)("calc.analyze.checker.comments",u)}})}Fl.Pledge.settleOrThrow(o(r.node))}var Krr={ok:!0,isOk:LG.identity,collect:function(r,t,n){return!1}};function Vrr(){return{ok:void 0,isOk:function(r){return r===void 0},collect:function(r,t,n){var a,o=n??[];return((a=o[r.label])!==null&&a!==void 0?a:o[r.label]=[]).push(t),o}}}function B0e(e,r,t,n,a){var o,u,s=t.annotations;a===void 0&&(a=!0);var l={globals:e,locals:r,localeInfo:(u=(o=r.config)===null||o===void 0?void 0:o.localeInfo)!==null&&u!==void 0?u:e.config.localeInfo,annotations:s,reportError:n.collect,isOk:function(){return n.isOk(l.errorData)},earlyExit:a,errorData:n.ok};return l}function U0e(e,r){try{var t=Fl.Pledge.settleOrThrow(qG(e,r.node,Ia.SignatureType.All,void 0,wr.baseErrors.Empty_formula));return Urr(e,r),t}catch(n){if(n===WQ)return xs(e,Ia.SignatureType.All);throw n}}function jrr(e,r,t){try{var n=Vrr(),a=B0e(e,r,t,n,!1),o=U0e(a,t),u=o.context.errorData;return(0,qA.success)([Ob.__assign(Ob.__assign({},t),{isWellFormed:u===void 0}),u])}catch(s){return(0,qA.failure)((0,qA.javaScriptError)(s))}}GA.checkFormulaWithDiagnostics=jrr;function Wrr(e,r,t){try{var n=B0e(e,r,t,Krr),a=U0e(n,t),o=a.context.errorData;return(0,qA.success)(Ob.__assign(Ob.__assign({},t),{isWellFormed:o}))}catch(u){return(0,qA.failure)((0,qA.javaScriptError)(u))}}GA.checkFormula=Wrr});var GG=T(It=>{"use strict";p();Object.defineProperty(It,"__esModule",{value:!0});It.zipVisitor=It.voidVisitor=It.visitWSFNode=It.visitQualifier=It.visitOperatorNode=It.visitFormulaNode=It.visitCellRef=It.visitAppHeadNode=It.reduceTopDown_Pledge=It.reducePledge=It.reduceBottomUp_Recursive=It.reduceBottomUp_Pledge=It.reduceBottomUp_MaxDepth=It.reduceBottomUp_CPS=It.reduceBottomUp=It.identityVisitor=It.depthVisitor=It.constVisitor=It.composeVisitor=It.bindVisitor=It.binaryVisitor=It.ZipVisitor=It.PledgeReducer=It.IdentityVisitor=It.DelegatingVisitor=It.ConstVisitor=It.ComposeVisitor=It.BinaryVisitor=void 0;var ko=qr();It.BinaryVisitor=ko.visitor.BinaryVisitor;It.ComposeVisitor=ko.visitor.ComposeVisitor;It.ConstVisitor=ko.visitor.ConstVisitor;It.DelegatingVisitor=ko.visitor.DelegatingVisitor;It.IdentityVisitor=ko.visitor.IdentityVisitor;It.PledgeReducer=ko.visitor.PledgeReducer;It.ZipVisitor=ko.visitor.ZipVisitor;It.binaryVisitor=ko.visitor.binaryVisitor;It.bindVisitor=ko.visitor.bindVisitor;It.composeVisitor=ko.visitor.composeVisitor;It.constVisitor=ko.visitor.constVisitor;It.depthVisitor=ko.visitor.depthVisitor;It.identityVisitor=ko.visitor.identityVisitor;It.reduceBottomUp=ko.visitor.reduceBottomUp;It.reduceBottomUp_CPS=ko.visitor.reduceBottomUp_CPS;It.reduceBottomUp_MaxDepth=ko.visitor.reduceBottomUp_MaxDepth;It.reduceBottomUp_Pledge=ko.visitor.reduceBottomUp_Pledge;It.reduceBottomUp_Recursive=ko.visitor.reduceBottomUp_Recursive;It.reducePledge=ko.visitor.reducePledge;It.reduceTopDown_Pledge=ko.visitor.reduceTopDown_Pledge;It.visitAppHeadNode=ko.visitor.visitAppHeadNode;It.visitCellRef=ko.visitor.visitCellRef;It.visitFormulaNode=ko.visitor.visitFormulaNode;It.visitOperatorNode=ko.visitor.visitOperatorNode;It.visitQualifier=ko.visitor.visitQualifier;It.visitWSFNode=ko.visitor.visitWSFNode;It.voidVisitor=ko.visitor.voidVisitor;It.zipVisitor=ko.visitor.zipVisitor});var zQ=T(wa=>{"use strict";p();Object.defineProperty(wa,"__esModule",{value:!0});wa.resolvedUserDefinedFunc=wa.resolvedStructRef=wa.resolvedNever=wa.resolvedName=wa.resolvedLocalName=wa.resolvedDottedName=wa.resolvedCellRef=wa.resolveLocalsGrid=wa.noOriginSheet=wa.invalidStructRef=wa.invalidQualifier=wa.invalidCellRef=wa.emptyIntersection=wa.ResolvedKind=wa.ResolveReasonKind=wa.InvalidStructRefReason=wa.InvalidQualifierReason=wa.InvalidCellRefReason=void 0;var Dc=qr();wa.InvalidCellRefReason=Dc.resolveServiceTypes.InvalidCellRefReason;wa.InvalidQualifierReason=Dc.resolveServiceTypes.InvalidQualifierReason;wa.InvalidStructRefReason=Dc.resolveServiceTypes.InvalidStructRefReason;wa.ResolveReasonKind=Dc.resolveServiceTypes.ResolveReasonKind;wa.ResolvedKind=Dc.resolveServiceTypes.ResolvedKind;wa.emptyIntersection=Dc.resolveServiceTypes.emptyIntersection;wa.invalidCellRef=Dc.resolveServiceTypes.invalidCellRef;wa.invalidQualifier=Dc.resolveServiceTypes.invalidQualifier;wa.invalidStructRef=Dc.resolveServiceTypes.invalidStructRef;wa.noOriginSheet=Dc.resolveServiceTypes.noOriginSheet;wa.resolveLocalsGrid=Dc.resolveServiceTypes.resolveLocalsGrid;wa.resolvedCellRef=Dc.resolveServiceTypes.resolvedCellRef;wa.resolvedDottedName=Dc.resolveServiceTypes.resolvedDottedName;wa.resolvedLocalName=Dc.resolveServiceTypes.resolvedLocalName;wa.resolvedName=Dc.resolveServiceTypes.resolvedName;wa.resolvedNever=Dc.resolveServiceTypes.resolvedNever;wa.resolvedStructRef=Dc.resolveServiceTypes.resolvedStructRef;wa.resolvedUserDefinedFunc=Dc.resolveServiceTypes.resolvedUserDefinedFunc});var QQ=T(_a=>{"use strict";p();Object.defineProperty(_a,"__esModule",{value:!0});_a.shouldQuoteQualifier=_a.resolvePosition=_a.quoteQualifier=_a.formatRowRange=_a.formatRow=_a.formatRangePos=_a.formatQualifier=_a.formatGridRange=_a.formatColRange=_a.formatCol=_a.formatCellPos=_a.columnName=_a.canonicaliseRowRange=_a.canonicaliseRow=_a.canonicaliseRangePos=_a.canonicaliseColRange=_a.canonicaliseCol=_a.canonicaliseCellPos=_a.canonicaliseBrackets=void 0;var rc=qr();_a.canonicaliseBrackets=rc.cellFormat.canonicaliseBrackets;_a.canonicaliseCellPos=rc.cellFormat.canonicaliseCellPos;_a.canonicaliseCol=rc.cellFormat.canonicaliseCol;_a.canonicaliseColRange=rc.cellFormat.canonicaliseColRange;_a.canonicaliseRangePos=rc.cellFormat.canonicaliseRangePos;_a.canonicaliseRow=rc.cellFormat.canonicaliseRow;_a.canonicaliseRowRange=rc.cellFormat.canonicaliseRowRange;_a.columnName=rc.cellFormat.columnName;_a.formatCellPos=rc.cellFormat.formatCellPos;_a.formatCol=rc.cellFormat.formatCol;_a.formatColRange=rc.cellFormat.formatColRange;_a.formatGridRange=rc.cellFormat.formatGridRange;_a.formatQualifier=rc.cellFormat.formatQualifier;_a.formatRangePos=rc.cellFormat.formatRangePos;_a.formatRow=rc.cellFormat.formatRow;_a.formatRowRange=rc.cellFormat.formatRowRange;_a.quoteQualifier=rc.cellFormat.quoteQualifier;_a.resolvePosition=rc.cellFormat.resolvePosition;_a.shouldQuoteQualifier=rc.cellFormat.shouldQuoteQualifier});var YQ=T(BG=>{"use strict";p();Object.defineProperty(BG,"__esModule",{value:!0});BG.autocorrectFormula=void 0;var QM=fe(),Ui=nf(),HM=F0(),Sm=kp(),ph=hm(),XM=GG(),kb=zQ(),K0e=IG(),Hrr=VM(),XQ=QQ(),zrr=dh(),Qrr=fh(),Ry={getDocumentLoc:function(){return(0,Sm.assertFalse)("calc.analyze.autocorrectFormula: default getDocumentLoc")},getSheetIndex:function(){return(0,Sm.assertFalse)("calc.analyze.autocorrectFormula: default getSheetIndex")},getSheetName:function(){return(0,Sm.assertFalse)("calc.analyze.autocorrectFormula: default getSheetName")},getNameLoc:function(){return(0,Sm.assertFalse)("calc.analyze.autocorrectFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,Sm.assertFalse)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,Sm.assertFalse)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes")},getContainingTable:function(){return(0,Sm.assertFalse)("calc.analyze.autocorrectFormula: default getContainingTable")},getStructRefColumn:function(){return(0,Sm.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,Sm.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")}};function Xrr(e){var r,t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N;return{config:e.config,getDocumentLoc:(t=(r=e.getDocumentLoc)===null||r===void 0?void 0:r.bind(e))!==null&&t!==void 0?t:Ry.getDocumentLoc,getSheetIndex:(a=(n=e.getSheetIndex)===null||n===void 0?void 0:n.bind(e))!==null&&a!==void 0?a:Ry.getSheetIndex,getSheetName:(u=(o=e.getSheetName)===null||o===void 0?void 0:o.bind(e))!==null&&u!==void 0?u:Ry.getSheetName,getNameLoc:(l=(s=e.getNameLoc)===null||s===void 0?void 0:s.bind(e))!==null&&l!==void 0?l:Ry.getNameLoc,getUserDefinedFuncLoc:(d=(c=e.getUserDefinedFuncLoc)===null||c===void 0?void 0:c.bind(e))!==null&&d!==void 0?d:Ry.getUserDefinedFuncLoc,getSheetRangeIndexes:(m=(f=e.getSheetRangeIndexes)===null||f===void 0?void 0:f.bind(e))!==null&&m!==void 0?m:Ry.getSheetRangeIndexes,getContainingTable:(h=(v=e.getContainingTable)===null||v===void 0?void 0:v.bind(e))!==null&&h!==void 0?h:Ry.getContainingTable,getStructRefColumn:(_=(y=e.getStructRefColumn)===null||y===void 0?void 0:y.bind(e))!==null&&_!==void 0?_:Ry.getStructRefColumn,getStructRefSpecialRef:(N=(E=e.getStructRefSpecialRef)===null||E===void 0?void 0:E.bind(e))!==null&&N!==void 0?N:Ry.getStructRefSpecialRef}}var zM=(0,HM.createFailureErrorClass)("AutocorrectError"),Yrr=QM.__assign(QM.__assign({},(0,XM.binaryVisitor)((0,XM.constVisitor)(!1),function(e,r){return e||r})),{badSequenceNode:function(r,t,n){return!0},badCharsNode:function(r,t,n){return!0}}),Jrr=function(e){QM.__extends(r,e);function r(t,n,a){var o,u,s,l,c=e.call(this)||this;c.f=a,c.seenUnclosed=!1,c.seenParen=!1,c.seenMissingOperand=!1;var d=Xrr(t);return c.globals=d,c.locals=n,c.resolver=(0,K0e.createResolver)(d),c.localeInfo=(u=(o=n.config)===null||o===void 0?void 0:o.localeInfo)!==null&&u!==void 0?u:t.config.localeInfo,c.refStyle=(l=(s=n.config)===null||s===void 0?void 0:s.refStyle)!==null&&l!==void 0?l:t.config.refStyle,c}return r.prototype.autocorrect=function(){return(0,XM.reduceBottomUp)(Yrr,this.f)?this.f.node:(0,XM.reduceBottomUp)(this,this.f)},r.prototype.literalNode=function(t,n,a){if(n||(this.seenUnclosed=!0),!this.locals.allowUnqualifiedCell&&t.kind===zrr.OperKind.Error&&t.type===Qrr.ErrorType.REF){var o=this.qualifyCellRef();if(o)return(0,Ui.cellRefNode)((0,Ui.cellRefError)(),this.qualifyCellRef(),a)}return(0,Ui.literalNode)(t,n,a)},r.prototype.nameNode=function(t,n,a){var o=(0,Ui.nameNode)(t,n,a),u=(0,Ui.flattenNameParts)(t).parts,s=QM.__assign(QM.__assign({},this.locals),{allowUnqualifiedCell:!0}),l=this.resolver.resolveDottedName(s,o,this.f.annotations),c=l.headResolved,d=l.fieldsResolved;if((0,K0e.canDenoteCellRef)(s,n,u)){var f=u[0],m=u[1],v=u.slice(2);if(c.kind===kb.ResolvedKind.ResolvedCellRef){var h=c.node,y=h.ref,_=h.qualifier,E=h.label,N=this.cellRefNode(y,_,E),k=N.ref,q=N.qualifier;(0,Sm.assertTrue)("calc.analyze.autocorrectFormula: resolved CellRefKind correct",y.kind===f.ref.kind),(0,Sm.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't change CellRefKind",k.kind===y.kind),(0,Sm.assertTrue)("calc.analyze.autocorrectFormula: autocorrect doesn't generate ErrorQualifier",(q==null?void 0:q.kind)!==Ui.QualifierKind.Error),(0,Sm.assertTrue)("calc.analyze.autocorrectFormula: all flattened field parts resolved",u.length===1+d.length);var V=function(M,B){var U=B.rhs,j=B.canDenoteNamedObject,X=B.label,ee=B.qualifiedLabel;return(0,Ui.fieldRefNamePart)(M,U,j,X,ee)};return(0,Ui.nameNode)(v.reduce(V,V((0,Ui.cellRefNamePart)(k,f.asWhole,f.label,f.qualifiedLabel),m)),q,E)}this.throwIfResolutionUnknown(c.resolution)}if(this.locals.allowRelativeQualifier&&n===void 0){if(c.kind===kb.ResolvedKind.ResolvedName&&(0,ph.isSuccess)(c.resolution)&&c.resolution.value&&c.resolution.value.scope.index!==void 0)return(0,Ui.nameNode)(t,this.qualifySheetName(c.resolution.value.scope),a);this.throwIfResolutionUnknown(c.resolution)}if(n&&(n.kind===Ui.QualifierKind.Sheet||n.kind===Ui.QualifierKind.Ident)){if(c.kind===kb.ResolvedKind.ResolvedName&&(0,ph.isSuccess)(c.resolution)&&c.resolution.value&&c.resolution.value.scope.index===void 0&&c.qualifierResolution===Ui.QualifierKind.Sheet)return(0,Ui.nameNode)(t,this.qualifyBookName(c.resolution.value.scope),a);this.throwIfResolutionUnknown(c.resolution)}return o},r.prototype.arrayNode=function(t,n,a){return n||(this.seenUnclosed=!0),(0,Ui.arrayNode)(t,n,a)},r.prototype.appNode=function(t,n,a,o){var u=this.appNodeBase(t,a,o);return a||(this.seenUnclosed=!0),(0,HM.isOperatorNode)(t)||(this.seenParen=!0),(0,HM.isOperatorNode)(t)&&n.some(HM.isMissingNode)&&(this.seenMissingOperand=!0),(0,Ui.appNode)(t,n,u,o)},r.prototype.letNode=function(t,n,a,o,u,s){var l=this.appNodeBase(t,u,s);return u||(this.seenUnclosed=!0),this.seenParen=!0,(0,Ui.letNode)(t,n,a,o,l,s)},r.prototype.lambdaNode=function(t,n,a,o,u,s){var l=this.appNodeBase(t,u,s);return u||(this.seenUnclosed=!0),this.seenParen=!0,(0,Ui.lambdaNode)(t,n,a,o,l,s)},r.prototype.parenNode=function(t,n,a){return n||(this.seenUnclosed=!0),this.seenParen=!0,(0,Ui.parenNode)(t,n,a)},r.prototype.cellRefNode=function(t,n,a){return t.isBracketed&&this.localeInfo.rcLeftBracket==="("&&(this.seenParen=!0),!this.locals.allowUnqualifiedCell&&n===void 0?(0,Ui.cellRefNode)(t,this.qualifyCellRef(),a):(0,Ui.cellRefNode)(t,n,a)},r.prototype.fieldRefNode=function(t,n,a){return n.isClosed||(this.seenUnclosed=!0),(0,Ui.fieldRefNode)(t,n,a)},r.prototype.structRefNode=function(t,n,a){if(n.isClosed||(this.seenUnclosed=!0),t!==void 0&&t.qualifier){var o=this.resolver.resolveName(this.locals,t,Hrr.NameSource.StructRef),u=o.resolution,s=o.qualifierResolution;if((0,ph.isSuccess)(u)&&u.value&&s===Ui.QualifierKind.Sheet)return(0,Ui.structRefNode)((0,Ui.nameNode)(t.parts,void 0,t.label),n,a);this.throwIfResolutionUnknown(u)}return(0,Ui.structRefNode)(t,n,a)},r.prototype.qualifyCellRef=function(){var t=this.locals.originSheet;if(!(0,ph.isSuccess)(t))throw new zM(t.reason);if(t.value.index!==void 0){var n=this.globals.getSheetName(t.value.document,t.value.index);if(!(0,ph.isSuccess)(n))throw new zM(n.reason);var a=void 0;return(0,Ui.sheetQualifier)(n.value,a,(0,XQ.shouldQuoteQualifier)(this.localeInfo,this.refStyle,n.value))}},r.prototype.qualifySheetName=function(t){var n=this.globals.getSheetName(t.document,t.index);if(!(0,ph.isSuccess)(n))throw new zM(n.reason);var a=void 0;return(0,Ui.sheetQualifier)(n.value,a,(0,XQ.shouldQuoteQualifier)(this.localeInfo,this.refStyle,n.value))},r.prototype.qualifyBookName=function(t){var n=t.document;return(0,Ui.identQualifier)(n.name,(0,XQ.shouldQuoteQualifier)(this.localeInfo,this.refStyle,n.name))},r.prototype.appNodeBase=function(t,n,a){return n||!(0,HM.isOperatorNode)(t)&&this.isFormulaRoot(a)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand},r.prototype.isFormulaRoot=function(t){var n;return((n=this.f.annotations[t])===null||n===void 0?void 0:n.kind)===Ui.AnnotationKind.FormulaRoot},r.prototype.throwIfResolutionUnknown=function(t){if(!(0,ph.isSuccess)(t)&&t.reason.kind!==kb.ResolveReasonKind.NoOriginSheet&&t.reason.kind!==kb.ResolveReasonKind.InvalidQualifier&&t.reason.kind!==kb.ResolveReasonKind.InvalidCellRef&&t.reason.kind!==kb.ResolveReasonKind.InvalidStructRef&&t.reason.kind!==kb.ResolveReasonKind.EmptyIntersection)throw new zM(t.reason)},r}(XM.IdentityVisitor);function Zrr(e,r,t){try{var n=t.spans,a=t.annotations,o=t.depthUpperBound,u=new Jrr(e,r,t).autocorrect();return(0,ph.success)((0,Ui.formula)(u,n,a,o))}catch(s){return s instanceof zM?(0,ph.failure)(s.reason):(0,ph.failure)((0,ph.javaScriptError)(s))}}BG.autocorrectFormula=Zrr});var JQ=T(Mp=>{"use strict";p();Object.defineProperty(Mp,"__esModule",{value:!0});Mp.analyzeLocalsName=Mp.analyzeLocalsGrid=Mp.createAnalyzeGlobals=Mp.staticPrecedents=Mp.summarizeFormulaDiagnostics=Mp.diagnostics=void 0;var $rr=fe(),etr=VM(),V0e=$rr.__importStar(kG());Mp.diagnostics=V0e;var UG=hm();function rtr(e){if(e!==void 0){var r={};return Object.keys(e).forEach(function(t){e[Number(t)].forEach(function(n){var a,o=V0e.formatDiagnostic(n);r[o]=((a=r[o])!==null&&a!==void 0?a:0)+1})}),r}}Mp.summarizeFormulaDiagnostics=rtr;function ttr(e,r,t,n,a,o,u){return{cells:e,names:r,udfs:t,special:n,ownSpecial:a,bound:o,resolutions:u}}Mp.staticPrecedents=ttr;function ntr(e,r){return{config:e,getSheetName:r}}Mp.createAnalyzeGlobals=ntr;function atr(e,r,t,n){return n===void 0&&(n=!1),{config:t??void 0,lexicalKind:e,originGridCell:(0,UG.success)(r.range),originSheet:(0,UG.success)(r.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:n}}Mp.analyzeLocalsGrid=atr;function itr(e,r,t){return t===void 0&&(t=!1),{config:r??void 0,lexicalKind:etr.LexicalKind.NameManager,originGridCell:(0,UG.success)(e.range),originSheet:(0,UG.success)(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:t}}Mp.analyzeLocalsName=itr});var H0e=T(VG=>{"use strict";p();Object.defineProperty(VG,"__esModule",{value:!0});VG.resolveStaticPrecedents=void 0;var otr=fe(),Ey=kp(),KG=DA(),Ay=hm(),BA=nf(),YM=VM(),utr=IG(),N0=zQ(),JM=Nb(),UA=dh(),j0e=F0(),str=fh(),W0e=GG(),ltr=JQ(),Py={getDocumentLoc:function(){return(0,Ey.assertFalse)("calc.analyze.resolveStaticPrecedents: default getDocumentLoc")},getSheetIndex:function(){return(0,Ey.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetIndex")},getSheetName:function(){return(0,Ey.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetName")},getNameLoc:function(){return(0,Ey.assertFalse)("calc.analyze.resolveStaticPrecedents: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,Ey.assertFalse)("calc.analyze.resolveStaticPrecedents: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,Ey.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetRangeIndexes")},getContainingTable:function(){return(0,Ey.assertFalse)("calc.analyze.resolveStaticPrecedents: default getContainingTable")},getStructRefColumn:function(){return(0,Ey.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,Ey.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefSpecialRef")}};function ctr(e){var r,t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N;return{config:e.config,getDocumentLoc:(t=(r=e.getDocumentLoc)===null||r===void 0?void 0:r.bind(e))!==null&&t!==void 0?t:Py.getDocumentLoc,getSheetIndex:(a=(n=e.getSheetIndex)===null||n===void 0?void 0:n.bind(e))!==null&&a!==void 0?a:Py.getSheetIndex,getSheetName:(u=(o=e.getSheetName)===null||o===void 0?void 0:o.bind(e))!==null&&u!==void 0?u:Py.getSheetName,getNameLoc:(l=(s=e.getNameLoc)===null||s===void 0?void 0:s.bind(e))!==null&&l!==void 0?l:Py.getNameLoc,getUserDefinedFuncLoc:(d=(c=e.getUserDefinedFuncLoc)===null||c===void 0?void 0:c.bind(e))!==null&&d!==void 0?d:Py.getUserDefinedFuncLoc,getSheetRangeIndexes:(m=(f=e.getSheetRangeIndexes)===null||f===void 0?void 0:f.bind(e))!==null&&m!==void 0?m:Py.getSheetRangeIndexes,getContainingTable:(h=(v=e.getContainingTable)===null||v===void 0?void 0:v.bind(e))!==null&&h!==void 0?h:Py.getContainingTable,getStructRefColumn:(_=(y=e.getStructRefColumn)===null||y===void 0?void 0:y.bind(e))!==null&&_!==void 0?_:Py.getStructRefColumn,getStructRefSpecialRef:(N=(E=e.getStructRefSpecialRef)===null||E===void 0?void 0:E.bind(e))!==null&&N!==void 0?N:Py.getStructRefSpecialRef}}var ZQ=(0,j0e.createFailureErrorClass)("ResolveStaticPrecedentsError"),dtr=function(e){otr.__extends(r,e);function r(t,n,a){var o=e.call(this)||this;return o.locals=n,o.annotations=a,o.cells=[],o.names=[],o.udfs=[],o.nameSpecial=UA.SpecialPrecs.None,o.ownSpecial=UA.SpecialPrecs.None,o.resolutions=[],o.globals=ctr(t),o.resolver=(0,utr.createResolver)(o.globals),o}return r.prototype.appNode=function(t,n,a,o){var u=this;if(t.kind===BA.NodeKind.WSF){var s=t.id,l=(0,JM.getWorksheetFuncType)(s).staticPrecs;switch(s){case JM.WorksheetFuncId.LOOKUP:case JM.WorksheetFuncId.SUMIF:case JM.WorksheetFuncId.AVERAGEIF:var c=function(m){var v=m.label,h=u.resolutions[v],y=(h==null?void 0:h.kind)===N0.ResolvedKind.ResolvedCellRef||(h==null?void 0:h.kind)===N0.ResolvedKind.ResolvedStructRef?h.resolution:void 0;return(y==null?void 0:y.kind)===Ay.ResultKind.Success?y.value:void 0},d=function(m,v){var h=c(m),y=c(v);return h!==void 0&&y!==void 0&&(0,YM.isSheetGridRange)(h)&&(0,YM.isSheetGridRange)(y)&&(0,j0e.isDocumentLocEqual)(h.sheet.document,y.sheet.document)&&h.range.rows===y.range.rows&&h.range.cols===y.range.cols};(n.length<3||n[2].kind===BA.NodeKind.Literal||n[2].kind===BA.NodeKind.Array||d(n[2],s===JM.WorksheetFuncId.LOOKUP?n[1]:n[0]))&&(l&=~UA.SpecialPrecs.AllCells);break}l!==UA.SpecialPrecs.None&&(this.ownSpecial|=l)}return e.prototype.appNode.call(this,t,n,a,o)},r.prototype.nameNode=function(t,n,a){var o=this.resolver.resolveDottedName(this.locals,(0,BA.nameNode)(t,n,a),this.annotations);this.resolutions[a]=o,(0,KG.safePush)(this.names,o.precedents.names),(0,KG.safePush)(this.udfs,o.precedents.udfs);var u=o.headResolved;switch(u.kind){case N0.ResolvedKind.ResolvedName:if(!(0,Ay.isSuccess)(u.resolution)){this.handleResolutionError(u.resolution.reason);break}u.resolution.value!==void 0&&(this.nameSpecial|=UA.SpecialPrecs.All);break;case N0.ResolvedKind.ResolvedUserDefinedFunc:if(!(0,Ay.isSuccess)(u.resolution)){this.handleResolutionError(u.resolution.reason);break}break;case N0.ResolvedKind.ResolvedCellRef:this.pushResolvedGridRef(u.resolution);break}return e.prototype.nameNode.call(this,t,n,a)},r.prototype.cellRefNode=function(t,n,a){var o=this.resolver.resolveCellRef(this.locals,(0,BA.cellRefNode)(t,n,a));this.resolutions[a]=o;var u=o.resolution;return this.pushResolvedGridRef(u),e.prototype.cellRefNode.call(this,t,n,a)},r.prototype.structRefNode=function(t,n,a){var o=this.resolver.resolveStructRef(this.locals,(0,BA.structRefNode)(t,n,a));this.resolutions[a]=o,(0,KG.safePush)(this.names,o.precedents);var u=o.resolution;return this.pushResolvedGridRef(u),e.prototype.structRefNode.call(this,t,n,a)},r.prototype.pushResolvedGridRef=function(t){if(t.kind!==Ay.ResultKind.Success)return this.handleResolutionError(t.reason);if(t.value!==void 0){var n=t.value;if((0,YM.isSheetGridRange)(n))this.cells.push(n);else{this.ownSpecial|=UA.SpecialPrecs.OwnDocSheets;var a=this.globals.getSheetRangeIndexes(n.sheet);if(!(0,Ay.isSuccess)(a))throw new ZQ(a.reason);(0,KG.safePush)(this.cells,a.value.sheets.map(function(o){return(0,YM.sheetGridRange)((0,YM.sheetIndex)(n.sheet.document,o),n.range)}))}}},r.prototype.handleResolutionError=function(t){switch(t.kind){case N0.ResolveReasonKind.NoOriginSheet:case N0.ResolveReasonKind.InvalidStructRef:case N0.ResolveReasonKind.InvalidCellRef:case N0.ResolveReasonKind.InvalidQualifier:case N0.ResolveReasonKind.EmptyIntersection:return}throw new ZQ(t)},r}(W0e.IdentityVisitor);function ftr(e,r,t){try{var n=new dtr(e,r,t.annotations);return(0,W0e.reduceBottomUp)(n,t),(0,Ay.success)((0,ltr.staticPrecedents)(n.cells,n.names,n.udfs,n.nameSpecial|n.ownSpecial,n.ownSpecial,str.PrecsBound.Upper,n.resolutions))}catch(a){return a instanceof ZQ?(0,Ay.failure)(a.reason):(0,Ay.failure)((0,Ay.javaScriptError)(a))}}VG.resolveStaticPrecedents=ftr});var Q0e=T(jG=>{"use strict";p();Object.defineProperty(jG,"__esModule",{value:!0});jG.createAnalyzer=void 0;var z0e=HQ(),ptr=YQ(),mtr=H0e();function gtr(e){return{checkFormula:function(t,n){return(0,z0e.checkFormula)(e,t,n)},checkFormulaWithDiagnostics:function(t,n){return(0,z0e.checkFormulaWithDiagnostics)(e,t,n)},autocorrectFormula:function(t,n){return(0,ptr.autocorrectFormula)(e,t,n)},resolveStaticPrecedents:function(t,n){return(0,mtr.resolveStaticPrecedents)(e,t,n)}}}jG.createAnalyzer=gtr});var eX=T(mh=>{"use strict";p();Object.defineProperty(mh,"__esModule",{value:!0});mh.notFormulaString=mh.ReasonKind=mh.parseLocals=mh.createParseGlobals=void 0;var X0e=fe(),vtr=F0(),htr=hm();function Str(e){return{config:e}}mh.createParseGlobals=Str;function ytr(e,r,t,n,a){return{config:t??void 0,lexicalKind:e,originGridCell:(0,htr.success)(r),contextNames:n,syntaxFeatures:a}}mh.parseLocals=ytr;var $Q;(function(e){e.NotFormulaString="NotFormulaString"})($Q||($Q={}));mh.ReasonKind=X0e.__assign(X0e.__assign({},vtr.ReasonKind),$Q);function _tr(e){return{kind:mh.ReasonKind.NotFormulaString,message:e}}mh.notFormulaString=_tr});var xT=T(Uu=>{"use strict";p();Object.defineProperty(Uu,"__esModule",{value:!0});Uu.surrogatePairToCodePoint=Uu.stringFromCodePoint=Uu.stringCodePointAt=Uu.scanCodePointsBack=Uu.scanCodePoints=Uu.numCodeUnits=Uu.isLowSurrogate=Uu.isHighSurrogate=Uu.isAnySurrogate=Uu.countCodePoints=Uu.codePointIterator=void 0;var gh=pr();Uu.codePointIterator=gh.unicode.codePointIterator;Uu.countCodePoints=gh.unicode.countCodePoints;Uu.isAnySurrogate=gh.unicode.isAnySurrogate;Uu.isHighSurrogate=gh.unicode.isHighSurrogate;Uu.isLowSurrogate=gh.unicode.isLowSurrogate;Uu.numCodeUnits=gh.unicode.numCodeUnits;Uu.scanCodePoints=gh.unicode.scanCodePoints;Uu.scanCodePointsBack=gh.unicode.scanCodePointsBack;Uu.stringCodePointAt=gh.unicode.stringCodePointAt;Uu.stringFromCodePoint=gh.unicode.stringFromCodePoint;Uu.surrogatePairToCodePoint=gh.unicode.surrogatePairToCodePoint});var KA=T(oe=>{"use strict";p();Object.defineProperty(oe,"__esModule",{value:!0});oe.codePointExclamationMark=oe.codePointEuroSign=oe.codePointEqualsSign=oe.codePointDoubleQuote=oe.codePointDollarSign=oe.codePointDigitZero=oe.codePointDigitTwo=oe.codePointDigitThree=oe.codePointDigitSix=oe.codePointDigitSeven=oe.codePointDigitOne=oe.codePointDigitNine=oe.codePointDigitFour=oe.codePointDigitFive=oe.codePointDigitEight=oe.codePointComma=oe.codePointColon=oe.codePointCircumflexAccent=oe.codePointCapitalZ=oe.codePointCapitalY=oe.codePointCapitalX=oe.codePointCapitalW=oe.codePointCapitalV=oe.codePointCapitalU=oe.codePointCapitalT=oe.codePointCapitalS=oe.codePointCapitalR=oe.codePointCapitalQ=oe.codePointCapitalP=oe.codePointCapitalO=oe.codePointCapitalN=oe.codePointCapitalM=oe.codePointCapitalL=oe.codePointCapitalK=oe.codePointCapitalJ=oe.codePointCapitalI=oe.codePointCapitalH=oe.codePointCapitalG=oe.codePointCapitalF=oe.codePointCapitalE=oe.codePointCapitalD=oe.codePointCapitalC=oe.codePointCapitalB=oe.codePointCapitalA=oe.codePointCR=oe.codePointBacktick=oe.codePointBackslash=oe.codePointAtSign=oe.codePointAsterisk=oe.codePointAmpersand=void 0;oe.codePointSmallW=oe.codePointSmallV=oe.codePointSmallU=oe.codePointSmallT=oe.codePointSmallS=oe.codePointSmallR=oe.codePointSmallQ=oe.codePointSmallP=oe.codePointSmallO=oe.codePointSmallN=oe.codePointSmallM=oe.codePointSmallL=oe.codePointSmallK=oe.codePointSmallJ=oe.codePointSmallI=oe.codePointSmallH=oe.codePointSmallG=oe.codePointSmallF=oe.codePointSmallE=oe.codePointSmallD=oe.codePointSmallC=oe.codePointSmallB=oe.codePointSmallA=oe.codePointSlash=oe.codePointSingleQuote=oe.codePointSemicolon=oe.codePointRightSquareBracket=oe.codePointRightParen=oe.codePointRightCurlyBracket=oe.codePointQuestionMark=oe.codePointPlusSign=oe.codePointPipe=oe.codePointPercentSign=oe.codePointMinusSign=oe.codePointLessThanSign=oe.codePointLeftSquareBracket=oe.codePointLeftParen=oe.codePointLeftCurlyBracket=oe.codePointLF=oe.codePointInvertedQuestionMark=oe.codePointInvertedExclamationMark=oe.codePointHash=oe.codePointGreaterThanSign=oe.codePointFullwidthLatinSmallZ=oe.codePointFullwidthLatinSmallA=oe.codePointFullwidthLatinCapitalZ=oe.codePointFullwidthLatinCapitalA=oe.codePointFullwidthDigitZero=oe.codePointFullwidthDigitNine=oe.codePointFullStop=void 0;oe.codePointRightSingleQuotationMark=oe.codePointLeftSingleQuotationMark=oe.codePointUnderscore=oe.codePointTilde=oe.codePointThaiDigitZero=oe.codePointThaiDigitNine=oe.codePointTab=oe.codePointSpace=oe.codePointSmallZ=oe.codePointSmallY=oe.codePointSmallX=void 0;var He=pr();oe.codePointAmpersand=He.codePoint.codePointAmpersand;oe.codePointAsterisk=He.codePoint.codePointAsterisk;oe.codePointAtSign=He.codePoint.codePointAtSign;oe.codePointBackslash=He.codePoint.codePointBackslash;oe.codePointBacktick=He.codePoint.codePointBacktick;oe.codePointCR=He.codePoint.codePointCR;oe.codePointCapitalA=He.codePoint.codePointCapitalA;oe.codePointCapitalB=He.codePoint.codePointCapitalB;oe.codePointCapitalC=He.codePoint.codePointCapitalC;oe.codePointCapitalD=He.codePoint.codePointCapitalD;oe.codePointCapitalE=He.codePoint.codePointCapitalE;oe.codePointCapitalF=He.codePoint.codePointCapitalF;oe.codePointCapitalG=He.codePoint.codePointCapitalG;oe.codePointCapitalH=He.codePoint.codePointCapitalH;oe.codePointCapitalI=He.codePoint.codePointCapitalI;oe.codePointCapitalJ=He.codePoint.codePointCapitalJ;oe.codePointCapitalK=He.codePoint.codePointCapitalK;oe.codePointCapitalL=He.codePoint.codePointCapitalL;oe.codePointCapitalM=He.codePoint.codePointCapitalM;oe.codePointCapitalN=He.codePoint.codePointCapitalN;oe.codePointCapitalO=He.codePoint.codePointCapitalO;oe.codePointCapitalP=He.codePoint.codePointCapitalP;oe.codePointCapitalQ=He.codePoint.codePointCapitalQ;oe.codePointCapitalR=He.codePoint.codePointCapitalR;oe.codePointCapitalS=He.codePoint.codePointCapitalS;oe.codePointCapitalT=He.codePoint.codePointCapitalT;oe.codePointCapitalU=He.codePoint.codePointCapitalU;oe.codePointCapitalV=He.codePoint.codePointCapitalV;oe.codePointCapitalW=He.codePoint.codePointCapitalW;oe.codePointCapitalX=He.codePoint.codePointCapitalX;oe.codePointCapitalY=He.codePoint.codePointCapitalY;oe.codePointCapitalZ=He.codePoint.codePointCapitalZ;oe.codePointCircumflexAccent=He.codePoint.codePointCircumflexAccent;oe.codePointColon=He.codePoint.codePointColon;oe.codePointComma=He.codePoint.codePointComma;oe.codePointDigitEight=He.codePoint.codePointDigitEight;oe.codePointDigitFive=He.codePoint.codePointDigitFive;oe.codePointDigitFour=He.codePoint.codePointDigitFour;oe.codePointDigitNine=He.codePoint.codePointDigitNine;oe.codePointDigitOne=He.codePoint.codePointDigitOne;oe.codePointDigitSeven=He.codePoint.codePointDigitSeven;oe.codePointDigitSix=He.codePoint.codePointDigitSix;oe.codePointDigitThree=He.codePoint.codePointDigitThree;oe.codePointDigitTwo=He.codePoint.codePointDigitTwo;oe.codePointDigitZero=He.codePoint.codePointDigitZero;oe.codePointDollarSign=He.codePoint.codePointDollarSign;oe.codePointDoubleQuote=He.codePoint.codePointDoubleQuote;oe.codePointEqualsSign=He.codePoint.codePointEqualsSign;oe.codePointEuroSign=He.codePoint.codePointEuroSign;oe.codePointExclamationMark=He.codePoint.codePointExclamationMark;oe.codePointFullStop=He.codePoint.codePointFullStop;oe.codePointFullwidthDigitNine=He.codePoint.codePointFullwidthDigitNine;oe.codePointFullwidthDigitZero=He.codePoint.codePointFullwidthDigitZero;oe.codePointFullwidthLatinCapitalA=He.codePoint.codePointFullwidthLatinCapitalA;oe.codePointFullwidthLatinCapitalZ=He.codePoint.codePointFullwidthLatinCapitalZ;oe.codePointFullwidthLatinSmallA=He.codePoint.codePointFullwidthLatinSmallA;oe.codePointFullwidthLatinSmallZ=He.codePoint.codePointFullwidthLatinSmallZ;oe.codePointGreaterThanSign=He.codePoint.codePointGreaterThanSign;oe.codePointHash=He.codePoint.codePointHash;oe.codePointInvertedExclamationMark=He.codePoint.codePointInvertedExclamationMark;oe.codePointInvertedQuestionMark=He.codePoint.codePointInvertedQuestionMark;oe.codePointLF=He.codePoint.codePointLF;oe.codePointLeftCurlyBracket=He.codePoint.codePointLeftCurlyBracket;oe.codePointLeftParen=He.codePoint.codePointLeftParen;oe.codePointLeftSquareBracket=He.codePoint.codePointLeftSquareBracket;oe.codePointLessThanSign=He.codePoint.codePointLessThanSign;oe.codePointMinusSign=He.codePoint.codePointMinusSign;oe.codePointPercentSign=He.codePoint.codePointPercentSign;oe.codePointPipe=He.codePoint.codePointPipe;oe.codePointPlusSign=He.codePoint.codePointPlusSign;oe.codePointQuestionMark=He.codePoint.codePointQuestionMark;oe.codePointRightCurlyBracket=He.codePoint.codePointRightCurlyBracket;oe.codePointRightParen=He.codePoint.codePointRightParen;oe.codePointRightSquareBracket=He.codePoint.codePointRightSquareBracket;oe.codePointSemicolon=He.codePoint.codePointSemicolon;oe.codePointSingleQuote=He.codePoint.codePointSingleQuote;oe.codePointSlash=He.codePoint.codePointSlash;oe.codePointSmallA=He.codePoint.codePointSmallA;oe.codePointSmallB=He.codePoint.codePointSmallB;oe.codePointSmallC=He.codePoint.codePointSmallC;oe.codePointSmallD=He.codePoint.codePointSmallD;oe.codePointSmallE=He.codePoint.codePointSmallE;oe.codePointSmallF=He.codePoint.codePointSmallF;oe.codePointSmallG=He.codePoint.codePointSmallG;oe.codePointSmallH=He.codePoint.codePointSmallH;oe.codePointSmallI=He.codePoint.codePointSmallI;oe.codePointSmallJ=He.codePoint.codePointSmallJ;oe.codePointSmallK=He.codePoint.codePointSmallK;oe.codePointSmallL=He.codePoint.codePointSmallL;oe.codePointSmallM=He.codePoint.codePointSmallM;oe.codePointSmallN=He.codePoint.codePointSmallN;oe.codePointSmallO=He.codePoint.codePointSmallO;oe.codePointSmallP=He.codePoint.codePointSmallP;oe.codePointSmallQ=He.codePoint.codePointSmallQ;oe.codePointSmallR=He.codePoint.codePointSmallR;oe.codePointSmallS=He.codePoint.codePointSmallS;oe.codePointSmallT=He.codePoint.codePointSmallT;oe.codePointSmallU=He.codePoint.codePointSmallU;oe.codePointSmallV=He.codePoint.codePointSmallV;oe.codePointSmallW=He.codePoint.codePointSmallW;oe.codePointSmallX=He.codePoint.codePointSmallX;oe.codePointSmallY=He.codePoint.codePointSmallY;oe.codePointSmallZ=He.codePoint.codePointSmallZ;oe.codePointSpace=He.codePoint.codePointSpace;oe.codePointTab=He.codePoint.codePointTab;oe.codePointThaiDigitNine=He.codePoint.codePointThaiDigitNine;oe.codePointThaiDigitZero=He.codePoint.codePointThaiDigitZero;oe.codePointTilde=He.codePoint.codePointTilde;oe.codePointUnderscore=He.codePoint.codePointUnderscore;oe.codePointLeftSingleQuotationMark=He.codePoint.codePointLeftSingleQuotationMark;oe.codePointRightSingleQuotationMark=He.codePoint.codePointRightSingleQuotationMark});var ZM=T(xp=>{"use strict";p();Object.defineProperty(xp,"__esModule",{value:!0});xp.wrapPosition=xp.parseGridRangeA1=xp.parseGridCellA1=xp.parseCellRef=xp.isR1C1IdentStart=xp.SpecialPos=void 0;var VA=qr();xp.SpecialPos=VA.cellParse.SpecialPos;xp.isR1C1IdentStart=VA.cellParse.isR1C1IdentStart;xp.parseCellRef=VA.cellParse.parseCellRef;xp.parseGridCellA1=VA.cellParse.parseGridCellA1;xp.parseGridRangeA1=VA.cellParse.parseGridRangeA1;xp.wrapPosition=VA.cellParse.wrapPosition});var Og=T(Xe=>{"use strict";p();Object.defineProperty(Xe,"__esModule",{value:!0});Xe.rangeOperatorToken=Xe.geOperatorToken=Xe.leOperatorToken=Xe.neOperatorToken=Xe.gtOperatorToken=Xe.ltOperatorToken=Xe.eqOperatorToken=Xe.concatOperatorToken=Xe.percentOperatorToken=Xe.powOperatorToken=Xe.divOperatorToken=Xe.mulOperatorToken=Xe.subOperatorToken=Xe.addOperatorToken=Xe.operatorToken=Xe.identOrBooleanToken=Xe.literalToken=Xe.cellRefR1C1Token=Xe.cellRefA1Token=Xe.specialRefToken=Xe.assignSepToken=Xe.dotSepToken=Xe.qualSepToken=Xe.rowSepToken=Xe.colSepToken=Xe.listSepToken=Xe.rightSQuoteToken=Xe.rightBraceToken=Xe.rightBracketToken=Xe.rightParenToken=Xe.leftSQuoteToken=Xe.leftBraceToken=Xe.leftBracketToken=Xe.leftParenToken=Xe.identToken=Xe.multiLineCommentToken=Xe.singleLineCommentToken=Xe.escapeToken=Xe.unexpectedToken=Xe.spacesToken=Xe.endToken=Xe.badErrorOper=Xe.isBadErrorOper=Xe.badNumberOper=Xe.isNumberLikeOper=Xe.isBadNumberOper=Xe.TokenOperKind=Xe.SepId=Xe.DelimId=Xe.TokenKind=void 0;Xe.appendToken=Xe.poundOperatorToken=Xe.atOperatorToken=void 0;var btr=fe(),vd=Nb(),jA=nf(),Y0e=fh(),Z0e=dh(),Ctr=xT(),$M=btr.__importStar(KA()),J0e=ZM(),Ttr=$M.codePointAsterisk,Rtr=$M.codePointMinusSign,Etr=$M.codePointPlusSign,Ptr=$M.codePointSlash,Atr=$M.codePointSpace,Ho;(function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape",e[e.SingleLineComment=13]="SingleLineComment",e[e.MultiLineComment=14]="MultiLineComment"})(Ho||(Xe.TokenKind=Ho={}));var O0;(function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"})(O0||(Xe.DelimId=O0={}));var Mb;(function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"})(Mb||(Xe.SepId=Mb={}));var IT;(function(e){e.BadNumber="BadNumber",e.BadError="BadError"})(IT||(Xe.TokenOperKind=IT={}));function Ftr(e){return e.kind===IT.BadNumber}Xe.isBadNumberOper=Ftr;function $0e(e){return e.kind===IT.BadNumber||e.kind===Z0e.OperKind.Number}Xe.isNumberLikeOper=$0e;Xe.badNumberOper={kind:IT.BadNumber};function Ntr(e){return e.kind===IT.BadError}Xe.isBadErrorOper=Ntr;Xe.badErrorOper={kind:IT.BadError};function WA(e,r,t,n){return{kind:e,start:r,chars:t,isIdentContinue:n}}var Otr=function(r){return WA(Ho.End,r,"",!1)};Xe.endToken=Otr;var ktr=function(r,t){return WA(Ho.Spaces,r,t,!1)};Xe.spacesToken=ktr;var Mtr=function(r,t){return WA(Ho.Unexpected,r,t,!1)};Xe.unexpectedToken=Mtr;var xtr=function(r,t){return WA(Ho.Escape,r,t,!1)};Xe.escapeToken=xtr;var Itr=function(r,t){return WA(Ho.SingleLineComment,r,t,!1)};Xe.singleLineCommentToken=Itr;var wtr=function(r,t,n){return{kind:Ho.MultiLineComment,start:r,chars:t,isIdentContinue:!1,isClosed:n}};Xe.multiLineCommentToken=wtr;var Dtr=function(r,t){return WA(Ho.Ident,r,t,!0)};Xe.identToken=Dtr;function Xf(e,r,t,n){return{kind:e,start:r,chars:t,isIdentContinue:!1,value:n}}var Ltr=function(r){return Xf(Ho.Left,r,"(",O0.Paren)};Xe.leftParenToken=Ltr;var qtr=function(r,t){return Xf(Ho.Left,r,t,O0.Bracket)};Xe.leftBracketToken=qtr;var Gtr=function(r,t){return Xf(Ho.Left,r,t,O0.Brace)};Xe.leftBraceToken=Gtr;var Btr=function(r){return Xf(Ho.Left,r,"'",O0.SQuote)};Xe.leftSQuoteToken=Btr;var Utr=function(r){return Xf(Ho.Right,r,")",O0.Paren)};Xe.rightParenToken=Utr;var Ktr=function(r,t){return Xf(Ho.Right,r,t,O0.Bracket)};Xe.rightBracketToken=Ktr;var Vtr=function(r,t){return Xf(Ho.Right,r,t,O0.Brace)};Xe.rightBraceToken=Vtr;var jtr=function(r){return Xf(Ho.Right,r,"'",O0.SQuote)};Xe.rightSQuoteToken=jtr;var Wtr=function(r,t){return Xf(Ho.Sep,r,t,Mb.List)};Xe.listSepToken=Wtr;var Htr=function(r,t){return Xf(Ho.Sep,r,t,Mb.Col)};Xe.colSepToken=Htr;var ztr=function(r,t){return Xf(Ho.Sep,r,t,Mb.Row)};Xe.rowSepToken=ztr;var Qtr=function(r){return Xf(Ho.Sep,r,"!",Mb.Qual)};Xe.qualSepToken=Qtr;var Xtr=function(r){return Xf(Ho.Sep,r,".",Mb.Dot)};Xe.dotSepToken=Xtr;var Ytr=function(r){return Xf(Ho.Sep,r,":=",Mb.Assign)};Xe.assignSepToken=Ytr;var Jtr=function(r,t,n){return Xf(Ho.SpecialRef,r,t,n)};Xe.specialRefToken=Jtr;function eSe(e,r,t,n,a,o,u){return{kind:Ho.CellRef,start:e,chars:r,isIdentContinue:t,row:n,col:a,refStyle:o,isBadLocale:u}}function Ztr(e,r,t,n){var a=(t==null||typeof t=="object"&&t.kind===jA.PosKind.Rel)&&(n==null||typeof n=="object"&&n.kind===jA.PosKind.Rel),o=!1;return eSe(e,r,a,t,n,jA.RefStyle.A1,o)}Xe.cellRefA1Token=Ztr;function $tr(e,r,t,n,a){a===void 0&&(a=!1);var o=(t===J0e.SpecialPos.RCNoNum||t==null||t.kind===jA.PosKind.Abs)&&(n===J0e.SpecialPos.RCNoNum||n==null||n.kind===jA.PosKind.Abs);return eSe(e,r,o,t,n,jA.RefStyle.R1C1,a)}Xe.cellRefR1C1Token=$tr;function enr(e){for(var r=0,t=(0,Ctr.codePointIterator)(e);r<t.length;r++){var n=t[r];if(n===Etr||n===Rtr||n===Ttr||n===Atr||n===Ptr)return!1}return!0}function rX(e,r,t,n){n===void 0&&(n=!0);var a=t.kind===Z0e.OperKind.Boolean||$0e(t)&&enr(r);return{kind:Ho.Literal,start:e,chars:r,isIdentContinue:a,oper:t,hasRight:n}}Xe.literalToken=rX;function rnr(e,r,t){return e.stringCompareCI(e.falseName,t)===0?rX(r,t,Y0e.falseOper):e.stringCompareCI(e.trueName,t)===0?rX(r,t,Y0e.trueOper):(0,Xe.identToken)(r,t)}Xe.identOrBooleanToken=rnr;function rSe(e,r,t){return{kind:Ho.Operator,start:e,chars:r,isIdentContinue:!1,value:t}}Xe.operatorToken=rSe;function of(e){var r=vd.operatorStrings[e];if(r==null)throw new Error("operatorTokenMaker: invalid operator ".concat(e));return function(t){return rSe(t,r,e)}}Xe.addOperatorToken=of(vd.OperatorId.Add);Xe.subOperatorToken=of(vd.OperatorId.Sub);Xe.mulOperatorToken=of(vd.OperatorId.Mul);Xe.divOperatorToken=of(vd.OperatorId.Div);Xe.powOperatorToken=of(vd.OperatorId.Pow);Xe.percentOperatorToken=of(vd.OperatorId.Percent);Xe.concatOperatorToken=of(vd.OperatorId.Concat);Xe.eqOperatorToken=of(vd.OperatorId.Eq);Xe.ltOperatorToken=of(vd.OperatorId.Lt);Xe.gtOperatorToken=of(vd.OperatorId.Gt);Xe.neOperatorToken=of(vd.OperatorId.Ne);Xe.leOperatorToken=of(vd.OperatorId.Le);Xe.geOperatorToken=of(vd.OperatorId.Ge);Xe.rangeOperatorToken=of(vd.OperatorId.Range);Xe.atOperatorToken=of(vd.OperatorId.At);Xe.poundOperatorToken=of(vd.OperatorId.Pound);function tnr(e,r,t){return t.push(r),r.start+e}Xe.appendToken=tnr});var k0=T(zt=>{"use strict";p();Object.defineProperty(zt,"__esModule",{value:!0});zt.concat=zt.flatten=zt.middle=zt.right=zt.left=zt.tuple=zt.many1=zt.many=zt.reduce=zt.applyTake=zt.takePeek=zt.peek=zt.take=zt.fails=zt.succeeds=zt.opt=zt.any=zt.withState=zt.apply=zt.bind=zt.parseFail=zt.parseSucceed=zt.warnSucceedOrFail=zt.setDebugging=zt.lazy=zt.runParser=void 0;var nSe=kp(),aSe=Pb(),tSe=hm(),nnr=DA();function anr(e){for(var r=e;r!=null;)r=r();return r}function inr(e,r,t,n){var a;function o(c,d){a=(0,tSe.success)({output:c,index:d})}function u(){a=(0,tSe.failure)(void 0)}if(anr(e(r,t,n,o,u)),a==null){var s=(0,aSe.anonymize)(r),l="calc.parse.runParser: internal error: parser did not call resolve or reject on ".concat(s);return(0,nSe.assertFalse)(l)}return a}zt.runParser=inr;function onr(e){var r;return function(n,a,o,u,s){var l=r??(r=e());return function(){return l(n,a,o,u,s)}}}zt.lazy=onr;var tX=!1;function unr(e){tX=e}zt.setDebugging=unr;function snr(e,r){return function(n,a,o,u,s){return e(n,a,o,function(l,c){return tX&&console.warn("".concat(r," succeeded, returning index ").concat(c," (of ").concat(n.length,") with"),l),u(l,c)},function(){return tX&&console.warn("".concat(r," failed at index ").concat(a," (of ").concat(n.length,")")),s})}}zt.warnSucceedOrFail=snr;function iSe(e){return function(t,n,a,o,u){return o(e,n)}}zt.parseSucceed=iSe;var lnr=function(r,t,n,a,o){return o};function oSe(){return lnr}zt.parseFail=oSe;function uSe(e,r){return function(n,a,o,u,s){return e(n,a,o,function(l,c){return r(o,l)(n,c,o,u,s)},s)}}zt.bind=uSe;function HA(e,r){return function(n,a,o,u,s){return e(n,a,o,function(l,c){return u(r(o,l),c)},s)}}zt.apply=HA;function cnr(e){return function(r,t,n,a,o){return e(n)(r,t,n,a,o)}}zt.withState=cnr;function dnr(e,r){return function(n,a,o,u,s){return e(n,a,o,u,function(){return r(n,a,o,u,s)})}}function fnr(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.length===0?oSe():e.reduce(dnr)}zt.any=fnr;function pnr(e,r){return function(n,a,o,u,s){return e(n,a,o,u,function(){return u(r,a)})}}zt.opt=pnr;function mnr(e){return function(t,n,a,o,u){return e(t,n,a,function(){return o(!0,n)},u)}}zt.succeeds=mnr;function gnr(e){return function(t,n,a,o,u){return e(t,n,a,u,function(){return o(!0,n)})}}zt.fails=gnr;function sSe(e,r){return function(n,a,o,u,s){var l=n[a];if(l==null)return s;var c=e(o,l);return c==null?s:u(c,a+r)}}function vnr(e){return sSe(e,1)}zt.take=vnr;function hnr(e){return sSe(e,0)}zt.peek=hnr;function Snr(e){return function(t,n,a,o,u){var s=t[n],l=t[n+1];if(s==null||l==null)return u;var c=e(a,s,l);return c==null?u:o(c,n+1)}}zt.takePeek=Snr;function ynr(e,r){return function(n,a,o,u,s){return e(n,a,o,function(l,c){var d=r(o,l);return d==null?s:u(d,c)},s)}}zt.applyTake=ynr;function lSe(e,r,t){return function(a,o,u,s,l){var c=t,d=o;function f(){return e(a,d,u,m,v)}function m(h,y){if(y<=d){var _=(0,aSe.anonymize)(a),E="calc.parse.reduce: internal error: no progress made at index ".concat(d," on ").concat(_);return(0,nSe.assertFalse)(E)}return c=r(u,h,c),d=y,f}function v(){return s(c,d)}return f}}zt.reduce=lSe;function nX(e,r){function t(n,a,o){return o.push(a),o}return lSe(e,t,r)}function _nr(e,r){return r===void 0?function(n,a,o,u,s){return nX(e,[])(n,a,o,u,s)}:function(n,a,o,u,s){return e(n,a,o,function(l,c){return nX(r,[l])(n,c,o,u,s)},function(){return u([],a)})}}zt.many=_nr;function bnr(e,r){return r===void 0&&(r=e),uSe(e,function(t,n){return nX(r,[n])})}zt.many1=bnr;function ex(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(e.length===0)return iSe([]);if(e.length===1)return HA(e[0],function(n,a){return[a]});var t=e.length;return function(a,o,u,s,l){var c=o,d=[];function f(){return e[d.length](a,c,u,m,l)}function m(v,h){return c=h,d.push(v),d.length<t?f:s(d,c)}return f}}zt.tuple=ex;function Cnr(e,r){return HA(ex(e,r),function(t,n){var a=n[0];return a})}zt.left=Cnr;function Tnr(e,r){return HA(ex(e,r),function(t,n){var a=n[1];return a})}zt.right=Tnr;function Rnr(e,r,t){return HA(ex(e,r,t),function(n,a){var o=a[1];return o})}zt.middle=Rnr;function cSe(e){return HA(e,function(r,t){return(0,nnr.safeConcat)([],t)})}zt.flatten=cSe;function Enr(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return cSe(ex.apply(void 0,e))}zt.concat=Enr});var vh=T(Dr=>{"use strict";p();Object.defineProperty(Dr,"__esModule",{value:!0});Dr.parseBracketedTokens=Dr.parseIdentContinue=Dr.parseEnd=Dr.parseEscape=Dr.parseAtOp=Dr.parseRangeOp=Dr.parseDotSepTokenNotFollowedByLeftBracket=Dr.parseRightBracket=Dr.parseLeftBracket=Dr.parseRightSQuote=Dr.parseLeftSQuote=Dr.parseRightBrace=Dr.parseLeftBrace=Dr.parseRightParen=Dr.parseLeftParen=Dr.parseAssignToken=Dr.parseDotSepToken=Dr.parseQualSep=Dr.parseColSep=Dr.parseRowSep=Dr.parseListSep=Dr.parseCharIndex=Dr.parseSpacesOnly=Dr.parseWhitespace=Dr.isWhitespaceToken=Dr.isCommentToken=Dr.isBracketToken=Dr.isRightBracketToken=Dr.isLeftBracketToken=Dr.isRefErrorToken=Dr.isAtOpToken=Dr.isRangeOpToken=Dr.isListSepToken=Dr.isDotSepToken=void 0;var Pnr=Pb(),Anr=kp(),Fnr=fh(),dSe=Nb(),ta=Og(),Mo=k0(),Nnr=dh();function fSe(e){return e.kind===ta.TokenKind.Sep&&e.value===ta.SepId.Dot}Dr.isDotSepToken=fSe;function Onr(e){return e.kind===ta.TokenKind.Sep&&e.value===ta.SepId.List}Dr.isListSepToken=Onr;function pSe(e){return e.kind===ta.TokenKind.Operator&&e.value===dSe.OperatorId.Range}Dr.isRangeOpToken=pSe;function mSe(e){return e.kind===ta.TokenKind.Operator&&e.value===dSe.OperatorId.At}Dr.isAtOpToken=mSe;function knr(e){return e.kind===ta.TokenKind.Literal&&e.oper.kind===Nnr.OperKind.Error&&e.oper.type===Fnr.ErrorType.REF}Dr.isRefErrorToken=knr;function gSe(e){return e.kind===ta.TokenKind.Left&&e.value===ta.DelimId.Bracket}Dr.isLeftBracketToken=gSe;function Mnr(e){return e.kind===ta.TokenKind.Right&&e.value===ta.DelimId.Bracket}Dr.isRightBracketToken=Mnr;function vSe(e){return(e.kind===ta.TokenKind.Left||e.kind===ta.TokenKind.Right)&&e.value===ta.DelimId.Bracket}Dr.isBracketToken=vSe;function xnr(e){return e.kind===ta.TokenKind.SingleLineComment||e.kind===ta.TokenKind.MultiLineComment}Dr.isCommentToken=xnr;function hSe(e){return e.kind===ta.TokenKind.Spaces||e.kind===ta.TokenKind.SingleLineComment||e.kind===ta.TokenKind.MultiLineComment}Dr.isWhitespaceToken=hSe;Dr.parseWhitespace=(0,Mo.many)((0,Mo.take)(function(e,r){return hSe(r)?r:void 0}));Dr.parseSpacesOnly=(0,Mo.opt)((0,Mo.take)(function(e,r){return r.kind===ta.TokenKind.Spaces?r.chars:void 0}),"");var Inr=function(r,t,n,a,o){var u=r[t];if(u==null){var s="calc.parse.pStart: internal error: expected token at ".concat(t," in ").concat((0,Pnr.anonymize)(r));return(0,Anr.assertFalse)(s)}return a(u.start,t)};Dr.parseCharIndex=Inr;function zA(e){return(0,Mo.take)(function(r,t){return t.kind===ta.TokenKind.Sep&&t.value===e?t:void 0})}function WG(e){return(0,Mo.take)(function(r,t){return t.kind===ta.TokenKind.Left&&t.value===e?t:void 0})}function HG(e){return(0,Mo.take)(function(r,t){return t.kind===ta.TokenKind.Right&&t.value===e?t:void 0})}Dr.parseListSep=zA(ta.SepId.List);Dr.parseRowSep=zA(ta.SepId.Row);Dr.parseColSep=zA(ta.SepId.Col);Dr.parseQualSep=zA(ta.SepId.Qual);Dr.parseDotSepToken=zA(ta.SepId.Dot);Dr.parseAssignToken=zA(ta.SepId.Assign);Dr.parseLeftParen=WG(ta.DelimId.Paren);Dr.parseRightParen=HG(ta.DelimId.Paren);Dr.parseLeftBrace=WG(ta.DelimId.Brace);Dr.parseRightBrace=HG(ta.DelimId.Brace);Dr.parseLeftSQuote=WG(ta.DelimId.SQuote);Dr.parseRightSQuote=HG(ta.DelimId.SQuote);Dr.parseLeftBracket=WG(ta.DelimId.Bracket);Dr.parseRightBracket=HG(ta.DelimId.Bracket);Dr.parseDotSepTokenNotFollowedByLeftBracket=(0,Mo.takePeek)(function(e,r,t){return fSe(r)&&!gSe(t)?r:void 0});Dr.parseRangeOp=(0,Mo.take)(function(e,r){return pSe(r)?r:void 0});Dr.parseAtOp=(0,Mo.take)(function(e,r){return mSe(r)?r:void 0});Dr.parseEscape=(0,Mo.take)(function(e,r){return r.kind===ta.TokenKind.Escape?r:void 0});Dr.parseEnd=(0,Mo.take)(function(e,r){return r.kind===ta.TokenKind.End?r:void 0});Dr.parseIdentContinue=(0,Mo.apply)((0,Mo.many1)((0,Mo.take)(function(e,r){return r.isIdentContinue?r:void 0})),function(e,r){var t=r[0];return r.length===1?t:(0,ta.identToken)(t.start,r.map(function(n){return n.chars}).join(""))});var wnr=(0,Mo.take)(function(e,r){return!vSe(r)&&r.kind!==ta.TokenKind.End?r:void 0}),SSe=(0,Mo.lazy)(function(){return(0,Mo.flatten)((0,Mo.many)((0,Mo.any)((0,Mo.many1)(wnr),(0,Mo.concat)((0,Mo.tuple)(Dr.parseLeftBracket),SSe,(0,Mo.opt)((0,Mo.tuple)(Dr.parseRightBracket),[])))))});Dr.parseBracketedTokens=(0,Mo.apply)((0,Mo.tuple)(Dr.parseLeftBracket,SSe,Dr.parseCharIndex,(0,Mo.opt)(Dr.parseRightBracket,void 0)),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3];return n.push((0,ta.endToken)(a)),[n,o!==void 0]})});var Fy=T(Lc=>{"use strict";p();Object.defineProperty(Lc,"__esModule",{value:!0});Lc.cellRefMustBeCellRefNode=Lc.withDelim=Lc.addSpan=Lc.addWhitespace=Lc.getSpan=Lc.getNodeSpan=Lc.makeState=Lc.ListSep=void 0;var ySe=fe(),Dnr=Pb(),_Se=kp(),zG=Og(),aX=nf(),Lnr=vh(),iX;(function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"})(iX||(Lc.ListSep=iX={}));function qnr(e,r,t,n,a){var o;return{localeInfo:e,mathpack:r,refStyle:t,lexicalKind:n,origin:a,delim:{delimId:void 0,listSep:iX.Union,stack:(o={},o[zG.DelimId.Paren]=!1,o[zG.DelimId.Brace]=!1,o[zG.DelimId.Bracket]=!1,o)},cellRefMustBeCellRefNode:!1,label:1,spans:[]}}Lc.makeState=qnr;function Gnr(e,r){var t=e.spans[r.label];if(t==null){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given ".concat((0,Dnr.anonymize)(r));(0,_Se.assertFalse)(n)}return t}Lc.getNodeSpan=Gnr;function Bnr(e,r){var t=e.spans[r];return(0,_Se.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",t!=null),t}Lc.getSpan=Bnr;function Unr(e,r){var t=bSe(e,r.start,r.start+r.chars.length,"","");return r.kind===zG.TokenKind.SingleLineComment?(0,aX.singleLineComment)(r.chars,t):(0,aX.multiLineComment)(r.chars,r.isClosed,t)}var Knr=[];function oX(e,r){var t=typeof r=="string"?Knr:r.filter(Lnr.isCommentToken);return[typeof r=="string"?r:r.map(function(n){return n.chars}).join(""),t.length>0?t.map(function(n){return Unr(e,n)}):void 0]}Lc.addWhitespace=oX;function bSe(e,r,t,n,a){var o=e.label;e.label+=1;var u=oX(e,n),s=u[0],l=u[1],c=oX(e,a),d=c[0],f=c[1];return e.spans[o]=(0,aX.formulaSpan)(r,t,s,d,l,f),o}Lc.addSpan=bSe;function CSe(e,r,t){return function(n,a,o,u,s){var l=e(o);return t(n,a,o,function(c,d){return r(o,l),u(c,d)},function(){return r(o,l),s})}}function Vnr(e,r){var t=e.delimId,n=e.listSep;return CSe(function(a){var o,u=a.delim;return a.delim={delimId:t,listSep:n,stack:ySe.__assign(ySe.__assign({},u.stack),(o={},o[t]=!0,o))},u},function(a,o){return a.delim=o},r)}Lc.withDelim=Vnr;function jnr(e){return CSe(function(r){var t=r.cellRefMustBeCellRefNode;return r.cellRefMustBeCellRefNode=!0,t},function(r,t){return r.cellRefMustBeCellRefNode=t},e)}Lc.cellRefMustBeCellRefNode=jnr});var qT=T(qc=>{"use strict";p();var uX;Object.defineProperty(qc,"__esModule",{value:!0});qc.runOperatorPrecedenceParser=qc.isWSFNode=qc.maybeWSFTerm=qc.structRefTerm=qc.fieldRefTerm=qc.argsTerm=qc.lambdaArgsTerm=qc.TermKind=void 0;var Wnr=fe(),rx=Pb(),Ny=kp(),an=nf(),yo=Nb(),nu=Og(),St=k0(),Si=Fy(),wT=F0(),xSe=vh(),sX=hm(),ISe=WM(),Hnr=dh(),tc;(function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"})(tc||(qc.TermKind=tc={}));function znr(e,r,t,n){return{kind:tc.LambdaArgsTerm,nodes:e,isClosed:r,start:t,end:n}}qc.lambdaArgsTerm=znr;function Qnr(e,r,t,n){return{kind:tc.ArgsTerm,nodes:e,isClosed:r,start:t,end:n}}qc.argsTerm=Qnr;function wSe(e,r,t,n){return{kind:tc.FieldRefTerm,hasDotPreSpace:e,rhs:r,start:t,end:n}}qc.fieldRefTerm=wSe;function Xnr(e,r,t){return{kind:tc.StructRefTerm,rhs:e,start:r,end:t}}qc.structRefTerm=Xnr;function Ynr(e,r){return{kind:tc.MaybeWSFTerm,node:e,whole:r}}qc.maybeWSFTerm=Ynr;function QG(e){return e.kind!==nu.TokenKind.Operator&&e.kind!==nu.TokenKind.Sep&&e.kind!==nu.TokenKind.End&&e.kind!==nu.TokenKind.Spaces&&e.kind!==nu.TokenKind.SingleLineComment&&e.kind!==nu.TokenKind.MultiLineComment&&!(e.kind in tc)}function XG(e){return e.kind===nu.TokenKind.Spaces||e.kind===nu.TokenKind.SingleLineComment||e.kind===nu.TokenKind.MultiLineComment}function DSe(e,r){return r=r.kind===tc.MaybeWSFTerm?r.node:r,QG(r)?(0,Si.getNodeSpan)(e,r).start:r.start}var DT=(0,St.many)((0,St.take)(function(e,r){return XG(r)?r:void 0})),Jnr=(0,St.many1)((0,St.take)(function(e,r){return XG(r)?r:void 0})),Znr=(0,St.peek)(function(e,r){return r}),hh=function(r,t,n,a,o){var u=r[t];if(u==null){var s="calc.parse.pStart: internal error: expected term at ".concat(t," in ").concat((0,rx.anonymize)(r));return(0,Ny.assertFalse)(s)}return a(DSe(n,u),t)};function LT(e){return(0,St.apply)((0,St.tuple)(DT,hh,(0,St.take)(e),hh,DT),function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3],s=t[4];return(0,an.operatorNode)(o,(0,Si.addSpan)(r,a,u,n,s))})}function LSe(e){return(0,St.apply)((0,St.tuple)(DT,hh,(0,St.take)(e),hh),function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3];return(0,an.operatorNode)(o,(0,Si.addSpan)(r,a,u,n,""))})}function qSe(e){return(0,St.apply)((0,St.tuple)(hh,(0,St.take)(e),hh,DT),function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3];return(0,an.operatorNode)(a,(0,Si.addSpan)(r,n,o,"",u))})}var $nr=LT(function(e,r){return r.kind===nu.TokenKind.Operator&&(r.value===yo.OperatorId.Add||r.value===yo.OperatorId.Sub)?r.value:void 0}),GSe=qSe(function(e,r){if(r.kind===nu.TokenKind.Operator){if(r.value===yo.OperatorId.Add)return yo.OperatorId.Pos;if(r.value===yo.OperatorId.Sub)return yo.OperatorId.Neg}}),cX=qSe(function(e,r){return r.kind===nu.TokenKind.Operator&&r.value===yo.OperatorId.At?r.value:void 0}),ear=LSe(function(e,r){return r.kind===nu.TokenKind.Operator&&r.value===yo.OperatorId.Pound?r.value:void 0}),rar=(0,St.take)(function(e,r){return r.kind===tc.StructRefTerm?r:void 0}),tar=LT(function(e,r){return r.kind===nu.TokenKind.Operator&&(r.value===yo.OperatorId.Mul||r.value===yo.OperatorId.Div)?r.value:void 0}),nar=LT(function(e,r){return r.kind===nu.TokenKind.Operator&&r.value===yo.OperatorId.Pow?r.value:void 0}),aar=LSe(function(e,r){return r.kind===nu.TokenKind.Operator&&r.value===yo.OperatorId.Percent?r.value:void 0}),iar=LT(function(e,r){return r.kind===nu.TokenKind.Operator&&r.value===yo.OperatorId.Concat?r.value:void 0}),oar=LT(function(e,r){return r.kind===nu.TokenKind.Operator&&r.value>=yo.OperatorId.Eq&&r.value<=yo.OperatorId.Ge?r.value:void 0}),uar=LT(function(e,r){return r.kind===nu.TokenKind.Operator&&r.value===yo.OperatorId.Range?r.value:void 0}),sar=LT(function(e,r){return r.kind===nu.TokenKind.Operator&&r.value===yo.OperatorId.Union?r.value:void 0}),lar=(0,St.applyTake)((0,St.tuple)(Jnr,Znr),function(e,r){var t=r[0],n=r[1];if(n.kind!==nu.TokenKind.End&&(n.kind!==nu.TokenKind.Operator||n.value===yo.OperatorId.At)&&!(n.kind===nu.TokenKind.Sep&&(0,xSe.isDotSepToken)(n))){if(!(t.length===1&&t[0].kind===nu.TokenKind.Spaces))return t;var a=DSe(e,n),o=(0,Si.addSpan)(e,a,a,t[0].chars,"");return(0,an.operatorNode)(yo.OperatorId.Isect,o)}}),BSe=(0,St.take)(function(e,r){return r.kind===nu.TokenKind.Sep&&(0,xSe.isDotSepToken)(r)?r:void 0}),car=(0,St.take)(function(e,r){return r.kind===tc.ArgsTerm?r:void 0}),dar=(0,St.take)(function(e,r){return r.kind===tc.LambdaArgsTerm?r:void 0}),far=(0,St.take)(function(e,r){return r.kind===tc.ArgsTerm||r.kind===tc.FieldRefTerm?r:void 0}),par=(uX={},uX[yo.WorksheetFuncId.LETREC]=ISe.FeatureName.CalcLetRecFunction,uX);function dX(e,r){if(r.kind===tc.MaybeWSFTerm&&r.whole!==void 0){var t=(0,wT.getWorksheetFuncId)(e,r.whole);if(t===void 0||((0,Ny.assertTrue)("calc.parse.parseWSFName: unexpected UDF",t!==yo.WorksheetFuncId._UDF),(0,yo.getWorksheetFuncType)(t).flags&Hnr.FunctionFlags.Internal))return;var n=par[t];return n!==void 0&&!(0,ISe.isFeatureEnabled)(n)?void 0:(0,an.wsfNode)(t,r.whole,r.node.label)}}qc.isWSFNode=dX;var mar=(0,St.take)(function(e,r){return dX(e.localeInfo,r)}),gar=(0,St.take)(function(e,r){var t=dX(e.localeInfo,r);return(t==null?void 0:t.id)===yo.WorksheetFuncId.LAMBDA?t:void 0});function har(e,r){return!!((0,wT.isUnqualifiedNameNode)(r)||e===an.RefStyle.A1&&r.kind===an.NodeKind.CellRef&&r.qualifier===void 0&&r.ref.kind===an.CellRefKind.Single&&r.ref.col.kind===an.PosKind.Rel&&r.ref.row.kind===an.PosKind.Rel)}var TSe=(0,St.apply)((0,St.tuple)(gar,dar),function(e,r){for(var t=r[0],n=r[1],a=(0,Si.getNodeSpan)(e,t).start,o=n.nodes,u=t.id,s=[],l,c=[],d=0;d<o.length;d+=1){var f=o[d];f.kind===an.NodeKind.Param?s.push((0,an.lambdaParam)((0,an.indexedArg)(f,d))):d===o.length-1?l=(0,an.indexedArg)(f,d):c.push((0,an.indexedArg)(f,d))}var m=(0,Si.addSpan)(e,a,n.end,"","");return(0,an.lambdaNode)(t,s,l,c,n.isClosed,m)}),RSe=(0,St.apply)((0,St.tuple)(mar,car),function(e,r){var t=r[0],n=r[1],a=(0,Si.getNodeSpan)(e,t).start,o=n.nodes;switch(t.id){case yo.WorksheetFuncId.LET:case yo.WorksheetFuncId.LETREC:{for(var u=t.id,s=[],l=[],c=void 0,d=0;d<o.length;d+=1){var f=o[d];if(d===o.length-1){c=(0,an.indexedArg)(f,d);continue}if(d+1<o.length&&(0,wT.isUnqualifiedNameNode)(f)&&!(d+3<o.length&&!har(e.refStyle,o[d+2])&&(0,wT.isUnqualifiedNameNode)(o[d+1]))){s.push((0,an.letVar)((0,an.indexedArg)((0,an.varNode)((0,an.identNode)(f.whole,f.parts.label),f.label),d),(0,an.indexedArg)(o[d+1],d+1))),d+=1;continue}l.push((0,an.indexedArg)(f,d))}var m=(0,Si.addSpan)(e,a,n.end,"","");return(0,an.letNode)(t,s,c,l,n.isClosed,m)}case yo.WorksheetFuncId.LAMBDA:return(0,Ny.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}return lX(e,t,o,n.isClosed,a,n.end)});function USe(e,r,t){return(0,St.apply)((0,St.tuple)((0,St.many)(e),r),function(n,a){var o=a[0],u=a[1];return o.reduceRight(t(n),u)})}function Sh(e,r,t){return(0,St.apply)((0,St.tuple)(e,(0,St.many)(r)),function(n,a){var o=a[0],u=a[1];return u.reduce(t(n),o)})}var Sar=function(r){return Array.isArray(r)};function xb(e){return function(r,t){var n,a=t[0],o=t[1];if(Sar(a)){var u=(0,Si.getNodeSpan)(e,r);(0,Ny.assertTrue)("calc.parse.makeAppNodeInfix",u.post.length===0),n=(0,Si.addWhitespace)(e,a),u.post=n[0],u.postComments=n[1];var s=(0,Si.getNodeSpan)(e,o),l=(0,Si.addSpan)(e,u.start,s.end,"","");return(0,an.badSequenceNode)(an.BadType.Unexpected,[r,o],l)}var c=(0,Si.getNodeSpan)(e,r).start,d=(0,Si.getNodeSpan)(e,o).end,f=(0,Si.addSpan)(e,c,d,"","");return(0,an.appNode)(a,[r,o],!0,f)}}function lX(e,r,t,n,a,o){var u=(0,Si.addSpan)(e,a,o,"","");return(0,an.appNode)(r,t,n,u)}function fX(e){return function(r,t){var n=(0,Si.getNodeSpan)(e,r).start;switch(t.kind){case tc.ArgsTerm:return lX(e,r,t.nodes,t.isClosed,n,t.end);case tc.FieldRefTerm:{var a=(0,Si.addSpan)(e,n,t.end,"",""),o=(0,Si.getNodeSpan)(e,t.rhs),u=o.start,s=o.end,l=o.pre;if((0,wT.isNumberLiteralNode)(r)){var c=(0,Si.addSpan)(e,u,u,"",""),d=(0,an.missingNode)("",c),f=t.rhs.label,m=(0,Si.addSpan)(e,u,s,"",""),v=!1,h=(0,an.fieldRef)(t.rhs.field,t.rhs.isBracketed,t.rhs.isClosed,v,m);return(0,an.badSequenceNode)(an.BadType.FieldRef,[r,(0,an.fieldRefNode)(d,h,f)],a)}var y=!t.rhs.isBracketed&&(0,wT.shouldFieldRefBeBracketed)(r,t.rhs,l),_=(0,an.fieldRef)(t.rhs.field,t.rhs.isBracketed,t.rhs.isClosed,y,t.rhs.label);return(0,an.fieldRefNode)(r,_,a)}case tc.StructRefTerm:{var a=(0,Si.addSpan)(e,n,t.end,"","");switch(r.kind){case an.NodeKind.Name:return(0,an.structRefNode)(r,t.rhs,a);case an.NodeKind.Missing:return(0,an.structRefNode)(void 0,t.rhs,a)}return(0,an.badSequenceNode)(an.BadType.StructRef,[r,(0,an.structRefNode)(void 0,t.rhs,(0,Si.addSpan)(e,t.start,t.end,"",""))],a)}case an.NodeKind.Operator:return lX(e,t,[r],!0,n,(0,Si.getNodeSpan)(e,t).end)}}}function KSe(e){var r=!0;return function(t,n){var a=(0,Si.getNodeSpan)(e,n).start,o=(0,Si.getNodeSpan)(e,t).end,u=(0,Si.addSpan)(e,a,o,"","");if((n.id===yo.OperatorId.Pos||n.id===yo.OperatorId.Neg)&&r&&(r=!1,(0,wT.isNumberLiteralNode)(t)&&(0,Si.getNodeSpan)(e,n).post==="")){var s=n.id===yo.OperatorId.Pos?t.oper:e.mathpack.neg(t.oper);return(0,an.literalNode)(s,!0,u)}return(0,an.appNode)(n,[t],!0,u)}}var ESe=(0,St.take)(function(e,r){return r.kind===tc.MaybeWSFTerm?r.node:QG(r)?r:void 0}),yar=(0,St.apply)((0,St.tuple)(DT,BSe,hh,DT),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3];return(0,an.badCharsNode)(an.BadType.Unexpected,n.chars,(0,Si.addSpan)(e,n.start,a,t,o))}),_ar=(0,St.apply)((0,St.tuple)(hh,DT,BSe,hh),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=!1,s=(0,Si.addSpan)(e,o,o,"",""),l=(0,Si.addSpan)(e,a.start,o,n,""),c=(0,an.fieldRef)((0,an.missingNode)("",s),!1,!0,u,l);return wSe(n.length>0,c,t,o)}),bar=(0,St.lazy)(function(){return(0,St.apply)((0,St.tuple)(hh,(0,St.many)((0,St.any)(TSe,RSe,ESe,yar),(0,St.any)(TSe,RSe,ESe,(0,St.right)((0,St.succeeds)(cX),YG))),hh),function(e,r){var t=r[0],n=r[1],a=r[2];if(n.length===1)return n[0];var o=(0,Si.addSpan)(e,t,a,"","");return n.length===0?(0,an.missingNode)("",o):(0,an.badSequenceNode)(an.BadType.Unexpected,n,o)})}),Car=(0,St.lazy)(function(){return(0,St.any)((0,St.right)((0,St.succeeds)(cX),YG),(0,St.right)((0,St.succeeds)(GSe),VSe),bar)}),PSe=Sh(Car,(0,St.any)(ear,rar),fX),ASe=Sh(PSe,(0,St.tuple)(uar,PSe),xb),Tar=Sh(ASe,(0,St.tuple)(lar,ASe),xb),Rar=Sh(Tar,(0,St.any)(far,_ar),fX),YG=USe(cX,Rar,KSe),Ear=Sh(YG,(0,St.tuple)(sar,YG),xb),VSe=USe(GSe,Ear,KSe),FSe=Sh(VSe,aar,fX),NSe=Sh(FSe,(0,St.tuple)(nar,FSe),xb),OSe=Sh(NSe,(0,St.tuple)(tar,NSe),xb),kSe=Sh(OSe,(0,St.tuple)($nr,OSe),xb),MSe=Sh(kSe,(0,St.tuple)(iar,kSe),xb),Par=Sh(MSe,(0,St.tuple)(oar,MSe),xb);function Aar(e,r){var t=r.length-1;if(t<1){var n="calc.parse.runTermParser: internal error: expected at least 1 term";return(0,Ny.assertFalse)(n)}if(r[t].kind!==nu.TokenKind.End){var n="calc.parse.runTermParser: internal error: array[n].kind !== End in ".concat((0,rx.anonymize)(r));return(0,Ny.assertFalse)(n)}if(t===1&&QG(r[0]))return r[0];if(XG(r[0])){var n="calc.parse.runTermParser: internal error: array[0].kind === Spaces/comment in ".concat((0,rx.anonymize)(r));return(0,Ny.assertFalse)(n)}if(XG(r[t-1])){var n="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces/comment in ".concat((0,rx.anonymize)(r));return(0,Ny.assertFalse)(n)}for(;;){var a=(0,St.runParser)(Par,r,0,e);if((0,sX.isSuccess)(a)&&a.value.index>=t)return a.value.output;if(!(0,sX.isSuccess)(a)||a.value.index===0||a.value.index===1&&QG(r[0])){var o=(0,sX.isSuccess)(a)?a.value.index:0,n="calc.parse.runTermParser: internal error: consumed ".concat(o," out of ").concat(t," in ").concat((0,rx.anonymize)(r));return(0,Ny.assertFalse)(n)}r=Wnr.__spreadArray([a.value.output],r.slice(a.value.index),!0),t=r.length-1}}qc.runOperatorPrecedenceParser=Aar});var JG=T(QA=>{"use strict";p();Object.defineProperty(QA,"__esModule",{value:!0});QA.parseFieldRef=QA.isUnbracketedField=void 0;var Far=fe(),GT=nf(),mX=Og(),ym=k0(),Nar=qT(),tx=Fy(),Oy=vh(),Oar=hm(),pX=xT(),gX=Far.__importStar(KA()),kar=gX.codePointQuestionMark,jSe=gX.codePointBackslash,Mar=gX.codePointUnderscore,WSe=255;function HSe(e,r){function t(o){return o!==kar&&o!==jSe&&e.isIdentContinue(o)}function n(o){return o!==Mar&&o!==jSe&&(e.isIdentStart(o)||e.isNumeral(o))}if(r.length===0)return!1;var a=(0,pX.stringCodePointAt)(r,0);return n(a)?(0,pX.codePointIterator)(r,(0,pX.numCodeUnits)(a)).every(t):!1}QA.isUnbracketedField=HSe;var xar=(0,ym.take)(function(e,r){return!(0,Oy.isBracketToken)(r)&&r.kind!==mX.TokenKind.Escape&&r.kind!==mX.TokenKind.End?r.chars:void 0}),Iar=(0,ym.take)(function(e,r){return r.kind===mX.TokenKind.Ident&&(r.chars===e.localeInfo.leftBracket||r.chars===e.localeInfo.rightBracket||r.chars==="'")?r.chars:void 0}),war=(0,ym.any)(xar,(0,ym.right)(Oy.parseEscape,Iar)),Dar=(0,ym.apply)((0,ym.tuple)((0,ym.many)(war),Oy.parseEnd),function(e,r){var t=r[0],n=r[1];return t.join("")}),Lar=(0,ym.applyTake)(Oy.parseBracketedTokens,function(e,r){var t=r[0],n=r[1],a=(0,ym.runParser)(Dar,t,0,e);if((0,Oar.isSuccess)(a)){var o=t[0].start,u=t[t.length-1].start,s=a.value.output;if(s.length>WSe){var l=t.map(function(c){return c.chars}).join("");return[(0,GT.badCharsNode)(GT.BadType.FieldName,l,(0,tx.addSpan)(e,o,u,"","")),!1,!0]}return[(0,GT.identNode)(s,(0,tx.addSpan)(e,o,u,"","")),!0,n]}}),qar=(0,ym.apply)(Oy.parseIdentContinue,function(e,r){var t=r.start,n=r.start+r.chars.length;return!HSe(e.localeInfo,r.chars)||r.chars.length>WSe?[(0,GT.badCharsNode)(GT.BadType.FieldName,r.chars,(0,tx.addSpan)(e,t,n,"","")),!1,!0]:[(0,GT.identNode)(r.chars,(0,tx.addSpan)(e,t,n,"","")),!1,!0]});QA.parseFieldRef=(0,ym.apply)((0,ym.tuple)(Oy.parseCharIndex,Oy.parseWhitespace,Oy.parseDotSepToken,(0,ym.any)(qar,Lar),Oy.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=o[0],s=o[1],l=o[2],c=r[4],d=(0,tx.addSpan)(e,a.start,c,n,""),f=!1,m=(0,GT.fieldRef)(u,s,l,f,d);return(0,Nar.fieldRefTerm)(n.length>0,m,t,c)})});var SX=T(ZG=>{"use strict";p();Object.defineProperty(ZG,"__esModule",{value:!0});ZG.parseQualifier=void 0;var Gar=fe(),yh=nf(),Dn=k0(),M0=Fy(),Ki=vh(),ky=Og(),Bar=Gar.__importStar(KA()),Uar=dh(),JSe=QQ(),zSe=kp();function ZSe(e){return e.kind===ky.TokenKind.Literal&&e.oper.kind===Uar.OperKind.Boolean}function Kar(e){return e.kind===ky.TokenKind.Literal&&(0,ky.isNumberLikeOper)(e.oper)}var Var=Bar.codePointFullStop,vX=(0,Dn.opt)((0,Dn.takePeek)(function(e,r,t){return r.kind===ky.TokenKind.Spaces&&!(0,Ki.isWhitespaceToken)(t)?r.chars:void 0}),""),jar=(0,Dn.take)(function(e,r){return r.isIdentContinue&&!ZSe(r)&&r.chars.length>0&&r.chars.charCodeAt(0)!==Var?r.chars:void 0}),$Se=(0,Dn.take)(function(e,r){return r.isIdentContinue||(0,Ki.isDotSepToken)(r)?r.chars:void 0}),QSe=(0,Dn.apply)((0,Dn.many1)(jar,$Se),function(e,r){return r.join("")}),XSe=(0,Dn.take)(function(e,r){return r.kind===ky.TokenKind.Ident?r.chars:void 0}),hX=function(r,t){var n;return((n=t.path)!==null&&n!==void 0?n:"")+r.leftBracket+t.document+r.rightBracket};function eye(e,r,t,n,a,o){var u,s;if(r==null)n==null?(u=(0,yh.identQualifier)(t,a,o),s=t):(u=(0,yh.sheetRangeQualifier)(t,n,void 0,a,o),s="".concat(t,":").concat(n));else{var l=hX(e.localeInfo,r);n==null?(u=(0,yh.sheetQualifier)(t,r,a,o),s="".concat(l).concat(t)):(u=(0,yh.sheetRangeQualifier)(t,n,r,a,o),s="".concat(l).concat(t,":").concat(n))}return[u,a?(0,JSe.quoteQualifier)(s):s]}var YSe=(0,Dn.take)(function(e,r){return r.kind===ky.TokenKind.Ident||(0,Ki.isRangeOpToken)(r)?r.chars:void 0}),rye=(0,Dn.apply)((0,Dn.tuple)(Ki.parseCharIndex,(0,Dn.many)(YSe),Ki.parseLeftBracket,(0,Dn.many1)(YSe),Ki.parseRightBracket,Ki.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4],s=r[5],l=n.join(""),c=o.join("");return(0,yh.documentQualifier)(c,l!==""?l:void 0,!0,(0,M0.addSpan)(e,t,s,"",""))}),tye=(0,Dn.apply)((0,Dn.tuple)(Ki.parseCharIndex,Ki.parseLeftBracket,(0,Dn.many1)($Se),Ki.parseRightBracket,Ki.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4],s=a.join("");return(0,yh.documentQualifier)(s,void 0,!1,(0,M0.addSpan)(e,t,u,"",""))}),War=(0,Dn.apply)((0,Dn.tuple)(Ki.parseCharIndex,(0,Dn.opt)(tye,void 0),QSe,(0,Dn.opt)((0,Dn.right)(Ki.parseRangeOp,QSe),void 0),Ki.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4];return eye(e,n,a,o,!1,(0,M0.addSpan)(e,t,u,"",""))}),Har=(0,Dn.apply)((0,Dn.tuple)(Ki.parseLeftSQuote,(0,Dn.opt)(rye,void 0),XSe,(0,Dn.opt)((0,Dn.right)(Ki.parseRangeOp,XSe),void 0),Ki.parseRightSQuote,Ki.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4],s=r[5];return eye(e,n,a,o,!0,(0,M0.addSpan)(e,t.start,s,"",""))}),zar=(0,Dn.apply)(tye,function(e,r){return[r,hX(e.localeInfo,r)]}),Qar=(0,Dn.apply)((0,Dn.tuple)(Ki.parseLeftSQuote,rye,Ki.parseRightSQuote,Ki.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3];return[(0,yh.documentQualifier)(n.document,n.path,!0,(0,M0.addSpan)(e,t.start,o,"","")),(0,JSe.quoteQualifier)(hX(e.localeInfo,n))]}),Xar=(0,Dn.take)(function(e,r){return r.kind===ky.TokenKind.End||r.kind===ky.TokenKind.Right&&r.value===ky.DelimId.SQuote?void 0:r.chars}),Yar=(0,Dn.apply)((0,Dn.tuple)(Ki.parseLeftSQuote,(0,Dn.many)(Xar),(0,Dn.opt)((0,Dn.tuple)(Ki.parseRightSQuote,(0,Dn.opt)((0,Dn.tuple)(Ki.parseQualSep,vX),[void 0,""])),[void 0,[void 0,""]]),Ki.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=a[0],u=a[1],s=u[0],l=u[1],c=r[3],d=o!==void 0,f=s!==void 0,m="'".concat(n.join("")).concat(d?"'":"").concat(f?"!":""),v=(0,M0.addSpan)(e,t.start,c-l.length,"",l);return[(0,yh.badQualifier)(m,!0,d,f,v),m]}),Jar=(0,Dn.takePeek)(function(e,r,t){if((0,Ki.isRefErrorToken)(r)){var n=(0,M0.addSpan)(e,r.start,t.start,"","");return[(0,yh.errorQualifier)(n),r.chars]}}),Zar=(0,Dn.peek)(function(e,r){var t=(0,M0.addSpan)(e,r.start,r.start,"","");return[(0,yh.relativeQualifier)(t),""]}),$ar=(0,Dn.apply)((0,Dn.tuple)((0,Dn.any)(War,Har,zar,Qar,Zar),Ki.parseQualSep,vX),function(e,r){var t=r[0],n=t[0],a=t[1],o=r[1],u=r[2],s=(0,M0.getNodeSpan)(e,n);return s.end+=1,(0,zSe.assertTrue)("calc.parse.parseGoodQualifier",s.end===o.start+o.chars.length),(0,zSe.assertTrue)("calc.parse.parseGoodQualifier",s.post.length===0),s.post=u,[n,"".concat(a,"!")]}),eir=(0,Dn.take)(function(e,r){return r.isIdentContinue||(0,Ki.isDotSepToken)(r)||ZSe(r)||Kar(r)?r.chars:void 0}),rir=(0,Dn.apply)((0,Dn.tuple)(Ki.parseCharIndex,(0,Dn.many)(eir),Ki.parseQualSep,Ki.parseCharIndex,vX),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4],s="".concat(n.join(""),"!"),l=(0,M0.addSpan)(e,t,o,"",u);return[(0,yh.badQualifier)(s,!1,!0,!0,l),s]});ZG.parseQualifier=(0,Dn.any)(Jar,$ar,rir,Yar)});var PX=T(x0=>{"use strict";p();Object.defineProperty(x0,"__esModule",{value:!0});x0.parseRef=x0.parseUnqualBadRef=x0.isCompleteCellRefToken=void 0;var nye=fe(),tir=Pb(),eB=kp(),yt=nf(),_X=fh(),XA=ZM(),Gc=Og(),Fa=k0(),nx=qT(),ni=Fy(),nir=F0(),_m=vh(),air=SX(),iir=dh(),oye=xT(),oir=JG();function bX(e,r){return e.refStyle===r.refStyle&&!r.isBadLocale&&r.row!==XA.SpecialPos.A1BadDollar&&r.col!==XA.SpecialPos.A1BadDollar}function uye(e){return e.refStyle===yt.RefStyle.R1C1||typeof e.row=="object"&&typeof e.col=="object"}function uir(e){return e.refStyle===yt.RefStyle.A1&&e.row==null&&typeof e.col=="object"&&e.col.kind===yt.PosKind.Rel}function sir(e,r){return r.refStyle===yt.RefStyle.A1&&e.refStyle===yt.RefStyle.A1&&r.isIdentContinue||r.refStyle===yt.RefStyle.R1C1&&(0,XA.isR1C1IdentStart)(r.row,r.col)}function CX(e,r){return r.kind===Gc.TokenKind.CellRef&&bX(e,r)&&uye(r)}x0.isCompleteCellRefToken=CX;var lir=(0,yt.pos)(yt.PosKind.Rel,0);function $G(e){return e===XA.SpecialPos.RCNoNum?lir:e}function rB(e,r){if(e.row!==XA.SpecialPos.A1BadDollar&&e.col!==XA.SpecialPos.A1BadDollar){var t=e.refStyle===yt.RefStyle.R1C1&&!e.isIdentContinue;if(e.row!=null&&e.col!=null)return(0,yt.cellRefSingle)($G(e.row),$G(e.col),t,r);if(e.row!=null){var n=$G(e.row);return(0,yt.cellRefRow)(n,n,t,r)}if(e.col!=null){var a=$G(e.col);return(0,yt.cellRefCol)(a,a,t,r)}}var o="calc.parse.cellRefToken2cellRef: bad token ".concat((0,tir.anonymize)(e));return(0,eB.assertFalse)(o)}function TX(e,r){return r.isIdentContinue&&e.localeInfo.isIdentStart((0,oye.stringCodePointAt)(r.chars,0))}var cir=(0,Fa.take)(function(e,r){return CX(e,r)&&!TX(e,r)||(0,_m.isRefErrorToken)(r)?r:void 0}),aye=(0,Fa.take)(function(e,r){return CX(e,r)&&TX(e,r)?r:void 0}),dir=(0,Fa.apply)((0,Fa.tuple)((0,Fa.any)(cir,(0,Fa.withState)(function(e){return e.cellRefMustBeCellRefNode?aye:(0,Fa.left)(aye,(0,Fa.fails)((0,Fa.any)(_m.parseIdentContinue,_m.parseDotSepTokenNotFollowedByLeftBracket)))})),_m.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=t.kind===Gc.TokenKind.CellRef?rB(t,(0,ni.addSpan)(e,t.start,n,"","")):(0,yt.cellRefError)((0,ni.addSpan)(e,t.start,n,"","")),o=t.kind===Gc.TokenKind.CellRef?t.chars:void 0;return(0,nx.maybeWSFTerm)((0,yt.cellRefNode)(a,void 0,(0,ni.addSpan)(e,t.start,n,"","")),o)});function fir(e,r,t){return t.kind===Gc.TokenKind.Left&&t.value===Gc.DelimId.Paren&&r.isIdentContinue&&(0,nir.getWorksheetFuncId)(e.localeInfo,r.chars)!=null}var iye=(0,Fa.takePeek)(function(e,r,t){return r.kind===Gc.TokenKind.CellRef&&bX(e,r)&&!fir(e,r,t)&&!t.isIdentContinue?[r,t.start]:void 0}),pir=(0,Fa.bind)((0,Fa.tuple)(iye,_m.parseSpacesOnly,_m.parseRangeOp,_m.parseSpacesOnly,iye),function(e,r){var t=r[0],n=t[0],a=t[1],o=r[1],u=r[2],s=r[3],l=r[4],c=l[0],d=l[1],f=(0,ni.addSpan)(e,n.start,a,"",o),m=(0,ni.addSpan)(e,c.start,d,s,""),v=rB(n,f),h=rB(c,m),y=void 0;if(v.kind===yt.CellRefKind.Single&&h.kind===yt.CellRefKind.Single){var _=(0,ni.addSpan)(e,n.start,d,"","");y=(0,yt.cellRefRange)(v,h,_)}else if(o.length===0&&s.length===0){if(v.kind===yt.CellRefKind.Row&&h.kind===yt.CellRefKind.Row){var E=v.isBracketed||h.isBracketed,_=(0,ni.addSpan)(e,n.start,d,"","");y=(0,yt.cellRefRow)(v.row1,h.row1,E,_)}else if(v.kind===yt.CellRefKind.Col&&h.kind===yt.CellRefKind.Col){var E=v.isBracketed||h.isBracketed,_=(0,ni.addSpan)(e,n.start,d,"","");y=(0,yt.cellRefCol)(v.col1,h.col1,E,_)}}if(y==null)return(0,Fa.parseFail)();var N=(0,nx.maybeWSFTerm)((0,yt.cellRefNode)(y,void 0,(0,ni.addSpan)(e,n.start,d,"","")),void 0);return n.isIdentContinue&&c.isIdentContinue?(0,Fa.peek)(function(k,q){return q.kind===Gc.TokenKind.Sep&&q.value===Gc.SepId.Qual?void 0:N}):(0,Fa.parseSucceed)(N)}),RX=(0,Fa.any)(pir,dir);x0.parseUnqualBadRef=(0,Fa.apply)((0,Fa.take)(function(e,r){return r.kind===Gc.TokenKind.CellRef?r:void 0}),function(e,r){var t=r.start+r.chars.length,n=r.refStyle===yt.RefStyle.R1C1&&!r.isIdentContinue;return(0,nx.maybeWSFTerm)((0,yt.cellRefNode)((0,yt.cellRefBad)(r.chars,n,(0,ni.addSpan)(e,r.start,t,"","")),void 0,(0,ni.addSpan)(e,r.start,t,"","")),r.chars)});function mir(e,r,t){return t.length===0||r.length===1&&r[0].kind===Gc.TokenKind.Literal||t.some(function(n,a){return a%2===0?n.kind!==Gc.TokenKind.Sep:n.kind===Gc.TokenKind.Sep||!(0,oir.isUnbracketedField)(e.localeInfo,n.chars)})}var gir="_xlpm",vir="_xleta";function hir(e,r){var t,n,a,o,u,s,l,c,d,f=r[0],m=r[1],v=r[2],h=r[3],y=f[0],_=f.length===1&&((t=m[0])===null||t===void 0?void 0:t.kind)===Gc.TokenKind.Sep,E=y.kind!==Gc.TokenKind.CellRef||uir(y)||sir(e,y)&&_;if(v||mir(e,f,m)){var N=nye.__spreadArray(nye.__spreadArray([],f,!0),m,!0).map(function(W){return W.chars}).join(""),k=(0,ni.addSpan)(e,y.start,h,"",""),q=(0,ni.addSpan)(e,y.start,h,"",""),V=(0,yt.identNamePart)(N,E,k,q),I=(0,yt.nameNode)(V,void 0,(0,ni.addSpan)(e,y.start,h,"",""));return(0,nx.maybeWSFTerm)(I,I.whole)}var M=E,B,U=0,j=(a=(n=m[U])===null||n===void 0?void 0:n.start)!==null&&a!==void 0?a:h,X=(0,ni.addSpan)(e,y.start,j,"",""),ee=(0,ni.addSpan)(e,y.start,j,"","");if(f.length===1&&y.kind===Gc.TokenKind.CellRef)if(!bX(e,y))M=!1,B=(0,yt.identNamePart)(y.chars,M,X,ee);else if(!uye(y))B=(0,yt.identNamePart)(y.chars,M,X,ee);else{var re=(0,ni.addSpan)(e,y.start,j,"",""),Z=rB(y,re);B=(0,yt.cellRefNamePart)(Z,y.chars,X,ee)}else{var J=f.map(function(W){return W.chars}).join("");(e.localeInfo.stringCompareCI(J,gir)===0||e.localeInfo.stringCompareCI(J,vir)===0)&&U+1<m.length&&(J+="."+m[U+1].chars,U+=2,j=(u=(o=m[U])===null||o===void 0?void 0:o.start)!==null&&u!==void 0?u:h,X=(0,ni.addSpan)(e,y.start,j,"",""),ee=(0,ni.addSpan)(e,y.start,j,"","")),B=(0,yt.identNamePart)(J,M,X,ee)}for(var C=!1,S=B;U+1<m.length;U+=2){var b=m[U],O=m[U+1],w=(l=(s=m[U+2])===null||s===void 0?void 0:s.start)!==null&&l!==void 0?l:h;S=(0,yt.fieldRefNamePart)(S,(0,yt.fieldRef)((0,yt.identNode)(O.chars,(0,ni.addSpan)(e,O.start,w,"","")),!1,!0,C,(0,ni.addSpan)(e,b.start,w,"","")),U+2>=m.length?E:M,(0,ni.addSpan)(e,y.start,w,"",""),(0,ni.addSpan)(e,y.start,w,"",""))}if(U<m.length){var b=m[U],w=(d=(c=m[U+1])===null||c===void 0?void 0:c.start)!==null&&d!==void 0?d:h,D=(0,yt.fieldRef)((0,yt.missingNode)("",(0,ni.addSpan)(e,w,w,"","")),!1,!0,C,(0,ni.addSpan)(e,b.start,w,"",""));S=(0,yt.fieldRefNamePart)(S,D,E,(0,ni.addSpan)(e,y.start,w,"",""),(0,ni.addSpan)(e,y.start,w,"","")),U+=1}(0,eB.assertTrue)("calc.parse.pUnqualName: i == tailTokens",U===m.length),S.kind===yt.NamePartKind.CellRefNamePart&&(0,eB.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");var Q=(0,yt.nameNode)(S,void 0,(0,ni.addSpan)(e,y.start,h,"",""));return(0,nx.maybeWSFTerm)(Q,Q.whole)}var Sir=(0,Fa.take)(function(e,r){return r.kind===Gc.TokenKind.Ident&&e.localeInfo.isIdentStart((0,oye.stringCodePointAt)(r.chars,0))||r.kind===Gc.TokenKind.CellRef&&TX(e,r)?r:void 0}),yir=(0,Fa.take)(function(e,r){return r.kind===Gc.TokenKind.Literal&&r.oper.kind===iir.OperKind.Boolean?r:void 0}),_ir=(0,Fa.any)(Sir,(0,Fa.left)(yir,(0,Fa.succeeds)(_m.parseDotSepTokenNotFollowedByLeftBracket))),bir=(0,Fa.peek)(function(e,r){return(0,_m.isLeftBracketToken)(r)}),Cir=(0,Fa.tuple)((0,Fa.many1)(_ir,_m.parseIdentContinue),(0,Fa.many)((0,Fa.any)(_m.parseIdentContinue,_m.parseDotSepTokenNotFollowedByLeftBracket)),bir,_m.parseCharIndex),EX=(0,Fa.apply)(Cir,hir),yX=(0,Fa.opt)((0,Fa.any)(RX,EX,x0.parseUnqualBadRef),{node:void 0}),Tir=(0,Fa.any)(RX,(0,Fa.right)((0,Fa.fails)(EX),x0.parseUnqualBadRef));function Rir(e,r,t){for(var n=r;;){var a=(0,ni.getSpan)(e,n.qualifiedLabel);if(a.start=t,n.kind===yt.NamePartKind.FieldRefNamePart)n=n.lhs;else break}return r}var Eir=(0,Fa.bind)(air.parseQualifier,function(e,r){var t=r[0],n=r[1];return(0,Fa.apply)(t.kind===yt.QualifierKind.SheetRange?(0,ni.cellRefMustBeCellRefNode)(t.isQuoted?yX:Tir):t.kind===yt.QualifierKind.Error?(0,ni.cellRefMustBeCellRefNode)(yX):yX,function(a,o){var u=o.node;if(u==null)return t.kind===yt.QualifierKind.Error?(0,yt.literalNode)(_X.refErrorOper,!0,t.label):(0,yt.badCharsNode)(yt.BadType.Qualifier,n,t.label);var s=(0,ni.getNodeSpan)(a,t).start,l=(0,ni.getNodeSpan)(a,u).end;if(u.kind===yt.NodeKind.Name){var c=(0,ni.addSpan)(a,s,l,"","");if(t.kind===yt.QualifierKind.Error){var d=(0,yt.literalNode)(_X.refErrorOper,!0,t.label);return(0,yt.badSequenceNode)(yt.BadType.Unexpected,[d,u],c)}return(0,eB.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",t.kind!==yt.QualifierKind.SheetRange||t.isQuoted),t.kind===yt.QualifierKind.SheetRange&&t.document===void 0&&(t=(0,yt.identQualifier)("".concat(t.sheet1,":").concat(t.sheet2),t.isQuoted,t.label)),(0,yt.nameNode)(Rir(a,u.parts,s),t,c)}var f=(0,ni.addSpan)(a,s,l,"","");return t.kind===yt.QualifierKind.Ident&&(t=(0,yt.sheetQualifier)(t.name,void 0,t.isQuoted,t.label)),(0,yt.cellRefNode)(u.ref,t,f)})}),Pir=(0,Fa.apply)((0,Fa.any)(RX,EX),function(e,r){return r.node.kind===yt.NodeKind.CellRef&&r.node.ref.kind===yt.CellRefKind.Error?(0,yt.literalNode)(_X.refErrorOper,!0,r.node.label):r});x0.parseRef=(0,Fa.any)(Eir,Pir)});var AX=T(tB=>{"use strict";p();Object.defineProperty(tB,"__esModule",{value:!0});tB.parseLiteral=void 0;var My=nf(),YA=Og(),BT=k0(),Air=qT(),Fir=Fy(),sye=vh(),Nir=fh(),lye=F0(),cye=dh();function Oir(e){return e.refStyle===My.RefStyle.A1&&e.col==null&&typeof e.row=="object"&&e.row.kind===My.PosKind.Rel}var kir=(0,BT.take)(function(e,r){return r.kind===YA.TokenKind.Literal&&r.oper.kind!==cye.OperKind.Boolean?r:r.kind===YA.TokenKind.CellRef&&Oir(r)?(0,YA.literalToken)(r.start,r.chars,e.mathpack.fromNumber(r.row.index+e.origin.row+1)):void 0}),Mir=(0,BT.take)(function(e,r){return r.kind===YA.TokenKind.Literal&&r.oper.kind===cye.OperKind.Boolean?r:void 0});tB.parseLiteral=(0,BT.apply)((0,BT.tuple)((0,BT.any)(kir,(0,BT.left)(Mir,(0,BT.fails)(sye.parseDotSepTokenNotFollowedByLeftBracket))),sye.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=(0,Fir.addSpan)(e,t.start,n,"","");if((0,YA.isBadNumberOper)(t.oper))return(0,My.badCharsNode)(My.BadType.NumberLiteral,t.chars,a);if((0,YA.isBadErrorOper)(t.oper))return(0,My.badCharsNode)(My.BadType.ErrorLiteral,t.chars,a);if((0,lye.isStringOper)(t.oper)&&t.oper.value.length>Nir.cellStringLimit)return(0,My.badCharsNode)(My.BadType.StringLiteral,t.chars,a);var o=(0,My.literalNode)(t.oper,t.hasRight,a);return(0,lye.isBooleanOper)(t.oper)?(0,Air.maybeWSFTerm)(o,t.chars):o})});var OX=T(nB=>{"use strict";p();Object.defineProperty(nB,"__esModule",{value:!0});nB.parseStructRef=void 0;var xir=fe(),kt=k0(),Iir=qT(),Vn=vh(),kg=nf(),Mg=Fy(),I0=Og(),wir=hm(),pye=(0,kt.take)(function(e,r){return r.isIdentContinue||r.kind===I0.TokenKind.Spaces?r:void 0}),Dir=(0,kt.apply)((0,kt.many1)(pye),function(e,r){var t=r[0];return r.length===1?t:(0,I0.identToken)(t.start,r.map(function(n){return n.kind===I0.TokenKind.Escape?"":n.chars}).join(""))}),mye=(0,kt.take)(function(e,r){return r.isIdentContinue||r.kind===I0.TokenKind.Spaces||r.kind===I0.TokenKind.Escape||(0,Vn.isListSepToken)(r)||(0,Vn.isRangeOpToken)(r)?r:void 0}),gye=(0,kt.apply)((0,kt.many1)(mye),function(e,r){var t=r[0];return r.length===1?t:(0,I0.identToken)(t.start,r.map(function(n){return n.kind===I0.TokenKind.Escape?"":n.chars}).join(""))}),vye=(0,kt.take)(function(e,r){return r.kind===I0.TokenKind.SpecialRef?r:void 0}),Lir=(0,kt.apply)((0,kt.tuple)(Vn.parseCharIndex,vye,Vn.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2];return(0,kg.specialRef)(n.value,!1,!0,(0,Mg.addSpan)(e,t,a,"",""))}),qir=(0,kt.apply)((0,kt.tuple)(Vn.parseCharIndex,Vn.parseLeftBracket,vye,(0,kt.opt)(Vn.parseRightBracket,void 0),Vn.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4];return(0,kg.specialRef)(a.value,!0,o!==void 0,(0,Mg.addSpan)(e,t,u,"",""))}),hye=(0,kt.any)(Lir,qir),Gir=(0,kt.apply)((0,kt.tuple)(Vn.parseCharIndex,Dir,Vn.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2];return(0,kg.columnRef)(n.chars,!1,!0,(0,Mg.addSpan)(e,t,a,"",""))}),Sye=(0,kt.apply)((0,kt.tuple)(Vn.parseCharIndex,Vn.parseLeftBracket,(0,kt.opt)(gye,void 0),(0,kt.opt)(Vn.parseRightBracket,void 0),Vn.parseCharIndex),function(e,r){var t,n=r[0],a=r[1],o=r[2],u=r[3],s=r[4];return(0,kg.columnRef)((t=o==null?void 0:o.chars)!==null&&t!==void 0?t:"",!0,u!==void 0,(0,Mg.addSpan)(e,n,s,"",""))}),Bir=(0,kt.apply)((0,kt.tuple)(Vn.parseCharIndex,gye,Vn.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2];return(0,kg.columnRef)(n.chars,!1,!0,(0,Mg.addSpan)(e,t,a,"",""))}),FX=(0,kt.any)(Gir,Sye),yye=(0,kt.apply)(Vn.parseCharIndex,function(e,r){return(0,kg.missingRef)((0,Mg.addSpan)(e,r,r,"",""))}),dye=(0,kt.any)(FX,yye),_ye=(0,kt.take)(function(e,r){return r.chars==="#"?r:void 0}),Uir=(0,kt.apply)((0,kt.many1)(_ye,pye),function(e,r){return(0,I0.unexpectedToken)(r[0].start,r.map(function(t){return t.chars}).join(""))}),Kir=(0,kt.apply)((0,kt.many1)(_ye,mye),function(e,r){return(0,I0.unexpectedToken)(r[0].start,r.map(function(t){return t.chars}).join(""))}),Vir=(0,kt.apply)((0,kt.tuple)(Vn.parseCharIndex,Uir,Vn.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2];return(0,kg.badRef)(n.chars,!1,!0,(0,Mg.addSpan)(e,t,a,"",""))}),jir=(0,kt.apply)((0,kt.tuple)(Vn.parseCharIndex,Vn.parseLeftBracket,Kir,(0,kt.opt)(Vn.parseRightBracket,void 0),Vn.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4];return(0,kg.badRef)(a.chars,!0,o!==void 0,(0,Mg.addSpan)(e,t,u,"",""))}),bye=(0,kt.any)(Vir,jir),NX=(0,kt.apply)((0,kt.tuple)(Vn.parseCharIndex,dye,Vn.parseRangeOp,dye,Vn.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4];return(0,kg.rangeOpRef)(n,o,(0,Mg.addSpan)(e,t,u,"",""))}),Wir=(0,kt.any)(NX,FX),fye=(0,kt.any)(hye,bye,NX,FX,yye),Hir=(0,kt.apply)((0,kt.tuple)(Vn.parseCharIndex,fye,(0,kt.many1)((0,kt.tuple)(Vn.parseListSep,fye)),Vn.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3];return(0,kg.commaOpRef)(xir.__spreadArray([n],a.map(function(u){var s=u[0],l=u[1];return l}),!0),(0,Mg.addSpan)(e,t,o,"",""))}),zir=(0,kt.apply)((0,kt.tuple)(Vn.parseCharIndex,Vn.parseAtOp,(0,kt.opt)(Wir,void 0),Vn.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3];return(0,kg.thisRowOpRef)(a,(0,Mg.addSpan)(e,t,o,"",""))}),Qir=(0,kt.apply)(Vn.parseSpacesOnly,function(){}),Xir=(0,kt.any)((0,kt.left)(Qir,Vn.parseEnd),(0,kt.left)(Bir,Vn.parseEnd),(0,kt.left)(Hir,Vn.parseEnd),(0,kt.left)(zir,Vn.parseEnd),(0,kt.left)(NX,Vn.parseEnd),(0,kt.left)(hye,Vn.parseEnd),(0,kt.left)(bye,Vn.parseEnd),(0,kt.left)(Sye,Vn.parseEnd));nB.parseStructRef=(0,kt.applyTake)((0,kt.tuple)(Vn.parseCharIndex,Vn.parseBracketedTokens,Vn.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=n[0],o=n[1],u=r[2],s=(0,kt.runParser)(Xir,a,0,e);return(0,wir.isSuccess)(s)?(0,Iir.structRefTerm)((0,kg.structRef)(s.value.output,o,(0,Mg.addSpan)(e,t,u,"","")),t,u):void 0})});var Cye=T(aB=>{"use strict";p();Object.defineProperty(aB,"__esModule",{value:!0});aB.buildAnnotations=void 0;var Yir=qr();aB.buildAnnotations=Yir.annotations.buildAnnotations});var kX=T(_h=>{"use strict";p();Object.defineProperty(_h,"__esModule",{value:!0});_h.parseSpParam=_h.runFormulaParser=_h.parseFormula=void 0;var Tye=Pb(),ax=kp(),Is=nf(),iB=nf(),oB=Nb(),xo=Og(),Kr=k0(),ix=qT(),Io=Fy(),na=vh(),uB=PX(),Jir=AX(),Oye=JG(),kye=OX(),Rye=hm(),Zir=Cye(),Eye=xT(),$ir=pr(),eor=ZM(),Pye=WM(),ror=F0(),tor=fh(),UT=(0,Kr.apply)((0,Kr.tuple)(na.parseWhitespace,(0,Kr.lazy)(function(){return _h.parseFormula}),na.parseWhitespace),function(e,r){var t,n,a=r[0],o=r[1],u=r[2],s=(0,Io.getNodeSpan)(e,o);return(0,ax.assertTrue)("calc.parse.parseSpFormula",!(s.pre.length>0&&a.length>0)),(0,ax.assertTrue)("calc.parse.parseSpFormula",!(s.post.length>0&&u.length>0)),a.length>0&&(t=(0,Io.addWhitespace)(e,a),s.pre=t[0],s.preComments=t[1]),u.length>0&&(n=(0,Io.addWhitespace)(e,u),s.post=n[0],s.postComments=n[1]),o}),nor=(0,Kr.apply)((0,Kr.tuple)(na.parseLeftParen,(0,Io.withDelim)({delimId:xo.DelimId.Paren,listSep:Io.ListSep.Union},UT),(0,Kr.opt)(na.parseRightParen,void 0),na.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3];return(0,Is.parenNode)(n,a!==void 0,(0,Io.addSpan)(e,t.start,o,"",""))}),Aye=(0,Kr.many1)(UT,(0,Kr.right)(na.parseColSep,UT)),aor=(0,Kr.many1)(Aye,(0,Kr.right)(na.parseRowSep,Aye)),ior=(0,Kr.apply)((0,Kr.tuple)(na.parseLeftBrace,(0,Io.withDelim)({delimId:xo.DelimId.Brace,listSep:Io.ListSep.Union},aor),(0,Kr.opt)(na.parseRightBrace,void 0),na.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3];return(0,Is.arrayNode)(n,a!==void 0,(0,Io.addSpan)(e,t.start,o,"",""))});function Fye(e){return(0,Kr.takePeek)(function(r,t,n){return e(t)?(0,Is.badCharsNode)(Is.BadType.Unexpected,t.chars,(0,Io.addSpan)(r,t.start,n.start,"","")):void 0})}var oor=(0,Kr.apply)((0,Kr.tuple)(na.parseCharIndex,Fye(na.isLeftBracketToken),(0,Io.withDelim)({delimId:xo.DelimId.Bracket,listSep:Io.ListSep.Union},UT),(0,Kr.opt)(Fye(na.isRightBracketToken),void 0),na.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4],s=[n,a];return o!=null&&s.push(o),(0,Is.badSequenceNode)(Is.BadType.Unexpected,s,(0,Io.addSpan)(e,t,u,"",""))}),uor=(0,Kr.takePeek)(function(e,r,t){switch(r.kind){case xo.TokenKind.End:case xo.TokenKind.Operator:case xo.TokenKind.Spaces:case xo.TokenKind.SingleLineComment:case xo.TokenKind.MultiLineComment:return;case xo.TokenKind.Sep:if(r.value===xo.SepId.Dot)return;if(r.value===xo.SepId.Qual||r.value===xo.SepId.Assign)break;if(e.delim.delimId===xo.DelimId.Brace||r.value!==xo.SepId.Col&&r.value!==xo.SepId.Row)return;break;case xo.TokenKind.Right:if(r.value!==xo.DelimId.SQuote&&e.delim.stack[r.value])return;break}return(0,Is.badCharsNode)(Is.BadType.Unexpected,r.chars,(0,Io.addSpan)(e,r.start,t.start,"",""))}),sor=(0,Kr.any)(uB.parseRef,Jir.parseLiteral,nor,ior,Oye.parseFieldRef,kye.parseStructRef,oor,uB.parseUnqualBadRef,uor);function Mye(e){return(0,Kr.tuple)(na.parseLeftParen,(0,Io.withDelim)({delimId:xo.DelimId.Paren,listSep:Io.ListSep.Arg},(0,Kr.apply)((0,Kr.many1)(e,(0,Kr.right)(na.parseListSep,e)),function(r,t){return t.map(function(n){return n.kind===Is.NodeKind.Missing?(0,Is.literalNode)(tor.missingOper,!0,n.label):n})})),(0,Kr.opt)(na.parseRightParen,void 0),na.parseCharIndex)}var lor=(0,Kr.apply)(Mye(UT),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3];return(0,ix.argsTerm)(n,a!==void 0,t.start,o)}),cor=(0,Kr.apply)(Mye((0,Kr.any)((0,Kr.lazy)(function(){return _h.parseSpParam}),UT)),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3];return(0,ix.lambdaArgsTerm)(n,a!==void 0,t.start,o)}),dor=(0,Kr.take)(function(e,r){return r.kind===xo.TokenKind.Operator&&(r.value===oB.OperatorId.Percent||r.value===oB.OperatorId.Pound)?r:void 0});function por(e,r){return r.kind===xo.TokenKind.Sep&&r.value===xo.SepId.List&&e.delim.listSep===Io.ListSep.Union?(0,xo.operatorToken)(r.start,e.localeInfo.listSeparator,oB.OperatorId.Union):void 0}var mor=(0,Kr.take)(function(e,r){return r.kind===xo.TokenKind.Operator||(0,na.isDotSepToken)(r)?r:por(e,r)}),gor=(0,Kr.many)((0,Kr.take)(function(e,r){return(0,na.isWhitespaceToken)(r)?r:void 0})),Nye=(0,Kr.any)((0,Kr.concat)((0,Kr.bind)((0,Kr.any)(sor,dor),function(e,r){var t=(0,ix.isWSFNode)(e.localeInfo,r);return(t==null?void 0:t.id)===oB.WorksheetFuncId.LAMBDA?(0,Kr.concat)((0,Kr.parseSucceed)([r]),(0,Kr.opt)((0,Kr.tuple)(cor),[])):(0,Kr.parseSucceed)([r])}),(0,Kr.many)((0,Kr.any)(lor,Oye.parseFieldRef,kye.parseStructRef))),(0,Kr.tuple)(mor)),vor=(0,Kr.flatten)((0,Kr.many1)(Nye,(0,Kr.concat)(gor,Nye)));_h.parseFormula=(0,Kr.apply)((0,Kr.tuple)((0,Kr.opt)(vor,void 0),na.parseCharIndex),function(e,r){var t=r[0],n=r[1];if(t==null){var a=(0,Io.addSpan)(e,n,n,"","");return(0,Is.missingNode)("",a)}var o=t;return o.push((0,xo.endToken)(n)),(0,ix.runOperatorPrecedenceParser)(e,o)});function hor(e,r,t,n,a,o,u,s){var l,c=s.length-1;if(c<0){var d="calc.parse.runTokenParser: internal error: expected at least 1 token";return(0,ax.assertFalse)(d)}if(s[c].kind!==xo.TokenKind.End){var d="calc.parse.runTokenParser: internal error: array[n] !== End in ".concat((0,Tye.anonymize)(s));return(0,ax.assertFalse)(d)}var f=(0,Io.makeState)(e,r,t,n,a),m=(0,Kr.runParser)(UT,s,0,f);if(!(0,Rye.isSuccess)(m)||m.value.index<c){var v=(0,Rye.isSuccess)(m)?m.value.index:0,d="calc.parse.runTokenParser: internal error: consumed ".concat(v," out of ").concat(c," in ").concat((0,Tye.anonymize)(s));return(0,ax.assertFalse)(d)}var h=m.value.output,y=f.spans,_=(0,Zir.buildAnnotations)(e,h,o,u===void 0?void 0:(l={},l[iB.SyntaxFeature.Comments]=u[iB.SyntaxFeature.Comments]===!0,l[iB.SyntaxFeature.Statements]=u[iB.SyntaxFeature.Statements]===!0,l));return(0,Is.formula)(h,y,_)}_h.runFormulaParser=hor;var Sor=$ir.codePoint.codePointFullStop;function yor(e,r){if(!e.localeInfo.isIdentStart((0,Eye.stringCodePointAt)(r,0))||!(0,Eye.codePointIterator)(r).every(function(a){return a===Sor||e.localeInfo.isIdentContinue(a)}))return!1;var t=(0,eor.parseCellRef)(e.localeInfo,e.refStyle,e.origin,r,0);if(t!==void 0&&t.i===r.length){var n=t.refStyle===Is.RefStyle.A1?(0,xo.cellRefA1Token)(0,r,t.row,t.col):(0,xo.cellRefR1C1Token)(0,r,t.row,t.col,t.enLocale);if((0,uB.isCompleteCellRefToken)(e,n))return!1}return!0}var _or=(0,Kr.apply)((0,Kr.many1)((0,Kr.take)(function(e,r){return r.isIdentContinue||(0,na.isDotSepToken)(r)?r:void 0})),function(e,r){var t=r[0].start,n=r.map(function(o){return o.chars}).join(""),a=(0,Io.addSpan)(e,t,t+n.length,"","");return yor(e,n)?(0,Is.identNode)(n,a):(0,Is.badCharsNode)(Is.BadType.ParamName,n,a)}),bor=(0,Kr.applyTake)((0,Kr.tuple)(na.parseCharIndex,na.parseLeftBracket,na.parseCharIndex,na.parseSpacesOnly,(0,Kr.opt)(_or,void 0),na.parseSpacesOnly,na.parseCharIndex,(0,Kr.opt)(na.parseRightBracket,void 0),na.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4],s=r[5],l=r[6],c=r[7],d=r[8];if(u!==void 0){var f=(0,Io.getNodeSpan)(e,u);f.pre=o,f.post=s}var m=u??(0,Is.missingNode)(o+s,(0,Io.addSpan)(e,a,l,"",""));return(0,Is.paramName)(m,!0,c!==void 0,(0,Io.addSpan)(e,t,d,"",""))}),Cor=(0,Kr.applyTake)((0,Kr.tuple)(na.parseCharIndex,uB.parseRef,na.parseCharIndex),function(e,r){var t=r[0],n=r[1],a=r[2],o=n.kind===ix.TermKind.MaybeWSFTerm?n.node:n;if((0,ror.isUnqualifiedNameNode)(o))return(0,Is.paramName)((0,Is.identNode)(o.whole,o.label),!1,!0,(0,Io.addSpan)(e,t,a,"",""))}),Tor=(0,Kr.apply)((0,Kr.tuple)(na.parseWhitespace,na.parseCharIndex,na.parseAssignToken,na.parseWhitespace,(0,Kr.lazy)(function(){return _h.parseFormula}),na.parseCharIndex),function(e,r){var t,n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],l=r[5],c=(0,Io.getNodeSpan)(e,s);return t=(0,Io.addWhitespace)(e,u),c.pre=t[0],c.preComments=t[1],(0,Is.paramDefault)(s,(0,Io.addSpan)(e,a,l,n,""))}),Ror=(0,Kr.lazy)(function(){return(0,Pye.isFeatureEnabled)(Pye.FeatureName.CalcLambdaDefaultParameters)?Tor:(0,Kr.parseFail)()});_h.parseSpParam=(0,Kr.applyTake)((0,Kr.tuple)(na.parseWhitespace,na.parseCharIndex,(0,Kr.bind)((0,Kr.any)(Cor,bor),function(e,r){return r.isClosed?(0,Kr.apply)((0,Kr.opt)(Ror,void 0),function(t,n){return[r,n]}):(0,Kr.parseSucceed)([r,void 0])}),na.parseCharIndex,na.parseWhitespace,(0,Kr.peek)(function(e,r){return r})),function(e,r){var t=r[0],n=r[1],a=r[2],o=a[0],u=a[1],s=r[3],l=r[4],c=r[5];if(u!==void 0||c.kind===xo.TokenKind.End&&o.isBracketed||(0,na.isListSepToken)(c)&&o.isClosed)return(0,Is.paramNode)(o,u,(0,Io.addSpan)(e,n,s,t,l))})});var sB=T(ws=>{"use strict";p();Object.defineProperty(ws,"__esModule",{value:!0});ws.values=ws.stringStartsWith=ws.stringEndsWith=ws.repeat=ws.prependErrorMessage=ws.partialArray=ws.messageFromError=ws.mathLog2=ws.isInteger=ws.arrayFill=void 0;var w0=pr();ws.arrayFill=w0.util.arrayFill;ws.isInteger=w0.util.isInteger;ws.mathLog2=w0.util.mathLog2;ws.messageFromError=w0.util.messageFromError;ws.partialArray=w0.util.partialArray;ws.prependErrorMessage=w0.util.prependErrorMessage;ws.repeat=w0.util.repeat;ws.stringEndsWith=w0.util.stringEndsWith;ws.stringStartsWith=w0.util.stringStartsWith;ws.values=w0.util.values});var qye=T(Ib=>{"use strict";p();Object.defineProperty(Ib,"__esModule",{value:!0});Ib.parseResultHelper=Ib.ExtractLetVisitor=Ib.CaretInsideArrayNodeIdentityVisitor=void 0;var lB=fe(),MX=kp(),wo=nf(),ox=VQ(),Eor=Nb(),ux=hm(),Yf=GG(),xye=DA(),Iye=sB(),Por=dh(),Aor=fh(),For=mi(),wye=function(e){lB.__extends(r,e);function r(t,n){var a=e.call(this)||this;return a.parsedFormulaTree=t,a.caretPosition=n,a.isInsideArrayNode=!1,a.autoCompleteFixForArrayNodesEnabled=(0,For.isChangeGateEnabled)("OfficeVSO:7896479_autoCompleteFixForArrayNodesEnabled"),a}return r.prototype.arrayNode=function(t,n,a){var o=e.prototype.arrayNode.call(this,t,n,a);return this.autoCompleteFixForArrayNodesEnabled&&this.caretInNode(o)&&(this.isInsideArrayNode=!0),o},r.prototype.caretInNode=function(t){if(t===void 0)return!1;var n=this.parsedFormulaTree.spans[t.label];return n!==void 0&&this.caretPosition>=n.start&&this.caretPosition<=n.end},r}(Yf.IdentityVisitor);Ib.CaretInsideArrayNodeIdentityVisitor=wye;function xy(e,r){var t=e[r];return(0,MX.assertTrue)("ParseResultHelper.getFormulaSpan: expected span to be defined",t!==void 0),t}var Dye=function(e){lB.__extends(r,e);function r(t,n){var a=e.call(this,t,n)||this;return a.references=[],a}return r.prototype.letNode=function(t,n,a,o,u,s){if(this.caretInNode(a==null?void 0:a.arg))this.pushNames(n);else for(var l=0;l<n.length;l+=1){var c=n[l].binder;if(this.caretInNode(c.arg)){this.pushNames(t.id===Eor.WorksheetFuncId.LET?n.slice(0,l):n);break}}return e.prototype.letNode.call(this,t,n,a,o,u,s)},r.prototype.lambdaNode=function(t,n,a,o,u,s){if(this.caretInNode(a==null?void 0:a.arg))this.pushNames(n);else for(var l=0;l<n.length;l+=1){var c=n[l].name;if(c.arg.def!==void 0&&this.caretInNode(c.arg.def.rhs)){this.pushNames(n.slice(0,l));break}}return e.prototype.lambdaNode.call(this,t,n,a,o,u,s)},r.prototype.pushNames=function(t){(0,xye.safePush)(this.references,t.map(function(n){var a=n.name;return a.arg.wholeName}).filter(xye.isDefined).reverse())},r}(wye);Ib.ExtractLetVisitor=Dye;function Nor(e,r){if((0,ux.isSuccess)(e))try{var t=new Dye(e.value,r);return(0,Yf.reduceBottomUp)(t,e.value),t.references.reverse()}catch(a){var n="ParseResultHelper.extractLetVariables: unhandled error ".concat((0,Iye.messageFromError)(a));return MX.ulsLogger.ULS.traceTag(507381983,ox.LogCategory.msoulscat_ES_EWAJS,ox.TraceLevel.Warning,n),[]}}function Oor(e,r,t,n,a){if(t===void 0&&(t=!1),!!(0,ux.isSuccess)(e)){var o=[];return Lye(e,["range","namedRange","letName","literal","function","structRefRange"],function(u,s){var l=xy(e.value.spans,s.label),c={kind:u,ref:s,span:l};o.push(c)},r,t,n,a),o.sort(function(u,s){var l;return(l=u.span.start-s.span.start)!==0||(l=s.span.end-u.span.end)!==0?l:0}),o}}function Lye(e,r,t,n,a,o,u){if(a===void 0&&(a=!1),!(0,ux.isSuccess)(e))return!1;try{kor(e.value,n??(0,ox.getEnglishLocaleInfo)(),r,t,a,o,u)}catch(l){var s="ParseResultHelper.traverse: unhandled error ".concat((0,Iye.messageFromError)(l));MX.ulsLogger.ULS.traceTag(507381982,ox.LogCategory.msoulscat_ES_EWAJS,ox.TraceLevel.Warning,s)}return!0}Ib.parseResultHelper={isSuccess:ux.isSuccess,traverse:Lye,extractReferences:Oor,extractLetVariables:Nor};function kor(e,r,t,n,a,o,u){if(e==null||n==null)return;var s={};N();var l={};{var c=0,d=[],f=lB.__assign(lB.__assign({},Yf.voidVisitor),{letNode:function(B,U,j,X,ee,re){for(var Z=0,J=U;Z<J.length;Z++){var C=J[Z].name;l[C.arg.label]=c}d.push({letCount:c,span:xy(e.spans,re)}),c+=1},lambdaNode:function(B,U,j,X,ee,re){for(var Z=0,J=U;Z<J.length;Z++){var C=J[Z].name;l[C.arg.label]=c}d.push({letCount:c,span:xy(e.spans,re)}),c+=1}});(0,Yf.reduceBottomUp)(f,e),d.sort(function(M,B){return M.span.start-B.span.start});for(var m={},v=0;v<d.length;v+=1)m[d[v].letCount]=v;for(var h=0,y=Object.keys(l).map(Number);h<y.length;h++){var _=y[h];l[_]=m[l[_]]}}var E={literalNode:function(B,U,j){var X=Yf.identityVisitor.literalNode(B,U,j);return k("literal")&&n("literal",{label:j,value:X,valueKind:B.kind}),X},missingNode:function(B,U){var j=Yf.identityVisitor.missingNode(B,U);return k("literal")&&n("literal",{label:U,value:(0,wo.literalNode)(Aor.missingOper,!0,U),valueKind:Por.OperKind.Missing}),j},arrayNode:function(B,U,j){return Yf.identityVisitor.arrayNode(B,U,j)},appNode:function(B,U,j,X){var ee=Yf.identityVisitor.appNode(B,U,j,X);return I(B,U,j,X),ee},letNode:function(B,U,j,X,ee,re){var Z=(0,wo.letNode)(B,U,j,X,ee,re);I(B,Z.args,ee,re);for(var J=0,C=U;J<C.length;J++){var S=C[J].name;k("letName")&&n("letName",{label:S.arg.label,name:S.arg.wholeName,number:l[S.arg.label],qualifier:void 0})}return Z},lambdaNode:function(B,U,j,X,ee,re){var Z=(0,wo.lambdaNode)(B,U,j,X,ee,re);I(B,Z.args,ee,re);for(var J=0,C=U;J<C.length;J++){var S=C[J].name;k("letName")&&n("letName",{label:S.arg.name.name.label,name:S.arg.wholeName,number:l[S.arg.label],qualifier:void 0})}return Z},parenNode:function(B,U,j){return Yf.identityVisitor.parenNode(B,U,j)},nameNode:function(B,U,j){var X=(0,wo.nameNode)(B,U,j),ee=e.annotations[B.label],re=e.annotations[j];if((re==null?void 0:re.kind)!==wo.AnnotationKind.AppHeadName){if((ee==null?void 0:ee.kind)===wo.AnnotationKind.LocalNameUse){var Z=l[ee.label];k("letName")&&Z!=null&&n("letName",{label:j,name:ee.name,number:Z,qualifier:void 0})}else if(k("namedRange")){var J=X.whole.split(".");n("namedRange",{label:j,name:J[0],names:J.slice(1),qualifier:q(X)})}}return X},cellRefNode:function(B,U,j){var X=(0,wo.cellRefNode)(B,U,j);return k("range")&&V(X),X},fieldRefNode:function(B,U,j){return Yf.identityVisitor.fieldRefNode(B,U,j)},structRefNode:function(B,U,j){var X=(0,wo.structRefNode)(B,U,j);if(k("structRefRange")){if(u==null||o==null)return X;var ee=u.resolveStructRef(o,X).resolution;if(!(0,ux.isSuccess)(ee)||ee.value===void 0)return X;var re=ee.value;n("structRefRange",{label:j,type:"range",top:(0,wo.pos)(wo.PosKind.Rel,re.range.row),left:(0,wo.pos)(wo.PosKind.Rel,re.range.col),bottom:(0,wo.pos)(wo.PosKind.Rel,re.range.row+re.range.rows-1),right:(0,wo.pos)(wo.PosKind.Rel,re.range.col+re.range.cols-1),span:xy(e.spans,j),qualifier:B!==void 0?q(B):void 0,name:B!==void 0?B.whole:void 0})}return X},badSequenceNode:function(B,U,j){return Yf.identityVisitor.badSequenceNode(B,U,j)},badCharsNode:function(B,U,j){return Yf.identityVisitor.badCharsNode(B,U,j)},operatorNode:function(B,U){return Yf.identityVisitor.operatorNode(B,U)},wsfNode:function(B,U,j){return Yf.identityVisitor.wsfNode(B,U,j)}};(0,Yf.reduceBottomUp)(E,e);function N(){t!=null?t.forEach(function(M){s[M]=!0}):s["*"]=!0}function k(M){return s[M]||s["*"]}function q(M){if(M.qualifier!=null){var B={};switch(M.qualifier.kind){case wo.QualifierKind.Sheet:var U=M.qualifier;B.type="Sheet",B.sheet=U.sheet,U.document!=null&&(B.document=U.document.document,U.document.path!=null&&(B.documentPath=U.document.path));break;case wo.QualifierKind.SheetRange:var j=M.qualifier;B.type="SheetRange",B.sheet1=j.sheet1,B.sheet2=j.sheet2,j.document!=null&&(B.document=j.document.document,j.document.path!=null&&(B.documentPath=j.document.path));break;case wo.QualifierKind.Ident:var X=M.qualifier;B.type="Ident",B.name=X.name;break;case wo.QualifierKind.Document:var ee=M.qualifier;B.type="Document",B.document=ee.document,ee.path!=null&&(B.documentPath=ee.path);break;default:break}return B}}function V(M){if(!(e==null||n==null))switch(M.ref.kind){case wo.CellRefKind.Error:break;case wo.CellRefKind.Col:var B=M.ref;n("range",{label:M.label,type:"col",startIndex:B.col1,endIndex:B.col2,span:xy(e.spans,B.label),qualifier:q(M)});break;case wo.CellRefKind.Row:var U=M.ref;n("range",{label:M.label,type:"row",startIndex:U.row1,endIndex:U.row2,span:xy(e.spans,U.label),qualifier:q(M)});break;case wo.CellRefKind.Single:var j=M.ref;n("range",{label:M.label,type:"cell",row:j.row,col:j.col,span:xy(e.spans,j.label),qualifier:q(M)});break;case wo.CellRefKind.Range:var X=M.ref;n("range",{label:M.label,type:"range",top:X.ref1.row,left:X.ref1.col,bottom:X.ref2.row,right:X.ref2.col,topLeftSpan:xy(e.spans,X.ref1.label),bottomRightSpan:xy(e.spans,X.ref2.label),qualifier:q(M)});break}}function I(M,B,U,j){if(n!=null)switch(M.kind){case wo.NodeKind.Operator:k("operator")&&n("operator",{label:j,value:M.id});break;case wo.NodeKind.WSF:case wo.NodeKind.Name:k("function")&&n("function",{label:j,name:M.whole,isClosed:U,args:[]});break}}}});var Gye=T(xg=>{"use strict";p();Object.defineProperty(xg,"__esModule",{value:!0});xg.parseUint=xg.parseSignedLiteral=xg.parseNumberLiteral=xg.isLineBreak=xg.isSpace=void 0;var sx=qr();xg.isSpace=sx.literalParse.isSpace;xg.isLineBreak=sx.literalParse.isLineBreak;xg.parseNumberLiteral=sx.literalParse.parseNumberLiteral;xg.parseSignedLiteral=sx.literalParse.parseSignedLiteral;xg.parseUint=sx.literalParse.parseUint});var xX=T(D0=>{"use strict";p();Object.defineProperty(D0,"__esModule",{value:!0});D0.scanEscapedWhile=D0.getEscapedSkip=D0.scanWhile=D0.makeProgressAsserter=void 0;var Mor=kp(),cB=xT(),xor=sB();function Ior(e,r){var t=r-1;return function(n){if(n<=t){var a="".concat(e,": internal error: no progress made at index ").concat(n);return(0,Mor.assertFalse)(a)}t=n}}D0.makeProgressAsserter=Ior;function wor(e,r,t){for(var n=r;n<e.length&&t(e,n);)n+=(0,cB.numCodeUnits)((0,cB.stringCodePointAt)(e,n));return[e.substring(r,n),n]}D0.scanWhile=wor;function Bye(e,r,t,n,a){return t(e,r)?1:(0,xor.stringStartsWith)(e,n,r)&&r+n.length<e.length&&a(e,r+n.length)?2:0}D0.getEscapedSkip=Bye;function Dor(e,r,t,n,a){for(var o=[],u=r,s=r;s<e.length;){var l=Bye(e,s,t,n,a);if(l===0)break;l===2&&(u!==s&&o.push(e.substring(u,s)),u=s+n.length,s+=n.length),s+=(0,cB.numCodeUnits)((0,cB.stringCodePointAt)(e,s))}return u!==s&&o.push(e.substring(u,s)),[o.join(""),s]}D0.scanEscapedWhile=Dor});var BX=T(pB=>{"use strict";p();Object.defineProperty(pB,"__esModule",{value:!0});pB.tokenizeFormula=void 0;var Lor=fe(),Wye=kp(),We=Og(),IX=fh(),qor=ZM(),JA=Gye(),Gor=DA(),wX=nf(),Ig=xX(),hd=xT(),nc=Lor.__importStar(KA()),_o=sB(),Uye=WM(),Bor=vh(),LX=nc.codePointAsterisk,Hye=nc.codePointAtSign,fB=nc.codePointColon,qX=nc.codePointDoubleQuote,DX=nc.codePointExclamationMark,GX=nc.codePointHash,Uor=nc.codePointLeftParen,zye=nc.codePointQuestionMark,Kor=nc.codePointRightParen,KT=nc.codePointSingleQuote,Vor=nc.codePointFullStop,jor=nc.codePointDigitZero,dB=nc.codePointSlash,Wor=nc.codePointMinusSign,Kye=nc.codePointSpace,Hor=nc.codePointInvertedExclamationMark,zor=nc.codePointInvertedQuestionMark,Qor=nc.codePointLeftSingleQuotationMark,Xor=nc.codePointRightSingleQuotationMark,lx;function Yor(e){if(!lx){lx=(0,Gor.makeStringMap)();for(var r=0,t=Object.getOwnPropertyNames(Qye);r<t.length;r++){var n=t[r];lx[n.charCodeAt(0)]=!0}for(var a=0,o=Object.getOwnPropertyNames(Xye);a<o.length;a++){var u=o[a];lx[u.charCodeAt(0)]=!0}}return lx[e]===!0}var Qye={"+":We.addOperatorToken,"-":We.subOperatorToken,"*":We.mulOperatorToken,"/":We.divOperatorToken,"^":We.powOperatorToken,"%":We.percentOperatorToken,"&":We.concatOperatorToken,"=":We.eqOperatorToken,"<":We.ltOperatorToken,">":We.gtOperatorToken,":":We.rangeOperatorToken,".":We.dotSepToken,"@":We.atOperatorToken,"#":We.poundOperatorToken},Xye={"<>":We.neOperatorToken,"<=":We.leOperatorToken,">=":We.geOperatorToken};function Vye(e,r,t){if(r<e.length-1){var n=Xye[e.substring(r,r+2)];if(n!=null)return(0,We.appendToken)(2,n(r),t)}var a=Qye[e.charAt(r)];if(a!=null)return(0,We.appendToken)(1,a(r),t);var o="calc.parse.tokenizeOperator: internal error: expected operator";return(0,Wye.assertFalse)(o)}function Jor(e,r,t,n,a){var o=(0,JA.parseNumberLiteral)(e,r,t,n,!1,!1,!1);if(o!==void 0){var u=o.value,s=o.i,l=t.substring(n,s);return(0,We.appendToken)(s-n,(0,We.literalToken)(n,l,u??We.badNumberOper,!0),a),s}}var Zor=function(r,t){return r.charCodeAt(t)!==qX},$or=function(r,t){return r.charCodeAt(t)===qX};function eur(e,r,t){var n=(0,Ig.scanEscapedWhile)(e,r+1,Zor,'"',$or),a=n[0],o=n[1],u=e.substring(r,o+1);return o<e.length?(0,We.appendToken)(o+1-r,(0,We.literalToken)(r,u,(0,IX.stringOper)(a),!0),t):(0,We.appendToken)(o-r,(0,We.literalToken)(r,u,(0,IX.stringOper)(a),!1),t)}function rur(e,r,t,n){for(var a=1;a<e.errorNames.length;a+=1){var o=e.errorNames[a];if(o!=null){var u=r.substring(t,t+o.length);if(e.stringCompareCI(o,u)===0)return(0,We.appendToken)(o.length,(0,We.literalToken)(t,u,(0,IX.errorOper)(a)),n)}}for(var s=t+1,l=!1;s<r.length;){var c=(0,hd.stringCodePointAt)(r,s);if(s===t+1&&(c===Hor||c===zor)){s+=1;continue}if(s>t+1&&(c===dB||c===Wor||c===Kye)&&!l){l=!0,s+=1;continue}if(s>t+1&&c===Vor){s+=1;continue}if(s>t+1&&c===jor){s+=1,s<r.length&&r.charCodeAt(s)===DX&&(s+=1);break}if(c===DX||c===zye){s!==t+1&&(s+=1);break}if(e.isIdentContinue(c)&&!e.isNumeral(c)){s+=(0,hd.numCodeUnits)(c);continue}if(c===Qor||c===Xor){s+=1;continue}break}for(;s>t+1&&r.charCodeAt(s-1)===Kye;)--s;if(s>t+1){var u=r.substring(t,s);return(0,We.appendToken)(s-t,(0,We.literalToken)(t,u,We.badErrorOper),n)}}function tur(e,r,t,n){for(var a=1;a<e.specialRefNames.length;a+=1){var o=e.specialRefNames[a];if(o!=null){var u=r.substring(t,t+o.length);if(e.stringCompareCI(o,u)===0)return(0,We.appendToken)(o.length,(0,We.specialRefToken)(t,u,a),n)}}}function jye(e,r,t){var n=r.charCodeAt(t);return!(0,JA.isSpace)(n)&&n!==KT&&n!==GX&&n!==fB&&n!==Hye&&!(0,_o.stringStartsWith)(r,e.listSeparator,t)&&!(0,_o.stringStartsWith)(r,e.leftBracket,t)&&!(0,_o.stringStartsWith)(r,e.rightBracket,t)}var Yye=function(r,t){return(0,JA.isSpace)((0,hd.stringCodePointAt)(r,t))},nur=function(r,t){return!(0,JA.isLineBreak)((0,hd.stringCodePointAt)(r,t))},aur=function(r,t){return!(t+1<r.length&&r.charCodeAt(t)===LX&&r.charCodeAt(t+1)===dB)};function iur(e,r,t,n){for(var a=t,o=0,u=function(y,_){return jye(e,y,_)},s=function(y,_){return!jye(e,y,_)},l=(0,Ig.makeProgressAsserter)("calc.parse.tokenizeBracketedRef",a);a<r.length;){l(a);var c=(0,hd.stringCodePointAt)(r,a);if(n.length>0&&n[n.length-1].kind===We.TokenKind.Escape&&s(r,a)){a=(0,We.appendToken)((0,hd.numCodeUnits)(c),(0,We.identToken)(a,(0,hd.stringFromCodePoint)(c)),n);continue}if(c===Hye){a=(0,We.appendToken)(1,(0,We.atOperatorToken)(a),n);continue}if(c===GX){var d=tur(e,r,a,n);if(d!=null){a=d;continue}}if(c===KT){a=(0,We.appendToken)(1,(0,We.escapeToken)(a,"'"),n);continue}if((0,_o.stringStartsWith)(r,e.rightBracket,a)){if(a=(0,We.appendToken)(e.rightBracket.length,(0,We.rightBracketToken)(a,e.rightBracket),n),o-=1,o===0)return a;continue}if(u(r,a)){var f=(0,Ig.scanWhile)(r,a,u),m=f[0],d=f[1];a=(0,We.appendToken)(d-a,(0,We.identToken)(a,m),n);continue}if((0,JA.isSpace)(c)){var v=(0,Ig.scanWhile)(r,a,Yye),m=v[0],d=v[1];a=(0,We.appendToken)(d-a,(0,We.spacesToken)(a,m),n);continue}if(c===fB){a=(0,We.appendToken)(1,(0,We.rangeOperatorToken)(a),n);continue}if((0,_o.stringStartsWith)(r,e.listSeparator,a)){a=(0,We.appendToken)(e.listSeparator.length,(0,We.listSepToken)(a,e.listSeparator),n);continue}if((0,_o.stringStartsWith)(r,e.leftBracket,a)&&o<2){a=(0,We.appendToken)(e.leftBracket.length,(0,We.leftBracketToken)(a,e.leftBracket),n),o+=1;continue}a=(0,We.appendToken)((0,hd.numCodeUnits)(c),(0,We.unexpectedToken)(a,(0,hd.stringFromCodePoint)(c)),n)}return a}function our(e,r,t){var n=r.charCodeAt(t);return n!==KT&&n!==fB&&n!==LX&&n!==zye&&!(0,_o.stringStartsWith)(r,e.leftBracket,t)&&!(0,_o.stringStartsWith)(r,e.rightBracket,t)}function uur(e,r,t,n){for(var a=(0,We.appendToken)(1,(0,We.leftSQuoteToken)(t),n),o=function(v,h){return our(e,v,h)},u=function(v,h){return v.charCodeAt(h)===KT},s=(0,Ig.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier",a);a<r.length;){s(a);var l=(0,hd.stringCodePointAt)(r,a);if(l===KT&&!(a+1<r.length&&r.charCodeAt(a+1)===KT))return(0,We.appendToken)(1,(0,We.rightSQuoteToken)(a),n);if(l===fB){a=(0,We.appendToken)(1,(0,We.rangeOperatorToken)(a),n);continue}if((0,_o.stringStartsWith)(r,e.leftBracket,a)){a=(0,We.appendToken)(e.leftBracket.length,(0,We.leftBracketToken)(a,e.leftBracket),n);continue}if((0,_o.stringStartsWith)(r,e.rightBracket,a)){a=(0,We.appendToken)(e.rightBracket.length,(0,We.rightBracketToken)(a,e.rightBracket),n);continue}if((0,Ig.getEscapedSkip)(r,a,o,"'",u)>0){var c=(0,Ig.scanEscapedWhile)(r,a,o,"'",u),d=c[0],f=c[1];a=(0,We.appendToken)(f-a,(0,We.identToken)(a,d),n);continue}a=(0,We.appendToken)((0,hd.numCodeUnits)(l),(0,We.unexpectedToken)(a,(0,hd.stringFromCodePoint)(l)),n)}return a}function sur(e,r,t,n,a,o){var u=(0,qor.parseCellRef)(e,r,t,n,a);if(u!=null){var s=u.i,l=n.substring(s,a),c=u.refStyle===wX.RefStyle.A1?(0,We.cellRefA1Token)(a,l,u.row,u.col):(0,We.cellRefR1C1Token)(a,l,u.row,u.col,u.enLocale);return(0,We.appendToken)(s-a,c,o)}}function lur(e,r,t,n){var a=n.length-1,o=n[a];if(o==null)return!0;if(o.kind===We.TokenKind.Sep&&o.value===We.SepId.Dot)return!1;if((0,_o.stringStartsWith)(r,e.decimalSeparator,t)){for(;o!=null&&(0,Bor.isWhitespaceToken)(o);)o=n[--a];return o==null?!0:o.kind!==We.TokenKind.Ident&&o.kind!==We.TokenKind.CellRef&&o.kind!==We.TokenKind.Right&&(o.kind!==We.TokenKind.Literal||(0,We.isNumberLikeOper)(o.oper))}return e.isNumeral((0,hd.stringCodePointAt)(r,t))}function cur(e,r,t,n,a,o,u){for(var s=[],l=[],c=o,d=(u==null?void 0:u[wX.SyntaxFeature.Comments])===!0,f=(u==null?void 0:u[wX.SyntaxFeature.Statements])===!0,m=!(0,_o.stringStartsWith)(e.statementSeparator,e.columnSeparator)&&!(0,_o.stringStartsWith)(e.statementSeparator,e.rowSeparator),v=!(0,_o.stringStartsWith)(e.statementSeparator,e.listSeparator)&&!(0,_o.stringStartsWith)(e.statementSeparator,e.decimalSeparator),h=(0,Ig.makeProgressAsserter)("calc.parse.tokenize",c);c<a.length;){h(c);var y=sur(e,t,n,a,c,s);if(y!=null){c=y;continue}var _=(0,hd.stringCodePointAt)(a,c),E=l.length>0&&l[l.length-1].delim===We.DelimId.Brace;if(lur(e,a,c,s)){var N=Jor(e,r,a,c,s);if(N!=null){c=N;continue}}if(_===qX){c=eur(a,c,s);continue}if(e.isIdentContinue(_)&&!(0,_o.stringStartsWith)(a,e.listSeparator,c)&&!(E&&(0,_o.stringStartsWith)(a,e.columnSeparator,c))&&!(E&&(0,_o.stringStartsWith)(a,e.rowSeparator,c))){var k=(0,Ig.scanWhile)(a,c,function(S,b){return e.isIdentContinue((0,hd.stringCodePointAt)(S,b))}),q=k[0],V=k[1];c=(0,We.appendToken)(V-c,(0,We.identOrBooleanToken)(e,c,q),s);continue}if(_===GX){var I=rur(e,a,c,s);if(I!=null){c=I;continue}c=Vye(a,c,s);continue}if((0,JA.isSpace)(_)){var M=(0,Ig.scanWhile)(a,c,Yye),q=M[0],B=M[1];c=(0,We.appendToken)(B-c,(0,We.spacesToken)(c,q),s);continue}if(_===Uor){l.push({delim:We.DelimId.Paren,lastParen:l.length,lastBrace:l.length>0?l[l.length-1].lastBrace:void 0}),c=(0,We.appendToken)(1,(0,We.leftParenToken)(c),s);continue}if(_===Kor){var U=l.length>0?l[l.length-1].lastParen:void 0;U!==void 0&&(l.length=U),c=(0,We.appendToken)(1,(0,We.rightParenToken)(c),s);continue}if((0,_o.stringStartsWith)(a,e.leftBrace,c)){l.push({delim:We.DelimId.Brace,lastParen:l.length>0?l[l.length-1].lastParen:void 0,lastBrace:l.length}),c=(0,We.appendToken)(e.leftBrace.length,(0,We.leftBraceToken)(c,e.leftBrace),s);continue}if((0,_o.stringStartsWith)(a,e.rightBrace,c)){var j=l.length>0?l[l.length-1].lastBrace:void 0;j!==void 0&&(l.length=j),c=(0,We.appendToken)(e.rightBrace.length,(0,We.rightBraceToken)(c,e.rightBrace),s);continue}if((0,_o.stringStartsWith)(a,e.leftBracket,c)){c=iur(e,a,c,s);continue}if((0,_o.stringStartsWith)(a,e.rightBracket,c)){c=(0,We.appendToken)(e.rightBracket.length,(0,We.rightBracketToken)(c,e.rightBracket),s);continue}if(E){if(f&&m&&(0,_o.stringStartsWith)(a,e.statementSeparator,c))break;if((0,_o.stringStartsWith)(a,e.columnSeparator,c)){c=(0,We.appendToken)(e.columnSeparator.length,(0,We.colSepToken)(c,e.columnSeparator),s);continue}if((0,_o.stringStartsWith)(a,e.rowSeparator,c)){c=(0,We.appendToken)(e.rowSeparator.length,(0,We.rowSepToken)(c,e.rowSeparator),s);continue}}if(f&&(0,_o.stringStartsWith)(a,e.statementSeparator,c)&&(v||l.length===0))break;if((0,_o.stringStartsWith)(a,e.listSeparator,c)){c=(0,We.appendToken)(e.listSeparator.length,(0,We.listSepToken)(c,e.listSeparator),s);continue}if(_===DX){c=(0,We.appendToken)(1,(0,We.qualSepToken)(c),s);continue}if(_===KT){c=uur(e,a,c,s);continue}if(_===dB&&c+1<a.length&&d){var X=a.charCodeAt(c+1);if(X===dB){var ee=(0,Ig.scanWhile)(a,c,nur),q=ee[0],re=ee[1];c=(0,We.appendToken)(re-c,(0,We.singleLineCommentToken)(c,q),s);continue}if(X===LX){var Z=(0,Ig.scanWhile)(a,c+2,aur),q=Z[0],J=Z[1],C=(0,_o.stringStartsWith)(a,"*/",J);(0,Wye.assertTrue)("calc.parse.tokenize: /**/",C||J===a.length),J+=C?2:0,q="/*"+q+(C?"*/":""),c=(0,We.appendToken)(J-c,(0,We.multiLineCommentToken)(c,q,C),s);continue}}if(Yor(_)){if((0,_o.stringStartsWith)(a,":=",c)&&(0,Uye.isFeatureEnabled)(Uye.FeatureName.CalcLambdaDefaultParameters)){c=(0,We.appendToken)(2,(0,We.assignSepToken)(c),s);continue}c=Vye(a,c,s);continue}c=(0,We.appendToken)((0,hd.numCodeUnits)(_),(0,We.unexpectedToken)(c,(0,hd.stringFromCodePoint)(_)),s)}return[s,c]}function dur(e,r,t,n){for(var a=e[r],o=r+1;o<e.length;o+=1){var u=e[o];if(u.kind!==t)break;a=n(a,u)}return[a,o]}function fur(e,r,t,n,a,o,u){for(var s=cur(e,r,t,n,a,o,u),l=s[0],c=s[1],d=[],f=0;f<l.length;){var m=l[f];if(m.kind===We.TokenKind.Unexpected){var v=dur(l,f,We.TokenKind.Unexpected,function(_,E){var N=_,k=E;return(0,We.unexpectedToken)(N.start,N.chars+k.chars)}),h=v[0],y=v[1];d.push(h),f=y;continue}d.push(m),f+=1}return d.push((0,We.endToken)(c)),d}pB.tokenizeFormula=fur});var Zye=T(gB=>{"use strict";p();var ZA;Object.defineProperty(gB,"__esModule",{value:!0});gB.createParser=void 0;var pur=fe(),mur=BX(),gur=kX(),vur=eX(),hur=F0(),VT=hm(),mB=pur.__importStar(KA()),Sur=mB.codePointEqualsSign,yur=mB.codePointPlusSign,_ur=mB.codePointMinusSign,bur=mB.codePointAtSign,Cur=(ZA={},ZA[Sur]=1,ZA[yur]=0,ZA[_ur]=0,ZA[bur]=-1,ZA);function Jye(e,r,t,n){var a,o,u,s,l=(o=(a=r.config)===null||a===void 0?void 0:a.localeInfo)!==null&&o!==void 0?o:e.config.localeInfo,c=(s=(u=r.config)===null||u===void 0?void 0:u.refStyle)!==null&&s!==void 0?s:e.config.refStyle,d=e.config.mathpack,f=(0,mur.tokenizeFormula)(l,d,c,r.originGridCell.value,t,n,r.syntaxFeatures),m=(0,gur.runFormulaParser)(l,d,c,r.lexicalKind,r.originGridCell.value,r.contextNames,r.syntaxFeatures,f);return(0,VT.success)(m)}function Tur(e,r,t,n){n===void 0&&(n=0);try{var a=n>=0&&n<t.length?Cur[t.charCodeAt(n)]:void 0;return a==null?(0,VT.failure)((0,vur.notFormulaString)("first character is not '=', '+', '-' or '@'")):a<0?(0,VT.failure)((0,hur.notImplemented)(["Lotus 1-2-3 syntax"])):Jye(e,r,t,n+a)}catch(o){return(0,VT.failure)((0,VT.javaScriptError)(o))}}function Rur(e,r,t,n){n===void 0&&(n=0);try{return Jye(e,r,t,n)}catch(a){return(0,VT.failure)((0,VT.javaScriptError)(a))}}function Eur(e){return{parseFormula:function(t,n,a){return Tur(e,t,n,a)},parseFormulaExpression:function(t,n,a){return Rur(e,t,n,a)}}}gB.createParser=Eur});var Jf=T(Ln=>{"use strict";p();Object.defineProperty(Ln,"__esModule",{value:!0});Ln.util=Ln.tokenizeFormulaModule=Ln.token=Ln.parseStructRefModule=Ln.parserState=Ln.parserService=Ln.parseResultHelperModule=Ln.parseRefModule=Ln.parser=Ln.parseQualifierModule=Ln.parseOperators=Ln.parseLiteralModule=Ln.parseFormulaModule=Ln.parseFieldRefModule=Ln.parseCommon=Ln.parseServiceTypes=Ln.analyzeServiceTypes=Ln.diagnostics=Ln.checker=Ln.autocorrect=Ln.analyzeService=Ln.PackageName=void 0;var ul=fe();Ln.PackageName="excel-online-calc-syntax";Ln.analyzeService=ul.__importStar(Q0e());Ln.autocorrect=ul.__importStar(YQ());Ln.checker=ul.__importStar(HQ());Ln.diagnostics=ul.__importStar(kG());Ln.analyzeServiceTypes=ul.__importStar(JQ());Ln.parseServiceTypes=ul.__importStar(eX());Ln.parseCommon=ul.__importStar(vh());Ln.parseFieldRefModule=ul.__importStar(JG());Ln.parseFormulaModule=ul.__importStar(kX());Ln.parseLiteralModule=ul.__importStar(AX());Ln.parseOperators=ul.__importStar(qT());Ln.parseQualifierModule=ul.__importStar(SX());Ln.parser=ul.__importStar(k0());Ln.parseRefModule=ul.__importStar(PX());Ln.parseResultHelperModule=ul.__importStar(qye());Ln.parserService=ul.__importStar(Zye());Ln.parserState=ul.__importStar(Fy());Ln.parseStructRefModule=ul.__importStar(OX());Ln.token=ul.__importStar(Og());Ln.tokenizeFormulaModule=ul.__importStar(BX());Ln.util=ul.__importStar(xX())});var $A=T(L0=>{"use strict";p();Object.defineProperty(L0,"__esModule",{value:!0});L0.parseLocals=L0.notFormulaString=L0.createParseGlobals=L0.ReasonKind=void 0;var vB=Jf();L0.ReasonKind=vB.parseServiceTypes.ReasonKind;L0.createParseGlobals=vB.parseServiceTypes.createParseGlobals;L0.notFormulaString=vB.parseServiceTypes.notFormulaString;L0.parseLocals=vB.parseServiceTypes.parseLocals});var cx=T(hB=>{"use strict";p();Object.defineProperty(hB,"__esModule",{value:!0});hB.createParser=void 0;var Pur=Jf();hB.createParser=Pur.parserService.createParser});var Db=T(wb=>{"use strict";p();Object.defineProperty(wb,"__esModule",{value:!0});wb.parseResultHelper=wb.CaretInsideArrayNodeIdentityVisitor=wb.ExtractLetVisitor=void 0;var UX=Jf();wb.ExtractLetVisitor=UX.parseResultHelperModule.ExtractLetVisitor;wb.CaretInsideArrayNodeIdentityVisitor=UX.parseResultHelperModule.CaretInsideArrayNodeIdentityVisitor;wb.parseResultHelper=UX.parseResultHelperModule.parseResultHelper});var VX=T(Ip=>{"use strict";p();Object.defineProperty(Ip,"__esModule",{value:!0});Ip.parseResultHelper=Ip.createParser=Ip.notFormulaString=Ip.parseLocals=Ip.ReasonKind=Ip.createParseGlobals=void 0;var KX=fe(),SB=KX.__importStar($A()),Aur=KX.__importStar(cx()),Fur=KX.__importStar(Db());Ip.createParseGlobals=SB.createParseGlobals;Ip.ReasonKind=SB.ReasonKind;Ip.parseLocals=SB.parseLocals;Ip.notFormulaString=SB.notFormulaString;Ip.createParser=Aur.createParser;Ip.parseResultHelper=Fur.parseResultHelper});var rF=T(wp=>{"use strict";p();Object.defineProperty(wp,"__esModule",{value:!0});wp.staticPrecedents=wp.summarizeFormulaDiagnostics=wp.diagnostics=wp.createAnalyzeGlobals=wp.analyzeLocalsName=wp.analyzeLocalsGrid=void 0;var eF=Jf();wp.analyzeLocalsGrid=eF.analyzeServiceTypes.analyzeLocalsGrid;wp.analyzeLocalsName=eF.analyzeServiceTypes.analyzeLocalsName;wp.createAnalyzeGlobals=eF.analyzeServiceTypes.createAnalyzeGlobals;wp.diagnostics=eF.analyzeServiceTypes.diagnostics;wp.summarizeFormulaDiagnostics=eF.analyzeServiceTypes.summarizeFormulaDiagnostics;wp.staticPrecedents=eF.analyzeServiceTypes.staticPrecedents});var tF=T(yB=>{"use strict";p();Object.defineProperty(yB,"__esModule",{value:!0});yB.createAnalyzer=void 0;var Nur=Jf();yB.createAnalyzer=Nur.analyzeService.createAnalyzer});var e_e=T(uf=>{"use strict";p();Object.defineProperty(uf,"__esModule",{value:!0});uf.createAnalyzer=uf.createAnalyzeGlobals=uf.staticPrecedents=uf.summarizeFormulaDiagnostics=uf.diagnostics=uf.analyzeLocalsName=uf.analyzeLocalsGrid=void 0;var $ye=fe(),nF=$ye.__importStar(rF()),Our=$ye.__importStar(tF());uf.analyzeLocalsGrid=nF.analyzeLocalsGrid;uf.analyzeLocalsName=nF.analyzeLocalsName;uf.diagnostics=nF.diagnostics;uf.summarizeFormulaDiagnostics=nF.summarizeFormulaDiagnostics;uf.staticPrecedents=nF.staticPrecedents;uf.createAnalyzeGlobals=nF.createAnalyzeGlobals;uf.createAnalyzer=Our.createAnalyzer});var aF=T(Ds=>{"use strict";p();Object.defineProperty(Ds,"__esModule",{value:!0});Ds.values=Ds.stringStartsWith=Ds.stringEndsWith=Ds.repeat=Ds.prependErrorMessage=Ds.partialArray=Ds.messageFromError=Ds.mathLog2=Ds.isInteger=Ds.arrayFill=void 0;var q0=pr();Ds.arrayFill=q0.util.arrayFill;Ds.isInteger=q0.util.isInteger;Ds.mathLog2=q0.util.mathLog2;Ds.messageFromError=q0.util.messageFromError;Ds.partialArray=q0.util.partialArray;Ds.prependErrorMessage=q0.util.prependErrorMessage;Ds.repeat=q0.util.repeat;Ds.stringEndsWith=q0.util.stringEndsWith;Ds.stringStartsWith=q0.util.stringStartsWith;Ds.values=q0.util.values});var jX=T(gn=>{"use strict";p();Object.defineProperty(gn,"__esModule",{value:!0});gn.valueErrorOper=gn.trueOper=gn.stringOper=gn.refErrorOper=gn.rangeSeqOper=gn.range3DOper=gn.precedents=gn.numErrorOper=gn.nullErrorOper=gn.nameErrorOper=gn.naErrorOper=gn.missingOper=gn.gettingDataErrorOper=gn.spillErrorOper=gn.fieldErrorOper=gn.falseOper=gn.errorOper=gn.div0ErrorOper=gn.cellStringLimit=gn.booleanOper=gn.blankOper=gn.arrayOper=gn.PrecsBound=gn.ErrorType=void 0;var Ku=qr();gn.ErrorType=Ku.value.ErrorType;gn.PrecsBound=Ku.value.PrecsBound;gn.arrayOper=Ku.value.arrayOper;gn.blankOper=Ku.value.blankOper;gn.booleanOper=Ku.value.booleanOper;gn.cellStringLimit=Ku.value.cellStringLimit;gn.div0ErrorOper=Ku.value.div0ErrorOper;gn.errorOper=Ku.value.errorOper;gn.falseOper=Ku.value.falseOper;gn.fieldErrorOper=Ku.value.fieldErrorOper;gn.spillErrorOper=Ku.value.spillErrorOper;gn.gettingDataErrorOper=Ku.value.gettingDataErrorOper;gn.missingOper=Ku.value.missingOper;gn.naErrorOper=Ku.value.naErrorOper;gn.nameErrorOper=Ku.value.nameErrorOper;gn.nullErrorOper=Ku.value.nullErrorOper;gn.numErrorOper=Ku.value.numErrorOper;gn.precedents=Ku.value.precedents;gn.range3DOper=Ku.value.range3DOper;gn.rangeSeqOper=Ku.value.rangeSeqOper;gn.refErrorOper=Ku.value.refErrorOper;gn.stringOper=Ku.value.stringOper;gn.trueOper=Ku.value.trueOper;gn.valueErrorOper=Ku.value.valueErrorOper});var Iy=T(De=>{"use strict";p();Object.defineProperty(De,"__esModule",{value:!0});De.isSheetGridRangeEqual=De.isSheetGridRange=De.isSheetGridCellEqual=De.isSheetGridCell=De.isRichOper=De.isReadOperEqual=De.isRangeOper=De.isRangeOpNoMissing=De.isRangeOpClosed=De.isPrimitiveOper=De.isOperatorNode=De.isNumberOper=De.isNumberLiteralNode=De.isNameScopeEqual=De.isMissingOper=De.isMissingNode=De.isGridRangeEqual=De.isGridCellEqual=De.isGridCell=De.isErrorOper=De.isDocumentLocEqual=De.isCommaOpRefWellFormed=De.isCommaOpNoBadOrMissing=De.isCommaOpClosed=De.isBooleanOper=De.isBooleanLiteralNode=De.isBlankOper=De.isArrayOper=De.internal=De.gridRangesJoin=De.gridRangeSize=De.gridRangeJoinOpt=De.gridRangeJoin=De.gridRangeIsects=De.gridRangeIsect=De.gridRangeExcept=De.gridRangeCompare=De.gridRangeAnchor=De.gridCellRange=De.gridCellImplicitIsect=De.getWorksheetFuncId=De.getUserDefinedFuncName=De.getBoundName=De.getArguments=De.getArgType=De.forEachTileInRange=De.forEachCellInRange=De.createFailureErrorClass=De.ReasonKind=De.LangReasonKind=void 0;De.applyComparison=De.unavailable=De.shouldFieldRefBeBracketed=De.sheetGridRangeAnchor=De.notImplemented=De.normalizeCommaOpRef=De.isWriteOper=De.isWellFormed=De.isWSFNode=De.isValidArgsLength=De.isUnqualifiedNameNode=De.isStringOper=De.isSheetIndexEqual=De.isSheetIndex=void 0;var ft=qr();De.LangReasonKind=ft.util.LangReasonKind;De.ReasonKind=ft.util.ReasonKind;De.createFailureErrorClass=ft.util.createFailureErrorClass;De.forEachCellInRange=ft.util.forEachCellInRange;De.forEachTileInRange=ft.util.forEachTileInRange;De.getArgType=ft.util.getArgType;De.getArguments=ft.util.getArguments;De.getBoundName=ft.util.getBoundName;De.getUserDefinedFuncName=ft.util.getUserDefinedFuncName;De.getWorksheetFuncId=ft.util.getWorksheetFuncId;De.gridCellImplicitIsect=ft.util.gridCellImplicitIsect;De.gridCellRange=ft.util.gridCellRange;De.gridRangeAnchor=ft.util.gridRangeAnchor;De.gridRangeCompare=ft.util.gridRangeCompare;De.gridRangeExcept=ft.util.gridRangeExcept;De.gridRangeIsect=ft.util.gridRangeIsect;De.gridRangeIsects=ft.util.gridRangeIsects;De.gridRangeJoin=ft.util.gridRangeJoin;De.gridRangeJoinOpt=ft.util.gridRangeJoinOpt;De.gridRangeSize=ft.util.gridRangeSize;De.gridRangesJoin=ft.util.gridRangesJoin;De.internal=ft.util.internal;De.isArrayOper=ft.util.isArrayOper;De.isBlankOper=ft.util.isBlankOper;De.isBooleanLiteralNode=ft.util.isBooleanLiteralNode;De.isBooleanOper=ft.util.isBooleanOper;De.isCommaOpClosed=ft.util.isCommaOpClosed;De.isCommaOpNoBadOrMissing=ft.util.isCommaOpNoBadOrMissing;De.isCommaOpRefWellFormed=ft.util.isCommaOpRefWellFormed;De.isDocumentLocEqual=ft.util.isDocumentLocEqual;De.isErrorOper=ft.util.isErrorOper;De.isGridCell=ft.util.isGridCell;De.isGridCellEqual=ft.util.isGridCellEqual;De.isGridRangeEqual=ft.util.isGridRangeEqual;De.isMissingNode=ft.util.isMissingNode;De.isMissingOper=ft.util.isMissingOper;De.isNameScopeEqual=ft.util.isNameScopeEqual;De.isNumberLiteralNode=ft.util.isNumberLiteralNode;De.isNumberOper=ft.util.isNumberOper;De.isOperatorNode=ft.util.isOperatorNode;De.isPrimitiveOper=ft.util.isPrimitiveOper;De.isRangeOpClosed=ft.util.isRangeOpClosed;De.isRangeOpNoMissing=ft.util.isRangeOpNoMissing;De.isRangeOper=ft.util.isRangeOper;De.isReadOperEqual=ft.util.isReadOperEqual;De.isRichOper=ft.util.isRichOper;De.isSheetGridCell=ft.util.isSheetGridCell;De.isSheetGridCellEqual=ft.util.isSheetGridCellEqual;De.isSheetGridRange=ft.util.isSheetGridRange;De.isSheetGridRangeEqual=ft.util.isSheetGridRangeEqual;De.isSheetIndex=ft.util.isSheetIndex;De.isSheetIndexEqual=ft.util.isSheetIndexEqual;De.isStringOper=ft.util.isStringOper;De.isUnqualifiedNameNode=ft.util.isUnqualifiedNameNode;De.isValidArgsLength=ft.util.isValidArgsLength;De.isWSFNode=ft.util.isWSFNode;De.isWellFormed=ft.util.isWellFormed;De.isWriteOper=ft.util.isWriteOper;De.normalizeCommaOpRef=ft.util.normalizeCommaOpRef;De.notImplemented=ft.util.notImplemented;De.sheetGridRangeAnchor=ft.util.sheetGridRangeAnchor;De.shouldFieldRefBeBracketed=ft.util.shouldFieldRefBeBracketed;De.unavailable=ft.util.unavailable;De.applyComparison=ft.util.applyComparison});var jT=T(on=>{"use strict";p();Object.defineProperty(on,"__esModule",{value:!0});on.now=on.mapFromArrayOfPairs=on.singleton=on.typedInstanceCreator=on.makeStringCompareCI=on.fastAbs=on.fastMax=on.fastMin=on.pair=on.filterOutNones=on.isNone=on.isDefined=on.safeConcat=on.safePush=on.strEnumArray=on.numEnumMap=on.numEnumArray=on.cloneStringMap=on.makeStringMap=on.identity=on.staticAssertIsOptional=on.staticAssertIs=on.staticAssertSame=on.staticAssertExtends=on.makeNewtypeIso=void 0;var bu=pr();on.makeNewtypeIso=bu.core.makeNewtypeIso;on.staticAssertExtends=bu.core.staticAssertExtends;on.staticAssertSame=bu.core.staticAssertSame;on.staticAssertIs=bu.core.staticAssertIs;on.staticAssertIsOptional=bu.core.staticAssertIsOptional;on.identity=bu.core.identity;on.makeStringMap=bu.core.makeStringMap;on.cloneStringMap=bu.core.cloneStringMap;on.numEnumArray=bu.core.numEnumArray;on.numEnumMap=bu.core.numEnumMap;on.strEnumArray=bu.core.strEnumArray;on.safePush=bu.core.safePush;on.safeConcat=bu.core.safeConcat;on.isDefined=bu.core.isDefined;on.isNone=bu.core.isNone;on.filterOutNones=bu.core.filterOutNones;on.pair=bu.core.pair;on.fastMin=bu.core.fastMin;on.fastMax=bu.core.fastMax;on.fastAbs=bu.core.fastAbs;on.makeStringCompareCI=bu.core.makeStringCompareCI;on.typedInstanceCreator=bu.core.typedInstanceCreator;on.singleton=bu.core.singleton;on.mapFromArrayOfPairs=bu.core.mapFromArrayOfPairs;on.now=bu.core.now});var bh=T(sf=>{"use strict";p();Object.defineProperty(sf,"__esModule",{value:!0});sf.successUndefined=sf.success=sf.javaScriptError=sf.isSuccess=sf.failure=sf.ResultKind=sf.ReasonKind=void 0;var WT=pr();sf.ReasonKind=WT.result.ReasonKind;sf.ResultKind=WT.result.ResultKind;sf.failure=WT.result.failure;sf.isSuccess=WT.result.isSuccess;sf.javaScriptError=WT.result.javaScriptError;sf.success=WT.result.success;sf.successUndefined=WT.result.successUndefined});var G0=T(sr=>{"use strict";p();Object.defineProperty(sr,"__esModule",{value:!0});sr.evalFormatLocalsGrid=sr.createFormatGlobals=sr.NumberFormatSource=sr.otherEdit=sr.numberEdit=sr.stringEdit=sr.formulaEdit=sr.EditKind=sr.renderedValueToString=sr.renderInfiniteWidth=sr.memoizedRenderCallback=sr.renderCallback=sr.isHashesValue=sr.renderedValue=sr.formattedValue=sr.hashesValue=sr.formattedUnitFlexible=sr.formattedUnitBlank=sr.formattedUnitString=sr.formattedUnitGeneral=sr.FormattedUnitKind=sr.Clip=sr.GetTimeKind=sr.Alignment=sr.NamedColor=sr.FormatCurrency=sr.isFormatCultureEqual=sr.isSystemCultureTag=sr.CultureTag=sr.BidiDate=sr.FormatValueType=sr.formatLocIFormat=sr.formatLocKnownFormat=sr.FormatLocKind=sr.previousFormatFailure=sr.aggregationError=sr.fractionOverflow=sr.dateOverflow=sr.tooWide=sr.noFormatPart=sr.notFormatString=sr.notValueString=sr.ReasonKind=sr.FormatReasonKind=void 0;var r_e=fe(),l_e=Iy(),kur=jT(),t_e=bh(),WX;(function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.AggregationError="AggregationError",e.PreviousFormatFailure="PreviousFormatFailure"})(WX||(sr.FormatReasonKind=WX={}));sr.ReasonKind=r_e.__assign(r_e.__assign({},l_e.LangReasonKind),WX);function Mur(e){return{kind:sr.ReasonKind.NotValueString,message:e}}sr.notValueString=Mur;function xur(e){return{kind:sr.ReasonKind.NotFormatString,message:e}}sr.notFormatString=xur;sr.noFormatPart={kind:sr.ReasonKind.NoFormatPart};function Iur(e){return{kind:sr.ReasonKind.TooWide,clip:e}}sr.tooWide=Iur;sr.dateOverflow={kind:sr.ReasonKind.DateOverflow};sr.fractionOverflow={kind:sr.ReasonKind.FractionOverflow};sr.aggregationError={kind:sr.ReasonKind.AggregationError};function wur(e){return{kind:sr.ReasonKind.PreviousFormatFailure,format:e}}sr.previousFormatFailure=wur;var _B;(function(e){e.FormatString="FormatString",e.KnownFormat="KnownFormat",e.IFormat="IFormat"})(_B||(sr.FormatLocKind=_B={}));function Dur(e,r){return{kind:_B.KnownFormat,document:e,knownFormat:r}}sr.formatLocKnownFormat=Dur;function Lur(e,r){return{kind:_B.IFormat,document:e,iformat:r}}sr.formatLocIFormat=Lur;var n_e;(function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"})(n_e||(sr.FormatValueType=n_e={}));var a_e;(function(e){e.English="English",e.Lunar="Lunar"})(a_e||(sr.BidiDate=a_e={}));var bB;(function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"})(bB||(sr.CultureTag=bB={}));function qur(e){return e===bB.SysDate||e===bB.SysTime}sr.isSystemCultureTag=qur;function Gur(e,r){return e.culture===r.culture&&e.numberShape===r.numberShape&&e.nationalNumberInput===r.nationalNumberInput&&e.calendar===r.calendar&&e.localCalendarInput===r.localCalendarInput&&e.tag===r.tag}sr.isFormatCultureEqual=Gur;var i_e;(function(e){e[e.LocaleInfo=0]="LocaleInfo"})(i_e||(sr.FormatCurrency=i_e={}));var o_e;(function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"})(o_e||(sr.NamedColor=o_e={}));var HX;(function(e){e.Left="Left",e.Center="Center",e.Right="Right"})(HX||(sr.Alignment=HX={}));var u_e;(function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"})(u_e||(sr.GetTimeKind=u_e={}));var zX;(function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"})(zX||(sr.Clip=zX={}));var Lb;(function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"})(Lb||(sr.FormattedUnitKind=Lb={}));function Bur(e,r,t,n,a,o){return{kind:Lb.General,num:e,decimalSeparator:r,includeSign:t,numberShape:n,expNumberShape:a,builtin:o}}sr.formattedUnitGeneral=Bur;function Uur(e){return{kind:Lb.String,str:e}}sr.formattedUnitString=Uur;function Kur(e){return{kind:Lb.Blank,str:e}}sr.formattedUnitBlank=Kur;function Vur(e){return{kind:Lb.Flexible,str:e}}sr.formattedUnitFlexible=Vur;function QX(e,r,t,n){return{units:e,color:r,alignment:t,clip:n}}function jur(e,r){return QX(e,r,HX.Center,zX.All)}sr.hashesValue=jur;sr.formattedValue=QX;sr.renderedValue=QX;function Wur(e){return!Array.isArray(e.units)}sr.isHashesValue=Wur;function c_e(e,r,t){return{renderWidth:e,bestFit:t,getTextWidth:r}}sr.renderCallback=c_e;function Hur(e){var r=(0,kur.makeStringMap)(),t=function(a){if(r[a]!=null)return r[a];var o=e.getTextWidth(a);return r[a]=o,o};return c_e(e.renderWidth,t,e.bestFit)}sr.memoizedRenderCallback=Hur;sr.renderInfiniteWidth={renderWidth:1/0,bestFit:!1,getTextWidth:function(r){return r.length}};function zur(e){for(var r="",t=0,n=e.units;t<n.length;t++){var a=n[t];switch(a.kind){case Lb.String:r+=a.str;break;case Lb.Blank:for(var o=0;o<a.str.length;o+=1)r+=" ";break}}return r}sr.renderedValueToString=zur;var iF;(function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"})(iF||(sr.EditKind=iF={}));function Qur(e){return{kind:iF.Formula,fmla:e}}sr.formulaEdit=Qur;function Xur(e,r){return{kind:iF.String,value:e,tick:r}}sr.stringEdit=Xur;function Yur(e,r){return{kind:iF.Number,value:e,format:r}}sr.numberEdit=Yur;function Jur(e){return{kind:iF.Other,value:e}}sr.otherEdit=Jur;var s_e;(function(e){e.Builtin="Builtin",e.CustomString="CustomString",e.CustomBytecode="CustomBytecode",e.System="System"})(s_e||(sr.NumberFormatSource=s_e={}));function Zur(e,r){return{config:e,getTime:r}}sr.createFormatGlobals=Zur;function $ur(e,r){var t=(0,l_e.sheetGridRangeAnchor)(e.range),n=(0,t_e.success)(t.range),a=(0,t_e.success)(t.sheet);return{config:r??void 0,lexicalSource:e,originGridCell:n,originSheet:a,allowUnqualifiedCell:!0,wrapCellReferences:!1}}sr.evalFormatLocalsGrid=$ur});var TB=T(B0=>{"use strict";p();Object.defineProperty(B0,"__esModule",{value:!0});B0.parseUint=B0.parseSignedLiteral=B0.parseNumberLiteral=B0.isSpace=void 0;var CB=qr();B0.isSpace=CB.literalParse.isSpace;B0.parseNumberLiteral=CB.literalParse.parseNumberLiteral;B0.parseSignedLiteral=CB.literalParse.parseSignedLiteral;B0.parseUint=CB.literalParse.parseUint});var Ch=T(wg=>{"use strict";p();Object.defineProperty(wg,"__esModule",{value:!0});wg.NumberShape=wg.KnownFormat=wg.DateOrder=wg.CurrencyFormat=wg.Calendar=void 0;var dx=qr();wg.Calendar=dx.numfmt.Calendar;wg.CurrencyFormat=dx.numfmt.CurrencyFormat;wg.DateOrder=dx.numfmt.DateOrder;wg.KnownFormat=dx.numfmt.KnownFormat;wg.NumberShape=dx.numfmt.NumberShape});var HT=T(Rt=>{"use strict";p();Object.defineProperty(Rt,"__esModule",{value:!0});Rt.ulsLogger=Rt.operatorIdToName=Rt.localeInfo=Rt.isNumeral=Rt.getOrdinal=Rt.getNumberShape=Rt.getEnglishWorksheetFuncIdToName=Rt.getEnglishLocaleInfo=Rt.englishWorksheetFuncIdToName=Rt.englishSysTimeFormat=Rt.englishSysDateFormat=Rt.englishSpecialRefNames=Rt.englishPictureSpecial=Rt.englishPictureSingle=Rt.englishPictureDbnum=Rt.englishPictureColor=Rt.englishOperatorIdToName=Rt.englishErrorTypeToName=Rt.englishErrorNames=Rt.createWorksheetFuncNameCallbacks=Rt.calcConfig=Rt.TraceLevel=Rt.PictureSpecial=Rt.PictureSingle=Rt.PictureDbnum=Rt.PictureColor=Rt.NulLogger=Rt.LogCategory=Rt.LCID=Rt.Country=void 0;var to=qr();Rt.Country=to.config.Country;Rt.LCID=to.config.LCID;Rt.LogCategory=to.config.LogCategory;Rt.NulLogger=to.config.NulLogger;Rt.PictureColor=to.config.PictureColor;Rt.PictureDbnum=to.config.PictureDbnum;Rt.PictureSingle=to.config.PictureSingle;Rt.PictureSpecial=to.config.PictureSpecial;Rt.TraceLevel=to.config.TraceLevel;Rt.calcConfig=to.config.calcConfig;Rt.createWorksheetFuncNameCallbacks=to.config.createWorksheetFuncNameCallbacks;Rt.englishErrorNames=to.config.englishErrorNames;Rt.englishErrorTypeToName=to.config.englishErrorTypeToName;Rt.englishOperatorIdToName=to.config.englishOperatorIdToName;Rt.englishPictureColor=to.config.englishPictureColor;Rt.englishPictureDbnum=to.config.englishPictureDbnum;Rt.englishPictureSingle=to.config.englishPictureSingle;Rt.englishPictureSpecial=to.config.englishPictureSpecial;Rt.englishSpecialRefNames=to.config.englishSpecialRefNames;Rt.englishSysDateFormat=to.config.englishSysDateFormat;Rt.englishSysTimeFormat=to.config.englishSysTimeFormat;Rt.englishWorksheetFuncIdToName=to.config.englishWorksheetFuncIdToName;Rt.getEnglishLocaleInfo=to.config.getEnglishLocaleInfo;Rt.getEnglishWorksheetFuncIdToName=to.config.getEnglishWorksheetFuncIdToName;Rt.getNumberShape=to.config.getNumberShape;Rt.getOrdinal=to.config.getOrdinal;Rt.isNumeral=to.config.isNumeral;Rt.localeInfo=to.config.localeInfo;Rt.operatorIdToName=to.config.operatorIdToName;Rt.ulsLogger=to.config.ulsLogger});var U0=T(Nl=>{"use strict";p();Object.defineProperty(Nl,"__esModule",{value:!0});Nl.assertPositiveLength=Nl.assertPositiveInteger=Nl.assertInteger=Nl.assertIndex=Nl.assertNatural=Nl.assertNever=Nl.assertFalse=Nl.assertTrue=Nl.ulsLogger=void 0;var wy=pr();Nl.ulsLogger=wy.assertions.ulsLogger;Nl.assertTrue=wy.assertions.assertTrue;Nl.assertFalse=wy.assertions.assertFalse;Nl.assertNever=wy.assertions.assertNever;Nl.assertNatural=wy.assertions.assertNatural;Nl.assertIndex=wy.assertions.assertIndex;Nl.assertInteger=wy.assertions.assertInteger;Nl.assertPositiveInteger=wy.assertions.assertPositiveInteger;Nl.assertPositiveLength=wy.assertions.assertPositiveLength});var RB=T(Vu=>{"use strict";p();Object.defineProperty(Vu,"__esModule",{value:!0});Vu.surrogatePairToCodePoint=Vu.stringFromCodePoint=Vu.stringCodePointAt=Vu.scanCodePointsBack=Vu.scanCodePoints=Vu.numCodeUnits=Vu.isLowSurrogate=Vu.isHighSurrogate=Vu.isAnySurrogate=Vu.countCodePoints=Vu.codePointIterator=void 0;var Th=pr();Vu.codePointIterator=Th.unicode.codePointIterator;Vu.countCodePoints=Th.unicode.countCodePoints;Vu.isAnySurrogate=Th.unicode.isAnySurrogate;Vu.isHighSurrogate=Th.unicode.isHighSurrogate;Vu.isLowSurrogate=Th.unicode.isLowSurrogate;Vu.numCodeUnits=Th.unicode.numCodeUnits;Vu.scanCodePoints=Th.unicode.scanCodePoints;Vu.scanCodePointsBack=Th.unicode.scanCodePointsBack;Vu.stringCodePointAt=Th.unicode.stringCodePointAt;Vu.stringFromCodePoint=Th.unicode.stringFromCodePoint;Vu.surrogatePairToCodePoint=Th.unicode.surrogatePairToCodePoint});var fx=T(le=>{"use strict";p();Object.defineProperty(le,"__esModule",{value:!0});le.codePointExclamationMark=le.codePointEuroSign=le.codePointEqualsSign=le.codePointDoubleQuote=le.codePointDollarSign=le.codePointDigitZero=le.codePointDigitTwo=le.codePointDigitThree=le.codePointDigitSix=le.codePointDigitSeven=le.codePointDigitOne=le.codePointDigitNine=le.codePointDigitFour=le.codePointDigitFive=le.codePointDigitEight=le.codePointComma=le.codePointColon=le.codePointCircumflexAccent=le.codePointCapitalZ=le.codePointCapitalY=le.codePointCapitalX=le.codePointCapitalW=le.codePointCapitalV=le.codePointCapitalU=le.codePointCapitalT=le.codePointCapitalS=le.codePointCapitalR=le.codePointCapitalQ=le.codePointCapitalP=le.codePointCapitalO=le.codePointCapitalN=le.codePointCapitalM=le.codePointCapitalL=le.codePointCapitalK=le.codePointCapitalJ=le.codePointCapitalI=le.codePointCapitalH=le.codePointCapitalG=le.codePointCapitalF=le.codePointCapitalE=le.codePointCapitalD=le.codePointCapitalC=le.codePointCapitalB=le.codePointCapitalA=le.codePointCR=le.codePointBacktick=le.codePointBackslash=le.codePointAtSign=le.codePointAsterisk=le.codePointAmpersand=void 0;le.codePointSmallW=le.codePointSmallV=le.codePointSmallU=le.codePointSmallT=le.codePointSmallS=le.codePointSmallR=le.codePointSmallQ=le.codePointSmallP=le.codePointSmallO=le.codePointSmallN=le.codePointSmallM=le.codePointSmallL=le.codePointSmallK=le.codePointSmallJ=le.codePointSmallI=le.codePointSmallH=le.codePointSmallG=le.codePointSmallF=le.codePointSmallE=le.codePointSmallD=le.codePointSmallC=le.codePointSmallB=le.codePointSmallA=le.codePointSlash=le.codePointSingleQuote=le.codePointSemicolon=le.codePointRightSquareBracket=le.codePointRightParen=le.codePointRightCurlyBracket=le.codePointQuestionMark=le.codePointPlusSign=le.codePointPipe=le.codePointPercentSign=le.codePointMinusSign=le.codePointLessThanSign=le.codePointLeftSquareBracket=le.codePointLeftParen=le.codePointLeftCurlyBracket=le.codePointLF=le.codePointInvertedQuestionMark=le.codePointInvertedExclamationMark=le.codePointHash=le.codePointGreaterThanSign=le.codePointFullwidthLatinSmallZ=le.codePointFullwidthLatinSmallA=le.codePointFullwidthLatinCapitalZ=le.codePointFullwidthLatinCapitalA=le.codePointFullwidthDigitZero=le.codePointFullwidthDigitNine=le.codePointFullStop=void 0;le.codePointUnderscore=le.codePointTilde=le.codePointThaiDigitZero=le.codePointThaiDigitNine=le.codePointTab=le.codePointSpace=le.codePointSmallZ=le.codePointSmallY=le.codePointSmallX=void 0;var Ye=pr();le.codePointAmpersand=Ye.codePoint.codePointAmpersand;le.codePointAsterisk=Ye.codePoint.codePointAsterisk;le.codePointAtSign=Ye.codePoint.codePointAtSign;le.codePointBackslash=Ye.codePoint.codePointBackslash;le.codePointBacktick=Ye.codePoint.codePointBacktick;le.codePointCR=Ye.codePoint.codePointCR;le.codePointCapitalA=Ye.codePoint.codePointCapitalA;le.codePointCapitalB=Ye.codePoint.codePointCapitalB;le.codePointCapitalC=Ye.codePoint.codePointCapitalC;le.codePointCapitalD=Ye.codePoint.codePointCapitalD;le.codePointCapitalE=Ye.codePoint.codePointCapitalE;le.codePointCapitalF=Ye.codePoint.codePointCapitalF;le.codePointCapitalG=Ye.codePoint.codePointCapitalG;le.codePointCapitalH=Ye.codePoint.codePointCapitalH;le.codePointCapitalI=Ye.codePoint.codePointCapitalI;le.codePointCapitalJ=Ye.codePoint.codePointCapitalJ;le.codePointCapitalK=Ye.codePoint.codePointCapitalK;le.codePointCapitalL=Ye.codePoint.codePointCapitalL;le.codePointCapitalM=Ye.codePoint.codePointCapitalM;le.codePointCapitalN=Ye.codePoint.codePointCapitalN;le.codePointCapitalO=Ye.codePoint.codePointCapitalO;le.codePointCapitalP=Ye.codePoint.codePointCapitalP;le.codePointCapitalQ=Ye.codePoint.codePointCapitalQ;le.codePointCapitalR=Ye.codePoint.codePointCapitalR;le.codePointCapitalS=Ye.codePoint.codePointCapitalS;le.codePointCapitalT=Ye.codePoint.codePointCapitalT;le.codePointCapitalU=Ye.codePoint.codePointCapitalU;le.codePointCapitalV=Ye.codePoint.codePointCapitalV;le.codePointCapitalW=Ye.codePoint.codePointCapitalW;le.codePointCapitalX=Ye.codePoint.codePointCapitalX;le.codePointCapitalY=Ye.codePoint.codePointCapitalY;le.codePointCapitalZ=Ye.codePoint.codePointCapitalZ;le.codePointCircumflexAccent=Ye.codePoint.codePointCircumflexAccent;le.codePointColon=Ye.codePoint.codePointColon;le.codePointComma=Ye.codePoint.codePointComma;le.codePointDigitEight=Ye.codePoint.codePointDigitEight;le.codePointDigitFive=Ye.codePoint.codePointDigitFive;le.codePointDigitFour=Ye.codePoint.codePointDigitFour;le.codePointDigitNine=Ye.codePoint.codePointDigitNine;le.codePointDigitOne=Ye.codePoint.codePointDigitOne;le.codePointDigitSeven=Ye.codePoint.codePointDigitSeven;le.codePointDigitSix=Ye.codePoint.codePointDigitSix;le.codePointDigitThree=Ye.codePoint.codePointDigitThree;le.codePointDigitTwo=Ye.codePoint.codePointDigitTwo;le.codePointDigitZero=Ye.codePoint.codePointDigitZero;le.codePointDollarSign=Ye.codePoint.codePointDollarSign;le.codePointDoubleQuote=Ye.codePoint.codePointDoubleQuote;le.codePointEqualsSign=Ye.codePoint.codePointEqualsSign;le.codePointEuroSign=Ye.codePoint.codePointEuroSign;le.codePointExclamationMark=Ye.codePoint.codePointExclamationMark;le.codePointFullStop=Ye.codePoint.codePointFullStop;le.codePointFullwidthDigitNine=Ye.codePoint.codePointFullwidthDigitNine;le.codePointFullwidthDigitZero=Ye.codePoint.codePointFullwidthDigitZero;le.codePointFullwidthLatinCapitalA=Ye.codePoint.codePointFullwidthLatinCapitalA;le.codePointFullwidthLatinCapitalZ=Ye.codePoint.codePointFullwidthLatinCapitalZ;le.codePointFullwidthLatinSmallA=Ye.codePoint.codePointFullwidthLatinSmallA;le.codePointFullwidthLatinSmallZ=Ye.codePoint.codePointFullwidthLatinSmallZ;le.codePointGreaterThanSign=Ye.codePoint.codePointGreaterThanSign;le.codePointHash=Ye.codePoint.codePointHash;le.codePointInvertedExclamationMark=Ye.codePoint.codePointInvertedExclamationMark;le.codePointInvertedQuestionMark=Ye.codePoint.codePointInvertedQuestionMark;le.codePointLF=Ye.codePoint.codePointLF;le.codePointLeftCurlyBracket=Ye.codePoint.codePointLeftCurlyBracket;le.codePointLeftParen=Ye.codePoint.codePointLeftParen;le.codePointLeftSquareBracket=Ye.codePoint.codePointLeftSquareBracket;le.codePointLessThanSign=Ye.codePoint.codePointLessThanSign;le.codePointMinusSign=Ye.codePoint.codePointMinusSign;le.codePointPercentSign=Ye.codePoint.codePointPercentSign;le.codePointPipe=Ye.codePoint.codePointPipe;le.codePointPlusSign=Ye.codePoint.codePointPlusSign;le.codePointQuestionMark=Ye.codePoint.codePointQuestionMark;le.codePointRightCurlyBracket=Ye.codePoint.codePointRightCurlyBracket;le.codePointRightParen=Ye.codePoint.codePointRightParen;le.codePointRightSquareBracket=Ye.codePoint.codePointRightSquareBracket;le.codePointSemicolon=Ye.codePoint.codePointSemicolon;le.codePointSingleQuote=Ye.codePoint.codePointSingleQuote;le.codePointSlash=Ye.codePoint.codePointSlash;le.codePointSmallA=Ye.codePoint.codePointSmallA;le.codePointSmallB=Ye.codePoint.codePointSmallB;le.codePointSmallC=Ye.codePoint.codePointSmallC;le.codePointSmallD=Ye.codePoint.codePointSmallD;le.codePointSmallE=Ye.codePoint.codePointSmallE;le.codePointSmallF=Ye.codePoint.codePointSmallF;le.codePointSmallG=Ye.codePoint.codePointSmallG;le.codePointSmallH=Ye.codePoint.codePointSmallH;le.codePointSmallI=Ye.codePoint.codePointSmallI;le.codePointSmallJ=Ye.codePoint.codePointSmallJ;le.codePointSmallK=Ye.codePoint.codePointSmallK;le.codePointSmallL=Ye.codePoint.codePointSmallL;le.codePointSmallM=Ye.codePoint.codePointSmallM;le.codePointSmallN=Ye.codePoint.codePointSmallN;le.codePointSmallO=Ye.codePoint.codePointSmallO;le.codePointSmallP=Ye.codePoint.codePointSmallP;le.codePointSmallQ=Ye.codePoint.codePointSmallQ;le.codePointSmallR=Ye.codePoint.codePointSmallR;le.codePointSmallS=Ye.codePoint.codePointSmallS;le.codePointSmallT=Ye.codePoint.codePointSmallT;le.codePointSmallU=Ye.codePoint.codePointSmallU;le.codePointSmallV=Ye.codePoint.codePointSmallV;le.codePointSmallW=Ye.codePoint.codePointSmallW;le.codePointSmallX=Ye.codePoint.codePointSmallX;le.codePointSmallY=Ye.codePoint.codePointSmallY;le.codePointSmallZ=Ye.codePoint.codePointSmallZ;le.codePointSpace=Ye.codePoint.codePointSpace;le.codePointTab=Ye.codePoint.codePointTab;le.codePointThaiDigitNine=Ye.codePoint.codePointThaiDigitNine;le.codePointThaiDigitZero=Ye.codePoint.codePointThaiDigitZero;le.codePointTilde=Ye.codePoint.codePointTilde;le.codePointUnderscore=Ye.codePoint.codePointUnderscore});var gx=T(Gb=>{"use strict";p();var Ol,Zf;Object.defineProperty(Gb,"__esModule",{value:!0});Gb.insertCommas=Gb.convertNumberShape=Gb.convertDigitsShape=void 0;var esr=fe(),mx=U0(),Dg=RB(),JX=esr.__importStar(fx()),fr=Ch(),qb=JX.codePointDigitZero,d_e=JX.codePointDigitNine,XX=JX.codePointDigitOne,rsr=(Ol={},Ol[fr.NumberShape.ArabicIndic]={zero:1632,one:1633},Ol[fr.NumberShape.ExtendedArabicIndic]={zero:1776,one:1777},Ol[fr.NumberShape.Devanagari]={zero:2406,one:2407},Ol[fr.NumberShape.Bengali]={zero:2534,one:2535},Ol[fr.NumberShape.Gurmukhi]={zero:2662,one:2663},Ol[fr.NumberShape.Gujarati]={zero:2790,one:2791},Ol[fr.NumberShape.Oriya]={zero:2918,one:2919},Ol[fr.NumberShape.Tamil]={zero:48,one:3047},Ol[fr.NumberShape.Telugu]={zero:3174,one:3175},Ol[fr.NumberShape.Kannada]={zero:3302,one:3303},Ol[fr.NumberShape.Malayalam]={zero:3430,one:3431},Ol[fr.NumberShape.Thai]={zero:3664,one:3665},Ol[fr.NumberShape.Lao]={zero:3792,one:3793},Ol[fr.NumberShape.Tibetan]={zero:3872,one:3873},Ol[fr.NumberShape.Myanmar]={zero:4160,one:4161},Ol[fr.NumberShape.Ethiopic]={zero:48,one:4969},Ol[fr.NumberShape.Khmer]={zero:6112,one:6113},Ol[fr.NumberShape.Mongolian]={zero:6160,one:6161},Ol),f_e=(Zf={},Zf[fr.NumberShape.Japanese1]={digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:1},Zf[fr.NumberShape.Japanese2]={digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:2},Zf[fr.NumberShape.Japanese3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Japanese",dbnum:3},Zf[fr.NumberShape.Korean1]={digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:1},Zf[fr.NumberShape.Korean2]={digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:2},Zf[fr.NumberShape.Korean3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806,langId:"Korean",dbnum:3},Zf[fr.NumberShape.Korean4]={digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312,langId:"Korean",dbnum:4},Zf[fr.NumberShape.ChineseSimp1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:1},Zf[fr.NumberShape.ChineseSimp2]={digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:2},Zf[fr.NumberShape.ChineseSimp3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806,langId:"ChineseSimp",dbnum:3},Zf[fr.NumberShape.ChineseTrad1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:1},Zf[fr.NumberShape.ChineseTrad2]={digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:2},Zf[fr.NumberShape.ChineseTrad3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806,langId:"ChineseTrad",dbnum:3},Zf);function YX(e,r){if(r===fr.NumberShape.ASCII)return e;switch(r){case fr.NumberShape.ArabicIndic:case fr.NumberShape.ExtendedArabicIndic:case fr.NumberShape.Devanagari:case fr.NumberShape.Bengali:case fr.NumberShape.Gurmukhi:case fr.NumberShape.Gujarati:case fr.NumberShape.Oriya:case fr.NumberShape.Tamil:case fr.NumberShape.Telugu:case fr.NumberShape.Kannada:case fr.NumberShape.Malayalam:case fr.NumberShape.Thai:case fr.NumberShape.Lao:case fr.NumberShape.Tibetan:case fr.NumberShape.Myanmar:case fr.NumberShape.Ethiopic:case fr.NumberShape.Khmer:case fr.NumberShape.Mongolian:{for(var t="",n=rsr[r],a=0;a<e.length;a+=1){var o=e.charCodeAt(a);(0,mx.assertTrue)("calc.numfmt.convertDigitsShape",qb<=o&&o<=d_e),o===qb?t+=(0,Dg.stringFromCodePoint)(n.zero):t+=(0,Dg.stringFromCodePoint)(n.one+(o-XX))}return t}case fr.NumberShape.ChineseTrad1:case fr.NumberShape.ChineseTrad2:case fr.NumberShape.ChineseTrad3:case fr.NumberShape.ChineseSimp1:case fr.NumberShape.ChineseSimp2:case fr.NumberShape.ChineseSimp3:case fr.NumberShape.Japanese1:case fr.NumberShape.Japanese2:case fr.NumberShape.Japanese3:case fr.NumberShape.Korean1:case fr.NumberShape.Korean2:case fr.NumberShape.Korean3:case fr.NumberShape.Korean4:{for(var t="",n=f_e[r],a=0;a<e.length;a+=1){var o=e.charCodeAt(a);t+=zT(n,o)}return t}}}Gb.convertDigitsShape=YX;function zT(e,r){return(0,mx.assertTrue)("calc.numfmt.ideographicDigit",qb<=r&&r<=d_e),(0,Dg.stringFromCodePoint)(e.digits[r-qb])}var $f;(function(e){e[e.Ten=10]="Ten",e[e.Hundred=11]="Hundred",e[e.Thousand=12]="Thousand",e[e.TenThousand=13]="TenThousand",e[e.HundredMillion=14]="HundredMillion",e[e.Trillion=15]="Trillion"})($f||($f={}));function px(e,r){switch(r){case $f.Ten:return(0,Dg.stringFromCodePoint)(e.ten);case $f.Hundred:return(0,Dg.stringFromCodePoint)(e.hundred);case $f.Thousand:return(0,Dg.stringFromCodePoint)(e.thousand);case $f.TenThousand:return(0,Dg.stringFromCodePoint)(e.tenThousand);case $f.HundredMillion:return(0,Dg.stringFromCodePoint)(e.hundredMillion);case $f.Trillion:return(0,Dg.stringFromCodePoint)(e.trillion);default:return(0,mx.assertFalse)("calc.numfmt.ideographicRank")}}function tsr(e,r,t){var n=e.decimalSeparator;if(t===fr.NumberShape.ASCII)return r;switch(t){case fr.NumberShape.ArabicIndic:case fr.NumberShape.ExtendedArabicIndic:case fr.NumberShape.Devanagari:case fr.NumberShape.Bengali:case fr.NumberShape.Gurmukhi:case fr.NumberShape.Gujarati:case fr.NumberShape.Oriya:case fr.NumberShape.Tamil:case fr.NumberShape.Telugu:case fr.NumberShape.Kannada:case fr.NumberShape.Malayalam:case fr.NumberShape.Thai:case fr.NumberShape.Lao:case fr.NumberShape.Tibetan:case fr.NumberShape.Myanmar:case fr.NumberShape.Ethiopic:case fr.NumberShape.Khmer:case fr.NumberShape.Mongolian:{var a=r.indexOf(n),o=YX(r.substring(0,a<0?void 0:a),t),u=a<0?"":n,s=a<0?"":YX(r.substring(a+n.length),t);return o+u+s}case fr.NumberShape.ChineseTrad1:case fr.NumberShape.ChineseTrad2:case fr.NumberShape.ChineseTrad3:case fr.NumberShape.ChineseSimp1:case fr.NumberShape.ChineseSimp2:case fr.NumberShape.ChineseSimp3:case fr.NumberShape.Japanese1:case fr.NumberShape.Japanese2:case fr.NumberShape.Japanese3:case fr.NumberShape.Korean1:case fr.NumberShape.Korean2:case fr.NumberShape.Korean3:case fr.NumberShape.Korean4:{var l=f_e[t],c=l.langId==="ChineseSimp"||l.langId==="ChineseTrad",d=l.dbnum===2||l.langId==="Korean"&&(l.dbnum===1||l.dbnum===4),a=r.indexOf(n),f=0,m=a<0?r.length:a,v="";if(m>12){if(m>16)for(;12<m;m--,f++){var h=r.charCodeAt(f);v+=zT(l,h)}else{var y=16,_=$f.Thousand,E=!1;do{if(y>m){y--,_--;continue}var h=r.charCodeAt(f);h!==qb?((c||d||h>XX||y%4===1)&&(c&&E&&(v+=zT(l,qb),E=!1),v+=zT(l,h)),_>=$f.Ten&&(v+=px(l,_))):E=!0,y--,_--,m--,f++}while(y>12)}v+=px(l,$f.Trillion)}{var y=12;do{var _=$f.Thousand,N=!1,E=!1;do{if(y>m){y--,_--;continue}var h=r.charCodeAt(f);h!==qb||v.length===0?((c||d||h>XX||y%4===1)&&(c&&E&&(v+=zT(l,qb),E=!1),v+=zT(l,h)),_>=$f.Ten&&(v+=px(l,_)),N=!0):E=!0,y--,_--,m--,f++}while(y%4);N&&m/4!==0&&(m===8?v+=px(l,$f.HundredMillion):m===4&&(v+=px(l,$f.TenThousand)))}while(m>0)}if(f!==r.length)for((0,mx.assertTrue)("calc.numfmt.convertNumberShape",a>=0&&f===a),v+=n,f=a+n.length;f<r.length;f++){var h=r.charCodeAt(f);v+=zT(l,h)}return v}default:return(0,mx.assertNever)("calc.numfmt.convertNumberShape",t)}}Gb.convertNumberShape=tsr;function nsr(e,r,t){if(r==="")return"";for(var n=(0,Dg.countCodePoints)(r,0,r.length),a="",o=0,u=0;o<r.length;){var s=(0,Dg.stringCodePointAt)(r,o),l=(0,Dg.numCodeUnits)(s);a+=r.substring(o,o+l),o+=l,u+=1,e.isThousandsPosition(t+(n-u))&&(a+=e.thousandsSeparator)}return a}Gb.insertCommas=nsr});var ZX=T(Bc=>{"use strict";p();Object.defineProperty(Bc,"__esModule",{value:!0});Bc.unknownFunctionType=Bc.operatorStrings=Bc.higherOrderFunctionType=Bc.getWorksheetFuncType=Bc.getWorksheetFuncEnglishName=Bc.getOperatorType=Bc.WorksheetFuncId=Bc.OperatorId=void 0;var Bb=qr();Bc.OperatorId=Bb.signature.OperatorId;Bc.WorksheetFuncId=Bb.signature.WorksheetFuncId;Bc.getOperatorType=Bb.signature.getOperatorType;Bc.getWorksheetFuncEnglishName=Bb.signature.getWorksheetFuncEnglishName;Bc.getWorksheetFuncType=Bb.signature.getWorksheetFuncType;Bc.higherOrderFunctionType=Bb.signature.higherOrderFunctionType;Bc.operatorStrings=Bb.signature.operatorStrings;Bc.unknownFunctionType=Bb.signature.unknownFunctionType});var m_e=T(oF=>{"use strict";p();Object.defineProperty(oF,"__esModule",{value:!0});oF.numberComponents=oF.formatScientificLeft=void 0;var p_e=qr();oF.formatScientificLeft=p_e.mathpack.formatScientificLeft;oF.numberComponents=p_e.mathpack.numberComponents});var $X=T(lf=>{"use strict";p();Object.defineProperty(lf,"__esModule",{value:!0});lf.xlDatepack=lf.tzUTC=lf.tzData=lf.dateTime=lf.TimeGranularity=lf.TimeDivision=lf.Rounding=void 0;var QT=qr();lf.Rounding=QT.datepack.Rounding;lf.TimeDivision=QT.datepack.TimeDivision;lf.TimeGranularity=QT.datepack.TimeGranularity;lf.dateTime=QT.datepack.dateTime;lf.tzData=QT.datepack.tzData;lf.tzUTC=QT.datepack.tzUTC;lf.xlDatepack=QT.datepack.xlDatepack});var FB=T(Kb=>{"use strict";p();Object.defineProperty(Kb,"__esModule",{value:!0});Kb.renderHashesValue=Kb.renderValue=Kb.renderGeneral=void 0;var Qa=G0(),asr=Iy(),XT=U0(),vx=jT(),eY=gx(),AB=aF(),Ub=bh(),isr=function(r){return r.kind!==Qa.FormattedUnitKind.General},g_e=function(r){return r.kind!==Qa.FormattedUnitKind.Flexible},aY=255;function EB(e,r,t){if(r&Qa.Clip.MaxChars&&t.length>aY)return Qa.Clip.MaxChars;if(r&Qa.Clip.CellWidth&&e.renderWidth<1/0&&e.getTextWidth(t)>e.renderWidth)return Qa.Clip.CellWidth}function rY(e,r,t,n,a,o,u){var s=(0,vx.fastMax)(0,aY-t.length-n.length),l=a.length===0?s:Math.floor(s/a.length);if(e.renderWidth!==1/0){var c=e.getTextWidth(a);c>0&&(l=(0,vx.fastMin)(l,(0,vx.fastMax)(Math.floor((e.renderWidth-e.getTextWidth(t+n))/c),0)))}var d=u(l),f=e.bestFit;if(f&&o&&(d===!1||d.indexOf("E")>=0)){for(var m=1,v=d;(v===!1||v.indexOf("E")>=0)&&l+m<=tY;)v=u(l+m),m++;if(v!==!1)return v}var h;if(d===!1||(h=EB(e,r,t+d+n))===void 0){for(var y=d,_=l+1;_<l+50;_+=1){var E=u(_);if(E!==!1){if(E===y)break;var N=EB(e,r,t+E+n);if(N!==void 0){y===!1&&(y=N);break}y=E}}return(0,XT.assertTrue)("calc.numfmt.renderValue: false after upwards search",y!==!1),y}for(var k=h,_=l-1;_>=0;_-=1){var E=u(_);if(E===!1)break;var N=EB(e,r,t+E+n);if(N===void 0)return E;k=N}return k}var PB=(0,asr.createFailureErrorClass)("RenderHashesError"),tY=11;function nY(e,r,t){var n=e.fromNumber(r.num),a=r.includeSign&&e.cond(n)<0?"-":"",o=a+e.formatGeneral(r,e.abs(n),t-a.length);if(o==="-0"&&(o="0"),o.length>t)return!1;var u=o.indexOf("E");if(u>=0){var s=(0,eY.convertNumberShape)(r,o.substring(0,u),r.expNumberShape),l=o.substring(u,u+2),c=(0,eY.convertDigitsShape)(o.substring(u+2),r.expNumberShape);return(0,XT.assertTrue)("calc.numfmt.render: formatGeneral ePart",l==="E-"||l==="E+"),s+l+c}return(0,eY.convertNumberShape)(r,o,r.numberShape)}Kb.renderGeneral=nY;function osr(e,r,t){var n=r.units,a=r.color,o=r.alignment,u=r.clip,s=(0,Qa.memoizedRenderCallback)(t),l;if(n.every(isr))l=n;else if(s.renderWidth===1/0)l=n.map(function(X){if(X.kind!==Qa.FormattedUnitKind.General)return X;var ee=nY(e,X,tY);return(0,XT.assertTrue)("calc.numfmt.renderValue: false after format at defaultGenPrecision",ee!==!1),(0,Qa.formattedUnitString)(ee)});else{for(var c="",d="",f=void 0,m=void 0,v=0;v<n.length;v+=1){var h=n[v];switch(h.kind){case Qa.FormattedUnitKind.String:case Qa.FormattedUnitKind.Blank:f!==void 0?d+=h.str:c+=h.str;break;case Qa.FormattedUnitKind.General:(0,XT.assertTrue)("calc.numfmt.renderValue: expected a single General unit",f===void 0),f=v,m=h;break;case Qa.FormattedUnitKind.Flexible:break}}(0,XT.assertTrue)("calc.numfmt.renderValue: genUnit",f!==void 0&&m!==void 0);var y=m,_=rY(s,u,c,d,"0",y.builtin,function(X){return nY(e,y,(0,vx.fastMin)(X,tY))});if(typeof _=="number")throw new PB((0,Qa.tooWide)(_));l=n.map(function(X){return X.kind===Qa.FormattedUnitKind.General?(0,Qa.formattedUnitString)(_):X})}var E;if(l.every(g_e))E=l;else if(s.renderWidth===1/0||s.bestFit)E=l.filter(g_e);else{for(var c="",d="",N,k=void 0,v=0;v<l.length;v+=1){var q=l[v];switch(q.kind){case Qa.FormattedUnitKind.String:case Qa.FormattedUnitKind.Blank:N!==void 0?d+=q.str:c+=q.str;break;case Qa.FormattedUnitKind.Flexible:N=v,k=q;break}}(0,XT.assertTrue)("calc.numfmt.renderValue: lastFlexUnit",N!==void 0&&k!==void 0);var V=k,I=rY(s,Qa.Clip.All,c,d,k.str,!1,function(re){return(0,AB.repeat)(V.str,re)});if(typeof I=="number"){if(I&u)throw new PB((0,Qa.tooWide)(I));I=""}var M=I.length/V.str.length;M=(0,vx.fastMax)(M-1,0);var B=(0,AB.repeat)(V.str,M);E=l.map(function(re,Z){return re.kind!==Qa.FormattedUnitKind.Flexible?re:(0,Qa.formattedUnitString)(Z===N?B:"")})}if(u!==Qa.Clip.None){for(var U="",v=0;v<E.length;v+=1)U+=E[v].str;var j=EB(s,u,U);if(s.bestFit&&j===Qa.Clip.CellWidth)return(0,Qa.renderedValue)(E,a,o,u);if(j!==void 0)throw new PB((0,Qa.tooWide)(j))}return(0,Qa.renderedValue)(E,a,o,u)}function usr(e,r,t){try{return(0,Qa.isHashesValue)(r)?(0,Ub.success)((0,Qa.hashesValue)(r.units,r.color)):(0,Ub.success)(osr(e,r,t))}catch(n){return n instanceof PB?(0,Ub.success)((0,Qa.hashesValue)(n.reason,r.color)):(0,Ub.failure)((0,Ub.javaScriptError)(n))}}Kb.renderValue=usr;function ssr(e,r){try{var t=(0,Qa.memoizedRenderCallback)(r),n=rY(t,e.clip,"","","#",!1,function(o){return(0,AB.repeat)("#",o)});if(typeof n=="number")switch(n){case Qa.Clip.MaxChars:n=(0,AB.repeat)("#",aY);break;case Qa.Clip.CellWidth:n="";break;default:return(0,XT.assertNever)("calc.numFmt.renderHashesValue",n)}var a=(0,Qa.formattedUnitString)(n);return(0,Ub.success)((0,Qa.renderedValue)([a],e.color,e.alignment,e.clip))}catch(o){return(0,Ub.failure)((0,Ub.javaScriptError)(o))}}Kb.renderHashesValue=ssr});var NB=T(Lg=>{"use strict";p();Object.defineProperty(Lg,"__esModule",{value:!0});Lg.functionType=Lg.SpecialPrecs=Lg.SignatureType=Lg.OperKind=Lg.FunctionFlags=void 0;var hx=qr();Lg.FunctionFlags=hx.types.FunctionFlags;Lg.OperKind=hx.types.OperKind;Lg.SignatureType=hx.types.SignatureType;Lg.SpecialPrecs=hx.types.SpecialPrecs;Lg.functionType=hx.types.functionType});var v_e=T(K0=>{"use strict";p();Object.defineProperty(K0,"__esModule",{value:!0});K0.kindAnonymizers=K0.anonymizeMagnitude=K0.anonymizeFormulaString=K0.anonymize=void 0;var OB=pr();K0.anonymize=OB.anonymizer.anonymize;K0.anonymizeFormulaString=OB.anonymizer.anonymizeFormulaString;K0.anonymizeMagnitude=OB.anonymizer.anonymizeMagnitude;K0.kindAnonymizers=OB.anonymizer.kindAnonymizers});var oY=T(uF=>{"use strict";p();var Nt;Object.defineProperty(uF,"__esModule",{value:!0});uF.convertKnownLCID=uF.getBundledLocaleInfo=void 0;var wt=HT(),h_e=U0(),S_e={ar:[["\u064A\u0646\u0627\u064A\u0631","\u0641\u0628\u0631\u0627\u064A\u0631","\u0645\u0627\u0631\u0633","\u0623\u0628\u0631\u064A\u0644","\u0645\u0627\u064A\u0648","\u064A\u0648\u0646\u064A\u0648","\u064A\u0648\u0644\u064A\u0648","\u0623\u063A\u0633\u0637\u0633","\u0633\u0628\u062A\u0645\u0628\u0631","\u0623\u0643\u062A\u0648\u0628\u0631","\u0646\u0648\u0641\u0645\u0628\u0631","\u062F\u064A\u0633\u0645\u0628\u0631"],["\u064A\u0646\u0627\u064A\u0631","\u0641\u0628\u0631\u0627\u064A\u0631","\u0645\u0627\u0631\u0633","\u0623\u0628\u0631\u064A\u0644","\u0645\u0627\u064A\u0648","\u064A\u0648\u0646\u064A\u0648","\u064A\u0648\u0644\u064A\u0648","\u0623\u063A\u0633\u0637\u0633","\u0633\u0628\u062A\u0645\u0628\u0631","\u0623\u0643\u062A\u0648\u0628\u0631","\u0646\u0648\u0641\u0645\u0628\u0631","\u062F\u064A\u0633\u0645\u0628\u0631"],["\u0627\u0644\u0623\u062D\u062F","\u0627\u0644\u0625\u062B\u0646\u064A\u0646","\u0627\u0644\u062B\u0644\u0627\u062B\u0627\u0621","\u0627\u0644\u0623\u0631\u0628\u0639\u0627\u0621","\u0627\u0644\u062E\u0645\u064A\u0633","\u0627\u0644\u062C\u0645\u0639\u0629","\u0627\u0644\u0633\u0628\u062A"],["\u0627\u0644\u0623\u062D\u062F","\u0627\u0644\u0625\u062B\u0646\u064A\u0646","\u0627\u0644\u062B\u0644\u0627\u062B\u0627\u0621","\u0627\u0644\u0623\u0631\u0628\u0639\u0627\u0621","\u0627\u0644\u062E\u0645\u064A\u0633","\u0627\u0644\u062C\u0645\u0639\u0629","\u0627\u0644\u0633\u0628\u062A"],["\u0635","\u0645"],"z"],en:[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["AM","PM"],"z"],es:[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","set","oct.","nov.","dic."],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],["do.","lu.","ma.","mi.","ju.","vi.","s\xE1."],["domingo","lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado"],["a. m.","p. m."],"z"],fr:[["janv.","f\xE9vr.","mars","avr.","mai","juin","juil.","ao\xFBt","sept.","oct.","nov.","d\xE9c."],["janvier","f\xE9vrier","mars","avril","mai","juin","juillet","ao\xFBt","septembre","octobre","novembre","d\xE9cembre"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"en","z"],zh:[["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"],["\u9031\u65E5","\u9031\u4E00","\u9031\u4E8C","\u9031\u4E09","\u9031\u56DB","\u9031\u4E94","\u9031\u516D"],["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],["\u4E0A\u5348","\u4E0B\u5348"],"s"],de:[["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"en","z"],hr:[["sij","vlj","o\u017Eu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],["sije\u010Danj","velja\u010Da","o\u017Eujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac"],["ned","pon","uto","sri","\u010Det","pet","sub"],["nedjelja","ponedjeljak","utorak","srijeda","\u010Detvrtak","petak","subota"],"en","z"],nl:[["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],["zo","ma","di","wo","do","vr","za"],["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],"en","z"],sv:[["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],["s\xF6n","m\xE5n","tis","ons","tor","fre","l\xF6r"],["s\xF6ndag","m\xE5ndag","tisdag","onsdag","torsdag","fredag","l\xF6rdag"],"en","z"],it:[["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],["dom","lun","mar","mer","gio","ven","sab"],["domenica","luned\xEC","marted\xEC","mercoled\xEC","gioved\xEC","venerd\xEC","sabato"],"en","z"],ro:[["ian.","feb.","mar.","apr.","mai","iun.","iul.","aug.","sept.","oct.","nov.","dec."],["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],["dum.","lun.","mar.","mie.","joi","vin.","s\xE2m."],["duminic\u0103","luni","mar\u021Bi","miercuri","joi","vineri","s\xE2mb\u0103t\u0103"],["a.m.","p.m."],"z"],ru:[["\u044F\u043D\u0432","\u0444\u0435\u0432","\u043C\u0430\u0440","\u0430\u043F\u0440","\u043C\u0430\u0439","\u0438\u044E\u043D","\u0438\u044E\u043B","\u0430\u0432\u0433","\u0441\u0435\u043D","\u043E\u043A\u0442","\u043D\u043E\u044F","\u0434\u0435\u043A"],["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0432\u0440\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"],["\u0412\u0441","\u041F\u043D","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041F\u0442","\u0421\u0431"],["\u0432\u043E\u0441\u043A\u0440\u0435\u0441\u0435\u043D\u044C\u0435","\u043F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A","\u0432\u0442\u043E\u0440\u043D\u0438\u043A","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043F\u044F\u0442\u043D\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043E\u0442\u0430"],"en","z"],sr:[["jan","feb","mar","apr","maj","jun","jul","avg","sep","okt","nov","dec"],["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],["ned","pon","uto","sre","\u010Det","pet","sub"],["nedelja","ponedeljak","utorak","sreda","\u010Detvrtak","petak","subota"],["pre podne","po podne"],"z"],uk:[["\u0421\u0456\u0447","\u041B\u044E\u0442","\u0411\u0435\u0440","\u041A\u0432\u0456","\u0422\u0440\u0430","\u0427\u0435\u0440","\u041B\u0438\u043F","\u0421\u0435\u0440","\u0412\u0435\u0440","\u0416\u043E\u0432","\u041B\u0438\u0441","\u0413\u0440\u0443"],["\u0441\u0456\u0447\u0435\u043D\u044C","\u043B\u044E\u0442\u0438\u0439","\u0431\u0435\u0440\u0435\u0437\u0435\u043D\u044C","\u043A\u0432\u0456\u0442\u0435\u043D\u044C","\u0442\u0440\u0430\u0432\u0435\u043D\u044C","\u0447\u0435\u0440\u0432\u0435\u043D\u044C","\u043B\u0438\u043F\u0435\u043D\u044C","\u0441\u0435\u0440\u043F\u0435\u043D\u044C","\u0432\u0435\u0440\u0435\u0441\u0435\u043D\u044C","\u0436\u043E\u0432\u0442\u0435\u043D\u044C","\u043B\u0438\u0441\u0442\u043E\u043F\u0430\u0434","\u0433\u0440\u0443\u0434\u0435\u043D\u044C"],["\u041D\u0434","\u041F\u043D","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041F\u0442","\u0421\u0431"],["\u043D\u0435\u0434\u0456\u043B\u044F","\u043F\u043E\u043D\u0435\u0434\u0456\u043B\u043E\u043A","\u0432\u0456\u0432\u0442\u043E\u0440\u043E\u043A","\u0441\u0435\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440","\u043F'\u044F\u0442\u043D\u0438\u0446\u044F","\u0441\u0443\u0431\u043E\u0442\u0430"],"en","z"],bg:[["\u044F\u043D\u0443","\u0444\u0435\u0432","\u043C\u0430\u0440","\u0430\u043F\u0440","\u043C\u0430\u0439","\u044E\u043D\u0438","\u044E\u043B\u0438","\u0430\u0432\u0433","\u0441\u0435\u043F","\u043E\u043A\u0442","\u043D\u043E\u0435","\u0434\u0435\u043A"],["\u044F\u043D\u0443\u0430\u0440\u0438","\u0444\u0435\u0432\u0440\u0443\u0430\u0440\u0438","\u043C\u0430\u0440\u0442","\u0430\u043F\u0440\u0438\u043B","\u043C\u0430\u0439","\u044E\u043D\u0438","\u044E\u043B\u0438","\u0430\u0432\u0433\u0443\u0441\u0442","\u0441\u0435\u043F\u0442\u0435\u043C\u0432\u0440\u0438","\u043E\u043A\u0442\u043E\u043C\u0432\u0440\u0438","\u043D\u043E\u0435\u043C\u0432\u0440\u0438","\u0434\u0435\u043A\u0435\u043C\u0432\u0440\u0438"],["\u043D\u0435\u0434","\u043F\u043E\u043D","\u0432\u0442","\u0441\u0440","\u0447\u0435\u0442\u0432","\u043F\u0435\u0442","\u0441\u044A\u0431"],["\u043D\u0435\u0434\u0435\u043B\u044F","\u043F\u043E\u043D\u0435\u0434\u0435\u043B\u043D\u0438\u043A","\u0432\u0442\u043E\u0440\u043D\u0438\u043A","\u0441\u0440\u044F\u0434\u0430","\u0447\u0435\u0442\u0432\u044A\u0440\u0442\u044A\u043A","\u043F\u0435\u0442\u044A\u043A","\u0441\u044A\u0431\u043E\u0442\u0430"],"en","z"],cs:[["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],["leden","\xFAnor","b\u0159ezen","duben","kv\u011Bten","\u010Derven","\u010Dervenec","srpen","z\xE1\u0159\xED","\u0159\xEDjen","listopad","prosinec"],["ne","po","\xFAt","st","\u010Dt","p\xE1","so"],["ned\u011Ble","pond\u011Bl\xED","\xFAter\xFD","st\u0159eda","\u010Dtvrtek","p\xE1tek","sobota"],["dop.","odp."],"z"],da:["sv",["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],["s\xF8","ma","ti","on","to","fr","l\xF8"],["s\xF8ndag","mandag","tirsdag","onsdag","torsdag","fredag","l\xF8rdag"],"sv","z"],el:[["\u0399\u03B1\u03BD","\u03A6\u03B5\u03B2","\u039C\u03B1\u03C1","\u0391\u03C0\u03C1","\u039C\u03B1\u03CA","\u0399\u03BF\u03C5\u03BD","\u0399\u03BF\u03C5\u03BB","\u0391\u03C5\u03B3","\u03A3\u03B5\u03C0","\u039F\u03BA\u03C4","\u039D\u03BF\u03B5","\u0394\u03B5\u03BA"],["\u0399\u03B1\u03BD\u03BF\u03C5\u03AC\u03C1\u03B9\u03BF\u03C2","\u03A6\u03B5\u03B2\u03C1\u03BF\u03C5\u03AC\u03C1\u03B9\u03BF\u03C2","\u039C\u03AC\u03C1\u03C4\u03B9\u03BF\u03C2","\u0391\u03C0\u03C1\u03AF\u03BB\u03B9\u03BF\u03C2","\u039C\u03AC\u03B9\u03BF\u03C2","\u0399\u03BF\u03CD\u03BD\u03B9\u03BF\u03C2","\u0399\u03BF\u03CD\u03BB\u03B9\u03BF\u03C2","\u0391\u03CD\u03B3\u03BF\u03C5\u03C3\u03C4\u03BF\u03C2","\u03A3\u03B5\u03C0\u03C4\u03AD\u03BC\u03B2\u03C1\u03B9\u03BF\u03C2","\u039F\u03BA\u03C4\u03CE\u03B2\u03C1\u03B9\u03BF\u03C2","\u039D\u03BF\u03AD\u03BC\u03B2\u03C1\u03B9\u03BF\u03C2","\u0394\u03B5\u03BA\u03AD\u03BC\u03B2\u03C1\u03B9\u03BF\u03C2"],["\u039A\u03C5\u03C1","\u0394\u03B5\u03C5","\u03A4\u03C1\u03B9","\u03A4\u03B5\u03C4","\u03A0\u03B5\u03BC","\u03A0\u03B1\u03C1","\u03A3\u03B1\u03B2"],["\u039A\u03C5\u03C1\u03B9\u03B1\u03BA\u03AE","\u0394\u03B5\u03C5\u03C4\u03AD\u03C1\u03B1","\u03A4\u03C1\u03AF\u03C4\u03B7","\u03A4\u03B5\u03C4\u03AC\u03C1\u03C4\u03B7","\u03A0\u03AD\u03BC\u03C0\u03C4\u03B7","\u03A0\u03B1\u03C1\u03B1\u03C3\u03BA\u03B5\u03C5\u03AE","\u03A3\u03AC\u03B2\u03B2\u03B1\u03C4\u03BF"],["\u03C0\u03BC","\u03BC\u03BC"],"z"],et:[["jaan","veebr","m\xE4rts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],["jaanuar","veebruar","m\xE4rts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],["P","E","T","K","N","R","L"],["p\xFChap\xE4ev","esmasp\xE4ev","teisip\xE4ev","kolmap\xE4ev","neljap\xE4ev","reede","laup\xE4ev"],"en","z"],fi:[["tammi","helmi","maalis","huhti","touko","kes\xE4","hein\xE4","elo","syys","loka","marras","joulu"],["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kes\xE4kuu","hein\xE4kuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],["su","ma","ti","ke","to","pe","la"],["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],["ap.","ip."],"z"],he:[["\u05D9\u05E0\u05D5","\u05E4\u05D1\u05E8","\u05DE\u05E8\u05E5","\u05D0\u05E4\u05E8","\u05DE\u05D0\u05D9","\u05D9\u05D5\u05E0","\u05D9\u05D5\u05DC","\u05D0\u05D5\u05D2","\u05E1\u05E4\u05D8","\u05D0\u05D5\u05E7","\u05E0\u05D5\u05D1","\u05D3\u05E6\u05DE"],["\u05D9\u05E0\u05D5\u05D0\u05E8","\u05E4\u05D1\u05E8\u05D5\u05D0\u05E8","\u05DE\u05E8\u05E5","\u05D0\u05E4\u05E8\u05D9\u05DC","\u05DE\u05D0\u05D9","\u05D9\u05D5\u05E0\u05D9","\u05D9\u05D5\u05DC\u05D9","\u05D0\u05D5\u05D2\u05D5\u05E1\u05D8","\u05E1\u05E4\u05D8\u05DE\u05D1\u05E8","\u05D0\u05D5\u05E7\u05D8\u05D5\u05D1\u05E8","\u05E0\u05D5\u05D1\u05DE\u05D1\u05E8","\u05D3\u05E6\u05DE\u05D1\u05E8"],["\u05D9\u05D5\u05DD\xA0\u05D0","\u05D9\u05D5\u05DD\xA0\u05D1","\u05D9\u05D5\u05DD\xA0\u05D2","\u05D9\u05D5\u05DD\xA0\u05D3","\u05D9\u05D5\u05DD\xA0\u05D4","\u05D9\u05D5\u05DD\xA0\u05D5","\u05E9\u05D1\u05EA"],["\u05D9\u05D5\u05DD\xA0\u05E8\u05D0\u05E9\u05D5\u05DF","\u05D9\u05D5\u05DD\xA0\u05E9\u05E0\u05D9","\u05D9\u05D5\u05DD\xA0\u05E9\u05DC\u05D9\u05E9\u05D9","\u05D9\u05D5\u05DD\xA0\u05E8\u05D1\u05D9\u05E2\u05D9","\u05D9\u05D5\u05DD\xA0\u05D7\u05DE\u05D9\u05E9\u05D9","\u05D9\u05D5\u05DD\xA0\u05E9\u05D9\u05E9\u05D9","\u05E9\u05D1\u05EA"],"en","z"],hu:[["jan.","febr.","m\xE1rc.","\xE1pr.","m\xE1j.","j\xFAn.","j\xFAl.","aug.","szept.","okt.","nov.","dec."],["janu\xE1r","febru\xE1r","m\xE1rcius","\xE1prilis","m\xE1jus","j\xFAnius","j\xFAlius","augusztus","szeptember","okt\xF3ber","november","december"],["V","H","K","Sze","Cs","P","Szo"],["vas\xE1rnap","h\xE9tf\u0151","kedd","szerda","cs\xFCt\xF6rt\xF6k","p\xE9ntek","szombat"],["de.","du."],"z"],id:[["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],["Mgg","Sen","Sel","Rab","Kam","Jum","Sab"],["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"en","z"],ja:[["1","2","3","4","5","6","7","8","9","10","11","12"],["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],["\u65E5","\u6708","\u706B","\u6C34","\u6728","\u91D1","\u571F"],["\u65E5\u66DC\u65E5","\u6708\u66DC\u65E5","\u706B\u66DC\u65E5","\u6C34\u66DC\u65E5","\u6728\u66DC\u65E5","\u91D1\u66DC\u65E5","\u571F\u66DC\u65E5"],["\u5348\u524D","\u5348\u5F8C"],"j"],ko:["ja",["1\uC6D4","2\uC6D4","3\uC6D4","4\uC6D4","5\uC6D4","6\uC6D4","7\uC6D4","8\uC6D4","9\uC6D4","10\uC6D4","11\uC6D4","12\uC6D4"],["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"],["\uC77C\uC694\uC77C","\uC6D4\uC694\uC77C","\uD654\uC694\uC77C","\uC218\uC694\uC77C","\uBAA9\uC694\uC77C","\uAE08\uC694\uC77C","\uD1A0\uC694\uC77C"],["\uC624\uC804","\uC624\uD6C4"],"k"],lt:[["saus.","vas.","kov.","bal.","geg.","bir\u017E.","liep.","rugp.","rugs.","spal.","lapkr.","gruod."],["sausis","vasaris","kovas","balandis","gegu\u017E\u0117","bir\u017Eelis","liepa","rugpj\u016Btis","rugs\u0117jis","spalis","lapkritis","gruodis"],["sk","pr","an","tr","kt","pn","\u0161t"],["sekmadienis","pirmadienis","antradienis","tre\u010Diadienis","ketvirtadienis","penktadienis","\u0161e\u0161tadienis"],["prie\u0161piet","popiet"],"z"],lv:[["janv.","febr.","marts","apr.","maijs","j\u016Bn.","j\u016Bl.","aug.","sept.","okt.","nov.","dec."],["janv\u0101ris","febru\u0101ris","marts","apr\u012Blis","maijs","j\u016Bnijs","j\u016Blijs","augusts","septembris","oktobris","novembris","decembris"],["sv\u0113td.","pirmd.","otrd.","tre\u0161d.","ceturtd.","piektd.","sestd."],["sv\u0113tdiena","pirmdiena","otrdiena","tre\u0161diena","ceturtdiena","piektdiena","sestdiena"],["priek\u0161p.","p\u0113cp."],"z"],nb:[["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"],["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],["s\xF8n","man","tir","ons","tor","fre","l\xF8r"],"da","ro","z"],pl:[["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa\u017A","lis","gru"],["stycze\u0144","luty","marzec","kwiecie\u0144","maj","czerwiec","lipiec","sierpie\u0144","wrzesie\u0144","pa\u017Adziernik","listopad","grudzie\u0144"],["niedz.","pon.","wt.","\u015Br.","czw.","pt.","sob."],["niedziela","poniedzia\u0142ek","wtorek","\u015Broda","czwartek","pi\u0105tek","sobota"],"en","z"],pt:[["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],["janeiro","fevereiro","mar\xE7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],["dom","seg","ter","qua","qui","sex","s\xE1b"],["domingo","segunda-feira","ter\xE7a-feira","quarta-feira","quinta-feira","sexta-feira","s\xE1bado"],"en","z"],sk:["ja",["janu\xE1r","febru\xE1r","marec","apr\xEDl","m\xE1j","j\xFAn","j\xFAl","august","september","okt\xF3ber","november","december"],["ne","po","ut","st","\u0161t","pi","so"],["nede\u013Ea","pondelok","utorok","streda","\u0161tvrtok","piatok","sobota"],"en","z"],sl:[["jan.","feb.","mar.","apr.","maj","jun.","jul.","avg.","sep.","okt.","nov.","dec."],["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],["ned.","pon.","tor.","sre.","\u010Det.","pet.","sob."],["nedelja","ponedeljek","torek","sreda","\u010Detrtek","petek","sobota"],["dop.","pop."],"z"],th:[["\u0E21.\u0E04.","\u0E01.\u0E1E.","\u0E21\u0E35.\u0E04.","\u0E40\u0E21.\u0E22.","\u0E1E.\u0E04.","\u0E21\u0E34.\u0E22.","\u0E01.\u0E04.","\u0E2A.\u0E04.","\u0E01.\u0E22.","\u0E15.\u0E04.","\u0E1E.\u0E22.","\u0E18.\u0E04."],["\u0E21\u0E01\u0E23\u0E32\u0E04\u0E21","\u0E01\u0E38\u0E21\u0E20\u0E32\u0E1E\u0E31\u0E19\u0E18\u0E4C","\u0E21\u0E35\u0E19\u0E32\u0E04\u0E21","\u0E40\u0E21\u0E29\u0E32\u0E22\u0E19","\u0E1E\u0E24\u0E29\u0E20\u0E32\u0E04\u0E21","\u0E21\u0E34\u0E16\u0E38\u0E19\u0E32\u0E22\u0E19","\u0E01\u0E23\u0E01\u0E0E\u0E32\u0E04\u0E21","\u0E2A\u0E34\u0E07\u0E2B\u0E32\u0E04\u0E21","\u0E01\u0E31\u0E19\u0E22\u0E32\u0E22\u0E19","\u0E15\u0E38\u0E25\u0E32\u0E04\u0E21","\u0E1E\u0E24\u0E28\u0E08\u0E34\u0E01\u0E32\u0E22\u0E19","\u0E18\u0E31\u0E19\u0E27\u0E32\u0E04\u0E21"],["\u0E2D\u0E32.","\u0E08.","\u0E2D.","\u0E1E.","\u0E1E\u0E24.","\u0E28.","\u0E2A."],["\u0E2D\u0E32\u0E17\u0E34\u0E15\u0E22\u0E4C","\u0E08\u0E31\u0E19\u0E17\u0E23\u0E4C","\u0E2D\u0E31\u0E07\u0E04\u0E32\u0E23","\u0E1E\u0E38\u0E18","\u0E1E\u0E24\u0E2B\u0E31\u0E2A\u0E1A\u0E14\u0E35","\u0E28\u0E38\u0E01\u0E23\u0E4C","\u0E40\u0E2A\u0E32\u0E23\u0E4C"],"en","z"],tr:[["Oca","\u015Eub","Mar","Nis","May","Haz","Tem","A\u011Fu","Eyl","Eki","Kas","Ara"],["Ocak","\u015Eubat","Mart","Nisan","May\u0131s","Haziran","Temmuz","A\u011Fustos","Eyl\xFCl","Ekim","Kas\u0131m","Aral\u0131k"],["Paz","Pzt","Sal","\xC7ar","Per","Cum","Cmt"],["Pazar","Pazartesi","Sal\u0131","\xC7ar\u015Famba","Per\u015Fembe","Cuma","Cumartesi"],["\xD6\xD6","\xD6S"],"z"],vi:[["Thg1","Thg2","Thg3","Thg4","Thg5","Thg6","Thg7","Thg8","Thg9","Thg10","Thg11","Thg12"],["Tha\u0301ng Gi\xEAng","Tha\u0301ng Hai","Tha\u0301ng Ba","Tha\u0301ng T\u01B0","Tha\u0301ng N\u0103m","Tha\u0301ng Sa\u0301u","Tha\u0301ng Ba\u0309y","Tha\u0301ng Ta\u0301m","Tha\u0301ng Chi\u0301n","Tha\u0301ng M\u01B0\u01A1\u0300i","Tha\u0301ng M\u01B0\u01A1\u0300i M\xF4\u0323t","Tha\u0301ng M\u01B0\u01A1\u0300i Hai"],["CN","T2","T3","T4","T5","T6","T7"],["Chu\u0309 Nh\xE2\u0323t","Th\u01B0\u0301 Hai","Th\u01B0\u0301 Ba","Th\u01B0\u0301 T\u01B0","Th\u01B0\u0301 N\u0103m","Th\u01B0\u0301 Sa\u0301u","Th\u01B0\u0301 Ba\u0309y"],["SA","CH"],"z"],ta:[["\u0B9C\u0BA9\u0BB5\u0BB0\u0BBF","\u0BAA\u0BBF\u0BAA\u0BCD\u0BB0\u0BB5\u0BB0\u0BBF","\u0BAE\u0BBE\u0BB0\u0BCD\u0B9A\u0BCD","\u0B8F\u0BAA\u0BCD\u0BB0\u0BB2\u0BCD","\u0BAE\u0BC7","\u0B9C\u0BC2\u0BA9\u0BCD","\u0B9C\u0BC2\u0BB2\u0BC8","\u0B86\u0B95\u0BB8\u0BCD\u0B9F\u0BCD","\u0B9A\u0BC6\u0BAA\u0BCD\u0B9F\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD","\u0B85\u0B95\u0BCD\u0B9F\u0BCB\u0BAA\u0BB0\u0BCD","\u0BA8\u0BB5\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD","\u0B9F\u0BBF\u0B9A\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD"],["\u0B9C\u0BA9\u0BB5\u0BB0\u0BBF","\u0BAA\u0BBF\u0BAA\u0BCD\u0BB0\u0BB5\u0BB0\u0BBF","\u0BAE\u0BBE\u0BB0\u0BCD\u0B9A\u0BCD","\u0B8F\u0BAA\u0BCD\u0BB0\u0BB2\u0BCD","\u0BAE\u0BC7","\u0B9C\u0BC2\u0BA9\u0BCD","\u0B9C\u0BC2\u0BB2\u0BC8","\u0B86\u0B95\u0BB8\u0BCD\u0B9F\u0BCD","\u0B9A\u0BC6\u0BAA\u0BCD\u0B9F\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD","\u0B85\u0B95\u0BCD\u0B9F\u0BCB\u0BAA\u0BB0\u0BCD","\u0BA8\u0BB5\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD","\u0B9F\u0BBF\u0B9A\u0BAE\u0BCD\u0BAA\u0BB0\u0BCD"],["\u0B9E\u0BBE\u0BAF\u0BBF\u0BB1\u0BC1","\u0BA4\u0BBF\u0B99\u0BCD\u0B95\u0BB3\u0BCD","\u0B9A\u0BC6\u0BB5\u0BCD\u0BB5\u0BBE\u0BAF\u0BCD","\u0BAA\u0BC1\u0BA4\u0BA9\u0BCD","\u0BB5\u0BBF\u0BAF\u0BBE\u0BB4\u0BA9\u0BCD","\u0BB5\u0BC6\u0BB3\u0BCD\u0BB3\u0BBF","\u0B9A\u0BA9\u0BBF"],["\u0B9E\u0BBE\u0BAF\u0BBF\u0BB1\u0BCD\u0BB1\u0BC1\u0B95\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0BA4\u0BBF\u0B99\u0BCD\u0B95\u0BB3\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0B9A\u0BC6\u0BB5\u0BCD\u0BB5\u0BBE\u0BAF\u0BCD\u0B95\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0BAA\u0BC1\u0BA4\u0BA9\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0BB5\u0BBF\u0BAF\u0BBE\u0BB4\u0B95\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0BB5\u0BC6\u0BB3\u0BCD\u0BB3\u0BBF\u0B95\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8","\u0B9A\u0BA9\u0BBF\u0B95\u0BCD\u0B95\u0BBF\u0BB4\u0BAE\u0BC8"],["\u0B95\u0BBE\u0BB2\u0BC8","\u0BAE\u0BBE\u0BB2\u0BC8"],"z"],syr:[["\u070F\u071F\u0722\xA0\u070F\u0712","\u072B\u0712\u071B","\u0710\u0715\u072A","\u0722\u071D\u0723\u0722","\u0710\u071D\u072A","\u071A\u0719\u071D\u072A\u0722","\u072C\u0721\u0718\u0719","\u0710\u0712","\u0710\u071D\u0720\u0718\u0720","\u070F\u072C\u072B\xA0\u070F\u0710","\u070F\u072C\u072B\xA0\u070F\u0712","\u070F\u071F\u0722\xA0\u070F\u0710"],["\u071F\u0722\u0718\u0722\xA0\u0710\u071A\u072A\u071D","\u072B\u0712\u071B","\u0710\u0715\u072A","\u0722\u071D\u0723\u0722","\u0710\u071D\u072A","\u071A\u0719\u071D\u072A\u0722","\u072C\u0721\u0718\u0719","\u0710\u0712","\u0710\u071D\u0720\u0718\u0720","\u072C\u072B\u072A\u071D\xA0\u0729\u0715\u071D\u0721","\u072C\u072B\u072A\u071D\xA0\u0710\u071A\u072A\u071D","\u071F\u0722\u0718\u0722\xA0\u0729\u0715\u071D\u0721"],["\u070F\u0710\xA0\u070F\u0712\u072B","\u070F\u0712\xA0\u070F\u0712\u072B","\u070F\u0713\xA0\u070F\u0712\u072B","\u070F\u0715\xA0\u070F\u0712\u072B","\u070F\u0717\xA0\u070F\u0712\u072B","\u070F\u0725\u072A\u0718\u0712","\u070F\u072B\u0712"],["\u071A\u0715\xA0\u0712\u072B\u0712\u0710","\u072C\u072A\u071D\u0722\xA0\u0712\u072B\u0712\u0710","\u072C\u0720\u072C\u0710\xA0\u0712\u072B\u0712\u0710","\u0710\u072A\u0712\u0725\u0710\xA0\u0712\u072B\u0712\u0710","\u071A\u0721\u072B\u0710\xA0\u0712\u072B\u0712\u0710","\u0725\u072A\u0718\u0712\u072C\u0710","\u072B\u0712\u072C\u0710"],["\u0729.\u071B","\u0712.\u071B"],"z"],eu:[["urt.","ots.","mar.","api.","mai.","eka.","uzt.","abu.","ira.","urr.","aza.","abe."],["urtarrila","otsaila","martxoa","apirila","maiatza","ekaina","uztaila","abuztua","iraila","urria","azaroa","abendua"],["ig.","al.","ar.","az.","og.","or.","lr."],["igandea","astelehena","asteartea","asteazkena","osteguna","ostirala","larunbata"],"en","z"],be:[["\u0441\u0442\u0443\u0434\u0437","\u043B\u044E\u0442","\u0441\u0430\u043A","\u043A\u0440\u0430\u0441","\u043C\u0430\u0439","\u0447\u044D\u0440\u0432","\u043B\u0456\u043F","\u0436\u043D","\u0432\u0435\u0440","\u043A\u0430\u0441\u0442\u0440","\u043B\u0456\u0441\u0442","\u0441\u043D\u0435\u0436"],["\u0441\u0442\u0443\u0434\u0437\u0435\u043D\u044C","\u043B\u044E\u0442\u044B","\u0441\u0430\u043A\u0430\u0432\u0456\u043A","\u043A\u0440\u0430\u0441\u0430\u0432\u0456\u043A","\u043C\u0430\u0439","\u0447\u044D\u0440\u0432\u0435\u043D\u044C","\u043B\u0456\u043F\u0435\u043D\u044C","\u0436\u043D\u0456\u0432\u0435\u043D\u044C","\u0432\u0435\u0440\u0430\u0441\u0435\u043D\u044C","\u043A\u0430\u0441\u0442\u0440\u044B\u0447\u043D\u0456\u043A","\u043B\u0456\u0441\u0442\u0430\u043F\u0430\u0434","\u0441\u043D\u0435\u0436\u0430\u043D\u044C"],["\u043D\u0434","\u043F\u043D","\u0430\u045E\u0442","\u0441\u0440","\u0447\u0446","\u043F\u0442","\u0441\u0431"],["\u043D\u044F\u0434\u0437\u0435\u043B\u044F","\u043F\u0430\u043D\u044F\u0434\u0437\u0435\u043B\u0430\u043A","\u0430\u045E\u0442\u043E\u0440\u0430\u043A","\u0441\u0435\u0440\u0430\u0434\u0430","\u0447\u0430\u0446\u0432\u0435\u0440","\u043F\u044F\u0442\u043D\u0456\u0446\u0430","\u0441\u0443\u0431\u043E\u0442\u0430"],"en","z"],dv:[["\u0796\u07A6\u0782\u07A6\u0788\u07A6\u0783\u07A9","\u078A\u07AC\u0784\u07B0\u0783\u07AA\u0787\u07A6\u0783\u07A9","\u0789\u07A7\u0783\u0797\u07B0","\u0787\u07AD\u0795\u07B0\u0783\u07A8\u078D\u07B0","\u0789\u07AC\u0787\u07A8","\u0796\u07AB\u0782\u07B0","\u0796\u07AA\u078D\u07A6\u0787\u07A8","\u0787\u07AE\u078E\u07A6\u0790\u07B0\u0793\u07B0","\u0790\u07AC\u0795\u07B0\u0793\u07AC\u0789\u07B0\u0784\u07A6\u0783","\u0787\u07AE\u0786\u07B0\u0793\u07AF\u0784\u07A6\u0783","\u0782\u07AE\u0788\u07AC\u0789\u07B0\u0784\u07A6\u0783","\u0791\u07A8\u0790\u07AC\u0789\u07B0\u0784\u07A6\u0783"],["\u0796\u07A6\u0782\u07A6\u0788\u07A6\u0783\u07A9","\u078A\u07AC\u0784\u07B0\u0783\u07AA\u0787\u07A6\u0783\u07A9","\u0789\u07A7\u0783\u0797\u07B0","\u0787\u07AD\u0795\u07B0\u0783\u07A8\u078D\u07B0","\u0789\u07AC\u0787\u07A8","\u0796\u07AB\u0782\u07B0","\u0796\u07AA\u078D\u07A6\u0787\u07A8","\u0787\u07AE\u078E\u07A6\u0790\u07B0\u0793\u07B0","\u0790\u07AC\u0795\u07B0\u0793\u07AC\u0789\u07B0\u0784\u07A6\u0783","\u0787\u07AE\u0786\u07B0\u0793\u07AF\u0784\u07A6\u0783","\u0782\u07AE\u0788\u07AC\u0789\u07B0\u0784\u07A6\u0783","\u0791\u07A8\u0790\u07AC\u0789\u07B0\u0784\u07A6\u0783"],["\u0787\u07A7\u078B\u07A9\u0787\u07B0\u078C\u07A6","\u0780\u07AF\u0789\u07A6","\u0787\u07A6\u0782\u07B0\u078E\u07A7\u0783\u07A6","\u0784\u07AA\u078B\u07A6","\u0784\u07AA\u0783\u07A7\u0790\u07B0\u078A\u07A6\u078C\u07A8","\u0780\u07AA\u0786\u07AA\u0783\u07AA","\u0780\u07AE\u0782\u07A8\u0780\u07A8\u0783\u07AA"],["\u0787\u07A7\u078B\u07A9\u0787\u07B0\u078C\u07A6","\u0780\u07AF\u0789\u07A6","\u0787\u07A6\u0782\u07B0\u078E\u07A7\u0783\u07A6","\u0784\u07AA\u078B\u07A6","\u0784\u07AA\u0783\u07A7\u0790\u07B0\u078A\u07A6\u078C\u07A8","\u0780\u07AA\u0786\u07AA\u0783\u07AA","\u0780\u07AE\u0782\u07A8\u0780\u07A8\u0783\u07AA"],["\u0789\u0786","\u0789\u078A"],"z"],hi:[["\u091C\u0928\u0935\u0930\u0940","\u092B\u0930\u0935\u0930\u0940","\u092E\u093E\u0930\u094D\u091A","\u0905\u092A\u094D\u0930\u0948\u0932","\u092E\u0908","\u091C\u0942\u0928","\u091C\u0941\u0932\u093E\u0908","\u0905\u0917\u0938\u094D\u0924","\u0938\u093F\u0924\u092E\u094D\u092C\u0930","\u0905\u0915\u094D\u0924\u0942\u092C\u0930","\u0928\u0935\u092E\u094D\u092C\u0930","\u0926\u093F\u0938\u092E\u094D\u092C\u0930"],["\u091C\u0928\u0935\u0930\u0940","\u092B\u0930\u0935\u0930\u0940","\u092E\u093E\u0930\u094D\u091A","\u0905\u092A\u094D\u0930\u0948\u0932","\u092E\u0908","\u091C\u0942\u0928","\u091C\u0941\u0932\u093E\u0908","\u0905\u0917\u0938\u094D\u0924","\u0938\u093F\u0924\u092E\u094D\u092C\u0930","\u0905\u0915\u094D\u0924\u0942\u092C\u0930","\u0928\u0935\u092E\u094D\u092C\u0930","\u0926\u093F\u0938\u092E\u094D\u092C\u0930"],["\u0930\u0935\u093F.","\u0938\u094B\u092E.","\u092E\u0902\u0917\u0932.","\u092C\u0941\u0927.","\u0917\u0941\u0930\u0941.","\u0936\u0941\u0915\u094D\u0930.","\u0936\u0928\u093F."],["\u0930\u0935\u093F\u0935\u093E\u0930","\u0938\u094B\u092E\u0935\u093E\u0930","\u092E\u0902\u0917\u0932\u0935\u093E\u0930","\u092C\u0941\u0927\u0935\u093E\u0930","\u0917\u0941\u0930\u0941\u0935\u093E\u0930","\u0936\u0941\u0915\u094D\u0930\u0935\u093E\u0930","\u0936\u0928\u093F\u0935\u093E\u0930"],["\u092A\u0942\u0930\u094D\u0935\u093E\u0939\u094D\u0928","\u0905\u092A\u0930\u093E\u0939\u094D\u0928"],"z"],fil:[["Ene","Peb","Mar","Abr","May","Hun","Hul","Ago","Set","Okt","Nob","Dis"],["Enero","Pebrero","Marso","Abril","Mayo","Hunyo","Hulyo","Agosto","Setyembre","Oktubre","Nobyembre","Disyembre"],["Lin","Lun","Mar","Miy","Huw","Biy","Sab"],["Linggo","Lunes","Martes","Miyerkules","Huwebes","Biyernes","Sabado"],"en","z"],ms:[["Jan","Feb","Mac","Apr","Mei","Jun","Jul","Ogo","Sep","Okt","Nov","Dis"],["Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"],["Ahd","Isn","Sel","Rab","Kha","Jum","Sab"],["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],["PG","PTG"],"z"],"ar-SA":"ar","ar-IQ":[["\u0643\u0627\u0646\u0648\u0646\xA0\u0627\u0644\u062B\u0627\u0646\u064A","\u0634\u0628\u0627\u0637","\u0622\u0630\u0627\u0631","\u0646\u064A\u0633\u0627\u0646","\u0623\u064A\u0627\u0631","\u062D\u0632\u064A\u0631\u0627\u0646","\u062A\u0645\u0648\u0632","\u0622\u0628","\u0623\u064A\u0644\u0648\u0644","\u062A\u0634\u0631\u064A\u0646\xA0\u0627\u0644\u0623\u0648\u0644","\u062A\u0634\u0631\u064A\u0646\xA0\u0627\u0644\u062B\u0627\u0646\u064A","\u0643\u0627\u0646\u0648\u0646\xA0\u0627\u0644\u0623\u0648\u0644"],["\u0643\u0627\u0646\u0648\u0646\xA0\u0627\u0644\u062B\u0627\u0646\u064A","\u0634\u0628\u0627\u0637","\u0622\u0630\u0627\u0631","\u0646\u064A\u0633\u0627\u0646","\u0623\u064A\u0627\u0631","\u062D\u0632\u064A\u0631\u0627\u0646","\u062A\u0645\u0648\u0632","\u0622\u0628","\u0623\u064A\u0644\u0648\u0644","\u062A\u0634\u0631\u064A\u0646\xA0\u0627\u0644\u0623\u0648\u0644","\u062A\u0634\u0631\u064A\u0646\xA0\u0627\u0644\u062B\u0627\u0646\u064A","\u0643\u0627\u0646\u0648\u0646\xA0\u0627\u0644\u0623\u0648\u0644"],"ar","ar","ar","z"],"ar-DZ":"ar","ar-EG":"ar","en-US":"en","en-AU":"en","en-BZ":"en","en-CA":"en","en-029":"en","en-HK":"en","en-IN":"en","en-ID":"en","en-IE":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-ZA":"en","en-TT":"en","en-GB":"en","en-ZW":"en","en-AS":"en","en-KE":"en","en-KW":"en","en-NL":"en","en-CH":"en","en-001":"en","en-VU":"en","en-MX":"en","en-IO":"en","en-IL":"en","en-PK":"en","en-NG":"en","en-UK":"en","es-ES":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],"es","es","es","en","z"],"es-AR":["es-ES","es",["dom.","lun.","mar.","mi\xE9.","jue.","vie.","s\xE1b."],"es",["a.\xA0m.","p.\xA0m."],"z"],"es-BO":["es-ES","es","es-AR","es","es-AR","z"],"es-CL":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],"es","es-AR","es","es-AR","z"],"es-CO":["es-ES","es","es-AR","es","es-AR","z"],"es-CR":["es-ES","es","es-AR","es","es-AR","z"],"es-DO":["es-ES","es","es-AR","es","es-AR","z"],"es-EC":["es-ES","es","es-AR","es","es-AR","z"],"es-SV":["es-ES","es","es-AR","es","es-AR","z"],"es-GT":["es-ES","es","es-AR","es","es-AR","z"],"es-HN":["es-ES","es","es-AR","es","es-AR","z"],"es-419":["es-ES","es","es-AR","es","ro","z"],"es-MX":["es-ES","es","es-AR","es","es","z"],"es-NI":["es-ES","es","es-AR","es","es-AR","z"],"es-PA":["es-ES","es","es-AR","es","es-AR","z"],"es-PY":["es-CL","es","es-AR","es","es-CL","z"],"es-PE":[["Ene.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ago.","Set.","Oct.","Nov.","Dic."],["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],"es-AR","es","es-AR","z"],"es-PR":["es-ES","es","es-AR","es","es-AR","z"],"es-ES_tradnl":["es-ES","es","es","es","es-ES","z"],"es-US":[["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],"es",["dom","lun","mar","mi\xE9","jue","vie","s\xE1b"],"es","en","z"],"es-UY":["es","es-PE","es-AR","es","es-AR","z"],"es-VE":["es-CL","es","es-AR","es","es-CL","z"],"es-CU":["es-ES","es","es-AR","es","ro","z"],"fr-FR":"fr","fr-BE":"fr","fr-CM":["fr","fr","fr","fr",["mat.","soir"],"z"],"fr-CA":"fr","fr-029":"fr","fr-CD":"fr","fr-CI":"fr","fr-HT":"fr","fr-LU":"fr","fr-ML":"fr","fr-MC":"fr","fr-MA":[["jan.","f\xE9v.","mar.","avr.","mai","jui.","juil.","ao\xFBt","sept.","oct.","nov.","d\xE9c."],"fr","fr","fr","en","z"],"fr-RE":"fr","fr-SN":"fr","fr-CH":"fr","zh-CN":["zh","zh",["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"],"zh","zh","s"],"zh-SG":[["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"],"zh","zh-CN","zh","zh","s"],"zh-HK":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-MO":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-TW":["zh-SG","zh","zh","zh","zh-SG","t"],"de-DE":"de","de-AT":[["J\xE4n","Feb","M\xE4r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["J\xE4nner","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"de","en","z"],"de-LI":[["Jan","Feb","M\xE4r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],"de","de-AT","de","en","z"],"de-LU":["de-LI","de","de-AT","de","de-LI","z"],"de-CH":["de-LI","de","de-AT","de","de-LI","z"],"hr-HR":"hr","hr-BA":[["sij","velj","o\u017Eu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],"hr","hr","hr","en","z"],"nl-NL":"nl","nl-BE":"nl","sv-SE":"sv","sv-FI":[["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],"sv","sv","sv",["fm","em"],"z"],"it-IT":"it","it-CH":"it","ro-RO":"ro","ro-MD":["ro","ro",["Du","Lu","Mar","Mie","Jo","Vi","S\xE2"],"ro","ro","z"],"ru-RU":"ru","ru-MD-x-genlower":[["\u044F\u043D\u0432.","\u0444\u0435\u0432\u0440.","\u043C\u0430\u0440\u0442","\u0430\u043F\u0440.","\u043C\u0430\u0439","\u0438\u044E\u043D\u044C","\u0438\u044E\u043B\u044C","\u0430\u0432\u0433.","\u0441\u0435\u043D\u0442.","\u043E\u043A\u0442.","\u043D\u043E\u044F\u0431.","\u0434\u0435\u043A."],["\u044F\u043D\u0432\u0430\u0440\u044F","\u0444\u0435\u0432\u0440\u0430\u043B\u044F","\u043C\u0430\u0440\u0442\u0430","\u0430\u043F\u0440\u0435\u043B\u044F","\u043C\u0430\u044F","\u0438\u044E\u043D\u044F","\u0438\u044E\u043B\u044F","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F","\u043E\u043A\u0442\u044F\u0431\u0440\u044F","\u043D\u043E\u044F\u0431\u0440\u044F","\u0434\u0435\u043A\u0430\u0431\u0440\u044F"],"ru","ru","en","z"],"sr-Latn-RS":"sr","sr-Latn-BA":[["jan","feb","mart","apr","maj","jun","jul","avg","sept","okt","nov","dec"],"sr","hr","hr",["prije podne","po podne"],"z"],"sr-Latn-CS":[["jan.","feb.","mart","apr.","maj","jun","jul","avg.","sept.","okt.","nov.","dec."],"sr",["ned.","pon.","uto.","sre.","\u010Det.","pet.","sub."],"sr","en","z"],"uk-UA-x-genlower":["uk",["\u0441\u0456\u0447\u043D\u044F","\u043B\u044E\u0442\u043E\u0433\u043E","\u0431\u0435\u0440\u0435\u0437\u043D\u044F","\u043A\u0432\u0456\u0442\u043D\u044F","\u0442\u0440\u0430\u0432\u043D\u044F","\u0447\u0435\u0440\u0432\u043D\u044F","\u043B\u0438\u043F\u043D\u044F","\u0441\u0435\u0440\u043F\u043D\u044F","\u0432\u0435\u0440\u0435\u0441\u043D\u044F","\u0436\u043E\u0432\u0442\u043D\u044F","\u043B\u0438\u0441\u0442\u043E\u043F\u0430\u0434\u0430","\u0433\u0440\u0443\u0434\u043D\u044F"],"uk","uk","uk","z"],"uk-UA":"uk","bg-BG":"bg","cs-CZ":"cs","da-DK":["sv","da","da","da","sv","z"],"el-GR":"el","et-EE":"et","fi-FI":"fi","he-IL":"he","hu-HU":"hu","id-ID":"id","ja-JP":"ja","ko-KR":["ja","ko","ko","ko","ko","k"],"lt-LT":"lt","lv-LV":"lv","nb-NO":["nb","nb","nb","da","nb","z"],"pl-PL":"pl","pt-BR":"pt","pt-PT":"pt","sk-SK":["ja","sk","sk","sk","en","z"],"sl-SI":"sl","th-TH":"th","tr-TR":"tr","vi-VN":"vi","ta-IN":"ta","syr-SY":"syr","eu-ES":"eu","be-BY-x-genlower":["be",["\u0441\u0442\u0443\u0434\u0437\u0435\u043D\u044F","\u043B\u044E\u0442\u0430\u0433\u0430","\u0441\u0430\u043A\u0430\u0432\u0456\u043A\u0430","\u043A\u0440\u0430\u0441\u0430\u0432\u0456\u043A\u0430","\u043C\u0430\u044F","\u0447\u044D\u0440\u0432\u0435\u043D\u044F","\u043B\u0456\u043F\u0435\u043D\u044F","\u0436\u043D\u0456\u045E\u043D\u044F","\u0432\u0435\u0440\u0430\u0441\u043D\u044F","\u043A\u0430\u0441\u0442\u0440\u044B\u0447\u043D\u0456\u043A\u0430","\u043B\u0456\u0441\u0442\u0430\u043F\u0430\u0434\u0430","\u0441\u043D\u0435\u0436\u043D\u044F"],"be","be","be","z"],"be-BY":"be","dv-MV":"dv","hi-IN":"hi","fil-PH":"fil","ms-MY":"ms"};function lsr(){for(var e={},r=["monthNameShort","monthNameLong","dayNameShort","dayNameLong","ampmSymbols"],t=0,n=Object.keys(S_e);t<n.length;t++){var a=n[t],o=S_e[a];if(typeof o=="string"){var u=e[o];(0,h_e.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture",u!==void 0),e[a]=u;continue}var s=o.slice(0,5).map(function(k,q){if(typeof k=="string"){var V=e[k];return(0,h_e.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture 2",V!==void 0),V[r[q]]}return k}),l=s[0],c=s[1],d=s[2],f=s[3],m=s[4],v=o[5],h=v==="k",y=v==="j",_=v==="t",E=v==="s",N=h||y||_||E;e[a]={monthNameShort:l,monthNameLong:c,dayNameShort:d,dayNameLong:f,ampmSymbols:m,isEastAsia:N,isKorea:h,isJapan:y,isChinaT:_,isChinaS:E}}return e}var iY;function csr(e){var r=e.culture,t=e.tag;if(typeof r!="number"){var n=r;return t!==void 0&&(r!==""&&(n+="-"),n+="x-"+String(t)),iY===void 0&&(iY=lsr()),iY[n]}}uF.getBundledLocaleInfo=csr;var dsr=(Nt={},Nt[wt.LCID.USA]="en-US",Nt[wt.LCID.Greek]="el-GR",Nt[wt.LCID.Hungarian]="hu-HU",Nt[wt.LCID.Turkish]="tr-TR",Nt[wt.LCID.Thailand]="th-TH",Nt[wt.LCID.Vietnam]="vi-VN",Nt[wt.LCID.Arabic]="ar-SA",Nt[wt.LCID.Hebrew]="he-IL",Nt[wt.LCID.Tamil]="ta-IN",Nt[wt.LCID.Syriac]="syr-SY",Nt[wt.LCID.Iraq]="ar-IQ",Nt[wt.LCID.Algerian]="ar-DZ",Nt[wt.LCID.Basque]="eu-ES",Nt[wt.LCID.PortBrazil]="pt-BR",Nt[wt.LCID.Croatian]="hr-HR",Nt[wt.LCID.Czech]="cs-CZ",Nt[wt.LCID.Danish]="da-DK",Nt[wt.LCID.Dutch]="nl-NL",Nt[wt.LCID.Australian]="en-AU",Nt[wt.LCID.CanadianEnglish]="en-CA",Nt[wt.LCID.British]="en-GB",Nt[wt.LCID.Finnish]="fi-FI",Nt[wt.LCID.French]="fr-FR",Nt[wt.LCID.FrenchCanadian]="fr-CA",Nt[wt.LCID.Italian]="it-IT",Nt[wt.LCID.NorskBokmal]="nb-NO",Nt[wt.LCID.NorskNynorsk]="nn-NO",Nt[wt.LCID.Polish]="pl-PL",Nt[wt.LCID.PortIberian]="pt-PT",Nt[wt.LCID.Romanian]="ro-RO",Nt[wt.LCID.Russian]="ru-RU",Nt[wt.LCID.Ukrainian]="uk-UA",Nt[wt.LCID.Belarusian]="be-BY",Nt[wt.LCID.SerbianCyrillic]="sr-Cyrl-CS",Nt[wt.LCID.SerbianLatin]="sr-Latn-CS",Nt[wt.LCID.Slovak]="sk-SK",Nt[wt.LCID.Slovenian]="sl-SI",Nt[wt.LCID.SpanishModern]="es-ES",Nt[wt.LCID.Swedish]="sv-SE",Nt[wt.LCID.HongKong]="zh-HK",Nt[wt.LCID.ChinaT]="zh-TW",Nt[wt.LCID.Korea]="ko-KR",Nt[wt.LCID.Japan]="ja-JP",Nt[wt.LCID.China]="zh-CN",Nt[wt.LCID.Devihi]="dv-MV",Nt[wt.LCID.Hindi]="hi-IN",Nt[wt.LCID.German]="de-DE",Nt[wt.LCID.Swiss]="fr-CH",Nt[wt.LCID.Indonesia]="id-ID",Nt[wt.LCID.EnglishIndonesia]="en-ID",Nt[wt.LCID.EnglishIndia]="en-IN",Nt[wt.LCID.Singapore]="zh-SG",Nt[wt.LCID.EnglishSingapore]="en-SG",Nt[wt.LCID.Serbia]="sr-RS",Nt[wt.LCID.Mexico]="es-MX",Nt[wt.LCID.Ireland]="en-IE",Nt[wt.LCID.EnglishZimbabwe]="en-ZW",Nt[wt.LCID.Belgium]="nl-BE",Nt);function fsr(e){var r;return typeof e=="string"?e:(r=dsr[e])!==null&&r!==void 0?r:e}uF.convertKnownLCID=fsr});var wB=T(Uc=>{"use strict";p();var Sx,yx,_x,sF,Vb,jb,Wb,si,cf,Hb;Object.defineProperty(Uc,"__esModule",{value:!0});Uc.changeFormatDecimals=Uc.applyFormat=Uc.createFormat=Uc.NumberFormatImpl=Uc.pictureCalendar=Uc.pictureNumberShape=void 0;var Qb=fe(),G=HT(),un=U0(),Pr=Iy(),Ee=G0(),Sd=RB(),psr=jX(),ac=ZX(),kB=TB(),Cu=aF(),msr=m_e(),no=jT(),gsr=Iy(),Cm=gx(),Rh=Qb.__importStar(fx()),_r=Ch(),Xb=$X(),vsr=FB(),YT=NB(),Ls=bh(),bx=v_e(),y_e=oY(),uY=Rh.codePointMinusSign,__e=Rh.codePointPlusSign,hsr=Rh.codePointDigitZero,Ssr=Rh.codePointHash,ysr=Rh.codePointFullStop,b_e=Rh.codePointDigitOne,_sr=Rh.codePointDigitTwo,sY=Rh.codePointLeftParen,C_e=Rh.codePointRightParen,bsr=Rh.codePointSmallT,Csr=Rh.codePointBackslash,Yb;(function(e){e[e.WantPic=0]="WantPic",e[e.WantClose=1]="WantClose",e[e.Done=2]="Done"})(Yb||(Yb={}));var Tsr={decimalSeparator:"NOTUSED"};function Cx(e,r,t,n){var a=e.formatFixed(r,0,0),o=a.mantissa,u=a.exponent;(0,un.assertTrue)("calc.numfmt.dtrInteger: mantissa len <= exponent",o.length<=u),(0,un.assertTrue)("calc.numfmt.dtrInteger: mantissa || !exponent",o.length!==0||u===0);var s=(0,Cm.convertDigitsShape)(u<t?(0,Cu.repeat)("0",t-u):"",n),l=(0,Cm.convertNumberShape)(Tsr,o+(0,Cu.repeat)("0",u-o.length),n);return s+l}function Rsr(e,r,t,n,a){var o=e.formatFixed(r,0,0),u=o.mantissa,s=o.exponent;(0,un.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",u.length<=s),(0,un.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa || !exponent",u.length!==0||s===0);var l=(s<t?(0,Cu.repeat)("0",t-s):"")+u+(0,Cu.repeat)("0",s-u.length),c=l.substring(0,n);return(0,Cm.convertDigitsShape)(c,a)}function lF(e,r){var t=e.formatFixed(r,0,0),n=t.mantissa,a=t.exponent;return(0,un.assertTrue)("calc.numfmt.formatInt: mantissa len <= exponent",n.length<=a),(0,un.assertTrue)("calc.numfmt.formatInt: mantissa || !exponent",n.length!==0||a===0),n===""?"0":n.length<a?n+(0,Cu.repeat)("0",a-n.length):n}function Esr(e){for(var r=[],t=0;t<e.length;t+=1){var n=e[t];switch(n.kind){case Ee.FormattedUnitKind.Blank:case Ee.FormattedUnitKind.String:{for(var a=n.str;t+1<e.length;){var o=e[t+1];if(o.kind!==n.kind)break;a+=o.str,t+=1}r.push({kind:n.kind,str:a});break}case Ee.FormattedUnitKind.Flexible:case Ee.FormattedUnitKind.General:r.push(n);break}}return r}var Psr=function(r){return r.kind===Ee.FormattedUnitKind.Flexible};function Asr(e,r){return e===r||e!==void 0&&r!==void 0&&(0,Ee.isFormatCultureEqual)(e,r)}var Fsr=(Sx={},Sx[1]=_r.NumberShape.ChineseTrad1,Sx[2]=_r.NumberShape.ChineseTrad2,Sx[3]=_r.NumberShape.ChineseTrad3,Sx),Nsr=(yx={},yx[1]=_r.NumberShape.ChineseSimp1,yx[2]=_r.NumberShape.ChineseSimp2,yx[3]=_r.NumberShape.ChineseSimp3,yx),Osr=(_x={},_x[1]=_r.NumberShape.Japanese1,_x[2]=_r.NumberShape.Japanese2,_x[3]=_r.NumberShape.Japanese3,_x),ksr=(sF={},sF[1]=_r.NumberShape.Korean1,sF[2]=_r.NumberShape.Korean2,sF[3]=_r.NumberShape.Korean3,sF[4]=_r.NumberShape.Korean4,sF);function Msr(e){return G.PictureColor[e]}function xsr(e){return G.PictureColor[e]}function Isr(e){return e+1}function wsr(e){return e-1}var Ml;(function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"})(Ml||(Ml={}));var lY=(0,Cu.partialArray)((Vb={},Vb[Ml.Ne]="<>",Vb[Ml.Le]="<=",Vb[Ml.Ge]=">=",Vb[Ml.Eq]="=",Vb[Ml.Lt]="<",Vb[Ml.Gt]=">",Vb)),Dsr=(jb={},jb[Ml.Ne]=ac.OperatorId.Ne,jb[Ml.Le]=ac.OperatorId.Le,jb[Ml.Ge]=ac.OperatorId.Ge,jb[Ml.Eq]=ac.OperatorId.Eq,jb[Ml.Lt]=ac.OperatorId.Lt,jb[Ml.Gt]=ac.OperatorId.Gt,jb),Lsr=(Wb={},Wb[ac.OperatorId.Ne]=Ml.Ne,Wb[ac.OperatorId.Le]=Ml.Le,Wb[ac.OperatorId.Ge]=Ml.Ge,Wb[ac.OperatorId.Eq]=Ml.Eq,Wb[ac.OperatorId.Lt]=Ml.Lt,Wb[ac.OperatorId.Gt]=Ml.Gt,Wb),Ke;(function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"})(Ke||(Ke={}));function JT(e,r,t,n){for(var a=0;a<r.length;a+=1){var o=r[a];if(o!=null&&!(n+o.length>t.length)){var u=t.substring(n,n+o.length);if(e.stringCompareCI(o,u)===0)return Number(a)}}}function T_e(e,r,t,n){for(var a=0;a<r.length;a+=1){var o=r[a];if(o!=null&&(0,Cu.stringStartsWith)(t,o,n))return Number(a)}return JT(e,r,t,n)}function pt(e,r){var t;return(t=e[r])!==null&&t!==void 0?t:""}function qsr(e,r,t,n){for(var a=t.substring(n,n+(0,Sd.numCodeUnits)((0,Sd.stringCodePointAt)(t,n))),o=0;o<r.length;o+=1){var u=r[o];if(u!=null&&u.length!==0){var s=u.substring(0,(0,Sd.numCodeUnits)((0,Sd.stringCodePointAt)(u,0)));if(e.stringCompareCI(a,s)===0)return!0}}return!1}function R_e(e,r){var t=r.indexOf(pt(e.pictureSingle,G.PictureSingle.APDelim));return t<0&&(t=r.length>>1),[r.substring(0,t),r.substring(t+1)]}var cY="$",MB="-",Gsr=",",Bsr="x-",Usr=/^[0-9A-F]{1,8}$/i,Ksr=/^(?:([a-z]{2,}(?:-[A-Z0-9](?:[A-Z0-9]+|(?=,)|$)(?:_[A-Z0-9]+)?)*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i;Uc.pictureNumberShape=(0,Cu.partialArray)((si={},si[1]=_r.NumberShape.ASCII,si[2]=_r.NumberShape.ArabicIndic,si[3]=_r.NumberShape.ExtendedArabicIndic,si[4]=_r.NumberShape.Devanagari,si[5]=_r.NumberShape.Bengali,si[6]=_r.NumberShape.Gurmukhi,si[7]=_r.NumberShape.Gujarati,si[8]=_r.NumberShape.Oriya,si[9]=_r.NumberShape.Tamil,si[10]=_r.NumberShape.Telugu,si[11]=_r.NumberShape.Kannada,si[12]=_r.NumberShape.Malayalam,si[13]=_r.NumberShape.Thai,si[14]=_r.NumberShape.Lao,si[15]=_r.NumberShape.Tibetan,si[16]=_r.NumberShape.Myanmar,si[17]=_r.NumberShape.Ethiopic,si[18]=_r.NumberShape.Khmer,si[19]=_r.NumberShape.Mongolian,si[27]=_r.NumberShape.Japanese1,si[28]=_r.NumberShape.Japanese2,si[29]=_r.NumberShape.Japanese3,si[30]=_r.NumberShape.ChineseSimp1,si[31]=_r.NumberShape.ChineseSimp2,si[32]=_r.NumberShape.ChineseSimp3,si[33]=_r.NumberShape.ChineseTrad1,si[34]=_r.NumberShape.ChineseTrad2,si[35]=_r.NumberShape.ChineseTrad3,si[36]=_r.NumberShape.Korean1,si[37]=_r.NumberShape.Korean2,si[38]=_r.NumberShape.Korean3,si[39]=_r.NumberShape.Korean4,si));Uc.pictureCalendar=(0,Cu.partialArray)((cf={},cf[1]=_r.Calendar.Gregorian,cf[2]=_r.Calendar.GregorianUS,cf[3]=_r.Calendar.Japan,cf[4]=_r.Calendar.Taiwan,cf[5]=_r.Calendar.Korea,cf[6]=_r.Calendar.Hijri,cf[7]=_r.Calendar.Thai,cf[8]=_r.Calendar.Hebrew,cf[9]=_r.Calendar.GregorianMEFrench,cf[10]=_r.Calendar.GregorianArabic,cf[11]=_r.Calendar.GregorianXlitEnglish,cf[12]=_r.Calendar.GregorianXlitFrench,cf[22]=_r.Calendar.Persian,cf[23]=_r.Calendar.UmAlQura,cf));var Vsr=Object.keys(Ee.CultureTag).reduce(function(e,r){var t=Ee.CultureTag[r];return e[String(t)]=t,e},Object.create(null));function dY(e){return e.toString(16).toUpperCase()}function E_e(e){return+("0x"+e)}var jsr={culture:"en-US",tag:void 0},Wsr={culture:"fr-FR",tag:void 0},Hsr={culture:"ar-IQ",tag:void 0},zsr={culture:"ar-SA",tag:void 0},Qsr={culture:"ar-DZ",tag:void 0},fY={culture:"th-TH",tag:void 0},P_e=543,pY=(Hb={},Hb[G.PictureSingle.Hour]=Xb.TimeDivision.Hour,Hb[G.PictureSingle.HourTh]=Xb.TimeDivision.Hour,Hb[G.PictureSingle.Minute]=Xb.TimeDivision.Minute,Hb[G.PictureSingle.MinuteTh]=Xb.TimeDivision.Minute,Hb[G.PictureSingle.Second]=Xb.TimeDivision.Second,Hb[G.PictureSingle.SecondTh]=Xb.TimeDivision.Second,Hb);function xB(e){return e.kind===mt.Char?e.formattedStr:void 0}var mt;(function(e){e[e.Char=400]="Char",e[e.Fraction=401]="Fraction",e[e.Exp=402]="Exp",e[e.Num=403]="Num",e[e.FracSeconds=404]="FracSeconds",e[e.DateSep=405]="DateSep",e[e.TimeSep=406]="TimeSep",e[e.SysFormat=407]="SysFormat"})(mt||(mt={}));var N_e={kind:Ke.General};function O_e(e){return e.length===1&&e[0].kind===Ke.General}function Xsr(e){return e.length===1&&e[0].kind===G.PictureSingle.Text}var Mn;(function(e){e[e.Num=0]="Num",e[e.Date=1]="Date",e[e.Fraction=2]="Fraction",e[e.Percent=3]="Percent",e[e.Exp=4]="Exp",e[e.Text=5]="Text",e[e.General=6]="General",e[e.Other=7]="Other"})(Mn||(Mn={}));function Ysr(e){return e.numVal&&e.nonZero&&e.digitTokens}var Yt;(function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"})(Yt||(Yt={}));var bm;(function(e){e[e.Unknown=0]="Unknown",e[e.Either=1]="Either",e[e.Number=2]="Number",e[e.Text=3]="Text"})(bm||(bm={}));var Tx={code:[N_e],color:void 0,dbnum:void 0,dtrRounding:Xb.Rounding.RoundSec};function A_e(e){return e.color===void 0&&e.dbnum===void 0&&O_e(e.code)}function Jsr(e){return e.color===void 0&&e.dbnum===void 0&&Xsr(e.code)}var F_e=255,Zsr=255,$sr=32,mY=127,IB=1,Rx=2,gY={},zb=(0,Pr.createFailureErrorClass)("ApplyHashesError"),kl=(0,Pr.createFailureErrorClass)("ApplyError"),gr=(0,Pr.createFailureErrorClass)("InitError"),k_e=function(){function e(r,t){this.config=r,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],this.hasTokenCurrCode=!1,t.old===void 0?(this.logFormatString=(0,bx.anonymizeFormulaString)(t.formatString),this.source=t.source,this.parseString(t.formatString)):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.hasTokenCurrCode=t.old.hasTokenCurrCode,this.thisCurrCode=t.old.thisCurrCode,this.thisCurrencySymbol=t.old.thisCurrencySymbol,this.applyCurrCode=t.old.applyCurrCode,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.logFormatString=t.logFormatString,this.source=Ee.NumberFormatSource.CustomString,this.checkBytecode()),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}return Object.defineProperty(e.prototype,"isPercent",{get:function(){return this.hasPercent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDate",{get:function(){return this.hasDate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTime",{get:function(){return this.hasTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTextOnly",{get:function(){return!this.posBeforeText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInputDependent",{get:function(){return this.isInputDependentFormat()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culture",{get:function(){return this.thisCurrCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currencySymbol",{get:function(){return this.thisCurrencySymbol},enumerable:!1,configurable:!0}),e.prototype.apply=function(r,t,n,a){try{return(0,Ls.success)(this.applyImpl(r,t,n,a))}catch(o){return o instanceof kl?(0,Ls.failure)(o.reason):(0,Ls.failure)((0,Ls.javaScriptError)((0,Cu.prependErrorMessage)(o,"(while applying format ".concat(this.logFormatString,")"))))}},e.prototype.isInputDependentFormat=function(){for(var r=0,t=this.parts;r<t.length;r++)for(var n=t[r],a=0,o=n.code;a<o.length;a++){var u=o[a];switch(u.kind){case Ke.General:case Ke.AMPM:case Ke.AMPMFE:case G.PictureSingle.Hash:case G.PictureSingle.Zero:case G.PictureSingle.Text:case G.PictureSingle.Year:case G.PictureSingle.YearTh:case G.PictureSingle.EngYearTh:case G.PictureSingle.ThYear:case G.PictureSingle.Month:case G.PictureSingle.MonthTh:case G.PictureSingle.Day:case G.PictureSingle.DayTh:case G.PictureSingle.LocDay:case G.PictureSingle.Hour:case G.PictureSingle.HourTh:case G.PictureSingle.Minute:case G.PictureSingle.MinuteTh:case G.PictureSingle.Second:case G.PictureSingle.SecondTh:case G.PictureSingle.Era:case G.PictureSingle.EraYear:case mt.Fraction:case mt.Exp:case mt.Num:case mt.SysFormat:case mt.FracSeconds:case G.PictureSingle.Question:return!0;case mt.DateSep:case mt.TimeSep:case mt.Char:case Ke.LatinDate:case G.PictureSingle.Decimal:case G.PictureSingle.Percent:case Ke.BidiDate:case Ke.Currency:case Ke.CurrCode:case Ke.StrLit:case Ke.Numeral:case Ke.PrefixDigTh:case Ke.Exp:case G.PictureSingle.Slash:case G.PictureSingle.Star:case G.PictureSingle.Underscore:}}return!1},e.prototype.applyImpl=function(r,t,n,a){var o,u=this.config,s=u.mathpack,l=u.localeInfo;if(this.valueType===Ee.FormatValueType.General){var c=void 0;if((0,Pr.isStringOper)(r))return(0,Ee.formattedValue)([(0,Ee.formattedUnitString)(r.value)],c,t,n);if(!a&&s.cond(r)===0)return(0,Ee.formattedValue)([],c,t,n);var d=(0,Ee.formattedUnitGeneral)(s.toNumber(r),l.decimalSeparator,!0,_r.NumberShape.ASCII,_r.NumberShape.ASCII,!0);return(0,Ee.formattedValue)([d],c,t,n)}for(var f=!1;;){var m=void 0;try{var v=void 0,h=!1,y=[];if((0,Pr.isStringOper)(r))v=Yt.Text;else{var _=s.cond(r);this.condPos!==void 0||this.condNeg!==void 0?(o=this.getPart(r),v=o.partKind,h=o.forceNeg):v=_<0?Yt.Neg:_>0?Yt.Pos:Yt.Zero,_<0&&(this.onlyOneNumberPart||h)&&y.push((0,Ee.formattedUnitString)("-"))}m=this.parts[v];var c=m.color,E=m.dbnum,N=m.code,k=m.dtrRounding;if(!a&&v===Yt.Zero&&m===this.parts[Yt.Pos]&&!f)return(0,Ee.formattedValue)([],c,t,n);var q=this.getNumShape(E);this.applyPart({dtrRounding:k,dbnum:E,forceNeg:h,units:y,numShape:q,bidiDate:void 0},N,r,void 0);var V=n|(v===Yt.Text&&!(A_e(m)||Jsr(m))?Ee.Clip.MaxChars:Ee.Clip.None),I=y.some(Psr)?Ee.Alignment.Left:t;return(0,Ee.formattedValue)(Esr(y),c,I,V)}catch(M){if(M===gY){(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyImpl restart",!(0,Pr.isStringOper)(r)&&s.cond(r)!==0),r=s.zero,f=!0;continue}if(M instanceof zb)return(0,Ee.hashesValue)(M.reason,m==null?void 0:m.color);throw M}}},e.prototype.applyPart=function(r,t,n,a){for(var o,u,s=this,l,c,d=this.config,f=d.mathpack,m=d.datepack,v=d.localeInfo,h=(c=(l=this.applyCurrCode)===null||l===void 0?void 0:l.calendar)!==null&&c!==void 0?c:_r.Calendar.Gregorian,y,_=function(){if(y!==void 0)return y;(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!(0,Pr.isStringOper)(n));var aw=s.config,fV=aw.date1904,ok=aw.dateCompatibility;if(!ok&&f.cond(n)<0)throw new zb(Ee.dateOverflow);if(ok&&f.cond(n)<0)throw fV?new kl((0,Pr.notImplemented)(["negative date 1904"])):new zb(Ee.dateOverflow);var el=m.fromNum(s.config,f.abs(n),r.dtrRounding);if(el===!1)throw new zb(Ee.dateOverflow);switch(h){case _r.Calendar.Gregorian:case _r.Calendar.GregorianUS:case _r.Calendar.GregorianMEFrench:case _r.Calendar.GregorianArabic:case _r.Calendar.GregorianXlitEnglish:case _r.Calendar.GregorianXlitFrench:break;case _r.Calendar.Thai:el.yr+=P_e;break;default:throw new kl((0,Pr.notImplemented)(["calendar: "+h]))}return(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: components within range",el.yr>=0&&el.mon>=1&&el.mon<=12&&el.dom>=0&&el.dom<=31&&el.hour>=0&&el.hour<=23&&el.min>=0&&el.min<=59&&el.sec>=0&&el.sec<=59&&el.fracSec>=0&&el.wdy>=1&&el.wdy<=7),y=el},E=function(){if(y!==void 0)throw new kl((0,Pr.notImplemented)(["use of value after date component"]));return n},N=!1,k=r.numShape,q=r.units,V=0;V<t.length;V+=1){var I=t[V];switch(I.kind){case Ke.General:{N=!0;var M=E();if((0,Pr.isStringOper)(M))q.push((0,Ee.formattedUnitString)(M.value));else{var B=f.abs(M);if(f.cond(M)<0&&f.formatGeneral(v,B,1)==="0")throw new kl((0,Pr.notImplemented)(["potential LRestart in interval (-0.5,0)"]));var U=(0,Ee.formattedUnitGeneral)(f.toNumber(B),v.decimalSeparator,!1,k,this.getNumShape(void 0),this.valueType===Ee.FormatValueType.General);if(r.dbnum!==void 0){var j=(0,vsr.renderGeneral)(f,U,255);(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart General renderRes",j!==!1),q.push((0,Ee.formattedUnitString)(j));break}q.push(U)}break}case G.PictureSingle.Text:{var X=E();(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Text value",(0,Pr.isStringOper)(X)),q.push((0,Ee.formattedUnitString)(X.value));break}case Ke.Exp:case G.PictureSingle.Slash:case mt.Char:q.push((0,Ee.formattedUnitString)(I.formattedStr));break;case G.PictureSingle.Star:q.push((0,Ee.formattedUnitFlexible)(I.escaped));break;case G.PictureSingle.Underscore:q.push((0,Ee.formattedUnitBlank)(I.escaped));break;case Ke.StrLit:q.push((0,Ee.formattedUnitString)(I.escaped));break;case G.PictureSingle.Percent:q.push((0,Ee.formattedUnitString)(I.formattedStr));break;case Ke.Numeral:q.push((0,Ee.formattedUnitString)(I.formattedStr));break;case Ke.Currency:q.push((0,Ee.formattedUnitString)(v.currencySymbol));break;case Ke.CurrCode:{var ee=I.currencySymbol,re=I.currCode;(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart system tag",!(0,Ee.isSystemCultureTag)(re==null?void 0:re.tag)),ee!==void 0&&q.push((0,Ee.formattedUnitString)(ee));break}case mt.DateSep:q.push((0,Ee.formattedUnitString)(v.dateSeparator));break;case mt.TimeSep:I.printAsTimeSep?q.push((0,Ee.formattedUnitString)(v.timeSeparator)):q.push((0,Ee.formattedUnitString)(I.formattedStr));break;case mt.Num:{var Z=E();(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num value",!(0,Pr.isStringOper)(Z)),(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num numState",a===void 0);var J=I.numDigLeft,C=I.numDigDec,S=I.numPercent,b=I.numThousands,O=2*S-3*b,w=f.formatFixed(Z,O,C),D=w.mantissa,Q=w.exponent;if((0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",D.length!==0||Q===0),(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",D.length<=Q+C),f.cond(Z)<0&&(this.onlyOneNumberPart||r.forceNeg)&&D.length===0)throw gY;this.applyPart(r,I.codeBefore,f.zero,void 0),this.applyPart(r,I.code,f.zero,{comma:I.comma,fractionDenom:!1,decimal:!1,digits:D,digitsExp:Q,numDigLeft:J});break}case mt.Exp:{var W=E();(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp value",!(0,Pr.isStringOper)(W)),(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp numState",a===void 0);var $=I.numMantDigLeft,me=I.numMantDigDec,ve=$===0&&me===0,Pe=f.formatScientific(W,$,me),D=Pe.mantissa,Q=Pe.exponent;(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",D.length!==0||Q===0||ve);var ua=(0,msr.formatScientificLeft)(Q,$);(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",D.length<=ua+me),this.applyPart(r,I.codeMant,f.zero,{comma:I.commaMant,fractionDenom:!1,decimal:!1,digits:D,digitsExp:ua,numDigLeft:I.numMantDigLeft}),this.applyPart(r,I.codeBetween,f.zero,void 0);var Qi=D===""&&!ve?0:Q-ua;Qi<0?q.push((0,Ee.formattedUnitString)("-")):I.isNeg||q.push((0,Ee.formattedUnitString)("+"));var go=lF(f,f.fromNumber(Qi));this.applyPart(r,I.codeExp,f.zero,{comma:I.commaMant,fractionDenom:!1,decimal:!1,digits:go,digitsExp:go.length,numDigLeft:I.numExpDigLeft});break}case mt.Fraction:{var Ro=E();(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!(0,Pr.isStringOper)(Ro)),(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",a===void 0);var S=I.numPercent,b=I.numThousands,$n=I.numIntDigLeft,ns=I.numNumerDig,Iu=I.numDenomDig,wi=I.commaInt,mp=I.denomValue,O=2*S-3*b,zl=f.tenTo(O),Ql=(0,Pr.isErrorOper)(zl)?zl:f.mul(f.abs(Ro),zl);if((0,Pr.isErrorOper)(Ql))throw new kl((0,Pr.notImplemented)(["overflow on fraction exp adjust"]));var _c=function(el){for(var NE=el;NE<q.length;NE+=1){var iw=q[NE];iw.kind===Ee.FormattedUnitKind.String&&(q[NE]=(0,Ee.formattedUnitBlank)(iw.str))}},Gd=I.anyZeroNumer,vl=void 0,wu=void 0,bs=void 0;if(I.codeInt!==void 0){var hl=f.trunc(Ql),id=f.sub(Ql,hl);if((0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",(0,Pr.isNumberOper)(id)),o=this.formFraction(id,mp,Iu),vl=o.numer,wu=o.denom,(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",f.cond2(vl,wu)<=0),f.cond2(vl,wu)===0){vl=f.zero;var as=f.add(hl,f.one);(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart bumped error",(0,Pr.isNumberOper)(as)),hl=as}f.cond(vl)!==0&&(Gd=!0);var Lv=lF(f,hl),qv={comma:wi,fractionDenom:!1,decimal:!1,digits:Lv,digitsExp:Lv.length,numDigLeft:$n},e0=q.length;this.applyPart(r,I.codeInt,f.zero,qv),bs=q.length,(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",I.lastDigInt!==void 0);var tk=f.cond(hl)!==0||!Gd||I.lastDigInt===G.PictureSingle.Zero;tk?this.applyPart(r,I.codeBetween1,f.zero,void 0):(I.lastDigInt!==G.PictureSingle.Question&&(q.length=e0),this.applyPart(r,I.codeBetween1,f.zero,void 0),_c(e0),I.firstDigNumer!==G.PictureSingle.Question&&(q.length=e0))}else{if(u=this.formFraction(Ql,mp,Iu),vl=u.numer,wu=u.denom,f.cond(Ro)<0&&(this.onlyOneNumberPart||r.forceNeg)&&f.cond(vl)===0)throw gY;Gd=!0,bs=q.length}var PE=lF(f,vl),J2={comma:!1,fractionDenom:!1,decimal:!1,digits:PE,digitsExp:PE.length,numDigLeft:ns};this.applyPart(r,I.codeNumer,f.zero,J2),this.applyPart(r,I.codeBetween2,f.zero,void 0);var Z2=lF(f,wu),iV={comma:!1,fractionDenom:!0,decimal:J2.decimal,digits:Z2,digitsExp:Z2.length,numDigLeft:Iu};this.applyPart(r,I.codeDenom,f.zero,iV),Gd||(I.anyQuestionNumer||I.firstDigDenom===G.PictureSingle.Question?_c(bs):q.length=bs);break}case G.PictureSingle.Decimal:{(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",a!==void 0),a.digitsExp>0&&(a.numDigLeft=a.digitsExp,this.dumpDigLeft(r,a,a.digitsExp)),a.decimal=!0,q.push((0,Ee.formattedUnitString)(v.decimalSeparator));break}case G.PictureSingle.Hash:case G.PictureSingle.Zero:case G.PictureSingle.Question:{(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",a!==void 0);var Zm=I.count;if(a.decimal||a.fractionDenom&&I.kind===G.PictureSingle.Question){if(a.fractionDenom&&V!==t.length-1)throw new kl((0,Pr.notImplemented)(["left-align bug in denominator"]));if(a.digitsExp<0){var r0=(0,no.fastMin)(Zm,-a.digitsExp),qf=(0,Cm.convertDigitsShape)((0,Cu.repeat)("0",r0),k);q.push((0,Ee.formattedUnitString)(qf)),a.digitsExp+=r0,Zm-=r0}{var nk=(0,no.fastMin)(Zm,a.digits.length),qf=(0,Cm.convertDigitsShape)(a.digits.substring(0,nk),k);q.push((0,Ee.formattedUnitString)(qf)),a.digits=a.digits.substring(nk),Zm-=nk}if(I.kind!==G.PictureSingle.Hash&&Zm>0){var qf=(0,Cm.convertDigitsShape)((0,Cu.repeat)("0",Zm),k);q.push(I.kind===G.PictureSingle.Question?(0,Ee.formattedUnitBlank)(qf):(0,Ee.formattedUnitString)(qf))}break}if(a.numDigLeft>a.digitsExp){var r0=(0,no.fastMin)(Zm,a.numDigLeft-a.digitsExp);if(I.kind!==G.PictureSingle.Hash){var qf=(0,Cm.convertDigitsShape)((0,Cu.repeat)("0",r0),k);a.comma&&(qf=(0,Cm.insertCommas)(v,qf,a.numDigLeft-r0)),q.push(I.kind===G.PictureSingle.Question?(0,Ee.formattedUnitBlank)(qf):(0,Ee.formattedUnitString)(qf))}Zm-=r0,a.numDigLeft-=r0}else Zm+=a.digitsExp-a.numDigLeft,a.numDigLeft=a.digitsExp;this.dumpDigLeft(r,a,Zm);break}case Ke.PrefixDigTh:v.isThai&&(k=r.numShape=_r.NumberShape.Thai);break;case Ke.LatinDate:this.hasTokenCurrCode||(r.bidiDate=Ee.BidiDate.English);break;case Ke.BidiDate:throw new kl((0,Pr.notImplemented)(["TokenKind.BidiDate"]));case G.PictureSingle.HourTh:case G.PictureSingle.MinuteTh:case G.PictureSingle.SecondTh:case G.PictureSingle.Hour:case G.PictureSingle.Minute:case G.PictureSingle.Second:{var O_=I.kind===G.PictureSingle.HourTh||I.kind===G.PictureSingle.MinuteTh||I.kind===G.PictureSingle.SecondTh,t0=O_&&!this.hasTokenCurrCode?_r.NumberShape.Thai:k;if(I.isAbs){var $2=E();if((0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!(0,Pr.isStringOper)($2)),O_&&this.hasTokenCurrCode)throw new kl((0,Pr.notImplemented)(["fcAbsHourTh && fIntlNum bug"]));var ew=m.toTime(this.config,f.abs($2),pY[I.kind],r.dtrRounding);if(ew===!1)throw new kl((0,Pr.notImplemented)(["absolute time overflow"]));q.push((0,Ee.formattedUnitString)(Cx(f,f.fromNumber(ew),I.count,t0)))}else{var ak=_(),$m=void 0;if(I.kind===G.PictureSingle.Minute||I.kind===G.PictureSingle.MinuteTh)$m=ak.min;else if(I.kind===G.PictureSingle.Second||I.kind===G.PictureSingle.SecondTh)$m=ak.sec;else if($m=ak.hour,I.isAMPM){if(I.kind===G.PictureSingle.HourTh)throw new kl((0,Pr.notImplemented)(["fc12HourTh/fc12Hour2Th forgotten"]));$m>12&&($m-=12),$m===0&&($m=12)}q.push((0,Ee.formattedUnitString)(Cx(f,f.fromNumber($m),I.count,t0)))}break}case Ke.AMPM:case Ke.AMPMFE:{var AE=void 0;if((0,Pr.isStringOper)(n)?AE=!0:AE=_().hour<12,(!this.hasTokenCurrCode||I.kind===Ke.AMPMFE)&&(I.kind===Ke.AMPMFE||v.isEastAsia||I.pictureKind===G.PictureSpecial.AP2)){var oV=R_e(v,I.tokenStr);q.push((0,Ee.formattedUnitString)(oV[AE?0:1]));break}var uV=this.getBundledLocaleInfo("localised AM/PM string",_r.Calendar.Gregorian,this.applyCurrCode);q.push((0,Ee.formattedUnitString)(uV.ampmSymbols[AE?0:1]));break}case mt.FracSeconds:{var ik=_();(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",ik.rounding>=I.rounding);var sV=Rsr(f,f.fromNumber(ik.fracSec),ik.rounding,I.rounding,k);q.push((0,Ee.formattedUnitString)(v.decimalSeparator+sV));break}case G.PictureSingle.Era:throw new kl((0,Pr.notImplemented)(["PictureSingle.Era"]));case G.PictureSingle.EraYear:throw new kl((0,Pr.notImplemented)(["PictureSingle.EraYear"]));case G.PictureSingle.YearTh:case G.PictureSingle.EngYearTh:case G.PictureSingle.ThYear:case G.PictureSingle.Year:{var t0=(I.kind===G.PictureSingle.YearTh||I.kind===G.PictureSingle.ThYear)&&!this.hasTokenCurrCode?_r.NumberShape.Thai:k,lV=(I.kind===G.PictureSingle.YearTh||I.kind===G.PictureSingle.EngYearTh)&&!this.hasTokenCurrCode,rw=_().yr+(lV?P_e:0),$m=I.count>2?rw:rw%100;q.push((0,Ee.formattedUnitString)(Cx(f,f.fromNumber($m),I.count,t0)));break}case G.PictureSingle.Month:case G.PictureSingle.MonthTh:{var FE=_().mon;switch(I.count){case 1:case 2:{var t0=I.kind===G.PictureSingle.MonthTh&&!this.hasTokenCurrCode?_r.NumberShape.Thai:k;q.push((0,Ee.formattedUnitString)(Cx(f,f.fromNumber(FE),I.count,t0)));break}case 3:case 4:case 5:{var lm=void 0;if(r.bidiDate===Ee.BidiDate.English?lm=(0,G.getEnglishLocaleInfo)():lm=this.getBundledLocaleInfo("localised month string",h,I.kind===G.PictureSingle.MonthTh&&!this.hasTokenCurrCode?fY:this.applyCurrCode),I.count===3)q.push((0,Ee.formattedUnitString)(lm.monthNameShort[FE-1]));else if(I.count===4||r.bidiDate===Ee.BidiDate.English)q.push((0,Ee.formattedUnitString)(lm.monthNameLong[FE-1]));else{var tw=lm.monthNameLong[FE-1];q.push((0,Ee.formattedUnitString)(tw.substring(0,(0,Sd.numCodeUnits)((0,Sd.stringCodePointAt)(tw,0)))))}break}}break}case G.PictureSingle.Day:case G.PictureSingle.DayTh:case G.PictureSingle.LocDay:{var O_=I.kind===G.PictureSingle.DayTh;if(I.count<3){var t0=O_&&!this.hasTokenCurrCode?_r.NumberShape.Thai:k,cV=_().dom;q.push((0,Ee.formattedUnitString)(Cx(f,f.fromNumber(cV),I.count,t0)))}else{var nw=_().wdy,lm=void 0;if(r.bidiDate===Ee.BidiDate.English||!this.hasTokenCurrCode&&v.isEastAsia&&I.kind===G.PictureSingle.Day?lm=(0,G.getEnglishLocaleInfo)():lm=this.getBundledLocaleInfo("localised day string",h,O_&&!this.hasTokenCurrCode?fY:this.applyCurrCode),O_&&this.hasTokenCurrCode&&I.count===3)throw new kl((0,Pr.notImplemented)(["fcDay3Th && fIntlNum bug"]));var qf=I.count===3?lm.dayNameShort[nw-1]:lm.dayNameLong[nw-1];q.push((0,Ee.formattedUnitString)(qf))}break}case mt.SysFormat:(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart SysFormat numState",a===void 0),this.applyPart(r,I.codeSysFormat,n,a);break;default:return(0,un.assertNever)("calc.numfmt.NumberFormatImpl: applyPart code",I)}}N&&E()},e.prototype.dumpDigLeft=function(r,t,n){var a=this.config.localeInfo,o=r.units,u=r.numShape,s=n;{var l=(0,no.fastMin)(s,t.digits.length),c=(0,Cm.convertDigitsShape)(t.digits.substring(0,l),u);t.comma&&(c=(0,Cm.insertCommas)(a,c,t.numDigLeft-l)),o.push((0,Ee.formattedUnitString)(c)),t.digits=t.digits.substring(l),s-=l,t.digitsExp-=l,t.numDigLeft-=l}if(s>0){var c=(0,Cm.convertDigitsShape)((0,Cu.repeat)("0",s),u);t.comma&&(c=(0,Cm.insertCommas)(a,c,t.numDigLeft-s)),o.push((0,Ee.formattedUnitString)(c)),t.digitsExp-=s,t.numDigLeft-=s}},e.prototype.getPart=function(r){for(var t=this.config.mathpack,n=Yt.Pos;n<Yt.Zero;n+=1){var a=n,o=void 0;if(n===Yt.Pos){if(o=this.condPos,o===void 0&&t.cond(r)>0)return{partKind:a,forceNeg:!1}}else{if(this.parts[a]===this.parts[Yt.Pos])throw new zb(Ee.noFormatPart);if(this.parts[Yt.Pos].code.length===0)throw new kl((0,Pr.notImplemented)(['emulation of ";[COND]foo" bug']));if(o=this.condNeg,o===void 0){if(this.parts[Yt.Zero]===this.parts[Yt.Pos])return(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: getPart condPos",this.condPos!==void 0),{partKind:a,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===ac.OperatorId.Eq};if(t.cond(r)<0)return{partKind:a,forceNeg:!1}}}if(o!==void 0){var u=o.operator,s=o.operand,l=t.sub(r,s);if((0,Pr.isErrorOper)(l))throw new kl((0,Pr.notImplemented)(["overflow in condition check"]));if((0,gsr.applyComparison)(u,t.cond2(r,s)))switch(u){case ac.OperatorId.Eq:return{partKind:a,forceNeg:!1};case ac.OperatorId.Ne:case ac.OperatorId.Gt:case ac.OperatorId.Ge:return{partKind:a,forceNeg:!0};case ac.OperatorId.Lt:return{partKind:a,forceNeg:t.cond(s)>0};case ac.OperatorId.Le:return{partKind:a,forceNeg:t.cond(s)>=0}}}}var c=Yt.Zero;if(this.parts[c]===this.parts[Yt.Pos])throw new zb(Ee.noFormatPart);return{partKind:c,forceNeg:!0}},e.prototype.getNumShape=function(r){var t=this.applyCurrCode,n=t==null?void 0:t.numberShape;if(n!==void 0)return n;if(r===void 0)return _r.NumberShape.ASCII;var a=this.getBundledLocaleInfo("localised DBNUM culture",_r.Calendar.Gregorian,t);return a.isEastAsia&&(a.isKorea?n=ksr[r]:a.isJapan?n=Osr[r]:a.isChinaT?n=Fsr[r]:a.isChinaS&&(n=Nsr[r])),n??_r.NumberShape.ASCII},e.prototype.formFraction=function(r,t,n){var a,o,u=this.config.mathpack;if(t!==void 0){var s=u.fromNumber(137438953472);if((0,Pr.isErrorOper)(u.sub(r,s)))throw new kl((0,Pr.notImplemented)(["overflow in fraction threshold check"]));if(u.cond2(r,s)<0){var l=u.mul(r,u.fromNumber(1.0000000000000002));(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction nudged error",(0,Pr.isNumberOper)(l)),r=l}var c=t,d=u.toNumber(c)<<1,f=u.mul(r,u.fromNumber(d));if(!(0,Pr.isNumberOper)(f))throw new kl((0,Pr.notImplemented)(["overflow in fraction denom mul"]));var m=u.lfix(f);if(m<0||m>=65535)throw new zb(Ee.fractionOverflow);var v=u.fromNumber(m+1>>1);return{numer:v,denom:c}}var h;switch(n){case 1:h=10;break;case 2:h=100;break;case 3:h=1e3;break;case 4:h=1e4;break;case 5:h=1e5;break;case 6:h=1e6;break;default:h=1e7;break}var y=u.fix(r);if(y>=2147483647)throw new zb(Ee.fractionOverflow);for(var _=r,E=1,N=1,k=0,q=0;;){var V=E*y;q+=V;var I=k*y;N+=I;var M=V>2147483647||I>2147483647;if(M||N>=h){k===1&&y===2&&u.cond2(_,u.trunc(_))===0&&(E+=1);break}a=[q,E],E=a[0],q=a[1],o=[N,k],k=o[0],N=o[1];var B=u.sub(_,u.trunc(_));if((0,un.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction frac sub",(0,Pr.isNumberOper)(B)),u.cond(B)===0)break;var U=u.div(u.one,B);if((0,Pr.isErrorOper)(U))throw new kl((0,Pr.notImplemented)(["overflow in fraction inversion"]));if(_=U,(y=u.fix(_))>2147483647)break}return k===0&&(k=E=1),{numer:u.fromNumber(E),denom:u.fromNumber(k)}},e.prototype.synthesizeDecimals=function(r){for(var t=this,n=(0,no.fastMax)(0,(0,no.fastMin)(r,mY)),a=[],o=function(d){var f=u.parts[d];if((d===Yt.Neg||d===Yt.Zero)&&f===u.parts[Yt.Pos])return a.push(a[Yt.Pos]),"continue";if(d===Yt.Text)return a.push(f===u.parts[Yt.Pos]?a[Yt.Pos]:f),"continue";var m=f.code,v=f.color,h=f.dbnum,y=f.dtrRounding,_=m.map(function(N){if(N.kind===mt.Num){var k=N.numDigLeft,q=N.numPercent,V=N.numThousands,I=N.comma,M=N.codeBefore,B={kind:mt.Num,numDigLeft:k,numDigDec:n,numPercent:q,numThousands:V,comma:I,code:t.adjustDecimals(d,N.numDigDec,N.code,n),codeBefore:M};return B}if(N.kind===mt.Exp){var U=N.isNeg,j=N.numMantDigLeft,X=N.numExpDigLeft,ee=N.commaMant,re=N.codeBetween,Z=N.codeExp,B={kind:mt.Exp,isNeg:U,numMantDigLeft:j,numMantDigDec:n,numExpDigLeft:X,commaMant:ee,codeMant:t.adjustDecimals(d,N.numMantDigDec,N.codeMant,n),codeBetween:re,codeExp:Z};return B}return N}),E={code:_,color:v,dbnum:h,dtrRounding:y};a.push(E)},u=this,s=Yt.Pos;s<=Yt.Text;s+=1)o(s);try{var l=new e(this.config,{old:this,logFormatString:"synthesizeDecimals(dec=".concat(n," on ").concat(this.logFormatString,")"),synth:a});if(l.formatString.length>F_e)throw new gr(this.notFormatString("format string too long: max length"));return l}catch(c){if(c instanceof gr)return this;throw c}},e.prototype.adjustDecimals=function(r,t,n,a){var o;if(a===t)return n;for(var u=!1,s=void 0,l=void 0,c=void 0,d=0;d<n.length;d+=1){var f=n[d];switch(f.kind){case G.PictureSingle.Decimal:c===void 0&&(c=d);break;case G.PictureSingle.Hash:case G.PictureSingle.Question:case G.PictureSingle.Zero:c!==void 0?l=d:(s=d,f.kind===G.PictureSingle.Question&&(u=!0));break}}var m=function(X){return X===G.PictureSingle.Percent||X===Ke.Currency||X===Ke.CurrCode||X===G.PictureSingle.Star};if(a===0){if(c===void 0)return n;var v=0,h=0;s===void 0?l!==void 0&&(v=c+1,h=l+1):(v=c,h=(l??c)+1);for(var y=n.slice(0,v),d=v;d<h;d+=1)m(n[d].kind)&&y.push(n[d]);return(0,no.safePush)(y,n.slice(h)),y}if(t>a){(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: adjustDecimals dec",c!==void 0);var _=void 0;(function(j){j[j.AfterDigs=0]="AfterDigs",j[j.Dropping=1]="Dropping",j[j.Keeping=2]="Keeping"})(_||(_={}));for(var E=_.AfterDigs,N=[],k=t-a,d=n.length-1;d>=0;d-=1){d<=c&&(E=_.Keeping);var f=n[d];if(E===_.AfterDigs&&(f.kind===G.PictureSingle.Hash||f.kind===G.PictureSingle.Question||f.kind===G.PictureSingle.Zero)&&(E=_.Dropping),E===_.Keeping||E===_.AfterDigs||m(f.kind)){N.push(f);continue}if(f.kind===G.PictureSingle.Hash||f.kind===G.PictureSingle.Question||f.kind===G.PictureSingle.Zero){var q=(0,no.fastMin)(k,f.count);q<f.count&&N.push({kind:f.kind,count:f.count-q}),k-=q,k===0&&(E=_.Keeping)}}return N.reverse(),N}if(r===Yt.Zero&&u&&l===void 0)return n;var V=a-t;if(l!==void 0){var I=n.slice(),f=I[l];return I[l]={kind:f.kind,count:f.count+V},I}var M=n.slice(),B=(o=c??s)!==null&&o!==void 0?o:M.length-1,U=[];return c===void 0&&U.push({kind:G.PictureSingle.Decimal}),U.push({kind:G.PictureSingle.Zero,count:V}),M.splice.apply(M,Qb.__spreadArray([B+1,0],U,!1)),M},e.prototype.parseString=function(r){if(this.source!==Ee.NumberFormatSource.CustomBytecode&&r.length>F_e)throw new gr(this.notFormatString("format string too long: max length"));for(var t=!1,n=!1,a=0,o=!1,u=Yt.Pos;u<=Yt.Text&&!o;u+=1){var s=this.tokenize(r.substring(a)),l=s.cond,c=s.currencySymbol,d=s.hasTokenCurrCode,f=this.convertTokToSun(s),m=f.currCode,v=f.hasPercent,h=f.hasDate,y=f.hasTime,_=this.classifySunPartKind(f,u===Yt.Text?bm.Text:bm.Unknown),E=this.convertSunToCode(f),N=E.part,k=E.applyCurrCode;if(a+=s.consumed,o=s.eos,v&&(this.hasPercent=!0),h&&(this.hasDate=!0),y&&(this.hasTime=!0),d){if(u!==Yt.Pos&&(!this.hasTokenCurrCode||!Asr(this.thisCurrCode,m)))throw new gr((0,Pr.notImplemented)(["inconsistent CurrCode in number parts"]));this.hasTokenCurrCode||(this.hasTokenCurrCode=!0,this.thisCurrCode=m)}if(k!==void 0&&this.applyCurrCode===void 0&&(this.applyCurrCode=k),c!==void 0&&this.thisCurrencySymbol===void 0&&(this.thisCurrencySymbol=c),this.source===Ee.NumberFormatSource.System&&((0,un.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: system ipart",u===Yt.Pos),!o||_===bm.Text))throw new gr(this.notFormatString("system format with more than one part"));if((_===bm.Text||u===Yt.Pos&&_===bm.Either)&&(t=!0,this.parts[Yt.Text]=N,_===bm.Text)){if(l!==void 0)throw new gr(this.notFormatString("condition in text part"));if(m!==void 0)throw new gr((0,Pr.notImplemented)(["CurrCode in text part"]));break}if(n=!0,this.parts[u]=N,this.onlyOneNumberPart=u===Yt.Pos,u===Yt.Pos)this.parts[Yt.Neg]=N,this.parts[Yt.Zero]=N,this.condPos=l;else if(u===Yt.Neg)this.condNeg=l;else if(l!==void 0)throw new gr(this.notFormatString("condition in zero part"))}if(!o)throw new gr(this.notFormatString("too many parts"));n||(this.parts[Yt.Pos]=Tx,this.parts[Yt.Neg]=Tx,this.parts[Yt.Zero]=Tx,this.posBeforeText=!1),t||(this.parts[Yt.Text]=Tx),n&&!t&&this.onlyOneNumberPart&&this.condPos!==void 0&&!O_e(this.parts[Yt.Pos].code)&&(this.parts[Yt.Neg]=Tx,this.onlyOneNumberPart=!1),(0,un.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: every part set",this.parts.every(function(q){return q!==void 0})),this.checkBytecode()},e.prototype.tokenize=function(r){for(var t=this.config.localeInfo,n={color:void 0,dbnum:void 0,dbnumForbidden:!1,cond:void 0,hasTokenCurrCode:!1,currCode:void 0,currencySymbol:void 0,tokens:[],consumed:0,eos:!0},a,o,u;n.consumed<r.length&&n.eos;){var s=this.readToken(n,r,n.consumed),l=a;switch(a=s,n.consumed+=s.tokenStr.length,s.kind){case G.PictureSingle.Sep:n.eos=!1;continue;case Ke.Color:if(n.color!==void 0)throw new gr(this.notFormatString("more than one color"));if(n.tokens.length!==0)throw new gr((0,Pr.notImplemented)(["colour in middle of format"]));n.color=s.color;continue;case Ke.Dbnum:if(n.dbnum!==void 0)throw new gr(this.notFormatString("more than one DBNUM"));if(n.dbnumForbidden)throw new gr(this.notFormatString("DBNUM after token which forbids it (% or E)"));if(n.tokens.length!==0)throw new gr((0,Pr.notImplemented)(["DBNUM in middle of format"]));n.dbnum=s.dbnum;continue;case Ke.Cond:if(n.cond!==void 0)throw new gr(this.notFormatString("more than one condition"));if(n.tokens.length!==0)throw new gr((0,Pr.notImplemented)(["condition in middle of format"]));n.cond=s.cond;continue;case Ke.CurrCode:if(o!==void 0)throw new gr(this.notFormatString("more than one currency code in section"));o=s;break;case Ke.Currency:u=s;break;case Ke.AMPM:case Ke.AMPMFE:case G.PictureSingle.Colon:case G.PictureSingle.DateSep:case Ke.LatinDate:case Ke.BidiDate:case G.PictureSingle.Year:case G.PictureSingle.Month:case G.PictureSingle.Day:case G.PictureSingle.Hour:case G.PictureSingle.Minute:case G.PictureSingle.Second:case G.PictureSingle.Reign:case G.PictureSingle.LocDay:case G.PictureSingle.Era:case G.PictureSingle.EraYear:case G.PictureSingle.EngYearTh:case G.PictureSingle.DayTh:case G.PictureSingle.MonthTh:case G.PictureSingle.YearTh:case G.PictureSingle.ThYear:case G.PictureSingle.HourTh:case G.PictureSingle.MinuteTh:case G.PictureSingle.SecondTh:{if((l==null?void 0:l.kind)===s.kind){l.count+=s.count;continue}break}}n.tokens.push(s)}return o!==void 0?(n.hasTokenCurrCode=!0,n.currCode=o.currCode,n.currencySymbol=o.currencySymbol):u!==void 0&&n.currencySymbol===void 0&&(n.currencySymbol=Ee.FormatCurrency.LocaleInfo),n.dbnum===4&&!t.isKorea&&(n.currCode!==void 0||t.isThai)&&(n.dbnum=void 0),n},e.prototype.readToken=function(r,t,n){var a=this.config,o=a.mathpack,u=a.localeInfo,s=JT(u,u.pictureSpecial,t,n);if(s!==void 0){var l=s,c=pt(u.pictureSpecial,l);u.isJapan&&l===G.PictureSpecial.GeneralOldMAC&&(l=G.PictureSpecial.General);var d=t.substring(n,n+c.length);switch(l){case G.PictureSpecial.AP1:case G.PictureSpecial.AP2:return{kind:Ke.AMPM,tokenStr:d,count:1,pictureKind:l};case G.PictureSpecial.AP3:return{kind:Ke.AMPMFE,tokenStr:d,count:1};case G.PictureSpecial.General:return{kind:Ke.General,tokenStr:d};case G.PictureSpecial.Currency:return{kind:Ke.Currency,tokenStr:d};default:break}}var f=(0,Sd.stringCodePointAt)(t,n),m=(0,Sd.numCodeUnits)(f),v=t.substring(n,n+m),h=T_e(u,u.pictureSingle,t,n);if(h!==void 0){var l=h;if((u.isJapan||u.isChinaT)&&(l===G.PictureSingle.E||l===G.PictureSingle.EraYear)){var y=void 0,_=void 0;n+m+1<t.length&&((y=t.charCodeAt(n+m))===uY||y===__e)&&((_=t.charCodeAt(n+m+1))===hsr||_===Ssr||_===ysr)?l=G.PictureSingle.E:l=G.PictureSingle.EraYear}if(l===G.PictureSingle.BidiDate||l===G.PictureSingle.EngYearTh){var y=void 0;if(n+m<t.length&&((y=t.charCodeAt(n+m))===b_e||y===_sr))return{kind:y===b_e?Ke.LatinDate:Ke.BidiDate,tokenStr:t.substring(n,n+m+1),count:1};l=G.PictureSingle.EngYearTh}if(l===G.PictureSingle.BidiNum)throw new gr(this.notFormatString("bidi num not allowed"));switch(l){case G.PictureSingle.Star:case G.PictureSingle.Underscore:{if(n+m>=t.length)throw new gr(this.notFormatString("unterminated "+v));var y=(0,Sd.stringCodePointAt)(t,n+m),E=(0,Sd.numCodeUnits)(y),N=(0,Sd.stringFromCodePoint)(y),d=t.substring(n,n+m+E);return{kind:l,tokenStr:d,escaped:N}}case G.PictureSingle.Backslash:return this.readToken_Backslash(t,n,m);case G.PictureSingle.Quote:{var k=t.indexOf(v,n+m);if(k<0)throw new gr(this.notFormatString("unterminated quoted string"));var q=t.substring(n+m,k),d=t.substring(n,k+m),V=JT(u,u.pictureSpecial,q,0);return V!==void 0&&V===G.PictureSpecial.Currency&&pt(u.pictureSpecial,V).length===q.length?{kind:Ke.Currency,tokenStr:d}:{kind:Ke.StrLit,tokenStr:d,escaped:q}}case G.PictureSingle.E:{if(u.isEastAsia){if(r.dbnum!==void 0)throw new gr(this.notFormatString("invalid DBNUM with exp"));if(r.dbnumForbidden)throw new gr((0,Pr.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));r.dbnumForbidden=!0}if(n+m>=t.length)throw new gr(this.notFormatString("unterminated exp"));var y=t.charCodeAt(n+m);if(y!==__e&&y!==uY)throw new gr(this.notFormatString("exp not followed by sign"));var d=t.substring(n,n+m+1);return{kind:Ke.Exp,tokenStr:d,eStr:v,isNeg:y===uY}}case G.PictureSingle.Hash:case G.PictureSingle.Year:case G.PictureSingle.Month:case G.PictureSingle.Day:case G.PictureSingle.Hour:case G.PictureSingle.Minute:case G.PictureSingle.Second:case G.PictureSingle.YearTh:case G.PictureSingle.MonthTh:case G.PictureSingle.DayTh:case G.PictureSingle.HourTh:case G.PictureSingle.MinuteTh:case G.PictureSingle.SecondTh:case G.PictureSingle.EngYearTh:case G.PictureSingle.ThYear:case G.PictureSingle.Question:case G.PictureSingle.Comma:case G.PictureSingle.Reign:case G.PictureSingle.LocDay:case G.PictureSingle.Era:case G.PictureSingle.EraYear:{if(l===G.PictureSingle.Reign&&!(u.isJapan||u.isChinaT))break;for(var I=m,M=1;(0,Cu.stringStartsWith)(t,v,n+I)&&JT(u,u.pictureSpecial,t,n+I)===void 0;)I+=m,M+=1;if(l===G.PictureSingle.LocDay&&M<3)break;var d=t.substring(n,n+I);return{kind:l,tokenStr:d,count:M}}case G.PictureSingle.Sep:case G.PictureSingle.Text:case G.PictureSingle.Decimal:case G.PictureSingle.Slash:case G.PictureSingle.Minus:case G.PictureSingle.Plus:return{kind:l,tokenStr:v};case G.PictureSingle.Space:return{kind:Ke.Char,tokenStr:v,escaped:v};case G.PictureSingle.Colon:return{kind:l,tokenStr:v,count:1};case G.PictureSingle.Percent:if(u.isEastAsia){if(r.dbnum!==void 0)throw new gr(this.notFormatString("invalid DBNUM with pct"));if(r.dbnumForbidden)throw new gr((0,Pr.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));r.dbnumForbidden=!0}return{kind:G.PictureSingle.Percent,tokenStr:v};case G.PictureSingle.DateSep:return v===pt(u.pictureSingle,G.PictureSingle.Slash)?{kind:G.PictureSingle.Slash,tokenStr:v}:v===pt(u.pictureSingle,G.PictureSingle.Minus)?{kind:G.PictureSingle.Minus,tokenStr:v}:{kind:G.PictureSingle.DateSep,tokenStr:v,count:1};case G.PictureSingle.ColorStart:{var B=pt(u.pictureSingle,G.PictureSingle.ColorEnd),U=t.indexOf(B,n+m);if(U<0)throw new gr(this.notFormatString("unterminated ["));var j=t.substring(n+m,U),d=t.substring(n,U+B.length),X=JT(u,lY,j,0);if(X!==void 0){for(var ee=pt(lY,X),re=ee.length;re<j.length&&(0,kB.isSpace)(j.charCodeAt(re));)re+=1;var Z=(0,kB.parseSignedLiteral)(u,o,j,re,!1);if(Z[1]===re)throw new gr((0,Pr.notImplemented)(["invalid number in condition"]));if(Z[1]!==j.length)throw new gr((0,Pr.notImplemented)(["trailing junk after condition"]));return{kind:Ke.Cond,tokenStr:d,cond:{operator:Dsr[X],operand:Z[0]}}}var J=JT(u,u.pictureColor,j,0);if(J!==void 0){var C=pt(u.pictureColor,J);if(J!==G.PictureColor.Color){if(C.length!==j.length)throw new gr((0,Pr.notImplemented)(["trailing junk after named color"]));return{kind:Ke.Color,tokenStr:d,color:Msr(J)}}if(J===G.PictureColor.Color){for(var S=C.length;S<j.length&&(0,kB.isSpace)(j.charCodeAt(S));)S+=1;var b=(0,kB.parseUint)(u,4,j,S),O=b[0],w=b[1];if(w===S)throw new gr(this.notFormatString("missing number for numbered color"));if(w!==j.length)throw new gr((0,Pr.notImplemented)(["trailing junk after numbered color"]));if(O<1||O>56)throw new gr(this.notFormatString("out-of-range numbered color"));return{kind:Ke.Color,tokenStr:d,color:O+8}}}var D=JT(u,u.pictureDbnum,j,0);if(D!==void 0){var Q=pt(u.pictureDbnum,D);if(Q.length!==j.length)throw new gr((0,Pr.notImplemented)(["trailing junk after DBNUM"]));return{kind:Ke.Dbnum,tokenStr:d,dbnum:Isr(D)}}return(0,Cu.stringStartsWith)(j,cY)?Qb.__assign({kind:Ke.CurrCode,tokenStr:d},this.parseCurrCode(j.substring(cY.length))):{kind:l,tokenStr:v}}case G.PictureSingle.ColorEnd:return{kind:l,tokenStr:v};case G.PictureSingle.OpenParen:case G.PictureSingle.CloseParen:return{kind:l,tokenStr:v,escaped:v};case G.PictureSingle.Extra:case G.PictureSingle.APDelim:case G.PictureSingle.Nen1:case G.PictureSingle.Gatsu1:case G.PictureSingle.Nichi1:case G.PictureSingle.Nen2:case G.PictureSingle.Gatsu2:case G.PictureSingle.Nichi2:break;case G.PictureSingle.Zero:case G.PictureSingle.ZeroTh:break;default:return(0,un.assertNever)("calc.numfmt.NumberFormatImpl: readToken single picKind",l)}}if(u.isNumeral(f)){if(u.getNumberShape(f)!==_r.NumberShape.ASCII)throw new gr((0,Pr.notImplemented)(["non-ASCII digits"]));var W=u.getOrdinal(f);if(W===0){for(var $=m,M=1;(0,Cu.stringStartsWith)(t,v,n+$);)$+=m,M+=1;var d=t.substring(n,n+$);return{kind:G.PictureSingle.Zero,tokenStr:d,count:M}}return{kind:Ke.Numeral,tokenStr:v,ordinal:W}}switch(f){case sY:return{kind:G.PictureSingle.OpenParen,tokenStr:v,escaped:v};case C_e:return{kind:G.PictureSingle.CloseParen,tokenStr:v,escaped:v};case Csr:return this.readToken_Backslash(t,n,m);case bsr:if(u.isThai)return{kind:Ke.PrefixDigTh,tokenStr:v};break}return{kind:Ke.Char,tokenStr:v,escaped:v}},e.prototype.readToken_Backslash=function(r,t,n){if(t+n>=r.length)throw new gr(this.notFormatString("unterminated backslash"));var a=(0,Sd.stringCodePointAt)(r,t+n),o=(0,Sd.numCodeUnits)(a),u=(0,Sd.stringFromCodePoint)(a),s=r.substring(t,t+n+o);return a===sY||a===C_e?{kind:a===sY?G.PictureSingle.OpenParen:G.PictureSingle.CloseParen,tokenStr:s,escaped:u}:{kind:Ke.Char,tokenStr:s,escaped:u}},e.prototype.convertTokToSun=function(r){var t=this,n,a=r.color,o=r.dbnum,u=r.cond,s=r.currCode,l=r.tokens,c=this.config.localeInfo,d={suns:[],dtrRounding:Xb.Rounding.RoundSec,color:a,dbnum:o,currCode:s,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return this.suns.length===0&&u===void 0&&a===void 0&&o===void 0&&s===void 0}},f=c.stringCompareCI(pt(c.pictureSingle,G.PictureSingle.Month),pt(c.pictureSingle,G.PictureSingle.Minute))===0,m=!1,v=0,h=0,y=!1,_=!1,E,N=!1,k=!1,q,V,I,M,B=0,U=function(bs,hl){var id=pY[bs];if(hl){if(_)throw new gr(t.notFormatString("more than one absolute time"));if(E!==void 0&&id>=E)throw new gr(t.notFormatString("absolute time must be largest division"));_=!0}else if(_&&id<=E)throw new gr((0,Pr.notImplemented)(["larger time division after absolute time"]));(E===void 0||id<E)&&(E=id)};function j(wu,bs,hl){var id=E;if(U(wu,bs),wu===G.PictureSingle.Hour||wu===G.PictureSingle.HourTh)N=!0,I=hl,M=void 0;else if(wu===G.PictureSingle.Second||wu===G.PictureSingle.SecondTh)if(M!==void 0&&!_){var as=M.code[0];(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCode",as.kind===G.PictureSingle.Month);var Lv=G.PictureSingle.Minute,qv=as.count;(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCount",qv===1||qv===2);var e0=!1;U(Lv,e0),v-=1,h+=1,M.code=[{kind:Lv,count:qv,isAbs:e0}],M=void 0}else id===void 0&&(N=!0);else N=!1}function X(wu){var bs=pt(c.pictureSingle,wu.kind);return{kind:mt.TimeSep,printAsTimeSep:v>0||h>0,formattedStr:bs}}function ee(wu){var bs=pt(c.pictureSingle,wu.kind);return bs===pt(c.pictureSingle,G.PictureSingle.DateSep)?{kind:mt.DateSep}:bs===pt(c.pictureSingle,G.PictureSingle.Colon)?X(wu):{kind:mt.Char,formattedStr:bs}}for(var re=0;re<l.length;re+=1){var Z=l[re];switch(Z.kind){case Ke.AMPM:case Ke.AMPMFE:case G.PictureSingle.Colon:case G.PictureSingle.DateSep:case G.PictureSingle.Year:case G.PictureSingle.Month:case G.PictureSingle.Day:case G.PictureSingle.Hour:case G.PictureSingle.Minute:case G.PictureSingle.Second:case G.PictureSingle.Reign:case G.PictureSingle.LocDay:case G.PictureSingle.Era:case G.PictureSingle.EraYear:case G.PictureSingle.EngYearTh:case Ke.LatinDate:case Ke.BidiDate:case G.PictureSingle.DayTh:case G.PictureSingle.MonthTh:case G.PictureSingle.YearTh:case G.PictureSingle.ThYear:case G.PictureSingle.HourTh:case G.PictureSingle.MinuteTh:case G.PictureSingle.SecondTh:{var J={kind:Mn.Date,code:[]};switch(d.suns.push(J),y=!0,Z.kind){case Ke.LatinDate:case Ke.BidiDate:if(re!==0&&!(re===1&&l[0].kind===Ke.CurrCode))throw new gr(this.notFormatString("bidi date must be first"));J.code.push(Z);break;case G.PictureSingle.DateSep:J.code.push({kind:mt.DateSep});break;case G.PictureSingle.Colon:J.code.push(X(Z));break;case G.PictureSingle.Reign:v+=1,c.isJapan&&Z.count>=2&&J.code.push({kind:G.PictureSingle.Era,count:3}),J.code.push({kind:G.PictureSingle.EraYear,count:c.isChinaT?1:2});break;case G.PictureSingle.Era:v+=1,J.code.push({kind:G.PictureSingle.Era,count:(0,no.fastMin)(3,Z.count)});break;case G.PictureSingle.EraYear:v+=1,J.code.push({kind:G.PictureSingle.EraYear,count:(0,no.fastMin)(2,Z.count)});break;case G.PictureSingle.Year:case G.PictureSingle.YearTh:case G.PictureSingle.EngYearTh:case G.PictureSingle.ThYear:M=void 0,v+=1,J.code.push({kind:Z.kind,count:Z.count<=2?2:4});break;case G.PictureSingle.Month:{if(f&&Z.count<=2){if(N){var C=G.PictureSingle.Minute,S=!1;j(C,S,J),h+=1,J.code.push({kind:C,count:Z.count,isAbs:S}),N=!1;break}M=J}else M=void 0;v+=1,J.code.push({kind:Z.kind,count:(0,no.fastMin)(5,Z.count)});break}case G.PictureSingle.MonthTh:{v+=1,J.code.push({kind:Z.kind,count:(0,no.fastMin)(4,Z.count)});break}case G.PictureSingle.Day:case G.PictureSingle.DayTh:M=void 0,v+=1,J.code.push({kind:Z.kind,count:(0,no.fastMin)(4,Z.count)});break;case G.PictureSingle.LocDay:M=void 0,v+=1,J.code.push({kind:G.PictureSingle.LocDay,count:Z.count===3?3:4});break;case G.PictureSingle.Hour:case G.PictureSingle.HourTh:case G.PictureSingle.Minute:case G.PictureSingle.MinuteTh:case G.PictureSingle.Second:case G.PictureSingle.SecondTh:{var S=!1;j(Z.kind,S,J),h+=1;var b=(0,no.fastMin)(2,Z.count);Z.kind===G.PictureSingle.Hour||Z.kind===G.PictureSingle.HourTh?J.code.push({kind:Z.kind,count:b,isAbs:S,isAMPM:!1}):J.code.push({kind:Z.kind,count:b,isAbs:S});break}case Ke.AMPM:case Ke.AMPMFE:if(_)throw new gr(this.notFormatString("AM/PM after absolute time"));if(Z.count>1)throw new gr((0,Pr.notImplemented)(["multiple AM/PM symbols"]));if(I!==void 0){var O=I.code[0];O.isAMPM=!0,I=void 0}k=!0,J.code.push(Z);break;default:return(0,un.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",Z)}break}case G.PictureSingle.Decimal:case Ke.Numeral:case G.PictureSingle.Hash:case G.PictureSingle.Zero:case G.PictureSingle.Question:case G.PictureSingle.Comma:{if(y){if(Z.kind!==G.PictureSingle.Decimal&&Z.kind!==G.PictureSingle.Comma)throw new gr(this.notFormatString("number picture in date/time format"));var w={kind:Mn.Date,code:[]};d.suns.push(w);var D=l[re+1];if(Z.kind===G.PictureSingle.Decimal&&(D==null?void 0:D.kind)===G.PictureSingle.Zero){var Q=D.count;if(Q>3)throw new gr(this.notFormatString("invalid number of fractional seconds"));re+=1,j(G.PictureSingle.Second,!1,w),h+=1,w.code.push({kind:mt.FracSeconds,rounding:Q}),d.dtrRounding=(0,no.fastMax)(d.dtrRounding,Q)}else w.code.push(ee(Z));break}if(Z.kind===G.PictureSingle.Comma){var W=pt(c.pictureSingle,Z.kind),$={kind:Mn.Other,code:[{kind:mt.Char,formattedStr:W}]};d.suns.push($);break}var me=function(hl){return hl===Ke.Numeral||hl===G.PictureSingle.Hash||hl===G.PictureSingle.Zero||hl===G.PictureSingle.Question},J={kind:Mn.Num,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};d.suns.push(J),q===void 0&&(q=J),V=J;var ve=void 0;for(re-=1;re+1<l.length;re+=1){var Pe=l[re+1],ua=!0;switch(Pe.kind){case G.PictureSingle.Decimal:m=J.decimal=!0,J.code.push(Pe),ve=void 0;break;case Ke.Numeral:J.code.push({kind:Pe.kind,formattedStr:Pe.tokenStr,ordinal:Pe.ordinal}),J.numVal=J.nonZero=!0,ve=void 0;break;case G.PictureSingle.Hash:case G.PictureSingle.Zero:case G.PictureSingle.Question:if(J.decimal?J.numDigDec+=Pe.count:J.numDigLeft+=Pe.count,J.firstDig===void 0&&(J.firstDig=Pe.kind),J.lastDig=Pe.kind,Pe.kind===G.PictureSingle.Hash?J.anyHash=!0:Pe.kind===G.PictureSingle.Question?J.anyQuestion=!0:(J.anyZero=!0,J.numVal=!0),ve!==void 0&&ve.kind===Pe.kind)ve.count+=Pe.count;else{var O={kind:Pe.kind,count:Pe.count};J.code.push(O),ve=O}break;case G.PictureSingle.Comma:var D=(n=l[re+2])===null||n===void 0?void 0:n.kind;if(me(D))m||(J.comma=!0);else{var b=Pe.count,Qi=pt(c.pictureSingle,G.PictureSingle.Space),go=pt(c.pictureSingle,G.PictureSingle.Comma);Qi===go&&(!c.isCurrencySymbolLead&&c.isCurrencySepBySpace&&D===Ke.Currency||c.isPercentSepBySpace&&D===G.PictureSingle.Percent)&&(J.code.push({kind:mt.Char,formattedStr:Qi}),b-=1),b>0&&(J.numThousands+=b)}break;default:ua=!1;break}if(!ua)break}break}case G.PictureSingle.Percent:{B+=1;var J={kind:Mn.Percent,code:[{kind:G.PictureSingle.Percent,formattedStr:Z.tokenStr}]};d.suns.push(J),d.hasPercent=!0;break}case Ke.Exp:{var J={kind:Mn.Exp,code:[{kind:Ke.Exp,formattedStr:Z.eStr,isNeg:Z.isNeg}],isNeg:Z.isNeg};d.suns.push(J);break}case Ke.General:{var J={kind:Mn.General,code:[Z]};d.suns.push(J);break}case G.PictureSingle.Text:{var J={kind:Mn.Text,code:[Z]};d.suns.push(J);break}case G.PictureSingle.Slash:{if(y){var Ro={kind:Mn.Date,code:[ee(Z)]};d.suns.push(Ro);break}var J={kind:Mn.Fraction,code:[{kind:G.PictureSingle.Slash,formattedStr:Z.tokenStr}]};d.suns.push(J);break}case G.PictureSingle.Star:case Ke.PrefixDigTh:case G.PictureSingle.Underscore:case Ke.Currency:case Ke.CurrCode:case Ke.StrLit:{var J={kind:Mn.Other,code:[Z]};d.suns.push(J);break}case G.PictureSingle.ColorEnd:case G.PictureSingle.Plus:{var J={kind:Mn.Other,code:[{kind:mt.Char,formattedStr:Z.tokenStr}]};d.suns.push(J);break}case G.PictureSingle.OpenParen:case G.PictureSingle.CloseParen:case Ke.Char:{var J={kind:Mn.Other,code:[{kind:mt.Char,formattedStr:Z.escaped}]};d.suns.push(J);break}case G.PictureSingle.Minus:{if(y){var $n={kind:Mn.Date,code:[ee(Z)]};d.suns.push($n);break}var W=pt(c.pictureSingle,Z.kind),J={kind:Mn.Other,code:[{kind:mt.Char,formattedStr:W}]};d.suns.push(J);break}case G.PictureSingle.ColorStart:{for(var ns=Yb.WantPic,J={kind:Mn.Date,code:[]};re+1<l.length&&ns!==Yb.Done;re+=1){var Iu=l[re+1];switch(Iu.kind){case G.PictureSingle.ColorEnd:if(ns!==Yb.WantClose)throw new gr(this.notFormatString("unexpected closing ]"));ns=Yb.Done;continue;case G.PictureSingle.Hour:case G.PictureSingle.HourTh:case G.PictureSingle.Month:case G.PictureSingle.Minute:case G.PictureSingle.Second:{if(Iu.kind===G.PictureSingle.Month&&!f)break;var C=Iu.kind===G.PictureSingle.Month?G.PictureSingle.Minute:Iu.kind,S=!0;j(C,S,J),h+=1;var b=(0,no.fastMin)(2,Iu.count);C===G.PictureSingle.Hour||C===G.PictureSingle.HourTh?J.code.push({kind:C,count:b,isAbs:S,isAMPM:!1}):J.code.push({kind:C,count:b,isAbs:S}),y=!0,ns=Yb.WantClose;continue}case Ke.Char:if(Iu.tokenStr===pt(c.pictureSingle,G.PictureSingle.Space))continue;break;default:break}throw new gr(this.notFormatString("unexpected token after ["))}if(ns!==Yb.Done)throw new gr((0,Pr.notImplemented)(["semicolon inside [ ]"]));d.suns.push(J);break}default:return(0,un.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok",Z)}if(d.suns.length>=2){var wi=d.suns[d.suns.length-2],mp=d.suns[d.suns.length-1];if(wi.kind===Mn.Other&&mp.kind===Mn.Other){var zl=wi.code;(0,no.safePush)(zl,mp.code),d.suns.pop()}}}if(q!==void 0&&(q.numThousands=V.numThousands,q.numPercent=B),k&&I!==void 0){var O=I.code[0];O.isAMPM=!0}if(_)for(var Ql=0,_c=d.suns;Ql<_c.length;Ql++){var J=_c[Ql];if(J.kind===Mn.Date)for(var Gd=0,vl=J.code;Gd<vl.length;Gd++){var O=vl[Gd];switch(O.kind){case G.PictureSingle.Hour:case G.PictureSingle.HourTh:case G.PictureSingle.Minute:case G.PictureSingle.MinuteTh:case G.PictureSingle.Second:case G.PictureSingle.SecondTh:O.isAbs=pY[O.kind]===E;break}}}if(d.suns.length>$sr)throw new gr(this.notFormatString("format string too long: SUNs limit"));return d.hasDate=v>0,d.hasTime=h>0,d},e.prototype.classifySunPartKind=function(r,t){for(var n=r.suns,a=r.isEmpty,o=r.hasDate,u=r.hasTime,s=t===bm.Number,l=t===bm.Text,c=!s&&!l,d=0,f=n;d<f.length;d++){var m=f[d];switch(m.kind){case Mn.Num:case Mn.Fraction:case Mn.Percent:case Mn.Exp:s=!0;break;case Mn.Text:l=!0;break;case Mn.General:continue;case Mn.Other:case Mn.Date:break;default:return(0,un.assertNever)("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",m)}c=!1}if((s?1:0)+(o||u?1:0)+(l?1:0)>1)throw new gr(this.notFormatString("cannot mix number/date/text"));return s||o||u?bm.Number:l?bm.Text:c&&!a?bm.Either:t},e.prototype.convertSunToCode=function(r){var t=r.suns,n=r.isEmpty,a=r.dtrRounding,o=r.color,u=r.dbnum,s=r.currCode,l=this.config.localeInfo,c=[];function d(ve){for(var Pe=ve-1;Pe>=0;Pe-=1){var ua=t[Pe];if(ua.kind===Mn.Num)return[Pe,ua]}}function f(ve){for(var Pe=ve+1;Pe<t.length;Pe+=1){var ua=t[Pe];if(ua.kind===Mn.Num)return[Pe,ua]}}for(var m,v=!1,h=0,y=0;y<t.length;y+=1){var _=t[y];switch(_.kind){case Mn.Text:if(m===Mn.Text)break;if(m!==void 0)throw new gr(this.notFormatString("@ after other control"));m=Mn.Text;break;case Mn.General:if(m!==void 0)throw new gr(this.notFormatString("General after other control"));if(v)throw new gr(this.notFormatString("General after number"));m=Mn.General;break;case Mn.Num:if(v=!0,m===Mn.General)throw new gr(this.notFormatString("number after General"));break;case Mn.Fraction:if(m!==void 0)throw new gr(this.notFormatString("/ after other control"));if(l.isEastAsia&&u!==void 0)throw new gr(this.notFormatString("/ not allowed with DBNUM"));m=Mn.Fraction;var E=d(y);if(E===void 0)throw new gr(this.notFormatString("no number before /"));var N=this.mergeNumSuns(t,h,E[0]),k=N[0],q=N[1],V=N[2],I=f(y);if(I===void 0)throw new gr(this.notFormatString("no number after /"));var M=t.slice(E[0]+1,I[0]),B=f(I[0])!==void 0;(0,no.safePush)(c,this.flattenSuns(k)),(0,no.safePush)(c,this.buildFractCode(q,V,E[1],M,I[1],B)),h=I[0]+1;break;case Mn.Exp:if(m!==void 0)throw new gr(this.notFormatString("E after other control"));m=Mn.Exp;var U=this.mergeNumSuns(t,h,y),j=U[0],X=U[1],ee=U[2];if(X===void 0)throw new gr(this.notFormatString("no number before E"));var re=this.mergeNumSuns(t,y+1,t.length),Z=re[0],J=re[1],C=re[2];if(J===void 0)throw new gr(this.notFormatString("no number after E"));(0,no.safePush)(c,this.flattenSuns(j)),(0,no.safePush)(c,this.buildExpCode(_.isNeg,X,Qb.__spreadArray(Qb.__spreadArray(Qb.__spreadArray([],ee,!0),[t[y]],!1),Z,!0),J)),(0,no.safePush)(c,this.flattenSuns(C)),h=t.length;break;case Mn.Percent:case Mn.Other:case Mn.Date:break;default:return(0,un.assertNever)("calc.numfmt.NumberFormatImpl: convertSunToCode sun",_)}}if(m===void 0){var S=this.mergeNumSuns(t,h,t.length),k=S[0],b=S[1],O=S[2];b!==void 0?(0,no.safePush)(c,this.buildNumberCode(k,b)):(0,no.safePush)(c,this.flattenSuns(k)),(0,no.safePush)(c,this.flattenSuns(O)),h=t.length}(0,no.safePush)(c,this.flattenSuns(t.slice(h))),t.length===0&&!n&&c.push(N_e);var w=s==null?void 0:s.tag;if((0,Ee.isSystemCultureTag)(w)){var D=w===Ee.CultureTag.SysDate?l.sysDateFormat:l.sysTimeFormat,Q=new e(this.config,{old:void 0,formatString:D,source:Ee.NumberFormatSource.System}),W=Q.parts[Yt.Pos],$={code:[{kind:mt.SysFormat,codeSysFormat:W.code,codeThisFormat:c}],color:W.color,dbnum:W.dbnum,dtrRounding:W.dtrRounding};return{part:$,applyCurrCode:Q.thisCurrCode}}var me={code:c,color:o,dbnum:u,dtrRounding:a};return{part:me,applyCurrCode:s}},e.prototype.flattenSuns=function(r){return(0,no.safeConcat)([],r.map(function(t){return t.code}))},e.prototype.buildExpCode=function(r,t,n,a){if(a.comma)throw new gr(this.notFormatString("comma following E"));var o=t.numDigDec;if(o>mY)throw new gr(this.notFormatString("too many decimal digits"));var u=this.bumpDigitsForComma(t),s=u.code,l=u.comma,c=u.numDigLeft;return[{kind:mt.Exp,isNeg:r,numMantDigLeft:c,numMantDigDec:o,numExpDigLeft:a.numDigLeft,commaMant:l,codeMant:s,codeBetween:this.flattenSuns(n),codeExp:this.flattenSuns([a])}]},e.prototype.buildNumberCode=function(r,t){var n=t.numDigDec;if(n>mY)throw new gr(this.notFormatString("too many decimal digits"));var a=this.bumpDigitsForComma(t),o=a.code,u=a.comma,s=a.numDigLeft;return[{kind:mt.Num,numDigLeft:s,numDigDec:n,numPercent:t.numPercent,numThousands:t.numThousands,comma:u,codeBefore:this.flattenSuns(r),code:o}]},e.prototype.buildFractCode=function(r,t,n,a,o,u){var s,l,c,d=this.config.mathpack;if(n.comma)throw new gr(this.notFormatString("comma in numerator"));if(n.decimal)throw new gr((0,Pr.notImplemented)(["decimals in numerator"]));if(o.comma)throw new gr(this.notFormatString("comma in denominator"));if(o.decimal)throw new gr(this.notFormatString("decimals in denominator"));if(n.numDigDec!==0)throw new gr(this.notFormatString("decimals in numerator"));if(Ysr(o))throw new gr(this.notFormatString("literal and placeholder digits mixed in denominator"));if(u)throw new gr((0,Pr.notImplemented)(["fraction number formats with trailing numbers"]));var f=!1,m=0,v;if(r!==void 0){if(!r.reallyNum)throw new gr((0,Pr.notImplemented)(["fixed numerals in fraction integer part"]));if(r.decimal)throw new gr((0,Pr.notImplemented)(["decimal in fraction integer part"]));if(r.numDigDec!==0)throw new gr(this.notFormatString("decimals in fraction integer part"));if(r.numVal&&r.nonZero)throw new gr((0,Pr.notImplemented)(["numerals in fraction integer part"]));s=this.bumpDigitsForComma(r),v=s.code,f=s.comma,m=s.numDigLeft}var h=(l=r==null?void 0:r.numPercent)!==null&&l!==void 0?l:n.numPercent,y=(c=r==null?void 0:r.numThousands)!==null&&c!==void 0?c:n.numThousands;if(y>0)throw new gr((0,Pr.notImplemented)(["fraction number formats with thousands"]));var _=o.code,E=o.numDigLeft,N=o.firstDig,k;if(o.numVal&&o.nonZero){if(u)throw new gr((0,Pr.notImplemented)(["fraction number formats with specified denominator and trailing numbers"]));if(o.code.length>5)throw new gr((0,Pr.notImplemented)(["too many digits in denominator"]));for(var q=0,V=0;V<o.code.length;V+=1){var I=o.code[V];switch(I.kind){case Ke.Numeral:q=q*10+I.ordinal;break;case G.PictureSingle.Zero:if(V===0)throw new gr((0,Pr.notImplemented)(["leading zero in denominator"]));q=q*10;break;default:return(0,un.assertFalse)("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(q>32767)throw new gr((0,Pr.notImplemented)(["overflow in denominator not emulated"]));_=[{kind:G.PictureSingle.Hash,count:1}],E=1,N=void 0,k=d.fromNumber(q)}return[{kind:mt.Fraction,numIntDigLeft:m,numPercent:h,numThousands:y,numNumerDig:n.numDigLeft,numDenomDig:E,commaInt:f,codeInt:v,codeBetween1:this.flattenSuns(t),codeNumer:n.code,codeBetween2:this.flattenSuns(a),codeDenom:_,denomValue:k,lastDigInt:r!==void 0?r.lastDig:void 0,firstDigNumer:n.firstDig,firstDigDenom:N,anyZeroNumer:n.anyZero,anyQuestionNumer:n.anyQuestion}]},e.prototype.mergeNumSuns=function(r,t,n){for(var a=[],o=[],u,s=t;s<r.length&&s<n;s+=1){var l=r[s];u!==void 0?l.kind===Mn.Num?(u.decimal?u.numDigDec+=l.numDigLeft+l.numDigDec:(u.numDigLeft+=l.numDigLeft,u.numDigDec+=l.numDigDec),u.comma=u.comma||l.comma,u.decimal=u.decimal||l.decimal,u.numVal=u.numVal||l.numVal,u.nonZero=u.nonZero||l.nonZero,l.lastDig!==void 0&&(u.lastDig=l.lastDig),u.firstDig===void 0&&(u.firstDig=l.firstDig),u.anyHash=u.anyHash||l.anyHash,u.anyQuestion=u.anyQuestion||l.anyQuestion,u.anyZero=u.anyZero||l.anyZero,(0,no.safePush)(u.code,this.flattenSuns(o)),o.length=0,(0,no.safePush)(u.code,l.code)):o.push(l):l.kind===Mn.Num?u=l:a.push(l)}return[a,u,o]},e.prototype.bumpDigitsForComma=function(r){if(!r.comma||this.anyLegalCommaPosition(r))return r;for(var t=r.numDigLeft%3,n=(t===0?r.numDigLeft===0?3:r.numDigLeft:r.numDigLeft+3-t)+1,a=0;a<r.code.length;a+=1){var o=r.code[a];switch(o.kind){case G.PictureSingle.Hash:{var u=r.code.slice();return u[a]=Qb.__assign(Qb.__assign({},o),{count:o.count+(n-r.numDigLeft)}),{code:u,comma:!0,numDigLeft:n}}case G.PictureSingle.Zero:case G.PictureSingle.Question:case G.PictureSingle.Decimal:{var u=r.code.slice();return u.splice(a,0,{kind:G.PictureSingle.Hash,count:n-r.numDigLeft}),{code:u,comma:!0,numDigLeft:n}}}}throw new gr((0,Pr.notImplemented)(["comma with pure number literal"]))},e.prototype.anyLegalCommaPosition=function(r){if(r.numDigLeft<4)return!1;for(var t=function(l){var c=l==null?void 0:l.kind;return c===G.PictureSingle.Hash||c===G.PictureSingle.Zero||c===G.PictureSingle.Question},n=r.numDigLeft,a=0;a<r.code.length;a+=1){var o=r.code[a];if(o.kind===G.PictureSingle.Decimal)return!1;if(t(o)){for(var u=0;u<o.count;u+=1)if(n-=1,n>0&&n%3===0&&(u+1<o.count||t(r.code[a+1])))return!0}}return!1},e.prototype.parseCurrCode=function(r){var t=this.config.localeInfo,n,a,o;{var u=r.indexOf(MB);if(r.length!==0&&u!==0){if(n=u<0?r:r.substring(0,u),n.length>61)throw new gr(this.notFormatString("currencySymbol too long"));for(var s=0,l=(0,Sd.codePointIterator)(n);s<l.length;s++){var c=l[s];if(t.isNumeral(c)&&t.getNumberShape(c)!==_r.NumberShape.ASCII)throw new gr((0,Pr.notImplemented)(["non-ASCII digits in currencySymbol"]))}}u>=0&&(o=r.substring(u+MB.length))}if(o!==void 0&&(a=this.parseFormatCulture(o),a===void 0))throw new gr((0,Pr.notImplemented)(["unhandled CurrCode: "+(0,bx.anonymizeFormulaString)(r)]));if((0,Ee.isSystemCultureTag)(a==null?void 0:a.tag)){if(n!==void 0)throw new gr(this.notFormatString("currencySymbol with sysdate/systime"));if(this.source===Ee.NumberFormatSource.System)throw new gr(this.notFormatString("system format referenced circularly within system format"))}return{currencySymbol:n,currCode:a}},e.prototype.parseFormatCulture=function(r){var t,n,a={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},o=function(v){var h=(v&32512)>>8;if(h!==0&&(a.numberShape=Uc.pictureNumberShape[h],a.numberShape===void 0))throw new gr((0,Pr.notImplemented)(["unknown number shape ".concat(h," in culture: ").concat((0,bx.anonymizeFormulaString)(r))]));a.nationalNumberInput=(v&32768)!==0;var y=v&127;if(y!==0&&(a.calendar=Uc.pictureCalendar[y],a.calendar===void 0))throw new gr((0,Pr.notImplemented)(["unknown calendar ".concat(y," in culture: ").concat((0,bx.anonymizeFormulaString)(r))]));a.localCalendarInput=(v&128)!==0},u=r.match(Ksr);if(u!=null){a.culture=(t=u[1])!==null&&t!==void 0?t:"";var s=(n=u[2])!==null&&n!==void 0?n:u[3];if(s!=null){if(a.tag=Vsr[s.toLowerCase()],a.tag===void 0)throw new gr((0,Pr.notImplemented)(["unknown CurrCode tag: "+(0,bx.anonymizeFormulaString)(r)]));switch(a.tag){case Ee.CultureTag.SysDate:case Ee.CultureTag.SysTime:case Ee.CultureTag.Euro1:case Ee.CultureTag.Euro2:case Ee.CultureTag.Bitcoin1:case Ee.CultureTag.Bitcoin2:if(a.culture!=="")throw new gr(this.notFormatString("CultureTag ".concat(String(a.tag)," cannot have culture")));break;case Ee.CultureTag.GenLower:case Ee.CultureTag.GenUpper:case Ee.CultureTag.NomLower:case Ee.CultureTag.Gannen:if(a.culture==="")throw new gr(this.notFormatString("CultureTag ".concat(String(a.tag)," must have culture")));break}}var l=u[4];if(l!=null){var c=E_e(l);o(c)}return a}if(Usr.test(r)){var d=E_e(r),f=d&65535;switch(f){case G.LCID.SystemLongDate:a.tag=Ee.CultureTag.SysDate;break;case G.LCID.SystemTime:a.tag=Ee.CultureTag.SysTime;break;case G.LCID.EuroTrailing:a.tag=Ee.CultureTag.Euro1;break;case G.LCID.EuroLeading:a.tag=Ee.CultureTag.Euro2;break;default:(f&64512)===64512&&(a.tag=Ee.CultureTag.GenLower),(f&64512)===63488&&(a.tag=Ee.CultureTag.GenUpper),(f&64512)===62464&&(a.tag=Ee.CultureTag.NomLower),a.tag!==void 0&&(f&=-63489),a.culture=(0,y_e.convertKnownLCID)(f);break}var c=d>>16;return o(c),a}},e.prototype.determineValueType=function(){for(var r=this.config.localeInfo,t={accountFill:!1,fvt:void 0},n=0,a=this.parts;n<a.length;n++){var o=a[n];t.accountFill=!1;var u=this.determineValueTypeCodes(t,o.code);if(u!==void 0)return u;if(t.accountFill&&(t.fvt===Ee.FormatValueType.Number||t.fvt===Ee.FormatValueType.Currency))return Ee.FormatValueType.Accounting;if(t.fvt!==void 0)return t.fvt}return t.fvt!==void 0?t.fvt:this.formatString===pt(r.pictureSpecial,G.PictureSpecial.General)?Ee.FormatValueType.General:Ee.FormatValueType.Custom},e.prototype.determineValueTypeCodes=function(r,t){for(var n=this.config.localeInfo,a=0;a<t.length;a+=1){var o=t[a];switch(o.kind){case Ke.General:break;case G.PictureSingle.Text:return Ee.FormatValueType.Text;case G.PictureSingle.Star:r.accountFill=!0;break;case mt.Char:case Ke.Exp:case G.PictureSingle.Slash:case Ke.StrLit:case G.PictureSingle.Percent:case G.PictureSingle.Underscore:case Ke.Numeral:case mt.DateSep:case mt.TimeSep:break;case Ke.Currency:r.fvt=Ee.FormatValueType.Currency;break;case Ke.CurrCode:o.currencySymbol!==void 0&&(r.fvt=Ee.FormatValueType.Currency);break;case mt.Num:{r.fvt=o.numPercent===1&&o.numThousands===0?Ee.FormatValueType.Percentage:Ee.FormatValueType.Number;var u=o.codeBefore,s=0;if(n.isEastAsia){if(s<u.length&&xB(u[s])==="("&&(s+=1),s<u.length&&xB(u[s])==="US$")return Ee.FormatValueType.Currency;if(n.isChinaT){if(s<u.length&&xB(u[s])==="NT$")return Ee.FormatValueType.Currency}else if(s<u.length&&xB(u[s])==="$")return Ee.FormatValueType.Currency}var l=void 0;if((l=this.determineValueTypeCodes(r,o.codeBefore.slice(s)))!==void 0||(l=this.determineValueTypeCodes(r,o.code))!==void 0)return l;break}case mt.Exp:{r.fvt=Ee.FormatValueType.Scientific;var l=void 0;if((l=this.determineValueTypeCodes(r,o.codeMant))!==void 0||(l=this.determineValueTypeCodes(r,o.codeBetween))!==void 0||(l=this.determineValueTypeCodes(r,o.codeExp))!==void 0)return l;break}case mt.Fraction:{r.fvt=Ee.FormatValueType.Fraction;var l=void 0;if(o.codeInt!==void 0&&(l=this.determineValueTypeCodes(r,o.codeInt))!==void 0||(l=this.determineValueTypeCodes(r,o.codeBetween1))!==void 0||(l=this.determineValueTypeCodes(r,o.codeNumer))!==void 0||(l=this.determineValueTypeCodes(r,o.codeBetween2))!==void 0||(l=this.determineValueTypeCodes(r,o.codeDenom))!==void 0)return l;break}case G.PictureSingle.Decimal:case G.PictureSingle.Hash:case G.PictureSingle.Zero:case G.PictureSingle.Question:break;case Ke.PrefixDigTh:case Ke.LatinDate:case Ke.BidiDate:break;case G.PictureSingle.HourTh:case G.PictureSingle.MinuteTh:case G.PictureSingle.SecondTh:case G.PictureSingle.Hour:case G.PictureSingle.Minute:case G.PictureSingle.Second:case mt.FracSeconds:return Ee.FormatValueType.Time;case Ke.AMPM:case Ke.AMPMFE:break;case G.PictureSingle.Era:case G.PictureSingle.EraYear:case G.PictureSingle.YearTh:case G.PictureSingle.EngYearTh:case G.PictureSingle.ThYear:case G.PictureSingle.MonthTh:case G.PictureSingle.DayTh:case G.PictureSingle.Year:case G.PictureSingle.Month:case G.PictureSingle.Day:case G.PictureSingle.LocDay:return Ee.FormatValueType.Date;case mt.SysFormat:return this.determineValueTypeCodes(r,o.codeThisFormat);default:return(0,un.assertNever)("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",o)}}},e.prototype.determineDecimals=function(){for(var r=this.parts[Yt.Pos],t=0,n=r.code;t<n.length;t++){var a=n[t];switch(a.kind){case mt.Num:return a.numDigDec;case mt.Exp:return a.numMantDigDec}}return 0},e.prototype.determineBidiDate=function(){var r=pt(this.config.localeInfo.pictureSingle,G.PictureSingle.BidiDate);if((0,Cu.stringStartsWith)(this.formatString,r+"1"))return Ee.BidiDate.English;if((0,Cu.stringStartsWith)(this.formatString,r+"2"))return Ee.BidiDate.Lunar},e.prototype.printFormatString=function(){var r=this.config.localeInfo,t=this.parts,n=t[0],a=t[1],o=t[2],u=t[3],s=!(A_e(u)||u===n),l=this.posBeforeText||!s,c="";return l&&(c+=this.printPart(n,this.condPos),a!==n&&(c+=pt(r.pictureSingle,G.PictureSingle.Sep),c+=this.printPart(a,this.condNeg),o!==n&&(c+=pt(r.pictureSingle,G.PictureSingle.Sep),c+=this.printPart(o,void 0)))),s&&(l&&(c+=pt(r.pictureSingle,G.PictureSingle.Sep)),c+=this.printPart(u,void 0)),c},e.prototype.printPart=function(r,t){var n=this.config,a=n.mathpack,o=n.localeInfo,u="";if(r.color!==void 0&&(u+=pt(o.pictureSingle,G.PictureSingle.ColorStart)+(typeof r.color=="number"?pt(o.pictureColor,G.PictureColor.Color)+String(r.color-8):pt(o.pictureColor,xsr(r.color)))+pt(o.pictureSingle,G.PictureSingle.ColorEnd)),t!==void 0){var s=21;u+=pt(o.pictureSingle,G.PictureSingle.ColorStart)+pt(lY,Lsr[t.operator])+a.formatGeneral(o,t.operand,s)+pt(o.pictureSingle,G.PictureSingle.ColorEnd)}return r.dbnum!==void 0&&(u+=pt(o.pictureSingle,G.PictureSingle.ColorStart)+pt(o.pictureDbnum,wsr(r.dbnum))+pt(o.pictureSingle,G.PictureSingle.ColorEnd)),u+=this.printCodes({seenDig:!1,wasPrevDig:!1},r.code,void 0),u},e.prototype.printCodes=function(r,t,n){var a=this.config,o=a.mathpack,u=a.localeInfo,s="",l;if(n!==void 0&&n.numThousands>0){for(var c=0;c<t.length;c+=1){var d=t[c].kind;(d===G.PictureSingle.Zero||d===G.PictureSingle.Hash||d===G.PictureSingle.Question||d===G.PictureSingle.Decimal||d===Ke.Numeral)&&(l=c)}(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",l!==void 0)}for(var f=function(_){return _===G.PictureSingle.Hash||_===G.PictureSingle.Zero||_===G.PictureSingle.Question},m=function(_){var E=t[_],N=r.wasPrevDig;switch(r.wasPrevDig=!1,E.kind){case Ke.General:s+=pt(u.pictureSpecial,G.PictureSpecial.General);break;case G.PictureSingle.Decimal:n!==void 0&&(n.decimal=!0),r.wasPrevDig=!0,s+=pt(u.pictureSingle,G.PictureSingle.Decimal);break;case G.PictureSingle.Hash:case G.PictureSingle.Zero:case G.PictureSingle.Question:{r.seenDig=!0,r.wasPrevDig=!0;var k=E.kind===G.PictureSingle.Zero?"0":pt(u.pictureSingle,E.kind),q=(0,Cu.repeat)(k,E.count);if(n===void 0||n.decimal){s+=q;break}if(n.comma){var V=n.numDigLeft-E.count;s+=(0,Cm.insertCommas)({isThousandsPosition:function(Pe){var ua;return Pe>0&&Pe%3===0&&(Pe>V||f((ua=t[_+1])===null||ua===void 0?void 0:ua.kind))},thousandsSeparator:pt(u.pictureSingle,G.PictureSingle.Comma)},q,V)}else s+=q;n.numDigLeft-=E.count;break}case Ke.Numeral:r.wasPrevDig=!0,s+=E.formattedStr;break;case mt.Exp:s+=v.printCodes(r,E.codeMant,{comma:E.commaMant,numThousands:0,decimal:!1,numDigLeft:E.numMantDigLeft})+v.printCodes(r,E.codeBetween,void 0)+v.printCodes(r,E.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:E.numExpDigLeft});break;case mt.Num:s+=v.printCodes(r,E.codeBefore,void 0)+v.printCodes(r,E.code,{comma:E.comma,numThousands:E.numThousands,decimal:!1,numDigLeft:E.numDigLeft});break;case mt.Fraction:{var I=E.codeInt===void 0?"":v.printCodes(r,E.codeInt,{comma:E.commaInt,numThousands:0,decimal:!1,numDigLeft:E.numIntDigLeft}),M=v.printCodes(r,E.codeBetween1,void 0),B=v.printCodes(r,E.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:E.numNumerDig}),U=v.printCodes(r,E.codeBetween2,void 0),j=v.printCodes(r,E.codeDenom,{comma:!1,numThousands:E.numThousands,decimal:!1,numDigLeft:E.numDenomDig});s+=I+M+B+U+(E.denomValue!==void 0?lF(o,E.denomValue):j);break}case mt.Char:{var X=pt(u.pictureSingle,G.PictureSingle.Backslash),ee=T_e(u,u.pictureSingle,E.formattedStr,0),re=qsr(u,u.pictureSpecial,E.formattedStr,0);if(ee!==void 0&&ee!==G.PictureSingle.Extra&&ee!==G.PictureSingle.Zero)switch(ee){case G.PictureSingle.Comma:var Z=t[_+1];if(N){var J=pt(u.pictureSingle,G.PictureSingle.Space);if(E.formattedStr!==J||Z===void 0||!(!u.isCurrencySymbolLead&&u.isCurrencySepBySpace&&Z.kind===Ke.Currency)&&!(u.isPercentSepBySpace&&Z.kind===G.PictureSingle.Percent)){s+=X;break}}if((Z==null?void 0:Z.kind)===mt.Char&&(Z==null?void 0:Z.formattedStr)===E.formattedStr){s+=X;break}break;case G.PictureSingle.Decimal:s+=X;break;case G.PictureSingle.Slash:r.seenDig&&(s+=X);break;case G.PictureSingle.Space:case G.PictureSingle.Minus:case G.PictureSingle.Plus:case G.PictureSingle.OpenParen:case G.PictureSingle.CloseParen:break;case G.PictureSingle.DateSep:pt(u.pictureSingle,G.PictureSingle.DateSep)!==pt(u.pictureSingle,G.PictureSingle.Minus)&&(s+=X);break;default:s+=X;break}else(re||u.isNumeral((0,Sd.stringCodePointAt)(E.formattedStr,0)))&&(s+=X);s+=E.formattedStr;break}case Ke.Exp:s+=E.formattedStr+(E.isNeg?"-":"+");break;case Ke.StrLit:{var X=pt(u.pictureSingle,G.PictureSingle.Quote);(0,un.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes StrLit",E.escaped.indexOf(X)<0),s+=X+E.escaped+X;break}case G.PictureSingle.Slash:s+=pt(u.pictureSingle,G.PictureSingle.Slash);break;case G.PictureSingle.Percent:s+=pt(u.pictureSingle,G.PictureSingle.Percent);break;case G.PictureSingle.Star:s+=pt(u.pictureSingle,G.PictureSingle.Star)+E.escaped;break;case G.PictureSingle.Underscore:s+=pt(u.pictureSingle,G.PictureSingle.Underscore)+E.escaped;break;case Ke.PrefixDigTh:s+="t";break;case Ke.Currency:s+=pt(u.pictureSpecial,G.PictureSpecial.Currency);break;case Ke.CurrCode:if(s+=pt(u.pictureSingle,G.PictureSingle.ColorStart),s+=cY,E.currencySymbol!==void 0&&(s+=E.currencySymbol),E.currCode!==void 0){var C=E.currCode,S=C.culture,b=C.numberShape,O=C.nationalNumberInput,w=C.calendar,D=C.localCalendarInput,Q=C.tag;s+=MB;var W=0;switch(b!==void 0&&(W|=Uc.pictureNumberShape.indexOf(b)<<8),O&&(W|=32768),w!==void 0&&(W|=Uc.pictureCalendar.indexOf(w)),D&&(W|=128),typeof S){case"number":{var $=S;switch(Q){case void 0:break;case Ee.CultureTag.GenLower:$|=64512;break;case Ee.CultureTag.GenUpper:$|=63488;break;case Ee.CultureTag.NomLower:$|=62464;break;default:(0,un.assertFalse)("calc.numfmt.NumberFormatImpl: printCodes lcid2")}var me=dY(W<<16|$);/^[a-f]{1,7}$/i.test(me)&&(me="0"+me),s+=me;break}case"string":{s+=S,Q!==void 0&&(S!==""&&(s+=MB),s+=Bsr,s+=String(Q)),W!==0&&(s+=Gsr,s+=dY(W));break}}}s+=pt(u.pictureSingle,G.PictureSingle.ColorEnd);break;case G.PictureSingle.Text:s+=pt(u.pictureSingle,G.PictureSingle.Text);break;case Ke.LatinDate:s+=pt(u.pictureSingle,G.PictureSingle.BidiDate)+"1";break;case Ke.BidiDate:s+=pt(u.pictureSingle,G.PictureSingle.BidiDate)+"2";break;case mt.FracSeconds:s+=pt(u.pictureSingle,G.PictureSingle.Decimal)+(0,Cu.repeat)("0",E.rounding);break;case mt.DateSep:s+=pt(u.pictureSingle,G.PictureSingle.DateSep);break;case mt.TimeSep:s+=pt(u.pictureSingle,G.PictureSingle.Colon);break;case G.PictureSingle.Era:case G.PictureSingle.EraYear:case G.PictureSingle.Year:case G.PictureSingle.YearTh:case G.PictureSingle.EngYearTh:case G.PictureSingle.ThYear:case G.PictureSingle.Month:case G.PictureSingle.MonthTh:case G.PictureSingle.Day:case G.PictureSingle.DayTh:case G.PictureSingle.LocDay:s+=(0,Cu.repeat)(pt(u.pictureSingle,E.kind),E.count);break;case G.PictureSingle.Hour:case G.PictureSingle.HourTh:case G.PictureSingle.Minute:case G.PictureSingle.MinuteTh:case G.PictureSingle.Second:case G.PictureSingle.SecondTh:if(E.isAbs){s+=pt(u.pictureSingle,G.PictureSingle.ColorStart)+(0,Cu.repeat)(pt(u.pictureSingle,E.kind),E.count)+pt(u.pictureSingle,G.PictureSingle.ColorEnd);break}s+=(0,Cu.repeat)(pt(u.pictureSingle,E.kind),E.count);break;case Ke.AMPM:case Ke.AMPMFE:E.kind===Ke.AMPMFE||u.isEastAsia||E.pictureKind===G.PictureSpecial.AP2?s+=E.tokenStr:s+=pt(u.pictureSpecial,E.pictureKind);break;case mt.SysFormat:s+=v.printCodes(r,E.codeThisFormat,void 0);break;default:return{value:(0,un.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",E)}}_===l&&(s+=(0,Cu.repeat)(pt(u.pictureSingle,G.PictureSingle.Comma),n.numThousands))},v=this,c=0;c<t.length;c+=1){var h=m(c);if(typeof h=="object")return h.value}return s},e.prototype.countBytecodeBuffer=function(r){for(var t,n,a=this.config,o=a.mathpack,u=a.localeInfo,s=0,l=0;l<r.length;l+=1){var c=r[l],d=IB;switch(c.kind){case G.PictureSingle.Percent:case Ke.Numeral:case mt.Char:case G.PictureSingle.Star:case G.PictureSingle.Underscore:d+=Rx;break;case Ke.StrLit:d+=1+Rx*c.escaped.length;break;case mt.FracSeconds:case G.PictureSingle.Hash:case G.PictureSingle.Zero:case G.PictureSingle.Question:case Ke.Exp:d+=1;break;case G.PictureSingle.Hour:case G.PictureSingle.HourTh:case G.PictureSingle.Minute:case G.PictureSingle.MinuteTh:case G.PictureSingle.Second:case G.PictureSingle.SecondTh:c.isAbs&&(d+=1);break;case mt.Fraction:if(d+=5,c.codeInt!==void 0&&(d+=this.countBytecodeBuffer(c.codeInt)),d+=this.countBytecodeBuffer(c.codeBetween1),d+=this.countBytecodeBuffer(c.codeNumer),d+=this.countBytecodeBuffer(c.codeBetween2),d+=this.countBytecodeBuffer(c.codeDenom),c.denomValue!==void 0){d-=2;var f=lF(o,c.denomValue).length;d+=2+Rx*f}c.commaInt&&(d+=IB);break;case mt.Exp:d+=3,d+=this.countBytecodeBuffer(c.codeMant),d+=this.countBytecodeBuffer(c.codeBetween),d+=this.countBytecodeBuffer(c.codeExp),c.commaMant&&(d+=IB);break;case mt.Num:d+=3,d+=this.countBytecodeBuffer(c.codeBefore),d+=this.countBytecodeBuffer(c.code),c.comma&&(d+=IB);break;case mt.SysFormat:d=0,d+=this.countBytecodeBuffer(c.codeThisFormat);break;case Ke.CurrCode:d+=Rx*(((n=(t=c.currencySymbol)===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0)+1),d+=8;break;case Ke.AMPM:{var m=u.isEastAsia||c.pictureKind===G.PictureSpecial.AP2?R_e(u,c.tokenStr):u.ampmSymbols;d+=2+Rx*(m[0].length+m[1].length)}break;case Ke.AMPMFE:break;case Ke.General:case G.PictureSingle.Decimal:case G.PictureSingle.Slash:case Ke.PrefixDigTh:case Ke.Currency:case G.PictureSingle.Text:case Ke.LatinDate:case Ke.BidiDate:case mt.DateSep:case mt.TimeSep:case G.PictureSingle.Era:case G.PictureSingle.EraYear:case G.PictureSingle.Year:case G.PictureSingle.YearTh:case G.PictureSingle.EngYearTh:case G.PictureSingle.ThYear:case G.PictureSingle.Month:case G.PictureSingle.MonthTh:case G.PictureSingle.Day:case G.PictureSingle.DayTh:case G.PictureSingle.LocDay:break;default:return(0,un.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",c)}s+=d}return s},e.prototype.countBytecodePart=function(r){var t=r.code,n=r.color,a=r.dbnum,o=r.dtrRounding,u=0;return n!==void 0&&(u+=2),a!==void 0&&(u+=2),o!==0&&(u+=2),u+=this.countBytecodeBuffer(t),u},e.prototype.countBytecode=function(){for(var r=0,t=Yt.Pos;t<=Yt.Text;t+=1){(t===Yt.Pos&&this.condPos!==void 0||t===Yt.Neg&&this.condNeg!==void 0)&&(r+=10);for(var n=this.parts[t],a=!1,o=Yt.Pos;o<t;o+=1)if(this.parts[o]===n){a=!0;break}a||(r+=this.countBytecodePart(n))}return r},e.prototype.checkBytecode=function(){if(this.countBytecode()>Zsr)throw new gr(this.notFormatString("format string too long: bytecode limit"));if(this.countBytecode()>247)throw new gr((0,Pr.notImplemented)(["format string too long: close to bytecode limit"]))},e.prototype.getBundledLocaleInfo=function(r,t,n){var a=n;switch(t){case _r.Calendar.GregorianUS:a=jsr;break;case _r.Calendar.GregorianMEFrench:a=Wsr;break;case _r.Calendar.GregorianArabic:a=Hsr;break;case _r.Calendar.GregorianXlitEnglish:a=zsr;break;case _r.Calendar.GregorianXlitFrench:a=Qsr;break;case _r.Calendar.UmAlQura:case _r.Calendar.Hijri:break;case _r.Calendar.Thai:a=fY;break}if((a==null?void 0:a.culture)!==void 0&&a.culture!==""){var o=(0,y_e.getBundledLocaleInfo)(a);if(o===void 0)throw new kl(this.notImplementedCulture(r,a.culture));return o}return this.config.localeInfo},e.prototype.notFormatString=function(r){return(0,Ee.notFormatString)("".concat(r," (source=").concat(String(this.source),"): ").concat(this.logFormatString))},e.prototype.notImplementedCulture=function(r,t){var n=typeof t=="number"?"lcid:".concat(dY(t)):"lang:".concat(t);return(0,Pr.notImplemented)(["".concat(r,": culture = ").concat(n)])},e}();Uc.NumberFormatImpl=k_e;function elr(e,r,t){try{return(0,Ls.success)(new k_e(e.config,{old:void 0,formatString:r,source:t}))}catch(n){return n instanceof gr?(0,Ls.failure)(n.reason):(0,Ls.failure)((0,Ls.javaScriptError)(n))}}Uc.createFormat=elr;function rlr(e){if(e.length===0)return!1;var r=(0,Sd.stringCodePointAt)(e,0);return r>=1424&&r<=1535||r===8207||r>=64285&&r<=64335||r>=1536&&r<=1791||r>=1872&&r<=1919||r>=2208&&r<=2303||r>=64336&&r<=65023||r>=65136&&r<=65279}function tlr(e,r,t,n){try{var a=void 0,o=void 0,u=void 0,s=e.config.localeInfo;switch(t.kind){case YT.OperKind.String:a=rlr(t.value)?Ee.Alignment.Right:Ee.Alignment.Left,o=Ee.Clip.None,u=t;break;case YT.OperKind.Number:a=r.isTextOnly?Ee.Alignment.Left:Ee.Alignment.Right,o=Ee.Clip.All,u=t;break;case YT.OperKind.Boolean:a=Ee.Alignment.Center,o=Ee.Clip.All,u=(0,psr.stringOper)(t.value?s.trueName:s.falseName);break;case YT.OperKind.Blank:return(0,Ls.success)((0,Ee.formattedValue)([],void 0,Ee.Alignment.Left,Ee.Clip.All));case YT.OperKind.Error:var l=s.errorNames[t.type];return l==null?(0,Ls.failure)((0,Pr.internal)("No locale data for error type ".concat(t.type))):(0,Ls.success)((0,Ee.formattedValue)([(0,Ee.formattedUnitString)(l)],void 0,Ee.Alignment.Center,Ee.Clip.All));case YT.OperKind.Array:return(0,Ls.failure)((0,Pr.notImplemented)(["Array applyFormat"]));case YT.OperKind.Rich:return(0,Ls.failure)((0,Pr.notImplemented)(["Rich applyFormat"]))}return r.apply(u,a,o,n)}catch(c){return(0,Ls.failure)((0,Ls.javaScriptError)(c))}}Uc.applyFormat=tlr;function nlr(e,r){try{switch(e.valueType){case Ee.FormatValueType.General:return(0,Ls.failure)((0,Pr.notImplemented)(["changeDecimals General"]));case Ee.FormatValueType.Number:case Ee.FormatValueType.Currency:case Ee.FormatValueType.Accounting:case Ee.FormatValueType.Percentage:case Ee.FormatValueType.Scientific:if(e.decimals===0&&r<0)return Ls.successUndefined;var t=(0,no.fastMax)(0,e.decimals+r),n=e.synthesizeDecimals(t);return n.formatString===e.formatString?Ls.successUndefined:(0,Ls.success)(n);default:return Ls.successUndefined}}catch(a){return(0,Ls.failure)((0,Ls.javaScriptError)(a))}}Uc.changeFormatDecimals=nlr});var ZT=T(li=>{"use strict";p();var Jb;Object.defineProperty(li,"__esModule",{value:!0});li.englishXLSXKnownFormat=li.isKnownFormatDefined=li.getKnownFormat=li.buildNumShapeDateTimeFormat=li.buildNumShapeConstFormat=li.buildMMDDYYFormat=li.buildSingle=li.buildCurrencyFormat=li.buildFractionFormat=li.buildQuoted=li.buildScientificFormat=li.buildPercentFormat=li.buildNumberFormat=li.getColor=li.getSingle=li.getSpecial=void 0;var Zb=fe(),Pi=Ch(),ke=Ch(),Ce=HT(),DB=HT(),alr=gx(),dF=U0(),Tm=aF(),w_e=wB(),ilr=jT();function Ex(e,r){var t,n=(t=e.pictureSpecial[r])!==null&&t!==void 0?t:Ce.englishPictureSpecial[r];return(0,dF.assertTrue)("calc.numfmt.knownFormat: getSpecial",n!==void 0),n}li.getSpecial=Ex;function qn(e,r){var t,n=(t=e.pictureSingle[r])!==null&&t!==void 0?t:Ce.englishPictureSingle[r];return(0,dF.assertTrue)("calc.numfmt.knownFormat: getSingle",n!==void 0),n}li.getSingle=qn;function D_e(e,r){var t,n=(t=e.pictureColor[r])!==null&&t!==void 0?t:Ce.englishPictureColor[r];return(0,dF.assertTrue)("calc.numfmt.knownFormat: getColor",n!==void 0),n}li.getColor=D_e;function qg(e,r,t,n){var a="";if(t>1){var o=(0,Tm.repeat)(qn(e,Ce.PictureSingle.Hash),t-1);a+=r?(0,alr.insertCommas)({isThousandsPosition:function(s){return s>0&&s%3===0},thousandsSeparator:qn(e,Ce.PictureSingle.Comma)},o,1):o}return a+="0",n>0&&(a+=qn(e,Ce.PictureSingle.Decimal),a+=(0,Tm.repeat)("0",n)),a}li.buildNumberFormat=qg;function cF(e,r){var t="";return t+="0",r>0&&(t+=qn(e,Ce.PictureSingle.Decimal),t+=(0,Tm.repeat)("0",r)),e.isPercentSepBySpace&&(t+=qn(e,Ce.PictureSingle.Space)),t+=qn(e,Ce.PictureSingle.Percent),t}li.buildPercentFormat=cF;function hY(e,r,t,n){var a="";return a+=qg(e,!1,r,t),e.isExpSepBySpace&&(a+=qn(e,Ce.PictureSingle.Space)),a+=qn(e,Ce.PictureSingle.E),a+="+",a+=(0,Tm.repeat)("0",n),a}li.buildScientificFormat=hY;function Px(e,r){var t=qn(e,Ce.PictureSingle.Quote);return t+r+t}li.buildQuoted=Px;function SY(e,r){var t="";t+=qn(e,Ce.PictureSingle.Hash);var n=e.fractionSeparator;return n===qn(e,Ce.PictureSingle.Comma)?t+=Px(e,n):n===" "?t+=qn(e,Ce.PictureSingle.Space):t+=Px(e,n),t+=(0,Tm.repeat)(qn(e,Ce.PictureSingle.Question),r),t+=qn(e,Ce.PictureSingle.Slash),t+=(0,Tm.repeat)(qn(e,Ce.PictureSingle.Question),r),t}li.buildFractionFormat=SY;var yd;(function(e){e[e.Pos=0]="Pos",e[e.Neg=1]="Neg",e[e.Zero=2]="Zero",e[e.Text=3]="Text"})(yd||(yd={}));function olr(e,r){var t="";return t+=Px(e,"-"),r>0&&(t+=(0,Tm.repeat)(qn(e,Ce.PictureSingle.Question),r)),t}function df(e,r,t,n,a,o,u){u===void 0&&(u=!1);for(var s=e.isCurrencySymbolLead,l=e.currencyFormat,c=e.isCurrencySepBySpace,d=u?yd.Pos:a?yd.Text:yd.Neg,f=qg(e,!0,4,t),m="",v=function(_){_!==yd.Pos&&(m+=qn(e,Ce.PictureSingle.Sep)),_===yd.Neg&&r&&(m+=qn(e,Ce.PictureSingle.ColorStart)+D_e(e,Ce.PictureColor.Red)+qn(e,Ce.PictureSingle.ColorEnd));var E=function(){return _===yd.Zero?olr(e,t):_===yd.Text?qn(e,Ce.PictureSingle.Text):f},N=function(){return _!==yd.Text?ci(e,Ce.PictureSingle.Star,Ce.PictureSingle.Space):""},k=function(){var X="";if(s)switch(l){case ke.CurrencyFormat.Paren:X+=ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.OpenParen);break;case ke.CurrencyFormat.Trail:X+=ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.Minus);break;case ke.CurrencyFormat.Intern:X+=ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.Space);break}else{switch(l){case ke.CurrencyFormat.Trail:X+=ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.Minus);break;case ke.CurrencyFormat.Paren:case ke.CurrencyFormat.Intern:X+=ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.Space);break}l!==ke.CurrencyFormat.Lead&&(X+=N())}return X},q=function(){if(s)switch(l){case ke.CurrencyFormat.Lead:return ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.Minus);case ke.CurrencyFormat.Intern:return ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.Space)}else switch(l){case ke.CurrencyFormat.Lead:return ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.Minus);case ke.CurrencyFormat.Paren:case ke.CurrencyFormat.Intern:return ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.Space)}return""},V=function(){return _===yd.Neg?qn(e,Ce.PictureSingle.OpenParen):""},I=function(){return _===yd.Text&&!s?"":_===yd.Neg?qn(e,Ce.PictureSingle.CloseParen):ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.CloseParen)},M=function(){var X="";if(_!==yd.Neg)switch(l){case ke.CurrencyFormat.Intern:!s&&_!==yd.Text&&(X+=ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.Minus));break;case ke.CurrencyFormat.Lead:case ke.CurrencyFormat.Trail:if(l===ke.CurrencyFormat.Lead&&!a)break;X+=ci(e,Ce.PictureSingle.Underscore,Ce.PictureSingle.Minus);break}else X+=qn(e,Ce.PictureSingle.Minus);return a&&!s&&l===ke.CurrencyFormat.Lead&&(X+=N()),X},B=function(){var X="";return n&&!s&&c&&(X+=qn(e,Ce.PictureSingle.Space)),n&&(X+=o??Ex(e,Ce.PictureSpecial.Currency)),s&&c&&(X+=qn(e,Ce.PictureSingle.Space)),X},U=function(){var X="";return _!==yd.Text&&(s?(n&&(X+=B()),a&&(X+=N())):X+=B()),X};if(a&&(m+=k()),s)switch(l){case ke.CurrencyFormat.Paren:a||(m+=V()),m+=U(),a&&(m+=V()),m+=E(),m+=I();break;case ke.CurrencyFormat.Lead:m+=M(),m+=U(),m+=E();break;case ke.CurrencyFormat.Intern:m+=U(),m+=M(),m+=E();break;case ke.CurrencyFormat.Trail:m+=U(),m+=E(),m+=M();break}else switch(l){case ke.CurrencyFormat.Paren:m+=V(),m+=E(),a&&(m+=I()),m+=U(),a||(m+=I());break;case ke.CurrencyFormat.Lead:m+=M(),m+=E(),m+=U();break;case ke.CurrencyFormat.Intern:m+=E(),m+=M(),m+=U();break;case ke.CurrencyFormat.Trail:m+=E(),m+=U(),m+=M();break}a&&(m+=q())},h=yd.Pos;h<=d;h+=1)v(h);return m}li.buildCurrencyFormat=df;function ci(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return r.map(function(n){return typeof n=="string"?n:qn(e,n)}).join("")}li.buildSingle=ci;var xl;(function(e){e[e.Day=0]="Day",e[e.Month=1]="Month",e[e.Year=2]="Year"})(xl||(xl={}));var ulr=(Jb={},Jb[ke.DateOrder.MDY]=[xl.Month,xl.Day,xl.Year],Jb[ke.DateOrder.DMY]=[xl.Day,xl.Month,xl.Year],Jb[ke.DateOrder.YMD]=[xl.Year,xl.Month,xl.Day],Jb[ke.DateOrder.MYD]=[xl.Month,xl.Year,xl.Day],Jb[ke.DateOrder.DYM]=[xl.Day,xl.Year,xl.Month],Jb[ke.DateOrder.YDM]=[xl.Year,xl.Day,xl.Month],Jb);function LB(e,r){var t=r?e.hour2Digits&&!e.clock24Hour:e.hour2Digits;return ci(e,t?Ce.PictureSingle.Hour:"",Ce.PictureSingle.Hour,Ce.PictureSingle.Colon,Ce.PictureSingle.Minute,Ce.PictureSingle.Minute)}function M_e(e,r){return LB(e,r)+ci(e,Ce.PictureSingle.Colon,Ce.PictureSingle.Second,Ce.PictureSingle.Second)}function x_e(e){var r="";return e.isAMPMSepBySpace&&(r+=qn(e,Ce.PictureSingle.Space)),r+=Ex(e,Ce.PictureSpecial.AP1),r}function bY(e,r,t,n,a){a===void 0&&(a=e.year4Digits);for(var o=e.month2Digits,u=e.day2Digits,s=[(0,Tm.repeat)(r,u?2:1),(0,Tm.repeat)(t,o?2:1),(0,Tm.repeat)(n,a?4:2)],l=ulr[e.dateOrder],c="",d=0;d<3;d+=1)c+=s[l[d]],d<2&&(c+=qn(e,Ce.PictureSingle.DateSep));return c}function yY(e,r){var t=qn(e,Ce.PictureSingle.Year),n=qn(e,Ce.PictureSingle.Month),a=qn(e,Ce.PictureSingle.Day);return bY(e,a,n,t,r)}li.buildMMDDYYFormat=yY;function qB(e,r,t,n,a,o){n===void 0&&(n=Ce.PictureSingle.Day),a===void 0&&(a=Ce.PictureSingle.Month),o===void 0&&(o=Ce.PictureSingle.Year);var u=e.day2Digits,s=e.country===Ce.Country.GER,l=e.dateSeparator==="/"&&e.dateAltSeparator!==" ",c="";return r&&(c+=ci(e,u?n:"",n),l?c+=e.dateAltSeparator:(c+=qn(e,Ce.PictureSingle.DateSep),s&&(c+=qn(e,Ce.PictureSingle.Space)))),c+=ci(e,a,a,a),t&&(l?c+=e.dateAltSeparator:s?c+=qn(e,Ce.PictureSingle.Space):c+=qn(e,Ce.PictureSingle.DateSep),c+=ci(e,o,o)),c}function _Y(e){var r=e.hour2Digits;return ci(e,r?Ce.PictureSingle.HourTh:"",Ce.PictureSingle.HourTh,Ce.PictureSingle.Colon,Ce.PictureSingle.MinuteTh,Ce.PictureSingle.MinuteTh)}function slr(e){return _Y(e)+ci(e,Ce.PictureSingle.Colon,Ce.PictureSingle.SecondTh,Ce.PictureSingle.SecondTh)}function I_e(e){return bY(e,qn(e,Ce.PictureSingle.DayTh),qn(e,Ce.PictureSingle.MonthTh),qn(e,Ce.PictureSingle.YearTh))}function vY(e,r,t){return qB(e,r,t,Ce.PictureSingle.DayTh,Ce.PictureSingle.MonthTh,Ce.PictureSingle.YearTh)}function llr(e,r,t,n,a,o,u,s){var l=w_e.pictureNumberShape.indexOf(t)<<24|clr(t),c=u;(n||a)&&(c=2);var d=14;if(c=(0,ilr.fastMin)(c,d),n){var f=ci(e,Ce.PictureSingle.ColorStart,"$"+e.currencySymbol+"-"+l.toString(16).toUpperCase(),Ce.PictureSingle.ColorEnd);return df(Zb.__assign(Zb.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:ke.CurrencyFormat.Paren}),!0,2,!0,!1,f).replace(f,function(){return f+qn(e,Ce.PictureSingle.Space)})}var m=ci(e,Ce.PictureSingle.ColorStart,"$-"+l.toString(16).toUpperCase(),Ce.PictureSingle.ColorEnd);if(a)return m+cF(Zb.__assign(Zb.__assign({},e),{isPercentSepBySpace:!1}),2);if(o)return m+qg(e,!0,4,c);var v=11,h=r.formatGeneral(e,s,v),y=h.indexOf("E");if(y>=0){var _=h.substring(0,y),E=_.indexOf(e.decimalSeparator)>=0,N=_.replace(e.decimalSeparator,"").length,k=h.substring(y+2).length;return m+ci(e,"0",!(c>0)||E?Ce.PictureSingle.Decimal:"",(0,Tm.repeat)(qn(e,Ce.PictureSingle.Hash),N-1),Ce.PictureSingle.E,c>0?"-":"+",(0,Tm.repeat)("0",k))}return m+ci(e,"0",c>0?Ce.PictureSingle.Decimal:"",(0,Tm.repeat)(qn(e,Ce.PictureSingle.Hash),c))}li.buildNumShapeConstFormat=llr;function clr(e){switch(e){case Pi.NumberShape.ArabicIndic:case Pi.NumberShape.ExtendedArabicIndic:return DB.LCID.Arabic;case Pi.NumberShape.Devanagari:return DB.LCID.Hindi;case Pi.NumberShape.Bengali:return 1093;case Pi.NumberShape.Gurmukhi:return 1094;case Pi.NumberShape.Gujarati:return 1095;case Pi.NumberShape.Oriya:return 1096;case Pi.NumberShape.Tamil:return DB.LCID.Tamil;case Pi.NumberShape.Telugu:return 1098;case Pi.NumberShape.Kannada:return 1099;case Pi.NumberShape.Malayalam:return 1100;case Pi.NumberShape.Thai:return DB.LCID.Thailand;case Pi.NumberShape.Lao:return 1108;case Pi.NumberShape.Tibetan:return 1105;case Pi.NumberShape.Myanmar:return 1109;case Pi.NumberShape.Ethiopic:return 1118;case Pi.NumberShape.Khmer:return 1107;case Pi.NumberShape.Mongolian:return 1104;case Pi.NumberShape.ASCII:case Pi.NumberShape.ChineseTrad1:case Pi.NumberShape.ChineseTrad2:case Pi.NumberShape.ChineseTrad3:case Pi.NumberShape.ChineseSimp1:case Pi.NumberShape.ChineseSimp2:case Pi.NumberShape.ChineseSimp3:case Pi.NumberShape.Japanese1:case Pi.NumberShape.Japanese2:case Pi.NumberShape.Japanese3:case Pi.NumberShape.Korean1:case Pi.NumberShape.Korean2:case Pi.NumberShape.Korean3:case Pi.NumberShape.Korean4:return 0;default:return(0,dF.assertNever)("calc.numfmt.lcidFromNumShape",e)}}function dlr(e,r,t){var n=ci(e,Ce.PictureSingle.ColorStart,"$-"+(w_e.pictureNumberShape.indexOf(r)<<24).toString(16).toUpperCase(),Ce.PictureSingle.ColorEnd);return n+L_e(e,t)}li.buildNumShapeDateTimeFormat=dlr;function L_e(e,r){switch(r){case ke.KnownFormat.General:return Ex(e,Ce.PictureSpecial.General);case ke.KnownFormat.NoComFixed0:return qg(e,!1,1,0);case ke.KnownFormat.NoComFixed:return qg(e,!1,1,2);case ke.KnownFormat.Fixed0:return qg(e,!0,4,0);case ke.KnownFormat.Fixed:return qg(e,!0,4,2);case ke.KnownFormat.Currency:return df(e,!1,0,!0,!1);case ke.KnownFormat.CoCurrency:return df(e,!0,0,!0,!1);case ke.KnownFormat.CurrencyDec:return df(e,!1,2,!0,!1);case ke.KnownFormat.CoCurrencyDec:return df(e,!0,2,!0,!1);case ke.KnownFormat.Pct0:return cF(e,0);case ke.KnownFormat.Pct:return cF(e,2);case ke.KnownFormat.Exp:return hY(e,1,2,2);case ke.KnownFormat.Fract:return SY(e,1);case ke.KnownFormat.FractBond:return SY(e,2);case ke.KnownFormat.MMDDYY:return yY(e);case ke.KnownFormat.DDMMMYY:return qB(e,!0,!0);case ke.KnownFormat.DDMMM:return qB(e,!0,!1);case ke.KnownFormat.MMMYY:return qB(e,!1,!0);case ke.KnownFormat.HHMMAP:return LB(e,!0)+x_e(e);case ke.KnownFormat.HHMMSSAP:return M_e(e,!0)+x_e(e);case ke.KnownFormat.HHMM:return LB(e,!1);case ke.KnownFormat.HHMMSS:return M_e(e,!1);case ke.KnownFormat.MDYHMS:return ci(e,yY(e),Ce.PictureSingle.Space,LB(e,!1));case ke.KnownFormat.USCoCurrency:case ke.KnownFormat.USCoCurrencyDec:return df(Zb.__assign(Zb.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:ke.CurrencyFormat.Paren}),!0,r===ke.KnownFormat.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?Px(e,"US$"):"$");case ke.KnownFormat.Currency2:return df(e,!1,0,!1,!1);case ke.KnownFormat.CoCurrency2:return df(e,!0,0,!1,!1);case ke.KnownFormat.CurrencyDec2:return df(e,!1,2,!1,!1);case ke.KnownFormat.CoCurrencyDec2:return df(e,!0,2,!1,!1);case ke.KnownFormat.Acct:return df(e,!1,0,!1,!0);case ke.KnownFormat.AcctDec:return df(e,!1,2,!1,!0);case ke.KnownFormat.AcctCur:return df(e,!1,0,!0,!0);case ke.KnownFormat.AcctDecCur:return df(e,!1,2,!0,!0);case ke.KnownFormat.MMSS:return ci(e,Ce.PictureSingle.Minute,Ce.PictureSingle.Minute,Ce.PictureSingle.Colon,Ce.PictureSingle.Second,Ce.PictureSingle.Second);case ke.KnownFormat.AbsHMMSS:return ci(e,Ce.PictureSingle.ColorStart,Ce.PictureSingle.Hour,Ce.PictureSingle.ColorEnd,Ce.PictureSingle.Colon,Ce.PictureSingle.Minute,Ce.PictureSingle.Minute,Ce.PictureSingle.Colon,Ce.PictureSingle.Second,Ce.PictureSingle.Second);case ke.KnownFormat.SS0:return ci(e,Ce.PictureSingle.Minute,Ce.PictureSingle.Minute,Ce.PictureSingle.Colon,Ce.PictureSingle.Second,Ce.PictureSingle.Second,Ce.PictureSingle.Decimal,"0");case ke.KnownFormat.Eng:return hY(e,3,1,1);case ke.KnownFormat.Text:return qn(e,Ce.PictureSingle.Text);case ke.KnownFormat.NoComFixed0_Tha:return"t"+qg(e,!1,1,0);case ke.KnownFormat.NoComFixed_Tha:return"t"+qg(e,!1,1,2);case ke.KnownFormat.Fixed0_Tha:return"t"+qg(e,!0,4,0);case ke.KnownFormat.Fixed_Tha:return"t"+qg(e,!0,4,2);case ke.KnownFormat.CoCurrency_Tha:case ke.KnownFormat.CoCurrencyDec_Tha:return df(Zb.__assign(Zb.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:ke.CurrencyFormat.Paren}),!0,r===ke.KnownFormat.CoCurrencyDec_Tha?2:0,!0,!1,"t"+Ex(e,Ce.PictureSpecial.Currency));case ke.KnownFormat.Pct0_Tha:return"t"+cF(e,0);case ke.KnownFormat.Pct_Tha:return"t"+cF(e,2);case ke.KnownFormat.MMDDYY_Tha:return I_e(e);case ke.KnownFormat.DDMMMYY_Tha:return vY(e,!0,!0);case ke.KnownFormat.DDMMM_Tha:return vY(e,!0,!1);case ke.KnownFormat.MMMYY_Tha:return vY(e,!1,!0);case ke.KnownFormat.HHMM_Tha:return _Y(e);case ke.KnownFormat.HHMMSS_Tha:return slr(e);case ke.KnownFormat.MDYHMS_Tha:return ci(e,I_e(e),Ce.PictureSingle.Space,_Y(e));case ke.KnownFormat.AbsHMMSS_Tha:return ci(e,Ce.PictureSingle.ColorStart,Ce.PictureSingle.HourTh,Ce.PictureSingle.ColorEnd,Ce.PictureSingle.Colon,Ce.PictureSingle.MinuteTh,Ce.PictureSingle.MinuteTh,Ce.PictureSingle.Colon,Ce.PictureSingle.SecondTh,Ce.PictureSingle.SecondTh);case ke.KnownFormat.MMSS_Tha:return ci(e,Ce.PictureSingle.MinuteTh,Ce.PictureSingle.MinuteTh,Ce.PictureSingle.Colon,Ce.PictureSingle.SecondTh,Ce.PictureSingle.SecondTh);case ke.KnownFormat.SS0_Tha:return ci(e,Ce.PictureSingle.MinuteTh,Ce.PictureSingle.MinuteTh,Ce.PictureSingle.Colon,Ce.PictureSingle.SecondTh,Ce.PictureSingle.SecondTh,Ce.PictureSingle.Decimal,"0");case ke.KnownFormat.DMBB_Tha:return bY(e,qn(e,Ce.PictureSingle.Day),qn(e,Ce.PictureSingle.Month),qn(e,Ce.PictureSingle.EngYearTh),!1);default:return(0,dF.assertNever)("calc.numfmt.getKnownFormat",r)}}li.getKnownFormat=L_e;function flr(e,r){return e<=ke.KnownFormat.General&&e>=ke.KnownFormat.AcctDec?!0:e<=-1e3&&e>=-1099?r.isEastAsia:e<=-1100&&e>=-1199?r.isJapan:e<=-1200&&e>=-1299?r.isKorea:e<=-1300&&e>=-1399?r.isChinaT:e<=-1400&&e>=-1499?r.isChinaS:e<=-2e3&&e>=-2099?r.isThai:(0,dF.assertFalse)("calc.numfmt.isKnownFormatDefined")}li.isKnownFormatDefined=flr;li.englishXLSXKnownFormat={0:ke.KnownFormat.General,1:ke.KnownFormat.NoComFixed0,2:ke.KnownFormat.NoComFixed,3:ke.KnownFormat.Fixed0,4:ke.KnownFormat.Fixed,5:ke.KnownFormat.Currency,6:ke.KnownFormat.CoCurrency,7:ke.KnownFormat.CurrencyDec,8:ke.KnownFormat.CoCurrencyDec,9:ke.KnownFormat.Pct0,10:ke.KnownFormat.Pct,11:ke.KnownFormat.Exp,12:ke.KnownFormat.Fract,13:ke.KnownFormat.FractBond,14:ke.KnownFormat.MMDDYY,15:ke.KnownFormat.DDMMMYY,16:ke.KnownFormat.DDMMM,17:ke.KnownFormat.MMMYY,18:ke.KnownFormat.HHMMAP,19:ke.KnownFormat.HHMMSSAP,20:ke.KnownFormat.HHMM,21:ke.KnownFormat.HHMMSS,22:ke.KnownFormat.MDYHMS,37:ke.KnownFormat.Currency2,38:ke.KnownFormat.CoCurrency2,39:ke.KnownFormat.CurrencyDec2,40:ke.KnownFormat.CoCurrencyDec2,41:ke.KnownFormat.Acct,42:ke.KnownFormat.AcctCur,43:ke.KnownFormat.AcctDec,44:ke.KnownFormat.AcctDecCur,45:ke.KnownFormat.MMSS,46:ke.KnownFormat.AbsHMMSS,47:ke.KnownFormat.SS0,48:ke.KnownFormat.Eng,49:ke.KnownFormat.Text}});var BB=T(GB=>{"use strict";p();Object.defineProperty(GB,"__esModule",{value:!0});GB.parseConstInternal=void 0;var $T=fe(),plr=TB(),qs=Ch(),fF=ZT(),$b=$T.__importStar(fx()),eR=bh(),mlr=$b.codePointDollarSign,glr=$b.codePointBackslash,q_e=$b.codePointPercentSign,G_e=$b.codePointSpace,B_e=$b.codePointLeftParen,vlr=$b.codePointMinusSign,U_e=$b.codePointPlusSign,hlr=$b.codePointRightParen,V0;(function(e){e[e.Default=0]="Default",e[e.DollarUS=1]="DollarUS",e[e.DollarExtra=2]="DollarExtra"})(V0||(V0={}));var Eh;(function(e){e[e.None=0]="None",e[e.Lead=1]="Lead",e[e.Trail=2]="Trail"})(Eh||(Eh={}));function K_e(e,r,t,n){if(!(r===" "||r==="")){var a=r==="$";if(e.isEastAsia){if(n<t.length&&t.charCodeAt(n)===mlr&&!a)return{currency:V0.DollarUS,i:n+1};if(n+2<t.length&&e.stringCompareCI(t.substring(n,n+3),"US$")===0)return{currency:e.isChinaT?V0.DollarUS:V0.DollarExtra,i:n+3};if((r==="\xA5"&&e.isJapan||r==="\u20A9"&&e.isKorea)&&n<t.length&&t.charCodeAt(n)===glr)return{currency:V0.Default,i:n+1};if(e.isChinaT&&n+2<t.length&&e.stringCompareCI(t.substring(n,n+3),"NT$")===0)return{currency:V0.DollarExtra,i:n+3}}if(n+r.length<=t.length&&e.stringCompareCI(t.substring(n,n+r.length),r)===0)return{currency:V0.Default,i:n+r.length}}}function V_e(e,r,t,n,a,o){var u,s=0,l=!1,c=!1,d=!1,f=e.isCurrencySymbolLead,m=e.currencySymbol;a!==Eh.None&&(f=a===Eh.Lead,m="\u20AC");for(var v=0;v<t.length;){if(u===void 0&&f){var h=K_e(e,m,t,v);if(h!==void 0){u=h.currency,v=h.i;continue}}var y=t.charCodeAt(v);switch(y){case q_e:v+=1,s+=1;continue;case G_e:v+=1;continue;case B_e:case vlr:case U_e:if(v+=1,c)return(0,eR.success)(void 0);c=!0,y===B_e&&(l=!0),d=y!==U_e;continue}break}var _=(0,plr.parseNumberLiteral)(e,r,t,v,!0,s>0||n,o);if(_===void 0||_.value===void 0)return(0,eR.success)(void 0);v=_.i;for(var E=d?r.neg(_.value):_.value;v<t.length;){if(u===void 0&&!f){var h=K_e(e,m,t,v);if(h!==void 0){u=h.currency,v=h.i;continue}}var y=t.charCodeAt(v);switch(y){case q_e:v+=1,s+=1;continue;case G_e:v+=1;continue;case hlr:if(v+=1,!l)return(0,eR.success)(void 0);l=!1;continue}break}if(v!==t.length||l||s>1||u!==void 0&&s>0)return(0,eR.success)(void 0);var N=_.numDigDec;_.consumedDecimal&&N<e.numberDecimals&&(_.consumedThousands||s>0?N=e.numberDecimals:u!==void 0&&(N=e.currencyDecimals));var k;if(_.format!==void 0)k=_.format;else if(u===V0.DollarUS)k=_.consumedDecimal?qs.KnownFormat.USCoCurrencyDec:qs.KnownFormat.USCoCurrency;else if(u===V0.DollarExtra)k=(0,fF.buildCurrencyFormat)($T.__assign($T.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:qs.CurrencyFormat.Paren}),!1,_.consumedDecimal?2:0,!0,!1,e.isChinaT?(0,fF.buildQuoted)(e,"NT$"):(0,fF.buildQuoted)(e,"US$"));else if(_.numShape===qs.NumberShape.Thai&&e.isThai)u!==void 0?k=_.consumedDecimal?qs.KnownFormat.CoCurrencyDec_Tha:qs.KnownFormat.CoCurrency_Tha:s>0?k=_.consumedDecimal?qs.KnownFormat.Pct_Tha:qs.KnownFormat.Pct0_Tha:_.consumedThousands?k=_.consumedDecimal?qs.KnownFormat.Fixed_Tha:qs.KnownFormat.Fixed0_Tha:k=_.consumedDecimal?qs.KnownFormat.NoComFixed_Tha:qs.KnownFormat.NoComFixed0_Tha;else if(_.numShape!==qs.NumberShape.ASCII)k=(0,fF.buildNumShapeConstFormat)(e,r,_.numShape,u!==void 0,s>0,_.consumedThousands,N,E);else if(u!==void 0)switch(a){case Eh.None:k=_.consumedDecimal?qs.KnownFormat.CoCurrencyDec:qs.KnownFormat.CoCurrency;break;case Eh.Lead:k=(0,fF.buildCurrencyFormat)($T.__assign($T.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!0,currencyFormat:qs.CurrencyFormat.Lead}),!0,_.consumedDecimal?2:0,!0,!1,"[$\u20AC-x-euro2]");break;case Eh.Trail:k=(0,fF.buildCurrencyFormat)($T.__assign($T.__assign({},e),{isCurrencySymbolLead:!1,isCurrencySepBySpace:!0,currencyFormat:qs.CurrencyFormat.Lead}),!0,_.consumedDecimal?2:0,!0,!1,"[$\u20AC-x-euro1]");break}else s>0?k=_.consumedDecimal?qs.KnownFormat.Pct:qs.KnownFormat.Pct0:_.consumedThousands?k=_.consumedDecimal?qs.KnownFormat.Fixed:qs.KnownFormat.Fixed0:k=qs.KnownFormat.General;return(0,eR.success)({value:E,format:k})}function Slr(e,r,t,n,a,o){if(!a)return V_e(e,r,t,n,Eh.None,o);for(var u=Eh.None;u<=Eh.Trail;u+=1){var s=V_e(e,r,t,n,u,o);if(!(0,eR.isSuccess)(s)||s.value!==void 0)return s;if(u===Eh.None&&t.indexOf("\u20AC")<0)break}return(0,eR.success)(void 0)}GB.parseConstInternal=Slr});var QB=T(mF=>{"use strict";p();var Ax;Object.defineProperty(mF,"__esModule",{value:!0});mF.parseDateInternal=mF.initParseDateGlobals=void 0;var z_e=fe(),Ph=HT(),VB=G0(),ylr=jT(),Kc=Iy(),nR=RB(),zB=z_e.__importStar(fx()),j_e=TB(),ic=U0(),ba=Ch(),Dy=$X(),pF=aF(),Zr=bh(),_lr=ZT(),blr=zB.codePointSlash,jB=zB.codePointSpace,TY=zB.codePointMinusSign,Clr=zB.codePointColon,Tlr={getTime:function(){return(0,ic.assertFalse)("calc.numfmt.parseDateInternal: default getTime")}};function Rlr(e){var r,t;return{config:e.config,getTime:(t=(r=e.getTime)===null||r===void 0?void 0:r.bind(e))!==null&&t!==void 0?t:Tlr.getTime}}mF.initParseDateGlobals=Rlr;var Tu;(function(e){e[e.Month=0]="Month",e[e.AMPM=1]="AMPM",e[e.Number=2]="Number"})(Tu||(Tu={}));function tR(e,r){return(0,ic.assertTrue)("calc.numfmt.monthToken",Gg(e,1,12)),{kind:Tu.Month,value:e,bidiDate:r}}var Elr=z_e.__spreadArray([],new Array(12),!0).map(function(e,r){return tR(r+1)}),UB=function(r){return Elr[r]},W_e=function(r){return tR(r+1,VB.BidiDate.English)},Plr=function(r){return tR(r+1,VB.BidiDate.Lunar)},Q_e=[!0,!1].map(function(e){return{kind:Tu.AMPM,am:e}}),Alr=Q_e[0],Flr=Q_e[1],CY=function(r){return r===0?Alr:Flr};function X_e(e,r,t){return(0,ic.assertTrue)("calc.numfmt.numberToken",(0,pF.isInteger)(e)&&Gg(e,-9999,9999)&&Gg(r,1,4)),{kind:Tu.Number,value:e,digits:r,numShape:t}}var di;(function(e){e[e.Nil=0]="Nil",e[e.Space=1]="Space",e[e.Date=2]="Date",e[e.Time=3]="Time",e[e.TimeAlt=4]="TimeAlt",e[e.FracSec=5]="FracSec",e[e.Intl1St3=6]="Intl1St3"})(di||(di={}));var KB=function(r){return r===di.Time||r===di.TimeAlt},Y_e=function(r,t){return r.lcid===Ph.LCID.Hungarian&&t===di.Date},WB=function(r){return r<=di.Space},H_e=function(r){return r<=di.Date},Nlr=["\u4E0A\u5348","\u4E0B\u5348"],Olr=(Ax={},Ax[Ph.Country.FRN]=[["Jun",tR(6)],["Jul",tR(7)]],Ax[Ph.Country.DUT]=[["Mrt",tR(3)]],Ax[Ph.Country.GER]=[["Mrz",tR(3)]],Ax),klr=["\u0645\u062D\u0631\u0645","\u0635\u0641\u0631","\u0631\u0628\u064A\u0639 \u0627\u0644\u0627\u0648\u0644","\u0631\u0628\u064A\u0639 \u0627\u0644\u062B\u0627\u0646\u064A","\u062C\u0645\u0627\u062F\u0649 \u0627\u0644\u0627\u0648\u0644\u0649","\u062C\u0645\u0627\u062F\u0649 \u0627\u0644\u062B\u0627\u0646\u064A\u0629","\u0631\u062C\u0628","\u0634\u0639\u0628\u0627\u0646","\u0631\u0645\u0636\u0627\u0646","\u0634\u0648\u0627\u0644","\u0630\u0648 \u0627\u0644\u0642\u0639\u062F\u0629","\u0630\u0648 \u0627\u0644\u062D\u062C\u0629"];function Gg(e,r,t){return e>=r&&e<=t}function Mlr(e,r){for(var t=0,n=(0,nR.codePointIterator)(r);t<n.length;t++){var a=n[t];if(e.isNumeral(a))return!0}return!1}function xlr(e,r){for(var t=ba.NumberShape.ASCII,n=0,a=(0,nR.codePointIterator)(r);n<a.length;n++){var o=a[n],u=e.getNumberShape(o);u!==ba.NumberShape.ASCII&&(t=u)}return t}function Ilr(e){var r=1930,t=30;return 1900+(e<t?100:0)+e}function J_e(e,r){var t=e.getTime(Dy.TimeGranularity.Year,r);if(!(0,Zr.isSuccess)(t))return t;var n=e.config,a=n.datepack.fromNum(n,t.value,Dy.Rounding.RoundSec);return(0,ic.assertTrue)("calc.numfmt.parseDateInternal: current year fromNum",a!==!1),(0,Zr.success)(a.yr)}function HB(e,r,t,n){return n+r.length<=t.length&&e.stringCompareCI(r,t.substring(n,n+r.length))===0}function Fx(e,r,t,n,a,o){for(var u=r.indexOf(" ",t),s=0;s<n.length;s+=1){var l=n[s],c=(0,ylr.fastMin)(a,l.length);if(u>=0&&l.indexOf(" ")<0&&u-t>=c&&u-t<=l.length){var d=l.substring(0,u-t);if(HB(e,d,r,t))return[o(s),t+d.length]}for(var f=void 0,m=c;m<=l.length;m+=1){var d=l.substring(0,m);if(!HB(e,d,r,t))break;f=t+d.length}if(f!==void 0)return[o(s),f]}}function Nx(e,r,t,n,a){for(var o=0;o<n.length;o+=1){var u=n[o];if(HB(e,u,r,t))return[a(o),t+u.length]}}function wlr(e,r,t){var n=Olr[e.country];if(n!==void 0)for(var a=0,o=n;a<o.length;a++){var u=o[a],s=u[0],l=u[1];if(HB(e,s,r,t))return[l,t+s.length]}var c;if(e.isEastAsia){if(c=Fx(e,r,t,(0,Ph.getEnglishLocaleInfo)().monthNameLong,3,UB),c!==void 0)return c}else if(e.isComplexScript){if(c=Nx(e,r,t,e.monthNameLong,UB),c!==void 0||(c=Nx(e,r,t,e.monthNameShort,UB),c!==void 0)||(c=Nx(e,r,t,(0,Ph.getEnglishLocaleInfo)().monthNameLong,W_e),c!==void 0)||(c=Nx(e,r,t,(0,Ph.getEnglishLocaleInfo)().monthNameShort,W_e),c!==void 0))return c}else if(c=Fx(e,r,t,e.monthNameLong,3,UB),c!==void 0)return c;return(e.lcid&Ph.LCID.LANG)===(Ph.LCID.Arabic&Ph.LCID.LANG)&&(c=Nx(e,r,t,klr,Plr),c!==void 0)||(c=Fx(e,r,t,e.ampmSymbols,1,CY),c!==void 0)||(c=Fx(e,r,t,(0,Ph.getEnglishLocaleInfo)().ampmSymbols,1,CY),c!==void 0)||(e.isChinaS||e.isChinaT)&&(c=Fx(e,r,t,Nlr,1,CY),c!==void 0)?c:[void 0,t]}function Dlr(e,r,t,n){var a,o,u=t,s=r.charCodeAt(u)===TY;s&&(u+=1);var l,c,d;if(n===di.FracSec){if(a=(0,j_e.parseUint)(e,4,u+4<r.length?r.substring(0,u+4):r,u),l=a[0],c=a[1],d=c-u,(0,ic.assertTrue)("calc.numfmt.parseDateInternal: 0 < digits <= 4",Gg(d,1,4)),d===4){for(var f=void 0;c<r.length&&e.isNumeral(f=(0,nR.stringCodePointAt)(r,c));)c+=(0,nR.numCodeUnits)(f);l=Math.round(l/10),d=3}}else if(o=(0,j_e.parseUint)(e,4,r,u),l=o[0],c=o[1],d=c-u,d>4||d>2&&l<100)return[void 0,t];if(d===0)return[void 0,t];var m=xlr(e,r.substring(u,c));return u=c,[X_e(s?-l:l,d,m),u]}function Llr(e,r,t,n){var a=di.Nil,o=t;if(r.charCodeAt(o)===jB)for(a=di.Space;r.charCodeAt(o)===jB;)o+=1;return e.timeAltSeparator!=null&&e.timeAltSeparator!==e.timeSeparator&&n===di.Time&&(0,pF.stringStartsWith)(r,e.timeAltSeparator,o)?(a=di.TimeAlt,o+=e.timeAltSeparator.length):(0,pF.stringStartsWith)(r,e.dateSeparator,o)?(a=di.Date,o+=e.dateSeparator.length):(0,pF.stringStartsWith)(r,e.timeSeparator,o)?(a=di.Time,o+=e.timeSeparator.length):(0,pF.stringStartsWith)(r,e.decimalSeparator,o)&&n===di.Time?(a=di.FracSec,o+=e.decimalSeparator.length):r.charCodeAt(o)===blr||r.charCodeAt(o)===TY?(a=di.Date,o+=1):r.charCodeAt(o)===Clr?(a=di.Time,o+=1):(0,pF.stringStartsWith)(r,", ",o)&&(a=di.Intl1St3,o+=2),a===di.Space&&(e.dateSeparator===" "?a=di.Date:e.timeSeparator===" "?a=di.Time:e.decimalSeparator===" "&&n===di.Time&&(a=di.FracSec)),[a,o]}function qlr(e,r,t){for(var n=e.localeInfo,a=e.dateCompatibility,o=9,u=[],s=t==null?void 0:t.bidiDate,l=ba.NumberShape.ASCII,c=t==null?void 0:t.culture,d,f=!1,m=!1,v=0;v<r.length;){if(u.length>=o)return(0,Zr.success)(void 0);var h=void 0;if(n.isNumeral((0,nR.stringCodePointAt)(r,v))||!a&&v+1<r.length&&r.charCodeAt(v)===TY&&n.isNumeral((0,nR.stringCodePointAt)(r,v+1))){var y=Dlr(n,r,v,d),_=y[0],E=y[1];if(_===void 0)return(0,Zr.success)(void 0);v=E,_.numShape!==ba.NumberShape.ASCII&&(l=_.numShape),h=_}else{if(r.charCodeAt(v)===jB)return(0,Zr.failure)((0,Kc.notImplemented)(["absurd date/time string with leading space"]));var N=wlr(n,r,v),k=N[0],q=N[1];if(k===void 0)return(0,Zr.success)(void 0);if(v=q,k.kind===Tu.Month){if(f)return(0,Zr.success)(void 0);f=!0,k.bidiDate!==void 0&&(s=k.bidiDate)}if(k.kind===Tu.AMPM){if(m||(m=!0,u.length===0||u[u.length-1].sep!==di.Space))return(0,Zr.success)(void 0);d=u[u.length-1].sep=di.Time}h=k}var V=Llr(n,r,v,d),I=V[0],M=V[1];for(v=M;v<r.length&&r.charCodeAt(v)===jB;)v+=1;u.push({tok:h,sep:I}),d=I}return(0,ic.assertTrue)("calc.numfmt.parseDateInternal: > 0 tokens",u.length!==0),(0,Zr.success)({tokens:u,bidiDate:s,numShape:l,culture:c})}function Glr(e,r){for(var t=e.localeInfo,n,a,o=0;o<r.length;o+=1)if(KB(r[o].sep)){n={start:o,end:o+1};break}var u,s,l,c,d;if(n!==void 0){if(n.start!==0&&!(r[n.start-1].sep===di.Space||Y_e(t,r[n.start-1].sep)))return(0,Zr.success)(void 0);for(;n.end<r.length&&KB(r[n.end-1].sep);)n.end+=1;if(n.end<r.length&&r[n.end-1].sep===di.FracSec){n.end+=1;var f=r[n.end-1];if(f.tok.kind!==Tu.Number)return(0,Zr.success)(void 0);var m=f.tok;if(c=f,n.end<r.length&&KB(r[n.end-1].sep)){n.end+=1;var v=r[n.end-1];if(v.tok.kind!==Tu.AMPM)return(0,Zr.failure)((0,Kc.notImplemented)(["non-AM/PM after FracSec"]));var h=v.tok;d=v}}else{var v=r[n.end-1];if(v.tok.kind===Tu.AMPM){var h=v.tok;d=v}}for(var y=n.end-n.start-(c!==void 0?1:0)-(d!==void 0?1:0),o=0;o<y;o+=1)if(r[n.start+o].tok.kind!==Tu.Number)return(0,Zr.failure)((0,Kc.notImplemented)(["non-number in H/M/S component"]));switch(y){case 0:return(0,ic.assertFalse)("calc.numfmt.parseDateInternal: 0 time");case 1:(0,ic.assertTrue)("calc.numfmt.parseDateInternal: 1 time => !fracSec",c===void 0),u=r[n.start];break;case 2:c===void 0?(u=r[n.start],s=r[n.start+1]):(s=r[n.start],l=r[n.start+1]);break;case 3:u=r[n.start],s=r[n.start+1],l=r[n.start+2];break;default:return(0,Zr.success)(void 0)}for(var o=n.end;o<r.length;o+=1)if(KB(r[o].sep))return(0,Zr.success)(void 0);if(n.end===r.length){var _=r[n.end-1].sep;if(!(WB(_)||d!==void 0&&_===di.FracSec))return(0,Zr.failure)((0,Kc.notImplemented)(["trailing sep after time"]))}else{var E=r[n.end-1].sep;if(!(WB(E)||E===di.Intl1St3))return(0,Zr.failure)((0,Kc.notImplemented)(["unexpected sep between time and date"]))}if(n.start===0)n.end!==r.length&&(a={start:n.end,end:r.length});else if(n.end===r.length)a={start:0,end:n.start};else return(0,Zr.failure)((0,Kc.notImplemented)(["date part split around time part"]))}else a={start:0,end:r.length};return(0,Zr.success)({time:n,date:a,hour:u,min:s,sec:l,fracSec:c,ampm:d})}function Blr(e,r){for(var t=r.start;t<r.end;t+=1)if(e[t].tok.kind===Tu.Month)return t}function Ulr(e,r,t,n){var a=e.config,o=a.localeInfo,u=a.dateCompatibility,s=a.datepack,l,c,d,f=!1;if(n!==void 0){var m=n.end-n.start;if(m<2||m>3)return(0,Zr.success)(void 0);var v=t[n.start],h=v.tok,y=v.sep,_=t[n.start+1],E=_.tok,N=_.sep,k=t[n.end-1],q=k.tok,V=k.sep;if((0,ic.assertTrue)("calc.numfmt.parseDateInternal: all not AM/PM",h.kind!==Tu.AMPM&&E.kind!==Tu.AMPM&&q.kind!==Tu.AMPM),!WB(V)&&!Y_e(o,V))return(0,Zr.success)(void 0);var I=Blr(t,n)!==void 0;if(f=I,I)if(H_e(y)&&H_e(N))if(h.kind===Tu.Month){if(m>2)return(0,Zr.success)(void 0);c=h,(0,ic.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",q.kind!==Tu.Month),l=q}else if(E.kind===Tu.Month)d=h,c=E,m===3&&((0,ic.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",q.kind!==Tu.Month),l=q);else return(0,Zr.success)(void 0);else{if(m!==3||WB(N))return(0,Zr.success)(void 0);var B=o.longDateFormat?h:E,U=o.longDateFormat?E:h;if(B.kind!==Tu.Month)return(0,Zr.success)(void 0);(0,ic.assertTrue)("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",U.kind!==Tu.Month&&q.kind!==Tu.Month),d=U,c=B,l=q}else if((0,ic.assertTrue)("calc.numfmt.parseDateInternal: all not Month",h.kind!==Tu.Month&&E.kind!==Tu.Month&&q.kind!==Tu.Month),m===2&&y===di.Date)switch(f=!0,o.dateOrder){case ba.DateOrder.MDY:c=h,l=q;break;case ba.DateOrder.YMD:Gg(h.value,1,12)?(c=h,d=q):(l=h,c=q);break;case ba.DateOrder.DMY:Gg(q.value,1,12)?(d=h,c=q):(c=h,l=q);break;default:return(0,Zr.failure)((0,Kc.notImplemented)(["date parse date order"]))}else{if(m<3||y!==di.Date||N!==di.Date)return(0,Zr.success)(void 0);var M=h.value>999||!u&&h.value>99?ba.DateOrder.YMD:o.dateOrder;switch(M){case ba.DateOrder.MDY:c=h,d=E,l=q;break;case ba.DateOrder.YMD:l=h,c=E,d=q;break;case ba.DateOrder.DMY:d=h,c=E,l=q;break;default:return(0,Zr.failure)((0,Kc.notImplemented)(["date parse date order"]))}}}var j=!1;if(o.dateOrder!==ba.DateOrder.DMY&&d===void 0&&c!==void 0&&Gg(c.value,1,12)&&l!==void 0&&Gg(l.value,1,31)){var X=J_e(e,r);if(!(0,Zr.isSuccess)(X))return X;l.value<=s.daysPerMonth(c.value,X.value,u)&&(d=l,l=X_e(X.value,4,ba.NumberShape.ASCII),j=!0)}return(0,Zr.success)({yr:l,mon:c,dom:d,useMonthName:f,usingCurrentYear:j})}function Klr(e,r,t,n,a,o,u,s,l,c){var d,f=e.config,m=f.mathpack,v=f.datepack,h=f.dateCompatibility,y,_,E;if(n!==void 0||a!==void 0||t!==void 0){if((0,ic.assertTrue)("calc.numfmt.parseDateInternal: dom || yr",a!==void 0||t!==void 0),(0,ic.assertTrue)("calc.numfmt.parseDateInternal: mon",n!==void 0),_=n.value,!Gg(_,1,12))return(0,Zr.success)(void 0);if(t===void 0){var N=J_e(e,r);if(!(0,Zr.isSuccess)(N))return N;y=N.value}else Gg(t.value,0,99)?y=Ilr(t.value):y=t.value;if(!Gg(y,1900,9999)||(E=(d=a==null?void 0:a.value)!==null&&d!==void 0?d:1,!Gg(E,1,v.daysPerMonth(_,y,h))))return(0,Zr.success)(void 0)}else{var k=v.fromNum(f,m.zero,Dy.Rounding.RoundSec);(0,ic.assertTrue)("calc.numfmt.parseDateInternal: zeroDtr fromNum",k!==!1),y=k.yr,_=k.mon,E=k.dom}var q=0,V=0,I=0,M=0,B=Dy.Rounding.RoundSec,U=0,j,X=!0;if(o!==void 0){if(o.value<0)return(0,Zr.failure)((0,Kc.notImplemented)(["negative hour"]));if(o.value>23){if(j!==void 0)return(0,Zr.success)(void 0);U=o.value,j=Dy.TimeDivision.Hour}else q=o.value}if(u!==void 0){if(u.value<0)return(0,Zr.failure)((0,Kc.notImplemented)(["negative minute"]));if(u.value>59){if(j!==void 0)return(0,Zr.success)(void 0);U=u.value,j=Dy.TimeDivision.Minute}else V=u.value}if(s!==void 0){if(s.value<0)return(0,Zr.failure)((0,Kc.notImplemented)(["negative second"]));if(s.value>59){if(j!==void 0)return(0,Zr.success)(void 0);U=s.value,j=Dy.TimeDivision.Second}else I=s.value}if(l!==void 0){if(l.value<0)return(0,Zr.failure)((0,Kc.notImplemented)(["negative fractional second"]));(0,ic.assertTrue)("calc.numfmt.parseDateInternal: fracSec.digits",l.digits>=1&&l.digits<=3),B=l.digits,(0,ic.assertTrue)("calc.numfmt.parseDateInternal: fracSec.value",l.value<(B===3?1001:B===2?100:10)),M=l.value}if(c!==void 0){if(j!==void 0||q>12)return(0,Zr.success)(void 0);c.am?q===12&&(q=0):q<12&&(q+=12)}var ee=(0,Dy.dateTime)(y,_,E,q,V,I,1,M,B),re=j!==void 0?v.toNumWithDuration(f,ee,j,U):v.toNum(f,ee);return(0,Kc.isErrorOper)(re)?(0,Zr.success)(void 0):(0,Zr.success)({value:re,duration:j})}function rR(e,r,t,n){return r===ba.NumberShape.ASCII?t:(r===ba.NumberShape.Lao||r===ba.NumberShape.Thai)&&e.isThai?n:(0,_lr.buildNumShapeDateTimeFormat)(e,r,t)}function Vlr(e,r,t,n,a,o,u,s,l,c,d,f,m){if(s)return(l==null?void 0:l.sep)===di.TimeAlt?(0,Zr.success)(e.sysTimeFormat):d!==void 0?(0,Zr.success)(rR(e,r,ba.KnownFormat.SS0,ba.KnownFormat.SS0_Tha)):m!==void 0?m===Dy.TimeDivision.Hour&&f===void 0&&!t?(0,Zr.success)(rR(e,r,ba.KnownFormat.AbsHMMSS,ba.KnownFormat.AbsHMMSS_Tha)):(0,Zr.success)(ba.KnownFormat.General):t?(0,Zr.success)(rR(e,r,ba.KnownFormat.MDYHMS,ba.KnownFormat.MDYHMS_Tha)):f!==void 0?(0,Zr.success)(rR(e,r,c!==void 0?ba.KnownFormat.HHMMSSAP:ba.KnownFormat.HHMMAP,c!==void 0?ba.KnownFormat.HHMMSS_Tha:ba.KnownFormat.HHMM_Tha)):(0,Zr.success)(rR(e,r,c!==void 0?ba.KnownFormat.HHMMSS:ba.KnownFormat.HHMM,c!==void 0?ba.KnownFormat.HHMMSS_Tha:ba.KnownFormat.HHMM_Tha));if((0,ic.assertTrue)("calc.numfmt.parseDateInternal: !haveTime => haveDate",t),!o)return(0,Zr.success)(rR(e,r,ba.KnownFormat.MMDDYY,ba.KnownFormat.MMDDYY_Tha));var v=n!==void 0&&!u,h=rR(e,r,a===void 0?ba.KnownFormat.MMMYY:v?ba.KnownFormat.DDMMMYY:ba.KnownFormat.DDMMM,a===void 0?ba.KnownFormat.MMMYY_Tha:v?ba.KnownFormat.DDMMMYY_Tha:ba.KnownFormat.DDMMM_Tha);return e.isEastAsia&&h===ba.KnownFormat.DDMMM&&t?(0,Zr.failure)((0,Kc.notImplemented)(["parseDateInternal ifmt for East Asian DDMMM"])):(0,Zr.success)(h)}function jlr(e,r,t,n){var a=e.config,o=a.localeInfo;if(!o.isEastAsia&&!Mlr(o,r))return(0,Zr.success)(void 0);if(o.isEastAsia)return(0,Zr.failure)((0,Kc.notImplemented)(["parse East Asia date"]));if(o.isThai){var u=r.indexOf("b");if(u<0&&(u=r.indexOf("B")),u>=0&&u+1<r.length&&o.isNumeral((0,nR.stringCodePointAt)(r,u+1)))return(0,Zr.failure)((0,Kc.notImplemented)(["parse Thai Buddhist date"]))}var s=qlr(a,r,t);if(!(0,Zr.isSuccess)(s)||s.value===void 0)return s;var l=s.value,c=l.tokens,d=l.bidiDate,f=l.numShape,m=l.culture;if(d===VB.BidiDate.Lunar)return(0,Zr.failure)((0,Kc.notImplemented)(["Lunar calendar"]));if(m!==void 0&&(m.localCalendarInput||m.tag===VB.CultureTag.Gannen))return(0,Zr.failure)((0,Kc.notImplemented)(["parse date: possible local calendar"]));var v=Glr(a,c);if(!(0,Zr.isSuccess)(v)||v.value===void 0)return v;var h=v.value,y=h.time,_=h.date,E=h.hour,N=h.min,k=h.sec,q=h.fracSec,V=h.ampm,I=Ulr(e,n,c,_);if(!(0,Zr.isSuccess)(I)||I.value===void 0)return I;var M=I.value,B=M.yr,U=M.mon,j=M.dom,X=M.useMonthName,ee=M.usingCurrentYear,re=Klr(e,n,B,U,j,E==null?void 0:E.tok,N==null?void 0:N.tok,k==null?void 0:k.tok,q==null?void 0:q.tok,V==null?void 0:V.tok);if(!(0,Zr.isSuccess)(re)||re.value===void 0)return re;var Z=re.value,J=Z.value,C=Z.duration,S=Vlr(o,f,_!==void 0,B,j,X,ee,y!==void 0,N,k,q,V,C);return(0,Zr.isSuccess)(S)?(0,Zr.success)({value:J,format:S.value}):S}mF.parseDateInternal=jlr});var XB=T(vF=>{"use strict";p();Object.defineProperty(vF,"__esModule",{value:!0});vF.shouldInstallFormat=vF.parseEdit=void 0;var RY=aF(),gF=jX(),Gs=G0(),Wlr=BB(),Z_e=QB(),Rm=bh();function Hlr(e){var r=e.charAt(0);return r==="="||r==="+"||r==="-"||r==="@"}function $_e(e){var r=(0,RY.stringStartsWith)(e,"'"),t=r?e.substring(1):e;return t.length>gF.cellStringLimit?(0,Rm.failure)((0,Gs.notValueString)("cell text too long")):(0,Rm.success)((0,Gs.stringEdit)((0,gF.stringOper)(t),r))}function zlr(e,r){if(e.stringCompareCI(r,e.trueName)===0)return gF.trueOper;if(e.stringCompareCI(r,e.falseName)===0)return gF.falseOper;for(var t=1;t<e.errorNames.length;t+=1){var n=e.errorNames[t];if(n!=null&&e.stringCompareCI(n,r)===0)return(0,gF.errorOper)(t)}}function ebe(e,r,t){return(0,Z_e.parseDateInternal)((0,Z_e.initParseDateGlobals)(e),r,t,Gs.GetTimeKind.ValueCell)}function rbe(e,r,t){var n=e.config,a=n.localeInfo,o=n.mathpack,u=!0,s=a.isEastAsia&&t.valueType===Gs.FormatValueType.Percentage&&u,l=!1;switch(t.valueType){case Gs.FormatValueType.Number:case Gs.FormatValueType.Currency:case Gs.FormatValueType.Percentage:case Gs.FormatValueType.Fraction:case Gs.FormatValueType.Scientific:case Gs.FormatValueType.Accounting:l=!0;break}return(0,Wlr.parseConstInternal)(a,o,r,s,!0,l)}function Qlr(e,r,t){var n=zlr(e.config.localeInfo,r);if(n!==void 0)return(0,Rm.success)((0,Gs.otherEdit)(n));for(var a=t.valueType===Gs.FormatValueType.Date||t.valueType===Gs.FormatValueType.Time?[ebe,rbe]:[rbe,ebe],o=0,u=a;o<u.length;o++){var s=u[o],l=s(e,r,t);if(!(0,Rm.isSuccess)(l))return l;if(l.value!==void 0){var c=l.value,d=c.value,f=c.format;return(0,Rm.success)((0,Gs.numberEdit)(d,f))}}return(0,Rm.success)(void 0)}function Xlr(e,r,t){try{if(t.valueType===Gs.FormatValueType.Text)return $_e(r);if(r==="")return(0,Rm.success)((0,Gs.otherEdit)(gF.blankOper));if(r.length>1&&(0,RY.stringStartsWith)(r,"="))return(0,Rm.success)((0,Gs.formulaEdit)(r));if(!(0,RY.stringStartsWith)(r,"'")){var n=Qlr(e,r,t);if(!(0,Rm.isSuccess)(n))return n;if(n.value!==void 0)return(0,Rm.success)(n.value)}return r.length>1&&Hlr(r)?(0,Rm.success)((0,Gs.formulaEdit)(r)):$_e(r)}catch(a){return(0,Rm.failure)((0,Rm.javaScriptError)(a))}}vF.parseEdit=Xlr;function Ylr(e,r){return(e==null?void 0:e.valueType)!==Gs.FormatValueType.Number&&r.valueType!==Gs.FormatValueType.Number&&(e==null?void 0:e.valueType)!==r.valueType}function Jlr(e,r){return e===r||r.source!==Gs.NumberFormatSource.Builtin?!1:r.valueType===Gs.FormatValueType.General?!0:Ylr(e,r)}vF.shouldInstallFormat=Jlr});var tbe=T(Ne=>{"use strict";p();Object.defineProperty(Ne,"__esModule",{value:!0});Ne.operatorNode=Ne.nameNode=Ne.missingRef=Ne.localNameUseAnnotation=Ne.localNameDeclAnnotation=Ne.literalNode=Ne.letVar=Ne.letNode=Ne.lambdaParam=Ne.lambdaNode=Ne.indexedArg=Ne.identQualifier=Ne.identNamePart=Ne.headNamePart=Ne.formulaSpan=Ne.formulaRootAnnotation=Ne.formula=Ne.flattenNameParts=Ne.flattenLetArgs=Ne.flattenLambdaArgs=Ne.fieldRefNode=Ne.fieldRefNamePart=Ne.fieldRef=Ne.errorQualifier=Ne.documentQualifier=Ne.commaOpRef=Ne.columnRef=Ne.cellRefSingle=Ne.cellRefRow=Ne.cellRefRange=Ne.cellRefNode=Ne.cellRefNamePart=Ne.cellRefError=Ne.cellRefCol=Ne.cellRefBad=Ne.badRef=Ne.badQualifier=Ne.arrayNode=Ne.appNode=Ne.appHeadNameAnnotation=Ne.StructRefKind=Ne.SpecialRefId=Ne.RefStyle=Ne.QualifierKind=Ne.PosKind=Ne.NodeKind=Ne.NamePartKind=Ne.CellRefKind=Ne.BadType=Ne.AnnotationKind=void 0;Ne.getDepthUpperBound=Ne.wsfNode=Ne.thisRowOpRef=Ne.structRefNode=Ne.structRef=Ne.specialRef=Ne.sheetRangeQualifier=Ne.sheetQualifier=Ne.relativeQualifier=Ne.rangeOpRef=Ne.pos=Ne.parenNode=Ne.paramNode=Ne.paramName=Ne.paramDefault=void 0;var at=qr();Ne.AnnotationKind=at.formulaModule.AnnotationKind;Ne.BadType=at.formulaModule.BadType;Ne.CellRefKind=at.formulaModule.CellRefKind;Ne.NamePartKind=at.formulaModule.NamePartKind;Ne.NodeKind=at.formulaModule.NodeKind;Ne.PosKind=at.formulaModule.PosKind;Ne.QualifierKind=at.formulaModule.QualifierKind;Ne.RefStyle=at.formulaModule.RefStyle;Ne.SpecialRefId=at.formulaModule.SpecialRefId;Ne.StructRefKind=at.formulaModule.StructRefKind;Ne.appHeadNameAnnotation=at.formulaModule.appHeadNameAnnotation;Ne.appNode=at.formulaModule.appNode;Ne.arrayNode=at.formulaModule.arrayNode;Ne.badQualifier=at.formulaModule.badQualifier;Ne.badRef=at.formulaModule.badRef;Ne.cellRefBad=at.formulaModule.cellRefBad;Ne.cellRefCol=at.formulaModule.cellRefCol;Ne.cellRefError=at.formulaModule.cellRefError;Ne.cellRefNamePart=at.formulaModule.cellRefNamePart;Ne.cellRefNode=at.formulaModule.cellRefNode;Ne.cellRefRange=at.formulaModule.cellRefRange;Ne.cellRefRow=at.formulaModule.cellRefRow;Ne.cellRefSingle=at.formulaModule.cellRefSingle;Ne.columnRef=at.formulaModule.columnRef;Ne.commaOpRef=at.formulaModule.commaOpRef;Ne.documentQualifier=at.formulaModule.documentQualifier;Ne.errorQualifier=at.formulaModule.errorQualifier;Ne.fieldRef=at.formulaModule.fieldRef;Ne.fieldRefNamePart=at.formulaModule.fieldRefNamePart;Ne.fieldRefNode=at.formulaModule.fieldRefNode;Ne.flattenLambdaArgs=at.formulaModule.flattenLambdaArgs;Ne.flattenLetArgs=at.formulaModule.flattenLetArgs;Ne.flattenNameParts=at.formulaModule.flattenNameParts;Ne.formula=at.formulaModule.formula;Ne.formulaRootAnnotation=at.formulaModule.formulaRootAnnotation;Ne.formulaSpan=at.formulaModule.formulaSpan;Ne.headNamePart=at.formulaModule.headNamePart;Ne.identNamePart=at.formulaModule.identNamePart;Ne.identQualifier=at.formulaModule.identQualifier;Ne.indexedArg=at.formulaModule.indexedArg;Ne.lambdaNode=at.formulaModule.lambdaNode;Ne.lambdaParam=at.formulaModule.lambdaParam;Ne.letNode=at.formulaModule.letNode;Ne.letVar=at.formulaModule.letVar;Ne.literalNode=at.formulaModule.literalNode;Ne.localNameDeclAnnotation=at.formulaModule.localNameDeclAnnotation;Ne.localNameUseAnnotation=at.formulaModule.localNameUseAnnotation;Ne.missingRef=at.formulaModule.missingRef;Ne.nameNode=at.formulaModule.nameNode;Ne.operatorNode=at.formulaModule.operatorNode;Ne.paramDefault=at.formulaModule.paramDefault;Ne.paramName=at.formulaModule.paramName;Ne.paramNode=at.formulaModule.paramNode;Ne.parenNode=at.formulaModule.parenNode;Ne.pos=at.formulaModule.pos;Ne.rangeOpRef=at.formulaModule.rangeOpRef;Ne.relativeQualifier=at.formulaModule.relativeQualifier;Ne.sheetQualifier=at.formulaModule.sheetQualifier;Ne.sheetRangeQualifier=at.formulaModule.sheetRangeQualifier;Ne.specialRef=at.formulaModule.specialRef;Ne.structRef=at.formulaModule.structRef;Ne.structRefNode=at.formulaModule.structRefNode;Ne.thisRowOpRef=at.formulaModule.thisRowOpRef;Ne.wsfNode=at.formulaModule.wsfNode;Ne.getDepthUpperBound=at.formulaModule.getDepthUpperBound});var nbe=T(Da=>{"use strict";p();Object.defineProperty(Da,"__esModule",{value:!0});Da.resolvedUserDefinedFunc=Da.resolvedStructRef=Da.resolvedNever=Da.resolvedName=Da.resolvedLocalName=Da.resolvedDottedName=Da.resolvedCellRef=Da.resolveLocalsGrid=Da.noOriginSheet=Da.invalidStructRef=Da.invalidQualifier=Da.invalidCellRef=Da.emptyIntersection=Da.ResolvedKind=Da.ResolveReasonKind=Da.InvalidStructRefReason=Da.InvalidQualifierReason=Da.InvalidCellRefReason=void 0;var Vc=qr();Da.InvalidCellRefReason=Vc.resolveServiceTypes.InvalidCellRefReason;Da.InvalidQualifierReason=Vc.resolveServiceTypes.InvalidQualifierReason;Da.InvalidStructRefReason=Vc.resolveServiceTypes.InvalidStructRefReason;Da.ResolveReasonKind=Vc.resolveServiceTypes.ResolveReasonKind;Da.ResolvedKind=Vc.resolveServiceTypes.ResolvedKind;Da.emptyIntersection=Vc.resolveServiceTypes.emptyIntersection;Da.invalidCellRef=Vc.resolveServiceTypes.invalidCellRef;Da.invalidQualifier=Vc.resolveServiceTypes.invalidQualifier;Da.invalidStructRef=Vc.resolveServiceTypes.invalidStructRef;Da.noOriginSheet=Vc.resolveServiceTypes.noOriginSheet;Da.resolveLocalsGrid=Vc.resolveServiceTypes.resolveLocalsGrid;Da.resolvedCellRef=Vc.resolveServiceTypes.resolvedCellRef;Da.resolvedDottedName=Vc.resolveServiceTypes.resolvedDottedName;Da.resolvedLocalName=Vc.resolveServiceTypes.resolvedLocalName;Da.resolvedName=Vc.resolveServiceTypes.resolvedName;Da.resolvedNever=Vc.resolveServiceTypes.resolvedNever;Da.resolvedStructRef=Vc.resolveServiceTypes.resolvedStructRef;Da.resolvedUserDefinedFunc=Vc.resolveServiceTypes.resolvedUserDefinedFunc});var ibe=T(hF=>{"use strict";p();Object.defineProperty(hF,"__esModule",{value:!0});hF.resolveGridRef=hF.createResolver=void 0;var abe=qr();hF.createResolver=abe.resolveService.createResolver;hF.resolveGridRef=abe.resolveService.resolveGridRef});var obe=T(Dt=>{"use strict";p();Object.defineProperty(Dt,"__esModule",{value:!0});Dt.zipVisitor=Dt.voidVisitor=Dt.visitWSFNode=Dt.visitQualifier=Dt.visitOperatorNode=Dt.visitFormulaNode=Dt.visitCellRef=Dt.visitAppHeadNode=Dt.reduceTopDown_Pledge=Dt.reducePledge=Dt.reduceBottomUp_Recursive=Dt.reduceBottomUp_Pledge=Dt.reduceBottomUp_MaxDepth=Dt.reduceBottomUp_CPS=Dt.reduceBottomUp=Dt.identityVisitor=Dt.depthVisitor=Dt.constVisitor=Dt.composeVisitor=Dt.bindVisitor=Dt.binaryVisitor=Dt.ZipVisitor=Dt.PledgeReducer=Dt.IdentityVisitor=Dt.DelegatingVisitor=Dt.ConstVisitor=Dt.ComposeVisitor=Dt.BinaryVisitor=void 0;var Do=qr();Dt.BinaryVisitor=Do.visitor.BinaryVisitor;Dt.ComposeVisitor=Do.visitor.ComposeVisitor;Dt.ConstVisitor=Do.visitor.ConstVisitor;Dt.DelegatingVisitor=Do.visitor.DelegatingVisitor;Dt.IdentityVisitor=Do.visitor.IdentityVisitor;Dt.PledgeReducer=Do.visitor.PledgeReducer;Dt.ZipVisitor=Do.visitor.ZipVisitor;Dt.binaryVisitor=Do.visitor.binaryVisitor;Dt.bindVisitor=Do.visitor.bindVisitor;Dt.composeVisitor=Do.visitor.composeVisitor;Dt.constVisitor=Do.visitor.constVisitor;Dt.depthVisitor=Do.visitor.depthVisitor;Dt.identityVisitor=Do.visitor.identityVisitor;Dt.reduceBottomUp=Do.visitor.reduceBottomUp;Dt.reduceBottomUp_CPS=Do.visitor.reduceBottomUp_CPS;Dt.reduceBottomUp_MaxDepth=Do.visitor.reduceBottomUp_MaxDepth;Dt.reduceBottomUp_Pledge=Do.visitor.reduceBottomUp_Pledge;Dt.reduceBottomUp_Recursive=Do.visitor.reduceBottomUp_Recursive;Dt.reducePledge=Do.visitor.reducePledge;Dt.reduceTopDown_Pledge=Do.visitor.reduceTopDown_Pledge;Dt.visitAppHeadNode=Do.visitor.visitAppHeadNode;Dt.visitCellRef=Do.visitor.visitCellRef;Dt.visitFormulaNode=Do.visitor.visitFormulaNode;Dt.visitOperatorNode=Do.visitor.visitOperatorNode;Dt.visitQualifier=Do.visitor.visitQualifier;Dt.visitWSFNode=Do.visitor.visitWSFNode;Dt.voidVisitor=Do.visitor.voidVisitor;Dt.zipVisitor=Do.visitor.zipVisitor});var ube=T(YB=>{"use strict";p();Object.defineProperty(YB,"__esModule",{value:!0});YB.Pledge=void 0;var Zlr=pr();YB.Pledge=Zlr.pledge.Pledge});var PY=T(yF=>{"use strict";p();var Em,Vi;Object.defineProperty(yF,"__esModule",{value:!0});yF.evalFormat=yF.evalFormatImpl=void 0;var sbe=fe(),ju=U0(),j0=Iy(),JB=tbe(),ue=G0(),EY=nbe(),$lr=ibe(),jt=ZX(),Ox=NB(),ecr=jT(),cs=Ch(),bd=bh(),fbe=obe(),_d=ube(),Bg=(0,ecr.typedInstanceCreator)()(function(e,r,t,n){return{strong:e,format:r,valueType:t,decimals:n}}),Mx={},W0=(0,j0.createFailureErrorClass)("InferenceError"),Pm={getDocumentLoc:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getDocumentLoc")},getSheetIndex:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getSheetIndex")},getSheetName:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getSheetName")},getNameLoc:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getSheetRangeIndexes")},getCellFormat:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getCellFormat")},getKnownFormat:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getKnownFormat")},getIformat:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getIformat")},getFormatString:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getFormatString")},getContainingTable:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getContainingTable")},getStructRefColumn:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,ju.assertFalse)("calc.numfmt.evalFormula: default getStructRefSpecialRef")}};function rcr(e){var r,t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N,k,q,V,I,M,B,U,j;return{config:e.config,getDocumentLoc:(t=(r=e.getDocumentLoc)===null||r===void 0?void 0:r.bind(e))!==null&&t!==void 0?t:Pm.getDocumentLoc,getSheetIndex:(a=(n=e.getSheetIndex)===null||n===void 0?void 0:n.bind(e))!==null&&a!==void 0?a:Pm.getSheetIndex,getSheetName:(u=(o=e.getSheetName)===null||o===void 0?void 0:o.bind(e))!==null&&u!==void 0?u:Pm.getSheetName,getNameLoc:(l=(s=e.getNameLoc)===null||s===void 0?void 0:s.bind(e))!==null&&l!==void 0?l:Pm.getNameLoc,getUserDefinedFuncLoc:(d=(c=e.getUserDefinedFuncLoc)===null||c===void 0?void 0:c.bind(e))!==null&&d!==void 0?d:Pm.getUserDefinedFuncLoc,getSheetRangeIndexes:(m=(f=e.getSheetRangeIndexes)===null||f===void 0?void 0:f.bind(e))!==null&&m!==void 0?m:Pm.getSheetRangeIndexes,getCellFormat:(h=(v=e.getCellFormat)===null||v===void 0?void 0:v.bind(e))!==null&&h!==void 0?h:Pm.getCellFormat,getKnownFormat:(_=(y=e.getKnownFormat)===null||y===void 0?void 0:y.bind(e))!==null&&_!==void 0?_:Pm.getKnownFormat,getIformat:(N=(E=e.getIformat)===null||E===void 0?void 0:E.bind(e))!==null&&N!==void 0?N:Pm.getIformat,getFormatString:(q=(k=e.getFormatString)===null||k===void 0?void 0:k.bind(e))!==null&&q!==void 0?q:Pm.getFormatString,getContainingTable:(I=(V=e.getContainingTable)===null||V===void 0?void 0:V.bind(e))!==null&&I!==void 0?I:Pm.getContainingTable,getStructRefColumn:(B=(M=e.getStructRefColumn)===null||M===void 0?void 0:M.bind(e))!==null&&B!==void 0?B:Pm.getStructRefColumn,getStructRefSpecialRef:(j=(U=e.getStructRefSpecialRef)===null||U===void 0?void 0:U.bind(e))!==null&&j!==void 0?j:Pm.getStructRefSpecialRef}}function pbe(e,r){var t,n,a=rcr(e);return{globals:a,locals:r,config:e.config,localeInfo:(n=(t=r.config)===null||t===void 0?void 0:t.localeInfo)!==null&&n!==void 0?n:e.config.localeInfo,mathpack:e.config.mathpack,get document(){var o=r.originSheet;if(!(0,bd.isSuccess)(o))throw new W0(o);return o.value.document},get defaultFormat(){var o=SF(this,cs.KnownFormat.General);return Bg(!1,o,o.valueType,o.decimals)},get unitlessFormat(){var o=SF(this,cs.KnownFormat.General);return Bg(!0,o,o.valueType,o.decimals)},resolver:(0,$lr.createResolver)(a),multOrDivTainted:!1}}var xx=(Em={},Em[ue.FormatValueType.General]=0,Em[ue.FormatValueType.Number]=1,Em[ue.FormatValueType.Currency]=2,Em[ue.FormatValueType.Accounting]=2,Em[ue.FormatValueType.Percentage]=3,Em[ue.FormatValueType.Date]=4,Em[ue.FormatValueType.Time]=5,Em[ue.FormatValueType.Fraction]=6,Em[ue.FormatValueType.Scientific]=7,Em[ue.FormatValueType.Text]=8,Em[ue.FormatValueType.Custom]=9,Em),ff;(function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"})(ff||(ff={}));var tcr=(Vi={},Vi[jt.WorksheetFuncId.INT]=ff.Propagate,Vi[jt.WorksheetFuncId.MOD]=ff.Propagate,Vi[jt.WorksheetFuncId.ROUND]=ff.Propagate,Vi[jt.WorksheetFuncId.SUM]=ff.Propagate,Vi[jt.WorksheetFuncId.TRUNC]=ff.Propagate,Vi[jt.WorksheetFuncId.AVERAGE]=ff.Propagate,Vi[jt.WorksheetFuncId.MAX]=ff.Propagate,Vi[jt.WorksheetFuncId.MEDIAN]=ff.Propagate,Vi[jt.WorksheetFuncId.MIN]=ff.Propagate,Vi[jt.WorksheetFuncId.ROUNDUP]=ff.Propagate,Vi[jt.WorksheetFuncId.ROUNDDOWN]=ff.Propagate,Vi[jt.WorksheetFuncId.NPV]=cs.KnownFormat.CoCurrencyDec,Vi[jt.WorksheetFuncId.PV]=cs.KnownFormat.CoCurrencyDec,Vi[jt.WorksheetFuncId.FV]=cs.KnownFormat.CoCurrencyDec,Vi[jt.WorksheetFuncId.PMT]=cs.KnownFormat.CoCurrencyDec,Vi[jt.WorksheetFuncId.RATE]=cs.KnownFormat.Pct0,Vi[jt.WorksheetFuncId.MIRR]=cs.KnownFormat.Pct0,Vi[jt.WorksheetFuncId.IRR]=cs.KnownFormat.Pct0,Vi[jt.WorksheetFuncId.DATE]=cs.KnownFormat.MMDDYY,Vi[jt.WorksheetFuncId.TIME]=cs.KnownFormat.HHMMAP,Vi[jt.WorksheetFuncId.NOW]=cs.KnownFormat.MDYHMS,Vi[jt.WorksheetFuncId.SLN]=cs.KnownFormat.CoCurrencyDec,Vi[jt.WorksheetFuncId.SYD]=cs.KnownFormat.CoCurrencyDec,Vi[jt.WorksheetFuncId.DDB]=cs.KnownFormat.CoCurrencyDec,Vi[jt.WorksheetFuncId.IPMT]=cs.KnownFormat.CoCurrencyDec,Vi[jt.WorksheetFuncId.PPMT]=cs.KnownFormat.CoCurrencyDec,Vi[jt.WorksheetFuncId.TODAY]=cs.KnownFormat.MMDDYY,Vi[jt.WorksheetFuncId.VDB]=cs.KnownFormat.CoCurrencyDec,Vi[jt.WorksheetFuncId.DB]=cs.KnownFormat.CoCurrencyDec,Vi);function ncr(e){var r;return(r=tcr[e])!==null&&r!==void 0?r:ff.Ignore}var acr=[[ue.FormatValueType.General,ue.FormatValueType.Number,ue.FormatValueType.Currency,ue.FormatValueType.Percentage,ue.FormatValueType.Date,ue.FormatValueType.Time,ue.FormatValueType.Fraction,ue.FormatValueType.Scientific,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.Number,ue.FormatValueType.Currency,ue.FormatValueType.Percentage,ue.FormatValueType.Date,ue.FormatValueType.Time,ue.FormatValueType.Number,ue.FormatValueType.Scientific,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Currency,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Currency,ue.FormatValueType.Currency,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Percentage,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Percentage,ue.FormatValueType.Percentage,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Date,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Time,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Fraction,ue.FormatValueType.Scientific,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Scientific,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Custom]],icr=[[ue.FormatValueType.General,ue.FormatValueType.Number,ue.FormatValueType.Currency,ue.FormatValueType.General,ue.FormatValueType.Date,ue.FormatValueType.Time,ue.FormatValueType.Fraction,ue.FormatValueType.Scientific,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.Number,ue.FormatValueType.Currency,ue.FormatValueType.Number,ue.FormatValueType.Date,ue.FormatValueType.Time,ue.FormatValueType.Fraction,ue.FormatValueType.Scientific,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Currency,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Currency,ue.FormatValueType.Currency,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Percentage,ue.FormatValueType.Date,ue.FormatValueType.Time,ue.FormatValueType.Percentage,ue.FormatValueType.Scientific,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Date,ue.FormatValueType.Date,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Time,ue.FormatValueType.Time,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Fraction,ue.FormatValueType.Scientific,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Scientific,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Text,ue.FormatValueType.Custom],[ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.General,ue.FormatValueType.Custom]];function mbe(e,r){if(typeof r!="number")return r;var t=e.globals.getIformat(e.document,r);if(!(0,bd.isSuccess)(t))throw new W0(t.reason);return t.value}function SF(e,r){var t=e.globals.getKnownFormat(e.document,r);if(!(0,bd.isSuccess)(t))throw new W0(t.reason);return t.value}function gbe(e,r){if(typeof r=="number")return r;var t=e.globals.getFormatString(e.document,r.formatString);if(!(0,bd.isSuccess)(t))throw new W0(t.reason);return t.value!==void 0?t.value:r}function kx(e,r,t){(0,ju.assertTrue)("calc.numfmt.evalFormula: well-formed bin op",r.length===2);var n=r[0],a=r[1];return t(e,n,a)}function vbe(e,r,t,n){var a=t[0],o=n[0],u=xx[a.valueType],s=xx[o.valueType],l=u<=s?r[u][s]:r[s][u],c=xx[l],d=o.decimals>a.decimals?o.decimals:a.decimals;switch(c){case u:return Bg(!0,a.format,a.valueType,d);case s:return Bg(!0,o.format,o.valueType,d);default:return e.unitlessFormat}}function lbe(e,r,t){return vbe(e,icr,r,t)}function ocr(e,r,t){var n=r[0],a=t[0];if(n.format===a.format&&n.valueType===a.valueType&&n.valueType===ue.FormatValueType.Time)return Bg(!0,n.format,n.valueType,n.decimals);if(n.valueType===ue.FormatValueType.Date&&a.valueType===ue.FormatValueType.Time||n.valueType===ue.FormatValueType.Time&&a.valueType===ue.FormatValueType.Date){var o=SF(e,cs.KnownFormat.MDYHMS),u=o.valueType,s=o.decimals;return Bg(!0,o,u,s)}return vbe(e,acr,r,t)}var ucr=function(r){return r.unitlessFormat};function scr(e,r,t){var n=r[0],a=t[0];return n.format===a.format?Bg(!0,n.format,n.valueType,n.decimals):e.unitlessFormat}function lcr(e,r,t){switch(r){case jt.OperatorId.Mul:case jt.OperatorId.Div:return e.multOrDivTainted=!0,kx(e,t,lbe);case jt.OperatorId.Pow:return kx(e,t,lbe);case jt.OperatorId.Add:case jt.OperatorId.Sub:return kx(e,t,ocr);case jt.OperatorId.Percent:{(0,ju.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",t.length===1);var n=t[0],a=n[0],o=n[1];if(!(0,j0.isNumberLiteralNode)(o))return e.defaultFormat;var u=a.strong,s=a.decimals,l=SF(e,cs.KnownFormat.Pct);return Bg(u,l,l.valueType,s)}case jt.OperatorId.Pound:case jt.OperatorId.At:return e.defaultFormat;case jt.OperatorId.Neg:case jt.OperatorId.Pos:{(0,ju.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",t.length===1);var a=t[0][0];return a}case jt.OperatorId.Lt:case jt.OperatorId.Le:case jt.OperatorId.Eq:case jt.OperatorId.Ge:case jt.OperatorId.Gt:case jt.OperatorId.Ne:return kx(e,t,ucr);case jt.OperatorId.Isect:case jt.OperatorId.Union:case jt.OperatorId.Range:case jt.OperatorId.Concat:return kx(e,t,scr);case jt.OperatorId.And:case jt.OperatorId.Or:case jt.OperatorId.Xor:case jt.OperatorId.Min:case jt.OperatorId.Max:throw new W0((0,j0.notImplemented)(["evalFormat for Yellow ops"]));default:return(0,ju.assertNever)("calc.numfmt.evalFormat: unexpected operator id",r)}}function cbe(e){return xx[e]===xx[ue.FormatValueType.General]}var ccr=function(){function e(r){var t=this;this.context=r,this.visitFormulaNode=function(n){return(0,fbe.visitFormulaNode)(t,n)},this.lazyVisitFormulaNode=function(n){return _d.Pledge.resolve(n).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(r){switch(r.kind){case Ox.OperKind.String:case Ox.OperKind.Boolean:case Ox.OperKind.Error:case Ox.OperKind.Missing:return _d.Pledge.resolve(this.context.defaultFormat);case Ox.OperKind.Number:var t=21,n=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(r),t),a=n.indexOf(this.context.localeInfo.decimalSeparator),o=a>=0?n.length-a-1:0,u=SF(this.context,cs.KnownFormat.General);return _d.Pledge.resolve(Bg(!1,u,u.valueType,o));default:return(0,ju.assertNever)("calc.numfmt.evalFormat: unexpected literal oper",r)}},e.prototype.arrayNode=function(r){return _d.Pledge.resolve(this.context.defaultFormat)},e.prototype.appNode=function(r,t){var n=this;if((0,j0.isOperatorNode)(r))return _d.Pledge.all(t.map(function(f){return n.lazyVisitFormulaNode(f).bind(function(m){return[m,f]})})).bind(function(f){return lcr(n.context,r.id,f)});if((0,j0.isWSFNode)(r)){var a=r.id,o=ncr(a),u=(0,jt.getWorksheetFuncType)(a),s=(0,j0.getArguments)(t);if((0,ju.assertTrue)("calc.numfmt.evalFormula: well-formed WSF args",(0,j0.isValidArgsLength)(u,s.length)),o===ff.Ignore)return _d.Pledge.resolve(this.context.defaultFormat);if(o===ff.Propagate)return s.length===0?_d.Pledge.resolve(this.context.defaultFormat):_d.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind(function(f){var m=f[0],v=m.format,h=m.valueType,y=m.decimals,_=!cbe(h);if(!m.strong&&_)return n.context.unitlessFormat;for(var E=_,N=1;N<f.length;N+=1){var k=f[N],q=!cbe(k.valueType);if(!k.strong&&q)return n.context.unitlessFormat;E||(v=k.format,h=k.valueType,y=k.decimals,E=q)}return Bg(!0,v,h,y)});var l=SF(this.context,o),c=l.valueType,d=l.decimals;return _d.Pledge.resolve(Bg(!0,l,c,d))}return this.lazyVisitFormulaNode(r)},e.prototype.letNode=function(r,t,n,a){return _d.Pledge.resolve(this.context.defaultFormat)},e.prototype.lambdaNode=function(r,t,n,a){return _d.Pledge.resolve(this.context.defaultFormat)},e.prototype.parenNode=function(r){return this.lazyVisitFormulaNode(r)},e.prototype.nameNode=function(r,t){return _d.Pledge.resolve(this.context.defaultFormat)},e.prototype.cellRefNode=function(r,t){var n=this.context.resolver.resolveCellRef(this.context.locals,(0,JB.cellRefNode)(r,t)).resolution;if(!(0,bd.isSuccess)(n))throw(0,ju.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",n.reason.kind!==EY.ResolveReasonKind.NoOriginSheet),new W0(n.reason);var a=n.value;if(a===void 0)throw Mx;return(0,j0.isSheetGridRange)(a)?_d.Pledge.resolve(dbe(this.context,a)):_d.Pledge.resolve(this.context.unitlessFormat)},e.prototype.fieldRefNode=function(r,t){var n=this;return this.lazyVisitFormulaNode(r).bind(function(a){return n.context.defaultFormat})},e.prototype.structRefNode=function(r,t){var n=(0,JB.structRefNode)(r,t),a=this.context.resolver.resolveStructRef(this.context.locals,n).resolution;if(!(0,bd.isSuccess)(a))throw(0,ju.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",a.reason.kind!==EY.ResolveReasonKind.NoOriginSheet),a.reason.kind===EY.ResolveReasonKind.EmptyIntersection?Mx:new W0(a.reason);var o=a.value;if(o===void 0)throw Mx;return _d.Pledge.resolve(dbe(this.context,o))},e.prototype.missingNode=function(r){return(0,ju.assertFalse)("calc.numfmt.evalFormat: unexpected missing node")},e.prototype.badSequenceNode=function(r,t){return(0,ju.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.badCharsNode=function(r,t){return(0,ju.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.operatorNode=function(r,t){return _d.Pledge.resolve((0,JB.operatorNode)(r,t))},e.prototype.wsfNode=function(r,t,n){return _d.Pledge.resolve((0,JB.wsfNode)(r,t,n))},e}();function hbe(e,r){return(0,fbe.reducePledge)(new ccr(e),r)}function dbe(e,r){var t=(0,j0.sheetGridRangeAnchor)(r),n=e.globals.getCellFormat(t);if(!(0,bd.isSuccess)(n))throw new W0(n.reason);var a=n.value,o=mbe(e,a);if(!(0,j0.isDocumentLocEqual)(t.sheet.document,e.document)&&(typeof a!="number"||o.source!==ue.NumberFormatSource.Builtin))return e.defaultFormat;var u=o.valueType,s=o.decimals;return Bg(!0,a,u,s)}function dcr(e,r){var t=r.strong,n=r.format,a=r.valueType,o=r.decimals;if(!(a===ue.FormatValueType.Number&&e.multOrDivTainted)){if(o>0&&t&&(a===ue.FormatValueType.Number||a===ue.FormatValueType.Currency||a===ue.FormatValueType.Accounting||a===ue.FormatValueType.Percentage)){var u=mbe(e,n);o!==u.decimals&&(n=u.synthesizeDecimals(o))}if(!(a===ue.FormatValueType.General||!t))return n=gbe(e,n),n}}function fcr(e,r,t){try{var n=pbe(e,r),a=hbe(n,t);return(0,bd.success)(sbe.__assign(sbe.__assign({},a),{format:gbe(n,a.format),mulOrDivTainted:n.multOrDivTainted}))}catch(o){return o instanceof W0?(0,bd.failure)(o.reason):o===Mx?bd.successUndefined:(0,bd.failure)((0,bd.javaScriptError)(o))}}yF.evalFormatImpl=fcr;function pcr(e,r,t){try{var n=pbe(e,r),a=hbe(n,t);return(0,bd.success)(dcr(n,a))}catch(o){return o instanceof W0?(0,bd.failure)(o.reason):o===Mx?bd.successUndefined:(0,bd.failure)((0,bd.javaScriptError)(o))}}yF.evalFormat=pcr});var NY=T(Dp=>{"use strict";p();Object.defineProperty(Dp,"__esModule",{value:!0});Dp.toXLNumber=Dp.applyValueEdit=Dp.getValueEditOperKind=Dp.renderFormat=Dp.getFormatString=Dp.initUtilGlobals=void 0;var mcr=Iy(),eC=G0(),gcr=Ch(),Ly=bh(),AY=U0(),vcr=XB(),hcr=ZT(),FY={getKnownFormat:function(){return(0,AY.assertFalse)("calc.numfmt: default getKnownFormat")},getIformat:function(){return(0,AY.assertFalse)("calc.numfmt: default getIformat")},getFormatString:function(){return(0,AY.assertFalse)("calc.numfmt: default getFormatString")}};function Scr(e){var r,t,n,a,o,u;return{config:e.config,getKnownFormat:(t=(r=e.getKnownFormat)===null||r===void 0?void 0:r.bind(e))!==null&&t!==void 0?t:FY.getKnownFormat,getIformat:(a=(n=e.getIformat)===null||n===void 0?void 0:n.bind(e))!==null&&a!==void 0?a:FY.getIformat,getFormatString:(u=(o=e.getFormatString)===null||o===void 0?void 0:o.bind(e))!==null&&u!==void 0?u:FY.getFormatString}}Dp.initUtilGlobals=Scr;function ycr(e,r,t,n,a){var o=r.getFormatString(t,n);return(0,Ly.isSuccess)(o)?o.value!==void 0?r.getIformat(t,o.value):e.createFormat(n,a):o}Dp.getFormatString=ycr;function _cr(e,r,t){var n=(0,mcr.isStringOper)(t)?eC.Clip.None:eC.Clip.All,a=r.apply(t,eC.Alignment.Right,n,!0);if(!(0,Ly.isSuccess)(a))return a;var o=e.renderValue(a.value,eC.renderInfiniteWidth);return(0,Ly.isSuccess)(o)?(0,eC.isHashesValue)(o.value)?(0,Ly.success)(o.value.units):(0,Ly.success)((0,eC.renderedValueToString)(o.value)):o}Dp.renderFormat=_cr;function bcr(e){return e.value.kind}Dp.getValueEditOperKind=bcr;function Ccr(e,r,t,n){var a=t;if(n.kind===eC.EditKind.Number&&n.format!==gcr.KnownFormat.General){var o=n.format,u=typeof o=="string"?o:(0,hcr.getKnownFormat)(r,o),s=typeof o!="string",l=e.createFormat(u,s);if(!(0,Ly.isSuccess)(l))return l;var c=l.value;(0,vcr.shouldInstallFormat)(c,t)&&(a=c)}return e.applyFormat(a,n.value,!0)}Dp.applyValueEdit=Ccr;function Tcr(e,r,t){var n=r.parseGeneral(t,!1,!0,eC.GetTimeKind.NonVolatile);return(0,Ly.isSuccess)(n)?n.value==null?(0,Ly.failure)(null):(0,Ly.success)(e.toNumber(n.value.value)):n}Dp.toXLNumber=Tcr});var OY=T($B=>{"use strict";p();Object.defineProperty($B,"__esModule",{value:!0});$B.renderFormulaBar=void 0;var Rcr=G0(),_F=Iy(),Ecr=ZT(),ybe=U0(),ZB=NY(),Sbe=Ch(),aR=NB(),sl=bh();function Pcr(e,r,t,n,a){var o=r.config,u=o.mathpack,s=o.localeInfo;if(u.cond(n)<0)return(0,sl.success)(void 0);var l="",c=u.fix(n)!==0||a.isDate,d=n;if(c){var f=u.trunc(n),m=(0,ZB.getFormatString)(e,r,t,(0,Ecr.buildMMDDYYFormat)(s,!0),Rcr.NumberFormatSource.CustomString);if(!(0,sl.isSuccess)(m))return m;var v=(0,ZB.renderFormat)(e,m.value,f);if(!(0,sl.isSuccess)(v))return v;if(typeof v.value!="string")return(0,sl.success)(void 0);l+=v.value;var h=u.sub(n,f);(0,ybe.assertTrue)("calc.numfmt.renderFormulaBar: sub error",!(0,_F.isErrorOper)(h)),d=h}if(u.cond(d)>0||a.isTime){c&&(l+="  ");var y=r.getKnownFormat(t,s.clock24Hour?Sbe.KnownFormat.HHMMSS:Sbe.KnownFormat.HHMMSSAP);if(!(0,sl.isSuccess)(y))return y;var v=(0,ZB.renderFormat)(e,y.value,d);if(!(0,sl.isSuccess)(v))return v;if(typeof v.value!="string")return(0,sl.success)(void 0);l+=v.value}return(0,sl.success)(l)}function Acr(e,r,t,n,a){if(a.isDate||a.isTime){var o=Pcr(e,(0,ZB.initUtilGlobals)(r),t,n,a);if(!(0,sl.isSuccess)(o))return o;if(o.value!==void 0){var u=o.value;return o}}var s=21,l=r.config,c=l.mathpack,d=l.localeInfo;if(a.isPercent){var f=c.mul(n,c.fromNumber(100));return(0,_F.isErrorOper)(f)?(0,sl.failure)((0,_F.notImplemented)(["renderFormulaBar % overflow"])):(0,sl.success)(c.formatGeneral(d,f,s)+"%")}return(0,sl.success)(c.formatGeneral(d,n,s))}function Fcr(e,r,t,n,a,o){try{var u=r.config.localeInfo;switch(n.kind){case aR.OperKind.Number:return Acr(e,r,t,n,a);case aR.OperKind.String:return(0,sl.success)(o?"'"+n.value:n.value);case aR.OperKind.Boolean:return(0,sl.success)(n.value?u.trueName:u.falseName);case aR.OperKind.Error:var s=u.errorNames[n.type];return s==null?(0,sl.failure)((0,_F.internal)("No locale data for error type ".concat(n.type))):(0,sl.success)(s);case aR.OperKind.Array:return(0,sl.failure)((0,_F.notImplemented)(["Array renderFormulaBar"]));case aR.OperKind.Rich:return(0,sl.failure)((0,_F.notImplemented)(["Rich renderFormulaBar"]));case aR.OperKind.Blank:return(0,sl.success)("");default:return(0,ybe.assertNever)("calc.numfmt.renderFormulaBar: never value",n)}}catch(l){return(0,sl.failure)((0,sl.javaScriptError)(l))}}$B.renderFormulaBar=Fcr});var kY=T(bF=>{"use strict";p();Object.defineProperty(bF,"__esModule",{value:!0});bF.parseDate=bF.parseGeneral=void 0;var Ncr=BB(),eU=QB(),Ix=bh();function Ocr(e,r,t,n,a){try{var o=e.config,u=o.localeInfo,s=o.mathpack,l=(0,Ncr.parseConstInternal)(u,s,r,t,n,!1);return!(0,Ix.isSuccess)(l)||l.value!==void 0?l:(0,eU.parseDateInternal)((0,eU.initParseDateGlobals)(e),r,void 0,a)}catch(c){return(0,Ix.failure)((0,Ix.javaScriptError)(c))}}bF.parseGeneral=Ocr;function kcr(e,r,t){try{return(0,eU.parseDateInternal)((0,eU.initParseDateGlobals)(e),r,void 0,t)}catch(n){return(0,Ix.failure)((0,Ix.javaScriptError)(n))}}bF.parseDate=kcr});var Tbe=T(rU=>{"use strict";p();Object.defineProperty(rU,"__esModule",{value:!0});rU.createNumberFormatter=void 0;var _be=G0(),MY=wB(),Mcr=XB(),bbe=FB(),xcr=PY(),Icr=OY(),Cbe=kY();function wcr(e){return{createFormat:function(t,n){return(0,MY.createFormat)(e,t,typeof n!="boolean"?n:n?_be.NumberFormatSource.Builtin:_be.NumberFormatSource.CustomString)},applyFormat:function(t,n,a){return(0,MY.applyFormat)(e,t,n,a)},changeFormatDecimals:MY.changeFormatDecimals,renderValue:function(t,n){return(0,bbe.renderValue)(e.config.mathpack,t,n)},renderHashesValue:function(t,n){return(0,bbe.renderHashesValue)(t,n)},renderFormulaBar:function(t,n,a,o){return(0,Icr.renderFormulaBar)(this,e,t,n,a,o)},parseGeneral:function(t,n,a,o){return(0,Cbe.parseGeneral)(e,t,n,a,o)},parseDate:function(t,n){return(0,Cbe.parseDate)(e,t,n)},parseEdit:function(t,n){return(0,Mcr.parseEdit)(e,t,n)},evalFormat:function(t,n){return(0,xcr.evalFormat)(e,t,n)}}}rU.createNumberFormatter=wcr});var Ebe=T(CF=>{"use strict";p();Object.defineProperty(CF,"__esModule",{value:!0});CF.getRibbonFormat=CF.RibbonFormat=void 0;var Rbe=fe(),sn=HT(),qy=Ch(),Bs=ZT(),ds;(function(e){e.GalleryGeneral="GalleryGeneral",e.GalleryNumber="GalleryNumber",e.GalleryCurrency="GalleryCurrency",e.GalleryAccounting="GalleryAccounting",e.GalleryShortDate="GalleryShortDate",e.GalleryLongDate="GalleryLongDate",e.GalleryTime="GalleryTime",e.GalleryPercentage="GalleryPercentage",e.GalleryFraction="GalleryFraction",e.GalleryScientific="GalleryScientific",e.GalleryText="GalleryText",e.ButtonComma="ButtonComma",e.ButtonPercentage="ButtonPercentage",e.ButtonAccounting="ButtonAccounting",e.KeyboardGeneral="KeyboardGeneral",e.KeyboardNumber="KeyboardNumber",e.KeyboardCurrency="KeyboardCurrency",e.KeyboardDate="KeyboardDate",e.KeyboardTime="KeyboardTime",e.KeyboardPercentage="KeyboardPercentage",e.KeyboardScientific="KeyboardScientific"})(ds||(CF.RibbonFormat=ds={}));function tU(e,r){return(0,Bs.buildSingle)(e,sn.PictureSingle.ColorStart,"$-",r,sn.PictureSingle.ColorEnd)}function Dcr(e,r,t){var n,a,o=((a=(n=t==null?void 0:t.culture)===null||n===void 0?void 0:n.calendar)!==null&&a!==void 0?a:qy.Calendar.Gregorian)===qy.Calendar.Gregorian;switch(r){case ds.GalleryGeneral:case ds.KeyboardGeneral:return(0,Bs.getKnownFormat)(e,qy.KnownFormat.General);case ds.GalleryNumber:return(0,Bs.buildNumberFormat)(e,!1,1,e.currencyDecimals);case ds.KeyboardNumber:return(0,Bs.buildNumberFormat)(e,!0,4,e.currencyDecimals);case ds.GalleryCurrency:{var u=Rbe.__assign(Rbe.__assign({},e),{currencyFormat:e.currencyFormat===qy.CurrencyFormat.Paren?qy.CurrencyFormat.Lead:e.currencyFormat});return(0,Bs.buildCurrencyFormat)(u,!1,e.currencyDecimals,!0,!1,void 0,!0)}case ds.KeyboardCurrency:return(0,Bs.buildCurrencyFormat)(e,!0,e.currencyDecimals,!0,!1);case ds.GalleryAccounting:case ds.ButtonAccounting:return(0,Bs.buildCurrencyFormat)(e,!1,e.currencyDecimals,!0,!0);case ds.GalleryShortDate:return o?(0,Bs.getKnownFormat)(e,qy.KnownFormat.MMDDYY):(0,Bs.buildSingle)(e,sn.PictureSingle.Month,sn.PictureSingle.DateSep,sn.PictureSingle.Day,sn.PictureSingle.Sep,sn.PictureSingle.Text);case ds.GalleryLongDate:return o?tU(e,"x-sysdate")+(0,Bs.buildSingle)(e,sn.PictureSingle.Day,sn.PictureSingle.Day,sn.PictureSingle.Day,sn.PictureSingle.Day,", ",sn.PictureSingle.Month,sn.PictureSingle.Month,sn.PictureSingle.Month,sn.PictureSingle.Month," ",sn.PictureSingle.Day,sn.PictureSingle.Day,", ",sn.PictureSingle.Year,sn.PictureSingle.Year,sn.PictureSingle.Year,sn.PictureSingle.Year):(0,Bs.buildSingle)(e,sn.PictureSingle.Month,sn.PictureSingle.DateSep,sn.PictureSingle.Day,sn.PictureSingle.DateSep,sn.PictureSingle.Year,sn.PictureSingle.Year,sn.PictureSingle.Sep,sn.PictureSingle.Text);case ds.GalleryTime:return tU(e,"x-systime")+(0,Bs.buildSingle)(e,sn.PictureSingle.Hour,sn.PictureSingle.Colon,sn.PictureSingle.Minute,sn.PictureSingle.Minute,sn.PictureSingle.Colon,sn.PictureSingle.Second,sn.PictureSingle.Second," ")+(0,Bs.getSpecial)(e,sn.PictureSpecial.AP1);case ds.KeyboardDate:return tU(e,"en-US")+(0,Bs.buildSingle)(e,sn.PictureSingle.Day,"-",sn.PictureSingle.Month,sn.PictureSingle.Month,sn.PictureSingle.Month,"-",sn.PictureSingle.Year,sn.PictureSingle.Year,sn.PictureSingle.Sep,sn.PictureSingle.Text);case ds.KeyboardTime:return tU(e,"en-US")+(0,Bs.buildSingle)(e,sn.PictureSingle.Hour,sn.PictureSingle.Colon,sn.PictureSingle.Minute,sn.PictureSingle.Minute," ",(0,Bs.getSpecial)(e,sn.PictureSpecial.AP1),sn.PictureSingle.Sep,sn.PictureSingle.Text);case ds.GalleryPercentage:return(0,Bs.buildPercentFormat)(e,e.currencyDecimals);case ds.ButtonPercentage:case ds.KeyboardPercentage:return(0,Bs.getKnownFormat)(e,qy.KnownFormat.Pct0);case ds.GalleryFraction:return(0,Bs.getKnownFormat)(e,qy.KnownFormat.Fract);case ds.GalleryScientific:case ds.KeyboardScientific:return(0,Bs.buildScientificFormat)(e,1,e.currencyDecimals,2);case ds.GalleryText:return(0,Bs.getKnownFormat)(e,qy.KnownFormat.Text);case ds.ButtonComma:return(0,Bs.buildCurrencyFormat)(e,!1,e.currencyDecimals,!1,!0)}}CF.getRibbonFormat=Dcr});var Pbe=T(nU=>{"use strict";p();Object.defineProperty(nU,"__esModule",{value:!0});nU.commonFormats=void 0;nU.commonFormats=["#","##","###","########\\ \\ \\ \\ \\ \\ \\ \\ ","###,###","###\\ ###","###\\-##\\-####","##,###.##\\ \\ \\ ","#,###","#,###.#","#,###.##","#,###_)","#,###_)_ ","#.##","#.##%","#.#%","#;\\(\\ \\ @\\ \\ \\ \\)",'#"\\""\\""\\""\\"\\ ??/??',"#\\ ###",";;",";;;","@\\ ","\\ #######\\ \\ \\ \\ ","\\ \\ @","\\(###\\)\\ ###\\-####","\\(\\ ###\\ \\)\\ ###\\-####","\\:","__@","[$$]#,##0_);\\([$$]#,##0\\);[$$]#,##0_);@_)","[$$]#,##0.0_);\\([$$]#,##0.0\\);[$$]#,##0.0_);@_)","[$$-1009]#,##0.00","[$$-1009]#,##0;[Red]\\-[$$-1009]#,##0","[$$-409]#,##0","[$$-409]#,##0.00","[$$-409]#,##0.00_);\\([$$-409]#,##0.00\\)",'_([$$-409]* #,##0.00_);_([$$-409]* \\(#,##0.00\\);_([$$-409]* "-"??_);_(@_)',"[$$-409]#,##0.0000","[$$-409]#,##0.0000_);\\([$$-409]#,##0.0000\\)","[$$-409]#,##0.00_);[Red]\\([$$-409]#,##0.00\\)","[$$-409]#,##0;[Red][$$-409]#,##0","[$$-409]#,##0_);[Red]\\([$$-409]#,##0\\)","[$$-C09]#,##0.00","[$$-C09]#,##0.000","[$$-C09]#,##0.0000","[$$-C09]#,##0.00000","[$\xA3-809]#,##0","[$\xA3-809]#,##0.00","[$\xA3-809]#,##0.00;[Red]\\-[$\xA3-809]#,##0.00","[$\xA3-809]#,##0;[Red][$\xA3-809]#,##0","[$\xA5-411]#,##0","[$\u20AC-2]\\ #,##0.00","[$\u20AC-2]\\ #,##0.00_);[Red]\\([$\u20AC-2]\\ #,##0.00\\)","[$\u20AC-2]\\ #,##0_);[Red]\\([$\u20AC-2]\\ #,##0\\)",'"$"#,##0','"$"#,##0;\\("$"#,##0\\)','"$"#,##0;\\-"$"#,##0','"$"#,##0_);\\("$"#,##0\\)','"$"#,##0_);\\("$"#,##0\\);"-"??_)','"$"#,##0_);\\("$"#,##0\\);\\ \\-\\ ','"$"\\ #,##0;\\("$"\\ #,##0\\)',"\\$#,##0_);\\(\\$#,##0\\)",'_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"_ ;_ @_ ','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0_);_("$"\\ * \\(#,##0\\);_("$"\\ * "-"_);_(@_)','_-"$"* #,##0_-;\\-"$"* #,##0_-;_-"$"* "-"_-;_-@_-','"$"#,##0_%_);\\("$"#,##0\\)_%;"$"#,##0_%_);@_%_)','"$"#,##0.0','"$"#.00','"$"0.0','"$"#,##0.0,_);\\("$"#,##0.0,\\)','"$"#,##0.0;\\("$"#,##0.0\\);','"$"#,##0.0_);\\("$"#,##0.0\\)','"$"\\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.0_ ;_ "$"\\ * \\-#,##0.0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"?_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"_);_(@_)','_-"$"* #,##0.0_-;\\-"$"* #,##0.0_-;_-"$"* "-"_-;_-@_-','"$"#,##0.0_%_);\\("$"#,##0.0\\)_%;"$"#,##0.0_%_);@_%_)','"$"#,##0.00','"$"#.000','"$"\\ #,##0.00','"$"#,##0.00,_);\\("$"#,##0.00,\\)','"$"#,##0.00;\\("$"#,##0.00\\)','"$"#,##0.00;\\-"$"#,##0.00','"$"#,##0.00_);\\("$"#,##0.00\\)','"$"\\ \\ \\ #,##0.00_);\\("$"\\ \\ \\ #,##0.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.00_ ;_ "$"\\ * \\-#,##0.00_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0.00_);_("$"\\ * \\(#,##0.00\\);_("$"\\ * "-"??_);_(@_)','_-"$"* #,##0.00_-;\\-"$"* #,##0.00_-;_-"$"* "-"??_-;_-@_-','"$"#,##0.00_%_);\\("$"#,##0.00\\)_%;"$"#,##0.00_%_);@_%_)','"$"#,##0.000','"$"0.000','"$"0000','"$"#,##0.000_);\\("$"#,##0.0\\)','"$"#,##0.000_);\\("$"#,##0.00\\)','"$"#,##0.000_);\\("$"#,##0.000\\)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000','"$"0.0000','"$"#,##0.0000_);\\("$"#,##0.00\\)','"$"#,##0.0000_);\\("$"#,##0.0000\\)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000','"$"#,##0.00000_);\\("$"#,##0.000\\)','"$"#,##0.00000_);\\("$"#,##0.00000\\)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"?????_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"_);_(@_)','"$"#,##0.000000','"$"#,##0.000000_);\\("$"#,##0.000000\\)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??????_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000000','"$"#,##0.0000000_);\\("$"#,##0.0000000\\)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000000','"$"#,##0.00000000_);\\("$"#,##0.00000000\\)','_("$"* #,##0.00000000_);_("$"* \\(#,##0.00000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.000000000_);\\("$"#,##0.000000000\\)','_("$"* #,##0.000000000_);_("$"* \\(#,##0.000000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.0000000000_);\\("$"#,##0.0000000000\\)','"$"#,##0.0000000;[Red]\\-"$"#,##0.0000000','"$"#,##0.0000000_);[Red]\\("$"#,##0.0000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\);"- "_)','"$"#,##0.00000;[Red]\\-"$"#,##0.00000','"$"#,##0.00000_);[Red]\\("$"#,##0.00000\\)','"$"#,##0.0000;[Red]\\-"$"#,##0.0000','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\)','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\);"- "_)','"$"#,##0.000" /GJ"','"$"#,##0.000_);[Red]\\("$"#,##0.000\\)','"$"#,##0.00" /GJ"','"$"#,##0.00" /mmbtu"','"$"#,##0.00" /MWh"','"$"#,##0.00;[Red]"$"#,##0.00','"$"#,##0.00;[Red]\\-"$"#,##0.00','"$"#,##0.00_);[Red]\\("$"#,##0.00\\)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"- "_)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"-"','"$"* #,##0.00;[Red]\\ \\("$"* #,##0.00\\)','"$"\\ #,##0.00;[Red]"$"\\ \\-#,##0.00','"$"\\ #,##0.00_);[Red]\\("$"\\ #,##0.00\\)','"$"\\ \\ #,##0.00_);[Red]\\("$"\\ \\ #,##0.00\\)',"\\$#,##0.00;[Red]\\$\\(#,##0.00\\);\\-",'"$"0.0"MM"','"$"#,##0.0;[Red]\\("$"#,##0.0\\)','"$"#,##0.0;[Red]\\-"$"#,##0.0','"$"#,##0.0_);[Red]\\("$"#,##0.0\\)','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);"- "_)','"$"\\ \\ #,##0.0_);[Red]\\("$"\\ \\ #,##0.0\\)','"$"0" / kW"','"$"0"MM"','"$"#,##0\\ "/MW"','"$"#,##0\\ "/MWh"','"$"#,##0\\ "/MWH"','"$"#,##0;[Red]"$"#,##0','"$"#,##0;[Red]\\-"$"#,##0','"$"#,##0_);[Red]\\("$"#,##0\\)','"$"#,##0_);[Red]\\("$"#,##0\\);"- "_)','"$"#,##0_);[Red]\\<"$"#,##0\\>','"$"\\ #,##0;[Red]\\-"$"\\ #,##0','"$"\\ #,##0_);[Red]\\("$"\\ #,##0\\)','"$"\\ \\ #,##0_);[Red]\\("$"\\ \\ #,##0\\)','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',"[$CAD]\\ #,##0.000","[$CAD]\\ #,##0.000_);\\([$CAD]\\ #,##0.000\\)","[$R$ -416]#,##0_);\\([$R$ -416]#,##0\\)","[$R$ -416]#,##0.00_);\\([$R$ -416]#,##0.00\\)","[$R$-416]#,##0.0000_);[Red]\\([$R$-416]#,##0.0000\\)","[$R$-416]#,##0.000_);[Red]\\([$R$-416]#,##0.000\\)","[$R$-416]#,##0.00_);[Red]\\([$R$-416]#,##0.00\\)","[$R$-416]#,##0_);[Red]\\([$R$-416]#,##0\\)",'"\xA3"#,##0','"\xA3"#,##0;\\-"\xA3"#,##0',"\\\xA3#,##0_);\\(\\\xA3#,##0\\)",'_ "\xA3"* #,##0_ ;_ "\xA3"* \\-#,##0_ ;_ "\xA3"* "-"_ ;_ @_ ','_("\xA3"* #,##0_);_("\xA3"* \\(#,##0\\);_("\xA3"* "-"_);_(@_)','_-"\xA3"* #,##0_-;\\-"\xA3"* #,##0_-;_-"\xA3"* "-"_-;_-@_-','"\xA3"#,##0.0',"\\\xA3#,##0.0_);\\(\\\xA3#,##0.0\\)",'"\xA3"#,##0.00','"\xA3"#,##0.00;\\-"\xA3"#,##0.00',"\\\xA3#,##0.00_);\\(\\\xA3#,##0.00\\)",'_ "\xA3"* #,##0.00_ ;_ "\xA3"* \\-#,##0.00_ ;_ "\xA3"* "-"??_ ;_ @_ ','_("\xA3"* #,##0.00_);_("\xA3"* \\(#,##0.00\\);_("\xA3"* "-"??_);_(@_)','_-"\xA3"* #,##0.00_-;\\-"\xA3"* #,##0.00_-;_-"\xA3"* "-"??_-;_-@_-',"\\\xA3#,##0.000_);\\(\\\xA3#,##0.000\\)","\\\xA3#,##0.0000_);\\(\\\xA3#,##0.0000\\)",'_-"\xA3"* #,##0.0000_-;\\-"\xA3"* #,##0.0000_-;_-"\xA3"* "-"??_-;_-@_-','"\xA3"#,##0.00;[Red]\\-"\xA3"#,##0.00','"\xA3"#,##0.00_);[Red]\\("\xA3"#,##0.00\\)',"\\\xA3#,##0.00_);[Red]\\(\\\xA3#,##0.00\\)","\\\xA3#,##0.0_);[Red]\\(\\\xA3#,##0.0\\)",'"\xA3"#,##0;[Red]\\-"\xA3"#,##0','"\xA3"#,##0_);[Red]\\("\xA3"#,##0\\)',"\\\xA3#,##0_);[Red]\\(\\\xA3#,##0\\)","###\\ ###\\ ###\\ ###.0","###0","#,###.0#","#,###_);\\(#,##0\\);\\ \\-_ ","#,###___);\\(#,##0\\);\\ \\-\\ __","#,##0.##","#,##0.####","#,##0_)","#.0%","#0",'"#"\\ 0',"\\(0\\)",'0%;_("-"\\)',"0%\\ \\ ","0.",'0"  "',"0_)","0_;",'0" $/MWh"','#,##0"\xA3"_);\\(#,##0"\xA3"\\)','_ * #,##0_)"\xA3"_ ;_ * \\(#,##0\\)"\xA3"_ ;_ * "-"_)"\xA3"_ ;_ @_ ','_ * #,##0_)_\xA3_ ;_ * \\(#,##0\\)_\xA3_ ;_ * "-"_)_\xA3_ ;_ @_ ','#,##0"\xA3"_);[Red]\\(#,##0"\xA3"\\)',"#,###.00###","#,###.00###\\ \\ \\ ","#,##0.;\\-#,##0.","#,##0.0","#,##0.0___;","#,##0;\\(#,##0\\)","#,##0;\\(#,##0\\);\\-\\-","#,##0;\\-#,##0",'#,##0;\\-#,##0;"-"',"#,##0\\ ;\\(#,##0\\)","#,##0_ ;\\-#,##0\\ ","#,##0_ \\ ;\\(#,##0\\ \\ \\)","#,##0_);\\(#,##0\\);",'#,##0_);\\(#,##0\\);\\ "  -"',"#,##0_);\\(#,##0\\);\\ \\-\\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ \\ \\ ","#,##0_);\\(#,##0\\);\\-","#,##0_);\\(#,##0\\);\\-\\ \\ ","#,##0_);\\(#,##0\\);\\-_)","#,##0_);\\(#,##0\\);\\-_)_ _ ","#,##0_);\\(#,##0\\);_ \\-\\ \\ ","#,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0_);\\(#,##0\\)\\-","#,##0_)_ ;\\(#,##0\\)\\ ;\\ \\-_ _)","#,##0_)_ ;\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0___);\\(#,##0\\);\\ \\-\\ __","#,##0___);\\(#,##0\\);\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\);___-\\ \\ ","#,##0___);\\(#,##0\\)_;\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\)___;\\ \\-__\\ \\ ","#,##0_____);\\(#,##0\\);_____-\\ \\ ","#,##0_________);\\(#,##0\\);_________-\\ \\ ","#,#00",".00",'"**"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"*"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;\\-"\\"#,##0',"\\(#,##0_)\\);\\(#,##0\\)",'_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"??_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* \\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ',"_##,##0_);\\(#,##0\\);\\-_)_ _ ","_##,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","_(##0_);\\(##0\\)_ ;\\-_)_ _ ",'_(#,##0_);\\(#,##0\\);"-    "','_(* #,##0_);_(* \\(#,##0\\);_(* "-"???_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"?_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* ""??_);_(@_)','_-* #,##0_-;\\-* #,##0_-;_-* "-"??_-;_-@_-','_-* #,##0_-;\\-* #,##0_-;_-* "-"_-;_-@_-','_-* #,##0_-;_-* #,##0\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0_-;\\-"\\"* #,##0_-;_-"\\"* "-"_-;_-@_-',"0%\\-0%","0.0","0.0%",'0.0%;_(* "-"_)','0.0%;_("-"\\)','0.0%;_("-"_)','0.0%;_(\\ "-"_)',"0.0%\\ \\)",'0.0%\\-;_("-"_)','0.0"  "','0.0"%"','0.0_ "  "',"0.0_)","0.0_;","0.0____","0;\\-0;","0;\\-0;;","0;\\-0;;@\\ ","0_ ;\\-0\\ ","0_);\\(0\\)","00","###0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,###.0_);\\(#,##0.0\\);\\ \\-\\ _ ","#,##0.00#","#,##0.00###","#,##0.00__;","#,##0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,##0_);\\(#,##0\\);#,##0_);@_)",'"@ "\\&0.00%','"@ "0.00%','_(* #,##0_);_(* \\(#,##0\\);_(* "0"??_);_(@_)',"0%_);\\(0%\\);0%_);@_%_)","0.00#%",'0.00%;_(* "-"_)','0.00%;_("-"\\)',"0.00;;",'0.00"  "',"0.00_)","0_%_);\\(0\\)_%;0_%_);@_%_)","000","000#",'#,##0.00" $";\\-#,##0.00" $"',"#,##0.00\\ [$DM-407]","#,##0.00\\ [$EUR-407]",'#,##0.00" $";[Red]\\-#,##0.00" $"','#,##0.00"\xA3"_);\\(#,##0.00"\xA3"\\)','_ * #,##0.00_)"\xA3"_ ;_ * \\(#,##0.00\\)"\xA3"_ ;_ * "-"??_)"\xA3"_ ;_ @_ ','_ * #,##0.00_)_\xA3_ ;_ * \\(#,##0.00\\)_\xA3_ ;_ * "-"??_)_\xA3_ ;_ @_ ','#,##0.00"\xA3"_);[Red]\\(#,##0.00"\xA3"\\)',"##0.000","#,##0.0%_);\\(#,##0.0%\\);","#,##0.0_);\\(#,##0.0\\)","#,##0.0_);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_);\\(#,##0.0\\);_ \\ \\-","#,##0.0____\\);\\(#,##0.0\\);___ \\-\\ \\ ","#,##0.0_______);\\(#,##0.0\\);______\\ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);_______ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.000","#,##0.000___;",".0000",".0000%",'_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"??_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"?_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"_);_(@_)','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"??_-;_-@_-','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"_-;_-@_-',"0.0%;\\(0.0\\)%;\\ \\-\\ \\ ",'0.0%;\\-0.0%;\\ "-"_%;@_%',"0.0%\\ ;\\(0.0\\)%\\ ;\\-\\ \\ \\ ","0.0%\\);\\(0.0\\)%;\\ \\-","0.0%_);\\(0.0%\\)","0.0%_);\\(0.0\\)%;\\ \\-","0.0%_;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_%;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_);\\(0.0\\)","0.000","0.000%",'0.000%;_("-"\\)',"0.000_)","0.000_;","0000","##0.000\\ \\\xA2","#,##0.00_);\\(#,##0.0\\)","#,##0.0000","#,##0.0000___;","0.0000","0.0000%",'0.0000%;_(* "-"_)','0.0000%;_("-"\\)','0.0000"  "',"0.0000\\ %","0.0000_)","00\\-000","00\\-000_)","00000","###0.00_);\\(#,##0.00\\)","#,##0.0%_);\\(#,##0.0%\\);0.0%_);@_%_)","#,##0.0_%_);\\(#,##0.0\\)_%;#,##0.0_%_);@_%_)","#,##0.0_);\\(#,##0.0\\);#,##0.0_);@_)","#,##0.00%_);\\(#,##0.00%\\)","#,##0.00;#,##0.00;","#,##0.00;\\(#,##0.00\\)","#,##0.00;\\(#,##0.00\\);\\-\\-","#,##0.00_);\\(#,##0.00\\);\\ \\-\\ ","#,##0.00_);\\(#,##0.00\\);\\-","#,##0.00_);\\(#,##0.00\\);\\-\\ \\ ","#,##0.00_);\\(#,##0.00\\);_ \\ \\-","#,##0.00_);\\(#,##0.00\\);_ \\-\\ \\ ","#,##0.00__\\);\\(#,##0.00\\);__\\ \\ \\-","#,##0.00___);\\(#,##0.00\\);___ \\ \\-","#,##0.00___);\\(#,##0.00_);\\ \\-\\ \\ \\ ","#,##0.00000","#,##0.00000___;",'"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\"\\-#,##0.00','"\\"#,##0.00;\\-"\\"#,##0.00','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * \\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* \\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"????_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"?_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"_);_(@_)','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"??_-;_-@_-','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"_-;_-@_-','_-* #,##0.00_-;_-* #,##0.00\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0.00_-;\\-"\\"* #,##0.00_-;_-"\\"* "-"??_-;_-@_-',"0.0%_);\\(0.0%\\);0.0%_);@_%_)","0.0\\%_);\\(0.0\\%\\);0.0\\%_);@_%_)","0.00%_);\\(0.00%\\)","0.00;\\-0.00;","0.00_);\\(0.00\\)","0.00000","0.00000%",'0.00000"  "',"0.00000_)","000000","#,###.000_);\\(#,##0.000\\);\\ \\-\\ _ ","#,##0.000000","0.000000","0.000000%","0.000000_)","#,##0.000;\\(#,##0.000\\)","#,##0.000;\\(#,##0.000\\);\\-\\-","#,##0.000_);\\(#,##0.000\\)","#,##0.000_);\\(#,##0.000\\);\\ \\-\\ \\ ","#,##0.000_);\\(#,##0.000\\);\\-","#,##0.000_);\\(#,##0.000\\);_ \\-\\ \\ ","#,##0.0000000",'_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"???_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"??_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"?_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"_);_(@_)','_-* #,##0.000_-;\\-* #,##0.000_-;_-* "-"??_-;_-@_-',"_00000000","0.000_);\\(0.000\\)","0.0000000","0.0000000%","0.0000000_)","0000\\ \\-\\ 0000","00000000","#,###.0000_);\\(#,##0.0000\\);\\ \\-\\ _ ","#,##0.00_%_);\\(#,##0.00\\)_%;#,##0.00_%_);@_%_)","#,##0.00000000","0.00%_);\\(0.00%\\);0.00%_);@_%_)","0.00000000","0.00000000%","0.00000000_)","000\\-00\\-0000","000000000","#,##0.0000;\\(#,##0.0000\\)","#,##0.0000;\\-#,##0.0000","#,##0.0000_);\\(#,##0.0000\\)","#,##0.0000_);\\(#,##0.0000\\);_ \\-\\ \\ ","#,##0.0000_);\\(#,##0.0000_)","#,##0.0000___);\\(#,##0.0000_);\\ \\-\\ \\ \\ ","#,##0.000000000","\\(000\\)000\\-0000",'_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"????_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"?_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"_);_(@_)','_-* #,##0.0000_-;\\-* #,##0.0000_-;_-* "-"??_-;_-@_-',"0.0000_);\\(0.0000\\)","0.000000000","0.000000000%","0.000000000_)","0000000000","#,###.00000_);\\(#,##0.00000\\);\\ \\-\\ _ ","#,##0.0000000000","0.0000000000","0.0000000000_)","#,##0.00000_);\\(#,##0.00000\\)","#,##0.00000000000",'_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"?????_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"??_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"_);_(@_)','_-* #,##0.00000_-;\\-* #,##0.00000_-;_-* "-"??_-;_-@_-',"0.00000_);\\(0.00000\\)","0.00000000000","0.00000000000_)","#,###.000000_);\\(#,##0.000000\\);\\ \\-\\ _ ","0.000000000000","#,##0.000000_);\\(#,##0.000000\\)",'_(* #,##0.000000_);_(* \\(#,##0.000000\\);_(* "-"??_);_(@_)','0.000000%;\\-0.000000%;\\ "-"_%;@_%',"0.0000000000000","0.0000000000000_)","0.00000000000000%","#,##0.0000000_);\\(#,##0.0000000\\)",'_(* #,##0.0000000_);_(* \\(#,##0.0000000\\);_(* "-"??_);_(@_)',"0.0000000_);\\(0.0000000\\)","0.000000000000000%","0.0000000000000000","#,##0.00000000_);\\(#,##0.00000000\\)",'_(* #,##0.00000000_);_(* \\(#,##0.00000000\\);_(* "-"??_);_(@_)',"0.00000000000000000","0.00000000000000000%","0.000000000000000000","0.000000000000000000%","#,##0.000000000_);\\(#,##0.000000000\\)",'_(* #,##0.000000000_);_(* \\(#,##0.000000000\\);_(* "-"??_);_(@_)',"#,##0.00000000000000000000","#,##0.0000000000_);\\(#,##0.0000000000\\)",'_(* #,##0.0000000000_);_(* \\(#,##0.0000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000","0.0000000000000000000000%",'_(* #,##0.000000000000_);_(* \\(#,##0.000000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000000","0.00000000000000000000000000",'_(* #,##0.0000000000000_);_(* \\(#,##0.0000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000","0.0000000000000000000000000000",'_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"??_);_(@_)','_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000000","0.00000000000000000000000000000000","#,##0.0000000000000000_);\\(#,##0.0000000000000000\\)","0.000000000000000000000000000000000","0.0000000000000000000000000000000000","0.00000000000000000000000000000000000","#,##0.00000000000000000000_);[Red]\\(#,##0.00000000000000000000\\)","#,##0.0000000000000_);[Red]\\(#,##0.0000000000000\\)","#,##0.000000000000_);[Red]\\(#,##0.000000000000\\)","#,##0.00000000000_);[Red]\\(#,##0.00000000000\\)","#,##0.0000000000_);[Red]\\(#,##0.0000000000\\)","#,##0.00000000_);[Red]\\(#,##0.00000000\\)","#,##0.0000000_);[Red]\\(#,##0.0000000\\)","#,##0.000000_);[Red]\\(#,##0.000000\\)","0.000000\\x_);\\(0.000000\\x\\)","0.00000E+00","#,##0.00000_);[Red]\\(#,##0.00000\\)","0.00000_);[Red]\\(0.00000\\)","0.0000E+00","###0.0000_);[Red]\\(###0.0000\\)","#,##0.0000\\ ;[Red]\\(#,##0.0000\\)","#,##0.0000_ ;[Red]\\-#,##0.0000\\ ","#,##0.0000_);[Red]\\(#,##0.0000\\)","0.0000%;[Red]\\-0.0000%","0.0000%\\ ;[Red]\\(0.0000%\\)","0.0000;[Red]0.0000","0.0000_ ;[Red]\\-0.0000\\ ","0.0000_);[Red]\\(0.0000\\)","0.0000\\x_);\\(0.0000\\x\\)","0.000E+00","0.000E+00_)",'0.000" MWh/GJ"',"###0.000_);[Red]\\(###0.000\\)","#,##0.000;[Red]\\(#,##0.000\\)","#,##0.000;[Red]\\(#,##0.000\\);\\-","#,##0.000\\ ;[Red]\\(#,##0.000\\)","#,##0.000_);[Red]\\(#,##0.000\\)","0.000;[Red]0.000","0.000_);[Red]\\(0.000\\)","0.000_);[Red]\\-0.000_)","#,##0.0_%_);\\(#,##0.0\\)_%;[White]#,##0.0_%_);@_%_)",'0.00%" Capitalization Rate"','0.00%" Discount Rate"','_-* #,##0.00\\ "DM"_-;\\-* #,##0.00\\ "DM"_-;_-* "-"??\\ "DM"_-;_-@_-','_-* #,##0.00\\ _D_M_-;\\-* #,##0.00\\ _D_M_-;_-* "-"??\\ _D_M_-;_-@_-','#,##0.00" F"_);\\(#,##0.00" F"\\)','_-* #,##0.00\\ "F"_-;\\-* #,##0.00\\ "F"_-;_-* "-"??\\ "F"_-;_-@_-','_-* #,##0.00\\ _F_-;\\-* #,##0.00\\ _F_-;_-* "-"??\\ _F_-;_-@_-','0.00" GJ//MWh"','0.00" GJ/MWh"','0.00\\ "MW"','0.00%" of Avg LTD"','0.00%" of Sales"','0.00%" perpetual annual growth"','_-* #,##0.00\\ "Pts"_-;\\-* #,##0.00\\ "Pts"_-;_-* "-"??\\ "Pts"_-;_-@_-','_-* #,##0.00\\ _P_t_s_-;\\-* #,##0.00\\ _P_t_s_-;_-* "-"??\\ _P_t_s_-;_-@_-',"###0.00_);[Red]\\(###0.00\\)","#,##0.00%_);[Red]\\(#,##0.00%\\)","#,##0.00;[Red]#,##0.00",'#,##0.00;[Red]"-"#,##0.00',"#,##0.00;[Red]\\(#,##0.00\\)","#,##0.00;[Red]\\(#,##0.00\\);\\-","#,##0.00\\ ;[Red]\\(#,##0.00\\)","#,##0.00\\ \\);[Red]\\(#,##0.00\\)","#,##0.00_ ;[Red]\\-#,##0.00\\ ",'#,##0.00_);[Red]\\(#,##0.00\\);"-"','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\"\\-#,##0.00','"\\"#,##0.00;[Red]\\-"\\"#,##0.00','_(* #,##0.00_);[Red]_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00%;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\);\\-","0.00;[Red]0.00","0.00_ ;[Red]\\-0.00\\ ","0.00_);[Red]\\(0.00\\)","0.00_);[Red]\\(0.00\\);;","#,##0.00_);[Red]\\(#,##0.00\\)*1000","0.00\\x",'_(* #,##0.00\\x\\ \\ ;_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00\\x_);\\(0.00\\x\\)","_(##0_);\\(##0\\)_1;\\-_)_ _ ",'""0.0%" --> 61.5% of Sales 1st 5 yrs.; steady state thereafter"','00\\ "Coal Upgrade"',"0.0E+00",'0.0" GJ/MWh"','00\\ "Hydro"','00\\ "Incremental"','0.0" mmbtu//MWh"','0.0%" of beg. Net PPE + Intgble Amort."','0.0%" of Sales"','0.0%" of Total Assets"',"#,##0.0_);[Red]\\(#,##0\\)","###0.0_);[Red]\\(###0.0\\)","#,##0.0;[Red]\\(#,##0.0\\)","#,##0.0;[Red]\\(#,##0.0\\);\\-","#,##0.0;[Red]\\-#,##0.0","#,##0.0\\ ;[Red]\\(#,##0.0\\)","#,##0.0_ ;[Red]\\-#,##0.0\\ ","#,##0.0_);[Red]\\(#,##0.0\\)","#,##0.0_);[Red]\\(#,##0.0\\);","#,##0.0_);[Red]\\(#,##0.0\\);\\-","0.0%;[Red]\\(0.0%\\)","0.0%\\ ;[Red]\\(0.0%\\)","0.0%_);[Red]\\(0.0%\\)","0.0_);[Red]\\(0.0\\)","0.0_);[Red]\\-0.0_)","#,##0.0_);[Red]\\(#,##0.0\\)*1000",'0.0"x"','0.0\\ "x"',"0.0\\x","#,##0.0\\x_);\\(#,##0.0\\x\\)","#,##0.0\\x_);\\(#,##0.0\\x\\);",'0.0\\x_)_);"NM"_x_)_);0.0\\x_)_);@_%_)',"#,##0.0\\x_);[Red]\\(#,##0.0\\x\\);",'0%\\ "Beg. Net PPE + Intangibles"','0" Days"','_-* #,##0\\ "DM"_-;\\-* #,##0\\ "DM"_-;_-* "-"\\ "DM"_-;_-@_-','_-* #,##0\\ _D_M_-;\\-* #,##0\\ _D_M_-;_-* "-"\\ _D_M_-;_-@_-',"#,##0_e","0.E+00","0E+00","0\\ \\f",'_-* #,##0\\ "F"_-;\\-* #,##0\\ "F"_-;_-* "-"\\ "F"_-;_-@_-','_-* #,##0\\ _F_-;\\-* #,##0\\ _F_-;_-* "-"\\ _F_-;_-@_-','#,##0" GJ/D"','0\\ "Hydro"','0" / kW"','0\\ "Last Year"','#,##0" MMBTUs";\\-#,##0" MMBTUs"','0" months"','0\\ "mos"','0" MW"','#,##0" MWh";\\-#,##0" MWh"','#,##0" MWh/D"','#,##0_)"MWH";[Red]\\("$"#,##0\\);"- "_)','#,##0_)"mW";[Red]\\("$"#,##0\\);"- "_)','0\\ " of"','0%" of Sales"','_-* #,##0\\ "Pts"_-;\\-* #,##0\\ "Pts"_-;_-* "-"\\ "Pts"_-;_-@_-','_-* #,##0\\ _P_t_s_-;\\-* #,##0\\ _P_t_s_-;_-* "-"\\ _P_t_s_-;_-@_-',"#,##0_r_)",'#,##0"r"_)',"###0_);[Red]\\(#,##0\\)","##,##0;[Red]\\(##,##0\\)","#,##0;[Red]#,##0",'#,##0;[Red]"-"#,##0',"#,##0;[Red]\\(#,##0\\)","#,##0;[Red]\\(#,##0\\);\\-","#,##0;[Red]\\-#,##0","#,##0;[Red]\\-#,##0;\\-","#,##0\\ ;[Red]\\(#,##0\\)","#,##0_ ;[Red]\\-#,##0\\ ","#,##0_);[Red]\\(#,##0\\);","#,##0_);[Red]\\(#,##0\\);;",'#,##0_);[Red]\\(#,##0\\);"-   "','#,##0_);[Red]\\(#,##0\\);"- "_)','#,##0_);[Red]\\(#,##0\\);"-"',"#,##0_);[Red]\\(#,##0\\);\\-","#,##0_);[Red]\\<#,##0\\>","#.0,,;[Red]\\(#.0,,\\)",'"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\"\\-#,##0','"\\"#,##0;[Red]\\-"\\"#,##0','_(* #,##0_);[Red]* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);[Red]\\(* \\(#,##0\\);_(* "-"_);_(@_)',"0%\\ ;[Red]\\(0%\\)",'0%\\ ;[Red]\\(0%\\)\\ ;"-  "',"0%\\);[Red]\\(0%\\)","0%_);[Red]\\(0%\\)","0;[Red]0","0_);[Red]\\(0\\)","0_);[Red]\\(0\\);;","0_);[Red]\\-0_)","#,##0_);[Red]\\(#,##0,\\)*1000",'0%" Tax Rate"','0\\ "Wind"','0\\ "WTG"','0" Year"','0" years"',"0\\ \\y\\e\\a\\r\\s",'0"  Years"',"\\10000000","#?/12","#\\ ?/32","#\\ ?/32;[Red]\\(#?/32\\)","#\\ ?/32;[Red]\\(#\\ ?/32\\)","#\\ ?/4","#\\ ?/64","[<=9999999]###\\-####;\\(###\\)\\ ###\\-####",'"and"\\ 0\\ "-->6-year average"','"As of "\\ mm/dd/yy','"As of "mmmm\\ dd\\,\\ yyyy','"As of"\\ mmmm\\ dd\\,\\ yyyy','"As of "mmmm\\ d\\,\\ yyyy','"Ave. Debt Bal. * "0.00%" cost * (1-t)"','#\\ "BP"','_(\\C"$"* #,##0.00000_);_(\\C"$"* \\(#,##0.00000\\);_(\\C"$"* "0"_);_(@_)','\\C"$"#,##0_);\\(\\C"$"#,##0\\)','_(\\C"$"* #,##0_);_(\\C"$"* \\(#,##0\\);_(\\C"$"* "0"_);_(@_)','\\C"$"\\ #,##0\\);[Red]\\(\\C"$"\\ #,##0\\)','"Canada Cash Desk Economics (CDN$) for"\\ mmm\\-yy\\ "as of:"','"Change since "mmmm\\ dd\\,\\ yyyy','"Changes Since "mmmm\\ dd\\,\\ yyyy','_ "CHF"\\ * #,##0.00_ ;_ "CHF"\\ * \\-#,##0.00_ ;_ "CHF"\\ * "-"??_ ;_ @_ ','"Converted at "_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','"Cr$"\\ #,##0_);\\("Cr$"\\ #,##0\\)','"Current Day ("mm/dd/yy") Theoretical Sensitivities"\\ ','"Curves Loaded for"\\ \\ mm/dd/yy','"DATE:"\\ dd\\-mmm\\-yy','"DATE="mm/dd/yy','#\\ "Day"',"dd","ddd","dddd","ddd\\ \\-\\ dd","ddd\\-dd","dddd\\ d\\ mmmm\\ yyyy","ddd\\-dd\\-mmm\\-yy","ddd\\ dd\\ mmm\\ yyyy\\ hh:mm","dd\\-ddd\\-yy","dddd\\ mmmm\\ dd\\ ","dddd\\,\\ mmmm\\ dd\\,\\ yyyy","dddd\\,\\ mmmm\\ d\\,\\ yyyy","dddd\\,\\ mmmm\\,\\ d\\,\\ yyyy","dddd\\,mmmm\\,d\\,yyyy","ddd\\,\\ mmm\\ d","ddd\\-mmm\\-dd","ddd\\ yy/mm/dd","dd\\-mmm_)","dd\\-mmm\\-yy","dd\\-mmm\\-yy_)","dd\\-mmm\\-yy_);[Red]dd\\-mmm\\-yy_)","dd\\ mmm\\ yyyy","dd\\-mmm\\-yyyy","ddmmyy",'"Detail of New Transactions By Originator - "mmmm\\,\\ yyyy','"Discount Rate of"\\ 0.00%',"d\\-mmm\\,ddd",'d\\-mmm\\-yy\\ "Cycle 6"',"d/mmm/yyyy","d\\-mmm\\-yyyy",'d\\-mmm\\-yyyy\\ "Cycle 6"',"d/m/yy\\ h:mm","d\\.m\\.yy\\ h:mm",'"down"\\ 0.0','"DR="0.00%','"Effective Date: "\\ dd\\-mmm\\-yyyy','"EQUITY CASH FLOW PV AT "#0.00"%"','"First Period Days =  "\\ 0','"Fuel Cost:"\\ 0.00',"General\\ ","General_)","General;[Red]\\-General","General_);[Red]\\-General_)","h","hh:mm","hh:mm\\ AM/PM","hh:mm\\ AM/PM_)","hh:mm:ss","[h]:mm",'h:mm:ss"\\""\\""\\""\\"\\ AM/PM','"Include";;"Exclude"','" K-"#','_ "kr"\\ * #,##0.00_ ;_ "kr"\\ * \\-#,##0.00_ ;_ "kr"\\ * "-"??_ ;_ @_ ','_ "kr"\\ * #,##0_ ;_ "kr"\\ * \\-#,##0_ ;_ "kr"\\ * "-"_ ;_ @_ ','"LTD Through "mmmm\\ dd\\,\\ yyyy','##"m"',"m","m/d","m/dd/yyyy","m/d/yy","m/d/yy_%_)","m\\-d\\-yy","m/d/yy\\ h:mm","m/d/yy\\ h:mm\\ AM/PM","m\\/d\\/yyyy","m/d/yyyy\\ h:mm:ss","mm","mm/dd","mmdd","mm/dd/ddd","mm/dd/yy","mm/dd/yy_)","mm\\-dd\\-yy","mmddyy","mm/dd/yy\\ hh:mm","mm\\-dd\\-yy\\ hmm\\ AM/PM","mm/dd/yyyy",'mm"/"dd"/"yyyy',"mm\\-dd\\-yyyy","mm\\-dd\\-yyyy\\ ","mm\\/dd\\/yyyy","mm/dd/yyyy\\ hh:mm\\ AM/PM","mm/dd/yyyy\\ hh:mmAM/PM","mm\\-dd\\-yyyy\\ \\ hh:mm:ss\\ AM/PM\\ \\ ","mm\\-dd\\-yyyy\\ hh:mm:ss\\ AM/PM","mmm","mmm\\ d","mmm\\-dd","mmm\\-dd\\ \\ \\ h:mm\\ AM/PM","mmm\\ dd\\ yy_;","mmm\\-dd\\-yy","mmm\\-dd\\-yy\\ h:mm\\ AM/PM","mmm\\ dd\\ yyyy;","mmmddyyyy","mmm\\ dd\\ yyyy\\ hh:mm\\ AM/PM","mmm\\-d\\-yy","mmm\\-d\\-yy\\ ","mmm\\ d\\,\\ yyyy","mmmm","mmmm\\ d",'mmmm\\ dd","\\ yyyy',"mmmm\\ dd\\,\\ yyyy","mmmm\\ dd\\,\\ yyyy\\ \\ h:mm\\ AM/PM","\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ mmmm\\ d\\,\\ yyyy","mmmm\\ d\\,\\ yyyy","mmmmm","mm\\-mmm\\-yy","mmmm\\-yy","mmmm\\ yyyy","mmmm\\-yyyy","mmm\\ yy","mmm\\-yy_)","mmm\\.yy","mmm\\ yyyy","mmm\\,\\ yyyy","mmm\\-yyyy","mmm\\-yyyy_)","mm/yy","mm\\-yy","mm/yyyy","mm\\-yyyy",'"MTD Through "mmmm\\ dd\\,\\ yyyy',"m/yy","m\\/yy","m/yyyy","\\n\\o\\t\\ \\Q0",'"On";;"Off"','_("P"* #,##0.00_);_("P"* \\(#,##0.00\\);_("P"* "-"??_);_(@_)','_("P"\\ * #,##0.00_);_("P"\\ * \\(#,##0.00\\);_("P"\\ * "-"??_);_(@_)','_("P"* #,##0_);_("P"* \\(#,##0\\);_("P"* "-"_);_(@_)','_("P"\\ * #,##0_);_("P"\\ * \\(#,##0\\);_("P"\\ * "-"_);_(@_)','"Pmts per Year = "0',"\\P\\P\\ #,##0.00000_);\\(\\P\\P\\ #,##0.00000_)",'_("Ps. "* #,##0.00_);_("Ps. "* \\(#,##0.00\\);_("Ps. "* "-"??_);_(@_)','"Ps. "#,##0.00_);[Red]\\("Ps. "#,##0.00\\)','_("Ps. "* #,##0_);_("Ps. "* \\(#,##0\\);_("Ps. "* "-"_);_(@_)',"\\Q\\ 0","\\Q0",'_("R$"* #,##0.00_);_("R$"* \\(#,##0.00\\);_("R$"* "-"??_);_(@_)','_("R$"* #,##0_);_("R$"* \\(#,##0\\);_("R$"* "-"_);_(@_)',"[Red]#,##0;\\-#,##0","[Red]#,##0.0;[Blue]\\<#,##0.0\\>",'_-"Rs."* #,##0.00_-;\\-"Rs."* #,##0.00_-;_-"Rs."* "-"??_-;_-@_-','_-"Rs."* #,##0_-;\\-"Rs."* #,##0_-;_-"Rs."* "-"_-;_-@_-','_-"S/."\\ * #,##0.00_-;\\-"S/."\\ * #,##0.00_-;_-"S/."\\ * "-"??_-;_-@_-','_-"S/."\\ * #,##0_-;\\-"S/."\\ * #,##0_-;_-"S/."\\ * "-"_-;_-@_-','"Sales growth declines from "0.0%" to 10% in yr 5"','"Sensitivity Change from Prior Day ("mm/dd/yy")"','_ "SFr."* #,##0.00_ ;_ "SFr."* \\-#,##0.00_ ;_ "SFr."* "-"??_ ;_ @_ ','"SFr."#,##0;[Red]"SFr."\\-#,##0','"SFr."#,##0;"SFr."\\-#,##0','_ "SFr."* #,##0_ ;_ "SFr."* \\-#,##0_ ;_ "SFr."* "-"_ ;_ @_ ','"Stmt Date "m/d/yy','"Through "mmmm\\ dd\\,\\ yyyy','_(\\U"$"* #,##0_);_(\\U"$"* \\(#,##0\\);_(\\U"$"* "0"_);_(@_)','"up"\\ 0.0','"VS"\\ mmm\\-yy',"\\W#,##0","\\W#,##0.0",'"Wire Date "m/d/yy','"with "0%" tax"',"#\\x","\\X",'"Yes";;"No"','"Yes"_%_);;"No"_%_)','"YTD Through "mmmm\\ dd\\,\\ yyyy',"yyddmm","yy/m","yy/mm","yy\\-mm\\-dd","yymmdd",'yy"\\""\\""\\"\\-mm"\\""\\""\\"\\-dd"\\""\\""\\""\\"\\ h:mm',"yy\\ mmm","yy\\ mmm\\ dd","yyyy","yyyyddmm","yyyy/mm","yyyy\\.mm\\.dd","yyyy\\-mm\\-dd\\ hh:mm","yyyy/mm/dd\\ hh:mm:ss:ss","yyyy\\-mm\\-dd\\ hh:mm:ss\\.ss","yyyy\\ \\-\\ mmm","yyyy\\-mmm","yyyy\\-mmm\\-dd","yyyymmmdd","yyyy\\ mmmm"]});var ep=T(Xa=>{"use strict";p();Object.defineProperty(Xa,"__esModule",{value:!0});Xa.util=Xa.unicode=Xa.testData=Xa.serviceTypes=Xa.ribbonFormat=Xa.render=Xa.parsedate=Xa.parseconst=Xa.parse=Xa.localeData=Xa.knownFormat=Xa.impl=Xa.formulaBar=Xa.formatService=Xa.eval=Xa.edit=Xa.PackageName=void 0;var pf=fe();Xa.PackageName="excel-online-calc-numfmt";Xa.edit=pf.__importStar(XB());Xa.eval=pf.__importStar(PY());Xa.formatService=pf.__importStar(Tbe());Xa.formulaBar=pf.__importStar(OY());Xa.impl=pf.__importStar(wB());Xa.knownFormat=pf.__importStar(ZT());Xa.localeData=pf.__importStar(oY());Xa.parse=pf.__importStar(kY());Xa.parseconst=pf.__importStar(BB());Xa.parsedate=pf.__importStar(QB());Xa.render=pf.__importStar(FB());Xa.ribbonFormat=pf.__importStar(Ebe());Xa.serviceTypes=pf.__importStar(G0());Xa.testData=pf.__importStar(Pbe());Xa.unicode=pf.__importStar(gx());Xa.util=pf.__importStar(NY())});var Us=T(Sr=>{"use strict";p();Object.defineProperty(Sr,"__esModule",{value:!0});Sr.tooWide=Sr.stringEdit=Sr.renderedValueToString=Sr.renderedValue=Sr.renderInfiniteWidth=Sr.renderCallback=Sr.formatLocIFormat=Sr.formatLocKnownFormat=Sr.FormatLocKind=Sr.previousFormatFailure=Sr.otherEdit=Sr.numberEdit=Sr.notValueString=Sr.notFormatString=Sr.noFormatPart=Sr.memoizedRenderCallback=Sr.isSystemCultureTag=Sr.isHashesValue=Sr.isFormatCultureEqual=Sr.hashesValue=Sr.fractionOverflow=Sr.formulaEdit=Sr.formattedValue=Sr.formattedUnitString=Sr.formattedUnitGeneral=Sr.formattedUnitFlexible=Sr.formattedUnitBlank=Sr.evalFormatLocalsGrid=Sr.dateOverflow=Sr.createFormatGlobals=Sr.aggregationError=Sr.ReasonKind=Sr.NumberFormatSource=Sr.NamedColor=Sr.GetTimeKind=Sr.FormattedUnitKind=Sr.FormatValueType=Sr.FormatReasonKind=Sr.FormatCurrency=Sr.EditKind=Sr.CultureTag=Sr.Clip=Sr.BidiDate=Sr.Alignment=void 0;var jn=ep();Sr.Alignment=jn.serviceTypes.Alignment;Sr.BidiDate=jn.serviceTypes.BidiDate;Sr.Clip=jn.serviceTypes.Clip;Sr.CultureTag=jn.serviceTypes.CultureTag;Sr.EditKind=jn.serviceTypes.EditKind;Sr.FormatCurrency=jn.serviceTypes.FormatCurrency;Sr.FormatReasonKind=jn.serviceTypes.FormatReasonKind;Sr.FormatValueType=jn.serviceTypes.FormatValueType;Sr.FormattedUnitKind=jn.serviceTypes.FormattedUnitKind;Sr.GetTimeKind=jn.serviceTypes.GetTimeKind;Sr.NamedColor=jn.serviceTypes.NamedColor;Sr.NumberFormatSource=jn.serviceTypes.NumberFormatSource;Sr.ReasonKind=jn.serviceTypes.ReasonKind;Sr.aggregationError=jn.serviceTypes.aggregationError;Sr.createFormatGlobals=jn.serviceTypes.createFormatGlobals;Sr.dateOverflow=jn.serviceTypes.dateOverflow;Sr.evalFormatLocalsGrid=jn.serviceTypes.evalFormatLocalsGrid;Sr.formattedUnitBlank=jn.serviceTypes.formattedUnitBlank;Sr.formattedUnitFlexible=jn.serviceTypes.formattedUnitFlexible;Sr.formattedUnitGeneral=jn.serviceTypes.formattedUnitGeneral;Sr.formattedUnitString=jn.serviceTypes.formattedUnitString;Sr.formattedValue=jn.serviceTypes.formattedValue;Sr.formulaEdit=jn.serviceTypes.formulaEdit;Sr.fractionOverflow=jn.serviceTypes.fractionOverflow;Sr.hashesValue=jn.serviceTypes.hashesValue;Sr.isFormatCultureEqual=jn.serviceTypes.isFormatCultureEqual;Sr.isHashesValue=jn.serviceTypes.isHashesValue;Sr.isSystemCultureTag=jn.serviceTypes.isSystemCultureTag;Sr.memoizedRenderCallback=jn.serviceTypes.memoizedRenderCallback;Sr.noFormatPart=jn.serviceTypes.noFormatPart;Sr.notFormatString=jn.serviceTypes.notFormatString;Sr.notValueString=jn.serviceTypes.notValueString;Sr.numberEdit=jn.serviceTypes.numberEdit;Sr.otherEdit=jn.serviceTypes.otherEdit;Sr.previousFormatFailure=jn.serviceTypes.previousFormatFailure;Sr.FormatLocKind=jn.serviceTypes.FormatLocKind;Sr.formatLocKnownFormat=jn.serviceTypes.formatLocKnownFormat;Sr.formatLocIFormat=jn.serviceTypes.formatLocIFormat;Sr.renderCallback=jn.serviceTypes.renderCallback;Sr.renderInfiniteWidth=jn.serviceTypes.renderInfiniteWidth;Sr.renderedValue=jn.serviceTypes.renderedValue;Sr.renderedValueToString=jn.serviceTypes.renderedValueToString;Sr.stringEdit=jn.serviceTypes.stringEdit;Sr.tooWide=jn.serviceTypes.tooWide});var TF=T(Ug=>{"use strict";p();Object.defineProperty(Ug,"__esModule",{value:!0});Ug.NumberShape=Ug.KnownFormat=Ug.DateOrder=Ug.CurrencyFormat=Ug.Calendar=void 0;var wx=qr();Ug.Calendar=wx.numfmt.Calendar;Ug.CurrencyFormat=wx.numfmt.CurrencyFormat;Ug.DateOrder=wx.numfmt.DateOrder;Ug.KnownFormat=wx.numfmt.KnownFormat;Ug.NumberShape=wx.numfmt.NumberShape});var aU=T(Lo=>{"use strict";p();Object.defineProperty(Lo,"__esModule",{value:!0});Lo.isKnownFormatDefined=Lo.getSpecial=Lo.getSingle=Lo.getKnownFormat=Lo.getColor=Lo.englishXLSXKnownFormat=Lo.buildSingle=Lo.buildScientificFormat=Lo.buildPercentFormat=Lo.buildNumberFormat=Lo.buildMMDDYYFormat=Lo.buildFractionFormat=Lo.buildCurrencyFormat=void 0;var Am=ep();Lo.buildCurrencyFormat=Am.knownFormat.buildCurrencyFormat;Lo.buildFractionFormat=Am.knownFormat.buildFractionFormat;Lo.buildMMDDYYFormat=Am.knownFormat.buildMMDDYYFormat;Lo.buildNumberFormat=Am.knownFormat.buildNumberFormat;Lo.buildPercentFormat=Am.knownFormat.buildPercentFormat;Lo.buildScientificFormat=Am.knownFormat.buildScientificFormat;Lo.buildSingle=Am.knownFormat.buildSingle;Lo.englishXLSXKnownFormat=Am.knownFormat.englishXLSXKnownFormat;Lo.getColor=Am.knownFormat.getColor;Lo.getKnownFormat=Am.knownFormat.getKnownFormat;Lo.getSingle=Am.knownFormat.getSingle;Lo.getSpecial=Am.knownFormat.getSpecial;Lo.isKnownFormatDefined=Am.knownFormat.isKnownFormatDefined});var Dx=T(RF=>{"use strict";p();Object.defineProperty(RF,"__esModule",{value:!0});RF.getRibbonFormat=RF.RibbonFormat=void 0;var Abe=ep();RF.RibbonFormat=Abe.ribbonFormat.RibbonFormat;RF.getRibbonFormat=Abe.ribbonFormat.getRibbonFormat});var xY=T(EF=>{"use strict";p();Object.defineProperty(EF,"__esModule",{value:!0});EF.shouldInstallFormat=EF.parseEdit=void 0;var Fbe=ep();EF.parseEdit=Fbe.edit.parseEdit;EF.shouldInstallFormat=Fbe.edit.shouldInstallFormat});var oU=T(iU=>{"use strict";p();Object.defineProperty(iU,"__esModule",{value:!0});iU.createNumberFormatter=void 0;var Lcr=ep();iU.createNumberFormatter=Lcr.formatService.createNumberFormatter});var Nbe=T(Lp=>{"use strict";p();Object.defineProperty(Lp,"__esModule",{value:!0});Lp.toXLNumber=Lp.renderFormat=Lp.initUtilGlobals=Lp.getValueEditOperKind=Lp.getFormatString=Lp.applyValueEdit=void 0;var PF=ep();Lp.applyValueEdit=PF.util.applyValueEdit;Lp.getFormatString=PF.util.getFormatString;Lp.getValueEditOperKind=PF.util.getValueEditOperKind;Lp.initUtilGlobals=PF.util.initUtilGlobals;Lp.renderFormat=PF.util.renderFormat;Lp.toXLNumber=PF.util.toXLNumber});var uU=T(Ve=>{"use strict";p();Object.defineProperty(Ve,"__esModule",{value:!0});Ve.englishXLSXKnownFormat=Ve.isKnownFormatDefined=Ve.getKnownFormat=Ve.Calendar=Ve.NumberShape=Ve.DateOrder=Ve.CurrencyFormat=Ve.KnownFormat=Ve.evalFormatLocalsGrid=Ve.createFormatGlobals=Ve.NumberFormatSource=Ve.otherEdit=Ve.numberEdit=Ve.stringEdit=Ve.formulaEdit=Ve.EditKind=Ve.renderedValueToString=Ve.renderInfiniteWidth=Ve.memoizedRenderCallback=Ve.renderCallback=Ve.isHashesValue=Ve.hashesValue=Ve.renderedValue=Ve.formattedValue=Ve.formattedUnitFlexible=Ve.formattedUnitBlank=Ve.formattedUnitString=Ve.formattedUnitGeneral=Ve.FormattedUnitKind=Ve.Clip=Ve.GetTimeKind=Ve.Alignment=Ve.NamedColor=Ve.FormatCurrency=Ve.CultureTag=Ve.BidiDate=Ve.FormatValueType=Ve.formatLocIFormat=Ve.formatLocKnownFormat=Ve.FormatLocKind=Ve.previousFormatFailure=Ve.fractionOverflow=Ve.dateOverflow=Ve.aggregationError=Ve.tooWide=Ve.noFormatPart=Ve.notFormatString=Ve.notValueString=Ve.ReasonKind=Ve.FormatReasonKind=void 0;Ve.toXLNumber=Ve.applyValueEdit=Ve.getValueEditOperKind=Ve.createNumberFormatter=Ve.shouldInstallFormat=Ve.getRibbonFormat=Ve.RibbonFormat=void 0;var iR=fe(),aa=iR.__importStar(Us()),Lx=iR.__importStar(TF()),IY=iR.__importStar(aU()),Obe=iR.__importStar(Dx()),qcr=iR.__importStar(xY()),Gcr=iR.__importStar(oU()),wY=iR.__importStar(Nbe());Ve.FormatReasonKind=aa.FormatReasonKind;Ve.ReasonKind=aa.ReasonKind;Ve.notValueString=aa.notValueString;Ve.notFormatString=aa.notFormatString;Ve.noFormatPart=aa.noFormatPart;Ve.tooWide=aa.tooWide;Ve.aggregationError=aa.aggregationError;Ve.dateOverflow=aa.dateOverflow;Ve.fractionOverflow=aa.fractionOverflow;Ve.previousFormatFailure=aa.previousFormatFailure;Ve.FormatLocKind=aa.FormatLocKind;Ve.formatLocKnownFormat=aa.formatLocKnownFormat;Ve.formatLocIFormat=aa.formatLocIFormat;Ve.FormatValueType=aa.FormatValueType;Ve.BidiDate=aa.BidiDate;Ve.CultureTag=aa.CultureTag;Ve.FormatCurrency=aa.FormatCurrency;Ve.NamedColor=aa.NamedColor;Ve.Alignment=aa.Alignment;Ve.GetTimeKind=aa.GetTimeKind;Ve.Clip=aa.Clip;Ve.FormattedUnitKind=aa.FormattedUnitKind;Ve.formattedUnitGeneral=aa.formattedUnitGeneral;Ve.formattedUnitString=aa.formattedUnitString;Ve.formattedUnitBlank=aa.formattedUnitBlank;Ve.formattedUnitFlexible=aa.formattedUnitFlexible;Ve.formattedValue=aa.formattedValue;Ve.renderedValue=aa.renderedValue;Ve.hashesValue=aa.hashesValue;Ve.isHashesValue=aa.isHashesValue;Ve.renderCallback=aa.renderCallback;Ve.memoizedRenderCallback=aa.memoizedRenderCallback;Ve.renderInfiniteWidth=aa.renderInfiniteWidth;Ve.renderedValueToString=aa.renderedValueToString;Ve.EditKind=aa.EditKind;Ve.formulaEdit=aa.formulaEdit;Ve.stringEdit=aa.stringEdit;Ve.numberEdit=aa.numberEdit;Ve.otherEdit=aa.otherEdit;Ve.NumberFormatSource=aa.NumberFormatSource;Ve.createFormatGlobals=aa.createFormatGlobals;Ve.evalFormatLocalsGrid=aa.evalFormatLocalsGrid;Ve.KnownFormat=Lx.KnownFormat;Ve.CurrencyFormat=Lx.CurrencyFormat;Ve.DateOrder=Lx.DateOrder;Ve.NumberShape=Lx.NumberShape;Ve.Calendar=Lx.Calendar;Ve.getKnownFormat=IY.getKnownFormat;Ve.isKnownFormatDefined=IY.isKnownFormatDefined;Ve.englishXLSXKnownFormat=IY.englishXLSXKnownFormat;Ve.RibbonFormat=Obe.RibbonFormat;Ve.getRibbonFormat=Obe.getRibbonFormat;Ve.shouldInstallFormat=qcr.shouldInstallFormat;Ve.createNumberFormatter=Gcr.createNumberFormatter;Ve.getValueEditOperKind=wY.getValueEditOperKind;Ve.applyValueEdit=wY.applyValueEdit;Ve.toXLNumber=wY.toXLNumber});var fs=T(gt=>{"use strict";p();Object.defineProperty(gt,"__esModule",{value:!0});gt.userDefinedFuncLoc=gt.unsafeGridRange=gt.structRefColumnLoc=gt.sheetRows=gt.sheetRangeIndexes=gt.sheetRange=gt.sheetIndex=gt.sheetGridRange=gt.sheetGridCube=gt.sheetGridCell=gt.sheetCols=gt.originCell=gt.nameScope=gt.nameLoc=gt.lexicalSourceUDF=gt.lexicalSourceWSF=gt.lexicalSourceRange=gt.lexicalSourceName=gt.lexicalSourceGrid=gt.lexicalSourceCell=gt.isSheetIndex=gt.isSheetGridRange=gt.isSheetGridCell=gt.isGridCell=gt.gridRange=gt.gridCell=gt.documentScope=gt.documentLoc=gt.allSheetsRange=gt.NameSource=gt.LexicalKind=void 0;var ji=qr();gt.LexicalKind=ji.location.LexicalKind;gt.NameSource=ji.location.NameSource;gt.allSheetsRange=ji.location.allSheetsRange;gt.documentLoc=ji.location.documentLoc;gt.documentScope=ji.location.documentScope;gt.gridCell=ji.location.gridCell;gt.gridRange=ji.location.gridRange;gt.isGridCell=ji.location.isGridCell;gt.isSheetGridCell=ji.location.isSheetGridCell;gt.isSheetGridRange=ji.location.isSheetGridRange;gt.isSheetIndex=ji.location.isSheetIndex;gt.lexicalSourceCell=ji.location.lexicalSourceCell;gt.lexicalSourceGrid=ji.location.lexicalSourceGrid;gt.lexicalSourceName=ji.location.lexicalSourceName;gt.lexicalSourceRange=ji.location.lexicalSourceRange;gt.lexicalSourceWSF=ji.location.lexicalSourceWSF;gt.lexicalSourceUDF=ji.location.lexicalSourceUDF;gt.nameLoc=ji.location.nameLoc;gt.nameScope=ji.location.nameScope;gt.originCell=ji.location.originCell;gt.sheetCols=ji.location.sheetCols;gt.sheetGridCell=ji.location.sheetGridCell;gt.sheetGridCube=ji.location.sheetGridCube;gt.sheetGridRange=ji.location.sheetGridRange;gt.sheetIndex=ji.location.sheetIndex;gt.sheetRange=ji.location.sheetRange;gt.sheetRangeIndexes=ji.location.sheetRangeIndexes;gt.sheetRows=ji.location.sheetRows;gt.structRefColumnLoc=ji.location.structRefColumnLoc;gt.unsafeGridRange=ji.location.unsafeGridRange;gt.userDefinedFuncLoc=ji.location.userDefinedFuncLoc});var kbe=T(rC=>{"use strict";p();Object.defineProperty(rC,"__esModule",{value:!0});rC.RTree=rC.RTKind=rC.copyExcept=void 0;var DY=pr();rC.copyExcept=DY.rTree.copyExcept;rC.RTKind=DY.rTree.RTKind;rC.RTree=DY.rTree.RTree});var Il=T(ln=>{"use strict";p();Object.defineProperty(ln,"__esModule",{value:!0});ln.now=ln.mapFromArrayOfPairs=ln.singleton=ln.typedInstanceCreator=ln.makeStringCompareCI=ln.fastAbs=ln.fastMax=ln.fastMin=ln.pair=ln.filterOutNones=ln.isNone=ln.isDefined=ln.safeConcat=ln.safePush=ln.strEnumArray=ln.numEnumMap=ln.numEnumArray=ln.cloneStringMap=ln.makeStringMap=ln.identity=ln.staticAssertIsOptional=ln.staticAssertIs=ln.staticAssertSame=ln.staticAssertExtends=ln.makeNewtypeIso=void 0;var Ru=pr();ln.makeNewtypeIso=Ru.core.makeNewtypeIso;ln.staticAssertExtends=Ru.core.staticAssertExtends;ln.staticAssertSame=Ru.core.staticAssertSame;ln.staticAssertIs=Ru.core.staticAssertIs;ln.staticAssertIsOptional=Ru.core.staticAssertIsOptional;ln.identity=Ru.core.identity;ln.makeStringMap=Ru.core.makeStringMap;ln.cloneStringMap=Ru.core.cloneStringMap;ln.numEnumArray=Ru.core.numEnumArray;ln.numEnumMap=Ru.core.numEnumMap;ln.strEnumArray=Ru.core.strEnumArray;ln.safePush=Ru.core.safePush;ln.safeConcat=Ru.core.safeConcat;ln.isDefined=Ru.core.isDefined;ln.isNone=Ru.core.isNone;ln.filterOutNones=Ru.core.filterOutNones;ln.pair=Ru.core.pair;ln.fastMin=Ru.core.fastMin;ln.fastMax=Ru.core.fastMax;ln.fastAbs=Ru.core.fastAbs;ln.makeStringCompareCI=Ru.core.makeStringCompareCI;ln.typedInstanceCreator=Ru.core.typedInstanceCreator;ln.singleton=Ru.core.singleton;ln.mapFromArrayOfPairs=Ru.core.mapFromArrayOfPairs;ln.now=Ru.core.now});var Na=T(Oe=>{"use strict";p();Object.defineProperty(Oe,"__esModule",{value:!0});Oe.isSheetGridRange=Oe.isSheetGridCellEqual=Oe.isSheetGridCell=Oe.isRichOper=Oe.isReadOperEqual=Oe.isRangeOper=Oe.isRangeOpNoMissing=Oe.isRangeOpClosed=Oe.isPrimitiveOper=Oe.isOperatorNode=Oe.isNumberOper=Oe.isNumberLiteralNode=Oe.isNameScopeEqual=Oe.isMissingOper=Oe.isMissingNode=Oe.isGridRangeEqual=Oe.isGridCellEqual=Oe.isGridCell=Oe.isErrorOper=Oe.isDocumentLocEqual=Oe.isCommaOpRefWellFormed=Oe.isCommaOpNoBadOrMissing=Oe.isCommaOpClosed=Oe.isBooleanOper=Oe.isBooleanLiteralNode=Oe.isBlankOper=Oe.isArrayOper=Oe.internal=Oe.gridRangesJoin=Oe.gridRangeSize=Oe.gridRangeJoinOpt=Oe.gridRangeJoin=Oe.gridRangeIsects=Oe.gridRangeIsect=Oe.gridRangeExcept=Oe.gridRangeCompare=Oe.gridRangeAnchor=Oe.gridCellRange=Oe.gridCellImplicitIsect=Oe.getEtaFuncId=Oe.getWorksheetFuncId=Oe.getUserDefinedFuncName=Oe.getBoundName=Oe.getArguments=Oe.getArgType=Oe.forEachTileInRange=Oe.forEachCellInRange=Oe.createFailureErrorClass=Oe.ReasonKind=Oe.LangReasonKind=void 0;Oe.applyComparison=Oe.unavailable=Oe.shouldFieldRefBeBracketed=Oe.sheetGridRangeAnchor=Oe.notImplemented=Oe.normalizeCommaOpRef=Oe.isWriteOper=Oe.isWellFormed=Oe.isWSFNode=Oe.isValidArgsLength=Oe.isUnqualifiedNameNode=Oe.isStringOper=Oe.isSheetIndexEqual=Oe.isSheetIndex=Oe.isSheetGridRangeEqual=void 0;var ot=qr();Oe.LangReasonKind=ot.util.LangReasonKind;Oe.ReasonKind=ot.util.ReasonKind;Oe.createFailureErrorClass=ot.util.createFailureErrorClass;Oe.forEachCellInRange=ot.util.forEachCellInRange;Oe.forEachTileInRange=ot.util.forEachTileInRange;Oe.getArgType=ot.util.getArgType;Oe.getArguments=ot.util.getArguments;Oe.getBoundName=ot.util.getBoundName;Oe.getUserDefinedFuncName=ot.util.getUserDefinedFuncName;Oe.getWorksheetFuncId=ot.util.getWorksheetFuncId;Oe.getEtaFuncId=ot.util.getEtaFuncId;Oe.gridCellImplicitIsect=ot.util.gridCellImplicitIsect;Oe.gridCellRange=ot.util.gridCellRange;Oe.gridRangeAnchor=ot.util.gridRangeAnchor;Oe.gridRangeCompare=ot.util.gridRangeCompare;Oe.gridRangeExcept=ot.util.gridRangeExcept;Oe.gridRangeIsect=ot.util.gridRangeIsect;Oe.gridRangeIsects=ot.util.gridRangeIsects;Oe.gridRangeJoin=ot.util.gridRangeJoin;Oe.gridRangeJoinOpt=ot.util.gridRangeJoinOpt;Oe.gridRangeSize=ot.util.gridRangeSize;Oe.gridRangesJoin=ot.util.gridRangesJoin;Oe.internal=ot.util.internal;Oe.isArrayOper=ot.util.isArrayOper;Oe.isBlankOper=ot.util.isBlankOper;Oe.isBooleanLiteralNode=ot.util.isBooleanLiteralNode;Oe.isBooleanOper=ot.util.isBooleanOper;Oe.isCommaOpClosed=ot.util.isCommaOpClosed;Oe.isCommaOpNoBadOrMissing=ot.util.isCommaOpNoBadOrMissing;Oe.isCommaOpRefWellFormed=ot.util.isCommaOpRefWellFormed;Oe.isDocumentLocEqual=ot.util.isDocumentLocEqual;Oe.isErrorOper=ot.util.isErrorOper;Oe.isGridCell=ot.util.isGridCell;Oe.isGridCellEqual=ot.util.isGridCellEqual;Oe.isGridRangeEqual=ot.util.isGridRangeEqual;Oe.isMissingNode=ot.util.isMissingNode;Oe.isMissingOper=ot.util.isMissingOper;Oe.isNameScopeEqual=ot.util.isNameScopeEqual;Oe.isNumberLiteralNode=ot.util.isNumberLiteralNode;Oe.isNumberOper=ot.util.isNumberOper;Oe.isOperatorNode=ot.util.isOperatorNode;Oe.isPrimitiveOper=ot.util.isPrimitiveOper;Oe.isRangeOpClosed=ot.util.isRangeOpClosed;Oe.isRangeOpNoMissing=ot.util.isRangeOpNoMissing;Oe.isRangeOper=ot.util.isRangeOper;Oe.isReadOperEqual=ot.util.isReadOperEqual;Oe.isRichOper=ot.util.isRichOper;Oe.isSheetGridCell=ot.util.isSheetGridCell;Oe.isSheetGridCellEqual=ot.util.isSheetGridCellEqual;Oe.isSheetGridRange=ot.util.isSheetGridRange;Oe.isSheetGridRangeEqual=ot.util.isSheetGridRangeEqual;Oe.isSheetIndex=ot.util.isSheetIndex;Oe.isSheetIndexEqual=ot.util.isSheetIndexEqual;Oe.isStringOper=ot.util.isStringOper;Oe.isUnqualifiedNameNode=ot.util.isUnqualifiedNameNode;Oe.isValidArgsLength=ot.util.isValidArgsLength;Oe.isWSFNode=ot.util.isWSFNode;Oe.isWellFormed=ot.util.isWellFormed;Oe.isWriteOper=ot.util.isWriteOper;Oe.normalizeCommaOpRef=ot.util.normalizeCommaOpRef;Oe.notImplemented=ot.util.notImplemented;Oe.sheetGridRangeAnchor=ot.util.sheetGridRangeAnchor;Oe.shouldFieldRefBeBracketed=ot.util.shouldFieldRefBeBracketed;Oe.unavailable=ot.util.unavailable;Oe.applyComparison=ot.util.applyComparison});var qY=T(AF=>{"use strict";p();Object.defineProperty(AF,"__esModule",{value:!0});AF.makeGridRangeTable=AF.gridRangeDistance=void 0;var Bcr=kbe(),Mbe=Il(),LY=Na();function xbe(e,r){var t=e.row,n=e.col,a=e.rows,o=e.cols,u=r.row,s=r.col,l=r.rows,c=r.cols,d=(0,Mbe.fastAbs)(t-u+(a-l)*.5),f=(0,Mbe.fastAbs)(n-s+(o-c)*.5);return d+f}AF.gridRangeDistance=xbe;function Ucr(){return Bcr.RTree.create(LY.gridRangeJoin,LY.gridRangeIsects,LY.gridRangeCompare,xbe)}AF.makeGridRangeTable=Ucr});var FF=T(sU=>{"use strict";p();Object.defineProperty(sU,"__esModule",{value:!0});sU.RedBlackMapTree=void 0;var Kcr=pr();sU.RedBlackMapTree=Kcr.rbMapTree.RedBlackMapTree});var fi=T(wl=>{"use strict";p();Object.defineProperty(wl,"__esModule",{value:!0});wl.assertPositiveLength=wl.assertPositiveInteger=wl.assertInteger=wl.assertIndex=wl.assertNatural=wl.assertNever=wl.assertFalse=wl.assertTrue=wl.ulsLogger=void 0;var Gy=pr();wl.ulsLogger=Gy.assertions.ulsLogger;wl.assertTrue=Gy.assertions.assertTrue;wl.assertFalse=Gy.assertions.assertFalse;wl.assertNever=Gy.assertions.assertNever;wl.assertNatural=Gy.assertions.assertNatural;wl.assertIndex=Gy.assertions.assertIndex;wl.assertInteger=Gy.assertions.assertInteger;wl.assertPositiveInteger=Gy.assertions.assertPositiveInteger;wl.assertPositiveLength=Gy.assertions.assertPositiveLength});var NF=T(Tr=>{"use strict";p();Object.defineProperty(Tr,"__esModule",{value:!0});Tr.tooWide=Tr.stringEdit=Tr.renderedValueToString=Tr.renderedValue=Tr.renderInfiniteWidth=Tr.renderCallback=Tr.previousFormatFailure=Tr.otherEdit=Tr.numberEdit=Tr.notValueString=Tr.notFormatString=Tr.noFormatPart=Tr.memoizedRenderCallback=Tr.isSystemCultureTag=Tr.isHashesValue=Tr.isFormatCultureEqual=Tr.hashesValue=Tr.fractionOverflow=Tr.formulaEdit=Tr.formattedValue=Tr.formattedUnitString=Tr.formattedUnitGeneral=Tr.formattedUnitFlexible=Tr.formattedUnitBlank=Tr.evalFormatLocalsGrid=Tr.dateOverflow=Tr.createFormatGlobals=Tr.aggregationError=Tr.ReasonKind=Tr.NumberFormatSource=Tr.NamedColor=Tr.GetTimeKind=Tr.FormattedUnitKind=Tr.FormatValueType=Tr.FormatReasonKind=Tr.FormatCurrency=Tr.EditKind=Tr.CultureTag=Tr.Clip=Tr.BidiDate=Tr.Alignment=void 0;var sa=ep();Tr.Alignment=sa.serviceTypes.Alignment;Tr.BidiDate=sa.serviceTypes.BidiDate;Tr.Clip=sa.serviceTypes.Clip;Tr.CultureTag=sa.serviceTypes.CultureTag;Tr.EditKind=sa.serviceTypes.EditKind;Tr.FormatCurrency=sa.serviceTypes.FormatCurrency;Tr.FormatReasonKind=sa.serviceTypes.FormatReasonKind;Tr.FormatValueType=sa.serviceTypes.FormatValueType;Tr.FormattedUnitKind=sa.serviceTypes.FormattedUnitKind;Tr.GetTimeKind=sa.serviceTypes.GetTimeKind;Tr.NamedColor=sa.serviceTypes.NamedColor;Tr.NumberFormatSource=sa.serviceTypes.NumberFormatSource;Tr.ReasonKind=sa.serviceTypes.ReasonKind;Tr.aggregationError=sa.serviceTypes.aggregationError;Tr.createFormatGlobals=sa.serviceTypes.createFormatGlobals;Tr.dateOverflow=sa.serviceTypes.dateOverflow;Tr.evalFormatLocalsGrid=sa.serviceTypes.evalFormatLocalsGrid;Tr.formattedUnitBlank=sa.serviceTypes.formattedUnitBlank;Tr.formattedUnitFlexible=sa.serviceTypes.formattedUnitFlexible;Tr.formattedUnitGeneral=sa.serviceTypes.formattedUnitGeneral;Tr.formattedUnitString=sa.serviceTypes.formattedUnitString;Tr.formattedValue=sa.serviceTypes.formattedValue;Tr.formulaEdit=sa.serviceTypes.formulaEdit;Tr.fractionOverflow=sa.serviceTypes.fractionOverflow;Tr.hashesValue=sa.serviceTypes.hashesValue;Tr.isFormatCultureEqual=sa.serviceTypes.isFormatCultureEqual;Tr.isHashesValue=sa.serviceTypes.isHashesValue;Tr.isSystemCultureTag=sa.serviceTypes.isSystemCultureTag;Tr.memoizedRenderCallback=sa.serviceTypes.memoizedRenderCallback;Tr.noFormatPart=sa.serviceTypes.noFormatPart;Tr.notFormatString=sa.serviceTypes.notFormatString;Tr.notValueString=sa.serviceTypes.notValueString;Tr.numberEdit=sa.serviceTypes.numberEdit;Tr.otherEdit=sa.serviceTypes.otherEdit;Tr.previousFormatFailure=sa.serviceTypes.previousFormatFailure;Tr.renderCallback=sa.serviceTypes.renderCallback;Tr.renderInfiniteWidth=sa.serviceTypes.renderInfiniteWidth;Tr.renderedValue=sa.serviceTypes.renderedValue;Tr.renderedValueToString=sa.serviceTypes.renderedValueToString;Tr.stringEdit=sa.serviceTypes.stringEdit;Tr.tooWide=sa.serviceTypes.tooWide});var Dl=T(mf=>{"use strict";p();Object.defineProperty(mf,"__esModule",{value:!0});mf.successUndefined=mf.success=mf.javaScriptError=mf.isSuccess=mf.failure=mf.ResultKind=mf.ReasonKind=void 0;var oR=pr();mf.ReasonKind=oR.result.ReasonKind;mf.ResultKind=oR.result.ResultKind;mf.failure=oR.result.failure;mf.isSuccess=oR.result.isSuccess;mf.javaScriptError=oR.result.javaScriptError;mf.success=oR.result.success;mf.successUndefined=oR.result.successUndefined});var lU=T(La=>{"use strict";p();Object.defineProperty(La,"__esModule",{value:!0});La.resolvedUserDefinedFunc=La.resolvedStructRef=La.resolvedNever=La.resolvedName=La.resolvedLocalName=La.resolvedDottedName=La.resolvedCellRef=La.resolveLocalsGrid=La.noOriginSheet=La.invalidStructRef=La.invalidQualifier=La.invalidCellRef=La.emptyIntersection=La.ResolvedKind=La.ResolveReasonKind=La.InvalidStructRefReason=La.InvalidQualifierReason=La.InvalidCellRefReason=void 0;var jc=qr();La.InvalidCellRefReason=jc.resolveServiceTypes.InvalidCellRefReason;La.InvalidQualifierReason=jc.resolveServiceTypes.InvalidQualifierReason;La.InvalidStructRefReason=jc.resolveServiceTypes.InvalidStructRefReason;La.ResolveReasonKind=jc.resolveServiceTypes.ResolveReasonKind;La.ResolvedKind=jc.resolveServiceTypes.ResolvedKind;La.emptyIntersection=jc.resolveServiceTypes.emptyIntersection;La.invalidCellRef=jc.resolveServiceTypes.invalidCellRef;La.invalidQualifier=jc.resolveServiceTypes.invalidQualifier;La.invalidStructRef=jc.resolveServiceTypes.invalidStructRef;La.noOriginSheet=jc.resolveServiceTypes.noOriginSheet;La.resolveLocalsGrid=jc.resolveServiceTypes.resolveLocalsGrid;La.resolvedCellRef=jc.resolveServiceTypes.resolvedCellRef;La.resolvedDottedName=jc.resolveServiceTypes.resolvedDottedName;La.resolvedLocalName=jc.resolveServiceTypes.resolvedLocalName;La.resolvedName=jc.resolveServiceTypes.resolvedName;La.resolvedNever=jc.resolveServiceTypes.resolvedNever;La.resolvedStructRef=jc.resolveServiceTypes.resolvedStructRef;La.resolvedUserDefinedFunc=jc.resolveServiceTypes.resolvedUserDefinedFunc});var Fm=T(Or=>{"use strict";p();Object.defineProperty(Or,"__esModule",{value:!0});Or.runtimePositionFirstOrderFunc=Or.runtimePositionFormulaRoot=Or.runtimePositionEtaLambdaBody=Or.runtimePositionLambdaParam=Or.runtimePositionLambdaRoot=Or.runtimePositionLetVal=Or.breaked=Or.paused=Or.limitExceeded=Or.previousNameFailure=Or.previousFailure=Or.cellCycle=Or.nameCycle=Or.evalLocals=Or.evalGlobals=Or.userDefinedFunc=Or.stopped=Or.cellFormula=Or.cellWellFormedFormula=Or.pendingValue=Or.finalValue=Or.illFormedFormula=Or.LimitKind=Or.StepAction=Or.RuntimePositionKind=Or.stackValue=Or.Interrupt=Or.CellKind=Or.interval=Or.compileLocalsName=Or.compileLocalsGrid=Or.createCompileGlobals=Or.ReasonKind=void 0;var cU=fe(),Ibe=fi(),UY=Il(),Lbe=Na(),Vcr=fs(),jcr=NF(),qx=Dl(),Wcr=lU(),GY;(function(e){e.Timeout="Timeout",e.Breakpoint="Breakpoint",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"})(GY||(GY={}));Or.ReasonKind=cU.__assign(cU.__assign(cU.__assign(cU.__assign({},Lbe.ReasonKind),GY),jcr.FormatReasonKind),Wcr.ResolveReasonKind);function Hcr(e){return{config:e}}Or.createCompileGlobals=Hcr;function zcr(e,r,t){return{config:t??void 0,lexicalKind:e,originGridCell:(0,qx.success)(r),allowUnqualifiedCell:!0,emitStepInfo:!1}}Or.compileLocalsGrid=zcr;function Qcr(e,r){return{config:r??void 0,lexicalKind:Vcr.LexicalKind.NameManager,originGridCell:(0,qx.success)(e),allowUnqualifiedCell:!1,emitStepInfo:!1}}Or.compileLocalsName=Qcr;Or.interval=(0,UY.typedInstanceCreator)()(function(e,r){return(0,Ibe.assertPositiveInteger)("calc.runtime.interval: end",r),(0,Ibe.assertIndex)("calc.runtime.interval: start",e,r),{start:e,end:r}});var dU;(function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue"})(dU||(Or.CellKind=dU={}));var BY;(function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"})(BY||(Or.Interrupt=BY={}));Or.stackValue=(0,UY.typedInstanceCreator)()(function(e,r){return{label:e,value:r}});var tC;(function(e){e.LetVar="LetVar",e.LambdaRoot="LambdaRoot",e.LambdaParam="LambdaParam",e.EtaLambdaBody="EtaLambdaBody",e.FormulaRoot="FormulaRoot",e.FirstOrderFunc="FirstOrderFunc"})(tC||(Or.RuntimePositionKind=tC={}));var wbe;(function(e){e.Continue="Continue",e.Break="Break"})(wbe||(Or.StepAction=wbe={}));var Dbe;(function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"})(Dbe||(Or.LimitKind=Dbe={}));function Xcr(e,r,t){return{kind:Or.ReasonKind.IllFormedFormula,message:e,mode:r,diagnostics:t}}Or.illFormedFormula=Xcr;function Ycr(e){return{kind:dU.FinalValue,oper:e}}Or.finalValue=Ycr;function Jcr(e){return{kind:dU.PendingValue,anchor:e}}Or.pendingValue=Jcr;function Zcr(e,r){return{source:e,formula:r}}Or.cellWellFormedFormula=Zcr;function $cr(e,r){return{source:e,formula:r}}Or.cellFormula=$cr;Or.stopped={kind:Or.ReasonKind.Stopped};function edr(e,r){return{arity:e,func:r}}Or.userDefinedFunc=edr;function rdr(e,r,t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N,k,q,V,I,M,B,U,j,X,ee,re){return{config:e,getDocumentLoc:r,getSheetIndex:t,getSheetName:n,getSheetRangeIndexes:a,getNameLoc:o,getUserDefinedFuncLoc:u,getCellValue:s,getCellValues:l,getWorksheetFunc:c,getUserDefinedFunc:d,getNameFormula:f,getCellFormula:m,getUsedRange:v,interruptToken:[BY.Continue],tryGetHiddenRows:h,tryGetHiddenCols:y,isInFilterMode:_,getKnownFormat:E,getIformat:N,getFormatString:k,getRandom:q,getTime:V,schedulerConfig:ee??{},limits:re??{},setCellValue:I,setCellValues:M,setCellFailure:B,getContainingTable:U,getStructRefColumn:j,getStructRefSpecialRef:X,getIntersectingTables:function(){return(0,qx.failure)((0,Lbe.notImplemented)(["getIntersectingTables"]))}}}Or.evalGlobals=rdr;Or.evalLocals=(0,UY.typedInstanceCreator)()(function(e,r,t,n,a,o,u,s,l,c,d){return{lexicalSource:e,originGridCell:r,originSheet:t,calcingArray:n,reflectionGridCell:a,reflectionSheet:o,implicitIntersect:u,allowUnqualifiedCell:s,wrapCellReferences:l,followHyperlinks:c,contextNames:d}});function tdr(e){return{kind:Or.ReasonKind.NameCycle,names:e}}Or.nameCycle=tdr;function ndr(e){return{kind:Or.ReasonKind.CellCycle,cells:e}}Or.cellCycle=ndr;function adr(e){return{kind:Or.ReasonKind.PreviousFailure,range:e}}Or.previousFailure=adr;function idr(e){return{kind:Or.ReasonKind.PreviousNameFailure,name:e}}Or.previousNameFailure=idr;function odr(e){return{kind:Or.ReasonKind.LimitExceeded,limit:e}}Or.limitExceeded=odr;function udr(e){return{kind:qx.ResultKind.Paused,reason:Or.ReasonKind.Timeout,resume:e}}Or.paused=udr;function sdr(e){return{kind:qx.ResultKind.Breaked,resume:e}}Or.breaked=sdr;function ldr(e,r){return{kind:tC.LetVar,varNamePosition:e,varBinderPosition:r}}Or.runtimePositionLetVal=ldr;function cdr(e,r,t){return{kind:tC.LambdaRoot,lambdaNodePosition:e,head:r,args:t}}Or.runtimePositionLambdaRoot=cdr;function ddr(e,r,t){return{kind:tC.LambdaParam,idx:e,paramNodePosition:r,paramNamePosition:t}}Or.runtimePositionLambdaParam=ddr;function fdr(e){return{kind:tC.EtaLambdaBody,wsfId:e}}Or.runtimePositionEtaLambdaBody=fdr;Or.runtimePositionFormulaRoot={kind:tC.FormulaRoot};Or.runtimePositionFirstOrderFunc={kind:tC.FirstOrderFunc}});var H0=T(qp=>{"use strict";p();Object.defineProperty(qp,"__esModule",{value:!0});qp.recordNameCycle=qp.appendVisitedName=qp.emptyVisitedNames=qp.recordCellCycle=qp.appendVisitedCell=qp.emptyVisitedCells=void 0;var qbe=FF(),Gbe=Fm(),pdr=fi();function Bbe(e,r,t){return e===void 0?r===void 0?0:-1:r===void 0?1:t(e,r)}function fU(e,r){return e<r?-1:e===r?0:1}function Ube(e,r){return typeof e=="string"?typeof r!="string"?1:fU(e,r):typeof r=="string"||e<r?-1:e===r?0:1}function Kbe(e,r){var t;return(t=fU(e.name,r.name))!==0?t:Bbe(e.path,r.path,fU)}function mdr(e,r){var t;return(t=e.range.col-r.range.col)!==0||(t=e.range.row-r.range.row)!==0||(t=Ube(e.sheet.index,r.sheet.index))!==0?t:Kbe(e.sheet.document,r.sheet.document)}function gdr(e,r){var t;return(t=fU(e.name,r.name))!==0||(t=Bbe(e.scope.index,r.scope.index,Ube))!==0?t:Kbe(e.scope.document,r.scope.document)}function Vbe(e,r){return{current:e,map:r}}qp.emptyVisitedCells=Vbe(void 0,qbe.RedBlackMapTree.create(mdr));function vdr(e,r){return(0,pdr.assertTrue)("calc.runtime.appendVisitedCell",r.previous===e.current),Vbe(r,e.map.setValue(r.cell,r))}qp.appendVisitedCell=vdr;function hdr(e,r){for(var t=[],n=(0,Gbe.cellCycle)(t),a=r;t.push(a.cell),a.cycle=n,a!==e;a=a.previous);return t.reverse(),n}qp.recordCellCycle=hdr;function jbe(e,r){return{current:e,map:r}}qp.emptyVisitedNames=jbe(void 0,qbe.RedBlackMapTree.create(gdr));function Sdr(e,r){var t={name:r,previous:e.current};return jbe(t,e.map.setValue(r,t))}qp.appendVisitedName=Sdr;function ydr(e,r){for(var t=[],n=r;t.push(n.name),n!==e;n=n.previous);return t.reverse(),(0,Gbe.nameCycle)(t)}qp.recordNameCycle=ydr});var Nm=T(qa=>{"use strict";p();Object.defineProperty(qa,"__esModule",{value:!0});qa.transposeSparseArray2D=qa.transposeArray2D=qa.sparseArray2DTo1D=qa.singletonArray2D=qa.rowArray2D=qa.jaggedArray=qa.constantArray2D=qa.constantArray=qa.colArray2D=qa.broadcastArray2D=qa.broadcastArray=qa.array2DToJaggedArray=qa.array2DForall2=qa.array2DForall=qa.StrictSparseArray2D=qa.StrictArray2D=qa.NonstrictSparseArray2D=qa.NonstrictArray2D=void 0;var Wc=pr();qa.NonstrictArray2D=Wc.arrayUtils.NonstrictArray2D;qa.NonstrictSparseArray2D=Wc.arrayUtils.NonstrictSparseArray2D;qa.StrictArray2D=Wc.arrayUtils.StrictArray2D;qa.StrictSparseArray2D=Wc.arrayUtils.StrictSparseArray2D;qa.array2DForall=Wc.arrayUtils.array2DForall;qa.array2DForall2=Wc.arrayUtils.array2DForall2;qa.array2DToJaggedArray=Wc.arrayUtils.array2DToJaggedArray;qa.broadcastArray=Wc.arrayUtils.broadcastArray;qa.broadcastArray2D=Wc.arrayUtils.broadcastArray2D;qa.colArray2D=Wc.arrayUtils.colArray2D;qa.constantArray=Wc.arrayUtils.constantArray;qa.constantArray2D=Wc.arrayUtils.constantArray2D;qa.jaggedArray=Wc.arrayUtils.jaggedArray;qa.rowArray2D=Wc.arrayUtils.rowArray2D;qa.singletonArray2D=Wc.arrayUtils.singletonArray2D;qa.sparseArray2DTo1D=Wc.arrayUtils.sparseArray2DTo1D;qa.transposeArray2D=Wc.arrayUtils.transposeArray2D;qa.transposeSparseArray2D=Wc.arrayUtils.transposeSparseArray2D});var Ua=T(vn=>{"use strict";p();Object.defineProperty(vn,"__esModule",{value:!0});vn.calcErrorOper=vn.valueErrorOper=vn.trueOper=vn.stringOper=vn.refErrorOper=vn.rangeSeqOper=vn.range3DOper=vn.precedents=vn.numErrorOper=vn.nullErrorOper=vn.nameErrorOper=vn.naErrorOper=vn.missingOper=vn.gettingDataErrorOper=vn.fieldErrorOper=vn.falseOper=vn.errorOper=vn.div0ErrorOper=vn.cellStringLimit=vn.booleanOper=vn.blankOper=vn.arrayOper=vn.PrecsBound=vn.ErrorType=void 0;var Wu=qr();vn.ErrorType=Wu.value.ErrorType;vn.PrecsBound=Wu.value.PrecsBound;vn.arrayOper=Wu.value.arrayOper;vn.blankOper=Wu.value.blankOper;vn.booleanOper=Wu.value.booleanOper;vn.cellStringLimit=Wu.value.cellStringLimit;vn.div0ErrorOper=Wu.value.div0ErrorOper;vn.errorOper=Wu.value.errorOper;vn.falseOper=Wu.value.falseOper;vn.fieldErrorOper=Wu.value.fieldErrorOper;vn.gettingDataErrorOper=Wu.value.gettingDataErrorOper;vn.missingOper=Wu.value.missingOper;vn.naErrorOper=Wu.value.naErrorOper;vn.nameErrorOper=Wu.value.nameErrorOper;vn.nullErrorOper=Wu.value.nullErrorOper;vn.numErrorOper=Wu.value.numErrorOper;vn.precedents=Wu.value.precedents;vn.range3DOper=Wu.value.range3DOper;vn.rangeSeqOper=Wu.value.rangeSeqOper;vn.refErrorOper=Wu.value.refErrorOper;vn.stringOper=Wu.value.stringOper;vn.trueOper=Wu.value.trueOper;vn.valueErrorOper=Wu.value.valueErrorOper;vn.calcErrorOper=Wu.value.calcErrorOper});var KY=T(Ll=>{"use strict";p();Object.defineProperty(Ll,"__esModule",{value:!0});Ll.breakTransition=Ll.nextTransition=Ll.nextOnSuccessReceiver=Ll.callMachineTransition=Ll.TransitionKind=Ll.MachineRuntime=Ll.MachineCycle=Ll.VoidMachine=Ll.AllMachine=void 0;var By=pr();Ll.AllMachine=By.machine.AllMachine;Ll.VoidMachine=By.machine.VoidMachine;Ll.MachineCycle=By.machine.MachineCycle;Ll.MachineRuntime=By.machine.MachineRuntime;Ll.TransitionKind=By.machine.TransitionKind;Ll.callMachineTransition=By.machine.callMachineTransition;Ll.nextOnSuccessReceiver=By.machine.nextOnSuccessReceiver;Ll.nextTransition=By.machine.nextTransition;Ll.breakTransition=By.machine.breakTransition});var au=T(Kg=>{"use strict";p();Object.defineProperty(Kg,"__esModule",{value:!0});Kg.functionType=Kg.SpecialPrecs=Kg.SignatureType=Kg.OperKind=Kg.FunctionFlags=void 0;var Gx=qr();Kg.FunctionFlags=Gx.types.FunctionFlags;Kg.OperKind=Gx.types.OperKind;Kg.SignatureType=Gx.types.SignatureType;Kg.SpecialPrecs=Gx.types.SpecialPrecs;Kg.functionType=Gx.types.functionType});var oc=T(Hu=>{"use strict";p();Object.defineProperty(Hu,"__esModule",{value:!0});Hu.refToVal=Hu.ArrayMachine=Hu.earlyReturn=Hu.EarlyReturnKind=Hu.ThenMachine=Hu.isMachineCall=Hu.machineCall=Hu.MachineCallKind=Hu.readOperType=Hu.singleReadOperType=void 0;var _dr=fe(),VY=Ua(),OF=KY(),pU=Na(),nC=Dl(),Om=au();_dr.__exportStar(KY(),Hu);Hu.singleReadOperType=Om.OperKind.Number|Om.OperKind.String|Om.OperKind.Boolean|Om.OperKind.Error|Om.OperKind.Blank|Om.OperKind.Rich;Hu.readOperType=Hu.singleReadOperType|Om.OperKind.Array;var mU;(function(e){e.MachineCall="MachineCall"})(mU||(Hu.MachineCallKind=mU={}));function bdr(e){return{kind:mU.MachineCall,machine:e}}Hu.machineCall=bdr;function gU(e){return e.kind===mU.MachineCall}Hu.isMachineCall=gU;var Cdr=function(){function e(r,t,n){this.context=r,this.f1=t,this.f2=n,this.runStatus=!1,this.oper1=void 0,this.oper2=void 0}return e.prototype.next=function(){var r;try{if(this.oper1===void 0){var t=this.f1();if(gU(t))return(0,OF.callMachineTransition)(t.machine,this);this.oper1=t}if(this.oper2===void 0){var n=this.f2(this.oper1);if(gU(n))return(0,OF.callMachineTransition)(n.machine,this);this.oper2=n}return(0,nC.success)(this.oper2)}catch(a){return(r=this.context.handleEvaluationError(a))!==null&&r!==void 0?r:(0,nC.failure)((0,nC.javaScriptError)(a))}},e.prototype.receiveResult=function(r){return(0,nC.isSuccess)(r)?(this.oper1===void 0?this.oper1=r.value:this.oper2===void 0&&(this.oper2=r.value),OF.nextTransition):r},e}();Hu.ThenMachine=Cdr;var vU;(function(e){e.EarlyReturn="EarlyReturn"})(vU||(Hu.EarlyReturnKind=vU={}));function Tdr(e){return{kind:vU.EarlyReturn,value:e}}Hu.earlyReturn=Tdr;var Rdr=function(){function e(r,t,n,a,o){this.context=r,this.rows=t,this.cols=n,this.func=a,this.coercer=o,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var r;try{if(this.toDeref!==void 0){var t=this.coercer(this.toDeref,this.opers.length,this.row.length);if(t.kind===vU.EarlyReturn)return t.value;this.row.push(t),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return(0,nC.success)((0,VY.arrayOper)(this.rows,this.cols,this.opers));var n=this.func(this.opers.length,this.row.length);return gU(n)?(0,OF.callMachineTransition)(n.machine,this):(this.toDeref=n,OF.nextTransition)}catch(a){return(r=this.context.handleEvaluationError(a))!==null&&r!==void 0?r:(0,nC.failure)((0,nC.javaScriptError)(a))}},e.prototype.receiveResult=function(r){return(0,nC.isSuccess)(r)?(this.toDeref=r.value,OF.nextTransition):r},e}();Hu.ArrayMachine=Rdr;function Edr(e,r,t){if(!(0,pU.isRangeOper)(r))return r;if(!(0,pU.isSheetIndex)(r.sheets))return VY.valueErrorOper;if(!t)return r.ranges.length===1&&(0,pU.isGridCell)(r.ranges[0])?e.dereferenceOper(r,Om.SignatureType.All&~Om.OperKind.Range):e.dereferenceOper(r,Om.OperKind.Array);var n=e.dereferenceOper(r,Om.SignatureType.All&~(Om.OperKind.Range|Om.OperKind.Array));return(0,pU.isArrayOper)(n)?VY.naErrorOper:n}Hu.refToVal=Edr});var kF=T(Et=>{"use strict";p();Object.defineProperty(Et,"__esModule",{value:!0});Et.ulsLogger=Et.operatorIdToName=Et.localeInfo=Et.isNumeral=Et.getOrdinal=Et.getNumberShape=Et.getEnglishWorksheetFuncIdToName=Et.getEnglishLocaleInfo=Et.englishWorksheetFuncIdToName=Et.englishSysTimeFormat=Et.englishSysDateFormat=Et.englishSpecialRefNames=Et.englishPictureSpecial=Et.englishPictureSingle=Et.englishPictureDbnum=Et.englishPictureColor=Et.englishOperatorIdToName=Et.englishErrorTypeToName=Et.englishErrorNames=Et.createWorksheetFuncNameCallbacks=Et.calcConfig=Et.TraceLevel=Et.PictureSpecial=Et.PictureSingle=Et.PictureDbnum=Et.PictureColor=Et.NulLogger=Et.LogCategory=Et.LCID=Et.Country=void 0;var ao=qr();Et.Country=ao.config.Country;Et.LCID=ao.config.LCID;Et.LogCategory=ao.config.LogCategory;Et.NulLogger=ao.config.NulLogger;Et.PictureColor=ao.config.PictureColor;Et.PictureDbnum=ao.config.PictureDbnum;Et.PictureSingle=ao.config.PictureSingle;Et.PictureSpecial=ao.config.PictureSpecial;Et.TraceLevel=ao.config.TraceLevel;Et.calcConfig=ao.config.calcConfig;Et.createWorksheetFuncNameCallbacks=ao.config.createWorksheetFuncNameCallbacks;Et.englishErrorNames=ao.config.englishErrorNames;Et.englishErrorTypeToName=ao.config.englishErrorTypeToName;Et.englishOperatorIdToName=ao.config.englishOperatorIdToName;Et.englishPictureColor=ao.config.englishPictureColor;Et.englishPictureDbnum=ao.config.englishPictureDbnum;Et.englishPictureSingle=ao.config.englishPictureSingle;Et.englishPictureSpecial=ao.config.englishPictureSpecial;Et.englishSpecialRefNames=ao.config.englishSpecialRefNames;Et.englishSysDateFormat=ao.config.englishSysDateFormat;Et.englishSysTimeFormat=ao.config.englishSysTimeFormat;Et.englishWorksheetFuncIdToName=ao.config.englishWorksheetFuncIdToName;Et.getEnglishLocaleInfo=ao.config.getEnglishLocaleInfo;Et.getEnglishWorksheetFuncIdToName=ao.config.getEnglishWorksheetFuncIdToName;Et.getNumberShape=ao.config.getNumberShape;Et.getOrdinal=ao.config.getOrdinal;Et.isNumeral=ao.config.isNumeral;Et.localeInfo=ao.config.localeInfo;Et.operatorIdToName=ao.config.operatorIdToName;Et.ulsLogger=ao.config.ulsLogger});var uc=T(ll=>{"use strict";p();Object.defineProperty(ll,"__esModule",{value:!0});ll.arrayLift=ll.makeStrict=ll.gridRangeAnchorHash=ll.broadcastWriteOper=ll.isEmptyStringOper=ll.emptyStringOper=ll.traceErrorOper=ll.writeOperType=ll.singleWriteOperType=void 0;var aC=Nm(),yU=Ua(),iC=Na(),Pdr=fs(),hU=Il(),SU=oc(),rp=au(),Hbe=fi(),Wbe=kF();ll.singleWriteOperType=rp.OperKind.Number|rp.OperKind.String|rp.OperKind.Boolean|rp.OperKind.Error|rp.OperKind.Rich;ll.writeOperType=ll.singleWriteOperType|rp.OperKind.Array;function Adr(e,r,t){var n="".concat(e,": generated Excel error, type ").concat(r,"; ").concat(t);Hbe.ulsLogger.ULS.traceTag(596120270,Wbe.LogCategory.msoulscat_ES_EWAJS,Wbe.TraceLevel.Verbose,n)}ll.traceErrorOper=Adr;ll.emptyStringOper=(0,yU.stringOper)("");function Fdr(e){return(0,iC.isStringOper)(e)&&e.value===""}ll.isEmptyStringOper=Fdr;function Ndr(e,r,t){var n=(0,iC.isArrayOper)(t)?(0,aC.broadcastArray)(t.rows,t.cols,e,r,t.opers,yU.naErrorOper):(0,aC.constantArray)(e,r,t);return(0,yU.arrayOper)(e,r,n)}ll.broadcastWriteOper=Ndr;function Odr(e){return Pdr.sheetCols*e.row+e.col}ll.gridRangeAnchorHash=Odr;function kdr(e){var r=function(n){return n&~(rp.OperKind.Array|rp.OperKind.Range)};return(0,rp.functionType)(e.minArgs,e.maxArgs,e.headTypes.map(r),e.restTypes.map(r),e.tailTypes.map(r),e.returnType,e.staticPrecs,e.flags)}ll.makeStrict=kdr;function Mdr(e,r,t,n,a){switch(n.kind){case rp.OperKind.Missing:case rp.OperKind.Blank:return(0,aC.constantArray2D)(r,t,e.zero);case rp.OperKind.Array:return a&rp.OperKind.Array?(0,aC.constantArray2D)(r,t,n):(0,aC.broadcastArray2D)(r,t,new aC.StrictArray2D(n.rows,n.cols,n.opers),yU.naErrorOper);case rp.OperKind.Range:return(0,aC.constantArray2D)(r,t,n);default:return(0,aC.constantArray2D)(r,t,n)}}function xdr(e,r,t,n){for(var a=0,o=0,u=0;u<n.length;u+=1){var s=n[u];(0,iC.isArrayOper)(s)&&!((0,iC.getArgType)(r,u,n.length)&rp.OperKind.Array)?(a=(0,hU.fastMax)(a,s.rows),o=(0,hU.fastMax)(o,s.cols)):(a=(0,hU.fastMax)(a,1),o=(0,hU.fastMax)(o,1))}var l=n.map(function(c,d,f){return Mdr(e.mathpack,a,o,c,(0,iC.getArgType)(r,d,f.length))});return(0,SU.machineCall)(new SU.ArrayMachine(e,a,o,function(c,d){return t(l.map(function(f){return f.get(c,d)}))},function(c){var d=e.coerceOper((0,SU.refToVal)(e,c,!0),SU.readOperType);return(0,Hbe.assertTrue)("calc.runtime.arrayLift",!(0,iC.isMissingOper)(d)&&!(0,iC.isRangeOper)(d)),(0,iC.isArrayOper)(d)?d.opers[0][0]:d}))}ll.arrayLift=xdr});var eCe=T(Cd=>{"use strict";p();Object.defineProperty(Cd,"__esModule",{value:!0});Cd.IterativeRecalcState=Cd.cellRead=Cd.cellWrite=Cd.rangeWrite=Cd.TransactionLogMessageKind=Cd.TransactionLog=Cd.WriteResultKind=void 0;var zbe=fe(),Qbe=fs(),Idr=qY(),Ybe=Il(),_U=H0(),Xbe=uc(),wdr=Na(),Ah;(function(e){e[e.Next=0]="Next",e[e.Done=1]="Done",e[e.CellWriteLimitReached=2]="CellWriteLimitReached",e[e.CellCycle=3]="CellCycle"})(Ah||(Cd.WriteResultKind=Ah={}));var Ddr=function(){function e(r){this.state=r}return e.prototype.forEachMeets=function(r,t){var n=this.state[r.sheet.index];n!==void 0&&n.forEachMeets(r.range,t)},e.prototype.setValue=function(r,t){var n,a,o=(a=this.state[r.sheet.index])!==null&&a!==void 0?a:(0,Idr.makeGridRangeTable)();return new e(zbe.__assign(zbe.__assign({},this.state),(n={},n[r.sheet.index]=o.setValue(r.range,t),n)))},e.empty=function(){return new e({})},e}(),Jbe=function(){function e(){this.log=[]}return e.prototype.extract=function(){return this.log},e.prototype.lookup=function(r){var t=[];return this.current!==void 0&&(this.current.previousVersions.forEachMeets(r,function(n,a){return t.push(a),!0}),e.meets(r,this.current.range)&&t.push(this.current)),t},Object.defineProperty(e.prototype,"current",{get:function(){return this.log[this.log.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.log.length},enumerable:!1,configurable:!0}),e.prototype.insert=function(r,t){if(this.current===void 0){this.log.push({version:0,range:r,message:t,previousVersions:Ddr.empty()});return}var n={version:this.current.version+1,range:r,message:t,previousVersions:this.current.previousVersions.setValue(this.current.range,this.current)};this.log.push(n)},e.prototype.rollBack=function(r){if(this.current===void 0)return!1;var t=void 0;return this.current.previousVersions.forEachMeets(r,function(n,a){return(t===void 0||a.version<t.version)&&(t=a),!0}),t===void 0?e.meets(r,this.current.range)?(this.truncLog(this.log.length-1),!0):!1:(this.truncLog(t.version),!0)},e.prototype.truncLog=function(r){this.log.length=(0,Ybe.fastMax)(r,0)},e.meets=function(r,t){return r.sheet.index!==t.sheet.index?!1:(0,wdr.gridRangeIsects)(r.range,t.range)},e}();Cd.TransactionLog=Jbe;var uR;(function(e){e[e.RangeWrite=0]="RangeWrite",e[e.CellWrite=1]="CellWrite",e[e.CellRead=2]="CellRead"})(uR||(Cd.TransactionLogMessageKind=uR={}));function Zbe(e,r){return{kind:uR.RangeWrite,range:e,opers:r}}Cd.rangeWrite=Zbe;function $be(e,r){return{kind:uR.CellWrite,cell:e,oper:r}}Cd.cellWrite=$be;Cd.cellRead={kind:uR.CellRead};var Ldr={kind:Ah.CellWriteLimitReached},qdr=function(){function e(r){this.transactionLog=new Jbe,this.anchorVisitCounts={},this.workStack=[[r,_U.emptyVisitedCells]]}return e.prototype.registerVisibleCells=function(r){for(var t=0,n=r;t<n.length;t++){var a=n[t];this.ensureNeedsVisit(a)}return{kind:Ah.Next,address:this.address}},e.prototype.registerDynamicDependency=function(r){for(var t=0,n=r;t<n.length;t++){var a=n[t],o={cell:a,previous:this.visitedCells.current,cycle:void 0},u=this.visitedCells.map.getValue(a);if(u!==void 0)return(0,_U.recordCellCycle)(u,this.visitedCells.current),{kind:Ah.CellCycle,cycle:u.cycle};this.workStack.push([a,(0,_U.appendVisitedCell)(this.visitedCells,o)]),this.ensureNeedsVisit(a)}return{kind:Ah.Next,address:this.address}},e.prototype.registerRead=function(){return this.transactionLog.lookup(this.address).length===0&&this.transactionLog.insert(this.address,Cd.cellRead),this.next()},e.prototype.writeRange=function(r){var t=this.address,n=t.sheet,a=t.range,o=a.row,u=a.col,s=(0,Qbe.sheetGridRange)(n,(0,Qbe.gridRange)(o,u,r.length,r[0].length));return this.write(s,Zbe(s,r))},e.prototype.writeCell=function(r){return this.write(this.address,$be(this.address,r))},Object.defineProperty(e.prototype,"address",{get:function(){return this.workStack[this.workStack.length-1][0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visitedCells",{get:function(){return this.workStack[this.workStack.length-1][1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){return this.transactionLog},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remainingWork",{get:function(){return this.workStack},enumerable:!1,configurable:!0}),e.prototype.incrementCellWriteCount=function(r){var t=this.ensureNeedsVisit(r);if(t[1]+=1,t[1]>10)return Ldr},e.prototype.ensureNeedsVisit=function(r){var t,n=this.anchorVisitCounts[r.sheet.index];return n===void 0&&(n=this.anchorVisitCounts[r.sheet.index]={}),n[(0,Xbe.gridRangeAnchorHash)(r.range)]=(t=n[(0,Xbe.gridRangeAnchorHash)(r.range)])!==null&&t!==void 0?t:[r,0]},e.prototype.write=function(r,t){if(this.transactionLog.rollBack(r))return{kind:Ah.Next,address:this.address};var n=this.incrementCellWriteCount(this.address);return n!==void 0?n:(this.transactionLog.insert(r,t),this.next())},e.prototype.next=function(){for(;this.workStack.length>1;)if(this.workStack.pop(),this.transactionLog.lookup(this.address).length===0)return{kind:Ah.Next,address:this.address};if(this.transactionLog.lookup(this.address).length===0)return{kind:Ah.Next,address:this.address};var r=this.unevaluatedVisibleRanges();if((0,Ybe.safePush)(this.workStack,r),r.length>0)return{kind:Ah.Next,address:this.address};for(var t=[],n=[],a=0,o=this.transactionLog.extract();a<o.length;a++){var u=o[a];switch(u.message.kind){case uR.CellWrite:t.push([u.message.cell,u.message.oper]);break;case uR.RangeWrite:n.push([u.range,u.message.opers]);break}}return{kind:Ah.Done,cellWrites:t,rangeWrites:n}},e.prototype.unevaluatedVisibleRanges=function(){var r=[];for(var t in this.anchorVisitCounts)for(var n in this.anchorVisitCounts[t]){var a=this.anchorVisitCounts[t][n][0];this.transactionLog.lookup(a).length===0&&r.push([a,_U.emptyVisitedCells])}return r},e}();Cd.IterativeRecalcState=qdr});var qo=T(la=>{"use strict";p();Object.defineProperty(la,"__esModule",{value:!0});la.CellEvaluationResultKind=la.ES5IterableStackFrame=la.ES5IterableStackValue=la.stackFrameList=la.stackMapList=la.emptyStackEnv=la.LazyOper=la.evalLocalsSlice=la.evalLocalsFirstOrderFunc=la.evalLocalsLambda=la.evalLocalsName=la.evalLocalsGrid=la.evalUsage=la.bottomEvalPrecedents=la.handleEvaluationError=la.throwEvaluationError=la.EvaluationError=la.unevaluated=la.RuntimeInternalReasonKind=void 0;var nCe=fe(),Uy=Fm(),jY=Na(),rCe=fs(),Gdr=fi(),tCe=Ua(),bU=oc(),Bdr=au(),km=Dl(),Udr=FF(),CU;(function(e){e.Unevaluated="Unevaluated"})(CU||(la.RuntimeInternalReasonKind=CU={}));function Kdr(e){return e.length===0&&(0,Gdr.assertFalse)("calc.runtime.unevaluated: expected nonempty array"),{kind:CU.Unevaluated,anchors:e}}la.unevaluated=Kdr;la.EvaluationError=(0,jY.createFailureErrorClass)("EvaluationError");function aCe(e){throw new la.EvaluationError(e)}la.throwEvaluationError=aCe;var Vdr=function(){function e(r){this.machine=r,this.runStatus=!1}return e.prototype.next=function(){return(0,bU.callMachineTransition)(this.machine,this)},e.prototype.receiveResult=function(r){if(!(0,km.isSuccess)(r))return r;switch(r.value.kind){case TU.ReadFailure:return r.value.failure;case TU.WroteFailure:return(0,km.failure)((0,Uy.previousFailure)(r.value.source.range))}return km.successUndefined},e}();function jdr(e,r,t){var n;switch(t.kind){case CU.Unevaluated:{if(r.map.getCount()+1>((n=e.globals.limits.maxCellChain)!==null&&n!==void 0?n:1/0))return(0,km.failure)((0,Uy.limitExceeded)(Uy.LimitKind.CellChain));var a=t.anchors.map(function(o){return new Vdr(e.createCellEvaluationMachine(e,void 0,r,o))});return(0,bU.callMachineTransition)(new bU.AllMachine(a),(0,bU.nextOnSuccessReceiver)())}default:return(0,km.failure)(t)}}la.handleEvaluationError=jdr;function Wdr(){return(0,tCe.precedents)([],[],[],Bdr.SpecialPrecs.None,tCe.PrecsBound.Lower)}la.bottomEvalPrecedents=Wdr;function Hdr(e,r){return{lambdaCalls:e,lambdaDepth:r}}la.evalUsage=Hdr;function zdr(e){var r=(0,jY.sheetGridRangeAnchor)(e.range),t=(0,km.success)(r.range),n=(0,km.success)(r.sheet);return(0,Uy.evalLocals)(e,t,n,e.kind===rCe.LexicalKind.Range,t,n,e.kind===rCe.LexicalKind.Cell,!0,!1,(0,km.success)(!1),void 0)}la.evalLocalsGrid=zdr;function Qdr(e,r){var t=e.name.scope,n;if(t.index!==void 0)n=(0,km.success)(t);else{var a=r.originSheet;if(!(0,km.isSuccess)(a))return aCe(a.reason);n=(0,jY.isDocumentLocEqual)(a.value.document,t.document)?a:(0,km.success)(t)}var o=r.originGridCell;return(0,Uy.evalLocals)(e,o,n,r.calcingArray,o,n,!1,!1,!0,(0,km.success)(!1),void 0)}la.evalLocalsName=Qdr;function Xdr(e,r){return(0,Uy.evalLocals)(e.lexicalSource,e.originGridCell,e.originSheet,r.calcingArray,r.reflectionGridCell,r.reflectionSheet,r.implicitIntersect,e.allowUnqualifiedCell,e.wrapCellReferences,(0,km.success)(!1),void 0)}la.evalLocalsLambda=Xdr;function Ydr(e,r){var t=r.originGridCell,n=r.originSheet,a=r.calcingArray,o=r.reflectionGridCell,u=r.reflectionSheet,s=r.implicitIntersect,l=r.allowUnqualifiedCell,c=r.wrapCellReferences,d=r.followHyperlinks;return(0,Uy.evalLocals)(e,t,n,a,o,u,s,l,c,d,void 0)}la.evalLocalsFirstOrderFunc=Ydr;function Jdr(e){var r=e.lexicalSource,t=e.originGridCell,n=e.originSheet,a=e.calcingArray,o=e.reflectionGridCell,u=e.reflectionSheet,s=e.implicitIntersect,l=e.allowUnqualifiedCell,c=e.wrapCellReferences,d=e.followHyperlinks,f=e.contextNames;return(0,Uy.evalLocals)(r,t,n,a,o,u,s,l,c,d,f)}la.evalLocalsSlice=Jdr;var iCe=function(){function e(r){this.fallback=r}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value===void 0?this.fallback():this._value},set:function(t){this._value=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueOrUndefined",{get:function(){return this._value},enumerable:!1,configurable:!0}),e}();la.LazyOper=iCe;la.emptyStackEnv=Udr.RedBlackMapTree.create(function(e,r){return e-r});function Zdr(e,r,t){return{labels:e,numPushed:r,next:t}}la.stackMapList=Zdr;function $dr(e,r,t,n,a){var o;return{stackDepth:1+((o=a==null?void 0:a.stackDepth)!==null&&o!==void 0?o:0),lexicalSource:e,position:r,localValues:new oCe(t,n),caller:a}}la.stackFrameList=$dr;var oCe=function(){function e(r,t){this.stackEnv=r,this.stackMap=t}return e.prototype.iterator=function(){var r,t,n,a,o,u;return nCe.__generator(this,function(s){switch(s.label){case 0:r=this.stackEnv.getCount()-1,t=this.stackMap,s.label=1;case 1:if(t===void 0)return[3,6];n=t.numPushed-1,s.label=2;case 2:return n>=0?(a=t.labels[n],o=this.stackEnv.getValue(r--),a===void 0||o===void 0?[3,4]:(u=o instanceof iCe?o.valueOrUndefined:o,u===void 0?[3,4]:[4,(0,Uy.stackValue)(a,u)])):[3,5];case 3:s.sent(),s.label=4;case 4:return n--,[3,2];case 5:return t=t.next,[3,1];case 6:return[2]}})},e}();la.ES5IterableStackValue=oCe;var efr=function(){function e(r){this.leafFrame=r}return e.prototype.iterator=function(){var r;return nCe.__generator(this,function(t){switch(t.label){case 0:r=this.leafFrame,t.label=1;case 1:return r===void 0?[3,4]:[4,r];case 2:t.sent(),t.label=3;case 3:return r=r.caller,[3,1];case 4:return[2]}})},e}();la.ES5IterableStackFrame=efr;var TU;(function(e){e[e.ReadFailure=0]="ReadFailure",e[e.ReadOper=1]="ReadOper",e[e.WroteFailure=2]="WroteFailure",e[e.WroteOper=3]="WroteOper"})(TU||(la.CellEvaluationResultKind=TU={}))});var Ky=T(Hc=>{"use strict";p();Object.defineProperty(Hc,"__esModule",{value:!0});Hc.setFeatureGateDictionaryGetter=Hc.overrideTypedFeatureGates=Hc.isTypedChangeGateEnabled=Hc.getTypedFeatureGate=Hc.getFeatures=Hc.isFeatureEnabled=Hc.initFeatureConfiguration=Hc.FeatureName=void 0;var MF=pr();Hc.FeatureName=MF.featureConfiguration.FeatureName;Hc.initFeatureConfiguration=MF.featureConfiguration.initFeatureConfiguration;Hc.isFeatureEnabled=MF.featureConfiguration.isFeatureEnabled;Hc.getFeatures=MF.featureConfiguration.getFeatures;Hc.getTypedFeatureGate=MF.featureConfiguration.getTypedFeatureGate;Hc.isTypedChangeGateEnabled=MF.featureConfiguration.isTypedChangeGateEnabled;var uCe=mi();Object.defineProperty(Hc,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return uCe.overrideTypedFeatureGates}});Object.defineProperty(Hc,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return uCe.setFeatureGateDictionaryGetter}})});var EU=T(RU=>{"use strict";p();Object.defineProperty(RU,"__esModule",{value:!0});RU.coerceOper=void 0;var rfr=uc(),tfr=qo(),ql=au(),sc=Ua(),nfr=NF(),Bx=Na(),afr=Dl(),ifr=uc(),ofr=fi(),ufr=Ky();function sCe(e,r){return r&ql.OperKind.Number?e.zero:r&ql.OperKind.String?ifr.emptyStringOper:r&ql.OperKind.Boolean?sc.falseOper:sc.valueErrorOper}function lCe(e,r,t){var n=e.globals.config,a=n.localeInfo,o=n.mathpack;if(t&r.kind)return r;if((0,Bx.isNumberOper)(r)){if(t&ql.OperKind.String){var u=20;return(0,sc.stringOper)(o.formatGeneral(a,r,u))}return t&ql.OperKind.Boolean?(0,sc.booleanOper)(o.cond(r)!==0):t&ql.OperKind.Array?(0,sc.arrayOper)(1,1,[[r]]):sc.valueErrorOper}if((0,Bx.isStringOper)(r)){if(t&ql.OperKind.Number){if(r.value.length===0||r.value.length>255)return sc.valueErrorOper;var s=e.numberFormatter.parseGeneral(r.value,!1,!0,nfr.GetTimeKind.NonVolatile);return(0,afr.isSuccess)(s)||(0,tfr.throwEvaluationError)(s.reason),s.value!==void 0?s.value.value:sc.valueErrorOper}if(t&ql.OperKind.Boolean){if(a.stringCompareCI(r.value,a.trueName)===0)return sc.trueOper;if(a.stringCompareCI(r.value,a.falseName)===0)return sc.falseOper}return t&ql.OperKind.Array?(0,sc.arrayOper)(1,1,[[r]]):sc.valueErrorOper}if((0,Bx.isBooleanOper)(r))return t&ql.OperKind.Number?r.value?o.one:o.zero:t&ql.OperKind.String?(0,sc.stringOper)(r.value?a.trueName:a.falseName):t&ql.OperKind.Array?(0,sc.arrayOper)(1,1,[[r]]):sc.valueErrorOper;switch(r.kind){case ql.OperKind.Error:return r;case ql.OperKind.Missing:return t&ql.OperKind.Blank?sc.blankOper:sCe(o,t);case ql.OperKind.Blank:return sCe(o,t);case ql.OperKind.Rich:return(0,ufr.getTypedFeatureGate)("Microsoft.Office.Excel.CalcTsDec2023Funcs")&&t&ql.OperKind.Array?(0,sc.arrayOper)(1,1,[[r]]):lCe(e,r.getFallback(),t);case ql.OperKind.Range:case ql.OperKind.Array:return sc.valueErrorOper;default:return(0,ofr.assertNever)("calc.runtime.coerceOper",r)}}function sfr(e,r,t){var n=lCe(e,r,t);return(0,Bx.isErrorOper)(n)&&!(0,Bx.isErrorOper)(r)&&(0,rfr.traceErrorOper)("calc.runtime.coerceOper",n.type,"kind = ".concat(r.kind)),n}RU.coerceOper=sfr});var Vy=T(z0=>{"use strict";p();Object.defineProperty(z0,"__esModule",{value:!0});z0.kindAnonymizers=z0.anonymizeMagnitude=z0.anonymizeFormulaString=z0.anonymize=void 0;var PU=pr();z0.anonymize=PU.anonymizer.anonymize;z0.anonymizeFormulaString=PU.anonymizer.anonymizeFormulaString;z0.anonymizeMagnitude=PU.anonymizer.anonymizeMagnitude;z0.kindAnonymizers=PU.anonymizer.kindAnonymizers});var Ux=T(AU=>{"use strict";p();Object.defineProperty(AU,"__esModule",{value:!0});AU.Pledge=void 0;var lfr=pr();AU.Pledge=lfr.pledge.Pledge});var Q0=T(hn=>{"use strict";p();var WY,HY;Object.defineProperty(hn,"__esModule",{value:!0});hn.transformBottomUp=hn.isOperTerm=hn.postStepTerm=hn.callMachineTerm=hn.callFirstOrderFuncTerm=hn.callLambdaTerm=hn.callNameTerm=hn.noopTerm=hn.conditionalTerm=hn.readStackTerm=hn.structRefTerm=hn.cellRefTerm=hn.udfTerm=hn.nameTerm=hn.appTerm=hn.letTerm=hn.lambdaTerm=hn.arrayTerm=hn.isOperatorName=hn.worksheetFunctionNameToId=hn.worksheetFunctionIdToName=hn.operatorNameToId=hn.operatorIdToName=hn.TermKind=void 0;var zY=fe(),FU=Il(),NU=fi(),Vg=Ux(),bo;(function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.Conditional=-2147483640]="Conditional",e[e.StructRef=-2147483639]="StructRef",e[e.Noop=-2147483638]="Noop",e[e.CallLambda=-2147483637]="CallLambda",e[e.CallName=-2147483636]="CallName",e[e.CallFirstOrderFunc=-2147483635]="CallFirstOrderFunc",e[e.CallMachine=-2147483634]="CallMachine",e[e.PostStep=-2147483633]="PostStep"})(bo||(hn.TermKind=bo={}));hn.operatorIdToName=(WY=(0,FU.makeNewtypeIso)(FU.identity,FU.identity),WY.wrap),hn.operatorNameToId=WY.unwrap;hn.worksheetFunctionIdToName=(HY=(0,FU.makeNewtypeIso)(function(e){return-e},function(e){return-e}),HY.wrap),hn.worksheetFunctionNameToId=HY.unwrap;function cfr(e){return e>0}hn.isOperatorName=cfr;function gf(e,r){var t={kind:e,data:void 0,children:void 0,position:r};return t}function cCe(e,r,t,n){var a=gf(bo.Array,n);return a.children=t,a.data={rows:e,cols:r},a}hn.arrayTerm=cCe;function dCe(e,r,t,n){(0,NU.assertTrue)("calc.runtime.lambdaTerm: defsAndBody",t.length===1+r.reduce(function(o,u){return o+(u.hasDef?1:0)},0)),(0,NU.assertTrue)("calc.runtime.lambdaTerm: params",r.every(function(o,u,s){return!(o.hasDef&&o.isRest)&&(!o.isRest||u===s.length-1)}));var a=gf(bo.Lambda,n);return a.children=t,a.data={checkArity:e,params:r},a}hn.lambdaTerm=dCe;function fCe(e,r,t,n,a){(0,NU.assertTrue)("calc.runtime.letTerm",e.length===t.length);var o=gf(bo.Let,a);return o.children=zY.__spreadArray(zY.__spreadArray([],e,!0),[n],!1),o.data={rec:r,varLabels:t},o}hn.letTerm=fCe;var pCe=[];function mCe(e,r,t,n,a,o){n===void 0&&(n=pCe);var u=gf(bo.App,o);return u.children=a,u.data={funName:e,funType:r,isFormulaRoot:t,args:n},u}hn.appTerm=mCe;function gCe(e,r,t,n,a){var o=gf(bo.Name,a);return o.data={name:e,qualifier:r,source:t},o.children=n,o}hn.nameTerm=gCe;function vCe(e,r,t,n){var a=gf(bo.Udf,n);return a.data={name:e,qualifier:r},a.children=t,a}hn.udfTerm=vCe;function dfr(e,r,t){var n=gf(bo.CellRef,t);return n.data={ref:e,qualifier:r},n}hn.cellRefTerm=dfr;function ffr(e,r){var t=gf(bo.StructRef,r);return t.data=e,t}hn.structRefTerm=ffr;function pfr(e,r){var t=gf(bo.ReadStack,r);return t.data=e,t}hn.readStackTerm=pfr;function hCe(e,r,t,n,a,o){var u=gf(bo.Conditional,o);return u.children=zY.__spreadArray([n],a,!0),u.data={funName:e,funType:r,isFormulaRoot:t,args:pCe},u}hn.conditionalTerm=hCe;function SCe(e,r){var t=gf(bo.Noop,r);return t.children=e,t}hn.noopTerm=SCe;function mfr(e,r,t){var n=gf(bo.CallName,t);return n.children=r,n.data={loc:e},n}hn.callNameTerm=mfr;function gfr(e,r,t,n,a){var o=gf(bo.CallLambda,void 0);return o.children=a,o.data={capturedLocals:e,capturedStackEnv:r,capturedStackMap:t,caller:n},o}hn.callLambdaTerm=gfr;function vfr(e,r,t){var n=gf(bo.CallFirstOrderFunc,void 0);return n.children=t,n.data={source:e,caller:r},n}hn.callFirstOrderFuncTerm=vfr;function hfr(e,r){var t=gf(bo.CallMachine,r);return t.data={machine:e},t}hn.callMachineTerm=hfr;hn.postStepTerm=gf(bo.PostStep,void 0);function yCe(e){return e.kind>0}hn.isOperTerm=yCe;function Sfr(e,r){function t(a){if(yCe(a))return Vg.Pledge.resolve(a);switch(a.kind){case bo.Let:return Vg.Pledge.all(a.children.map(n)).bind(function(o){var u=o.slice(0,o.length-1);return fCe(u,a.data.rec,a.data.varLabels,o[o.length-1],a.position)});case bo.App:return Vg.Pledge.all(a.children.map(n)).bind(function(o){return mCe(a.data.funName,a.data.funType,a.data.isFormulaRoot,a.data.args,o,a.position)});case bo.Conditional:return Vg.Pledge.all(a.children.map(n)).bind(function(o){var u=o[0],s=o.slice(1);return hCe(a.data.funName,a.data.funType,a.data.isFormulaRoot,u,s,a.position)});case bo.Lambda:return Vg.Pledge.all(a.children.map(n)).bind(function(o){return dCe(a.data.checkArity,a.data.params,o,a.position)});case bo.Array:return Vg.Pledge.all(a.children.map(function(o){return Vg.Pledge.all(o.map(n))})).bind(function(o){return cCe(a.data.rows,a.data.cols,o,a.position)});case bo.Name:return(a.children===void 0?Vg.Pledge.resolve(void 0):n(a.children)).bind(function(o){return gCe(a.data.name,a.data.qualifier,a.data.source,o,a.position)});case bo.Udf:return(a.children===void 0?Vg.Pledge.resolve(void 0):n(a.children)).bind(function(o){return vCe(a.data.name,a.data.qualifier,o,a.position)});case bo.CellRef:case bo.StructRef:case bo.ReadStack:return Vg.Pledge.resolve(a);case bo.Noop:return n(a.children).bind(function(o){return SCe(o,a.position)});default:return(0,NU.assertNever)("calc.runtime.transformBottomUp",a)}}function n(a){return Vg.Pledge.resolve(a).bind(t).bind(r)}return Vg.Pledge.settleOrThrow(n(e))}hn.transformBottomUp=Sfr});var xF=T(Fe=>{"use strict";p();Object.defineProperty(Fe,"__esModule",{value:!0});Fe.operatorNode=Fe.nameNode=Fe.missingRef=Fe.localNameUseAnnotation=Fe.localNameDeclAnnotation=Fe.literalNode=Fe.letVar=Fe.letNode=Fe.lambdaParam=Fe.lambdaNode=Fe.indexedArg=Fe.identQualifier=Fe.identNamePart=Fe.headNamePart=Fe.formulaSpan=Fe.formulaRootAnnotation=Fe.formula=Fe.flattenNameParts=Fe.flattenLetArgs=Fe.flattenLambdaArgs=Fe.fieldRefNode=Fe.fieldRefNamePart=Fe.fieldRef=Fe.errorQualifier=Fe.documentQualifier=Fe.commaOpRef=Fe.columnRef=Fe.cellRefSingle=Fe.cellRefRow=Fe.cellRefRange=Fe.cellRefNode=Fe.cellRefNamePart=Fe.cellRefError=Fe.cellRefCol=Fe.cellRefBad=Fe.badRef=Fe.badQualifier=Fe.arrayNode=Fe.appNode=Fe.appHeadNameAnnotation=Fe.StructRefKind=Fe.SpecialRefId=Fe.RefStyle=Fe.QualifierKind=Fe.PosKind=Fe.NodeKind=Fe.NamePartKind=Fe.CellRefKind=Fe.BadType=Fe.AnnotationKind=void 0;Fe.missingNode=Fe.identNode=Fe.varNode=Fe.getDepthUpperBound=Fe.wsfNode=Fe.thisRowOpRef=Fe.structRefNode=Fe.structRef=Fe.specialRef=Fe.sheetRangeQualifier=Fe.sheetQualifier=Fe.relativeQualifier=Fe.rangeOpRef=Fe.pos=Fe.parenNode=Fe.paramNode=Fe.paramName=Fe.paramDefault=void 0;var Xr=qr();Fe.AnnotationKind=Xr.formulaModule.AnnotationKind;Fe.BadType=Xr.formulaModule.BadType;Fe.CellRefKind=Xr.formulaModule.CellRefKind;Fe.NamePartKind=Xr.formulaModule.NamePartKind;Fe.NodeKind=Xr.formulaModule.NodeKind;Fe.PosKind=Xr.formulaModule.PosKind;Fe.QualifierKind=Xr.formulaModule.QualifierKind;Fe.RefStyle=Xr.formulaModule.RefStyle;Fe.SpecialRefId=Xr.formulaModule.SpecialRefId;Fe.StructRefKind=Xr.formulaModule.StructRefKind;Fe.appHeadNameAnnotation=Xr.formulaModule.appHeadNameAnnotation;Fe.appNode=Xr.formulaModule.appNode;Fe.arrayNode=Xr.formulaModule.arrayNode;Fe.badQualifier=Xr.formulaModule.badQualifier;Fe.badRef=Xr.formulaModule.badRef;Fe.cellRefBad=Xr.formulaModule.cellRefBad;Fe.cellRefCol=Xr.formulaModule.cellRefCol;Fe.cellRefError=Xr.formulaModule.cellRefError;Fe.cellRefNamePart=Xr.formulaModule.cellRefNamePart;Fe.cellRefNode=Xr.formulaModule.cellRefNode;Fe.cellRefRange=Xr.formulaModule.cellRefRange;Fe.cellRefRow=Xr.formulaModule.cellRefRow;Fe.cellRefSingle=Xr.formulaModule.cellRefSingle;Fe.columnRef=Xr.formulaModule.columnRef;Fe.commaOpRef=Xr.formulaModule.commaOpRef;Fe.documentQualifier=Xr.formulaModule.documentQualifier;Fe.errorQualifier=Xr.formulaModule.errorQualifier;Fe.fieldRef=Xr.formulaModule.fieldRef;Fe.fieldRefNamePart=Xr.formulaModule.fieldRefNamePart;Fe.fieldRefNode=Xr.formulaModule.fieldRefNode;Fe.flattenLambdaArgs=Xr.formulaModule.flattenLambdaArgs;Fe.flattenLetArgs=Xr.formulaModule.flattenLetArgs;Fe.flattenNameParts=Xr.formulaModule.flattenNameParts;Fe.formula=Xr.formulaModule.formula;Fe.formulaRootAnnotation=Xr.formulaModule.formulaRootAnnotation;Fe.formulaSpan=Xr.formulaModule.formulaSpan;Fe.headNamePart=Xr.formulaModule.headNamePart;Fe.identNamePart=Xr.formulaModule.identNamePart;Fe.identQualifier=Xr.formulaModule.identQualifier;Fe.indexedArg=Xr.formulaModule.indexedArg;Fe.lambdaNode=Xr.formulaModule.lambdaNode;Fe.lambdaParam=Xr.formulaModule.lambdaParam;Fe.letNode=Xr.formulaModule.letNode;Fe.letVar=Xr.formulaModule.letVar;Fe.literalNode=Xr.formulaModule.literalNode;Fe.localNameDeclAnnotation=Xr.formulaModule.localNameDeclAnnotation;Fe.localNameUseAnnotation=Xr.formulaModule.localNameUseAnnotation;Fe.missingRef=Xr.formulaModule.missingRef;Fe.nameNode=Xr.formulaModule.nameNode;Fe.operatorNode=Xr.formulaModule.operatorNode;Fe.paramDefault=Xr.formulaModule.paramDefault;Fe.paramName=Xr.formulaModule.paramName;Fe.paramNode=Xr.formulaModule.paramNode;Fe.parenNode=Xr.formulaModule.parenNode;Fe.pos=Xr.formulaModule.pos;Fe.rangeOpRef=Xr.formulaModule.rangeOpRef;Fe.relativeQualifier=Xr.formulaModule.relativeQualifier;Fe.sheetQualifier=Xr.formulaModule.sheetQualifier;Fe.sheetRangeQualifier=Xr.formulaModule.sheetRangeQualifier;Fe.specialRef=Xr.formulaModule.specialRef;Fe.structRef=Xr.formulaModule.structRef;Fe.structRefNode=Xr.formulaModule.structRefNode;Fe.thisRowOpRef=Xr.formulaModule.thisRowOpRef;Fe.wsfNode=Xr.formulaModule.wsfNode;Fe.getDepthUpperBound=Xr.formulaModule.getDepthUpperBound;Fe.varNode=Xr.formulaModule.varNode;Fe.identNode=Xr.formulaModule.identNode;Fe.missingNode=Xr.formulaModule.missingNode});var vf=T(zc=>{"use strict";p();Object.defineProperty(zc,"__esModule",{value:!0});zc.unknownFunctionType=zc.operatorStrings=zc.higherOrderFunctionType=zc.getWorksheetFuncType=zc.getWorksheetFuncEnglishName=zc.getOperatorType=zc.WorksheetFuncId=zc.OperatorId=void 0;var oC=qr();zc.OperatorId=oC.signature.OperatorId;zc.WorksheetFuncId=oC.signature.WorksheetFuncId;zc.getOperatorType=oC.signature.getOperatorType;zc.getWorksheetFuncEnglishName=oC.signature.getWorksheetFuncEnglishName;zc.getWorksheetFuncType=oC.signature.getWorksheetFuncType;zc.higherOrderFunctionType=oC.signature.higherOrderFunctionType;zc.operatorStrings=oC.signature.operatorStrings;zc.unknownFunctionType=oC.signature.unknownFunctionType});var QY=T(Lt=>{"use strict";p();Object.defineProperty(Lt,"__esModule",{value:!0});Lt.zipVisitor=Lt.voidVisitor=Lt.visitWSFNode=Lt.visitQualifier=Lt.visitOperatorNode=Lt.visitFormulaNode=Lt.visitCellRef=Lt.visitAppHeadNode=Lt.reduceTopDown_Pledge=Lt.reducePledge=Lt.reduceBottomUp_Recursive=Lt.reduceBottomUp_Pledge=Lt.reduceBottomUp_MaxDepth=Lt.reduceBottomUp_CPS=Lt.reduceBottomUp=Lt.identityVisitor=Lt.depthVisitor=Lt.constVisitor=Lt.composeVisitor=Lt.bindVisitor=Lt.binaryVisitor=Lt.ZipVisitor=Lt.PledgeReducer=Lt.IdentityVisitor=Lt.DelegatingVisitor=Lt.ConstVisitor=Lt.ComposeVisitor=Lt.BinaryVisitor=void 0;var Go=qr();Lt.BinaryVisitor=Go.visitor.BinaryVisitor;Lt.ComposeVisitor=Go.visitor.ComposeVisitor;Lt.ConstVisitor=Go.visitor.ConstVisitor;Lt.DelegatingVisitor=Go.visitor.DelegatingVisitor;Lt.IdentityVisitor=Go.visitor.IdentityVisitor;Lt.PledgeReducer=Go.visitor.PledgeReducer;Lt.ZipVisitor=Go.visitor.ZipVisitor;Lt.binaryVisitor=Go.visitor.binaryVisitor;Lt.bindVisitor=Go.visitor.bindVisitor;Lt.composeVisitor=Go.visitor.composeVisitor;Lt.constVisitor=Go.visitor.constVisitor;Lt.depthVisitor=Go.visitor.depthVisitor;Lt.identityVisitor=Go.visitor.identityVisitor;Lt.reduceBottomUp=Go.visitor.reduceBottomUp;Lt.reduceBottomUp_CPS=Go.visitor.reduceBottomUp_CPS;Lt.reduceBottomUp_MaxDepth=Go.visitor.reduceBottomUp_MaxDepth;Lt.reduceBottomUp_Pledge=Go.visitor.reduceBottomUp_Pledge;Lt.reduceBottomUp_Recursive=Go.visitor.reduceBottomUp_Recursive;Lt.reducePledge=Go.visitor.reducePledge;Lt.reduceTopDown_Pledge=Go.visitor.reduceTopDown_Pledge;Lt.visitAppHeadNode=Go.visitor.visitAppHeadNode;Lt.visitCellRef=Go.visitor.visitCellRef;Lt.visitFormulaNode=Go.visitor.visitFormulaNode;Lt.visitOperatorNode=Go.visitor.visitOperatorNode;Lt.visitQualifier=Go.visitor.visitQualifier;Lt.visitWSFNode=Go.visitor.visitWSFNode;Lt.voidVisitor=Go.visitor.voidVisitor;Lt.zipVisitor=Go.visitor.zipVisitor});var OU=T(jg=>{"use strict";p();Object.defineProperty(jg,"__esModule",{value:!0});jg.canDenoteCellRef=jg.canDenoteUserDefinedFunc=jg.canDenoteLocalName=jg.resolveGridRef=jg.createResolver=void 0;var Kx=qr();jg.createResolver=Kx.resolveService.createResolver;jg.resolveGridRef=Kx.resolveService.resolveGridRef;jg.canDenoteLocalName=Kx.resolveService.canDenoteLocalName;jg.canDenoteUserDefinedFunc=Kx.resolveService.canDenoteUserDefinedFunc;jg.canDenoteCellRef=Kx.resolveService.canDenoteCellRef});var xU=T(sC=>{"use strict";p();var kU;Object.defineProperty(sC,"__esModule",{value:!0});sC.createCompiler=sC.compiledFormulaTerm=sC.compiledFormula=void 0;var Y0=fe(),yfr=Vy(),Gp=fi(),Qn=Q0(),_Ce=Fm(),RCe=uc(),X0=xF(),Fh=Na(),Wi=vf(),_fr=FF(),XY=Ua(),MU=Dl(),uC=QY(),bCe=Il(),ps=Ux(),CCe=fs(),TCe=Ky(),YY=OU(),ECe=(0,Fh.createFailureErrorClass)("CompileError"),JY=(0,RCe.makeStrict)((0,Wi.getWorksheetFuncType)(Wi.WorksheetFuncId.IF)),bfr=(0,RCe.makeStrict)((0,Wi.getWorksheetFuncType)(Wi.WorksheetFuncId.CHOOSE));function Cfr(e){return(0,Qn.isOperTerm)(e)&&(0,Fh.isWriteOper)(e)}var Tfr=function(){function e(r){var t=this;this.context=r,this.visitFormulaNode=function(n){return(0,uC.visitFormulaNode)(t,n)},this.lazyVisitFormulaNode=function(n){return ps.Pledge.resolve(n).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(r,t,n){return ps.Pledge.resolve(this.noopTerm(r,n))},e.prototype.arrayNode=function(r,t,n){var a=this;return ps.Pledge.all(r.map(function(o){return ps.Pledge.all(o.map(a.lazyVisitFormulaNode))})).bind(function(o){return a.toArrayTerm(o,n)})},e.prototype.toArrayTerm=function(r,t){var n=r.length,a=r[0]===void 0?0:r[0].length,o=r.map(function(u){return u.map(function(s){return s.kind===Qn.TermKind.Noop?s.children:s})});return o.every(function(u){return u.every(Cfr)})?this.noopTerm((0,XY.arrayOper)(n,a,o),t):(0,Qn.arrayTerm)(n,a,r,t)},e.prototype.appNode=function(r,t,n,a){var o=this,u,s=((u=this.context.annotations[a])===null||u===void 0?void 0:u.kind)===X0.AnnotationKind.FormulaRoot;if((0,Fh.isOperatorNode)(r)){var l=(0,Wi.getOperatorType)(r.id);return ps.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind(function(h){return(0,Qn.appTerm)((0,Qn.operatorIdToName)(r.id),l,s,void 0,h,a)})}var c=(0,Fh.getArguments)(t);if((0,Fh.isWSFNode)(r)){var d=r.id;switch(d){case Wi.WorksheetFuncId.IFERROR:case Wi.WorksheetFuncId.IFNA:{(0,Gp.assertTrue)("calc.runtime.toIfPredicateTerm: expected wff",c.length===2);var f=c[0],m=c[1],v=new e(Y0.__assign(Y0.__assign({},this.context),{numNames:this.context.numNames+1}));return ps.Pledge.all([this.lazyVisitFormulaNode(f),ps.Pledge.try(function(){return(0,uC.visitFormulaNode)(v,m)})]).bind(function(h){var y=h[0],_=h[1];return o.toIfPredicateTerm(d===Wi.WorksheetFuncId.IFERROR?Wi.WorksheetFuncId.ISERROR:Wi.WorksheetFuncId.ISNA,y,_,a)})}case Wi.WorksheetFuncId._UDF:return(0,Gp.assertFalse)("calc.runtime.appNode: expected wff (not UDF)")}return ps.Pledge.all(c.map(this.lazyVisitFormulaNode)).bind(function(h){switch(d){case Wi.WorksheetFuncId.IF:return o.toIfTerm(h,a);case Wi.WorksheetFuncId.CHOOSE:return o.toChooseTerm(h,a)}var y=(0,Wi.getWorksheetFuncType)(d);return(0,Qn.appTerm)((0,Qn.worksheetFunctionIdToName)(d),y,!1,void 0,h,a)})}return this.lazyVisitFormulaNode(r).bind(function(h){return ps.Pledge.all(c.map(o.lazyVisitFormulaNode)).bind(function(y){return o.toAppTerm(h,y,a)})})},e.prototype.toIfPredicateTerm=function(r,t,n,a){var o=(0,Qn.readStackTerm)(0,void 0),u=(0,Qn.conditionalTerm)((0,Qn.worksheetFunctionIdToName)(Wi.WorksheetFuncId.IF),JY,!1,(0,Qn.appTerm)((0,Qn.worksheetFunctionIdToName)(r),(0,Wi.getWorksheetFuncType)(r),!1,void 0,[o],void 0),[n,o],void 0);return(0,Qn.letTerm)([t],!1,[void 0],u,a)},e.prototype.toIfTerm=function(r,t){switch(r.length){case 3:return(0,Qn.conditionalTerm)((0,Qn.worksheetFunctionIdToName)(Wi.WorksheetFuncId.IF),JY,!1,r[0],[r[1],r[2]],t);case 2:return(0,Qn.conditionalTerm)((0,Qn.worksheetFunctionIdToName)(Wi.WorksheetFuncId.IF),JY,!1,r[0],[r[1],XY.falseOper],t);case 1:throw new ECe((0,Fh.notImplemented)(["single-argument IF"]));default:return(0,Gp.assertFalse)("calc.runtime.toIfTerm: expected wff")}},e.prototype.toChooseTerm=function(r,t){return(0,Gp.assertTrue)("calc.runtime.toChooseTerm: expected wff",r.length>=1),(0,Qn.conditionalTerm)((0,Qn.worksheetFunctionIdToName)(Wi.WorksheetFuncId.CHOOSE),bfr,!1,r[0],r.slice(1),t)},e.prototype.toAppTerm=function(r,t,n){return(0,Qn.appTerm)((0,Qn.worksheetFunctionIdToName)(Wi.WorksheetFuncId._UDF),(0,Wi.higherOrderFunctionType)(),!1,void 0,Y0.__spreadArray([r],t,!0),n)},e.prototype.letNode=function(r,t,n,a,o,u){var s=this,l=r.id===Wi.WorksheetFuncId.LETREC?!0:r.id===Wi.WorksheetFuncId.LET?!1:(0,Gp.assertFalse)("calc.runtime.compile");(0,Gp.assertTrue)("calc.runtime.letNode: expected wff",n!==void 0);var c=this.bindNames(t),d=c[t.length],f=t.map(function(v){var h=v.name;return h.arg.label}),m;return l?m=ps.Pledge.all(t.map(function(v){var h=v.binder;return ps.Pledge.try(function(){return(0,uC.visitFormulaNode)(d,h.arg)})})):m=ps.Pledge.all(t.map(function(v,h){var y=v.binder,_=c[h];return ps.Pledge.try(function(){return(0,uC.visitFormulaNode)(_,y.arg)})})),m.bind(function(v){return(0,uC.visitFormulaNode)(d,n.arg).bind(function(h){return(0,Qn.letTerm)(v.map(function(y,_){return s.noopTerm(y,(0,_Ce.runtimePositionLetVal)(t[_].name.arg.label,t[_].binder.arg.label))}),l,f,h,u)})})},e.prototype.lambdaNode=function(r,t,n,a,o,u){(0,Gp.assertTrue)("calc.runtime.lambdaNode: expected wff",n!==void 0);var s=this.bindNames(t),l=s[t.length],c=t.reduce(function(f,m,v){var h=m.name;return(0,bCe.fastMax)(f,h.arg.isOptional?0:v+1)},0),d=t.length;return ps.Pledge.all(t.map(function(f,m){var v=f.name;if(v.arg.def===void 0)return ps.Pledge.resolve(void 0);var h=s[m],y=v.arg.def.rhs;return ps.Pledge.try(function(){return(0,uC.visitFormulaNode)(h,y)})})).bind(function(f){return(0,uC.visitFormulaNode)(l,n.arg).bind(function(m){var v=f.map(function(y,_){return[y,_]}).filter(function(y){return y[0]!==void 0}),h=Y0.__spreadArray(Y0.__spreadArray([],v.map(function(y){var _=y[0];return _}),!0),[m],!1);return(0,Qn.lambdaTerm)(function(y){return y>=c&&y<=d},t.map(function(y){var _=y.name;return{paramNodeLabel:_.arg.label,paramNameLabel:_.arg.name.name.label,hasDef:_.arg.def!==void 0,isRest:!1}}),h,u)})})},e.prototype.bindNames=function(r){var t=this,n=this.context.numNames,a=[this];return r.reduce(function(o,u,s){var l=u.name;(0,Gp.assertTrue)("calc.runtime.bindNames: expected wff",l.arg.wholeName!==void 0);var c=o.setValue((0,Fh.getBoundName)(t.context.localeInfo,l.arg.wholeName),n+s);return a.push(new e(Y0.__assign(Y0.__assign({},t.context),{names:c,numNames:n+s+1}))),c},this.context.names),a},e.prototype.parenNode=function(r,t,n){var a=this;return this.lazyVisitFormulaNode(r).bind(function(o){return a.noopTerm(o,n)})},e.prototype.nameNode=function(r,t,n){var a,o=((a=this.context.annotations[n])===null||a===void 0?void 0:a.kind)===X0.AnnotationKind.AppHeadName;return ps.Pledge.resolve(this.toNameTerm(r,t,o))},e.prototype.toNameTerm=function(r,t,n){var a=this,o=this.context,u=o.locals,s=o.names,l=o.numNames,c=(0,X0.flattenNameParts)(r).parts;if((0,YY.canDenoteLocalName)(t,c)){var d=c[0],f=c.slice(1),m=s.getEntry((0,Fh.getBoundName)(this.context.localeInfo,d.asWhole));if(m!==void 0){var v=m.value,h=(0,Qn.readStackTerm)(l-v-1,d.qualifiedLabel);return ps.Pledge.resolve(f.reduce(function(k,q){return a.toFieldRefTerm(k,q.rhs.field.whole,q.qualifiedLabel)},h))}}var y=void 0;if(t==null&&(0,TCe.getTypedFeatureGate)("Microsoft.Office.Excel.CalcEtaLambda")&&(0,TCe.getTypedFeatureGate)("Microsoft.Office.Excel.EtaReducedLambdas")){var _=(0,Fh.getEtaFuncId)(this.context.localeInfo,r.asWhole);if(_!==void 0){var E=Y0.__assign({},(0,Wi.getWorksheetFuncType)(_));E.maxArgs=(0,bCe.fastMin)(254,E.maxArgs),y=(0,Qn.lambdaTerm)(function(k){return(0,Fh.isValidArgsLength)(E,k)},[{paramNodeLabel:void 0,paramNameLabel:void 0,hasDef:!1,isRest:!0}],[(0,Qn.appTerm)((0,Qn.worksheetFunctionIdToName)(_),E,!1,[{isSpread:!0}],[(0,Qn.readStackTerm)(0,void 0)],(0,_Ce.runtimePositionEtaLambdaBody)(_))],r.qualifiedLabel)}}if((0,YY.canDenoteCellRef)(u,t,c)){var d=c[0],f=c.slice(1),N=t!=null&&t.kind===X0.QualifierKind.Ident?(0,X0.sheetQualifier)(t.name,void 0,t.isQuoted,t.label):t,h=(0,Qn.cellRefTerm)(d.ref,N,d.qualifiedLabel);y=f.reduce(function(I,M){return a.toFieldRefTerm(I,M.rhs.field.whole,M.qualifiedLabel)},h)}return(0,YY.canDenoteUserDefinedFunc)(n,t,r)&&(y=(0,Qn.udfTerm)(r.asWhole,t,y,r.qualifiedLabel)),r.canDenoteNamedObject&&(y=(0,Qn.nameTerm)(r.asWhole,t,n?CCe.NameSource.AppHead:CCe.NameSource.Plain,y,r.qualifiedLabel)),(0,Gp.assertTrue)("calc.runtime.compile: expected wff NameNode",y!==void 0),ps.Pledge.resolve(y)},e.prototype.cellRefNode=function(r,t,n){return ps.Pledge.resolve((0,Qn.cellRefTerm)(r,t,n))},e.prototype.fieldRefNode=function(r,t,n){var a=this;(0,Gp.assertTrue)("calc.runtime.compile: expected wff FieldRef",t.field.kind===X0.NodeKind.Ident);var o=t.field.whole;return this.lazyVisitFormulaNode(r).bind(function(u){return a.toFieldRefTerm(u,o,n)})},e.prototype.toFieldRefTerm=function(r,t,n){var a=Wi.WorksheetFuncId.FIELDVALUE;return(0,Qn.appTerm)((0,Qn.worksheetFunctionIdToName)(a),(0,Wi.getWorksheetFuncType)(a),!1,void 0,[r,(0,XY.stringOper)(t)],n)},e.prototype.noopTerm=function(r,t){return this.context.locals.emitStepInfo?(0,Qn.noopTerm)(r,t):r},e.prototype.structRefNode=function(r,t,n){return ps.Pledge.resolve((0,Qn.structRefTerm)((0,X0.structRefNode)(r,t,n),n))},e.prototype.missingNode=function(r,t){return(0,Gp.assertFalse)("calc.runtime.compile: unexpected missing node")},e.prototype.badSequenceNode=function(r,t,n){return(0,Gp.assertFalse)("calc.runtime.compile: unexpected bad node")},e.prototype.badCharsNode=function(r,t,n){return(0,Gp.assertFalse)("calc.runtime.compile: unexpected bad node")},e.prototype.operatorNode=function(r,t){return ps.Pledge.resolve((0,X0.operatorNode)(r,t))},e.prototype.wsfNode=function(r,t,n){return ps.Pledge.resolve((0,X0.wsfNode)(r,t,n))},e}(),Rfr=(kU={},kU[Wi.OperatorId.At]=Wi.WorksheetFuncId.SINGLE,kU[Wi.OperatorId.Pound]=Wi.WorksheetFuncId.ANCHORARRAY,kU);function Efr(e){if(!(0,Qn.isOperTerm)(e)&&e.kind===Qn.TermKind.App&&(0,Qn.isOperatorName)(e.data.funName)){var r=Rfr[(0,Qn.operatorNameToId)(e.data.funName)];if(r!==void 0)return(0,Qn.appTerm)((0,Qn.worksheetFunctionIdToName)(r),(0,Wi.getWorksheetFuncType)(r),e.data.isFormulaRoot,e.data.args,e.children,e.position)}return e}var Pfr=[Efr],Afr=function(r,t){return t(r)},Ffr=function(r){return Pfr.reduce(Afr,r)};function Nfr(e){return(0,Qn.transformBottomUp)(e,Ffr)}function PCe(e,r){var t=Y0.__assign(Y0.__assign({},e),{term:r});return t}sC.compiledFormula=PCe;function Ofr(e,r){return typeof r.term!="object"?(0,Gp.assertFalse)("".concat(e,": expected known compiled formula type; given ").concat((0,yfr.anonymize)(r))):r.term}sC.compiledFormulaTerm=Ofr;function kfr(e,r){var t=r.annotations[r.node.label],n=_fr.RedBlackMapTree.create(e.stringCompareCI);if((t==null?void 0:t.kind)===X0.AnnotationKind.FormulaRoot){var a=t.contextNames,o=a===void 0?[]:a,u=o.reduce(function(s,l,c){return s.setValue((0,Fh.getBoundName)(e,l.whole),c)},n);return{names:u,numNames:o.length}}return{names:n,numNames:0}}function Mfr(e,r,t){var n,a;try{var o=(a=(n=r.config)===null||n===void 0?void 0:n.localeInfo)!==null&&a!==void 0?a:e.config.localeInfo,u=kfr(o,t),s=u.names,l=u.numNames,c={globals:e,locals:r,localeInfo:o,annotations:t.annotations,names:s,numNames:l},d=(0,uC.reducePledge)(new Tfr(c),t),f=Nfr(d);return(0,MU.success)(PCe(t,f))}catch(m){return m instanceof ECe?(0,MU.failure)(m.reason):(0,MU.failure)((0,MU.javaScriptError)(m))}}function xfr(e){return{compileFormula:function(t,n){return Mfr(e,t,n)}}}sC.createCompiler=xfr});var GU=T(J0=>{"use strict";p();Object.defineProperty(J0,"__esModule",{value:!0});J0.dereferenceOpers=J0.dereferenceOper=J0.dereference=J0.getCellValuesAsArray=void 0;var DU=fi(),IU=Ky(),ZY=Nm(),LU=Vy(),OCe=Fm(),jy=qo(),Ifr=oc(),wU=uc(),wfr=nl(),Wg=Ua(),Dfr=Il(),lC=Na(),IF=fs(),Lfr=H0(),ACe=au(),qU=Dl(),qfr=16;function kCe(e,r){var t=r.map.getValue(e);if(t!==void 0){var n=(0,Lfr.recordCellCycle)(t,r.current);return(0,jy.throwEvaluationError)(n)}}function FCe(e,r,t){e.precedents.cells.push(r);var n=e.globals.getCellValue(r);if(n.kind===qU.ResultKind.Failure)return(0,jy.throwEvaluationError)(n.reason);var a=n.value;if(a.kind===OCe.CellKind.FinalValue)return a.oper;kCe(a.anchor,e.visitedCells),t.push(a.anchor)}function Gfr(e,r,t,n,a){var o=[],u=n.length,s=0;(0,DU.assertTrue)("calc.runtime.deference: readIntoArray2D number of rows",u===t.rows);for(var l=0;l<u;l+=1){o.push([]);var c=n[l].length;(0,DU.assertTrue)("calc.runtime.deference: readIntoArray2D number of cols",c===t.cols),s=l===0?c:(0,Dfr.fastMin)(c,s);for(var d=0;d<c;d+=1){var f=n[l][d];OCe.CellKind.FinalValue===f.kind?o[l][d]=f.oper:(kCe(f.anchor,e.visitedCells),(0,DU.assertTrue)("calc.runtime.deference: readIntoArray2D correct sheet",(0,lC.isSheetIndexEqual)(f.anchor.sheet,r.sheet)),a.push(f.anchor),o[l][d]=Wg.refErrorOper)}}return new ZY.StrictSparseArray2D(r.range.rows,r.range.cols,u,s,o,Wg.blankOper)}function MCe(e,r,t,n){e.precedents.cells.push(r);var a;if(!n||(0,lC.gridRangeSize)(r.range)<=qfr)a=r;else{var o=e.globals.getUsedRange(r.sheet),u=void 0;(0,qU.isSuccess)(o)?u=o.value==null?void 0:o.value.range:(0,jy.throwEvaluationError)(o.reason);var s=u===void 0?void 0:(0,lC.gridRangeIsect)(r.range,(0,IF.gridRange)(0,0,u.row+u.rows,u.col+u.cols));if(s===void 0)return new ZY.StrictSparseArray2D(r.range.rows,r.range.cols,0,0,[],Wg.blankOper);a=(0,IF.sheetGridRange)(r.sheet,s)}var l=e.globals.getCellValues(a);if(l.kind===qU.ResultKind.Failure)return(0,jy.throwEvaluationError)(l.reason);var c=t.length,d=Gfr(e,r,a.range,l.value,t);if(c===t.length)return d}J0.getCellValuesAsArray=MCe;function NCe(e,r,t){var n=MCe(e,r,t,!1);if(n!=null)return(0,Wg.arrayOper)(n.rows,n.cols,n.rows===n.denseRows&&n.cols===n.denseCols?n.denseElements:(0,ZY.array2DToJaggedArray)(n))}function $Y(e,r,t,n){if(t&ACe.OperKind.Range||!(0,lC.isRangeOper)(r))return r;var a=r.sheets;if(!(0,lC.isSheetIndex)(a))return(0,wU.traceErrorOper)("calc.runtime.dereference",Wg.ErrorType.REF,"3D range, oper = ".concat((0,LU.anonymize)(r))),Wg.refErrorOper;if(r.ranges.length!==1)return(0,wU.traceErrorOper)("calc.runtime.dereference",Wg.ErrorType.VALUE,"union range, oper = ".concat((0,LU.anonymize)(r))),Wg.valueErrorOper;var o=r.ranges[0];if(t&Ifr.singleReadOperType){if((0,lC.isGridCell)(o))return FCe(e,(0,IF.sheetGridCell)(a,o),n);if(e.locals.implicitIntersect&&(0,IU.isFeatureEnabled)(IU.FeatureName.CalcLegacyImplicitIntersection)&&!(0,IU.isFeatureEnabled)(IU.FeatureName.CalcPreventSpillingHack)){var u=e.locals.originGridCell;if(!(0,qU.isSuccess)(u))return(0,jy.throwEvaluationError)(u.reason);var s=(0,lC.gridCellImplicitIsect)(u.value,o);return s==null?((0,wU.traceErrorOper)("calc.runtime.dereference",Wg.ErrorType.VALUE,"empty intersection, oper = ".concat((0,LU.anonymize)(r))),Wg.valueErrorOper):FCe(e,(0,IF.sheetGridCell)(a,s),n)}return NCe(e,(0,IF.sheetGridRange)(a,o),n)}return t&ACe.OperKind.Array?NCe(e,(0,IF.sheetGridRange)(a,o),n):((0,wU.traceErrorOper)("calc.runtime.dereference",Wg.ErrorType.VALUE,"bad target type ".concat(t)),Wg.valueErrorOper)}J0.dereference=$Y;function Bfr(e,r,t){var n=[],a=$Y(e,r,t,n);if(a==null){if(n.length>0)return(0,jy.throwEvaluationError)((0,jy.unevaluated)(n));var o=(0,LU.anonymize)(r),u="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = ".concat(o);return DU.ulsLogger.ULS.assertTag(595980819,wfr.LogCategory.msoulscat_ES_EWAJS,!1,u)}return a}J0.dereferenceOper=Bfr;function Ufr(e,r,t){for(var n=[],a=0;a<r.length;a+=1){var o=$Y(e,r[a],(0,lC.getArgType)(t,a,r.length),n);o!=null&&(r[a]=o)}if(n.length>0)return(0,jy.throwEvaluationError)((0,jy.unevaluated)(n))}J0.dereferenceOpers=Ufr});var VU=T(Td=>{"use strict";p();Object.defineProperty(Td,"__esModule",{value:!0});Td.applyOperator=Td.cmpNum=Td.cmpStr=Td.cmpBool=Td.cmpInt=void 0;var cC=Vy(),Vx=uc(),eJ=kF(),Gl=Ua(),rJ=fi(),ms=vf(),Z0=au(),Kfr=fs(),Hg=Na(),xCe=uc();Td.cmpInt=Hg.applyComparison;function BU(e,r,t){return(0,Td.cmpInt)(e,r.value-t.value)}Td.cmpBool=BU;function UU(e,r,t,n){return(0,Td.cmpInt)(r,e.stringCompareCI(t.value,n.value))}Td.cmpStr=UU;function KU(e,r,t,n){return(0,Td.cmpInt)(r,e.compare(t,n))}Td.cmpNum=KU;function Vfr(e,r,t,n){var a=e.config,o=a.localeInfo,u=a.mathpack;if(t.kind!==n.kind){if((0,Hg.isBlankOper)(t))switch(n.kind){case Z0.OperKind.Number:return KU(u,r,u.zero,n);case Z0.OperKind.String:return UU(o,r,xCe.emptyStringOper,n);case Z0.OperKind.Boolean:return BU(r,Gl.falseOper,n)}if((0,Hg.isBlankOper)(n))switch(t.kind){case Z0.OperKind.Number:return KU(u,r,t,u.zero);case Z0.OperKind.String:return UU(o,r,t,xCe.emptyStringOper);case Z0.OperKind.Boolean:return BU(r,t,Gl.falseOper)}return(0,Td.cmpInt)(r,t.kind-n.kind)}switch(t.kind){case Z0.OperKind.Number:return KU(u,r,t,n);case Z0.OperKind.String:return UU(o,r,t,n);case Z0.OperKind.Boolean:return BU(r,t,n);case Z0.OperKind.Blank:return(0,Td.cmpInt)(r,0);default:return!1}}function tJ(e,r,t){if(!(0,Hg.isSheetIndex)(r.sheets)){(0,Vx.traceErrorOper)(e,Gl.ErrorType.VALUE,"3D reference, range1 = ".concat((0,cC.anonymize)(r)));return}if(!(0,Hg.isSheetIndex)(t.sheets)){(0,Vx.traceErrorOper)(e,Gl.ErrorType.VALUE,"3D reference, range2 = ".concat((0,cC.anonymize)(t)));return}if(!(0,Hg.isDocumentLocEqual)(r.sheets.document,t.sheets.document)){var n="different document, range1 = ".concat((0,cC.anonymize)(r),", range2 = ").concat((0,cC.anonymize)(t));(0,Vx.traceErrorOper)(e,Gl.ErrorType.VALUE,n);return}var a=r.sheets.index,o=t.sheets.index;if(a!==o){var n="different sheet, range1 = ".concat((0,cC.anonymize)(r),", range2 = ").concat((0,cC.anonymize)(t));(0,Vx.traceErrorOper)(e,Gl.ErrorType.VALUE,n);return}return(0,Kfr.sheetIndex)(r.sheets.document,r.sheets.index)}function jfr(e,r){var t=tJ("calc.runtime.applyRangeOp",e,r);if(t==null)return Gl.valueErrorOper;var n=(0,Hg.gridRangesJoin)(e.ranges),a=(0,Hg.gridRangesJoin)(r.ranges),o=[(0,Hg.gridRangeJoin)(n,a)];return(0,Gl.rangeSeqOper)(t,o)}function Wfr(e,r){var t=tJ("calc.runtime.applyUnionOp",e,r);return t==null?Gl.valueErrorOper:(0,Gl.rangeSeqOper)(t,e.ranges.concat(r.ranges))}function Hfr(e,r){var t=tJ("calc.runtime.applyIsectOp",e,r);if(t==null)return Gl.valueErrorOper;for(var n=[],a=0;a<e.ranges.length;a+=1)for(var o=0;o<r.ranges.length;o+=1){var u=(0,Hg.gridRangeIsect)(e.ranges[a],r.ranges[o]);u!=null&&n.push(u)}if(n.length===0){var s="empty intersection, range1 = ".concat((0,cC.anonymize)(e),", range2 = ").concat((0,cC.anonymize)(r));return(0,Vx.traceErrorOper)("calc.runtime.applyIsectOp",Gl.ErrorType.NULL,s),Gl.nullErrorOper}return(0,Gl.rangeSeqOper)(t,n)}function zfr(e,r,t,n){n===void 0&&(n=!1);var a=e.config.mathpack;if(t.length===1){var o=t[0];switch(r){case ms.OperatorId.Percent:return a.percent(o);case ms.OperatorId.Neg:return a.neg(o);case ms.OperatorId.Pos:return o;default:{var u="bad application of ".concat(r," to 1 argument"),s="calc.runtime.applyOperator: ".concat(u);return rJ.ulsLogger.ULS.assertTag(593372496,eJ.LogCategory.msoulscat_ES_EWAJS,!1,s)}}}if(t.length===2){var o=t[0],l=t[1];switch(r){case ms.OperatorId.Add:{var c=a.add(o,l);return n&&(0,Hg.isNumberOper)(c)?a.checkAlmostCancellation(o,c):c}case ms.OperatorId.Sub:{var c=a.sub(o,l);return n&&(0,Hg.isNumberOper)(c)?a.checkAlmostCancellation(o,c):c}case ms.OperatorId.Mul:return a.mul(o,l);case ms.OperatorId.Div:return a.div(o,l);case ms.OperatorId.Pow:return a.power(o,l);case ms.OperatorId.Concat:return(0,Gl.stringOper)((o.value+l.value).substring(0,Gl.cellStringLimit));case ms.OperatorId.Eq:case ms.OperatorId.Ne:case ms.OperatorId.Lt:case ms.OperatorId.Le:case ms.OperatorId.Gt:case ms.OperatorId.Ge:return(0,Gl.booleanOper)(Vfr(e,r,o,l));case ms.OperatorId.Range:return jfr(o,l);case ms.OperatorId.Isect:return Hfr(o,l);case ms.OperatorId.Union:return Wfr(o,l);case ms.OperatorId.And:return(0,Gl.booleanOper)(o.value&&l.value);case ms.OperatorId.Or:return(0,Gl.booleanOper)(o.value||l.value);case ms.OperatorId.Xor:return(0,Gl.booleanOper)(o.value!==l.value);case ms.OperatorId.Min:return a.cond2(o,l)<=0?o:l;case ms.OperatorId.Max:return a.cond2(o,l)>=0?o:l;default:{var d="bad application of ".concat(r," to 2 arguments"),f="calc.runtime.applyOperator: ".concat(d);return rJ.ulsLogger.ULS.assertTag(593372497,eJ.LogCategory.msoulscat_ES_EWAJS,!1,f)}}}var m="bad application of ".concat(r," to ").concat(t.length," arguments"),v="calc.runtime.applyOperator: ".concat(m);return rJ.ulsLogger.ULS.assertTag(593372498,eJ.LogCategory.msoulscat_ES_EWAJS,!1,v)}Td.applyOperator=zfr});var dC=T($0=>{"use strict";p();Object.defineProperty($0,"__esModule",{value:!0});$0.isRangeValues=$0.rangeValues=$0.DerefOperKind=$0.machine=void 0;var Qfr=fe(),Xfr=Qfr.__importStar(oc());$0.machine=Xfr;var jU;(function(e){e.RangeValues="RangeValues"})(jU||($0.DerefOperKind=jU={}));function Yfr(e){return{kind:jU.RangeValues,arrays:e}}$0.rangeValues=Yfr;function Jfr(e){return e.kind===jU.RangeValues}$0.isRangeValues=Jfr});var nJ=T(eS=>{"use strict";p();Object.defineProperty(eS,"__esModule",{value:!0});eS.parseLocals=eS.notFormulaString=eS.createParseGlobals=eS.ReasonKind=void 0;var WU=Jf();eS.ReasonKind=WU.parseServiceTypes.ReasonKind;eS.createParseGlobals=WU.parseServiceTypes.createParseGlobals;eS.notFormulaString=WU.parseServiceTypes.notFormulaString;eS.parseLocals=WU.parseServiceTypes.parseLocals});var aJ=T(zg=>{"use strict";p();Object.defineProperty(zg,"__esModule",{value:!0});zg.summarizeFormulaDiagnostics=zg.diagnostics=zg.createAnalyzeGlobals=zg.analyzeLocalsName=zg.analyzeLocalsGrid=void 0;var jx=Jf();zg.analyzeLocalsGrid=jx.analyzeServiceTypes.analyzeLocalsGrid;zg.analyzeLocalsName=jx.analyzeServiceTypes.analyzeLocalsName;zg.createAnalyzeGlobals=jx.analyzeServiceTypes.createAnalyzeGlobals;zg.diagnostics=jx.analyzeServiceTypes.diagnostics;zg.summarizeFormulaDiagnostics=jx.analyzeServiceTypes.summarizeFormulaDiagnostics});var ICe=T(HU=>{"use strict";p();Object.defineProperty(HU,"__esModule",{value:!0});HU.adjustFormulaOrigin=void 0;var Zfr=qr();HU.adjustFormulaOrigin=Zfr.adjust.adjustFormulaOrigin});var Wy=T(wF=>{"use strict";p();Object.defineProperty(wF,"__esModule",{value:!0});wF.LambdaOper=wF.RecordOper=void 0;var wCe=Ua(),DCe=au(),$fr=function(){function e(r,t){t===void 0&&(t=wCe.valueErrorOper),this._fields=r,this._fallback=t,this.kind=DCe.OperKind.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(r){return this._fields.getValue(r)},e}();wF.RecordOper=$fr;var epr=function(){function e(r,t,n,a,o,u,s){this.checkArity=r,this.lambdaNodeLabel=t,this.params=n,this.locals=a,this.stackEnv=o,this.stackMap=u,this.defsAndBody=s,this.kind=DCe.OperKind.Rich}return e.prototype.getFallback=function(){return wCe.valueErrorOper},e.prototype.getField=function(r){},e}();wF.LambdaOper=epr});var LCe=T(Bp=>{"use strict";p();Object.defineProperty(Bp,"__esModule",{value:!0});Bp.toXLNumber=Bp.renderFormat=Bp.initUtilGlobals=Bp.getValueEditOperKind=Bp.getFormatString=Bp.applyValueEdit=void 0;var DF=ep();Bp.applyValueEdit=DF.util.applyValueEdit;Bp.getFormatString=DF.util.getFormatString;Bp.getValueEditOperKind=DF.util.getValueEditOperKind;Bp.initUtilGlobals=DF.util.initUtilGlobals;Bp.renderFormat=DF.util.renderFormat;Bp.toXLNumber=DF.util.toXLNumber});var fC=T(Ks=>{"use strict";p();Object.defineProperty(Ks,"__esModule",{value:!0});Ks.values=Ks.stringStartsWith=Ks.stringEndsWith=Ks.repeat=Ks.prependErrorMessage=Ks.partialArray=Ks.messageFromError=Ks.mathLog2=Ks.isInteger=Ks.arrayFill=void 0;var rS=pr();Ks.arrayFill=rS.util.arrayFill;Ks.isInteger=rS.util.isInteger;Ks.mathLog2=rS.util.mathLog2;Ks.messageFromError=rS.util.messageFromError;Ks.partialArray=rS.util.partialArray;Ks.prependErrorMessage=rS.util.prependErrorMessage;Ks.repeat=rS.util.repeat;Ks.stringEndsWith=rS.util.stringEndsWith;Ks.stringStartsWith=rS.util.stringStartsWith;Ks.values=rS.util.values});var qCe=T(pC=>{"use strict";p();Object.defineProperty(pC,"__esModule",{value:!0});pC.printLocalsName=pC.printLocalsGrid=pC.createSimplePrintGlobals=void 0;var iJ=qr();pC.createSimplePrintGlobals=iJ.printServiceTypes.createSimplePrintGlobals;pC.printLocalsGrid=iJ.printServiceTypes.printLocalsGrid;pC.printLocalsName=iJ.printServiceTypes.printLocalsName});var cJ=T(gC=>{"use strict";p();Object.defineProperty(gC,"__esModule",{value:!0});gC.FunctionDispatcher=gC.RestArgsOper=gC.UdfOper=void 0;var GCe=Vy(),Rd=fi(),rpr=Nm(),lJ=Fm(),tpr=Fm(),Ya=qo(),npr=dC(),apr=VU(),ipr=Q0(),oJ=Q0(),BCe=Q0(),UCe=Q0(),uJ=Q0(),LF=Q0(),opr=uc(),Wx=uc(),Hx=Il(),upr=kF(),KCe=fs(),Mm=fs(),lc=Na(),zU=xF(),mC=lU(),spr=nJ(),lpr=Ua(),tp=Ua(),cpr=aJ(),dpr=ICe(),fpr=Wy(),QU=vf(),sJ=oc(),zx=NF(),VCe=LCe(),Hi=au(),qF=GU(),ppr=EU(),yi=Dl(),mpr=fC(),gpr=qCe(),GF=Ky(),WCe=function(){function e(r,t){this.kind=Hi.OperKind.Rich,this.loc=r,this.arity=t.arity,this.func=t.func}return e.prototype.getFallback=function(){return(0,Rd.assertFalse)("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(r){return(0,Rd.assertFalse)("calc.runtime.UdfOper.getField")},e}();gC.UdfOper=WCe;var HCe=function(){function e(r){this.opers=r,this.kind=Hi.OperKind.Rich}return e.prototype.getFallback=function(){return(0,Rd.assertFalse)("calc.runtime.RestArgsOper.getFallback")},e.prototype.getField=function(r){return(0,Rd.assertFalse)("calc.runtime.RestArgsOper.getField")},e}();gC.RestArgsOper=HCe;function jCe(e,r,t,n){(0,Rd.assertTrue)("calc.runtime.compileCallLambda",e.checkArity(r.length));var a=[];{for(var o=0,u=0,s=0,l=e.params;s<l.length;s++){var c=l[s];if(c.isRest){a.push(new HCe(r.slice(u))),u=r.length;continue}var d=u>=r.length?lpr.missingOper:r[u++];c.hasDef&&((0,lc.isMissingOper)(d)&&(d=e.defsAndBody[o]),++o),a.push(d)}(0,Rd.assertTrue)("calc.runtime.compileCallLambda",u===r.length&&o===e.defsAndBody.length-1)}var f=n?a.map(function(y,_){var E=e.params[_];return E.paramNodeLabel===void 0&&E.paramNameLabel===void 0?y:(0,oJ.noopTerm)(y,(0,lJ.runtimePositionLambdaParam)(_,E.paramNodeLabel,E.paramNameLabel))}):a,m=a.map(function(y,_){return e.params[_].paramNodeLabel}),v=e.defsAndBody[e.defsAndBody.length-1],h=(0,oJ.letTerm)(f,!1,m,v,(0,lJ.runtimePositionLambdaRoot)(e.lambdaNodeLabel,e,r));return(0,oJ.callLambdaTerm)(e.locals,e.stackEnv,e.stackMap,t,h)}var vpr=function(){function e(r,t,n,a,o,u,s,l){this.context=r,this.stepConfig=t,this.locals=n,this.caller=a,this.precedents=o,this.visitedCells=u,this.visitedNames=s,this.usage=l,this.internalSource=void 0;var c=r.globals.config.refStyle;this.config={localeInfo:r.globals.config.localeInfo,get refStyle(){return o.special|=Hi.SpecialPrecs.RefStyle,c},mathpack:r.globals.config.mathpack,date1904:r.globals.config.date1904,dateCompatibility:r.globals.config.dateCompatibility,timezone:r.globals.config.timezone,datepack:r.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalCaller",{get:function(){return(0,Rd.assertTrue)("calc.runtime.FunctionDispatcher.internalCaller",this.internalSource!==void 0),(0,Ya.stackFrameList)(this.internalSource,e.internalPosition,Ya.emptyStackEnv,void 0,this.caller)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalContext",{get:function(){var t=this.internalCaller;return{stack:new Ya.ES5IterableStackFrame(t)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var t=this.locals.originGridCell;return(0,yi.isSuccess)(t)?t.value:(0,Ya.throwEvaluationError)(t.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var t=this.locals.originSheet;return(0,yi.isSuccess)(t)?t.value:(0,Ya.throwEvaluationError)(t.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var t=this.locals.reflectionGridCell;return(0,yi.isSuccess)(t)?t.value:(0,Ya.throwEvaluationError)(t.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var t=this.locals.reflectionSheet;return(0,yi.isSuccess)(t)?t.value:(0,Ya.throwEvaluationError)(t.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var t=this.locals.followHyperlinks;return(0,yi.isSuccess)(t)?t.value:(0,Ya.throwEvaluationError)(t.reason)},enumerable:!1,configurable:!0}),e.prototype.makeChildDispatcher=function(r){return new e(this.context,this.stepConfig,this.locals,r,this.precedents,this.visitedCells,this.visitedNames,this.usage)},e.prototype.useAsFuncContext=function(r){return(0,Rd.assertTrue)("calc.runtime.FunctionDispatcher.useAsFuncContext: caller shouldn't be set",this.internalSource===void 0),r!==void 0&&(this.internalSource=r),this},e.prototype.applyFunction=function(r,t){var n=this.makeChildDispatcher(this.internalCaller),a=(0,QU.getWorksheetFuncType)(r),o=t.some(lc.isRangeOper),u=o?t.slice(0):t;return(0,qF.dereferenceOpers)(n,u,a),n.termToFuncResult(n.dispatchFunction((0,LF.worksheetFunctionIdToName)(r),a,!1,u))},e.prototype.applyLambda=function(r,t){return this.termToFuncResult(jCe(r,t,this.internalCaller,this.stepConfig!=null))},e.prototype.handleEvaluationError=function(r){if(r instanceof Ya.EvaluationError)return(0,Ya.handleEvaluationError)(this.context,this.visitedCells,r.reason)},e.prototype.applyOperatorOrFunction=function(r,t,n){if((0,LF.isOperatorName)(r))return(0,apr.applyOperator)(this.globals,(0,LF.operatorNameToId)(r),t,n);var a=(0,LF.worksheetFunctionNameToId)(r);if(a===QU.WorksheetFuncId._UDF){if(t[0]instanceof fpr.LambdaOper){var o=t[0],u=t.slice(1);return o.checkArity(u.length)?((0,Rd.assertTrue)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: caller shouldn't be set",this.internalSource===void 0),jCe(o,u,this.caller,this.stepConfig!=null)):tp.valueErrorOper}if(t[0]instanceof WCe){var s=t[0];if(t.length-1!==s.arity)return tp.valueErrorOper;var l=s.func(this.useAsFuncContext((0,KCe.lexicalSourceUDF)(s.loc)),t.slice(1));if(l.kind===Hi.OperKind.Error){var c="UDF function return value";(0,Wx.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",l.type,c)}return this.funcContextResultToTerm(l)}switch(t[0].kind){case Hi.OperKind.Error:return t[0];case Hi.OperKind.Number:return tp.valueErrorOper;case Hi.OperKind.Rich:return(0,Ya.throwEvaluationError)((0,lc.notImplemented)(["Rich UDF head"]));case Hi.OperKind.String:case Hi.OperKind.Boolean:case Hi.OperKind.Blank:case Hi.OperKind.Missing:return tp.refErrorOper;case Hi.OperKind.Array:return(0,GF.isFeatureEnabled)(GF.FeatureName.CalcLambdaArrayLifting)?(0,Rd.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected array UDF head"):(0,Ya.throwEvaluationError)((0,lc.notImplemented)(["Array UDF head"]));case Hi.OperKind.Range:return(0,GF.isFeatureEnabled)(GF.FeatureName.CalcLambdaCellValues)?(0,Rd.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected range UDF head"):(0,Ya.throwEvaluationError)((0,lc.notImplemented)(["Range UDF head"]));default:return(0,Rd.assertNever)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",t[0])}}var d=this.globals.getWorksheetFunc(a);if(d.kind===yi.ResultKind.Failure)return(0,Ya.throwEvaluationError)(d.reason);var f=d.value;if(f==null){var c="nonexistent worksheet function ".concat(a);return(0,Wx.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",tp.ErrorType.NAME,c),tp.nameErrorOper}try{var l=f(this.useAsFuncContext((0,KCe.lexicalSourceWSF)(a)),t);if(l.kind===Hi.OperKind.Error){var c="worksheet function ".concat(a," return value");(0,Wx.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",l.type,c)}return this.funcContextResultToTerm(l)}catch(m){throw(0,mpr.prependErrorMessage)(m,"(in WSF ".concat((0,upr.englishWorksheetFuncIdToName)(a),")"))}},e.prototype.termToFuncResult=function(r){switch(r.kind){case uJ.TermKind.CallLambda:case uJ.TermKind.CallFirstOrderFunc:return(0,sJ.machineCall)(this.context.createCallTermEvaluationMachine(this.context,this.stepConfig,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,r));case uJ.TermKind.CallMachine:return(0,sJ.machineCall)(r.data.machine)}return r},e.prototype.funcContextResultToTerm=function(r){return(0,Rd.assertTrue)("calc.runtime.FunctionDispatcher.funcContextResultToTerm",this.internalSource!==void 0),(0,sJ.isMachineCall)(r)?(0,ipr.callFirstOrderFuncTerm)(this.internalSource,this.caller,(0,UCe.callMachineTerm)(r.machine,e.internalPosition)):r},e.prototype.dispatchFunction=function(r,t,n,a){var o=this;if(!(0,lc.isValidArgsLength)(t,a.length)){var u=JSON.stringify(t),s="bad application of ".concat(JSON.stringify(r)," to ").concat(a.length," arguments, ftype = ").concat(u),l="calc.runtime.FunctionDispatcher.dispatchFunction: ".concat(s);return(0,Rd.assertFalse)(l)}for(var c=a.length,d=Hi.SignatureType.None,f=0;f<c;f+=1){var m=a[f],v=m.kind,h=(0,lc.getArgType)(t,f,c);v&h||(d|=v),(0,lc.isRangeOper)(m)&&!(t.flags&Hi.FunctionFlags.Allow3dRef)&&!(h&Hi.SignatureType.Ref3D)&&!(0,lc.isSheetIndex)(m.sheets)&&(d|=v),(0,lc.isStringOper)(m)&&!(t.flags&Hi.FunctionFlags.AllowLStrs)&&m.value.length>255&&(0,GF.isTypedChangeGateEnabled)("Microsoft.Office.Excel.CalcTsLstr")&&(d|=v)}if(d===Hi.SignatureType.None)return this.applyOperatorOrFunction(r,a,n);if(d&Hi.OperKind.Array){var y=function(q){var V=o.makeChildDispatcher(o.caller);return V.termToFuncResult(V.dispatchFunction(r,t,!1,q))},_=(0,opr.arrayLift)(this.useAsFuncContext(void 0),t,y,a).machine;return(0,UCe.callMachineTerm)(_,void 0)}d&=~Hi.OperKind.Array;for(var E=[],f=0;f<c;f+=1){var N=a[f];if(d&N.kind){var h=(0,lc.getArgType)(t,f,c);if(N=this.coerceOper(N,h),(0,lc.isErrorOper)(N)&&!(h&Hi.OperKind.Error))return N;if((0,lc.isRangeOper)(N)&&!(t.flags&Hi.FunctionFlags.Allow3dRef)&&!(h&Hi.SignatureType.Ref3D)&&!(0,lc.isSheetIndex)(N.sheets)){var s="3D reference, oper = ".concat((0,GCe.anonymize)(N));return(0,Wx.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",tp.ErrorType.VALUE,s),tp.valueErrorOper}if((0,lc.isStringOper)(N)&&!(t.flags&Hi.FunctionFlags.AllowLStrs)&&N.value.length>255&&(0,GF.isTypedChangeGateEnabled)("Microsoft.Office.Excel.CalcTsLstr")){var s="LStr, oper = ".concat((0,GCe.anonymize)(N));return(0,Wx.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",tp.ErrorType.VALUE,s),tp.valueErrorOper}}E[f]=N}return this.applyOperatorOrFunction(r,E,n)},e.prototype.getAvailableFormula=function(r){var t=this.globals.getCellFormula(r);if(!(0,yi.isSuccess)(t))return(0,Ya.throwEvaluationError)(t.reason);if(!(0,Hx.isNone)(t.value))return t.value},e.prototype.getNameFormula=function(r,t,n){var a=this.context.resolver.resolveName(this.locals,(0,zU.nameNode)((0,zU.identNamePart)(t,!0),r),n),o=a.resolution,u=a.precedents;if((0,Hx.safePush)(this.precedents.names,u),!(0,yi.isSuccess)(o))switch(o.reason.kind){case mC.ResolveReasonKind.NoOriginSheet:case mC.ResolveReasonKind.InvalidQualifier:return;default:return(0,Ya.throwEvaluationError)(o.reason)}var s=o.value;if(s){var l=this.globals.getNameFormula(s,n);(0,yi.isSuccess)(l)||(0,Ya.throwEvaluationError)(l.reason);var c=l.value;if(!(0,Hx.isNone)(c))return[s,c.node]}},e.prototype.getCellRef=function(r,t,n,a){var o={originGridCell:(0,yi.success)(n.range),originSheet:(0,yi.success)(n.sheet),allowUnqualifiedCell:!0,wrapCellReferences:a},u=this.context.resolver.resolveCellRef(o,(0,zU.cellRefNode)(t,r)).resolution;if(!(0,yi.isSuccess)(u))switch(u.reason.kind){case mC.ResolveReasonKind.NoOriginSheet:case mC.ResolveReasonKind.InvalidQualifier:return;default:return(0,Ya.throwEvaluationError)(u.reason)}var s=u.value;if(s)return(0,tp.range3DOper)(s.sheet,s.range)},e.prototype.getStructRef=function(r,t,n){var a={originGridCell:(0,yi.success)(n.range),originSheet:(0,yi.success)(n.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},o=this.context.resolver.resolveStructRef(a,(0,zU.structRefNode)(r,t)),u=o.resolution,s=o.precedents;if((0,Hx.safePush)(this.precedents.names,s),!(0,yi.isSuccess)(u))switch(u.reason.kind){case mC.ResolveReasonKind.NoOriginSheet:case mC.ResolveReasonKind.InvalidQualifier:case mC.ResolveReasonKind.InvalidStructRef:case mC.ResolveReasonKind.EmptyIntersection:return;default:return(0,Ya.throwEvaluationError)(u.reason)}var l=u.value;if(l)return(0,tp.range3DOper)(l.sheet,l.range)},e.prototype.dereferenceOper=function(r,t){return(0,qF.dereferenceOper)(this,r,t)},e.prototype.dereferenceOpers=function(r,t){(0,qF.dereferenceOpers)(this,r,t)},e.prototype.getCellFormula=function(r){this.precedents.cells.push(r);var t=this.globals.getCellValue(r);return(0,yi.isSuccess)(t)?this.getAvailableFormula(r):(0,Ya.throwEvaluationError)(t.reason)},e.prototype.getSheetIndex=function(r,t){var n=this.globals.getSheetIndex(r,t);return(0,yi.isSuccess)(n)?(this.precedents.special|=Hi.SpecialPrecs.OwnDocSheets,n.value==null?void 0:(0,Mm.sheetIndex)(r,n.value)):(0,Ya.throwEvaluationError)(n.reason)},e.prototype.getSheetRangePosition=function(r){this.precedents.special|=Hi.SpecialPrecs.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(r);return(0,yi.isSuccess)(t)?t.value.position:(0,Ya.throwEvaluationError)(t.reason)},e.prototype.getSheetRangeIndexes=function(r){if(r.index!==void 0&&r.index===r.index2)return[r.index];this.precedents.special|=Hi.SpecialPrecs.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(r);return(0,yi.isSuccess)(t)?t.value.sheets:(0,Ya.throwEvaluationError)(t.reason)},e.prototype.dereferenceAllOpersInner=function(r,t,n){var a=this;n===void 0&&(n=!1);for(var o=[],u=[],s=function(m){var v=r[m];if(!(0,lc.isRangeOper)(v))return u.push(v),"continue";for(var h=[],y=function(V){var I=(0,qF.getCellValuesAsArray)(a,V,o,!0);I!==void 0&&h.push(t(I,V))},_=l.getSheetRangeIndexes(v.sheets),E=function(V){for(var I=(0,Mm.sheetIndex)(v.sheets.document,_[V]),M=function(X){var ee=v.ranges[X];if(!n)return y((0,Mm.sheetGridRange)(I,ee)),"continue";var re=l.globals.tryGetHiddenRows(I,ee.row,ee.row+ee.rows);if(!(0,yi.isSuccess)(re))return{value:(0,Ya.throwEvaluationError)(re.reason)};var Z=re.value;if(Z.length===0)return y((0,Mm.sheetGridRange)(I,ee)),"continue";for(var J=function($,me){var ve=(0,Mm.gridRange)($,ee.col,me-$,ee.cols);y((0,Mm.sheetGridRange)(I,ve))},C=0;C<Z.length;C+=1){var S=Z[C],b=S.start,O=S.end,w=C===0?ee.row:Z[C-1].end;(0,Rd.assertTrue)("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",w<=b&&b<O&&O<=ee.row+ee.rows),w!==b&&J(w,b);var D=(0,Mm.gridRange)(b,ee.col,O-b,ee.cols);l.precedents.cells.push((0,Mm.sheetGridRange)(I,D))}var Q=Z[Z.length-1].end;Q!==ee.row+ee.rows&&J(Q,ee.row+ee.rows)},B=0;B<v.ranges.length;B+=1){var U=M(B);if(typeof U=="object")return U}},N=0;N<_.length;N+=1){var k=E(N);if(typeof k=="object")return k}u.push({kind:npr.DerefOperKind.RangeValues,arrays:h})},l=this,c=0;c<r.length;c+=1){var d=s(c);if(typeof d=="object")return d.value}return o.length>0?(0,Ya.throwEvaluationError)((0,Ya.unevaluated)(o)):u},e.prototype.dereferenceAllOpers=function(r,t){return this.dereferenceAllOpersInner(r,Hx.identity,t)},e.prototype.dereferenceAllOpersAndFormulae=function(r,t){var n=this;return this.dereferenceAllOpersInner(r,function(a,o){return new rpr.NonstrictSparseArray2D(a.rows,a.cols,a.denseRows,a.denseCols,function(u,s){var l=a.get(u,s),c=(0,Mm.sheetGridCell)(o.sheet,(0,Mm.gridCell)(o.range.row+u,o.range.col+s));return[l,n.getAvailableFormula(c)]},function(){return[a.getSparse(),void 0]}).strict()},t)},e.prototype.parseFormula=function(r,t,n,a){var o=this.context.parser.parseFormula((0,spr.parseLocals)(n.lexicalKind,t,{refStyle:r}),a);if(!(0,yi.isSuccess)(o))return o;var u=this.context.analyzer.checkFormula(n,o.value);if(!(0,yi.isSuccess)(u))return u;if(!(0,lc.isWellFormed)(u.value))return(0,yi.failure)((0,tpr.illFormedFormula)("ill-formed indirect formula","indirect"));var s=u.value;return u},e.prototype.getRandom=function(){this.precedents.special|=Hi.SpecialPrecs.Calc;var r=this.internalContext,t=this.globals.getRandom(r);return(0,yi.isSuccess)(t)||(0,Ya.throwEvaluationError)(t.reason),t.value},e.prototype.getTime=function(r){this.precedents.special|=Hi.SpecialPrecs.Time;var t=this.globals.getTime(r,zx.GetTimeKind.Volatile);return(0,yi.isSuccess)(t)||(0,Ya.throwEvaluationError)(t.reason),t.value},e.prototype.coerceOper=function(r,t){return(0,ppr.coerceOper)(this,r,t)},e.prototype.parseGeneral=function(r,t){var n,a=this.numberFormatter.parseGeneral(r,!1,t,zx.GetTimeKind.NonVolatile);return(0,yi.isSuccess)(a)||(0,Ya.throwEvaluationError)(a.reason),(n=a.value)===null||n===void 0?void 0:n.value},e.prototype.parseDate=function(r){var t,n=this.numberFormatter.parseDate(r,zx.GetTimeKind.NonVolatile);return(0,yi.isSuccess)(n)||(0,Ya.throwEvaluationError)(n.reason),(t=n.value)===null||t===void 0?void 0:t.value},e.prototype.getBinaryOperator=function(r){var t=this,n=(0,QU.getOperatorType)(r),a=[tp.falseOper,tp.falseOper];return function(o,u){a[0]=o,a[1]=u,(0,qF.dereferenceOpers)(t,a,n);var s=t.dispatchFunction((0,LF.operatorIdToName)(r),n,!1,a);return(0,Rd.assertTrue)("calc.runtime.FunctionDispatcher.getBinaryOperator",(0,BCe.isOperTerm)(s)),s}},e.prototype.getUnaryOperator=function(r){var t=this,n=(0,QU.getOperatorType)(r),a=[tp.falseOper];return function(o){a[0]=o,(0,qF.dereferenceOpers)(t,a,n);var u=t.dispatchFunction((0,LF.operatorIdToName)(r),n,!1,a);return(0,Rd.assertTrue)("calc.runtime.FunctionDispatcher.getUnaryOperator",(0,BCe.isOperTerm)(u)),u}},e.prototype.isInFilterMode=function(r){this.precedents.special|=Hi.SpecialPrecs.InFilterMode;for(var t=0,n=r;t<n.length;t++){var a=n[t];if((0,lc.isRangeOper)(a))for(var o=0,u=this.getSheetRangeIndexes(a.sheets);o<u.length;o++){var s=u[o],l=this.globals.isInFilterMode((0,Mm.sheetIndex)(a.sheets.document,s));if(!(0,yi.isSuccess)(l))return(0,Ya.throwEvaluationError)(l.reason);if(l.value)return!0}}return!1},e.prototype.printFormula=function(r,t){var n=(0,Mm.sheetGridCell)(r.source.range.sheet,t),a=(0,dpr.adjustFormulaOrigin)(this.globals,(0,cpr.analyzeLocalsGrid)(Mm.LexicalKind.Cell,(0,lc.sheetGridRangeAnchor)(r.source.range)),t,r.formula);if(!(0,yi.isSuccess)(a))return(0,Ya.throwEvaluationError)(a.reason);var o=this.context.printer.printFormula((0,gpr.printLocalsGrid)(r.source,n,{refStyle:this.config.refStyle}),a.value);return(0,yi.isSuccess)(o)?o.value:(0,Ya.throwEvaluationError)(o.reason)},e.prototype.applyFormat=function(r,t,n,a){var o;if(typeof t=="number"){var u=this.globals.getKnownFormat(r,t);if(!(0,yi.isSuccess)(u))return(0,Ya.throwEvaluationError)(u.reason);o=u.value}else{var s=(0,VCe.getFormatString)(this.context.numberFormatter,this.globals,r,t,a);if(!(0,yi.isSuccess)(s))switch(s.reason.kind){case zx.FormatReasonKind.PreviousFormatFailure:case zx.FormatReasonKind.NotFormatString:return;default:return(0,Ya.throwEvaluationError)(s.reason)}o=s.value}var l=(0,VCe.renderFormat)(this.context.numberFormatter,o,n);if(!(0,yi.isSuccess)(l))return(0,Ya.throwEvaluationError)(l.reason);if(typeof l.value=="string")return l.value},e.internalPosition=lJ.runtimePositionFirstOrderFunc,e}();gC.FunctionDispatcher=vpr});var ZU=T(nS=>{"use strict";p();Object.defineProperty(nS,"__esModule",{value:!0});nS.EvaluationRuntime=nS.runtimeTimer=nS.calculateNextDeadline=nS.createSchedule=void 0;var XU=fi(),tS=Fm(),JU=Il(),YU=oc(),hpr=fC(),Spr=Dl();function ypr(e){var r=e.yieldIntervalMs,t=e.totalTimeMs==null?void 0:(0,JU.now)()+e.totalTimeMs,n=e.scheduleFunction!=null?e.scheduleFunction:function(a){return setTimeout(a,0)};return{yieldIntervalMs:r,endTimeMs:t,scheduleFunction:n}}nS.createSchedule=ypr;function Qx(e){if(!(e.yieldIntervalMs===void 0&&e.endTimeMs===void 0)){if(e.yieldIntervalMs===void 0)return e.endTimeMs;var r=(0,JU.now)()+e.yieldIntervalMs;return e.endTimeMs===void 0?r:(0,JU.fastMin)(e.endTimeMs,r)}}nS.calculateNextDeadline=Qx;function _pr(){return{doTimeout:function(r){return r!==void 0&&(0,JU.now)()>=r}}}nS.runtimeTimer=_pr;var bpr={kind:tS.ReasonKind.Timeout},Cpr={kind:tS.ReasonKind.Breakpoint},Tpr=function(){function e(r,t){(0,XU.assertPositiveInteger)("calc.runtime.EvaluationRuntime",t.length),this.context=r,this.machineRuntimes=t.map(function(n){return new YU.MachineRuntime(n)}),this.results=[]}return e.prototype.evaluateAsync=function(r){var t=this;if(this.context.globals.interruptToken[0]===tS.Interrupt.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(r.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var n=this.evaluate(Qx(r));return Array.isArray(n)?Promise.resolve(n):((0,XU.assertTrue)("calc.runtime.EvaluationRuntime.evaluateAsync",n.kind===tS.ReasonKind.Timeout),new Promise(function(a,o){return r.scheduleFunction(function(){try{a(t.evaluateAsync(r))}catch(u){o(u)}})}))}catch(a){return Promise.reject(a)}},e.prototype.evaluateSync=function(r){var t=this,n=function a(o){if(t.context.globals.interruptToken[0]===tS.Interrupt.Stop||t.context.timer.doTimeout(r.endTimeMs))return t.generatePartialResults(),t.results;var u=t.evaluate(o);if(Array.isArray(u))return u;switch(u.kind){case tS.ReasonKind.Timeout:return(0,tS.paused)(function(s){return a(s??Qx(r))});case tS.ReasonKind.Breakpoint:return(0,tS.breaked)(function(){return a(Qx(r))});default:return(0,XU.assertNever)("calc.runtime.EvaluationRuntime.evaluateSync",u)}};return n(Qx(r))},e.prototype.evaluate=function(r){var t=this,n=function(){return t.context.timer.doTimeout(r)};try{for(;this.results.length<this.machineRuntimes.length;){var a=this.machineRuntimes[this.results.length].run(n);if(a.kind===YU.TransitionKind.Next)return bpr;if(a.kind===YU.TransitionKind.Break)return Cpr;this.pushResult(a)}return this.results}catch(u){var o="calc.runtime.EvaluationRuntime.evaluate: unhandled error ".concat((0,hpr.messageFromError)(u));return(0,XU.assertFalse)(o)}},e.prototype.pushResult=function(r){return this.results.push(r),YU.nextTransition},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push((0,Spr.failure)(tS.stopped))},e}();nS.EvaluationRuntime=Tpr});var n3=T(t3=>{"use strict";p();Object.defineProperty(t3,"__esModule",{value:!0});t3.createCellEvaluationMachine=void 0;var $U=fi(),zCe=Fm(),e3=qo(),QCe=qo(),Rpr=oc(),XCe=Dl(),Epr=H0(),Ppr=H0(),Apr=fs(),ZCe=Ux(),Fpr=Ua(),r3=Vy(),vC=Na(),Npr=uc(),YCe=Wy(),JCe=Ky(),Opr=function(){function e(r,t,n,a){this.context=r,this.stepConfig=t,this.visitedCells=n,this.cell=a}return e.prototype.evalCell=function(){var r=this.context.globals.getCellValue(this.cell);if(r.kind===XCe.ResultKind.Failure)return{kind:e3.CellEvaluationResultKind.ReadFailure,failure:r};var t=r.value;if(t.kind===zCe.CellKind.FinalValue)return{kind:e3.CellEvaluationResultKind.ReadOper};var n=this.context.globals.getCellFormula(t.anchor);if(n.kind===XCe.ResultKind.Failure){var a="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return(0,$U.assertFalse)(a)}var o=n.value;if(o==null){var u="client error: expected getCellFormula(".concat((0,r3.anonymize)(t.anchor),") != null"),a="calc.runtime.CellEvaluationMachine.next: ".concat(u);return(0,$U.assertFalse)(a)}var s=this.visitAnchor(o),l=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,QCe.evalLocalsGrid)(s.source),s.precedents,(0,Ppr.appendVisitedCell)(this.visitedCells,s),Epr.emptyVisitedNames,Rpr.readOperType,o.formula);return ZCe.Pledge.fromMachine(l).bind(this.receiveSuccess(s)).catch(this.receiveFailure(s))},e.prototype.visitAnchor=function(r){var t=(0,vC.sheetGridRangeAnchor)(r.source.range),n=this.visitedCells.map.getValue(t);if(n!=null){var a="unexpected visitValue at ".concat((0,r3.anonymize)(t),"; given ").concat((0,r3.anonymize)(n)),o="calc.runtime.CellEvaluationMachine.visitAnchor: ".concat(a);return(0,$U.assertFalse)(o)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:r.source,precedents:(0,QCe.bottomEvalPrecedents)()}},e.prototype.receiveSuccess=function(r){var t=this;return function(n){if((0,vC.isRangeOper)(n)||(0,vC.isMissingOper)(n)){var a="expected ReadOper; given ".concat((0,r3.anonymize)(n)),o="calc.runtime.CellEvaluationMachine.receiveSuccess: ".concat(a);return(0,$U.assertFalse)(o)}return t.writeSuccess(r.source,n,r.precedents)}},e.prototype.receiveFailure=function(r){var t=this;return function(n){var a=n.kind===zCe.ReasonKind.PreviousFailure&&r.cycle!==void 0?r.cycle:n;return t.writeFailure(r.source,a,r.precedents)}},e.prototype.writeSuccess=function(r,t,n){return this.setCellValue(r,t,n),{kind:e3.CellEvaluationResultKind.WroteOper,source:r}},e.prototype.writeFailure=function(r,t,n){return this.context.globals.setCellFailure(r.range,t,n),{kind:e3.CellEvaluationResultKind.WroteFailure,source:r}},e.prototype.setCellValue=function(r,t,n){var a=this.context.globals.config.mathpack.zero,o=(0,vC.isBlankOper)(t)?a:t;if(r.kind===Apr.LexicalKind.Cell){if((0,vC.isArrayOper)(o)){var u=o.opers[0]===void 0?Fpr.naErrorOper:o.opers[0][0],s=(0,vC.isBlankOper)(u)?a:u;return this.isLambdaEnabled(r,s,n)?this.context.globals.setCellValue(r.range,s,n):void 0}return this.isLambdaEnabled(r,o,n)?this.context.globals.setCellValue(r.range,o,n):void 0}var l=r.range.range,c=(0,Npr.broadcastWriteOper)(l.rows,l.cols,o).opers,d=function(v){return(0,vC.isBlankOper)(v)?a:v},f=c.map(function(m){return m.map(d)});if(this.isLambdaEnabled(r,f,n))return this.context.globals.setCellValues(r.range,f,n)},e.prototype.isLambdaEnabled=function(r,t,n){return!(Array.isArray(t)?t.some(function(a){return a.some(function(o){return o instanceof YCe.LambdaOper})}):t instanceof YCe.LambdaOper)||(0,JCe.isFeatureEnabled)(JCe.FeatureName.CalcLambdaCellValues)?!0:(this.context.globals.setCellFailure(r.range,(0,vC.notImplemented)(["LAMBDA cell values"]),n),!1)},e}();function kpr(e,r,t,n){return ZCe.Pledge.try(function(){return new Opr(e,r,t,n).evalCell()})}t3.createCellEvaluationMachine=kpr});var u3=T(KF=>{"use strict";p();Object.defineProperty(KF,"__esModule",{value:!0});KF.createCallTermEvaluationMachine=KF.createFormulaEvaluationMachine=void 0;var Qg=fi(),zy=Fm(),Mpr=qo(),xpr=qo(),n1e=qo(),Ipr=qo(),Xx=qo(),Qc=qo(),a3=Il(),dJ=oc(),Nh=Dl(),$Ce=H0(),wpr=fs(),Dpr=fs(),Eu=Ua(),Hy=Vy(),iS=Na(),e1e=uc(),Lpr=Wy(),r1e=Ky(),ca=Q0(),Yx=cJ(),i3=GU(),pJ=au(),fJ=EU(),a1e=xU(),aS=uc(),BF=lU(),UF=xF(),o3=vf(),qpr=function(){return(0,Qc.throwEvaluationError)((0,iS.notImplemented)(["LETREC cycle"]))};function Gpr(e,r,t,n,a){var o=(0,n1e.stackFrameList)(e,r,t,n,a);return{stack:new Ipr.ES5IterableStackFrame(o)}}function t1e(e,r){return{context:e,holeIndex:0,locals:r}}var i1e=function(){function e(r,t,n,a,o,u,s,l,c,d,f){this.context=r,this.stepConfig=t,this.locals=n,this.precedents=a,this.visitedCells=o,this.visitedNames=u,this.usage=s,this.target=l,this.isNested=c,this.runStatus=!1,this.stackEnv=Xx.emptyStackEnv,this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.continuation=[],d.kind!==ca.TermKind.CallLambda&&d.kind!==ca.TermKind.CallFirstOrderFunc?(this.term=t!=null?(0,ca.noopTerm)(d,void 0):d,this.caller=void 0):((0,Qg.assertTrue)("calc.runtime.FormulaEvaluationMachine.constructor: no preStep for CallTerm",d.position===void 0),this.term=d,this.caller=d.data.caller.caller),this.initialLambdaDepth=s.lambdaDepth,f.length>0&&(this.stackEnv=f.reduce(function(m,v){var h=v.value;return m.setValue(m.getCount(),h)},this.stackEnv),this.stackMapLabels=f.map(function(m){var v=m.label;return v}),this.stackMapNumPushed=f.length)}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(r){if(r instanceof Qc.EvaluationError)return(0,Qc.handleEvaluationError)(this.context,this.visitedCells,r.reason);throw r}},e.prototype.receiveResult=function(r){return(0,Nh.isSuccess)(r)?this.updateTermTransition(r.value):r},e.prototype.doNext=function(){if((0,ca.isOperTerm)(this.term)){var r=this.continuation;if(r.length===0){(0,Qg.assertTrue)("calc.runtime.FormulaEvaluationMachine.doNext: lambdaDepth correctly decremented",this.usage.lambdaDepth===this.initialLambdaDepth);var t=(0,i3.dereferenceOper)(this,this.term,this.target),n=(0,fJ.coerceOper)(this,t,this.target);return this.precedents.bound=Eu.PrecsBound.Exact,(0,r1e.isFeatureEnabled)(r1e.FeatureName.CalcPreventSpillingHack)&&!this.isNested&&this.locals.lexicalSource.kind===Dpr.LexicalKind.Cell&&(0,iS.isArrayOper)(n)&&(n.rows!==1||n.cols!==1)?(0,Nh.failure)((0,iS.notImplemented)(["spilling"])):(0,Nh.success)(n)}var a=r[r.length-1];return this.applyContinuation(this.term,a)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(r,t){var n,a,o=t.context;switch(o.kind){case ca.TermKind.App:{var u=t.holeIndex,s=o.children.length;(0,Qg.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",u<=s);var l=t.locals;if(u===s)return(0,Qg.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,iS.isMissingOper)(r)),this.dispatchFunction(l,o.data,o.position);var c=(n=o.data.args[u])===null||n===void 0?void 0:n.isSpread;return c===!0?((0,Qg.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",r instanceof Yx.RestArgsOper),(0,a3.safePush)(l,r.opers)):((0,Qg.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",!(r instanceof Yx.RestArgsOper)),l.push(r)),u+1<s?this.nextHoleTransition(t,o.children[u+1]):this.nextHoleTransition(t,Eu.missingOper)}case ca.TermKind.Conditional:{var d=t.holeIndex;if(d===0){var f=(0,ca.worksheetFunctionNameToId)(o.data.funName),m=f===o3.WorksheetFuncId.IF?pJ.OperKind.Boolean:pJ.OperKind.Number,v=(0,i3.dereferenceOper)(this,r,m);if((0,iS.isArrayOper)(v))return t.locals=[v],this.nextHoleTransition(t,o.children[d+1]);if((0,iS.isRichOper)(v))return(0,Nh.failure)((0,iS.notImplemented)(["IF/CHOOSE with a rich value condition"]));if(v=(0,fJ.coerceOper)(this,v,m),f===o3.WorksheetFuncId.IF&&(0,iS.isBooleanOper)(v))return this.popContextTransition(o.children[v.value?1:2]);if(f===o3.WorksheetFuncId.CHOOSE&&(0,iS.isNumberOper)(v)){var h=this.context.globals.config.mathpack.fix(v);if(h<1||h>o.children.length-1){var y="CHOOSE; out of bounds option = ".concat((0,Hy.anonymize)(h));return(0,aS.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.applyContinuation",Eu.ErrorType.VALUE,y),this.popContextTransition(Eu.valueErrorOper)}return this.popContextTransition(o.children[h])}return(0,Qg.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,iS.isErrorOper)(v)),this.popContextTransition(v)}var l=t.locals;return l[d]=r,d+1<o.children.length?this.nextHoleTransition(t,o.children[d+1]):this.dispatchFunction(l,o.data,o.position)}case ca.TermKind.CallName:{var _=t.locals;return this.locals=_.locals,this.caller=_.caller,this.restoreStack(_),this.visitedNames=_.visitedNames,this.popContextTransition(r)}case ca.TermKind.Let:{var d=t.holeIndex,E=o.children.length-1;if(d>=E){var _=t.locals;return this.restoreStack(_),this.popContextTransition(r)}if(o.data.rec){var N=this.stackEnv.getCount()-E+d;this.stackEnv.getValue(N).value=r,this.stackEnv=this.stackEnv.setValue(N,r)}else this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),r),this.stackMapNumPushed+=1;return d+1>=E&&this.isLetTcoPossible()?this.popContextTransition(o.children[d+1]):this.nextHoleTransition(t,o.children[d+1])}case ca.TermKind.Array:{var k=(0,i3.dereferenceOper)(this,r,e1e.writeOperType),q=o.data,V=q.rows,I=q.cols,M=t.holeIndex,B=M%I,U=I===B+1,j=(M-B)/I,X=t.locals;if(X[j][B]=(0,fJ.coerceOper)(this,k,e1e.writeOperType),V===j+1&&U)return this.popContextTransition((0,Eu.arrayOper)(V,I,X));var ee=U?j+1:j,re=U?0:B+1;return this.nextHoleTransition(t,o.children[ee][re])}case ca.TermKind.CallLambda:{var _=t.locals;return this.locals=_.locals,this.caller=_.caller,this.restoreStack(_),this.usage.lambdaDepth-=1,this.popContextTransition(r)}case ca.TermKind.CallFirstOrderFunc:{var _=t.locals;return this.locals=_.locals,this.caller=_.caller,this.restoreStack(_),this.popContextTransition(r)}case ca.TermKind.PostStep:{var Z=t.locals;return(a=this.stepConfig)===null||a===void 0||a.postStep(Z,r),this.popContextTransition(r)}default:return(0,Qg.assertNever)("calc.runtime.FormulaEvaluationMachine.applyContinuation",o)}},e.prototype.reduceFormula=function(r){var t,n,a;switch(r.kind){case ca.TermKind.CellRef:return this.updateTermTransition(this.evalCellRefTerm(r));case ca.TermKind.StructRef:return this.updateTermTransition(this.evalStructRefTerm(r));case ca.TermKind.App:{var o=r.data.funName;if(!(0,ca.isOperatorName)(o)){var u=(0,ca.worksheetFunctionNameToId)(o);if(u!==o3.WorksheetFuncId._UDF){var s=this.globals.getWorksheetFunc(u);if(s.kind===Nh.ResultKind.Failure)return(0,Qc.throwEvaluationError)(s.reason)}}if(r.children.length===0){var l=new Yx.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(r.position),this.precedents,this.visitedCells,this.visitedNames,this.usage),c=l.dispatchFunction(o,r.data.funType,r.data.isFormulaRoot,[]);return this.updateTermTransition(c)}return this.pushContextTransition(r,r.children[0],[])}case ca.TermKind.CallLambda:{var d=this.isCallLambdaTcoPossible();if(this.usage.lambdaCalls[0]+1>((t=this.globals.limits.maxLambdaCalls)!==null&&t!==void 0?t:1/0))return(0,Qc.throwEvaluationError)((0,zy.limitExceeded)(zy.LimitKind.LambdaCalls));if(!d&&this.usage.lambdaDepth+1>((n=this.globals.limits.maxLambdaDepth)!==null&&n!==void 0?n:1/0))return(0,Qc.throwEvaluationError)((0,zy.limitExceeded)(zy.LimitKind.LambdaDepth));d||(this.usage.lambdaDepth+=1),this.usage.lambdaCalls[0]+=1;var f=this.stackEnv;this.stackEnv=r.data.capturedStackEnv;var m=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=r.data.capturedStackMap;var v=this.locals;this.locals=(0,Qc.evalLocalsLambda)(r.data.capturedLocals,this.locals);var h=this.caller;return this.switchCaller(r.data.caller,d),d?this.updateTermTransition(r.children):this.pushContextTransition(r,r.children,{locals:v,caller:h,stackEnv:f,stackMap:m})}case ca.TermKind.CallFirstOrderFunc:{var v=this.locals;this.locals=(0,Mpr.evalLocalsFirstOrderFunc)(r.data.source,this.locals);var h=this.caller;this.switchCaller(r.data.caller,!1);var f=this.stackEnv;this.stackEnv=Xx.emptyStackEnv;var m=this.stackMapList();return this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.pushContextTransition(r,r.children,{locals:v,caller:h,stackEnv:f,stackMap:m})}case ca.TermKind.CallMachine:return(0,dJ.callMachineTransition)(r.data.machine,this);case ca.TermKind.Conditional:return this.pushContextTransition(r,r.children[0],void 0);case ca.TermKind.Let:{var y=r.children.length-1;if(y===0)return this.updateTermTransition(r.children[0]);var f=this.stackEnv,m=this.stackMapList();if(this.stackMapLabels=r.data.varLabels,this.stackMapNumPushed=0,this.stackMapNext=m,r.data.rec){for(var _=0;_<y;_+=1)this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),new Xx.LazyOper(qpr));this.stackMapNumPushed+=y}return this.pushContextTransition(r,r.children[0],{stackEnv:f,stackMap:m})}case ca.TermKind.Name:return this.updateTermTransition(this.evalNameTerm(r));case ca.TermKind.CallName:{var E=r.data.loc,N=this.checkForNameCycle(E),k=this.stackFrameList(r.position),v=this.locals;this.locals=(0,Qc.evalLocalsName)((0,wpr.lexicalSourceName)(E),v);var h=this.caller;this.switchCaller(k,!1);var f=this.stackEnv;this.stackEnv=Xx.emptyStackEnv;var m=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0;var q=this.visitedNames;return this.visitedNames=N,this.pushContextTransition(r,r.children,{locals:v,caller:h,stackEnv:f,stackMap:m,visitedNames:q})}case ca.TermKind.Udf:return this.updateTermTransition(this.evalUdfTerm(r));case ca.TermKind.ReadStack:{var V=this.stackEnv.getValue(this.stackEnv.getCount()-1-r.data);return(0,Qg.assertTrue)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadStack oper",V!==void 0),this.updateTermTransition(V instanceof Xx.LazyOper?V.value:V)}case ca.TermKind.Array:return this.pushContextTransition(r,r.children[0][0],r.children.map(function(){return[]}));case ca.TermKind.Lambda:return this.updateTermTransition(new Lpr.LambdaOper(r.data.checkArity,r.position,(a=r.data.params)!==null&&a!==void 0?a:[],this.locals,this.stackEnv,this.stackMapList(),r.children));case ca.TermKind.Noop:return this.updateTermTransition(r.children);default:return(0,Qg.assertNever)("calc.runtime.FormulaEvaluationMachine.reduceFormula",r)}},e.prototype.dispatchFunction=function(r,t,n){var a=t.funName,o=t.funType,u=t.isFormulaRoot;(0,i3.dereferenceOpers)(this,r,o);var s=new Yx.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(n),this.precedents,this.visitedCells,this.visitedNames,this.usage),l=s.dispatchFunction(a,o,u,r);return this.popContextTransition(l)},e.prototype.stackFrameList=function(r){return(0,n1e.stackFrameList)(this.locals.lexicalSource,r,this.stackEnv,this.stackMapList(),this.caller)},e.prototype.stackMapList=function(){return this.stackMapLabels!==void 0&&this.stackMapNumPushed!==0?(0,xpr.stackMapList)(this.stackMapLabels,this.stackMapNumPushed,this.stackMapNext):this.stackMapNext},e.prototype.noopTerm=function(r,t){return this.stepConfig!=null?(0,ca.noopTerm)(r,t):r},e.prototype.pushContextTransition=function(r,t,n){var a=t1e(r,n);return this.continuation.push(a),this.updateTermTransition(t)},e.prototype.popContextTransition=function(r){return this.continuation.pop(),this.updateTermTransition(r)},e.prototype.nextHoleTransition=function(r,t){var n=r;return n.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(r){if(this.term=r,this.stepConfig!=null&&!(0,ca.isOperTerm)(r)&&r.position!==void 0&&r.kind!==ca.TermKind.Name&&r.kind!==ca.TermKind.Udf){var t=Gpr(this.locals.lexicalSource,r.position,this.stackEnv,this.stackMapList(),this.caller);this.continuation.push(t1e(ca.postStepTerm,t));var n=this.stepConfig.preStep(t);if(n===zy.StepAction.Break)return dJ.breakTransition}return dJ.nextTransition},e.prototype.switchCaller=function(r,t){(0,Qg.assertTrue)("calc.runtime.FormulaEvaluationMachine.switchCaller: correct nesting",r.caller===this.caller),t||(this.caller=r)},e.prototype.restoreStack=function(r){var t,n=r.stackEnv,a=r.stackMap;this.stackEnv=n,this.stackMapLabels=a==null?void 0:a.labels,this.stackMapNumPushed=(t=a==null?void 0:a.numPushed)!==null&&t!==void 0?t:0,this.stackMapNext=a==null?void 0:a.next},e.prototype.isLetTcoPossible=function(){var r=this.continuation[this.continuation.length-2];if(r===void 0)return!1;var t=r.context;if(t.kind===ca.TermKind.Let){var n=r.holeIndex,a=t.children.length-1;return n>=a}return t.kind===ca.TermKind.CallLambda||t.kind===ca.TermKind.CallName},e.prototype.isCallLambdaTcoPossible=function(){var r=this.continuation[this.continuation.length-1];if(r===void 0)return!1;var t=r.context;return t.kind===ca.TermKind.CallLambda},e.prototype.getNameFormulaAsTerm=function(r,t){var n=this.globals.getNameFormula(r,t);if(n.kind===Nh.ResultKind.Failure)return(0,Qc.throwEvaluationError)(n.reason);var a=n.value;if(a!=null)return(0,a1e.compiledFormulaTerm)("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",a)},e.prototype.checkForNameCycle=function(r){var t,n=this.visitedNames,a=n.map.getValue(r);if(a!==void 0){var o=(0,$Ce.recordNameCycle)(a,n.current);return(0,Qc.throwEvaluationError)(o)}return this.visitedNames.map.getCount()+1>((t=this.globals.limits.maxNameChain)!==null&&t!==void 0?t:1/0)?(0,Qc.throwEvaluationError)((0,zy.limitExceeded)(zy.LimitKind.NameChain)):(0,$Ce.appendVisitedName)(this.visitedNames,r)},e.prototype.evalNameTerm=function(r){var t=this.context.resolver.resolveName(this.locals,(0,UF.nameNode)((0,UF.identNamePart)(r.data.name,!0),r.data.qualifier),r.data.source),n=t.resolution,a=t.precedents;if((0,a3.safePush)(this.precedents.names,a),!(0,Nh.isSuccess)(n)){if(n.reason.kind===BF.ResolveReasonKind.NoOriginSheet){var o="error ref, no sheet, qualifier = ".concat((0,Hy.anonymize)(r.data.qualifier));return(0,aS.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",Eu.ErrorType.REF,o),this.noopTerm(Eu.refErrorOper,r.position)}var u=r.children;return n.reason.kind===BF.ResolveReasonKind.InvalidQualifier&&u!==void 0?u:(0,Qc.throwEvaluationError)(n.reason)}var s=n.value,l;if(s===void 0||(l=this.getNameFormulaAsTerm(s,r.data.source))===void 0){var u=r.children;if(u===void 0){var o="error ref, qualifier = ".concat((0,Hy.anonymize)(r.data.qualifier));return(0,aS.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",Eu.ErrorType.NAME,o),this.noopTerm(Eu.nameErrorOper,r.position)}return u}return(0,ca.callNameTerm)(s,this.noopTerm(l,zy.runtimePositionFormulaRoot),r.position)},e.prototype.evalCellRefTerm=function(r){var t=this.context.resolver.resolveCellRef(this.locals,(0,UF.cellRefNode)(r.data.ref,r.data.qualifier)).resolution;if(!(0,Nh.isSuccess)(t)){if(t.reason.kind===BF.ResolveReasonKind.NoOriginSheet){var n="error ref, no sheet, qualifier = ".concat((0,Hy.anonymize)(r.data.qualifier));return(0,aS.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Eu.ErrorType.REF,n),Eu.refErrorOper}return(0,Qc.throwEvaluationError)(t.reason)}var a=t.value;if(!a){var n="error ref, qualifier = ".concat((0,Hy.anonymize)(r.data.qualifier));return(0,aS.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Eu.ErrorType.REF,n),Eu.refErrorOper}return(0,Eu.range3DOper)(a.sheet,a.range)},e.prototype.evalStructRefTerm=function(r){var t=this.context.resolver.resolveStructRef(this.locals,r.data),n=t.resolution,a=t.precedents;if((0,a3.safePush)(this.precedents.names,a),!(0,Nh.isSuccess)(n)){if(n.reason.kind===BF.ResolveReasonKind.NoOriginSheet){var o="error ref, no sheet, struct ref = ".concat((0,Hy.anonymize)(r.data));return(0,aS.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",Eu.ErrorType.REF,o),Eu.refErrorOper}if(n.reason.kind===BF.ResolveReasonKind.EmptyIntersection){var o="error ref, empty intersection, struct ref = ".concat((0,Hy.anonymize)(r.data));return(0,aS.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",Eu.ErrorType.VALUE,o),Eu.valueErrorOper}return(0,Qc.throwEvaluationError)(n.reason)}var u=n.value;if(!u){var o="error ref, struct ref = ".concat((0,Hy.anonymize)(r.data));return(0,aS.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",Eu.ErrorType.REF,o),Eu.refErrorOper}return(0,Eu.range3DOper)(u.sheet,u.range)},e.prototype.evalUdfTerm=function(r){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,(0,UF.nameNode)((0,UF.identNamePart)(r.data.name,!0),r.data.qualifier)),n=t.resolution,a=t.precedents;if((0,a3.safePush)(this.precedents.udfs,a),!(0,Nh.isSuccess)(n)){var o=r.children;if(n.reason.kind===BF.ResolveReasonKind.InvalidQualifier&&o!==void 0)return o;(0,Qc.throwEvaluationError)(n.reason)}var u=n.value;if(!u){var o=r.children;if(o===void 0){var s="UDF resolution, qualifier = ".concat((0,Hy.anonymize)(r.data.qualifier));return(0,aS.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Eu.ErrorType.NAME,s),this.noopTerm(Eu.nameErrorOper,r.position)}return o}if(u.length>1){var s="UDF resolution, ambiguous name";return(0,aS.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",Eu.ErrorType.NAME,s),this.noopTerm(Eu.nameErrorOper,r.position)}var l=u[0],c=this.globals.getUserDefinedFunc(l);return(0,Nh.isSuccess)(c)||(0,Qc.throwEvaluationError)(c.reason),new Yx.UdfOper(l,c.value)},e}();function Bpr(e,r,t,n,a,o,u,s){var l,c=t.contextNames,d=c===void 0?[]:c,f=s.annotations[s.node.label],m=(l=(f==null?void 0:f.kind)===UF.AnnotationKind.FormulaRoot?f.contextNames:void 0)!==null&&l!==void 0?l:[];return(0,Qg.assertTrue)("calc.runtime.FormulaEvaluationMachine.createFormulaEvaluationMachine: contextNames",m.length===d.length&&d.every(function(v,h){return v.label===m[h].label})),new i1e(e,r,t,n,a,o,(0,Qc.evalUsage)([0],0),u,!1,(0,ca.noopTerm)((0,a1e.compiledFormulaTerm)("calc.runtime.createFormulaEvaluationMachine",s),zy.runtimePositionFormulaRoot),d)}KF.createFormulaEvaluationMachine=Bpr;function Upr(e,r,t,n,a,o,u,s){return new i1e(e,r,t,n,a,o,(0,Qc.evalUsage)(u.lambdaCalls,u.lambdaDepth),pJ.SignatureType.All,!0,s,[])}KF.createCallTermEvaluationMachine=Upr});var mJ=T(s3=>{"use strict";p();Object.defineProperty(s3,"__esModule",{value:!0});s3.createAnalyzer=void 0;var Kpr=Jf();s3.createAnalyzer=Kpr.analyzeService.createAnalyzer});var gJ=T(VF=>{"use strict";p();Object.defineProperty(VF,"__esModule",{value:!0});VF.createPrinter=VF.anonymizeFormula=void 0;var o1e=qr();VF.anonymizeFormula=o1e.printService.anonymizeFormula;VF.createPrinter=o1e.printService.createPrinter});var c3=T(l3=>{"use strict";p();Object.defineProperty(l3,"__esModule",{value:!0});l3.createNumberFormatter=void 0;var Vpr=ep();l3.createNumberFormatter=Vpr.formatService.createNumberFormatter});var vJ=T(d3=>{"use strict";p();Object.defineProperty(d3,"__esModule",{value:!0});d3.createParser=void 0;var jpr=Jf();d3.createParser=jpr.parserService.createParser});var s1e=T(p3=>{"use strict";p();Object.defineProperty(p3,"__esModule",{value:!0});p3.createNameEvaluationMachine=void 0;var Wpr=Vy(),Hpr=fi(),zpr=Dl(),Jx=Ux(),u1e=fs(),Qpr=au(),f3=qo(),hJ=H0(),Xpr=function(){function e(r,t,n,a){this.context=r,this.stepConfig=t,this.name=n,this.origin=a}return e.prototype.evalName=function(){var r=this.context.globals.getNameFormula(this.name,u1e.NameSource.Plain);if(r.kind===zpr.ResultKind.Failure)return Jx.Pledge.reject(r.reason);var t=r.value;if(t==null)return Jx.Pledge.resolve(void 0);var n=(0,f3.bottomEvalPrecedents)(),a=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,f3.evalLocalsName)((0,u1e.lexicalSourceName)(this.name),(0,f3.evalLocalsGrid)(this.origin)),n,hJ.emptyVisitedCells,(0,hJ.appendVisitedName)(hJ.emptyVisitedNames,this.name),Qpr.SignatureType.All,t);return Jx.Pledge.fromMachine(a).catch(this.receiveFailure())},e.prototype.receiveFailure=function(){return function(r){if(r.kind===f3.RuntimeInternalReasonKind.Unevaluated){var t="unexpected reason ".concat((0,Wpr.anonymize)(r)),n="calc.runtime.NameEvaluationMachine.receiveFailure: ".concat(t);return(0,Hpr.assertFalse)(n)}return Jx.Pledge.reject(r)}},e}();function Ypr(e,r,t,n){return Jx.Pledge.try(function(){return new Xpr(e,r,t,n).evalName()})}p3.createNameEvaluationMachine=Ypr});var S1e=T(hf=>{"use strict";p();Object.defineProperty(hf,"__esModule",{value:!0});hf.createEvaluator=hf.evalName=hf.evalCellsAsync=hf.evalCells=hf.evalFormula=hf.evaluationMachineContext=hf.runtimeEvaluationContext=void 0;var Jpr=mJ(),Zpr=Vy(),$pr=fi(),SJ=Dl(),emr=gJ(),rmr=OU(),l1e=Na(),tmr=c3(),nmr=vJ(),d1e=n3(),yJ=u3(),amr=s1e(),hC=ZU(),c1e=qo(),imr=oc(),omr=oc(),m3=Fm(),_J=H0();function g3(e){return{globals:e,timer:(0,hC.runtimeTimer)(),machineContext:f1e(e)}}hf.runtimeEvaluationContext=g3;function f1e(e){return{globals:e,resolver:(0,rmr.createResolver)(e),numberFormatter:(0,tmr.createNumberFormatter)(e),parser:(0,nmr.createParser)(e),printer:(0,emr.createPrinter)(e),analyzer:(0,Jpr.createAnalyzer)(e),createCellEvaluationMachine:d1e.createCellEvaluationMachine,createFormulaEvaluationMachine:yJ.createFormulaEvaluationMachine,createCallTermEvaluationMachine:yJ.createCallTermEvaluationMachine}}hf.evaluationMachineContext=f1e;function bJ(e){if(Array.isArray(e)){var r=e[0];if(r.kind===SJ.ResultKind.Success){if((0,l1e.isRangeOper)(r.value)||(0,l1e.isMissingOper)(r.value)){var t="expected ReadOper; given ".concat((0,Zpr.anonymize)(r)),n="calc.runtime.evalFormula: ".concat(t);return(0,$pr.assertFalse)(n)}return r}return r}return e.kind===SJ.ResultKind.Paused?(0,m3.paused)(function(a){return bJ(e.resume(a))}):(0,m3.breaked)(function(){return bJ(e.resume())})}function p1e(e,r,t){var n,a=g3(e),o=(0,c1e.bottomEvalPrecedents)(),u=(0,yJ.createFormulaEvaluationMachine)(a.machineContext,r.stepConfig,(0,c1e.evalLocalsSlice)(r),o,_J.emptyVisitedCells,_J.emptyVisitedNames,omr.readOperType,t),s=new hC.EvaluationRuntime(a,[u]),l=(0,hC.createSchedule)((n=r.schedulerConfig)!==null&&n!==void 0?n:e.schedulerConfig);return bJ(s.evaluateSync(l))}hf.evalFormula=p1e;function m1e(e,r,t){for(var n=g3(e),a=[],o=0;o<t.length;o+=1)a.push(new imr.VoidMachine((0,d1e.createCellEvaluationMachine)(n.machineContext,r,_J.emptyVisitedCells,t[o])));return new hC.EvaluationRuntime(n,a)}function g1e(e,r,t){var n;if(t.length===0)return[];var a=m1e(e,r.stepConfig,t),o=(0,hC.createSchedule)((n=r.schedulerConfig)!==null&&n!==void 0?n:e.schedulerConfig);return a.evaluateSync(o)}hf.evalCells=g1e;function v1e(e,r,t){var n;if(t.length===0)return Promise.resolve([]);var a=m1e(e,void 0,t),o=(0,hC.createSchedule)((n=r.schedulerConfig)!==null&&n!==void 0?n:e.schedulerConfig);return a.evaluateAsync(o)}hf.evalCellsAsync=v1e;function CJ(e){return Array.isArray(e)?e[0]:e.kind===SJ.ResultKind.Paused?(0,m3.paused)(function(r){return CJ(e.resume(r))}):(0,m3.breaked)(function(){return CJ(e.resume())})}function h1e(e,r,t,n){var a,o=g3(e),u=(0,amr.createNameEvaluationMachine)(o.machineContext,r.stepConfig,t,n),s=new hC.EvaluationRuntime(o,[u]),l=(0,hC.createSchedule)((a=r.schedulerConfig)!==null&&a!==void 0?a:e.schedulerConfig);return CJ(s.evaluateSync(l))}hf.evalName=h1e;function umr(e){return{evalFormula:function(t,n){return p1e(e,t,n)},evalCells:function(t,n){return g1e(e,t,n)},evalName:function(t,n,a){return h1e(e,t,n,a)},evalCellsAsync:function(t,n){return v1e(e,t,n)}}}hf.createEvaluator=umr});var y1e=T(SC=>{"use strict";p();Object.defineProperty(SC,"__esModule",{value:!0});SC.featureEnabledDummyCallback=SC.ConsoleLogger=SC.AssertLogger=void 0;var TJ=pr();SC.AssertLogger=TJ.testConfig.AssertLogger;SC.ConsoleLogger=TJ.testConfig.ConsoleLogger;SC.featureEnabledDummyCallback=TJ.testConfig.featureEnabledDummyCallback});var _1e=T(ir=>{"use strict";p();Object.defineProperty(ir,"__esModule",{value:!0});ir.fieldRef=ir.fieldRefNamePart=ir.lambdaNode=ir.letNode=ir.nameNode=ir.xorNode=ir.unionNode=ir.subNode=ir.sheet1Name=ir.sheet1=ir.relPos=ir.rangeNode=ir.powNode=ir.poundNode=ir.posNode=ir.percentNode=ir.orNode=ir.negNode=ir.neNode=ir.mulNode=ir.minNode=ir.maxNode=ir.ltNode=ir.leNode=ir.isectNode=ir.isNameLocEqual=ir.gtNode=ir.geNode=ir.expectTrue=ir.eqNode=ir.document1=ir.divNode=ir.createSingleRange=ir.concatNode=ir.badUnexpCharsNode=ir.badStructRefNode=ir.badStringLiteralNode=ir.badUnexpSeqNode=ir.badQualNode=ir.badParamNameNode=ir.badNumberLiteralNode=ir.badFieldRefNode=ir.badFieldNameNode=ir.badErrorLiteralNode=ir.badCellRefNode=ir.badBracketNode=ir.atNode=ir.andNode=ir.addNode=ir.absPos=void 0;var Sn=qr();ir.absPos=Sn.testUtil.absPos;ir.addNode=Sn.testUtil.addNode;ir.andNode=Sn.testUtil.andNode;ir.atNode=Sn.testUtil.atNode;ir.badBracketNode=Sn.testUtil.badBracketNode;ir.badCellRefNode=Sn.testUtil.badCellRefNode;ir.badErrorLiteralNode=Sn.testUtil.badErrorLiteralNode;ir.badFieldNameNode=Sn.testUtil.badFieldNameNode;ir.badFieldRefNode=Sn.testUtil.badFieldRefNode;ir.badNumberLiteralNode=Sn.testUtil.badNumberLiteralNode;ir.badParamNameNode=Sn.testUtil.badParamNameNode;ir.badQualNode=Sn.testUtil.badQualNode;ir.badUnexpSeqNode=Sn.testUtil.badUnexpSeqNode;ir.badStringLiteralNode=Sn.testUtil.badStringLiteralNode;ir.badStructRefNode=Sn.testUtil.badStructRefNode;ir.badUnexpCharsNode=Sn.testUtil.badUnexpCharsNode;ir.concatNode=Sn.testUtil.concatNode;ir.createSingleRange=Sn.testUtil.createSingleRange;ir.divNode=Sn.testUtil.divNode;ir.document1=Sn.testUtil.document1;ir.eqNode=Sn.testUtil.eqNode;ir.expectTrue=Sn.testUtil.expectTrue;ir.geNode=Sn.testUtil.geNode;ir.gtNode=Sn.testUtil.gtNode;ir.isNameLocEqual=Sn.testUtil.isNameLocEqual;ir.isectNode=Sn.testUtil.isectNode;ir.leNode=Sn.testUtil.leNode;ir.ltNode=Sn.testUtil.ltNode;ir.maxNode=Sn.testUtil.maxNode;ir.minNode=Sn.testUtil.minNode;ir.mulNode=Sn.testUtil.mulNode;ir.neNode=Sn.testUtil.neNode;ir.negNode=Sn.testUtil.negNode;ir.orNode=Sn.testUtil.orNode;ir.percentNode=Sn.testUtil.percentNode;ir.posNode=Sn.testUtil.posNode;ir.poundNode=Sn.testUtil.poundNode;ir.powNode=Sn.testUtil.powNode;ir.rangeNode=Sn.testUtil.rangeNode;ir.relPos=Sn.testUtil.relPos;ir.sheet1=Sn.testUtil.sheet1;ir.sheet1Name=Sn.testUtil.sheet1Name;ir.subNode=Sn.testUtil.subNode;ir.unionNode=Sn.testUtil.unionNode;ir.xorNode=Sn.testUtil.xorNode;ir.nameNode=Sn.testUtil.nameNode;ir.letNode=Sn.testUtil.letNode;ir.lambdaNode=Sn.testUtil.lambdaNode;ir.fieldRefNamePart=Sn.testUtil.fieldRefNamePart;ir.fieldRef=Sn.testUtil.fieldRef});var v3=T(ce=>{"use strict";p();Object.defineProperty(ce,"__esModule",{value:!0});ce.codePointExclamationMark=ce.codePointEuroSign=ce.codePointEqualsSign=ce.codePointDoubleQuote=ce.codePointDollarSign=ce.codePointDigitZero=ce.codePointDigitTwo=ce.codePointDigitThree=ce.codePointDigitSix=ce.codePointDigitSeven=ce.codePointDigitOne=ce.codePointDigitNine=ce.codePointDigitFour=ce.codePointDigitFive=ce.codePointDigitEight=ce.codePointComma=ce.codePointColon=ce.codePointCircumflexAccent=ce.codePointCapitalZ=ce.codePointCapitalY=ce.codePointCapitalX=ce.codePointCapitalW=ce.codePointCapitalV=ce.codePointCapitalU=ce.codePointCapitalT=ce.codePointCapitalS=ce.codePointCapitalR=ce.codePointCapitalQ=ce.codePointCapitalP=ce.codePointCapitalO=ce.codePointCapitalN=ce.codePointCapitalM=ce.codePointCapitalL=ce.codePointCapitalK=ce.codePointCapitalJ=ce.codePointCapitalI=ce.codePointCapitalH=ce.codePointCapitalG=ce.codePointCapitalF=ce.codePointCapitalE=ce.codePointCapitalD=ce.codePointCapitalC=ce.codePointCapitalB=ce.codePointCapitalA=ce.codePointCR=ce.codePointBacktick=ce.codePointBackslash=ce.codePointAtSign=ce.codePointAsterisk=ce.codePointAmpersand=void 0;ce.codePointSmallW=ce.codePointSmallV=ce.codePointSmallU=ce.codePointSmallT=ce.codePointSmallS=ce.codePointSmallR=ce.codePointSmallQ=ce.codePointSmallP=ce.codePointSmallO=ce.codePointSmallN=ce.codePointSmallM=ce.codePointSmallL=ce.codePointSmallK=ce.codePointSmallJ=ce.codePointSmallI=ce.codePointSmallH=ce.codePointSmallG=ce.codePointSmallF=ce.codePointSmallE=ce.codePointSmallD=ce.codePointSmallC=ce.codePointSmallB=ce.codePointSmallA=ce.codePointSlash=ce.codePointSingleQuote=ce.codePointSemicolon=ce.codePointRightSquareBracket=ce.codePointRightParen=ce.codePointRightCurlyBracket=ce.codePointQuestionMark=ce.codePointPlusSign=ce.codePointPipe=ce.codePointPercentSign=ce.codePointMinusSign=ce.codePointLessThanSign=ce.codePointLeftSquareBracket=ce.codePointLeftParen=ce.codePointLeftCurlyBracket=ce.codePointLF=ce.codePointInvertedQuestionMark=ce.codePointInvertedExclamationMark=ce.codePointHash=ce.codePointGreaterThanSign=ce.codePointFullwidthLatinSmallZ=ce.codePointFullwidthLatinSmallA=ce.codePointFullwidthLatinCapitalZ=ce.codePointFullwidthLatinCapitalA=ce.codePointFullwidthDigitZero=ce.codePointFullwidthDigitNine=ce.codePointFullStop=void 0;ce.codePointUnderscore=ce.codePointTilde=ce.codePointThaiDigitZero=ce.codePointThaiDigitNine=ce.codePointTab=ce.codePointSpace=ce.codePointSmallZ=ce.codePointSmallY=ce.codePointSmallX=void 0;var Je=pr();ce.codePointAmpersand=Je.codePoint.codePointAmpersand;ce.codePointAsterisk=Je.codePoint.codePointAsterisk;ce.codePointAtSign=Je.codePoint.codePointAtSign;ce.codePointBackslash=Je.codePoint.codePointBackslash;ce.codePointBacktick=Je.codePoint.codePointBacktick;ce.codePointCR=Je.codePoint.codePointCR;ce.codePointCapitalA=Je.codePoint.codePointCapitalA;ce.codePointCapitalB=Je.codePoint.codePointCapitalB;ce.codePointCapitalC=Je.codePoint.codePointCapitalC;ce.codePointCapitalD=Je.codePoint.codePointCapitalD;ce.codePointCapitalE=Je.codePoint.codePointCapitalE;ce.codePointCapitalF=Je.codePoint.codePointCapitalF;ce.codePointCapitalG=Je.codePoint.codePointCapitalG;ce.codePointCapitalH=Je.codePoint.codePointCapitalH;ce.codePointCapitalI=Je.codePoint.codePointCapitalI;ce.codePointCapitalJ=Je.codePoint.codePointCapitalJ;ce.codePointCapitalK=Je.codePoint.codePointCapitalK;ce.codePointCapitalL=Je.codePoint.codePointCapitalL;ce.codePointCapitalM=Je.codePoint.codePointCapitalM;ce.codePointCapitalN=Je.codePoint.codePointCapitalN;ce.codePointCapitalO=Je.codePoint.codePointCapitalO;ce.codePointCapitalP=Je.codePoint.codePointCapitalP;ce.codePointCapitalQ=Je.codePoint.codePointCapitalQ;ce.codePointCapitalR=Je.codePoint.codePointCapitalR;ce.codePointCapitalS=Je.codePoint.codePointCapitalS;ce.codePointCapitalT=Je.codePoint.codePointCapitalT;ce.codePointCapitalU=Je.codePoint.codePointCapitalU;ce.codePointCapitalV=Je.codePoint.codePointCapitalV;ce.codePointCapitalW=Je.codePoint.codePointCapitalW;ce.codePointCapitalX=Je.codePoint.codePointCapitalX;ce.codePointCapitalY=Je.codePoint.codePointCapitalY;ce.codePointCapitalZ=Je.codePoint.codePointCapitalZ;ce.codePointCircumflexAccent=Je.codePoint.codePointCircumflexAccent;ce.codePointColon=Je.codePoint.codePointColon;ce.codePointComma=Je.codePoint.codePointComma;ce.codePointDigitEight=Je.codePoint.codePointDigitEight;ce.codePointDigitFive=Je.codePoint.codePointDigitFive;ce.codePointDigitFour=Je.codePoint.codePointDigitFour;ce.codePointDigitNine=Je.codePoint.codePointDigitNine;ce.codePointDigitOne=Je.codePoint.codePointDigitOne;ce.codePointDigitSeven=Je.codePoint.codePointDigitSeven;ce.codePointDigitSix=Je.codePoint.codePointDigitSix;ce.codePointDigitThree=Je.codePoint.codePointDigitThree;ce.codePointDigitTwo=Je.codePoint.codePointDigitTwo;ce.codePointDigitZero=Je.codePoint.codePointDigitZero;ce.codePointDollarSign=Je.codePoint.codePointDollarSign;ce.codePointDoubleQuote=Je.codePoint.codePointDoubleQuote;ce.codePointEqualsSign=Je.codePoint.codePointEqualsSign;ce.codePointEuroSign=Je.codePoint.codePointEuroSign;ce.codePointExclamationMark=Je.codePoint.codePointExclamationMark;ce.codePointFullStop=Je.codePoint.codePointFullStop;ce.codePointFullwidthDigitNine=Je.codePoint.codePointFullwidthDigitNine;ce.codePointFullwidthDigitZero=Je.codePoint.codePointFullwidthDigitZero;ce.codePointFullwidthLatinCapitalA=Je.codePoint.codePointFullwidthLatinCapitalA;ce.codePointFullwidthLatinCapitalZ=Je.codePoint.codePointFullwidthLatinCapitalZ;ce.codePointFullwidthLatinSmallA=Je.codePoint.codePointFullwidthLatinSmallA;ce.codePointFullwidthLatinSmallZ=Je.codePoint.codePointFullwidthLatinSmallZ;ce.codePointGreaterThanSign=Je.codePoint.codePointGreaterThanSign;ce.codePointHash=Je.codePoint.codePointHash;ce.codePointInvertedExclamationMark=Je.codePoint.codePointInvertedExclamationMark;ce.codePointInvertedQuestionMark=Je.codePoint.codePointInvertedQuestionMark;ce.codePointLF=Je.codePoint.codePointLF;ce.codePointLeftCurlyBracket=Je.codePoint.codePointLeftCurlyBracket;ce.codePointLeftParen=Je.codePoint.codePointLeftParen;ce.codePointLeftSquareBracket=Je.codePoint.codePointLeftSquareBracket;ce.codePointLessThanSign=Je.codePoint.codePointLessThanSign;ce.codePointMinusSign=Je.codePoint.codePointMinusSign;ce.codePointPercentSign=Je.codePoint.codePointPercentSign;ce.codePointPipe=Je.codePoint.codePointPipe;ce.codePointPlusSign=Je.codePoint.codePointPlusSign;ce.codePointQuestionMark=Je.codePoint.codePointQuestionMark;ce.codePointRightCurlyBracket=Je.codePoint.codePointRightCurlyBracket;ce.codePointRightParen=Je.codePoint.codePointRightParen;ce.codePointRightSquareBracket=Je.codePoint.codePointRightSquareBracket;ce.codePointSemicolon=Je.codePoint.codePointSemicolon;ce.codePointSingleQuote=Je.codePoint.codePointSingleQuote;ce.codePointSlash=Je.codePoint.codePointSlash;ce.codePointSmallA=Je.codePoint.codePointSmallA;ce.codePointSmallB=Je.codePoint.codePointSmallB;ce.codePointSmallC=Je.codePoint.codePointSmallC;ce.codePointSmallD=Je.codePoint.codePointSmallD;ce.codePointSmallE=Je.codePoint.codePointSmallE;ce.codePointSmallF=Je.codePoint.codePointSmallF;ce.codePointSmallG=Je.codePoint.codePointSmallG;ce.codePointSmallH=Je.codePoint.codePointSmallH;ce.codePointSmallI=Je.codePoint.codePointSmallI;ce.codePointSmallJ=Je.codePoint.codePointSmallJ;ce.codePointSmallK=Je.codePoint.codePointSmallK;ce.codePointSmallL=Je.codePoint.codePointSmallL;ce.codePointSmallM=Je.codePoint.codePointSmallM;ce.codePointSmallN=Je.codePoint.codePointSmallN;ce.codePointSmallO=Je.codePoint.codePointSmallO;ce.codePointSmallP=Je.codePoint.codePointSmallP;ce.codePointSmallQ=Je.codePoint.codePointSmallQ;ce.codePointSmallR=Je.codePoint.codePointSmallR;ce.codePointSmallS=Je.codePoint.codePointSmallS;ce.codePointSmallT=Je.codePoint.codePointSmallT;ce.codePointSmallU=Je.codePoint.codePointSmallU;ce.codePointSmallV=Je.codePoint.codePointSmallV;ce.codePointSmallW=Je.codePoint.codePointSmallW;ce.codePointSmallX=Je.codePoint.codePointSmallX;ce.codePointSmallY=Je.codePoint.codePointSmallY;ce.codePointSmallZ=Je.codePoint.codePointSmallZ;ce.codePointSpace=Je.codePoint.codePointSpace;ce.codePointTab=Je.codePoint.codePointTab;ce.codePointThaiDigitNine=Je.codePoint.codePointThaiDigitNine;ce.codePointThaiDigitZero=Je.codePoint.codePointThaiDigitZero;ce.codePointTilde=Je.codePoint.codePointTilde;ce.codePointUnderscore=Je.codePoint.codePointUnderscore});var h3=T(zu=>{"use strict";p();Object.defineProperty(zu,"__esModule",{value:!0});zu.surrogatePairToCodePoint=zu.stringFromCodePoint=zu.stringCodePointAt=zu.scanCodePointsBack=zu.scanCodePoints=zu.numCodeUnits=zu.isLowSurrogate=zu.isHighSurrogate=zu.isAnySurrogate=zu.countCodePoints=zu.codePointIterator=void 0;var Oh=pr();zu.codePointIterator=Oh.unicode.codePointIterator;zu.countCodePoints=Oh.unicode.countCodePoints;zu.isAnySurrogate=Oh.unicode.isAnySurrogate;zu.isHighSurrogate=Oh.unicode.isHighSurrogate;zu.isLowSurrogate=Oh.unicode.isLowSurrogate;zu.numCodeUnits=Oh.unicode.numCodeUnits;zu.scanCodePoints=Oh.unicode.scanCodePoints;zu.scanCodePointsBack=Oh.unicode.scanCodePointsBack;zu.stringCodePointAt=Oh.unicode.stringCodePointAt;zu.stringFromCodePoint=Oh.unicode.stringFromCodePoint;zu.surrogatePairToCodePoint=Oh.unicode.surrogatePairToCodePoint});var Zx=T(S3=>{"use strict";p();Object.defineProperty(S3,"__esModule",{value:!0});S3.WildExp=void 0;var smr=fe(),EJ=smr.__importStar(v3()),RJ=h3(),yC;(function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"})(yC||(yC={}));var b1e=EJ.codePointTilde,C1e=EJ.codePointQuestionMark,T1e=EJ.codePointAsterisk,lmr=function(){function e(r,t,n){n===void 0&&(n=!1),this.localeInfo=r,this.source=t,this.appendWildcard=n,this.bytecode=[],this.blocks=[];for(var a="",o=0;o<t.length;o+=1){var u=t.charCodeAt(o);if(u===b1e&&o+1<t.length){var s=(0,RJ.stringCodePointAt)(t,o+1);a+=(0,RJ.stringFromCodePoint)(s),o+=(0,RJ.numCodeUnits)(s);continue}if(u!==b1e){if(u===C1e||u===T1e){this.pushBlock(a),a="",this.pushMeta(u);continue}a+=t.charAt(o)}}this.bytecode.length===0&&(this.simplePattern=a),this.pushBlock(a),n&&this.pushMeta(T1e)}return e.prototype.pushBlock=function(r){if(r!==""){var t=this.blocks.length;this.blocks.push(r),this.bytecode.push(t);for(var n=1;n<r.length;n+=1)this.bytecode.push(yC.OP_DOT)}},e.prototype.pushMeta=function(r){r===C1e?this.bytecode.push(yC.OP_DOT):this.bytecode.push(yC.OP_DOTSTAR)},e.prototype.test=function(r){if(this.simplePattern!==void 0)return this.testSimple(r,this.simplePattern);var t=Object.create(null);this.addState(t,0);for(var n=0;n<r.length;n+=1){var a=Object.keys(t);if(t=Object.create(null),a.length===0)return!1;for(var o=0;o<a.length;o+=1){var u=Number(a[o]);if(u!==this.bytecode.length){var s=this.bytecode[u];switch(s){case yC.OP_DOT:this.addState(t,u+1);break;case yC.OP_DOTSTAR:this.addState(t,u);break;default:var l=this.blocks[s];n+l.length<=r.length&&this.localeInfo.stringCompareCI(l,r.substring(n,n+l.length))===0&&this.addState(t,u+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(r,t){r[t]=!0;for(var n=this.bytecode,a=t;a<n.length&&n[a]===yC.OP_DOTSTAR;a+=1)r[a+1]=!0},e.prototype.testSimple=function(r,t){return t.length<=r.length&&(t.length===r.length||this.appendWildcard)&&this.localeInfo.stringCompareCI(t,r.substring(0,t.length))===0},e}();S3.WildExp=lmr});var PJ=T(_C=>{"use strict";p();Object.defineProperty(_C,"__esModule",{value:!0});_C.applyCriteria=_C.compileCriteria=_C.parseCriteria=void 0;var y3=Ua(),Vs=vf(),cmr=Nm(),R1e=Il(),$x=VU(),np=Na(),dmr=fi(),fmr=Zx(),eI=uc(),_3=au(),pmr={"=":Vs.OperatorId.Eq,"<":Vs.OperatorId.Lt,">":Vs.OperatorId.Gt},mmr={"<>":Vs.OperatorId.Ne,"<=":Vs.OperatorId.Le,">=":Vs.OperatorId.Ge};function gmr(e){if(e.length>=2){var r=mmr[e.substring(0,2)];if(r!==void 0)return[r,e.substring(2)]}if(e.length>=1){var r=pmr[e.substring(0,1)];if(r!==void 0)return[r,e.substring(1)]}return[void 0,e]}function vmr(e,r){var t=e.config.localeInfo;if(t.stringCompareCI(r,t.trueName)===0)return y3.trueOper;if(t.stringCompareCI(r,t.falseName)===0)return y3.falseOper;for(var n=1;n<t.errorNames.length;n+=1){var a=t.errorNames[n];if(a!=null&&t.stringCompareCI(a,r)===0)return(0,y3.errorOper)(n)}var o=e.parseGeneral(r,!1);return o!==void 0?o:(0,y3.stringOper)(r)}function E1e(e,r){if(!(0,np.isStringOper)(r))return r;var t=gmr(r.value),n=t[0],a=t[1],o=vmr(e,a),u={kind:"FilterExpression",operator:n,operand:o};return u}_C.parseCriteria=E1e;function P1e(e,r){var t=r.kind==="FilterExpression"?r:{kind:"FilterExpression",operator:Vs.OperatorId.Eq,operand:r},n=e.config,a=n.mathpack,o=n.localeInfo;function u(f,m){return function(v){var h=(0,np.isRichOper)(v)?v.getFallback():v;if((0,np.isNumberOper)(h))return(0,$x.cmpNum)(a,f,h,m);if((0,np.isStringOper)(h)&&f===Vs.OperatorId.Eq){var y=e.parseGeneral(h.value,!1);return y!==void 0?(0,$x.cmpNum)(a,f,y,m):!1}return f===Vs.OperatorId.Ne}}function s(f,m){return function(v){var h=(0,np.isRichOper)(v)?v.getFallback():v;return(0,np.isBooleanOper)(h)?(0,$x.cmpBool)(f,h,m):f===Vs.OperatorId.Ne}}function l(f,m){return function(v){var h=(0,np.isRichOper)(v)?v.getFallback():v;return(0,np.isErrorOper)(h)?(0,$x.cmpInt)(f,h.type-m.type):f===Vs.OperatorId.Ne}}function c(f,m){switch(f){case Vs.OperatorId.Eq:case Vs.OperatorId.Ne:var v=new fmr.WildExp(o,m.value);return function(h){var y=(0,np.isRichOper)(h)?h.getFallback():h;if(!(0,np.isStringOper)(y))return f===Vs.OperatorId.Ne;var _=v.test(y.value);return _===(f===Vs.OperatorId.Eq)};case Vs.OperatorId.Lt:case Vs.OperatorId.Gt:case Vs.OperatorId.Le:case Vs.OperatorId.Ge:return function(h){var y=(0,np.isRichOper)(h)?h.getFallback():h;return(0,np.isStringOper)(y)?(0,$x.cmpStr)(o,f,y,m):!1}}}if(t.operator===Vs.OperatorId.Ne&&(0,eI.isEmptyStringOper)(t.operand))return function(f){return!(0,np.isBlankOper)(f)};if(t.operator===Vs.OperatorId.Eq&&(0,eI.isEmptyStringOper)(t.operand))return np.isBlankOper;if(t.operator!==void 0&&(0,eI.isEmptyStringOper)(t.operand))return function(f){return!1};if(t.operator===void 0&&(0,eI.isEmptyStringOper)(t.operand))return function(f){return(0,np.isBlankOper)(f)||(0,eI.isEmptyStringOper)(f)};var d=t.operator===void 0?Vs.OperatorId.Eq:t.operator;switch(t.operand.kind){case _3.OperKind.Number:return u(d,t.operand);case _3.OperKind.Boolean:return s(d,t.operand);case _3.OperKind.String:return c(d,t.operand);case _3.OperKind.Error:return l(d,t.operand);default:return(0,dmr.assertNever)("calc.funcs.criteria.compileCriteria",t.operand)}}_C.compileCriteria=P1e;function hmr(e,r,t,n){var a=P1e(e,E1e(e,t)),o=r,u=n===void 0?o:n,s=function(f,m){var v=o.get(f,m);return a(v)?u.get(f,m):void 0},l=function(){var f=o.getSparse();return a(f)?u.getSparse():void 0},c=new cmr.NonstrictSparseArray2D(u.rows,u.cols,(0,R1e.fastMax)(o.denseRows,u.denseRows),(0,R1e.fastMax)(o.denseCols,u.denseCols),s,l);return c}_C.applyCriteria=hmr});var FJ=T(oS=>{"use strict";p();Object.defineProperty(oS,"__esModule",{value:!0});oS.reduceDerefOpers=oS.isPrimitiveCoercedOper=oS.isCoercedArrayOper=oS.coercedArrayOper=void 0;var Smr=dC(),ymr=Nm(),AJ=fi(),jF=au();function _mr(e,r,t){return(0,AJ.assertNatural)("calc.runtime.coercedArrayOper",e),(0,AJ.assertNatural)("calc.runtime.coercedArrayOper",r),t.length!==e?(0,AJ.assertFalse)("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:jF.OperKind.Array,rows:e,cols:r,opers:t}}oS.coercedArrayOper=_mr;function bmr(e){return e.kind===jF.OperKind.Array}oS.isCoercedArrayOper=bmr;var Cmr=jF.OperKind.Number|jF.OperKind.String|jF.OperKind.Boolean;function Tmr(e){var r=e.kind;return typeof r=="number"&&(r&Cmr)!==0}oS.isPrimitiveCoercedOper=Tmr;function Rmr(e,r,t,n,a){var o=function(c,d,f,m){if((d==null?void 0:d.kind)===jF.OperKind.Array){for(var v=new ymr.StrictArray2D(d.rows,d.cols,d.opers),h=c,y=0;y<f;y+=1)h=u(h,v);return h}var _=m&&a!==void 0?a:t,E=_(e,d);return E==null?c:r(c,E,f)};function u(l,c){for(var d=l,f=0;f<c.rows;f+=1)for(var m=0;m<c.cols;m+=1){var v=c.get(f,m);v!==void 0&&(d=o(d,v,1,!0))}return d}function s(l,c){for(var d=l,f=c.getSparse(),m=c.cols-c.denseCols,v=0;v<c.denseRows;v+=1){for(var h=0;h<c.denseCols;h+=1){var y=c.get(v,h);y!==void 0&&(d=o(d,y,1,!1))}m>0&&f!==void 0&&(d=o(d,f,m,!1))}var _=(c.rows-c.denseRows)*c.cols;return _>0&&f!==void 0&&(d=o(d,f,_,!1)),d}return n.reduce(function(l,c){return(0,Smr.isRangeValues)(c)?c.arrays.reduce(s,l):o(l,c,1,!1)},void 0)}oS.reduceDerefOpers=Rmr});var xm=T(Oa=>{"use strict";p();Object.defineProperty(Oa,"__esModule",{value:!0});Oa.getAbsoluteIndex=Oa.rangeOrArrayToVal=Oa.makeSlicer=Oa.ArraySlicer=Oa.RangeSlicer=Oa.validateArraySize=Oa.numInt=Oa.numMod=Oa.validDateRange=Oa.chkNumMultiOper=Oa.chkDateOper=Oa.atpm1904to1900Days=Oa.chkNumOper=Oa.assertError=Oa.assertString=Oa.assertNumber=Oa.wrap2=Oa.wrap1=void 0;var ap=Ua(),A1e=oc(),WF=fi(),yf=Na(),b3=Nm(),Sf=au(),bC=Dl(),Emr=qo(),Pmr=fs(),Amr=fC();function Fmr(e){return function(r,t){return e(r)(t[0])}}Oa.wrap1=Fmr;function Nmr(e){return function(r,t){return e(r)(t[0],t[1])}}Oa.wrap2=Nmr;var Omr=function(r){return(0,yf.isNumberOper)(r)?r:(0,WF.assertFalse)("calc.funcs.assertNumber")};Oa.assertNumber=Omr;var kmr=function(r){return(0,yf.isStringOper)(r)?r:(0,WF.assertFalse)("calc.funcs.assertString")};Oa.assertString=kmr;var Mmr=function(r){return(0,yf.isErrorOper)(r)?r:(0,WF.assertFalse)("calc.funcs.assertError")};Oa.assertError=Mmr;function F1e(e,r){var t=(0,A1e.refToVal)(e,r,!1),n=(0,yf.isRichOper)(t)?t.getFallback():t;switch(n.kind){case Sf.OperKind.Number:return n;case Sf.OperKind.Boolean:return ap.valueErrorOper;case Sf.OperKind.String:var a=e.coerceOper(n,Sf.OperKind.Number);return(0,yf.isNumberOper)(a)?a:ap.valueErrorOper;case Sf.OperKind.Error:return n;case Sf.OperKind.Array:return ap.valueErrorOper;case Sf.OperKind.Missing:return ap.naErrorOper;case Sf.OperKind.Blank:return e.mathpack.zero;default:return(0,WF.assertNever)("calc.funcs.chkNumOper",n)}}Oa.chkNumOper=F1e;Oa.atpm1904to1900Days=1462;function xmr(e,r){var t=F1e(e,r);if((0,yf.isErrorOper)(t))return t;var n=e.mathpack;return n.cond(t)<0||(t=n.floor(t),!O1e(e,t))?ap.numErrorOper:(e.config.date1904&&!(0,yf.isStringOper)(r)&&(t=n.add(n.fromNumber(Oa.atpm1904to1900Days),t)),t)}Oa.chkDateOper=xmr;function N1e(e,r){switch(r.kind){case Sf.OperKind.Number:return(0,bC.success)(new b3.StrictSparseArray2D(1,1,1,1,[[r]],ap.blankOper));case Sf.OperKind.String:var t=e.coerceOper(r,Sf.OperKind.Number);return(0,yf.isErrorOper)(t)?(0,bC.failure)(ap.valueErrorOper):(0,bC.success)(new b3.StrictSparseArray2D(1,1,1,1,[[t]],ap.blankOper));case Sf.OperKind.Blank:return(0,bC.success)(new b3.StrictSparseArray2D(1,1,1,1,[[e.mathpack.zero]],ap.blankOper));case Sf.OperKind.Missing:return(0,bC.failure)(ap.naErrorOper);case Sf.OperKind.Error:return(0,bC.failure)(r);case Sf.OperKind.Range:var n=(0,A1e.refToVal)(e,r,!1);return N1e(e,n);case Sf.OperKind.Array:return(0,bC.success)(new b3.StrictSparseArray2D(r.rows,r.cols,r.rows,r.cols,r.opers,ap.blankOper));default:return(0,bC.failure)(ap.valueErrorOper)}}Oa.chkNumMultiOper=N1e;var Imr=0,wmr=2958465,Dmr=0,Lmr=2957003;function O1e(e,r){var t,n,a=e.mathpack,o=a.lfix(r);return e.config.date1904?(t=Dmr,n=Lmr):(t=Imr,n=wmr),o>=t&&o<=n}Oa.validDateRange=O1e;function qmr(e,r,t){var n=e.div(r,t);if((0,yf.isErrorOper)(n))return n;var a=e.mul(e.trunc(n),t);if((0,yf.isErrorOper)(a))return a;var o=e.sub(r,a);return!(0,yf.isErrorOper)(o)&&e.cond(r)<0?e.abs(o):o}Oa.numMod=qmr;function Gmr(e,r){var t=e.sub(e.trunc(r),r);return(0,yf.isNumberOper)(t)&&e.cond(t)===0}Oa.numInt=Gmr;function Bmr(e,r){if(e*r>1048576)return(0,Emr.throwEvaluationError)((0,yf.notImplemented)(["Very large array size"]))}Oa.validateArraySize=Bmr;var k1e=function(){function e(r){this.oper=r;var t=r.ranges[0],n=t.rows,a=t.cols;this.rows=n,this.cols=a}return e.prototype.slice=function(r,t,n,a){var o=this.oper.ranges[0],u=o.row,s=o.col;return(0,ap.range3DOper)(this.oper.sheets,(0,Pmr.gridRange)(u+r,s+n,t,a))},e}();Oa.RangeSlicer=k1e;var M1e=function(){function e(r){this.oper=r,this.rows=r.opers.length,this.cols=r.opers[0].length}return e.prototype.slice=function(r,t,n,a){return(0,ap.arrayOper)(t,a,this.oper.opers.slice(r,r+t).map(function(o){return o.slice(n,n+a)}))},e}();Oa.ArraySlicer=M1e;function Umr(e){return(0,yf.isArrayOper)(e)?new M1e(e):new k1e(e)}Oa.makeSlicer=Umr;function Kmr(e,r){return(0,yf.isRangeOper)(e)?e.ranges.length>1?r:((0,WF.assertTrue)("calc.funcs.rangeOrArrayToVal: not 3D ref",(0,yf.isSheetIndex)(e.sheets)),e):e}Oa.rangeOrArrayToVal=Kmr;function Vmr(e,r){return(0,WF.assertTrue)("calc.funcs.getAbsoluteIndex",(0,Amr.isInteger)(r)&&r!==0&&r<=e&&r>=-e),r>0?r-1:e+r}Oa.getAbsoluteIndex=Vmr});var qJ=T(er=>{"use strict";p();Object.defineProperty(er,"__esModule",{value:!0});er.geomean=er.devsq=er.avedev=er.rank_avg=er.rank=er.aggregate=er.subtotal=er.mode_mult=er.mode=er.varpa=er.vara=er.varp=er.var_=er.stdevpa=er.stdeva=er.stdevp=er.stdev=er.trimmean=er.median=er.quartile_exc=er.quartile=er.percentile_exc=er.percentile=er.small=er.large=er.xor=er.or=er.and=er.minifs=er.maxifs=er.mina=er.maxa=er.min=er.max=er.countifs=er.countif=er.counta=er.countblank=er.count=er.textjoin=er.concat=er.averagea=er.averageifs=er.averageif=er.average=er.product=er.sumifs=er.sumif=er.sumsq=er.sum=void 0;er.sumproduct=er.harmean=void 0;var C3=fe(),pi=fi(),Qt=Ua(),ze=Na(),Qy=dC(),nI=fs(),aI=PJ(),x1e=Il(),I1e=vf(),zo=FJ(),Qu=xm(),jmr=uc(),io=au(),_f=Dl(),NJ=QY(),Wmr=qo();function Xu(e,r){var t=(0,ze.isRichOper)(r)?r.getFallback():r;switch(t.kind){case io.OperKind.Number:return t;case io.OperKind.Boolean:case io.OperKind.String:return;case io.OperKind.Error:return t;case io.OperKind.Missing:case io.OperKind.Blank:return;default:return(0,pi.assertNever)("calc.funcs.arithmeticOperationCoerce",t)}}function uI(e,r){var t=(0,ze.isRichOper)(r)?r.getFallback():r;switch(t.kind){case io.OperKind.Boolean:return t.value?e.mathpack.one:e.mathpack.zero;case io.OperKind.Number:return t;case io.OperKind.String:return e.mathpack.zero;case io.OperKind.Error:return t;case io.OperKind.Missing:case io.OperKind.Blank:return;default:return(0,pi.assertNever)("calc.funcs.arithmeticAOperationCoerce",t)}}function Hmr(e,r){var t=(0,ze.isRichOper)(r)?r.getFallback():r;return(0,ze.isStringOper)(t)?e.mathpack.zero:Xu(e,t)}function Xy(e){return function(t,n,a){if(t!==void 0&&(0,ze.isErrorOper)(t))return t;if((0,pi.assertTrue)("calc.funcs.numberReducer",t===void 0||(0,ze.isNumberOper)(t)),(0,ze.isErrorOper)(n))return n;(0,pi.assertTrue)("calc.funcs.numberReducer",(0,ze.isNumberOper)(n));var o,u;t===void 0?(o=n,u=a-1):(o=t,u=a);for(var s=0;s<u;s+=1){var l=e(o,n);if((0,ze.isErrorOper)(l))return l;o=l}return o}}function R3(e){return function(r,t,n){return e.count+=n,t}}function zmr(e){for(var r=e.length-1;r>=0;r-=1){var t=e[r];if(!(t===void 0||!(0,Qy.isRangeValues)(t)))for(var n=t.arrays.length-1;n>=0;n-=1){var a=t.arrays[n];if(a.rows>a.denseRows||a.cols>a.denseCols){var o=a.getSparse();if((o==null?void 0:o.kind)===io.OperKind.Number)return o}for(var u=a.denseRows-1;u>=0;u-=1)for(var s=a.denseCols-1;s>=0;s-=1){var o=a.get(u,s);if((o==null?void 0:o.kind)===io.OperKind.Number)return o}}}}function L1e(e,r,t){if(!(0,ze.isNumberOper)(t))return t;var n=zmr(r);return(n==null?void 0:n.kind)!==io.OperKind.Number?t:e.mathpack.checkAlmostCancellation(n,t)}function q1e(e,r,t){var n=(0,zo.reduceDerefOpers)(r,Xy(r.mathpack.add),Xu,t);return n==null?r.mathpack.zero:(e&&(n=L1e(r,t,n)),n)}var G1e=q1e.bind(void 0,!1),B1e=q1e.bind(void 0,!0);function Qmr(e,r){var t=e.dereferenceAllOpers(r);return B1e(e,t)}er.sum=Qmr;function Xmr(e,r){var t=e.dereferenceAllOpers(r),n=T3(Xu),a=(0,zo.reduceDerefOpers)(e,Xy(e.mathpack.add),n,t);return a??e.mathpack.zero}er.sumsq=Xmr;function iI(e){return(0,ze.isRangeOper)(e)&&e.ranges.length!==1}function U1e(e,r,t){if(iI(r))return(0,_f.failure)(Qt.valueErrorOper);if(t===void 0){var n=e.dereferenceAllOpers([r])[0];return(0,_f.success)({values:n,valuesToFilter:n})}if(iI(t))return(0,_f.failure)(Qt.valueErrorOper);var a=egr(r,t),o=a.actualEvalRange,u=a.actualFilterRange,s=o.ranges[0],l=u.ranges[0],c=e.dereferenceAllOpers([o])[0];if(s.col===l.col&&s.row===l.row)return(0,_f.success)({values:c,valuesToFilter:c});var d=e.dereferenceAllOpers([u])[0];return(0,_f.success)({values:c,valuesToFilter:d})}function K1e(e,r){var t=r[0],n=r[1],a=r[2],o=U1e(e,t,a);if(!(0,_f.isSuccess)(o))return o.reason;var u=o.value,s=u.values,l=u.valuesToFilter,c=[(0,Qy.rangeValues)([(0,aI.applyCriteria)(e,s.arrays[0],n,l.arrays[0])])];return G1e(e,c)}er.sumif=K1e;function sI(e,r,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var a=r[0];if(iI(a))return(0,_f.failure)(Qt.valueErrorOper);var o,u;if(t){var s=r[1],l=e.dereferenceAllOpers([a])[0];o=(0,aI.applyCriteria)(e,l.arrays[0],s),u=2}else{var c=e.dereferenceAllOpers([a])[0];o=c.arrays[0],u=1}for(var d=u;d<r.length;d+=2){var f=r[d],m=r[d+1];if(iI(f)||f.ranges[0].cols!==a.ranges[0].cols||f.ranges[0].rows!==a.ranges[0].rows)return(0,_f.failure)(Qt.valueErrorOper);var l=e.dereferenceAllOpers([f])[0];o=(0,aI.applyCriteria)(e,l.arrays[0],m,o)}return n&&(o=o.strict()),(0,_f.success)((0,Qy.rangeValues)([o]))}function Ymr(e,r){if(r.length===3)return K1e(e,[r[1],r[2],r[0]]);var t=sI(e,r);return(0,_f.isSuccess)(t)?G1e(e,[t.value]):t.reason}er.sumifs=Ymr;function V1e(e,r){var t=(0,zo.reduceDerefOpers)(e,Xy(e.mathpack.mul),Xu,r);return t??e.mathpack.zero}function Jmr(e,r){var t=e.dereferenceAllOpers(r);return V1e(e,t)}er.product=Jmr;function j1e(e,r,t,n,a,o){var u=(0,zo.reduceDerefOpers)(a,Xy(a.mathpack.add),e,o,r);if(u==null)return n;if(t&&(u=L1e(a,o,u)),(0,ze.isErrorOper)(u))return u;var s={count:0},l=(0,zo.reduceDerefOpers)(a,R3(s),e,o,r);(0,pi.assertTrue)("calc.funcs.averageCoerceInner",(0,ze.isNumberOper)(u)&&(l==null?void 0:l.kind)===io.OperKind.Number&&s.count>0);var c=a.mathpack.div(u,a.mathpack.fromNumber(s.count));return(0,ze.isErrorOper)(c)?c:[c,s.count]}function MJ(e,r,t,n,a){var o=j1e(e,r,t,Qt.div0ErrorOper,n,a);return Array.isArray(o)?o[0]:o}var W1e=MJ.bind(void 0,Xu,void 0,!1),H1e=MJ.bind(void 0,Xu,void 0,!0),Zmr=MJ.bind(void 0,uI,Hmr,!0);function $mr(e,r){var t=e.dereferenceAllOpers(r);return H1e(e,t)}er.average=$mr;function egr(e,r){var t=e.ranges[0],n=r.ranges[0],a=(0,x1e.fastMin)(t.cols,nI.sheetCols-n.col),o=(0,x1e.fastMin)(t.rows,nI.sheetRows-n.row),u=(0,nI.gridRange)(t.row,t.col,o,a),s=(0,Qt.range3DOper)(e.sheets,u),l=(0,nI.gridRange)(n.row,n.col,o,a),c=(0,Qt.range3DOper)(r.sheets,l);return{actualEvalRange:s,actualFilterRange:c}}function z1e(e,r){var t=r[0],n=r[1],a=r[2],o=U1e(e,t,a);if(!(0,_f.isSuccess)(o))return o.reason;var u=o.value,s=u.values,l=u.valuesToFilter,c=[(0,Qy.rangeValues)([(0,aI.applyCriteria)(e,s.arrays[0],n,l.arrays[0]).strict()])];return W1e(e,c)}er.averageif=z1e;function rgr(e,r){if(r.length===3)return z1e(e,[r[1],r[2],r[0]]);var t=sI(e,r,void 0,!0);return(0,_f.isSuccess)(t)?W1e(e,[t.value]):t.reason}er.averageifs=rgr;function tgr(e,r){var t=e.dereferenceAllOpers(r);return Zmr(e,t)}er.averagea=tgr;function Q1e(e,r,t,n,a){for(var o=void 0,u=function(){return o},s=0,l="",c=function(E,N){return E.coerceOper(N,io.OperKind.String)},d=function(E,N,k){if(E!==void 0&&(0,ze.isErrorOper)(E))return E;for(var q=0;q<k;q+=1){if(o!==void 0&&r.length>0&&(!t||o.value.length>0)){var V=r[s];if(s=(s+1)%r.length,l.length+V.value.length>Qt.cellStringLimit)return Qt.valueErrorOper;l+=V.value}if((0,ze.isErrorOper)(N))return N;if((0,pi.assertTrue)("calc.funcs.concatInner: expected string in reducer",(0,ze.isStringOper)(N)),l.length+N.value.length>Qt.cellStringLimit)return Qt.valueErrorOper;if(l+=N.value,o=N,N.value===""&&(r.length===0||t))break}return N},f=0;f<a.length;f+=1){var m=n[f];if((0,ze.isRangeOper)(m)&&m.ranges.length>1)return Qt.valueErrorOper;var v=(0,zo.reduceDerefOpers)(e,d,c,a.slice(f,f+1));if(v!==void 0&&(0,ze.isErrorOper)(v))return v;(0,pi.assertTrue)("calc.funcs.concatInner: expected string from reduce",v!==void 0&&(0,ze.isStringOper)(v))}var h=u();if(t&&h!==void 0&&h.value===""&&r.length>0&&l.length>0){var y=r[(s+r.length-1)%r.length];l=l.substring(0,l.length-y.value.length)}return(0,Qt.stringOper)(l)}function ngr(e,r){var t=e.dereferenceAllOpers(r);return Q1e(e,[],!0,r,t)}er.concat=ngr;function agr(e,r){var t=r[0],n=r[1],a=r.slice(2),o=[];if(!(0,ze.isMissingOper)(t)){if((0,ze.isRangeOper)(t)&&t.ranges.length>1)return Qt.valueErrorOper;var u=function(d,f){return d.coerceOper(f,io.OperKind.String)},s=(0,zo.reduceDerefOpers)(e,A3(o,Qu.assertString),u,e.dereferenceAllOpers([t]));if(s!==void 0&&(0,ze.isErrorOper)(s))return s;(0,pi.assertTrue)("calc.funcs.textjoin: expected string from reduce",s!==void 0&&(0,ze.isStringOper)(s))}var l=(0,ze.isMissingOper)(n)||n.value;return Q1e(e,o,l,a,e.dereferenceAllOpers(a))}er.textjoin=agr;function E3(e,r,t){var n={count:0};return(0,zo.reduceDerefOpers)(r,R3(n),e,t),r.mathpack.fromNumber(n.count)}function igr(e,r){var t=(0,ze.isRichOper)(r)?r.getFallback():r;return(0,ze.isNumberOper)(t)?t:void 0}var X1e=E3.bind(void 0,igr);function ogr(e,r){var t=e.dereferenceAllOpers(r);return X1e(e,t)}er.count=ogr;function ugr(e,r){var t=(0,ze.isRichOper)(r)?r.getFallback():r;return(0,ze.isBlankOper)(t)||(0,jmr.isEmptyStringOper)(t)?t:void 0}var sgr=E3.bind(void 0,ugr);function lgr(e,r){var t=r[0];if(!(0,ze.isSheetIndex)(t.sheets)||t.ranges.length!==1)return Qt.valueErrorOper;var n=e.dereferenceAllOpers(r);return sgr(e,n)}er.countblank=lgr;function cgr(e,r){var t=(0,ze.isRichOper)(r)?r.getFallback():r;return(0,ze.isPrimitiveOper)(t)||(0,ze.isErrorOper)(t)?t:void 0}var Y1e=E3.bind(void 0,cgr);function dgr(e,r){var t=e.dereferenceAllOpers(r);return Y1e(e,t)}er.counta=dgr;var J1e=E3.bind(void 0,function(e,r){return r});function Z1e(e,r){var t=r[0],n=r[1];if(iI(t))return Qt.valueErrorOper;var a=e.dereferenceAllOpers([t])[0],o=[(0,Qy.rangeValues)([(0,aI.applyCriteria)(e,a.arrays[0],n)])];return J1e(e,o)}er.countif=Z1e;function fgr(e,r){if(r.length===2)return Z1e(e,r);var t=sI(e,r,!0);return(0,_f.isSuccess)(t)?J1e(e,[t.value]):t.reason}er.countifs=fgr;var $1e=function(r,t,n){return r.mathpack.cond2(t,n)>0},eTe=function(r,t,n){return r.mathpack.cond2(t,n)<0};function P3(e,r,t,n,a){var o=function(l,c,d){return l===void 0?c:(0,ze.isErrorOper)(l)?l:((0,pi.assertTrue)("calc.funcs.minMaxCoerceInner",(0,ze.isNumberOper)(l)),(0,ze.isErrorOper)(c)?c:((0,pi.assertTrue)("calc.funcs.minMaxCoerceInner",(0,ze.isNumberOper)(c)),e(n,l,c)?l:c))},u=(0,zo.reduceDerefOpers)(n,o,r,a,t);return u??n.mathpack.zero}var xJ=P3.bind(void 0,$1e,Xu,void 0),IJ=P3.bind(void 0,eTe,Xu,void 0),pgr=P3.bind(void 0,$1e,uI,Xu),mgr=P3.bind(void 0,eTe,uI,Xu);function ggr(e,r){var t=e.dereferenceAllOpers(r);return xJ(e,t)}er.max=ggr;function vgr(e,r){var t=e.dereferenceAllOpers(r);return IJ(e,t)}er.min=vgr;function hgr(e,r){var t=e.dereferenceAllOpers(r);return pgr(e,t)}er.maxa=hgr;function Sgr(e,r){var t=e.dereferenceAllOpers(r);return mgr(e,t)}er.mina=Sgr;function ygr(e,r){var t=sI(e,r);return(0,_f.isSuccess)(t)?xJ(e,[t.value]):t.reason}er.maxifs=ygr;function _gr(e,r){var t=sI(e,r);return(0,_f.isSuccess)(t)?IJ(e,[t.value]):t.reason}er.minifs=_gr;function bgr(e,r){var t=(0,ze.isRichOper)(r)?r.getFallback():r;switch(t.kind){case io.OperKind.Boolean:return t;case io.OperKind.Number:return(0,Qt.booleanOper)(e.mathpack.cond(t)!==0);case io.OperKind.String:return;case io.OperKind.Error:return t;case io.OperKind.Missing:case io.OperKind.Blank:return;default:return(0,pi.assertNever)("calc.funcs.aggregationFuncs: booleanOperationCoerce",t)}}function wJ(e,r,t){var n=function(u,s,l){return u!==void 0&&(0,ze.isErrorOper)(u)?u:(0,ze.isErrorOper)(s)?s:((0,pi.assertTrue)("calc.funcs.booleanInner",(u===void 0||(0,ze.isBooleanOper)(u))&&(0,ze.isBooleanOper)(s)),(0,Qt.booleanOper)(e(u==null?void 0:u.value,s.value,l)))},a=(0,zo.reduceDerefOpers)(r,n,bgr,t);return a??Qt.valueErrorOper}var Cgr=wJ.bind(void 0,function(e,r){return e!==!1&&r}),Tgr=wJ.bind(void 0,function(e,r){return e===!0||r}),Rgr=wJ.bind(void 0,function(e,r,t){return r?((e===!0?1:0)+t)%2===1:e===!0});function Egr(e,r){var t=e.dereferenceAllOpers(r);return Cgr(e,t)}er.and=Egr;function Pgr(e,r){var t=e.dereferenceAllOpers(r);return Tgr(e,t)}er.or=Pgr;function Agr(e,r){var t=e.dereferenceAllOpers(r);return Rgr(e,t)}er.xor=Agr;function A3(e,r){return function(t,n,a){if(t!==void 0&&(0,ze.isErrorOper)(t))return t;if(!(0,ze.isErrorOper)(n))for(var o=r(n),u=0;u<a;u+=1)e.push(o);return n}}function rTe(e,r,t,n){var a=[],o=(0,zo.reduceDerefOpers)(r,A3(a,Qu.assertNumber),Xu,[t]);if(o==null)return Qt.numErrorOper;if((0,ze.isErrorOper)(o))return o;var u=r.mathpack;if(u.cond2(n,u.one)<0||u.cond2(n,u.fromNumber(a.length))>0)return Qt.numErrorOper;var s=a.sort(u.cond2);if(e){var l=(0,Qu.assertNumber)(u.add((0,Qu.assertNumber)(u.sub(u.fromNumber(a.length),n)),u.one));return s[u.lfix(l)-1]}return s[u.lfix(n)-1]}var tTe=rTe.bind(void 0,!0),nTe=rTe.bind(void 0,!1);function Fgr(e,r){var t=e.dereferenceAllOpers(r),n=t[0],a=t[1];return tTe(e,n,a)}er.large=Fgr;function Ngr(e,r){var t=e.dereferenceAllOpers(r),n=t[0],a=t[1];return nTe(e,n,a)}er.small=Ngr;function lI(e,r,t,n){var a=e.mathpack,o=[],u=(0,zo.reduceDerefOpers)(e,A3(o,Qu.assertNumber),Xu,r);if(u==null)return Qt.numErrorOper;if((0,ze.isErrorOper)(u))return u;if((0,ze.isErrorOper)(t))return t;if(a.cond(t)<0||a.cond2(t,a.one)>0)return Qt.numErrorOper;var s=o.sort(a.cond2),l=(0,Qu.assertNumber)(a.sub(a.fromNumber(s.length),a.one)),c=(0,Qu.assertNumber)(a.add(a.fromNumber(s.length),a.one)),d=n?(0,Qu.assertNumber)(a.mul(l,t)):(0,Qu.assertNumber)(a.sub((0,Qu.assertNumber)(a.mul(c,t)),a.one));if(a.cond(d)<0||a.cond2(d,l)>0)return Qt.numErrorOper;var f=a.lfix(d),m=(0,Qu.assertNumber)(a.sub(d,a.fromNumber(f)));if(a.cond(m)===0)return s[f];var v=a.sub(s[f+1],s[f]);return(0,ze.isErrorOper)(v)?v:a.add(s[f],(0,Qu.assertNumber)(a.mul(v,m)))}var aTe=function(r,t,n){return lI(r,[t],n,!0)};function Ogr(e,r){var t=e.dereferenceAllOpers(r),n=t[0],a=t[1];return aTe(e,n,a)}er.percentile=Ogr;var iTe=function(r,t,n){return lI(r,[t],n,!1)};function kgr(e,r){var t=e.dereferenceAllOpers(r),n=t[0],a=t[1];return iTe(e,n,a)}er.percentile_exc=kgr;function oTe(e,r){var t=e.mathpack;if(t.cond(r)<0||t.cond2(r,t.fromNumber(5))>=0)return Qt.numErrorOper;var n=t.lfix(r);return t.div(t.fromNumber(n),t.fromNumber(4))}var uTe=function(r,t,n){return lI(r,[t],oTe(r,n),!0)};function Mgr(e,r){var t=e.dereferenceAllOpers(r),n=t[0],a=t[1];return uTe(e,n,a)}er.quartile=Mgr;var sTe=function(r,t,n){return lI(r,[t],oTe(r,n),!1)};function xgr(e,r){var t=e.dereferenceAllOpers(r),n=t[0],a=t[1];return sTe(e,n,a)}er.quartile_exc=xgr;function lTe(e,r){return lI(e,r,e.mathpack.fromNumber(.5),!0)}function Igr(e,r){var t=e.dereferenceAllOpers(r);return lTe(e,t)}er.median=Igr;function wgr(e,r){var t=e.dereferenceAllOpers(r),n=t[0],a=t[1],o=[],u=(0,zo.reduceDerefOpers)(e,A3(o,Qu.assertNumber),Xu,[n]);if(u==null)return Qt.numErrorOper;if((0,ze.isErrorOper)(u))return u;var s=e.mathpack;if(s.cond(a)<0||s.cond2(a,s.one)>=0)return Qt.numErrorOper;o=o.sort(s.cond2);var l=s.lfix((0,Qu.assertNumber)(s.div((0,Qu.assertNumber)(s.mul(s.fromNumber(o.length),a)),s.fromNumber(2))));(0,pi.assertTrue)("calc.funcs.trimmean",l+l<o.length);var c=o[l],d=o[o.length-1-l],f=0,m=0,v=(0,zo.reduceDerefOpers)(e,Xy(e.mathpack.add),function(_,E){var N=Xu(_,E);if(N===void 0)return N;(0,pi.assertTrue)("calc.funcs.trimmean: unexpected error",(0,ze.isNumberOper)(N));var k=_.mathpack;if(k.cond2(N,c)<0){f+=1;return}if(k.cond2(N,d)>0){m+=1;return}return N},[n]);(0,pi.assertTrue)("calc.funcs.trimmean: found no elements",v!==void 0&&(0,ze.isNumberOper)(v)),(0,pi.assertTrue)("calc.funcs.trimmean: trimmed too many",f<=l&&m<=l);for(var h=v;f<l;f+=1){var y=s.sub(h,c);if((0,ze.isErrorOper)(y))return y;h=y}for(;m<l;m+=1){var y=s.sub(h,d);if((0,ze.isErrorOper)(y))return y;h=y}return s.div(h,s.fromNumber(o.length-l-l))}er.trimmean=wgr;function T3(e){return function(r,t){var n=e(r,t);return n!==void 0&&(0,ze.isNumberOper)(n)?r.mathpack.mul(n,n):n}}function w1e(e,r){return function(t,n){var a=e(t,n);if((a==null?void 0:a.kind)!==io.OperKind.Number)return a;var o=t.mathpack,u=o.sub(a,r);return(0,ze.isErrorOper)(u)?u:o.mul(u,u)}}function cTe(e,r,t,n){var a={count:0},o=(0,zo.reduceDerefOpers)(t,R3(a),e,n,r);if(o==null)return Qt.div0ErrorOper;(0,pi.assertTrue)("calc.funcs.varFirstPass: unexpected count type",a.count>=1);var u=Xy(t.mathpack.add),s=(0,zo.reduceDerefOpers)(t,u,e,n,r),l=(0,zo.reduceDerefOpers)(t,u,T3(e),n,r===void 0?void 0:T3(r));if((0,pi.assertTrue)("calc.funcs.varFirstPass: expected sum",s!=null),(0,pi.assertTrue)("calc.funcs.varFirstPass: expected sumSq",l!=null),(0,ze.isErrorOper)(s))return s;if((0,ze.isErrorOper)(l))return l;(0,pi.assertTrue)("calc.funcs.varFirstPass: unexpected oper type",(0,ze.isNumberOper)(s)&&(0,ze.isNumberOper)(l));var c=t.mathpack,d=c.div(s,c.fromNumber(a.count));return(0,ze.isErrorOper)(d)?d:[a.count,s,l,d]}function dTe(e,r,t,n,a){var o=Xy(t.mathpack.add),u=(0,zo.reduceDerefOpers)(t,o,w1e(e,a),n,r===void 0?void 0:w1e(r,a));return(0,pi.assertTrue)("calc.funcs.varSecondPass: unexpected error",(u==null?void 0:u.kind)===io.OperKind.Number),u}function fTe(e,r,t,n){var a=cTe(e,r,t,n);if(!Array.isArray(a))return a;var o=t.mathpack,u=a[0],s=a[1],l=a[2],c=a[3];if(u<2)return Qt.div0ErrorOper;var d=o.mul(s,s);if((0,ze.isErrorOper)(d))return d;var f=(0,Qu.assertNumber)(o.div(d,o.fromNumber(u))),m=(0,Qu.assertNumber)(o.sub(l,f));if(o.cond(c)===0)return o.cond(m)<0?o.zero:o.div(m,o.fromNumber(u-1));if(o.cond(m)>=0){var v=(0,Qu.assertNumber)(o.div(m,o.fromNumber(u-1))),h=21219957905e-324;if(o.cond2(v,o.fromNumber(h))>0){var y=o.div(f,l),_=(0,ze.isErrorOper)(y)?y:o.sub(y,o.one);if(!(0,ze.isErrorOper)(_)&&o.cond2(o.abs(_),o.fromNumber(.01))>0){var E=o.div(c,v),N=(0,ze.isErrorOper)(E)?E:o.sub(o.abs(E),o.fromNumber(1e3));if(!(0,ze.isErrorOper)(N)&&o.cond(N)<0)return v}}}var k=dTe(e,r,t,n,c);return o.cond(k)<0?o.zero:o.div(k,o.fromNumber(u-1))}function pTe(e,r,t,n){var a=cTe(e,r,t,n);if(!Array.isArray(a))return a;var o=t.mathpack,u=a[0],s=a[1],l=a[2],c=a[3];if(u<1)return Qt.div0ErrorOper;var d=o.mul(s,s);if((0,ze.isErrorOper)(d))return d;var f=o.mul(l,o.fromNumber(u));if((0,ze.isErrorOper)(f))return f;var m=(0,Qu.assertNumber)(o.sub(f,d));if(o.cond(c)===0)return o.cond(m)<0?o.zero:o.div(m,o.fromNumber(u*u));if(o.cond(m)>=0){var v=(0,Qu.assertNumber)(o.div(m,o.fromNumber(u*u))),h=21219957905e-324;if(o.cond2(v,o.fromNumber(h))>0){var y=o.div((0,Qu.assertNumber)(o.div(d,o.fromNumber(u))),l),_=(0,ze.isErrorOper)(y)?y:o.sub(y,o.one);if(!(0,ze.isErrorOper)(_)&&o.cond2(o.abs(_),o.fromNumber(.01))>0){var E=o.div(c,v),N=(0,ze.isErrorOper)(E)?E:o.sub(o.abs(E),o.fromNumber(1e3));if(!(0,ze.isErrorOper)(N)&&o.cond(N)<0)return v}}}var k=dTe(e,r,t,n,c);return o.cond(k)<0?o.zero:o.div(k,o.fromNumber(u))}var DJ=fTe.bind(void 0,Xu,void 0),LJ=pTe.bind(void 0,Xu,void 0),mTe=fTe.bind(void 0,uI,Xu),gTe=pTe.bind(void 0,uI,Xu);function F3(e){return function(r,t){var n=e(r,t);return(0,ze.isNumberOper)(n)?r.mathpack.sqrt(n):n}}var vTe=F3(DJ),hTe=F3(LJ),Dgr=F3(mTe),Lgr=F3(gTe);function qgr(e,r){var t=e.dereferenceAllOpers(r);return vTe(e,t)}er.stdev=qgr;function Ggr(e,r){var t=e.dereferenceAllOpers(r);return hTe(e,t)}er.stdevp=Ggr;function Bgr(e,r){var t=e.dereferenceAllOpers(r);return Dgr(e,t)}er.stdeva=Bgr;function Ugr(e,r){var t=e.dereferenceAllOpers(r);return Lgr(e,t)}er.stdevpa=Ugr;function Kgr(e,r){var t=e.dereferenceAllOpers(r);return DJ(e,t)}er.var_=Kgr;function Vgr(e,r){var t=e.dereferenceAllOpers(r);return LJ(e,t)}er.varp=Vgr;function jgr(e,r){var t=e.dereferenceAllOpers(r);return mTe(e,t)}er.vara=jgr;function Wgr(e,r){var t=e.dereferenceAllOpers(r);return gTe(e,t)}er.varpa=Wgr;var OJ=[H1e,X1e,Y1e,xJ,IJ,V1e,vTe,hTe,B1e,DJ,LJ];function Hgr(e){return function(r,t,n){if(r!==void 0&&(0,ze.isErrorOper)(r))return r;if((0,ze.isNumberOper)(t))for(var a=0;a<n;a+=1)e.push({value:t,index:e.length});return t}}function STe(e,r){var t=[],n=(0,zo.reduceDerefOpers)(e,Hgr(t),Xu,r);if(n==null)return Qt.naErrorOper;if((0,ze.isErrorOper)(n))return n;var a=e.mathpack,o=t.sort(function(y,_){return a.cond2(y.value,_.value)}),u=1,s=0,l=1/0,c=[];function d(y){u=1,l=y.index}function f(y){y.index<l&&(l=y.index),u+=1}var m=function(_){var E=_.value;u>s?(s=u,c.length=0,c.push({value:E,index:l})):u===s&&c.push({value:E,index:l})},v=function(_,E){return a.cond2(_.value,E.value)===0};d(o[0]);for(var h=1;h<o.length;h+=1)v(o[h-1],o[h])?f(o[h]):(m(o[h-1]),d(o[h]));return m(o[o.length-1]),s<2?Qt.naErrorOper:((0,pi.assertTrue)("calc.funcs.modeInner: unexpected error",c.length!==0),c.sort(function(y,_){return y.index-_.index}))}function yTe(e,r){var t=STe(e,r);return Array.isArray(t)?t[0].value:t}function zgr(e,r){return yTe(e,r)}er.mode=zgr;function Qgr(e,r){var t=STe(e,r);return Array.isArray(t)?(0,Qt.arrayOper)(t.length,1,t.map(function(n){return[n.value]})):t}er.mode_mult=Qgr;var Xgr=(0,NJ.binaryVisitor)(C3.__assign(C3.__assign({},(0,NJ.constVisitor)(!1)),{wsfNode:function(r){return r===I1e.WorksheetFuncId.SUBTOTAL||r===I1e.WorksheetFuncId.AGGREGATE}}),function(e,r){return e||r});function Ygr(e){return(0,NJ.reduceBottomUp)(Xgr,e)}function _Te(e){if(!(0,Qy.isRangeValues)(e))return e;var r=e.arrays.map(function(t){return t.map(function(n){var a=n[0],o=n[1];return o!==void 0&&Ygr(o.formula)?void 0:a})});return(0,Qy.rangeValues)(r)}function Jgr(e,r){var t=r[0],n=r.slice(1),a=e.mathpack,o=a.sfix(t),u=OJ.length,s=100;if(!(o>=1&&o<=u)&&!(o>=101&&o<=u+s))return Qt.valueErrorOper;var l=o>s||e.isInFilterMode(n),c=e.dereferenceAllOpersAndFormulae(n,l).map(_Te),d=OJ[o%s-1];return d(e,c)}er.subtotal=Jgr;var rI=C3.__spreadArray(C3.__spreadArray([],OJ,!0),[lTe,yTe],!1),D1e=[tTe,nTe,aTe,uTe,iTe,sTe];function Zgr(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r.slice(4),s=e.mathpack,l=s.sfix(t),c=s.sfix(n);if(!(l>=1&&l<=rI.length+D1e.length)||!(c>=0&&c<=7))return Qt.valueErrorOper;var d=(c&1)===1,f=(c&2)===2,m=(c&4)!==4;function v(M){var B=m?e.dereferenceAllOpersAndFormulae(M,d).map(_Te):e.dereferenceAllOpers(M,d);return f&&(B=B.map(function(U){if((0,zo.isPrimitiveCoercedOper)(U))return U;if((0,Qy.isRangeValues)(U)){var j=U.arrays.map(function(ee){return ee.map(function(re){return re===void 0||(0,ze.isErrorOper)(re)?void 0:re})});return(0,Qy.rangeValues)(j)}if((0,zo.isCoercedArrayOper)(U)){var X=U.opers.map(function(ee){return ee.map(function(re){return re===void 0||(0,ze.isErrorOper)(re)?void 0:re})});return(0,zo.coercedArrayOper)(U.rows,U.cols,X)}return U})),B}if(l>rI.length){if(o===void 0||u.length>0)return Qt.valueErrorOper;var h=io.OperKind.Number;(0,ze.isRangeOper)(o)&&!((0,ze.isSheetIndex)(o.sheets)&&o.ranges.length===1&&(0,nI.isGridCell)(o.ranges[0]))&&(0,Wmr.throwEvaluationError)((0,ze.notImplemented)(["AGGREGATE multi-cell array param"]));var y=e.coerceOper(e.dereferenceOper(o,h),h);if((0,ze.isErrorOper)(y)||(0,ze.isRangeOper)(a)&&!(0,ze.isSheetIndex)(a.sheets))return Qt.valueErrorOper;var _=v([a])[0],E=rI.length,N=D1e[l-E-1];return N(e,_,y)}for(var k=2;k<r.length;k+=1){var q=r[k];if(!q||!(0,ze.isRangeOper)(q)||!(0,ze.isSheetIndex)(q.sheets))return Qt.valueErrorOper}var V=v(r.slice(2));(0,pi.assertTrue)("calc.funcs.aggregate: requested non-array function with unexpected number",l>=1&&l<=rI.length);var I=rI[l-1];return I(e,V)}er.aggregate=Zgr;function $gr(e,r){return bTe(e,r,!1)}er.rank=$gr;function evr(e,r){return bTe(e,r,!0)}er.rank_avg=evr;function bTe(e,r,t){var n=r[0],a=r[1],o=r[2],u=o===void 0?Qt.falseOper:o,s=u.value?1:-1,l=0,c=0,d=e.mathpack,f=function(_,E,N){if(_!==void 0)return _;if((0,ze.isErrorOper)(E))return E;var k=d.cond2(n,(0,Qu.assertNumber)(E));k===0?l+=N:k===s&&(c+=N)},m=(0,zo.reduceDerefOpers)(e,f,Xu,e.dereferenceAllOpers([a]));if(m!==void 0)return m;if(l===0)return Qt.naErrorOper;var v=d.fromNumber(c+1);if(t){var h=d.div(d.fromNumber(l-1),d.fromNumber(2));return d.add(v,(0,Qu.assertNumber)(h))}return v}function rvr(e){return function(r,t){var n=e(r,t);return(n==null?void 0:n.kind)===io.OperKind.Number?r.mathpack.abs(n):n}}function tvr(e,r){return function(t,n){var a=e(t,n);return(a==null?void 0:a.kind)===io.OperKind.Number?t.mathpack.sub(a,r):a}}function CTe(e,r,t){var n=j1e(Xu,void 0,!0,Qt.numErrorOper,r,t);if(!Array.isArray(n))return n;var a=n[0],o=n[1],u=(0,zo.reduceDerefOpers)(r,Xy(r.mathpack.add),e(tvr(Xu,a)),t);return(0,pi.assertTrue)("calc.funcs.sumDevAndCount",u!==void 0),(0,ze.isErrorOper)(u)?u:[(0,Qu.assertNumber)(u),o]}function nvr(e,r){var t=e.dereferenceAllOpers(r),n=CTe(rvr,e,t);if(!Array.isArray(n))return n;var a=n[0],o=n[1];return e.mathpack.div(a,e.mathpack.fromNumber(o))}er.avedev=nvr;function avr(e,r){var t=e.dereferenceAllOpers(r),n=CTe(T3,e,t);if(!Array.isArray(n))return n;var a=n[0];return a}er.devsq=avr;var oI=new Float64Array(1),HF=new Int32Array(oI.buffer);function kJ(e,r){oI[0]=e.toNumber(r);var t=((HF[1]&2146435072)>>>20)-1023;return HF[1]=HF[1]&-2146435073|1072693248,[e.fromNumber(oI[0]),t]}function tI(e,r,t){oI[0]=e.toNumber(r);var n=((HF[1]&2146435072)>>>20)-1023;return HF[1]=HF[1]&-2146435073|n+t+1023<<20&2146435072,e.fromNumber(oI[0])}function ivr(e,r){var t=e.mathpack;return function(a,o,u){if(a!==void 0&&(0,ze.isErrorOper)(a))return a;if((0,pi.assertTrue)("calc.funcs.geometricReducer",a===void 0||(0,ze.isNumberOper)(a)),(0,ze.isErrorOper)(o))return o;if((0,pi.assertTrue)("calc.funcs.geometricReducer",(0,ze.isNumberOper)(o)),t.cond(o)<=0)return Qt.numErrorOper;for(var s=kJ(t,o),l=s[0],c=s[1],d=-2130706431,f=2130706431,m=a??t.one,v=0;v<u;v+=1){if(r.count%512===511){var h=kJ(t,m),y=h[0],_=h[1];if(r.prodExp+=_,m=y,r.prodExp>f||r.prodExp<d)return Qt.numErrorOper}r.count+=1,r.prodExp+=c,m=t.mul(m,l),(0,pi.assertTrue)("calc.funcs.geometricReducer",!(0,ze.isErrorOper)(m))}return m}}function ovr(e,r){var t=e.mathpack,n=e.dereferenceAllOpers(r),a={count:0,prodExp:0},o=(0,zo.reduceDerefOpers)(e,ivr(e,a),Xu,n);if(o==null)return Qt.numErrorOper;if((0,ze.isErrorOper)(o))return o;if((0,pi.assertTrue)("calc.funcs.geomean",a.count>0&&(0,ze.isNumberOper)(o)),a.count===1)return tI(t,o,a.prodExp);{var u=kJ(t,o),s=u[0],l=u[1];a.prodExp+=l,o=s}var c=a.prodExp/a.count|0,d=a.prodExp%a.count,f=t.div(t.one,t.fromNumber(a.count));if((0,pi.assertTrue)("calc.funcs.geomean",!(0,ze.isErrorOper)(f)),d<=1e3){var m=tI(t,o,d),v=t.power(m,f);return(0,pi.assertTrue)("calc.funcs.geomean",!(0,ze.isErrorOper)(v)),tI(t,v,c)}var h=d-1e3,y=d-h,_=tI(t,o,y),E=t.power(_,f);(0,pi.assertTrue)("calc.funcs.geomean",!(0,ze.isErrorOper)(E));var N=tI(t,E,c),k=1.4426950408889636,q=t.mul(t.fromNumber(a.count),t.fromNumber(k));(0,pi.assertTrue)("calc.funcs.geomean",!(0,ze.isErrorOper)(q));var V=t.div(t.fromNumber(h),q);(0,pi.assertTrue)("calc.funcs.geomean",!(0,ze.isErrorOper)(V));var I=t.exp(V);return(0,ze.isErrorOper)(I)?I:t.mul(N,I)}er.geomean=ovr;function uvr(e){return function(r,t){var n=e(r,t);if(n===void 0||!(0,ze.isNumberOper)(n))return n;var a=r.mathpack;return a.cond(n)<=0?Qt.numErrorOper:a.div(a.one,n)}}function svr(e,r){var t=e.dereferenceAllOpers(r),n=uvr(Xu),a=(0,zo.reduceDerefOpers)(e,Xy(e.mathpack.add),n,t);if(a==null)return Qt.naErrorOper;if((0,ze.isErrorOper)(a))return a;var o={count:0},u=(0,zo.reduceDerefOpers)(e,R3(o),n,t);(0,pi.assertTrue)("calc.funcs.harmean",(0,ze.isNumberOper)(a)&&(u==null?void 0:u.kind)===io.OperKind.Number&&o.count>0);var s=e.mathpack.div(a,e.mathpack.fromNumber(o.count));return(0,ze.isErrorOper)(s)?s:e.mathpack.div(e.mathpack.one,s)}er.harmean=svr;var lvr=function(r){return(0,ze.isRichOper)(r)?r.getFallback():r},cvr=function(r,t){for(var n=t.map(function(M){return(0,Qt.arrayOper)(M.rows,M.cols,M.opers.map(function(B){return B.map(lvr)}))}),a=r.mathpack,o=0,u=n;o<u.length;o++)for(var s=u[o],l=0,c=s.opers;l<c.length;l++)for(var d=c[l],f=0,m=d;f<m.length;f++){var v=m[f];if((0,ze.isErrorOper)(v))return v}var h=n[0].rows,y=n[0].cols;if(!n.every(function(M){return M.rows===h&&M.cols===y}))return Qt.valueErrorOper;for(var _=a.zero,E=0;E<h;++E)e:for(var N=0;N<y;++N){var k=n[0].opers[E][N];if(!(0,ze.isNumberOper)(k))continue e;for(var q=k,V=1;V<n.length;++V){var I=n[V].opers[E][N];if(!(0,ze.isNumberOper)(I))continue e;if(q=a.mul(q,I),(0,ze.isErrorOper)(q))return q}if(_=a.add(q,_),(0,ze.isErrorOper)(_))return _}return _};er.sumproduct=cvr});var GJ=T(bf=>{"use strict";p();Object.defineProperty(bf,"__esModule",{value:!0});bf.xlDatepack=bf.tzUTC=bf.tzData=bf.dateTime=bf.TimeGranularity=bf.TimeDivision=bf.Rounding=void 0;var sR=qr();bf.Rounding=sR.datepack.Rounding;bf.TimeDivision=sR.datepack.TimeDivision;bf.TimeGranularity=sR.datepack.TimeGranularity;bf.dateTime=sR.datepack.dateTime;bf.tzData=sR.datepack.tzData;bf.tzUTC=sR.datepack.tzUTC;bf.xlDatepack=sR.datepack.xlDatepack});var zJ=T(Wn=>{"use strict";p();Object.defineProperty(Wn,"__esModule",{value:!0});Wn.yearFrac=Wn.networkdays=Wn.networkdays_intl=Wn.eomonth=Wn.edate=Wn.workday=Wn.workday_intl=Wn.days=Wn.datedif=Wn.days360=Wn.time=Wn.date=Wn.weeknum=Wn.isoweeknum=Wn.weekday=Wn.second=Wn.minute=Wn.hour=Wn.day=Wn.month=Wn.year=void 0;var lR=fe(),Xn=Ua(),iu=GJ(),Gt=xm(),Ca=Na(),dvr=Dl(),Cf=au(),fvr=fi();function zF(e,r,t){var n=t[0],a=r.datepack,o=r.config,u=a.fromNum(o,n,iu.Rounding.RoundSec);return u===!1?Xn.numErrorOper:r.mathpack.fromNumber(e(u))}Wn.year=zF.bind(void 0,function(e){return e.yr});Wn.month=zF.bind(void 0,function(e){return e.mon});Wn.day=zF.bind(void 0,function(e){return e.dom});Wn.hour=zF.bind(void 0,function(e){return e.hour});Wn.minute=zF.bind(void 0,function(e){return e.min});Wn.second=zF.bind(void 0,function(e){return e.sec});function PTe(e,r,t){var n=r[0],a=r[1];t===void 0&&(t=!1);var o=e.config,u=e.mathpack,s=e.datepack,l=s.fromNum(lR.__assign(lR.__assign({},o),{date1904:o.date1904&&!t}),n,iu.Rounding.RoundSec);if(l===!1)return Xn.numErrorOper;var c=a!==void 0?u.sfix(a):1,d;switch(c){case 1:case 17:d=l.wdy;break;case 2:case 11:d=l.wdy===1?7:l.wdy-1;break;case 3:d=l.wdy===1?6:l.wdy-2;break;case 12:d=(l.wdy+4)%7+1;break;case 13:d=(l.wdy+3)%7+1;break;case 14:d=(l.wdy+2)%7+1;break;case 15:d=(l.wdy+1)%7+1;break;case 16:d=l.wdy%7+1;break;default:return Xn.numErrorOper}return u.fromNumber(d)}function pvr(e,r){return PTe(e,r)}Wn.weekday=pvr;function TTe(e,r,t){if(!r){var n=e.lfix(t);if(n===0||n===1)return e.fromNumber(52)}return Xn.numErrorOper}function mvr(e,r,t){if(r===void 0||(0,Ca.isMissingOper)(r))return[t?2:1,t];var n=(0,Gt.chkNumOper)(e,r);if(!(0,Ca.isErrorOper)(n)){var a=e.mathpack.sfix(n);if(t){if(a===1||a===2)return[a,t]}else{if(a===1||a===2)return[a,t];if(a>=11&&a<=16)return[a-9,t];if(a===17)return[1,t];if(a===21)return[2,!0]}}return[void 0,t]}function gvr(e,r,t,n){var a=e.mathpack,o=e.datepack,u=e.config,s=lR.__assign({},n),l=(r+6-s.wdy)%7;if(s.mon===12&&s.dom+l>=35)return a.one;s.dom=4,s.mon=1;var c=o.toDays(u,s);if((0,fvr.assertTrue)("calc.funcs.weeknumISOAmendments",c!==!1),c=(c-1)%7+1,(c-r+7)%7<3){var d=(0,Gt.assertNumber)(a.sub(t,a.one));if(a.cond(d)===0){var f=s.yr-1,m=f%4===0&&(f%100!==0||f%400===0);return r===c||m&&(r-c+7)%7===6?a.fromNumber(53):a.fromNumber(52)}return d}return t}function ATe(e,r,t){var n=t[0],a=t[1],o=(0,Gt.chkDateOper)(r,n);if((0,Ca.isErrorOper)(o))return o;var u=mvr(r,a,e),s=u[0],l=u[1];if(s===void 0)return Xn.numErrorOper;var c=r.mathpack,d=r.datepack,f=r.config,m=lR.__assign(lR.__assign({},f),{date1904:!1}),v=d.fromNum(m,o,iu.Rounding.RoundSec);if(v===!1)return TTe(c,m.dateCompatibility,o);var h=(0,iu.dateTime)(v.yr,1,1,0,0,0,0,0,iu.Rounding.RoundSec),y=d.toNum(m,h);if((0,Ca.isErrorOper)(y))return TTe(c,m.dateCompatibility,o);var _=PTe(r,[y],!0);if((0,Ca.isErrorOper)(_))return _;var E=(0,Gt.assertNumber)(c.add((0,Gt.assertNumber)(c.sub(_,c.fromNumber(s))),c.fromNumber(7))),N=(0,Gt.assertNumber)((0,Gt.numMod)(c,E,c.fromNumber(7))),k=(0,Gt.assertNumber)(c.add(c.floor((0,Gt.assertNumber)(c.div((0,Gt.assertNumber)(c.add((0,Gt.assertNumber)(c.sub(o,y)),N)),c.fromNumber(7)))),c.one));return l?gvr(r,s,k,v):k}Wn.isoweeknum=ATe.bind(void 0,!0);Wn.weeknum=ATe.bind(void 0,!1);var RTe=-32768,BJ=32767,N3=1900,vvr=9999;function hvr(e,r){var t=r[0],n=r[1],a=r[2],o=e.mathpack,u=e.datepack,s=e.config,l=o.sfix(t);if(l>vvr)return Xn.numErrorOper;var c=o.sfix(n);if(c>BJ||c<RTe)return Xn.numErrorOper;var d=o.sfix(a);(d>BJ||d<RTe)&&(d=BJ),s.dateCompatibility?l<N3&&(l+=1900):l<N3&&!(l===1899&&c===12&&d>=30)&&(l+=1900);var f=(0,iu.dateTime)(l,c,d,0,0,0,0,0,iu.Rounding.RoundSec);return u.toNum(s,f)}Wn.date=hvr;var Svr=1,yvr=12,_vr=30;function bvr(e,r){var t=r[0],n=r[1],a=r[2],o=e.mathpack,u=e.datepack,s=e.config,l=o.sfix(t);if(l>32767)return Xn.numErrorOper;var c=o.sfix(n);if(c>32767)return Xn.numErrorOper;var d=o.sfix(a);if(d>32767)return Xn.numErrorOper;var f,m,v;s.dateCompatibility?(f=s.date1904?1904:1900,m=Svr,v=s.date1904?1:0):(f=1899,m=yvr,v=_vr);var h=(0,iu.dateTime)(f,m,v,l,c,d,0,0,iu.Rounding.RoundSec),y=u.toNum(s,h);return(0,Ca.isErrorOper)(y)?y:o.cond(y)<0?Xn.numErrorOper:o.sub(y,o.trunc(y))}Wn.time=bvr;function Cvr(e,r){var t,n=r[0],a=r[1],o=r[2],u=e.mathpack,s=e.datepack,l=e.config,c=(t=o==null?void 0:o.value)!==null&&t!==void 0?t:!1,d=s.fromNum(l,n,iu.Rounding.RoundSec);if(d===!1)return Xn.naErrorOper;var f=d.dom===31||!c&&d.mon===2&&d.dom===s.daysPerMonth(2,d.yr,l.dateCompatibility)?30:d.dom,m=u.fromNumber((d.yr-N3)*360+d.mon*30+f),v=s.fromNum(l,a,iu.Rounding.RoundSec);if(v===!1)return Xn.naErrorOper;var h=v.dom===31&&(c||d.dom===30)?30:v.dom,y=u.fromNumber((v.yr-N3)*360+v.mon*30+h);return u.sub(y,m)}Wn.days360=Cvr;function Tvr(e,r){var t=r[0],n=r[1],a=r[2].value;if(a.length>2||a.length===0)return Xn.numErrorOper;var o=e.mathpack,u=e.datepack,s=e.config,l=o.lfix(t),c=u.fromNum(s,t,iu.Rounding.RoundSec);if(c===!1)return Xn.numErrorOper;var d=e.mathpack.lfix(n),f=u.fromNum(s,n,iu.Rounding.RoundSec);if(f===!1||l>d)return Xn.numErrorOper;var m=f.dom,v=f.mon,h=f.yr;c.dom>m&&(v-=1,v===0&&(v=12,h-=1),m+=u.daysPerMonth(v,h,s.dateCompatibility)),c.mon>v&&(v+=12,h-=1);var y=function(k,q){return s.localeInfo.stringCompareCI(k,q)===0};if(y(a,"Y"))return o.fromNumber(h-c.yr);if(y(a,"M"))return o.fromNumber((h-c.yr)*12+(v-c.mon));if(y(a,"D"))return o.fromNumber(d-l);if(y(a,"MD"))return o.fromNumber(m-c.dom);if(y(a,"YM"))return o.fromNumber(v-c.mon);if(y(a,"YD")){for(var _=0,E=c.mon;E<v;E+=1)_+=u.daysPerMonth(E,c.yr,s.dateCompatibility);return o.fromNumber(_+(m-c.dom))}return Xn.numErrorOper}Wn.datedif=Tvr;function ETe(e,r){var t;if((0,Ca.isStringOper)(r)){var n=r.value.replace(/^\s+/,"");if(t=e.coerceOper((0,Xn.stringOper)(n),Cf.OperKind.Number),(0,Ca.isErrorOper)(t))return t}else t=r;return(0,Gt.chkDateOper)(e,t)}function Rvr(e,r){var t=r[0],n=r[1];if((0,Ca.isStringOper)(t)&&t.value.length>255||(0,Ca.isStringOper)(n)&&n.value.length>255)return Xn.valueErrorOper;var a=ETe(e,t);if((0,Ca.isErrorOper)(a))return a;var o=ETe(e,n);return(0,Ca.isErrorOper)(o)?o:e.mathpack.sub(a,o)}Wn.days=Rvr;function KJ(e,r,t){return t?(0,Gt.assertNumber)(e.sub(r,e.fromNumber(Gt.atpm1904to1900Days))):r}function O3(e,r){return(e>>r%7&1)!==0}var oo;(function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"})(oo||(oo={}));function WJ(e){switch(e){case 1:return oo.Saturday|oo.Sunday;case 2:return oo.Sunday|oo.Monday;case 3:return oo.Monday|oo.Tuesday;case 4:return oo.Tuesday|oo.Wednesday;case 5:return oo.Wednesday|oo.Thursday;case 6:return oo.Thursday|oo.Friday;case 7:return oo.Friday|oo.Saturday;case 11:return oo.Sunday;case 12:return oo.Monday;case 13:return oo.Tuesday;case 14:return oo.Wednesday;case 15:return oo.Thursday;case 16:return oo.Friday;case 17:return oo.Saturday;default:return!1}}function HJ(e){var r=2;if(e.length!==7)return!1;for(var t=oo.None,n=0;n<e.length;n+=1)if(e[n]==="1")t=t|1<<(n+r)%7;else if(e[n]!=="0")return!1;return t}function Evr(e){for(var r=[],t=e.getSparse(),n=e.cols-e.denseCols,a=0;a<e.denseRows;a+=1){for(var o=0;o<e.denseCols;o+=1){var u=e.get(a,o);u!==void 0&&r.push(u)}if(n>0&&t!==void 0)for(var s=0;s<n;s+=1)r.push(t)}var l=(e.rows-e.denseRows)*e.cols;if(l>0&&t!==void 0)for(var a=0;a<l;a+=1)r.push(t);return r}function VJ(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=oo.Saturday|oo.Sunday,s=(0,Gt.chkDateOper)(e,t);if((0,Ca.isErrorOper)(s))return s;var l=(0,Gt.chkNumOper)(e,n);if((0,Ca.isErrorOper)(l))return l;var c=e.mathpack,d=e.config;l=c.floor(l);var f=c.cond(l)>0?c.one:c.fromNumber(-1),m=c.abs(l),v=(0,Gt.assertNumber)(c.add(s,l));if(!(0,Gt.validDateRange)(e,v))return Xn.numErrorOper;if(c.cond(m)===0)return KJ(c,s,d.date1904);var h=null,y=[];if(a){if(!(0,Ca.isMissingOper)(a)){if((0,Ca.isNumberOper)(a)){var _=WJ(c.lfix(a));if(_===!1)return Xn.numErrorOper;u=_}else if((0,Ca.isStringOper)(a)){var E=HJ(a.value);if(E===!1)return Xn.valueErrorOper;u=E}else return Xn.numErrorOper;if(u===127)return Xn.valueErrorOper}if(o&&!(0,Ca.isMissingOper)(o)){var N=(0,Gt.chkNumMultiOper)(e,o);if(!(0,dvr.isSuccess)(N))return N.reason;h=N.value}}for(var k=h==null?[]:Evr(h),q=k.length-1;q>=0;q-=1){var V=k[q];switch(V.kind){case Cf.OperKind.Number:case Cf.OperKind.String:case Cf.OperKind.Blank:var I=(0,Gt.chkDateOper)(e,V);if((0,Ca.isErrorOper)(I))return I;y[q]=I;break;case Cf.OperKind.Error:return V;default:return Xn.valueErrorOper}}for(;c.cond(m)>0;){s=(0,Gt.assertNumber)(c.add(s,f));var M=c.lfix(s);if(!O3(u,M)){for(var B=!0,q=0;q<k.length;q+=1)if(c.cond2(y[q],s)===0){B=!1;break}B&&(m=(0,Gt.assertNumber)(c.sub(m,c.one)))}}return s=KJ(c,s,d.date1904),(0,Gt.validDateRange)(e,s)?s:Xn.numErrorOper}Wn.workday_intl=VJ;function Pvr(e,r){var t=r[0],n=r[1],a=r[2];return a?VJ(e,[t,n,Xn.missingOper,a]):VJ(e,[t,n])}Wn.workday=Pvr;function Avr(e,r,t,n,a,o){var u=e.lfix(n),s=e.lfix(a),l=e.lfix(o);return r.toNum(t,(0,iu.dateTime)(l,s,u,0,0,0,0,0,iu.Rounding.RoundSec))}var Fvr=1900,Nvr=-9999;function Ovr(e,r,t,n){var a=e.mathpack,o=e.datepack,u=e.config,s=lR.__assign(lR.__assign({},u),{date1904:!1}),l=o.fromNum(s,r,iu.Rounding.RoundSec);if(l===!1)return l;var c=a.fromNumber(l.dom),d=a.fromNumber(l.mon),f=a.fromNumber(12),m=a.fromNumber(l.yr);if(a.cond(t)>=0){m=(0,Gt.assertNumber)(a.add(a.floor((0,Gt.assertNumber)(a.div(t,f))),m));var v=(0,Gt.assertNumber)((0,Gt.numMod)(a,t,f)),h=(0,Gt.assertNumber)(a.add(v,d));a.cond2(h,f)===1&&(m=(0,Gt.assertNumber)(a.add(m,a.one))),d=(0,Gt.assertNumber)((0,Gt.numMod)(a,h,f))}else{var y=a.neg(t),_=a.floor((0,Gt.assertNumber)(a.div(y,f)));m=(0,Gt.assertNumber)(a.sub(m,_));var v=(0,Gt.assertNumber)((0,Gt.numMod)(a,y,f));if(a.cond2(v,d)>=0)m=(0,Gt.assertNumber)(a.sub(m,a.one)),d=(0,Gt.assertNumber)(a.add((0,Gt.assertNumber)(a.sub(d,v)),f));else{var E=(0,Gt.assertNumber)(a.sub(d,v));d=(0,Gt.assertNumber)((0,Gt.numMod)(a,E,f))}}a.cond(d)===0&&(d=f);var N=a.lfix(d);switch(N){case 4:case 6:case 9:case 11:var k=a.fromNumber(30);a.cond2(c,k)>0&&(c=k);break;case 2:a.cond2(c,a.fromNumber(28))>0&&(c=a.fromNumber(o.daysPerMonth(2,a.toNumber(m),!1)));break}n&&(c=a.fromNumber(o.daysPerMonth(N,a.toNumber(m),!1)));var q=a.lfix(m);if(q<(s.dateCompatibility?Fvr:Nvr))return!1;var V=Avr(a,o,s,c,d,m);return(0,Ca.isErrorOper)(V)?!1:V}function FTe(e,r,t){var n=t[0],a=t[1],o=(0,Gt.chkDateOper)(r,n);if((0,Ca.isErrorOper)(o))return o;var u=(0,Gt.chkNumOper)(r,a);if((0,Ca.isErrorOper)(u))return u;var s=r.mathpack,l=r.config;s.cond(u)>0?u=s.floor(u):u=s.ceil(u);var c=!e,d=u,f=Ovr(r,o,d,c);return f===!1?Xn.numErrorOper:KJ(s,f,l.date1904)}Wn.edate=FTe.bind(void 0,!0);Wn.eomonth=FTe.bind(void 0,!1);function kvr(e,r,t,n,a,o){var u,s=e.mathpack;if(o===void 0||(0,Ca.isMissingOper)(o))u=oo.Saturday|oo.Sunday;else if((0,Ca.isStringOper)(o)){var l=HJ(o.value);if(l===!1)return Xn.valueErrorOper;u=l}else{var c=(0,Gt.chkNumOper)(e,o);if((0,Ca.isErrorOper)(c))return Xn.valueErrorOper;var d=WJ(s.lfix(c));if(d===!1)return Xn.numErrorOper;u=d}var f=s.fromNumber(t),m=s.fromNumber(n),v=e.dereferenceOper(a,Cf.OperKind.Array);if(!(0,Ca.isArrayOper)(v))return Xn.valueErrorOper;var h=[];function y(B){if(s.cond2(B,f)>=0&&s.cond2(B,m)<=0){var U=s.lfix(B);O3(u,U)||h.push(B)}}for(var _=0;_<v.rows;_+=1)for(var E=0;E<v.cols;E+=1){var N=v.opers[_][E];switch(N.kind){case Cf.OperKind.Number:case Cf.OperKind.String:var k=(0,Gt.chkDateOper)(e,N);if((0,Ca.isErrorOper)(k))return k;y(k);break;case Cf.OperKind.Blank:break;case Cf.OperKind.Error:return N;default:return Xn.valueErrorOper}}var q=r;if(h.length!==0){var V=h.sort(function(B,U){return s.cond2(B,U)}),I=V[0];q=(0,Gt.assertNumber)(s.sub(q,s.one));for(var _=0;_<V.length;_+=1){var M=V[_];s.cond2(M,I)!==0&&(I=M,q=(0,Gt.assertNumber)(s.sub(q,s.one)))}}return q}function jJ(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=e.mathpack,s,l=oo.Saturday|oo.Sunday,c=5;function d(X){l=X,c=7;for(var ee=l;ee!==0;)(ee&1)===1&&(c-=1),ee=ee>>1}if(a!==void 0&&!(0,Ca.isMissingOper)(a))if((0,Ca.isStringOper)(a)){var f=HJ(a.value);if(f===!1)return Xn.valueErrorOper;d(f)}else{var m=(0,Gt.chkNumOper)(e,a);if((0,Ca.isErrorOper)(m))return Xn.valueErrorOper;var v=WJ(u.lfix(m));if(v===!1)return Xn.numErrorOper;d(v)}var h=o??Xn.missingOper,y=(0,Gt.chkDateOper)(e,t);if((0,Ca.isErrorOper)(y))return y;var _=(0,Gt.chkDateOper)(e,n);if((0,Ca.isErrorOper)(_))return _;var E=u.lfix(y),N=u.lfix(_),k;E>N?(k=E,E=N,N=k,s=-1):s=1,k=E%7,k=N%7;for(var q=0,V=E<N?E:N,I=E<N?N:E;V%7!==0&&V!==I;)O3(l,V)||(q+=1),V+=1;for(;I%7!==6&&V!==I;)O3(l,I)||(q+=1),I-=1;if(I===V&&(l>>V%7&1)!==1&&(q+=1),E>N){var M=V;V=I,I=M}var B=u.fromNumber(c*Math.floor((I+1-V)/7)+q);switch(h.kind){case Cf.OperKind.Number:case Cf.OperKind.String:var U=(0,Gt.chkDateOper)(e,h);if((0,Ca.isErrorOper)(U))return U;k=u.lfix(U),k>=E&&k<=N&&k%7>=2&&(B=(0,Gt.assertNumber)(u.sub(B,u.one)));break;case Cf.OperKind.Range:case Cf.OperKind.Array:var j=kvr(e,B,E,N,h,a);if((0,Ca.isErrorOper)(j))return j;B=j;break;case Cf.OperKind.Error:return h;case Cf.OperKind.Missing:break;default:return Xn.valueErrorOper}return u.mul(u.fromNumber(s),B)}Wn.networkdays_intl=jJ;function Mvr(e,r){var t=r[0],n=r[1],a=r[2];return a?jJ(e,[t,n,Xn.missingOper,a]):jJ(e,[t,n])}Wn.networkdays=Mvr;function xvr(e,r,t,n){var a=e.mathpack,o=e.datepack,u=e.config,s=a.fromNumber(360),l=a.fromNumber(365),c=a.fromNumber(366);switch(r){case cc.BasisActual:var d=o.fromNum(u,t,iu.Rounding.RoundSec);if(d===!1)return!1;var f=d.dom,m=d.mon,v=d.yr,h=o.fromNum(u,n,iu.Rounding.RoundSec);if(h===!1)return!1;var y=h.dom,_=h.mon,E=h.yr,N=E-1;if(v===E)return o.daysPerMonth(2,v,u.dateCompatibility)===29?c:l;if(N===v&&(m>_||m===_&&f>=y)){if(o.daysPerMonth(2,v,u.dateCompatibility)===29){var k=o.toNum(u,(0,iu.dateTime)(v,2,29,0,0,0,0,0,iu.Rounding.RoundSec));return(0,Ca.isErrorOper)(k)?!1:a.cond2(k,t)>=0?c:l}if(o.daysPerMonth(2,E,u.dateCompatibility)===29){var k=o.toNum(u,(0,iu.dateTime)(v,2,29,0,0,0,0,0,iu.Rounding.RoundSec));return(0,Ca.isErrorOper)(k)?!1:a.cond2(k,n)<=0?c:l}return l}for(var q=0,V=v;V<=E;V+=1)o.daysPerMonth(2,V,u.dateCompatibility)===29?q+=366:q+=365;var I=a.fromNumber(E-v+1);return(0,Gt.assertNumber)(a.div(a.fromNumber(q),I));case cc.Basis30360:case cc.BasisActual360:case cc.BasisE30360:return s;case cc.BasisActual365:return l;default:return s}}function NTe(e,r,t,n,a,o,u){var s=e.mathpack,l=(t-r)*360,c=(a-n)*30;return s.fromNumber(u-o+c+l)}function Ivr(e,r,t){var n=e.datepack,a=e.config,o=n.fromNum(a,r,iu.Rounding.RoundSec);if(o===!1)return!1;var u=o.dom,s=o.mon,l=o.yr,c=n.fromNum(a,t,iu.Rounding.RoundSec);if(c===!1)return!1;var d=c.dom,f=c.mon,m=c.yr;return u===31&&(u=30),d===31&&(d=30),NTe(e,l,m,s,f,u,d)}function UJ(e,r,t,n){var a=e.datepack,o=e.config,u=a.daysPerMonth(t,n,o.dateCompatibility);return r===u}function wvr(e,r,t,n,a){var o=e.datepack,u=e.config,s=o.fromNum(u,r,iu.Rounding.RoundSec);if(s===!1)return!1;var l=s.dom,c=s.mon,d=s.yr,f=o.fromNum(u,t,iu.Rounding.RoundSec);if(f===!1)return!1;var m=f.dom,v=f.mon,h=f.yr;return m===2&&UJ(e,m,v,h)&&(l===2&&UJ(e,l,c,d)||n===3)&&(m=30),m===31&&(l>=30||n===3)&&(m=30),l===31&&(l=30),a&&c===2&&UJ(e,l,c,d)&&(l=30),NTe(e,d,h,c,v,l,m)}function Dvr(e,r,t,n,a){var o=e.mathpack,u=o.cond2(r,t);switch(u){case 1:break;case 0:return o.zero;case-1:switch(n){case cc.Basis30360:return wvr(e,r,t,a,!0);case cc.BasisActual360:case cc.BasisActual365:case cc.BasisActual:return(0,Gt.assertNumber)(o.sub(t,r));case cc.BasisE30360:return Ivr(e,r,t)}break}return!1}var cc;(function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"})(cc||(cc={}));function Lvr(e,r){var t=cc.DefaultBasis;if(r===void 0||(0,Ca.isMissingOper)(r))return t;var n=(0,Gt.chkNumOper)(e,r);if((0,Ca.isErrorOper)(n))return n;var a=e.mathpack;switch(t=a.lfix(a.floor(n)),t){case cc.Basis30360:case cc.BasisActual:case cc.BasisActual360:case cc.BasisActual365:case cc.BasisE30360:return t;default:return Xn.numErrorOper}}function qvr(e,r){var t=r[0],n=r[1],a=r[2],o=cc.DefaultBasis;if(a!==void 0){var u=Lvr(e,a);if(typeof u!="number")return u;o=u}var s=(0,Gt.chkDateOper)(e,t);if((0,Ca.isErrorOper)(s))return s;var l=(0,Gt.chkDateOper)(e,n);if((0,Ca.isErrorOper)(l))return l;var c=e.mathpack;if(c.cond2(s,l)>0){var d=s;s=l,l=d}var f=Dvr(e,s,l,o,0);if(f===!1)return Xn.numErrorOper;var m=xvr(e,o,s,l);return m===!1?Xn.numErrorOper:c.div(f,m)}Wn.yearFrac=qvr});var XJ=T(QF=>{"use strict";p();Object.defineProperty(QF,"__esModule",{value:!0});QF.gestep=QF.delta=void 0;var OTe=xm(),QJ=Na();function kTe(e,r){var t=r[0],n=r[1],a=n===void 0||(0,QJ.isMissingOper)(n)?e.mathpack.zero:(0,OTe.chkNumOper)(e,n);if((0,QJ.isErrorOper)(a))return a;var o=(0,OTe.chkNumOper)(e,t);return(0,QJ.isErrorOper)(o)?o:[o,a]}function Gvr(e,r){var t=kTe(e,r);if(!Array.isArray(t))return t;var n=t[0],a=t[1],o=e.mathpack;return o.cond2(n,a)===0?o.one:o.zero}QF.delta=Gvr;function Bvr(e,r){var t=kTe(e,r);if(!Array.isArray(t))return t;var n=t[0],a=t[1],o=e.mathpack;return o.cond2(n,a)>=0?o.one:o.zero}QF.gestep=Bvr});var YJ=T(Up=>{"use strict";p();Object.defineProperty(Up,"__esModule",{value:!0});Up.info=Up.error_type=Up.type=Up.n_=Up.t_=Up.na=void 0;var YF=Ua(),Uvr=oc(),uS=Na(),Kvr=fi(),XF=au(),Vvr=uc(),jvr=qo();function Wvr(e,r){return YF.naErrorOper}Up.na=Wvr;function MTe(e,r){if((0,uS.isRangeOper)(r)){if((0,uS.isSheetIndex)(r.sheets)){var t=(0,YF.rangeSeqOper)(r.sheets,[(0,uS.gridRangeAnchor)(r.ranges[0])]);return e.dereferenceOper(t,Uvr.readOperType)}return YF.valueErrorOper}return r}function Hvr(e,r){var t=r[0],n=MTe(e,t);return(0,uS.isStringOper)(n)||(0,uS.isErrorOper)(n)?n:Vvr.emptyStringOper}Up.t_=Hvr;function zvr(e,r){var t=r[0],n=MTe(e,t);if((0,uS.isNumberOper)(n)||(0,uS.isErrorOper)(n))return n;var a=e.mathpack;return(0,uS.isBooleanOper)(n)&&n.value?a.one:a.zero}Up.n_=zvr;function Qvr(e,r){var t=r[0],n=e.mathpack;switch(t.kind){case XF.OperKind.Number:return n.fromNumber(1);case XF.OperKind.String:return n.fromNumber(2);case XF.OperKind.Boolean:return n.fromNumber(4);case XF.OperKind.Error:return n.fromNumber(16);case XF.OperKind.Array:return n.fromNumber(64);case XF.OperKind.Rich:return n.fromNumber(128);default:return(0,Kvr.assertNever)("calc.funcs.type",t)}}Up.type=Qvr;function Xvr(e,r){var t=r[0];return(0,uS.isErrorOper)(t)?(t.type>YF.ErrorType.CALC&&(0,jvr.throwEvaluationError)((0,uS.notImplemented)(["ERROR.TYPE for "+String(t.type)])),e.mathpack.fromNumber(t.type)):YF.naErrorOper}Up.error_type=Xvr;function Yvr(e,r){return YF.valueErrorOper}Up.info=Yvr});var rZ=T(Tf=>{"use strict";p();Object.defineProperty(Tf,"__esModule",{value:!0});Tf.scan=Tf.reduce=Tf.bycol=Tf.byrow=Tf.map=Tf.makearray=Tf.apply=void 0;var Xg=Ua(),Jvr=Wy(),JJ=oc(),CC=oc(),Zvr=qo(),cl=Na(),TC=vf(),JF=xm(),k3=au(),cI=Il(),ZJ=fi(),xTe=Dl(),$vr=kF();function ehr(e,r){return!(0,cl.isRangeOper)(r)||!(0,cl.isSheetIndex)(r.sheets)||r.ranges.length!==1||!(0,cl.isGridCell)(r.ranges[0])?r:e.dereferenceOper(r,k3.SignatureType.All&~k3.OperKind.Range)}function M3(e,r,t){var n=ehr(e,r);return!(n instanceof Jvr.LambdaOper)||!n.checkArity(t)?Xg.valueErrorOper:n}function rhr(e,r){var t=r[0],n=r.slice(1),a=M3(e,t,n.length);return(0,cl.isErrorOper)(a)?a:e.applyLambda(a,n)}Tf.apply=rhr;function $J(e,r){return function(t){var n=t;if((0,cl.isRangeOper)(n)){if(!((0,cl.isSheetIndex)(n.sheets)&&n.ranges.length===1&&(0,cl.isGridCell)(n.ranges[0])))return(0,JJ.earlyReturn)((0,xTe.success)(Xg.calcErrorOper));n=r.dereferenceOper(n,k3.SignatureType.All&~k3.OperKind.Range),(0,ZJ.assertTrue)("calc.funcs.coerceLambdaRvToArrayElt",!(0,cl.isRangeOper)(n))}return(0,cl.isArrayOper)(n)?n.rows===1&&n.cols===1?n.opers[0][0]:(0,JJ.earlyReturn)((0,xTe.success)(Xg.calcErrorOper)):((0,cl.isMissingOper)(n)&&(0,Zvr.throwEvaluationError)((0,cl.notImplemented)(["".concat((0,$vr.englishWorksheetFuncIdToName)(e),": MissingOper in result")])),n)}}function thr(e,r){var t=r[0],n=r[1],a=r[2],o=M3(e,a,2);if((0,cl.isErrorOper)(o))return o;var u=e.mathpack,s=(0,cl.isMissingOper)(t)?1:u.fix(t),l=(0,cl.isMissingOper)(n)?1:u.fix(n);return s<1||l<1?Xg.valueErrorOper:((0,JF.validateArraySize)(s,l),(0,CC.machineCall)(new CC.ArrayMachine(e,s,l,function(c,d){var f=e.mathpack,m=[f.fromNumber(c+1),f.fromNumber(d+1)];return e.applyLambda(o,m)},$J(TC.WorksheetFuncId.MAKEARRAY,e))))}Tf.makearray=thr;function eZ(e,r,t,n,a){var o=M3(e,n,t.length);if((0,cl.isErrorOper)(o))return o;for(var u=[],s=0,l=t;s<l.length;s++){var c=l[s];if(!(0,cl.isArrayOper)(c)&&!(0,cl.isRangeOper)(c))return Xg.valueErrorOper;var d=(0,JF.rangeOrArrayToVal)(c,Xg.valueErrorOper);if((0,cl.isErrorOper)(d))return d;u.push(a((0,JF.makeSlicer)(d)))}var f=u.map(function(y){return y.rows}).reduce(cI.fastMin),m=u.map(function(y){return y.rows}).reduce(cI.fastMax),v=u.map(function(y){return y.cols}).reduce(cI.fastMin),h=u.map(function(y){return y.cols}).reduce(cI.fastMax);return(0,JF.validateArraySize)(m,h),(0,CC.machineCall)(new CC.ArrayMachine(e,m,h,function(y,_){return y>=f||_>=v?Xg.naErrorOper:e.applyLambda(o,u.map(function(E){return E.slice(y,1,_,1)}))},$J(r,e)))}function nhr(e,r){var t=r.slice(0,r.length-1),n=r[r.length-1];return eZ(e,TC.WorksheetFuncId.MAP,t,n,cI.identity)}Tf.map=nhr;function ahr(e,r){var t=[r[0]],n=r[1];return n===void 0?Xg.naErrorOper:eZ(e,TC.WorksheetFuncId.BYROW,t,n,function(a){return{rows:a.rows,cols:1,slice:function(u,s,l,c){return a.slice(u,s,0,a.cols)}}})}Tf.byrow=ahr;function ihr(e,r){var t=[r[0]],n=r[1];return n===void 0?Xg.naErrorOper:eZ(e,TC.WorksheetFuncId.BYCOL,t,n,function(a){return{rows:1,cols:a.cols,slice:function(u,s,l,c){return a.slice(0,a.rows,l,c)}}})}Tf.bycol=ihr;function ITe(e,r,t,n,a){var o=(0,JF.rangeOrArrayToVal)(n,Xg.valueErrorOper);if((0,cl.isErrorOper)(o))return o;var u=(0,JF.makeSlicer)(o),s=M3(e,a,2);if((0,cl.isErrorOper)(s))return s;var l=!(0,cl.isMissingOper)(t),c=l?t:void 0,d=!0,f;if(r===TC.WorksheetFuncId.REDUCE)f=function(y){return c=y,Xg.blankOper};else{var m=$J(r,e);f=function(y){var _=m(y);return _.kind===JJ.EarlyReturnKind.EarlyReturn||(c=_),_}}var v=(0,CC.machineCall)(new CC.ArrayMachine(e,u.rows,u.cols,function(h,y){var _=d;return d=!1,_&&!l?u.slice(h,1,y,1):((0,ZJ.assertTrue)("calc.funcs.scanReduce",c!==void 0),e.applyLambda(s,[c,u.slice(h,1,y,1)]))},f));return r===TC.WorksheetFuncId.REDUCE?(0,CC.machineCall)(new CC.ThenMachine(e,function(){return v},function(){return(0,ZJ.assertTrue)("calc.funcs.scanReduce",c!==void 0),c})):v}function ohr(e,r){var t=r[0],n=r[1],a=r[2];return ITe(e,TC.WorksheetFuncId.REDUCE,t,n,a)}Tf.reduce=ohr;function uhr(e,r){var t=r[0],n=r[1],a=r[2];return ITe(e,TC.WorksheetFuncId.SCAN,t,n,a)}Tf.scan=uhr});var iZ=T(Rf=>{"use strict";p();Object.defineProperty(Rf,"__esModule",{value:!0});Rf.not=Rf.false_=Rf.true_=Rf.switch_=Rf.ifs=Rf.choose=Rf.if_=void 0;var ZF=Ua(),dI=fi(),aZ=uc(),I3=vf(),Bl=Na(),x3=qo(),sS=au(),shr=(0,aZ.makeStrict)((0,I3.getWorksheetFuncType)(I3.WorksheetFuncId.IFS)),wTe=(0,aZ.makeStrict)((0,I3.getWorksheetFuncType)(I3.WorksheetFuncId.SWITCH));function lhr(e,r){var t=r[0];(0,dI.assertTrue)("calc.funcs.if: condition is not a boolean",(0,Bl.isBooleanOper)(t));var n=r[t.value?1:2];return(0,dI.assertTrue)("calc.funcs.if: result is undefined",n!==void 0),n}Rf.if_=lhr;function chr(e,r){var t=r[0];(0,dI.assertTrue)("calc.funcs.choose",(0,Bl.isNumberOper)(t));var n=e.mathpack.fix(t);return n<1||n>r.length-1?ZF.valueErrorOper:r[n]}Rf.choose=chr;function tZ(e,r,t,n){var a=n.slice();return e.dereferenceOpers(a,r),(0,aZ.arrayLift)(e,r,function(o){for(var u=[],s=0;s<o.length;s+=1){var l=(0,Bl.getArgType)(r,s,o.length);u[s]=e.coerceOper(o[s],l)}return t(e,u)},a)}function DTe(e,r){for(var t=0;t<r.length;t+=2){var n=r[t];if((0,Bl.isArrayOper)(n)){var a=r.slice(t);return tZ(e,shr,DTe,a)}if((0,Bl.isErrorOper)(n))return n;if((0,dI.assertTrue)("calc.funcs.ifs",(0,Bl.isBooleanOper)(n)),n.value)return r[t+1]}return ZF.naErrorOper}Rf.ifs=DTe;function dhr(e,r){var t=e.mathpack,n=e.localeInfo;switch(r.kind){case sS.OperKind.Number:return function(a){return(0,Bl.isRichOper)(a)?(0,x3.throwEvaluationError)((0,Bl.notImplemented)(["SWITCH with a rich value case"])):(0,Bl.isNumberOper)(a)&&t.compare(r,a)===0};case sS.OperKind.String:return function(a){return(0,Bl.isRichOper)(a)?(0,x3.throwEvaluationError)((0,Bl.notImplemented)(["SWITCH with a rich value case"])):(0,Bl.isStringOper)(a)&&n.stringCompareCI(r.value,a.value)===0};case sS.OperKind.Boolean:return function(a){return(0,Bl.isRichOper)(a)?(0,x3.throwEvaluationError)((0,Bl.notImplemented)(["SWITCH with a rich value case"])):(0,Bl.isBooleanOper)(a)&&r.value===a.value};case sS.OperKind.Rich:return(0,x3.throwEvaluationError)((0,Bl.notImplemented)(["SWITCH with a rich value condition"]));default:return(0,dI.assertNever)("calc.funcs.makeSwitchComparer",r)}}function nZ(e,r){var t=r[0];if((0,Bl.isArrayOper)(t))return tZ(e,wTe,nZ,r);if((0,Bl.isErrorOper)(t))return t;for(var n=dhr(e.config,t),a=1;a<r.length-1;a+=2){var o=sS.OperKind.Error|sS.OperKind.Rich|sS.OperKind.Number|sS.OperKind.Boolean|sS.OperKind.String|sS.OperKind.Array,u=e.coerceOper(e.dereferenceOper(r[a],o),o);if((0,Bl.isArrayOper)(u))return tZ(e,wTe,nZ,r);if((0,Bl.isErrorOper)(u))return u;if(n(u))return r[a+1]}var s=r.length%2===0;return s?r[r.length-1]:ZF.naErrorOper}Rf.switch_=nZ;function fhr(e,r){return ZF.trueOper}Rf.true_=fhr;function phr(e,r){return ZF.falseOper}Rf.false_=phr;function mhr(e,r){var t=r[0];return(0,ZF.booleanOper)(!t.value)}Rf.not=mhr});var oZ=T(w3=>{"use strict";p();var cR;Object.defineProperty(w3,"__esModule",{value:!0});w3.sortOpers=void 0;var LTe=Il(),lS=au(),$F=Na(),ghr=qo(),dR=function(r){return r<0?-1:r>0?1:0},qTe=(cR={},cR[lS.OperKind.Number]=1,cR[lS.OperKind.String]=2,cR[lS.OperKind.Boolean]=3,cR[lS.OperKind.Array]=4,cR[lS.OperKind.Error]=5,cR);function GTe(e,r,t,n,a){if((0,$F.isBlankOper)(r))return(0,$F.isBlankOper)(t)?0:1;if((0,$F.isBlankOper)(t))return-1;if((0,$F.isRichOper)(r)||(0,$F.isRichOper)(t))return(0,ghr.throwEvaluationError)((0,$F.notImplemented)(["rich value sort"]));if(r.kind!==t.kind)return dR(n*(qTe[r.kind]-qTe[t.kind]));switch(r.kind){case lS.OperKind.Number:return dR(n*e.mathpack.cond2(r,t));case lS.OperKind.String:return dR(n*e.localeInfo.stringCompareCI(r.value,t.value));case lS.OperKind.Boolean:return dR(n*(r.value-t.value));case lS.OperKind.Array:{for(var o=r,u=t,s=(0,LTe.fastMin)(o.rows,u.rows),l=(0,LTe.fastMin)(o.cols,u.cols),c=0;c<s;++c){for(var d=0;d<l;++d){var f=GTe(e,o.opers[c][d],u.opers[c][d],n,a);if(f!==0)return f}if(o.cols!==u.cols)return dR(n*(o.cols-u.cols))}return o.rows!==u.rows?dR(n*(o.rows-u.rows)):0}case lS.OperKind.Error:return a?dR(n*(r.type-t.type)):0}}w3.sortOpers=GTe});var U3=T(Yu=>{"use strict";p();Object.defineProperty(Yu,"__esModule",{value:!0});Yu.xmatch=Yu.xlookup=Yu.makeWildcardComparer=Yu.vlookup=Yu.hlookup=Yu.lookup=Yu.match=Yu.linearSearch=Yu.binarySearch=Yu.makeLookupComparer=Yu.index=void 0;var Ai=vf(),mn=Ua(),UTe=dC(),uo=Na(),mR=fi(),D3=qo(),KTe=Zx(),eN=fs(),RC=Nm(),fR=Il(),Qo=au(),L3=oZ();function uZ(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=e.mathpack,s=u.sfix(n);if(s<0)return mn.valueErrorOper;var l=a===void 0?void 0:u.sfix(a);if(l!==void 0&&l<0)return mn.valueErrorOper;var c=o===void 0?0:u.sfix(o)-1;if(c<0)return mn.valueErrorOper;var d,f;switch(t.kind){case Qo.OperKind.Range:if(!(0,uo.isSheetIndex)(t.sheets))return mn.valueErrorOper;if(c>=t.ranges.length)return mn.refErrorOper;var m=t.ranges[c];if(l===void 0)if(m.rows===1)d=0,f=s-1;else{if(m.cols!==1)return mn.refErrorOper;d=s-1,f=-1}else d=s-1,f=l-1;if(d>=m.rows||f>=m.cols)return mn.refErrorOper;var v=(0,eN.gridRange)(m.row+(0,fR.fastMax)(d,0),m.col+(0,fR.fastMax)(f,0),d===-1?m.rows:1,f===-1?m.cols:1);return(0,mn.rangeSeqOper)(t.sheets,[v]);case Qo.OperKind.Array:return c>0||(l===void 0?t.rows===1?(d=0,f=s-1):(d=s-1,f=-1):(d=s-1,f=l-1),d>=t.rows||f>=t.cols)?mn.refErrorOper:d===-1&&f===-1?t:d===-1?(0,mn.arrayOper)(t.rows,1,t.opers.map(function(h){return[h[f]]})):f===-1?(0,mn.arrayOper)(1,t.cols,[t.opers[d]]):t.opers[d][f];default:return(0,mR.assertNever)("calc.funcs.lookupFuncs: INDEX",t)}}Yu.index=uZ;var pR=function(r){return r<0?Ai.OperatorId.Lt:r>0?Ai.OperatorId.Gt:Ai.OperatorId.Eq},vhr=function(r,t,n){return pR(r.cond2(t,n))},hhr=function(r,t){return pR(r-t)};function lZ(e,r,t){t===void 0&&(t=!1);var n=!0,a=e.config,o=a.localeInfo,u=a.mathpack,s;switch(r.kind){case Qo.OperKind.Number:s=function(d){return{correctType:n,sgnT:vhr(u,d,r)}};break;case Qo.OperKind.String:if(t){var l=new KTe.WildExp(o,r.value);s=function(d){return{correctType:n,sgnT:l.test(d.value)?Ai.OperatorId.Eq:Ai.OperatorId.Ne}}}else s=function(d){return{correctType:n,sgnT:pR(o.stringCompareCI(d.value,r.value))}};break;case Qo.OperKind.Boolean:s=function(d){return{correctType:n,sgnT:hhr(d.value,r.value)}};break;case Qo.OperKind.Rich:return(0,D3.throwEvaluationError)((0,uo.notImplemented)(["lookup with rich value condition"]));case Qo.OperKind.Blank:s=function(){return{correctType:n,sgnT:Ai.OperatorId.Eq}};break;default:return(0,mR.assertNever)("calc.funcs.makeLookupComparer",r)}return function(c){var d=(0,uo.isRichOper)(c)?c.getFallback():c;return r.kind!==d.kind?{correctType:!1,sgnT:Ai.OperatorId.Ne}:s(d)}}Yu.makeLookupComparer=lZ;function G3(e,r,t){for(var n=!1,a=0,o=t.length-1,u=Math.floor((a+o)/2),s=a,l=o,c=lZ(e,r);;){var d=t.get(u),f=c(d).sgnT;if(f===Ai.OperatorId.Ne){if(u<l){for(var m=u+1;m<=l;m+=1)if(f=c(t.get(m)).sgnT,f!==Ai.OperatorId.Ne){u=m;break}}f===Ai.OperatorId.Ne&&(u=Math.floor((s+l)/2),f=Ai.OperatorId.Gt)}if(f===Ai.OperatorId.Eq){if(u<o){u+=1,n=!0,s=u,l=u;continue}return u}if(f===Ai.OperatorId.Lt?s=u+1:l=u-1,s<=l){u=Math.floor((s+l)/2);continue}if(n)u-=1;else if(f===Ai.OperatorId.Gt&&(u-=1,u>=a)){s=u,l=u;continue}return u}}Yu.binarySearch=G3;function q3(e,r,t,n){for(var a=-1,o=n===Ai.OperatorId.Eq,u=lZ(e,r,o),s=0;s<t.length;s+=1){var l=t.get(s),c=u(l),d=c.correctType,f=c.sgnT;if(d){if(f===Ai.OperatorId.Eq)return s;if(f!==Ai.OperatorId.Ne&&f===n)return a;a=s}s===t.denseLength&&(s=(0,fR.fastMax)(s,t.length-2))}return n!==Ai.OperatorId.Eq?a:t.length}Yu.linearSearch=q3;function cZ(e){switch(e.kind){case Qo.OperKind.Number:return mn.naErrorOper;case Qo.OperKind.Range:return(0,uo.isSheetIndex)(e.sheets)?e.ranges.length>1?mn.naErrorOper:e:mn.valueErrorOper;case Qo.OperKind.Array:return e}}function Shr(e,r){switch(r.kind){case Qo.OperKind.Number:return r;case Qo.OperKind.Range:if(!(0,uo.isSheetIndex)(r.sheets))return mn.valueErrorOper;if(r.ranges.length>1)return mn.refErrorOper;var t=r.ranges;return e.calcingArray?(0,D3.throwEvaluationError)((0,uo.notImplemented)(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):t[0].rows>1||t[0].cols>1?(0,D3.throwEvaluationError)((0,uo.notImplemented)(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):r;case Qo.OperKind.Array:return(0,D3.throwEvaluationError)((0,uo.notImplemented)(["HLOOKUP/VLOOKUP array argument 3"]))}}function VTe(e,r){var t;switch(r.kind){case Qo.OperKind.Number:return r;case UTe.DerefOperKind.RangeValues:t=r.arrays[0].get(0,0);break;case Qo.OperKind.Array:t=r.opers[0][0];break;default:return(0,mR.assertNever)("calc.funcs.lookupFuncs.getNumFromRef",r)}return t=e.coerceOper(t,Qo.OperKind.Number),(0,uo.isErrorOper)(t)?mn.refErrorOper:t}function yhr(e){switch(e.kind){case Qo.OperKind.Number:return e;case Qo.OperKind.Range:if(!(0,uo.isSheetIndex)(e.sheets))return mn.valueErrorOper;if(e.ranges.length>1)return mn.refErrorOper;var r=e.ranges[0];return r.rows!==1||r.cols!==1?mn.refErrorOper:e}}function jTe(e){switch(e.kind){case Qo.OperKind.Number:return mn.naErrorOper;case Qo.OperKind.Rich:return mn.naErrorOper;case Qo.OperKind.Range:if(!(0,uo.isSheetIndex)(e.sheets))return mn.valueErrorOper;if(e.ranges.length>1)return mn.naErrorOper;var r=e.ranges[0];return r.rows!==1&&r.cols!==1?mn.naErrorOper:e;case Qo.OperKind.Array:return e.rows!==1&&e.cols!==1?mn.naErrorOper:e}}function B3(e){switch(e.kind){case UTe.DerefOperKind.RangeValues:return e.arrays[0];case Qo.OperKind.Array:return new RC.StrictSparseArray2D(e.rows,e.cols,e.rows,e.cols,e.opers,mn.blankOper)}}function sZ(e,r){switch(r.kind){case Qo.OperKind.Range:var t=r.sheets,n=r.ranges[0];return new RC.NonstrictSparseArray2D(n.rows,n.cols,n.rows,n.cols,function(a,o){var u=(0,eN.gridCell)(n.row+a,n.col+o),s=e.dereferenceAllOpers([(0,mn.rangeSeqOper)(t,[u])])[0];return s.arrays[0].get(0,0)},function(){return(0,mR.assertFalse)("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")});case Qo.OperKind.Array:return new RC.StrictSparseArray2D(r.rows,r.cols,r.rows,r.cols,r.opers,mn.blankOper)}}function _hr(e,r){var t=r[0],n=r[1],a=r[2],o=a===void 0?e.mathpack.one:a,u=e.mathpack,s=yhr(o);if((0,uo.isErrorOper)(s))return s;var l=e.dereferenceAllOpers([s])[0],c=VTe(e,l);if((0,uo.isErrorOper)(c))return c;var d=jTe(n);if((0,uo.isErrorOper)(d))return d;var f=e.dereferenceAllOpers([d])[0],m=B3(f),v=m.rows===1,h=(0,RC.sparseArray2DTo1D)(m,v),y=-1;return u.cond(c)>0?y=G3(e,t,h):u.cond(c)===0?y=q3(e,t,h,Ai.OperatorId.Eq):y=q3(e,t,h,Ai.OperatorId.Lt),y<0||y>=h.length?mn.naErrorOper:e.mathpack.fromNumber(y+1)}Yu.match=_hr;function BTe(e){if((0,uo.isRangeOper)(e)){var r=e.ranges[0];return r.cols>r.rows}return e.cols>e.rows}function bhr(e,r,t){if((0,uo.isRangeOper)(t)){var n=t.ranges[0],a=(0,eN.gridRange)(n.row,n.col,(0,fR.fastMin)(r?1:e,eN.sheetRows-n.row),(0,fR.fastMin)(r?e:1,eN.sheetCols-n.col));return(0,mn.range3DOper)(t.sheets,a)}return t}function Chr(e,r){var t=r[0],n=r[1],a=r[2],o=cZ(n);if((0,uo.isErrorOper)(o))return o;var u=BTe(o),s=HTe(o,u),l=e.dereferenceAllOpers([s])[0],c=(0,RC.sparseArray2DTo1D)(B3(l),u),d=G3(e,t,c);if(d<0)return mn.naErrorOper;if(a!==void 0){var f=jTe(a);if((0,uo.isErrorOper)(f))return f;var m=BTe(f),v=bhr(c.length,m,f),h=(0,RC.sparseArray2DTo1D)(sZ(e,v),m);return d>=h.length?(0,uo.isArrayOper)(f)?mn.naErrorOper:mn.blankOper:h.get(d)}var y=sZ(e,o);return u?y.get(y.rows-1,d):y.get(d,y.cols-1)}Yu.lookup=Chr;function WTe(e,r,t){var n=r[0],a=r[1],o=r[2],u=r[3],s=u===void 0?mn.trueOper:u,l=cZ(a);if((0,uo.isErrorOper)(l))return l;var c=HTe(l,t),d=e.dereferenceAllOpers([c])[0],f=(0,RC.sparseArray2DTo1D)(B3(d),t),m=!s.value,v=m?q3(e,n,f,Ai.OperatorId.Eq):G3(e,n,f);if(v<0||v>=f.length)return mn.naErrorOper;var h=Shr(e,o);if((0,uo.isErrorOper)(h))return h;var y=e.dereferenceAllOpers([h])[0],_=VTe(e,y);if((0,uo.isErrorOper)(_))return _;var E=e.mathpack.sfix(_)-1,N=sZ(e,l);return E<0?mn.valueErrorOper:E>=(t?N.rows:N.cols)?mn.refErrorOper:t?N.get(E,v):N.get(v,E)}function Thr(e,r){return WTe(e,r,!0)}Yu.hlookup=Thr;function Rhr(e,r){return WTe(e,r,!1)}Yu.vlookup=Rhr;function HTe(e,r){if((0,uo.isRangeOper)(e)){var t=e.ranges[0],n=(0,eN.gridRange)(t.row,t.col,r?1:t.rows,r?t.cols:1);return(0,mn.rangeSeqOper)(e.sheets,[n])}return e}function Ehr(e){switch(e.kind){case Qo.OperKind.Range:return(0,mR.assertTrue)("calc.funcs.xlookup",(0,uo.isSheetIndex)(e.sheets)),e.ranges.length>1?mn.naErrorOper:[e.ranges[0].rows,e.ranges[0].cols];case Qo.OperKind.Array:return[e.rows,e.cols]}}var Kp;(function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Higher=1]="Higher",e[e.Wildcard=2]="Wildcard"})(Kp||(Kp={}));var cS;(function(e){e[e.DescendingBinary=-2]="DescendingBinary",e[e.ReverseLinear=-1]="ReverseLinear",e[e.Linear=1]="Linear",e[e.AscendingBinary=2]="AscendingBinary"})(cS||(cS={}));function zTe(e){return e===cS.DescendingBinary||e===cS.AscendingBinary}function QTe(e,r,t,n){t===void 0&&(t=mn.missingOper),n===void 0&&(n=mn.missingOper);var a=(0,uo.isMissingOper)(t)?Kp.Exact:e.mathpack.sfix(t);if(a<Kp.Lower||a>Kp.Wildcard)return mn.valueErrorOper;var o=(0,uo.isMissingOper)(n)?cS.Linear:e.mathpack.sfix(n);if(o<cS.DescendingBinary||o>cS.AscendingBinary||o===0||a===Kp.Wildcard&&zTe(o))return mn.valueErrorOper;var u=cZ(r);if((0,uo.isErrorOper)(u))return u;var s=e.dereferenceAllOpers([u])[0],l=B3(s),c=l.rows,d=l.cols,f;if(c===1)f=!0;else if(d===1)f=!1;else return mn.valueErrorOper;return{kind:void 0,lookupArray:(0,RC.sparseArray2DTo1D)(l,f),matchMode:a,searchMode:o,isHorizontal:f}}function Phr(e,r,t,n,a){return t===Ai.OperatorId.Gt?r!==Kp.Higher?!1:a===void 0?!0:pR((0,L3.sortOpers)(e,n,a,1,!1))===Ai.OperatorId.Lt:r!==Kp.Lower?!1:a===void 0?!0:pR((0,L3.sortOpers)(e,n,a,1,!1))===Ai.OperatorId.Gt}function Ahr(e,r,t){var n=r.lookupArray,a=r.matchMode,o=r.searchMode,u=e.config,s=o===cS.DescendingBinary,l,c=0,d=n.length-1;(0,mR.assertTrue)("calc.funcs.xBinarySearch",a!==Kp.Wildcard);for(var f=function(q){return pR((0,L3.sortOpers)(u,q,t,1,!1))},m=!1;d>=c;){var v=Math.floor((d+c)/2),h=n.get(v),y=f(h);if(y===Ai.OperatorId.Eq)m=!0,l=v;else if(!m){var _=a===Kp.Higher&&y===Ai.OperatorId.Gt,E=a===Kp.Lower&&y===Ai.OperatorId.Lt,N=_||E;N&&(l=v)}s!==(y===Ai.OperatorId.Lt)?c=v+1:d=v-1}return l}function XTe(e,r){var t=new KTe.WildExp(e.config.localeInfo,r.value);return function(n){return(0,uo.isStringOper)(n)&&t.test(n.value)?Ai.OperatorId.Eq:Ai.OperatorId.Ne}}Yu.makeWildcardComparer=XTe;function Fhr(e,r,t){for(var n=r.lookupArray,a=r.matchMode,o=r.searchMode,u=e.config,s,l=a===Kp.Lower||a===Kp.Higher,c=a===Kp.Wildcard&&(0,uo.isStringOper)(t)?XTe(e,t):function(E){return pR((0,L3.sortOpers)(u,E,t,1,!1))},d=o===cS.ReverseLinear?n.length-1:0,f=o===cS.ReverseLinear?-1:1,m=d;m>=0&&m<n.length;m+=f){var v=n.get(m),h=c(v);if(h===Ai.OperatorId.Eq){s=m;break}if(l&&((0,mR.assertTrue)("calc.funcs.xLinearSearch",h!==Ai.OperatorId.Ne),Phr(u,a,h,v,s===void 0?void 0:n.get(s))&&(s=m)),m>=n.denseLength){var y=n.denseLength,_=n.length-1;f>0?m=(0,fR.fastMax)(m,_-1):m=(0,fR.fastMin)(m,y+1)}}return s}function YTe(e,r,t){return zTe(r.searchMode)?Ahr(e,r,t):Fhr(e,r,t)}function Nhr(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=o===void 0?mn.missingOper:o,s=r[4],l=r[5],c=QTe(e,n,s,l);if(c.kind!==void 0)return c;var d=Ehr(a);if(!Array.isArray(d))return d;var f=d[0],m=d[1],v=c.lookupArray.length,h=v===f&&(f===1||!c.isHorizontal),y=v===m&&(m===1||c.isHorizontal);if(!h&&!y)return mn.valueErrorOper;var _=YTe(e,c,t);if(_===void 0)return(0,uo.isMissingOper)(u)?mn.naErrorOper:u;var E=e.mathpack;return h?uZ(e,[a,E.fromNumber(_+1),m===1?E.one:E.zero]):uZ(e,[a,f===1?E.one:E.zero,E.fromNumber(_+1)])}Yu.xlookup=Nhr;function Ohr(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=QTe(e,n,a,o);if(u.kind!==void 0)return u;var s=YTe(e,u,t);return s===void 0?mn.naErrorOper:e.mathpack.fromNumber(s+1)}Yu.xmatch=Ohr});var K3=T(kr=>{"use strict";p();Object.defineProperty(kr,"__esModule",{value:!0});kr.sqrtpi=kr.factdouble=kr.fact=kr.quotient=kr.mod=kr.radians=kr.degrees=kr.sign=kr.abs=kr.odd=kr.even=kr.floor_precise=kr.floor_math=kr.floor=kr.ceiling_precise=kr.ceiling_math=kr.ceiling=kr.mround=kr.rounddown=kr.roundup=kr.trunc=kr.round=kr.int=kr.atan2=kr.atan=kr.acos=kr.asin=kr.tan=kr.cos=kr.sin=kr.log=kr.log10=kr.ln=kr.power=kr.exp=kr.sqrt=kr.pi=void 0;var so=xm(),Yy=Ua(),js=Na();function khr(e,r){return e.mathpack.pi}kr.pi=khr;kr.sqrt=(0,so.wrap1)(function(e){return e.mathpack.sqrt});kr.exp=(0,so.wrap1)(function(e){return e.mathpack.exp});kr.power=(0,so.wrap2)(function(e){return e.mathpack.power});kr.ln=(0,so.wrap1)(function(e){return e.mathpack.ln});kr.log10=(0,so.wrap1)(function(e){return e.mathpack.log});function Mhr(e,r){var t=r[0],n=r[1],a=e.mathpack;if(n===void 0)return a.log(t);var o=a.ln(t);if((0,js.isErrorOper)(o))return o;var u=a.ln(n);return(0,js.isErrorOper)(u)?u:a.div(o,u)}kr.log=Mhr;kr.sin=(0,so.wrap1)(function(e){return e.mathpack.sin});kr.cos=(0,so.wrap1)(function(e){return e.mathpack.cos});kr.tan=(0,so.wrap1)(function(e){return e.mathpack.tan});kr.asin=(0,so.wrap1)(function(e){return e.mathpack.asin});kr.acos=(0,so.wrap1)(function(e){return e.mathpack.acos});kr.atan=(0,so.wrap1)(function(e){return e.mathpack.atan});kr.atan2=(0,so.wrap2)(function(e){return e.mathpack.atan2});function xhr(e,r){var t=r[0],n=e.mathpack;return n.cond2(n.abs(t),n.fromNumber(1e15))<0&&(t=n.viewRound(t)),n.floor(t)}kr.int=xhr;kr.round=(0,so.wrap2)(function(e){return e.mathpack.round});function Ihr(e,r){var t=r[0],n=r[1],a=n===void 0?e.mathpack.zero:n;return e.mathpack.roundDown(t,a)}kr.trunc=Ihr;kr.roundup=(0,so.wrap2)(function(e){return e.mathpack.roundUp});kr.rounddown=(0,so.wrap2)(function(e){return e.mathpack.roundDown});function whr(e,r){var t=r[0],n=r[1],a=(0,so.chkNumOper)(e,t);if((0,js.isErrorOper)(a))return a;var o=(0,so.chkNumOper)(e,n);if((0,js.isErrorOper)(o))return o;var u=e.mathpack;if(u.cond(o)===0)return u.zero;if(u.cond(a)!==0&&u.cond(a)<0!=u.cond(o)<0)return Yy.numErrorOper;var s=u.div(a,o);if((0,js.isErrorOper)(s))return Yy.numErrorOper;var l=u.floor(s),c=(0,so.assertNumber)(u.sub(s,l)),d=u.fromNumber(.499999999999995);if(u.cond2(c,d)<0)return u.mul(l,o);var f=u.add(l,u.one);return(0,js.isErrorOper)(f)?f:u.mul(f,o)}kr.mround=whr;function dZ(e,r,t){var n=e.cond(r),a=e.cond(t);if(n>0&&a<0)return Yy.numErrorOper;if(n===0||a===0)return e.zero;var o=e.div(r,t);return(0,js.isErrorOper)(o)?o:e.mul(e.ceil(e.viewRound(o)),t)}function fZ(e,r,t){var n=e.cond(r),a=e.cond(t);if(n>0&&a<0)return Yy.numErrorOper;if(n===0&&a===0)return r;var o=e.div(r,t);return(0,js.isErrorOper)(o)?o:e.mul(e.floor(e.viewRound(o)),t)}function Dhr(e,r){var t=r[0],n=r[1];return dZ(e.mathpack,t,n)}kr.ceiling=Dhr;function Lhr(e,r){var t=r[0],n=r[1],a=r[2],o=e.mathpack,u=n===void 0||(0,js.isMissingOper)(n)?o.one:o.abs(n),s=a===void 0||(0,js.isMissingOper)(a)?o.zero:a;return o.cond(s)!==0&&o.cond(t)<0&&(u=o.neg(u)),o.cond(u)===0?o.zero:dZ(o,t,u)}kr.ceiling_math=Lhr;function qhr(e,r){var t=r[0],n=r[1],a=e.mathpack,o=n===void 0||(0,js.isMissingOper)(n)?a.one:a.abs(n);return a.cond(o)===0?a.zero:dZ(a,t,o)}kr.ceiling_precise=qhr;function Ghr(e,r){var t=r[0],n=r[1];return fZ(e.mathpack,t,n)}kr.floor=Ghr;function Bhr(e,r){var t=r[0],n=r[1],a=r[2],o=e.mathpack,u=n===void 0||(0,js.isMissingOper)(n)?o.one:o.abs(n),s=a===void 0||(0,js.isMissingOper)(a)?o.zero:a;return o.cond(s)!==0&&o.cond(t)<0&&(u=o.neg(u)),o.cond(u)===0?o.zero:fZ(o,t,u)}kr.floor_math=Bhr;function Uhr(e,r){var t=r[0],n=r[1],a=e.mathpack,o=n===void 0||(0,js.isMissingOper)(n)?a.one:a.abs(n);return a.cond(o)===0?a.zero:fZ(a,t,o)}kr.floor_precise=Uhr;function JTe(e,r,t){var n=t[0],a=r.mathpack;if(a.cond(n)>=0){var o=a.ceil(n);return a.cond2((0,so.assertNumber)((0,so.numMod)(a,o,a.fromNumber(2))),a.one)===0===e?a.add(o,a.one):o}var u=a.floor(n);return a.cond2((0,so.assertNumber)((0,so.numMod)(a,u,a.fromNumber(2))),a.one)===0===e?a.sub(u,a.one):u}kr.even=JTe.bind(void 0,!0);kr.odd=JTe.bind(void 0,!1);kr.abs=(0,so.wrap1)(function(e){return e.mathpack.abs});function Khr(e,r){var t=r[0],n=e.mathpack;return n.fromNumber(n.cond(t))}kr.sign=Khr;function Vhr(e,r){var t=r[0],n=e.mathpack,a=(0,so.assertNumber)(n.div(n.fromNumber(180),n.pi));return n.mul(t,a)}kr.degrees=Vhr;function jhr(e,r){var t=r[0],n=e.mathpack,a=(0,so.assertNumber)(n.div(n.pi,n.fromNumber(180)));return n.mul(t,a)}kr.radians=jhr;kr.mod=(0,so.wrap2)(function(e){return e.mathpack.mod});function Whr(e,r){var t=r[0],n=r[1],a=(0,so.chkNumOper)(e,t);if((0,js.isErrorOper)(a))return a;var o=(0,so.chkNumOper)(e,n);if((0,js.isErrorOper)(o))return o;var u=e.mathpack;if(u.cond(o)===0)return Yy.div0ErrorOper;var s=u.div(a,o);return(0,js.isErrorOper)(s)?Yy.numErrorOper:u.cond(s)>0?u.floor(s):u.ceil(s)}kr.quotient=Whr;function Hhr(e,r){var t=r[0],n=e.mathpack,a=n.sfix(t);if(n.cond(t)<0||a>170)return Yy.numErrorOper;for(var o=n.one,u=a;u>0;u-=1){if((0,js.isErrorOper)(o))return o;o=n.mul(n.fromNumber(u),o)}return o}kr.fact=Hhr;function zhr(e,r){var t=r[0],n=(0,so.chkNumOper)(e,t);if((0,js.isErrorOper)(n))return n;var a=e.mathpack,o=a.floor(n);if(a.cond2(o,a.fromNumber(-1))<0||a.cond2(o,a.fromNumber(300))>0)return Yy.numErrorOper;for(var u=a.one,s=a.toNumber(o),l=s;l>1;l-=2){if((0,js.isErrorOper)(u))return u;u=a.mul(a.fromNumber(l),u)}return u}kr.factdouble=zhr;function Qhr(e,r){var t=r[0],n=(0,so.chkNumOper)(e,t);if((0,js.isErrorOper)(n))return n;var a=e.mathpack;if(a.cond(n)<0)return Yy.numErrorOper;var o=a.mul(a.pi,n);return(0,js.isErrorOper)(o)?o:a.sqrt(o)}kr.sqrtpi=Qhr});var ZTe=T(Yg=>{"use strict";p();Object.defineProperty(Yg,"__esModule",{value:!0});Yg.NumberShape=Yg.KnownFormat=Yg.DateOrder=Yg.CurrencyFormat=Yg.Calendar=void 0;var fI=qr();Yg.Calendar=fI.numfmt.Calendar;Yg.CurrencyFormat=fI.numfmt.CurrencyFormat;Yg.DateOrder=fI.numfmt.DateOrder;Yg.KnownFormat=fI.numfmt.KnownFormat;Yg.NumberShape=fI.numfmt.NumberShape});var $Te=T(Bo=>{"use strict";p();Object.defineProperty(Bo,"__esModule",{value:!0});Bo.isKnownFormatDefined=Bo.getSpecial=Bo.getSingle=Bo.getKnownFormat=Bo.getColor=Bo.englishXLSXKnownFormat=Bo.buildSingle=Bo.buildScientificFormat=Bo.buildPercentFormat=Bo.buildNumberFormat=Bo.buildMMDDYYFormat=Bo.buildFractionFormat=Bo.buildCurrencyFormat=void 0;var Im=ep();Bo.buildCurrencyFormat=Im.knownFormat.buildCurrencyFormat;Bo.buildFractionFormat=Im.knownFormat.buildFractionFormat;Bo.buildMMDDYYFormat=Im.knownFormat.buildMMDDYYFormat;Bo.buildNumberFormat=Im.knownFormat.buildNumberFormat;Bo.buildPercentFormat=Im.knownFormat.buildPercentFormat;Bo.buildScientificFormat=Im.knownFormat.buildScientificFormat;Bo.buildSingle=Im.knownFormat.buildSingle;Bo.englishXLSXKnownFormat=Im.knownFormat.englishXLSXKnownFormat;Bo.getColor=Im.knownFormat.getColor;Bo.getKnownFormat=Im.knownFormat.getKnownFormat;Bo.getSingle=Im.knownFormat.getSingle;Bo.getSpecial=Im.knownFormat.getSpecial;Bo.isKnownFormatDefined=Im.knownFormat.isKnownFormatDefined});var vZ=T(Ws=>{"use strict";p();Object.defineProperty(Ws,"__esModule",{value:!0});Ws.valuetotext=Ws.arraytotext=Ws.numbervalue=Ws.isWhitespace=Ws.timevalue=Ws.datevalue=Ws.value=Ws.dollar=Ws.fixed=Ws.text=void 0;var Xhr=fe(),ou=Ua(),mI=fi(),Yhr=K3(),rN=ZTe(),V3=Xhr.__importStar(v3()),Hs=Na(),pZ=$Te(),dc=au(),mZ=NF(),eRe=qo(),pI=h3(),rRe=fC(),gZ=V3.codePointSpace,Jhr=V3.codePointTab,Zhr=V3.codePointLF,$hr=V3.codePointCR;function e0r(e,r){var t=r[0],n=r[1].value,a=(0,Hs.isRichOper)(t)?t.getFallback():t;if((0,Hs.isStringOper)(a)&&a.value.length>255||n.length>255)return ou.valueErrorOper;var o;switch(a.kind){case dc.OperKind.String:{var u=e.coerceOper(a,dc.OperKind.Number);o=(0,Hs.isNumberOper)(u)?u:a;break}case dc.OperKind.Number:o=a;break;case dc.OperKind.Boolean:{var u=e.coerceOper(a,dc.OperKind.String);(0,mI.assertTrue)("calc.funcs.text",(0,Hs.isStringOper)(u)),o=u;break}case dc.OperKind.Error:return ou.valueErrorOper}var s=e.applyFormat(e.originSheet.document,n,o,mZ.NumberFormatSource.CustomString);return s!==void 0?(0,ou.stringOper)(s):ou.valueErrorOper}Ws.text=e0r;function tRe(e,r,t,n){if(t===void 0||(0,Hs.isMissingOper)(t)){var a=n??2;return{formatValue:r,formatDecimals:a}}var o=e.config.mathpack;if(o.cond(t)<0){var u=0,s=(0,Yhr.round)(e,[r,t]);return(0,mI.assertTrue)("calc.funcs.fixedDollarRound",(0,Hs.isNumberOper)(s)||(0,Hs.isErrorOper)(s)),{formatValue:s,formatDecimals:u}}var l=o.sfix(t);return l<0||l>127?{formatValue:ou.valueErrorOper,formatDecimals:0}:{formatValue:r,formatDecimals:l}}function r0r(e,r){var t,n=r[0],a=r[1],o=r[2],u=tRe(e,n,a,void 0),s=u.formatValue,l=u.formatDecimals;if((0,Hs.isErrorOper)(s))return s;var c;(t=o==null?void 0:o.value)!==null&&t!==void 0&&t?c=l===0?rN.KnownFormat.NoComFixed0:l===2?rN.KnownFormat.NoComFixed:(0,pZ.buildNumberFormat)(e.config.localeInfo,!1,1,l):c=l===0?rN.KnownFormat.Fixed0:l===2?rN.KnownFormat.Fixed:(0,pZ.buildNumberFormat)(e.config.localeInfo,!0,4,l);var d=e.applyFormat(e.originSheet.document,c,s,mZ.NumberFormatSource.CustomBytecode);return d!==void 0?(0,ou.stringOper)(d):ou.valueErrorOper}Ws.fixed=r0r;function t0r(e,r){var t=r[0],n=r[1],a=e.config.localeInfo,o=tRe(e,t,n,a.isEastAsia?a.currencyDecimals:void 0),u=o.formatValue,s=o.formatDecimals;if((0,Hs.isErrorOper)(u))return u;var l=s===0?rN.KnownFormat.Currency:s===2?rN.KnownFormat.CurrencyDec:(0,pZ.buildCurrencyFormat)(a,!1,s,!0,!1),c=e.applyFormat(e.originSheet.document,l,u,mZ.NumberFormatSource.CustomBytecode);return c!==void 0&&c.length>0&&c.charCodeAt(c.length-1)===gZ?(0,ou.stringOper)(c.substring(0,c.length-1)):c!==void 0?(0,ou.stringOper)(c):ou.valueErrorOper}Ws.dollar=t0r;function nRe(e){for(var r=0;r<e.length&&e.charCodeAt(r)===gZ;)r+=1;return e.substring(r)}function n0r(e,r){var t=r[0];switch(t.kind){case dc.OperKind.Boolean:return ou.valueErrorOper;case dc.OperKind.Number:return t;case dc.OperKind.String:return t.value.length>255?ou.valueErrorOper:e.coerceOper((0,ou.stringOper)(nRe(t.value)),dc.OperKind.Number)}}Ws.value=n0r;function aRe(e,r){var t;return!(0,Hs.isStringOper)(r)||r.value.length>255?ou.valueErrorOper:(t=e.parseDate(nRe(r.value)))!==null&&t!==void 0?t:ou.valueErrorOper}function a0r(e,r){var t=r[0],n=aRe(e,t);return(0,Hs.isErrorOper)(n)?n:e.mathpack.trunc(n)}Ws.datevalue=a0r;function i0r(e,r){var t=r[0],n=aRe(e,t);return(0,Hs.isErrorOper)(n)?n:e.mathpack.sub(n,e.mathpack.trunc(n))}Ws.timevalue=i0r;function iRe(e){return e===gZ||e===Jhr||e===$hr||e===Zhr}Ws.isWhitespace=iRe;function o0r(e,r){var t=r[0],n=r[1],a=r[2],o=e.mathpack,u=e.config.localeInfo;if(n!==void 0&&(!(0,Hs.isStringOper)(n)||n.value==="")||a!==void 0&&(!(0,Hs.isStringOper)(a)||a.value===""))return ou.valueErrorOper;var s=function(M){return(0,pI.stringFromCodePoint)((0,pI.stringCodePointAt)(M,0))},l=u.decimalSeparator,c=n?s(n.value):l,d=a?s(a.value):u.thousandsSeparator;if(c===d)if(a===void 0)d=l;else return ou.valueErrorOper;var f=t.value;if(f==="")return o.zero;for(var m=!1,v=0,h=255,y=[],_=0,E=function(M){return y.push(M),_+=M.length};v<f.length&&_<h;){if(iRe(f.charCodeAt(v))){v+=1;continue}if(!m&&(0,rRe.stringStartsWith)(f,d,v)){v+=d.length;continue}if((0,rRe.stringStartsWith)(f,c,v))m=!0,E(l),v+=c.length;else{var N=(0,pI.stringCodePointAt)(f,v);E((0,pI.stringFromCodePoint)(N)),v+=(0,pI.numCodeUnits)(N)}}if(v!==f.length)return ou.valueErrorOper;for(var k=0;y.length>0&&y[y.length-1]==="%";)_-=y.pop().length,++k;if(y.length===0)return o.zero;var q=e.coerceOper((0,ou.stringOper)(y.join("")),dc.OperKind.Number);if(!(0,Hs.isNumberOper)(q))return ou.valueErrorOper;for(var V=q;k>0;)V=o.div(V,o.fromNumber(100)),(0,mI.assertTrue)("calc.funcs.numberValue",(0,Hs.isNumberOper)(V)),--k;return V}Ws.numbervalue=o0r;var Jg;(function(e){e[e.Concise=0]="Concise",e[e.Strict=1]="Strict"})(Jg||(Jg={}));function oRe(e,r,t){var n=t===void 0?Jg.Concise:e.mathpack.sfix(t);return n!==Jg.Concise&&n!==Jg.Strict?ou.valueErrorOper:uRe(e,r,n)}function uRe(e,r,t){var n=[],a=e.config.localeInfo;switch(r.kind){case dc.OperKind.Array:{for(var o=0;o<r.rows;++o)for(var u=0;u<r.cols;++u){var s=r.opers[o][u];if((0,Hs.isArrayOper)(s)||(0,Hs.isRangeOper)(s))return ou.calcErrorOper}var l=t===Jg.Concise?a.listSeparator:a.rowSeparator,c=t===Jg.Concise?a.listSeparator:a.columnSeparator;t===Jg.Strict&&n.push(a.leftBrace);for(var o=0;o<r.rows;++o){o!==0&&(n.push(l),t===Jg.Concise&&n.push(" "));for(var u=0;u<r.cols;++u){u!==0&&(n.push(c),t===Jg.Concise&&n.push(" "));var d=uRe(e,r.opers[o][u],t);if((0,Hs.isErrorOper)(d))return d;n.push(d.value)}}t===Jg.Strict&&n.push(a.rightBrace);break}case dc.OperKind.String:t===Jg.Strict?n.push('"'+r.value.replace(/"/g,'""')+'"'):n.push(r.value);break;case dc.OperKind.Number:case dc.OperKind.Boolean:{var f=e.coerceOper(r,dc.OperKind.String);(0,mI.assertTrue)("calc.funcs.operToText",(0,Hs.isStringOper)(f)),n.push(f.value);break}case dc.OperKind.Blank:break;case dc.OperKind.Error:{var m=a.errorNames[r.type];m==null&&(0,eRe.throwEvaluationError)((0,Hs.internal)("No locale data for error type ".concat(r.type))),n.push(m);break}case dc.OperKind.Rich:(0,eRe.throwEvaluationError)((0,Hs.notImplemented)(["ARRAYTOTEXT/VALUETOTEXT rich argument"]));default:return(0,mI.assertNever)("calc.funcs.operToText",r)}return n.reduce(function(v,h){return v+h.length},0)>ou.cellStringLimit?ou.calcErrorOper:(0,ou.stringOper)(n.join(""))}function u0r(e,r){return oRe(e,r[0],r[1])}Ws.arraytotext=u0r;function s0r(e,r){return oRe(e,r[0],r[1])}Ws.valuetotext=s0r});var SZ=T(Fi=>{"use strict";p();Object.defineProperty(Fi,"__esModule",{value:!0});Fi.formulatext=Fi.isformula=Fi.isodd=Fi.iseven=Fi.isomitted=Fi.islambda=Fi.isref=Fi.isnumber=Fi.istext=Fi.isnontext=Fi.isna=Fi.islogical=Fi.isblank=Fi.iserr=Fi.iserror=void 0;var dl=Ua(),ip=Na(),j3=fs(),l0r=Nm(),c0r=Wy(),hZ=xm();function d0r(e,r){var t=r[0];return(0,dl.booleanOper)((0,ip.isErrorOper)(t))}Fi.iserror=d0r;function f0r(e,r){var t=r[0];return(0,dl.booleanOper)((0,ip.isErrorOper)(t)&&t.type!==dl.ErrorType.NA)}Fi.iserr=f0r;function p0r(e,r){var t=r[0];return(0,dl.booleanOper)((0,ip.isBlankOper)(t))}Fi.isblank=p0r;function m0r(e,r){var t=r[0];return(0,dl.booleanOper)((0,ip.isBooleanOper)(t))}Fi.islogical=m0r;function g0r(e,r){var t=r[0];return(0,dl.booleanOper)((0,ip.isErrorOper)(t)&&t.type===dl.ErrorType.NA)}Fi.isna=g0r;function v0r(e,r){var t=r[0];return(0,dl.booleanOper)(!(0,ip.isStringOper)(t))}Fi.isnontext=v0r;function h0r(e,r){var t=r[0];return(0,dl.booleanOper)((0,ip.isStringOper)(t))}Fi.istext=h0r;function S0r(e,r){var t=r[0];return(0,dl.booleanOper)((0,ip.isNumberOper)(t))}Fi.isnumber=S0r;function y0r(e,r){var t=r[0];return(0,dl.booleanOper)((0,ip.isRangeOper)(t))}Fi.isref=y0r;function _0r(e,r){var t=r[0];return(0,dl.booleanOper)(t instanceof c0r.LambdaOper)}Fi.islambda=_0r;function b0r(e,r){var t=r[0];return(0,dl.booleanOper)((0,ip.isMissingOper)(t))}Fi.isomitted=b0r;function sRe(e,r){var t=r[0],n=(0,hZ.chkNumOper)(e,t);if((0,ip.isErrorOper)(n))return n;var a=e.mathpack,o=10000000000000003e-26,u=(0,hZ.assertNumber)(a.add(a.abs(n),a.fromNumber(o))),s=(0,hZ.assertNumber)(a.div(a.floor(u),a.fromNumber(2)));return(0,dl.booleanOper)(a.cond2(s,a.floor(s))===0)}Fi.iseven=sRe;function C0r(e,r){var t=sRe(e,r);return(0,ip.isBooleanOper)(t)?(0,dl.booleanOper)(!t.value):t}Fi.isodd=C0r;function lRe(e,r,t){if(!(0,ip.isSheetIndex)(r.sheets))return dl.valueErrorOper;var n=r.ranges[0];if(e.calcingArray||!(0,ip.isGridCell)(n)){var a=r.sheets;return(0,dl.arrayOper)(n.rows,n.cols,(0,l0r.jaggedArray)(n.rows,n.cols,function(u,s){var l=(0,j3.sheetGridCell)(a,(0,j3.gridCell)(n.row+u,n.col+s));return t(e.getCellFormula(l),l)}))}var o=(0,ip.sheetGridRangeAnchor)((0,j3.sheetGridRange)(r.sheets,n));return t(e.getCellFormula(o),o)}function T0r(e,r){var t=r[0];return lRe(e,t,function(n){return(0,dl.booleanOper)(n!==void 0)})}Fi.isformula=T0r;function R0r(e,r){var t=r[0];return lRe(e,t,function(n,a){if(n===void 0)return dl.naErrorOper;var o=e.printFormula(n,a.range);return n.source.kind===j3.LexicalKind.Cell?(0,dl.stringOper)(o):(0,dl.stringOper)("{"+o+"}")})}Fi.formulatext=R0r});var _Z=T(zs=>{"use strict";p();Object.defineProperty(zs,"__esModule",{value:!0});zs.single=zs.transpose=zs.offset=zs.sheet=zs.sheets=zs.column=zs.row=zs.columns=zs.rows=zs.areas=void 0;var Zu=Ua(),Ju=Na(),H3=fs(),W3=Il(),E0r=fi(),yZ=Nm();function P0r(e,r){var t=r[0];return(0,Ju.isSheetIndex)(t.sheets)?e.mathpack.fromNumber(t.ranges.length):Zu.valueErrorOper}zs.areas=P0r;function A0r(e,r){var t=r[0],n=e.mathpack;return(0,Ju.isArrayOper)(t)?n.fromNumber(t.rows):(0,Ju.isSheetIndex)(t.sheets)?t.ranges.length>1?Zu.refErrorOper:n.fromNumber(t.ranges[0].rows):Zu.valueErrorOper}zs.rows=A0r;function F0r(e,r){var t=r[0],n=e.mathpack;return(0,Ju.isArrayOper)(t)?n.fromNumber(t.cols):(0,Ju.isSheetIndex)(t.sheets)?t.ranges.length>1?Zu.refErrorOper:n.fromNumber(t.ranges[0].cols):Zu.valueErrorOper}zs.columns=F0r;function cRe(e,r){if(!r)return[e.reflectionGridCell,!e.calcingArray];if(!(0,Ju.isSheetIndex)(r.sheets))return Zu.valueErrorOper;if(r.ranges.length>1)return Zu.refErrorOper;var t=r.ranges[0];return[t,(0,Ju.isGridCell)(t)]}function N0r(e,r){var t=r[0],n=cRe(e,t);if(!Array.isArray(n))return n;var a=n[0],o=n[1],u=e.mathpack;return o?u.fromNumber(a.row+1):(0,Zu.arrayOper)(a.rows,1,(0,yZ.jaggedArray)(a.rows,1,function(s){return u.fromNumber(a.row+s+1)}))}zs.row=N0r;function O0r(e,r){var t=r[0],n=cRe(e,t);if(!Array.isArray(n))return n;var a=n[0],o=n[1],u=e.mathpack;return o?u.fromNumber(a.col+1):(0,Zu.arrayOper)(1,a.cols,(0,yZ.jaggedArray)(1,a.cols,function(s,l){return u.fromNumber(a.col+l+1)}))}zs.column=O0r;function k0r(e,r){var t=r[0],n=e.mathpack;return t?(0,Ju.isArrayOper)(t)?Zu.naErrorOper:n.fromNumber(e.getSheetRangeIndexes(t.sheets).length):n.fromNumber(e.getSheetRangeIndexes((0,H3.allSheetsRange)(e.reflectionSheet.document)).length)}zs.sheets=k0r;function M0r(e,r){var t=r[0],n=e.mathpack;if(!t){var a=e.reflectionSheet;return a.index===void 0?Zu.naErrorOper:n.fromNumber(e.getSheetRangePosition(a)+1)}if((0,Ju.isStringOper)(t)){var o=e.getSheetIndex(e.reflectionSheet.document,t.value);return o===void 0?Zu.naErrorOper:n.fromNumber(e.getSheetRangePosition(o)+1)}return(0,Ju.isRangeOper)(t)?n.fromNumber(e.getSheetRangePosition(t.sheets)+1):(0,Ju.isArrayOper)(t)?Zu.naErrorOper:(0,E0r.assertNever)("calc.funcs.sheet",t)}zs.sheet=M0r;function x0r(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4];if(!(0,Ju.isSheetIndex)(t.sheets)||t.ranges.length!==1)return Zu.valueErrorOper;var s=e.mathpack,l=t.ranges[0],c=l.row,d=l.col,f=l.rows,m=l.cols,v=c;(0,Ju.isNumberOper)(n)&&(v+=s.lfix(n));var h=d;(0,Ju.isNumberOper)(a)&&(h+=s.lfix(a));var y=v+f-1;if(o!==void 0&&(0,Ju.isNumberOper)(o)){var _=s.cond(o);if(_===0)return Zu.refErrorOper;y=v+s.lfix(o)-(_>0?1:-1)}var E=h+m-1;if(u!==void 0&&(0,Ju.isNumberOper)(u)){var _=s.cond(u);if(_===0)return Zu.refErrorOper;E=h+s.lfix(u)-(_>0?1:-1)}var N=(0,W3.fastMin)(v,y),k=(0,W3.fastMin)(h,E),q=(0,W3.fastMax)(v,y)-N+1,V=(0,W3.fastMax)(h,E)-k+1;return N<0||k<0||N+q>H3.sheetRows||k+V>H3.sheetCols?Zu.refErrorOper:(0,Zu.rangeSeqOper)(t.sheets,[(0,H3.gridRange)(N,k,q,V)])}zs.offset=x0r;function I0r(e,r){var t=r[0];return(0,Ju.isArrayOper)(t)?(0,Zu.arrayOper)(t.cols,t.rows,(0,yZ.jaggedArray)(t.cols,t.rows,function(n,a){return t.opers[a][n]})):t}zs.transpose=I0r;function w0r(e,r){var t=r[0];if((0,Ju.isPrimitiveOper)(t)||(0,Ju.isMissingOper)(t)||(0,Ju.isBlankOper)(t)||(0,Ju.isRichOper)(t))return t;if((0,Ju.isArrayOper)(t))return t.opers[0][0];if(!(0,Ju.isSheetIndex)(t.sheets))return Zu.refErrorOper;if(t.ranges.length!==1)return Zu.valueErrorOper;var n=e.originGridCell,a=(0,Ju.gridCellImplicitIsect)(n,t.ranges[0]);return a===void 0?Zu.valueErrorOper:(0,Zu.rangeSeqOper)(t.sheets,[a])}zs.single=w0r});var bZ=T(tN=>{"use strict";p();Object.defineProperty(tN,"__esModule",{value:!0});tN.record=tN.fieldvalue=void 0;var D0r=Ua(),L0r=Na(),q0r=FF(),G0r=Wy();function B0r(e,r){var t=r[0],n=r[1].value;if((0,L0r.isRichOper)(t)){var a=t.getField(n);if(a!==void 0)return a}return D0r.fieldErrorOper}tN.fieldvalue=B0r;function U0r(e,r){for(var t=r[0],n=e.config.localeInfo,a=q0r.RedBlackMapTree.create(n.stringCompareCI),o=1;o<r.length;o+=2){var u=r[o].value,s=r[o+1];a=a.setValue(u,s)}return new G0r.RecordOper(a,t)}tN.record=U0r});var dRe=T(Ta=>{"use strict";p();Object.defineProperty(Ta,"__esModule",{value:!0});Ta.shouldQuoteQualifier=Ta.resolvePosition=Ta.quoteQualifier=Ta.formatRowRange=Ta.formatRow=Ta.formatRangePos=Ta.formatQualifier=Ta.formatGridRange=Ta.formatColRange=Ta.formatCol=Ta.formatCellPos=Ta.columnName=Ta.canonicaliseRowRange=Ta.canonicaliseRow=Ta.canonicaliseRangePos=Ta.canonicaliseColRange=Ta.canonicaliseCol=Ta.canonicaliseCellPos=Ta.canonicaliseBrackets=void 0;var fc=qr();Ta.canonicaliseBrackets=fc.cellFormat.canonicaliseBrackets;Ta.canonicaliseCellPos=fc.cellFormat.canonicaliseCellPos;Ta.canonicaliseCol=fc.cellFormat.canonicaliseCol;Ta.canonicaliseColRange=fc.cellFormat.canonicaliseColRange;Ta.canonicaliseRangePos=fc.cellFormat.canonicaliseRangePos;Ta.canonicaliseRow=fc.cellFormat.canonicaliseRow;Ta.canonicaliseRowRange=fc.cellFormat.canonicaliseRowRange;Ta.columnName=fc.cellFormat.columnName;Ta.formatCellPos=fc.cellFormat.formatCellPos;Ta.formatCol=fc.cellFormat.formatCol;Ta.formatColRange=fc.cellFormat.formatColRange;Ta.formatGridRange=fc.cellFormat.formatGridRange;Ta.formatQualifier=fc.cellFormat.formatQualifier;Ta.formatRangePos=fc.cellFormat.formatRangePos;Ta.formatRow=fc.cellFormat.formatRow;Ta.formatRowRange=fc.cellFormat.formatRowRange;Ta.quoteQualifier=fc.cellFormat.quoteQualifier;Ta.resolvePosition=fc.cellFormat.resolvePosition;Ta.shouldQuoteQualifier=fc.cellFormat.shouldQuoteQualifier});var TZ=T(lo=>{"use strict";p();Object.defineProperty(lo,"__esModule",{value:!0});lo.wraprows=lo.wrapcols=lo.torow=lo.tocol=lo.chooserows=lo.choosecols=lo.vstack=lo.hstack=lo.expand=lo.drop=lo.take=lo.sequence=lo.indirect=lo.address=void 0;var Zg=Ua(),da=Ua(),pc=fs(),Ed=xF(),fRe=dRe(),_i=Na(),Jy=vf(),K0r=vf(),gRe=fi(),V0r=fC(),CZ=Dl(),z3=au(),j0r=qo(),EC=Il(),Xc=Nm(),vRe=dC(),Vp=xm();function W0r(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=r[4],s=e.mathpack,l=(a==null?void 0:a.kind)===z3.OperKind.Number?s.sfix(a)-1:0;if(l<0||l>3)return da.valueErrorOper;var c=(l&1)!==0,d=(l&2)!==0,f=(o==null?void 0:o.kind)!==z3.OperKind.Boolean||o.value?Ed.RefStyle.A1:Ed.RefStyle.R1C1,m=function(q,V,I){return f===Ed.RefStyle.R1C1&&q?-V<I&&I<V:1<=I&&I<=V},v=s.sfix(t);if(!m(d,pc.sheetRows,v)||!(0,_i.isNumberOper)(n))return da.valueErrorOper;var h=s.sfix(n);if(!m(c,pc.sheetCols,h))return da.valueErrorOper;var y=(0,pc.gridCell)(v<0?pc.sheetRows-1:0,h<0?pc.sheetCols-1:0),_=(0,Ed.pos)(d?Ed.PosKind.Rel:Ed.PosKind.Abs,f===Ed.RefStyle.R1C1&&d?v:v-1),E=(0,Ed.pos)(c?Ed.PosKind.Rel:Ed.PosKind.Abs,f===Ed.RefStyle.R1C1&&c?h:h-1),N=(0,fRe.formatCellPos)(e.config.localeInfo,f,y,_,E,!1);return(0,gRe.assertTrue)("calc.funcs.address: cell wrapped",N!==void 0),(u==null?void 0:u.kind)===z3.OperKind.String?u.value===""?(0,da.stringOper)("!"+N):u.value.length>255?da.valueErrorOper:(0,da.stringOper)((0,fRe.formatQualifier)(e.config.localeInfo,e.config.refStyle,u.value)+"!"+N):(0,da.stringOper)(N)}lo.address=W0r;function H0r(e,r){var t,n=r[0].value,a=r[1],o=!((t=a==null?void 0:a.value)!==null&&t!==void 0)||t?Ed.RefStyle.A1:Ed.RefStyle.R1C1;if(n.length>255||(0,V0r.stringStartsWith)(n," "))return da.valueErrorOper;var u=(0,pc.originCell)(e.originSheet,e.originGridCell),s=!0,l={lexicalKind:pc.LexicalKind.Indirect,originGridCell:(0,CZ.success)(u.range),originSheet:(0,CZ.success)(u.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:s,workbookLoad:!1},c=e.parseFormula(o,u.range,l,"="+n);if(!(0,CZ.isSuccess)(c))return da.refErrorOper;for(var d=c.value.node,f=!1,m=!1;;){if(!f&&d.kind===Ed.NodeKind.App&&(0,_i.isOperatorNode)(d.head)&&d.head.id===K0r.OperatorId.Pound&&d.args.length===1&&(f=!0,d=d.args[0]),!m&&d.kind===Ed.NodeKind.Name){var v=e.getNameFormula(d.qualifier,d.whole,pc.NameSource.Indirect);if(v===void 0)return da.refErrorOper;u=(0,pc.originCell)(u.sheet,(0,pc.gridCell)(0,0)),d=v[1],m=!0;continue}if(d.kind===Ed.NodeKind.CellRef){var h=e.getCellRef(d.qualifier,d.ref,u,s);return h===void 0||!(0,_i.isSheetIndex)(h.sheets)?da.refErrorOper:f?(0,j0r.throwEvaluationError)((0,_i.notImplemented)(["# operator in INDIRECT"])):h}if(d.kind===Ed.NodeKind.StructRef){if(d.lhs===void 0)return da.refErrorOper;var h=e.getStructRef(d.lhs,d.rhs,u);return h===void 0||f?da.refErrorOper:h}return da.refErrorOper}}lo.indirect=H0r;var z0r=function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3],s=r.mathpack,l=(0,_i.isMissingOper)(n)?1:s.sfix(n),c=a===void 0||(0,_i.isMissingOper)(a)?1:s.sfix(a);if(l<0||l>pc.sheetRows||c<0||c>pc.sheetRows)return da.valueErrorOper;if((0,Vp.validateArraySize)(l,c),l===0||c===0)return da.calcErrorOper;for(var d=o===void 0||(0,_i.isMissingOper)(o)?s.fromNumber(1):o,f=u===void 0||(0,_i.isMissingOper)(u)?s.fromNumber(1):u,m=d,v=[],h=0;h<l;h++){for(var y=[],_=0;_<c;_++)if(y.push(m),!(0,_i.isErrorOper)(m)){var E=s.add(m,f);m=(0,_i.isErrorOper)(E)?E:s.checkAlmostCancellation(f,E)}v.push(y)}return(0,da.arrayOper)(l,c,v)};lo.sequence=z0r;function pRe(e,r){if((0,EC.fastAbs)(e)<r){var t=(0,EC.fastAbs)(e);return e<0?{start:r-t,count:t}:{start:0,count:t}}return{start:0,count:r}}function mRe(e,r){if((0,EC.fastAbs)(e)<r){var t=r-(0,EC.fastAbs)(e);return e<0?{start:0,count:t}:{start:e,count:t}}return{start:0,count:0}}var Q0r=function(r,t){var n=t[0],a=t[1],o=t[2],u=r.mathpack,s=(0,Vp.rangeOrArrayToVal)(n,da.valueErrorOper);if(!(0,_i.isArrayOper)(s)&&!(0,_i.isRangeOper)(s))return s;var l=(0,Vp.makeSlicer)(s),c=(0,_i.isMissingOper)(a)?l.rows:u.lfix(a),d=o===void 0||(0,_i.isMissingOper)(o)?l.cols:u.lfix(o),f=pRe(c,l.rows),m=f.start,v=f.count,h=pRe(d,l.cols),y=h.start,_=h.count;return v===0||_===0?da.calcErrorOper:l.slice(m,v,y,_)};lo.take=Q0r;var X0r=function(r,t){var n=t[0],a=t[1],o=t[2],u=r.mathpack,s=(0,Vp.rangeOrArrayToVal)(n,da.valueErrorOper);if(!(0,_i.isArrayOper)(s)&&!(0,_i.isRangeOper)(s))return s;var l=(0,Vp.makeSlicer)(s),c=(0,_i.isMissingOper)(a)?0:u.lfix(a),d=o===void 0||(0,_i.isMissingOper)(o)?0:u.lfix(o),f=mRe(c,l.rows),m=f.start,v=f.count,h=mRe(d,l.cols),y=h.start,_=h.count;return v===0||_===0?da.calcErrorOper:l.slice(m,v,y,_)};lo.drop=X0r;function Y0r(e,r){var t=r[0],n=r[1],a=r[2],o=a===void 0?Zg.missingOper:a,u=r[3],s=u===void 0?Zg.missingOper:u,l=e.mathpack,c=(0,_i.isMissingOper)(n)?t.rows:l.lfix(n),d=(0,_i.isMissingOper)(o)?t.cols:l.lfix(o);if(c<t.rows||d<t.cols)return da.valueErrorOper;if(c===0||d===0)return da.calcErrorOper;if(d>pc.sheetRows||c>pc.sheetRows)return Zg.numErrorOper;(0,Vp.validateArraySize)(c,d);var f=(0,_i.isMissingOper)(s)?Zg.naErrorOper:s;return(0,_i.isArrayOper)(f)?da.valueErrorOper:(0,da.arrayOper)(c,d,(0,Xc.array2DToJaggedArray)(new Xc.StrictSparseArray2D(c,d,t.rows,t.cols,t.opers,f)))}lo.expand=Y0r;var J0r=function(r,t){return hRe(r,t,!0)};lo.hstack=J0r;var Z0r=function(r,t){return hRe(r,t,!1)};lo.vstack=Z0r;function $0r(e,r,t){return e.cols>=r?e:new Xc.NonstrictSparseArray2D(e.rows,r,e.rows,e.cols,e.get.bind(e),t)}var eSr=function(){return Zg.naErrorOper};function hRe(e,r,t){var n=e.dereferenceAllOpers(r),a=n.map(function(f){return(0,vRe.isRangeValues)(f)?f.arrays:[new Xc.StrictArray2D(f.rows,f.cols,f.opers)]}),o=(0,EC.safeConcat)([],a).map(function(f){return t?(0,Xc.transposeArray2D)(f):f}),u=o.reduce(function(f,m){return(0,EC.fastMax)(m.cols,f)},0),s=o.reduce(function(f,m){return f+m.rows},0);if(u>pc.sheetRows||s>pc.sheetRows)return Zg.numErrorOper;(0,Vp.validateArraySize)(s,u);var l=(0,EC.safeConcat)([],o.map(function(f){return $0r(f,u,eSr)}).map(Xc.array2DToJaggedArray)),c=new Xc.StrictArray2D(l.length,l[0].length,l),d=t?(0,Xc.transposeArray2D)(c):c;return(0,da.arrayOper)(d.rows,d.cols,(0,Xc.array2DToJaggedArray)(d))}function SRe(e,r,t){var n=r.lfix(e),a=n>0?n:-n;return a>t||a===0?da.valueErrorOper:(0,Vp.getAbsoluteIndex)(t,n)}function rSr(e,r,t){if(e.rows>1&&e.cols>1)return da.valueErrorOper;for(var n=[],a=0,o=e.opers;a<o.length;a++)for(var u=o[a],s=0,l=u;s<l.length;s++){var c=l[s];if(!(0,_i.isNumberOper)(c))return(0,_i.isErrorOper)(c)?c:da.valueErrorOper;var d=SRe(c,r,t);if(typeof d!="number")return d;n.push(d)}return n}function tSr(e,r,t){for(var n=[],a=0,o=e;a<o.length;a++){var u=o[a];if((0,_i.isArrayOper)(u)){var s=rSr(u,r,t);if(!Array.isArray(s))return s;(0,EC.safePush)(n,s)}else{var s=SRe(u,r,t);if(typeof s!="number")return s;n.push(s)}}return n}var nSr=function(r,t){for(var n=[],a=0,o=r;a<o.length;a++){var u=o[a],s=t.opers[u];n.push(s)}return n},aSr=function(r,t){return t.opers.map(function(n){for(var a=[],o=0,u=r;o<u.length;o++){var s=u[o];a.push(n[s])}return a})},yRe=function(r,t,n,a){var o=t[0],u=t.slice(1);if((0,_i.isRangeOper)(o)){if(o.ranges.length>1)return da.refErrorOper;(0,gRe.assertTrue)("calc.funcs.ChooseColRow: not 3D ref",(0,_i.isSheetIndex)(o.sheets))}var s=r.dereferenceOper(o,z3.OperKind.Array);if(!(0,_i.isArrayOper)(s))return s;var l=tSr(u,r.mathpack,a?s.rows:s.cols);if(!Array.isArray(l))return l;if(l.length>pc.sheetRows||(a?s.cols:s.rows)>pc.sheetRows)return Zg.numErrorOper;a?(0,Vp.validateArraySize)(l.length,s.cols):(0,Vp.validateArraySize)(s.rows,l.length);var c=n(l,s);return c.length===0||c[0].length===0?da.calcErrorOper:(0,da.arrayOper)(c.length,c[0].length,c)},iSr=function(r,t){return yRe(r,t,aSr,!1)};lo.choosecols=iSr;var oSr=function(r,t){return yRe(r,t,nSr,!0)};lo.chooserows=oSr;function _Re(e,r){return r?new Xc.NonstrictArray2D(1,e.length,function(t,n){return e[n]}):new Xc.NonstrictArray2D(e.length,1,function(t){return e[t]})}function bRe(e,r,t){var n=t[0],a=t[1],o=t[2],u=e.mathpack,s=e.dereferenceAllOpers([n])[0],l=(0,vRe.isRangeValues)(s)?s.arrays:[new Xc.StrictSparseArray2D(s.rows,s.cols,s.rows,s.cols,s.opers,Zg.blankOper)],c=a===void 0||(0,_i.isMissingOper)(a)?0:u.lfix(a),d=o===void 0||(0,_i.isMissingOper)(o)?!1:o.value;if(c<0||c>3)return da.valueErrorOper;for(var f=c===1||c===3,m=c===2||c===3,v=[],h=[],y=function(S,b){f&&(0,_i.isBlankOper)(S)||m&&(0,_i.isErrorOper)(S)||(v.push(S),h.push(b))},_=0,E=l;_<E.length;_++){for(var N=E[_],k=d?(0,Xc.transposeSparseArray2D)(N):N,q=k.rows,V=k.cols,I=k.denseRows,M=k.denseCols,B=0;B<I;++B){for(var U=0;U<M;++U)y(k.get(B,U),1);M<V&&y(k.getSparse(),V-M)}I<q&&V>0&&y(k.getSparse(),V*(q-I))}var j=h.reduce(function(C,S){return C+S},0);if(j===0)return da.calcErrorOper;if(j>pc.sheetRows)return Zg.numErrorOper;r===Jy.WorksheetFuncId.TOROW?(0,Vp.validateArraySize)(1,j):(0,Vp.validateArraySize)(j,1);for(var X=[],B=0;B<v.length;++B)for(var ee=v[B],re=h[B],Z=0;Z<re;++Z)X.push(ee);var J=_Re(X,r===Jy.WorksheetFuncId.TOROW);return(0,da.arrayOper)(J.rows,J.cols,(0,Xc.array2DToJaggedArray)(J))}function uSr(e,r){return bRe(e,Jy.WorksheetFuncId.TOCOL,r)}lo.tocol=uSr;function sSr(e,r){return bRe(e,Jy.WorksheetFuncId.TOROW,r)}lo.torow=sSr;function CRe(e,r,t){var n=t[0],a=t[1],o=t[2],u=o===void 0?Zg.missingOper:o;if(!(n.rows===1&&n.cols>=1)&&!(n.cols===1&&n.rows>=1))return da.valueErrorOper;var s=e.mathpack.lfix(a);if(s<1)return Zg.numErrorOper;var l=n.rows===1?n.opers[0]:n.opers.map(function(y){return y[0]}),c=l.length;if(s>=c){var d=_Re(l,r===Jy.WorksheetFuncId.WRAPROWS);return(0,da.arrayOper)(d.rows,d.cols,(0,Xc.array2DToJaggedArray)(d))}var f=Math.floor((c+s-1)/s);r===Jy.WorksheetFuncId.WRAPROWS?(0,Vp.validateArraySize)(f,s):(0,Vp.validateArraySize)(s,f);var m=(0,_i.isMissingOper)(u)?Zg.naErrorOper:u,v=function(_,E){var N=_*s+E;return N>=l.length?m:l[N]},h=r===Jy.WorksheetFuncId.WRAPROWS?new Xc.NonstrictArray2D(f,s,function(y,_){return v(y,_)}):new Xc.NonstrictArray2D(s,f,function(y,_){return v(_,y)});return(0,da.arrayOper)(h.rows,h.cols,(0,Xc.array2DToJaggedArray)(h))}function lSr(e,r){return CRe(e,Jy.WorksheetFuncId.WRAPCOLS,r)}lo.wrapcols=lSr;function cSr(e,r){return CRe(e,Jy.WorksheetFuncId.WRAPROWS,r)}lo.wraprows=cSr});var kZ=T(En=>{"use strict";p();Object.defineProperty(En,"__esModule",{value:!0});En.textAfter=En.textBefore=En.textSplit=En.substitute=En.search=En.replace=En.find=En.proper=En.upper=En.lower=En.unicode=En.code=En.unichar=En.char=En.clean=En.trim=En.rept=En.exact=En.concatenate=En.len=En.mid=En.left=En.right=void 0;var dSr=fe(),Qs=Na(),_t=Ua(),FZ=qo(),Yc=h3(),fSr=Zx(),vI=dSr.__importStar(v3()),RRe=fC(),ERe=au(),pSr=uc(),EZ=fi(),mSr=Il(),gSr=xm(),RZ=vI.codePointSpace,vSr=vI.codePointCapitalA,hSr=vI.codePointCapitalZ,SSr=vI.codePointSmallA,ySr=vI.codePointSmallZ,NZ=2147483647;function PRe(e,r){return r===void 0?1:e.cond(r)<0?_t.valueErrorOper:e.sfix(r)}function _Sr(e,r){var t,n=r[0].value,a=r[1];if(a!==void 0&&(0,Qs.isErrorOper)(a))return a;var o=PRe(e.mathpack,a);if(typeof o!="number"&&(0,Qs.isErrorOper)(o))return _t.valueErrorOper;var u=(t=(0,Yc.scanCodePointsBack)(n,n.length,o))!==null&&t!==void 0?t:0;return(0,_t.stringOper)(n.substring(u))}En.right=_Sr;function bSr(e,r){var t,n=r[0].value,a=r[1];if(a!==void 0&&(0,Qs.isErrorOper)(a))return a;var o=PRe(e.mathpack,a);if(typeof o!="number"&&(0,Qs.isErrorOper)(o))return _t.valueErrorOper;var u=(t=(0,Yc.scanCodePoints)(n,0,o))!==null&&t!==void 0?t:n.length;return(0,_t.stringOper)(n.substring(0,u))}En.left=bSr;function CSr(e,r){var t,n,a=r[0].value,o=r[1],u=r[2],s=e.mathpack,l=s.fix(o)-1,c=s.fix(u);if(s.cond(o)<0||l<0||s.cond(u)<0||c<0)return _t.valueErrorOper;var d=(t=(0,Yc.scanCodePoints)(a,0,l))!==null&&t!==void 0?t:a.length,f=(n=(0,Yc.scanCodePoints)(a,d,c))!==null&&n!==void 0?n:a.length;return(0,_t.stringOper)(a.substring(d,f))}En.mid=CSr;function TSr(e,r){var t=r[0].value;return e.mathpack.fromNumber((0,Yc.countCodePoints)(t,0,t.length))}En.len=TSr;function RSr(e,r){for(var t="",n=0;n<r.length;n+=1){var a=r[n].value;if(t.length+a.length>_t.cellStringLimit){t+=a.substring(0,_t.cellStringLimit-t.length);break}t+=a}return(0,_t.stringOper)(t)}En.concatenate=RSr;function ESr(e,r){var t=r[0],n=r[1];return((0,Qs.isRichOper)(t)||(0,Qs.isRichOper)(n))&&(0,FZ.throwEvaluationError)((0,Qs.notImplemented)(["EXACT rich argument"])),(0,_t.booleanOper)(t.value===n.value)}En.exact=ESr;function PSr(e,r){var t=r[0].value,n=r[1],a=e.mathpack,o=a.fix(n);return a.cond(n)<0||o>NZ?_t.valueErrorOper:t===""?pSr.emptyStringOper:o*t.length>_t.cellStringLimit?_t.valueErrorOper:(0,_t.stringOper)((0,RRe.repeat)(t,o))}En.rept=PSr;function ASr(e,r){for(var t=r[0].value,n="",a=0;a<t.length;){for(;a<t.length&&t.charCodeAt(a)===RZ;)a+=1;for(var o=a;a<t.length;){var u=t.charCodeAt(a)===RZ;if(a+=1,u)break}n+=t.substring(o,a)}return n.length>0&&n.charCodeAt(n.length-1)===RZ&&(n=n.substring(0,n.length-1)),(0,_t.stringOper)(n)}En.trim=ASr;function FSr(e,r){for(var t=r[0].value,n="",a=0;a<t.length;a+=1){var o=t.charCodeAt(a);(o>=256||(o&127)>=32)&&(n+=t.charAt(a))}return(0,_t.stringOper)(n)}En.clean=FSr;function NSr(e,r){var t=r[0],n=e.mathpack.sfix(t);return n<1||n>255?_t.valueErrorOper:(0,_t.stringOper)(String.fromCharCode(n))}En.char=NSr;function OSr(e,r){var t=r[0],n=e.mathpack,a=n.lfix(n.trunc(t));if(n.cond2(t,n.one)<0||a>=1114112)return _t.valueErrorOper;var o=64976,u=65007,s=65535,l=65534;return a<=65535&&(0,Yc.isAnySurrogate)(a)||a>=o&&a<=u||(a&s)>=l?_t.naErrorOper:(0,_t.stringOper)((0,Yc.stringFromCodePoint)(a))}En.unichar=OSr;function kSr(e,r){var t=r[0].value;if(t.length===0)return _t.valueErrorOper;var n=t.charCodeAt(0);return n>255?(0,FZ.throwEvaluationError)((0,Qs.notImplemented)(["CODE for codepoints > 255"])):e.mathpack.fromNumber(n)}En.code=kSr;function MSr(e,r){var t=r[0].value;if(t.length===0)return _t.valueErrorOper;var n=t.charCodeAt(0),a=e.mathpack;if(!(0,Yc.isAnySurrogate)(n))return a.fromNumber(n);if(t.length===1)return _t.valueErrorOper;var o=t.charCodeAt(1),u=(0,Yc.surrogatePairToCodePoint)(n,o);return u===void 0?_t.valueErrorOper:a.fromNumber(u)}En.unicode=MSr;function xSr(e){for(var r=0;r<e.length;r+=1)if(e.charCodeAt(r)>=128)return!1;return!0}function TRe(e){return e>=vSr&&e<=hSr||e>=SSr&&e<=ySr}function OZ(e,r,t){return e===""?e:xSr(e)?t():(0,FZ.throwEvaluationError)((0,Qs.notImplemented)([r+" for non-ASCII input"]))}function ISr(e,r){var t=r[0].value;return(0,_t.stringOper)(OZ(t,"LOWER",t.toLowerCase.bind(t)))}En.lower=ISr;function wSr(e,r){var t=r[0].value;return(0,_t.stringOper)(OZ(t,"UPPER",t.toUpperCase.bind(t)))}En.upper=wSr;function DSr(e,r){var t=r[0].value;return(0,_t.stringOper)(OZ(t,"PROPER",function(){for(var n=t.toLowerCase(),a="",o=0;;){for(var u=o;o<n.length&&!TRe(n.charCodeAt(o));)o+=1;if(a+=n.substring(u,o),o===n.length)break;var s=o,l=(0,Yc.stringCodePointAt)(n,o);for(a+=(0,Yc.stringFromCodePoint)(l).toUpperCase(),o+=(0,Yc.numCodeUnits)(l);o<n.length&&TRe(n.charCodeAt(o));)o+=1;a+=n.substring(s+1,o)}return a}))}En.proper=DSr;function LSr(e,r){var t,n=r[0].value,a=r[1].value,o=r[2],u=o!==void 0?e.mathpack.sfix(o)-1:0;if(u<0||u>=NZ)return _t.valueErrorOper;var s=(t=(0,Yc.scanCodePoints)(a,0,u))!==null&&t!==void 0?t:a.length,l=a.indexOf(n,s);return l>=0?e.mathpack.fromNumber((0,Yc.countCodePoints)(a,0,l)+1):_t.valueErrorOper}En.find=LSr;function qSr(e,r){var t,n,a=r[0].value,o=r[1],u=r[2],s=r[3].value,l=e.mathpack.sfix(o)-1;if(l<0||l>=_t.cellStringLimit)return _t.valueErrorOper;var c=e.mathpack.sfix(u);if(c<0||c>_t.cellStringLimit)return _t.valueErrorOper;var d=(t=(0,Yc.scanCodePoints)(a,0,l))!==null&&t!==void 0?t:a.length,f=(n=(0,Yc.scanCodePoints)(a,d,c))!==null&&n!==void 0?n:a.length,m=a.slice(0,d),v=a.slice(f);return m.length+s.length+v.length>_t.cellStringLimit?_t.valueErrorOper:(0,_t.stringOper)(m+s+v)}En.replace=qSr;function GSr(e,r){var t,n=r[0].value,a=r[1].value,o=r[2],u=o!==void 0?e.mathpack.sfix(o)-1:0;if(u<0||u>=NZ)return _t.valueErrorOper;for(var s=(t=(0,Yc.scanCodePoints)(a,0,u))!==null&&t!==void 0?t:a.length,l=new fSr.WildExp(e.config.localeInfo,n,!0);s<a.length;s+=1)if(l.test(a.slice(s)))return e.mathpack.fromNumber((0,Yc.countCodePoints)(a,0,s)+1);return _t.valueErrorOper}En.search=GSr;function BSr(e,r){var t=r[0],n=r[1].value,a=r[2].value,o=r[3],u=t.value,s=1/0;if(o!==void 0){var l=e.coerceOper(o,ERe.OperKind.Number);if((0,Qs.isErrorOper)(l))return l;if(s=e.mathpack.sfix(l),s<1||s>2147483646)return _t.valueErrorOper}var c=n.length;if(c>0){for(var d="",f=0,m=0;s>=0&&(m=u.indexOf(n,m))!==-1;)if(s-=1,s===1/0||s===0){var v=u.slice(f,m);if(d.length+v.length+a.length>_t.cellStringLimit)return _t.valueErrorOper;d+=v,d+=a,m+=c,f=m}else m+=1;var h=u.slice(f);return d.length+h.length>_t.cellStringLimit?_t.valueErrorOper:(d+=h,(0,_t.stringOper)(d))}return t}En.substitute=BSr;function PZ(e,r,t){if(r===void 0||(0,Qs.isMissingOper)(r))return[];if((0,Qs.isStringOper)(r))return t&&r.value.length===0?_t.valueErrorOper:[r.value];for(var n=[],a=0;a<r.rows;++a)for(var o=r.opers[a],u=0;u<o.length;++u){var s=o[u],l=e.coerceOper(s,ERe.OperKind.String);if((0,Qs.isErrorOper)(l))return l;var c=(0,gSr.assertString)(l).value;if(t&&c.length===0)return _t.valueErrorOper;n.push(c)}return n.sort(function(d,f){return d.length-f.length}),n}function AZ(e,r,t){for(var n=0,a=t;n<a.length;n++){var o=a[n];if((0,RRe.stringStartsWith)(e,o,r))return o}}function USr(e,r,t,n,a){for(var o,u=0,s=0,l=[],c;u<=r.length;){var d=void 0,f=void 0;if(s<r.length&&(d=AZ(r,s,t),f=d===void 0?AZ(r,s,n):void 0),(0,EZ.assertTrue)("calc.runtime.textsplit: current in bounds",s<=r.length),d!==void 0||f!==void 0||s===r.length){var m=s-u;(m>0||!a)&&(c===void 0&&(c=[],l.push(c)),c.push((0,_t.stringOper)(e.slice(u,s))),f!==void 0&&(c=void 0));var v=((o=d??f)!==null&&o!==void 0?o:"1").length;(0,EZ.assertTrue)("calc.runtime.textsplit: matchLength > 0",v>0),s+=v,u=s}else++s}return l}var KSr=function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3],s=t[4],l=t[5],c=n.value;if(c.length===0)return _t.valueErrorOper;var d=PZ(r,a,!0);if(!Array.isArray(d))return d;var f=PZ(r,o,!0);if(!Array.isArray(f))return f;var m=u===void 0||(0,Qs.isMissingOper)(u)?!1:u.value,v;if(s===void 0||(0,Qs.isMissingOper)(s))v=!1;else{var h=r.mathpack.lfix(s);if(h!==0&&h!==1)return _t.valueErrorOper;v=h===1}var y=l===void 0||(0,Qs.isMissingOper)(l)?_t.naErrorOper:l;if((0,Qs.isArrayOper)(y))return _t.valueErrorOper;var _=c;if(v&&(_=c.toLowerCase(),d=d.map(function(k){return k.toLowerCase()}),f=f.map(function(k){return k.toLowerCase()})),d.length===0&&f.length===0)return _t.valueErrorOper;var E=USr(c,_,d,f,m);if(!Array.isArray(E))return E;if(E.length===0)return _t.calcErrorOper;var N=E.reduce(function(k,q){return(0,mSr.fastMax)(q.length,k)},0);return(0,EZ.assertTrue)("calc.runtime.textsplit: non-zero cols",N>0),(0,_t.arrayOper)(E.length,N,E.map(function(k){for(;k.length<N;)k.push(y);return k}))};En.textSplit=KSr;function VSr(e,r,t,n,a,o,u){var s=e,l=r;if(t===0)return n>0?[0,0]:[s.length,s.length];var c=s.length-t;if(c<0)return u;a&&(s=s.toLowerCase(),l=l.map(function(y){return y.toLowerCase()}));var d=n,f=0,m=s.length,v=1;for(n<0&&(v=-1,f=m);f<=m&&f>=0;){var h=AZ(s,f,l);if(h!==void 0){if(d-=v,d===0)return[f,h.length];f+=v*(h.length-1)}f+=v}return o&&n-v===0?v===1?[s.length,0]:[0,0]:u}function jSr(e,r,t,n,a,o,u){var s=r.value,l=n===void 0||(0,Qs.isMissingOper)(n)?1:e.mathpack.sfix(n),c=PZ(e,t,!1);if(!Array.isArray(c))return c;var d=c.reduce(function(N,k){return k.length<N?k.length:N},c[0].length),f=-(s.length-d+1),m=s.length-d+1;if(n!==void 0&&!(0,Qs.isMissingOper)(n)&&(d!==0&&!(l>=f&&l<=m)||l===0))return _t.valueErrorOper;var v;if(a===void 0||(0,Qs.isMissingOper)(a))v=!1;else{var h=e.mathpack.lfix(a);if(h!==0&&h!==1)return _t.valueErrorOper;v=h===1}var y;if(o===void 0||(0,Qs.isMissingOper)(o))y=!1;else{var _=e.mathpack.lfix(o);if(_!==0&&_!==1)return _t.valueErrorOper;y=_===1}var E=u===void 0||(0,Qs.isMissingOper)(u)?_t.naErrorOper:u;return VSr(s,c,d,l,v,y,E)}function ARe(e,r,t,n,a,o,u,s){var l=jSr(r,t,n,a,o,u,s);if(Array.isArray(l)){var c=l[0],d=l[1];return e===gI.TEXTBEFORE?(0,_t.stringOper)(t.value.slice(0,c)):(0,_t.stringOper)(t.value.slice(c+d))}return l}var gI;(function(e){e[e.TEXTBEFORE=1]="TEXTBEFORE",e[e.TEXTAFTER=2]="TEXTAFTER"})(gI||(gI={}));var WSr=function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3],s=t[4],l=t[5];return ARe(gI.TEXTBEFORE,r,n,a,o,u,s,l)};En.textBefore=WSr;var HSr=function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3],s=t[4],l=t[5];return ARe(gI.TEXTAFTER,r,n,a,o,u,s,l)};En.textAfter=HSr});var MZ=T(ev=>{"use strict";p();Object.defineProperty(ev,"__esModule",{value:!0});ev.today=ev.now=ev.randarray=ev.randbetween=ev.rand=void 0;var kh=Ua(),wm=xm(),$g=Na(),ORe=GJ(),FRe=fs(),NRe=fi();function zSr(e,r){return e.getRandom()}ev.rand=zSr;function QSr(e,r){var t=r[0],n=r[1],a=(0,wm.chkNumOper)(e,t),o=(0,wm.chkNumOper)(e,n);if((0,$g.isErrorOper)(a))return a;if((0,$g.isErrorOper)(o))return o;var u=e.mathpack;if(u.cond2(a,o)>0)return kh.numErrorOper;var s=e.getRandom(),l=u.ceil(a),c=u.floor(o),d=u.sub(c,l);return(0,$g.isErrorOper)(d)?d:u.add(u.floor((0,wm.assertNumber)(u.mul((0,wm.assertNumber)(u.add(d,u.one)),s))),l)}ev.randbetween=QSr;function XSr(e,r,t){var n=e.mathpack,a=(0,wm.assertNumber)(n.add(t,n.one));return n.floor(kRe(e,r,a))}function kRe(e,r,t){var n=e.mathpack,a=n.sub(t,r),o=e.getRandom();if((0,$g.isErrorOper)(a)){var u=n.div(r,n.fromNumber(3)),s=n.div(t,n.fromNumber(3));(0,NRe.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,$g.isErrorOper)(u)&&!(0,$g.isErrorOper)(s));var l=n.sub(s,u);return(0,NRe.assertTrue)("calc.funcs.getRandomFloatBetween",!(0,$g.isErrorOper)(l)&&n.cond(l)>=0),(0,wm.assertNumber)(n.mul(n.fromNumber(3),(0,wm.assertNumber)(n.add(u,(0,wm.assertNumber)(n.mul(o,l))))))}return(0,wm.assertNumber)(n.add(r,(0,wm.assertNumber)(n.mul(o,a))))}function YSr(e,r){var t=r[0],n=t===void 0?kh.missingOper:t,a=r[1],o=a===void 0?kh.missingOper:a,u=r[2],s=u===void 0?kh.missingOper:u,l=r[3],c=l===void 0?kh.missingOper:l,d=r[4],f=d===void 0?kh.missingOper:d,m=e.mathpack,v=(0,$g.isMissingOper)(n)?1:m.sfix(n),h=(0,$g.isMissingOper)(o)?1:m.sfix(o);if(v<0||v>FRe.sheetRows||h<0||h>FRe.sheetRows)return kh.valueErrorOper;if((0,wm.validateArraySize)(v,h),v===0||h===0)return kh.calcErrorOper;var y=(0,$g.isMissingOper)(s)?m.zero:s,_=(0,$g.isMissingOper)(c)?m.one:c;if(m.cond2(y,_)>0)return kh.valueErrorOper;var E=(0,$g.isMissingOper)(f)?!1:f.value;if(E&&!((0,wm.numInt)(m,y)&&(0,wm.numInt)(m,_)))return kh.valueErrorOper;for(var N=[],k=0;k<v;k++){for(var q=[],V=0;V<h;V++){var I=E?XSr(e,y,_):kRe(e,y,_);q.push(I)}N.push(q)}return(0,kh.arrayOper)(v,h,N)}ev.randarray=YSr;function JSr(e,r){return e.getTime(ORe.TimeGranularity.Instant)}ev.now=JSr;function ZSr(e,r){return e.getTime(ORe.TimeGranularity.Day)}ev.today=ZSr});var xZ=T(Q3=>{"use strict";p();Object.defineProperty(Q3,"__esModule",{value:!0});Q3.hyperlink=void 0;function $Sr(e,r){var t=r[0],n=r[1];return e.followHyperlinks?t:n??t}Q3.hyperlink=$Sr});var qRe=T(dS=>{"use strict";p();Object.defineProperty(dS,"__esModule",{value:!0});dS.unique=dS.sortby=dS.sort=dS.filter=void 0;var op=Nm(),eyr=fi(),ryr=FF(),tyr=fC(),IRe=au(),rv=Na(),wRe=Ua(),Ul=Ua(),MRe=dC(),DRe=oZ(),gR=xm();function nyr(e,r){var t=r[0],n=r[1],a=r[2],o=(0,gR.rangeOrArrayToVal)(t,Ul.refErrorOper);if((0,rv.isErrorOper)(o))return o;var u=(0,gR.rangeOrArrayToVal)(n,Ul.refErrorOper);if((0,rv.isErrorOper)(u))return u;var s=(0,gR.makeSlicer)(o),l=s.rows,c=s.cols,d=(0,gR.makeSlicer)(u),f=d.rows,m=d.cols;if(!(f===1&&m>=1)&&!(m===1&&f>=1))return Ul.valueErrorOper;var v=f===1&&m===1?l===1:f>1;if(v?f!==l:m!==c)return Ul.valueErrorOper;for(var h=e.dereferenceAllOpers([u])[0],y=(0,op.sparseArray2DTo1D)((0,MRe.isRangeValues)(h)?h.arrays[0]:new op.StrictSparseArray2D(h.rows,h.cols,h.rows,h.cols,h.opers,Ul.blankOper),!v),_=[],E=0;E<y.length;++E){var N=e.coerceOper(y.get(E),IRe.OperKind.Boolean);if(!(0,rv.isBooleanOper)(N))return N;if(N.value)_.push(E);else if(E>=y.denseLength)break}if(v?(0,gR.validateArraySize)(_.length,c):(0,gR.validateArraySize)(l,_.length),_.length===0)return a!==void 0&&!(0,rv.isMissingOper)(a)?a:Ul.calcErrorOper;var k=e.dereferenceAllOpers([o])[0],q=(0,MRe.isRangeValues)(k)?k.arrays[0]:new op.StrictArray2D(k.rows,k.cols,k.opers),V=function(B){return new op.NonstrictArray2D(_.length,B.cols,function(U,j){return B.get(_[U],j)})},I=v?V(q):(0,op.transposeArray2D)(V((0,op.transposeArray2D)(q)));return(0,Ul.arrayOper)(I.rows,I.cols,(0,op.array2DToJaggedArray)(I))}dS.filter=nyr;function X3(e){return(0,rv.isBlankOper)(e)?(0,Ul.arrayOper)(1,1,[[e]]):e}function xRe(e,r,t,n){r===void 0&&(r=wRe.missingOper);var a=e.mathpack,o=(0,rv.isMissingOper)(r)?(0,Ul.arrayOper)(1,1,[[a.one]]):r;if(!(o.rows===1&&o.cols>=1)&&!(o.cols===1&&o.rows>=1)||o.rows*o.cols>t)return Ul.valueErrorOper;for(var u=[],s=0;s<o.rows;++s)for(var l=0;l<o.cols;++l){var c=e.coerceOper(o.opers[s][l],IRe.OperKind.Number);if(!(0,rv.isNumberOper)(c))return(0,gR.assertError)(c);var d=a.sfix(c),f=n(d);if(typeof f!="number")return f;u.push(f)}return u}function IZ(e,r){return r?new op.NonstrictArray2D(e.cols,e.rows,function(t,n){return e.opers[n][t]}):new op.StrictArray2D(e.rows,e.cols,e.opers)}function LRe(e,r,t,n){for(var a=r.rows,o=r.cols,u=e.config,s=function(v,h){for(var y=0;y<n.length;++y){var _=n[y],E=_[0],N=_[1],k=(0,DRe.sortOpers)(u,E(v),E(h),N,!1);if(k!==0)return k}return v-h},l=[],c=0;c<a;++c)l.push(c);l.sort(s);var d=new op.NonstrictArray2D(a,o,function(m,v){return r.get(l[m],v)}),f=t?(0,op.transposeArray2D)(d):d;return(0,Ul.arrayOper)(f.rows,f.cols,(0,op.array2DToJaggedArray)(f))}function ayr(e,r){var t=r[0],n=r[1],a=r[2],o=r[3],u=X3(t),s=o?o.value:!1,l=IZ(u,s),c=l.cols,d=xRe(e,n,c,function(v){return v>=1&&v<=c?v-1:Ul.valueErrorOper});if(!Array.isArray(d))return d;var f=xRe(e,a,d.length,function(v){return v===1||v===-1?v:Ul.valueErrorOper});if(!Array.isArray(f))return f;if(f.length===1)f.length=d.length,(0,tyr.arrayFill)(f,f[0]);else if(f.length!==d.length)return Ul.valueErrorOper;var m=d.map(function(v,h){return[function(y){return l.get(y,v)},f[h]]});return l.rows===1?u:LRe(e,l,s,m)}dS.sort=ayr;function iyr(e,r){var t,n=r[0],a=r.slice(1),o=X3(n);(0,eyr.assertTrue)("calc.funcs.sortby",a.every(function(N,k){return k%2===0?(0,rv.isArrayOper)(N)||(0,rv.isBlankOper)(N):(0,rv.isNumberOper)(N)||(0,rv.isMissingOper)(N)}));for(var u=[],s=0;s<a.length;s+=2)u.push([X3(a[s]),(t=a[s+1])!==null&&t!==void 0?t:wRe.missingOper]);for(var l=u[0][0].cols>=u[0][0].rows&&u[0][0].cols===o.cols,c=IZ(o,l),d=[],f=function(k,q){if(!(k.rows===1||k.cols===1))return{value:Ul.valueErrorOper};if(!(l?k.cols===o.cols:k.rows===o.rows))return{value:Ul.valueErrorOper};var V=k.opers,I=e.mathpack.sfix((0,rv.isNumberOper)(q)?q:e.mathpack.one);if(I!==1&&I!==-1)return{value:Ul.valueErrorOper};d.push([l?function(M){return V[0][M]}:function(M){return V[M][0]},I])},m=0,v=u;m<v.length;m++){var h=v[m],y=h[0],_=h[1],E=f(y,_);if(typeof E=="object")return E.value}return c.rows===1?o:LRe(e,c,l,d)}dS.sortby=iyr;function oyr(e,r){var t,n,a=r[0],o=r[1],u=r[2],s=X3(a),l=(t=o==null?void 0:o.value)!==null&&t!==void 0?t:!1,c=(n=u==null?void 0:u.value)!==null&&n!==void 0?n:!1,d=IZ(s,l);if(d.rows===1)return s;for(var f=e.config,m=function(V,I){for(var M=0;M<d.cols;++M){var B=(0,DRe.sortOpers)(f,d.get(V,M),d.get(I,M),1,!0);if(B!==0)return B}return 0},v=[],h=ryr.RedBlackMapTree.create(m),y=function(V){var I,M=void 0;I=h.getOrSetValue(V,function(){return{firstRow:V,count:0}}),h=I[0],M=I[1],M.count+=1,v.push(M)},_=0;_<d.rows;++_)y(_);var E=c?v.filter(function(q){return q.count===1}):v.filter(function(q,V){return q.firstRow===V});if(E.length===0)return Ul.calcErrorOper;var N=new op.NonstrictArray2D(E.length,d.cols,function(q,V){return d.get(E[q].firstRow,V)}),k=l?(0,op.transposeArray2D)(N):N;return(0,Ul.arrayOper)(k.rows,k.cols,(0,op.array2DToJaggedArray)(k))}dS.unique=oyr});var wZ=T(Z3=>{"use strict";p();Object.defineProperty(Z3,"__esModule",{value:!0});Z3.getWorksheetFunc=void 0;var Pd=fe(),Ot=Pd.__importStar(qJ()),fl=Pd.__importStar(zJ()),GRe=Pd.__importStar(XJ()),nN=Pd.__importStar(YJ()),vR=Pd.__importStar(rZ()),SR=Pd.__importStar(iZ()),hR=Pd.__importStar(U3()),ka=Pd.__importStar(K3()),$y=Pd.__importStar(vZ()),up=Pd.__importStar(SZ()),fS=Pd.__importStar(_Z()),J3=Pd.__importStar(bZ()),jp=Pd.__importStar(TZ()),gs=Pd.__importStar(kZ()),hI=Pd.__importStar(MZ()),uyr=Pd.__importStar(xZ()),Y3=Pd.__importStar(qRe()),Zy=Ky(),ne=vf(),te={};te[ne.WorksheetFuncId.SUM]=Ot.sum;te[ne.WorksheetFuncId.PRODUCT]=Ot.product;te[ne.WorksheetFuncId.AVERAGE]=Ot.average;te[ne.WorksheetFuncId.COUNTBLANK]=Ot.countblank;te[ne.WorksheetFuncId.MAX]=Ot.max;te[ne.WorksheetFuncId.MIN]=Ot.min;te[ne.WorksheetFuncId.AND]=Ot.and;te[ne.WorksheetFuncId.COUNTA]=Ot.counta;te[ne.WorksheetFuncId.OR]=Ot.or;te[ne.WorksheetFuncId.CONCAT]=Ot.concat;te[ne.WorksheetFuncId.AVERAGEIF]=Ot.averageif;te[ne.WorksheetFuncId.AVERAGEIFS]=Ot.averageifs;te[ne.WorksheetFuncId.COUNT]=Ot.count;te[ne.WorksheetFuncId.COUNTIF]=Ot.countif;te[ne.WorksheetFuncId.COUNTIFS]=Ot.countifs;te[ne.WorksheetFuncId.MEDIAN]=Ot.median;te[ne.WorksheetFuncId.SUMSQ]=Ot.sumsq;te[ne.WorksheetFuncId.SUMIF]=Ot.sumif;te[ne.WorksheetFuncId.SUMIFS]=Ot.sumifs;te[ne.WorksheetFuncId.LARGE]=Ot.large;te[ne.WorksheetFuncId.SMALL]=Ot.small;te[ne.WorksheetFuncId.RANK]=Ot.rank;te[ne.WorksheetFuncId.RANK_EQ]=Ot.rank;te[ne.WorksheetFuncId.RANK_AVG]=Ot.rank_avg;te[ne.WorksheetFuncId.PERCENTILE]=Ot.percentile;te[ne.WorksheetFuncId.PERCENTILE_INC]=Ot.percentile;te[ne.WorksheetFuncId.PERCENTILE_EXC]=Ot.percentile_exc;te[ne.WorksheetFuncId.QUARTILE]=Ot.quartile;te[ne.WorksheetFuncId.QUARTILE_INC]=Ot.quartile;te[ne.WorksheetFuncId.QUARTILE_EXC]=Ot.quartile_exc;te[ne.WorksheetFuncId.TRIMMEAN]=Ot.trimmean;te[ne.WorksheetFuncId.AVERAGEA]=Ot.averagea;te[ne.WorksheetFuncId.MAXA]=Ot.maxa;te[ne.WorksheetFuncId.MINA]=Ot.mina;te[ne.WorksheetFuncId.MAXIFS]=Ot.maxifs;te[ne.WorksheetFuncId.MINIFS]=Ot.minifs;te[ne.WorksheetFuncId.XOR]=Ot.xor;te[ne.WorksheetFuncId.AGGREGATE]=Ot.aggregate;te[ne.WorksheetFuncId.SUBTOTAL]=Ot.subtotal;te[ne.WorksheetFuncId.VAR]=Ot.var_;te[ne.WorksheetFuncId.VAR_S]=Ot.var_;te[ne.WorksheetFuncId.VARP]=Ot.varp;te[ne.WorksheetFuncId.VAR_P]=Ot.varp;te[ne.WorksheetFuncId.STDEV]=Ot.stdev;te[ne.WorksheetFuncId.STDEV_S]=Ot.stdev;te[ne.WorksheetFuncId.STDEVP]=Ot.stdevp;te[ne.WorksheetFuncId.STDEV_P]=Ot.stdevp;te[ne.WorksheetFuncId.VARA]=Ot.vara;te[ne.WorksheetFuncId.VARPA]=Ot.varpa;te[ne.WorksheetFuncId.STDEVA]=Ot.stdeva;te[ne.WorksheetFuncId.STDEVPA]=Ot.stdevpa;te[ne.WorksheetFuncId.AVEDEV]=Ot.avedev;te[ne.WorksheetFuncId.DEVSQ]=Ot.devsq;te[ne.WorksheetFuncId.MODE]=Ot.mode;te[ne.WorksheetFuncId.MODE_SNGL]=Ot.mode;te[ne.WorksheetFuncId.MODE_MULT]=Ot.mode_mult;te[ne.WorksheetFuncId.TEXTJOIN]=Ot.textjoin;te[ne.WorksheetFuncId.YEAR]=fl.year;te[ne.WorksheetFuncId.MONTH]=fl.month;te[ne.WorksheetFuncId.DAY]=fl.day;te[ne.WorksheetFuncId.HOUR]=fl.hour;te[ne.WorksheetFuncId.MINUTE]=fl.minute;te[ne.WorksheetFuncId.SECOND]=fl.second;te[ne.WorksheetFuncId.WEEKNUM]=fl.weeknum;te[ne.WorksheetFuncId.ISOWEEKNUM]=fl.isoweeknum;te[ne.WorksheetFuncId.WEEKDAY]=fl.weekday;te[ne.WorksheetFuncId.DATE]=fl.date;te[ne.WorksheetFuncId.TIME]=fl.time;te[ne.WorksheetFuncId.DAYS360]=fl.days360;te[ne.WorksheetFuncId.DAYS]=fl.days;te[ne.WorksheetFuncId.DATEDIF]=fl.datedif;te[ne.WorksheetFuncId.WORKDAY]=fl.workday;te[ne.WorksheetFuncId.WORKDAY_INTL]=fl.workday_intl;te[ne.WorksheetFuncId.EDATE]=fl.edate;te[ne.WorksheetFuncId.EOMONTH]=fl.eomonth;te[ne.WorksheetFuncId.NETWORKDAYS]=fl.networkdays;te[ne.WorksheetFuncId.NETWORKDAYS_INTL]=fl.networkdays_intl;te[ne.WorksheetFuncId.YEARFRAC]=fl.yearFrac;te[ne.WorksheetFuncId.DELTA]=GRe.delta;te[ne.WorksheetFuncId.GESTEP]=GRe.gestep;te[ne.WorksheetFuncId.NA]=nN.na;te[ne.WorksheetFuncId.T]=nN.t_;te[ne.WorksheetFuncId.N]=nN.n_;te[ne.WorksheetFuncId.TYPE]=nN.type;te[ne.WorksheetFuncId.ERROR_TYPE]=nN.error_type;te[ne.WorksheetFuncId.INFO]=nN.info;te[ne.WorksheetFuncId.IF]=SR.if_;te[ne.WorksheetFuncId.IFS]=SR.ifs;te[ne.WorksheetFuncId.SWITCH]=SR.switch_;te[ne.WorksheetFuncId.TRUE]=SR.true_;te[ne.WorksheetFuncId.FALSE]=SR.false_;te[ne.WorksheetFuncId.NOT]=SR.not;te[ne.WorksheetFuncId.CHOOSE]=SR.choose;te[ne.WorksheetFuncId.INDEX]=hR.index;te[ne.WorksheetFuncId.MATCH]=hR.match;te[ne.WorksheetFuncId.LOOKUP]=hR.lookup;te[ne.WorksheetFuncId.HLOOKUP]=hR.hlookup;te[ne.WorksheetFuncId.VLOOKUP]=hR.vlookup;te[ne.WorksheetFuncId.ABS]=ka.abs;te[ne.WorksheetFuncId.CEILING]=ka.ceiling;te[ne.WorksheetFuncId.ECMA_CEILING]=ka.ceiling;te[ne.WorksheetFuncId.DEGREES]=ka.degrees;te[ne.WorksheetFuncId.FLOOR]=ka.floor;te[ne.WorksheetFuncId.RADIANS]=ka.radians;te[ne.WorksheetFuncId.ROUND]=ka.round;te[ne.WorksheetFuncId.ROUNDUP]=ka.roundup;te[ne.WorksheetFuncId.ROUNDDOWN]=ka.rounddown;te[ne.WorksheetFuncId.EVEN]=ka.even;te[ne.WorksheetFuncId.SIGN]=ka.sign;te[ne.WorksheetFuncId.PI]=ka.pi;te[ne.WorksheetFuncId.SQRT]=ka.sqrt;te[ne.WorksheetFuncId.EXP]=ka.exp;te[ne.WorksheetFuncId.POWER]=ka.power;te[ne.WorksheetFuncId.LN]=ka.ln;te[ne.WorksheetFuncId.LOG10]=ka.log10;te[ne.WorksheetFuncId.LOG]=ka.log;te[ne.WorksheetFuncId.SIN]=ka.sin;te[ne.WorksheetFuncId.COS]=ka.cos;te[ne.WorksheetFuncId.TAN]=ka.tan;te[ne.WorksheetFuncId.ASIN]=ka.asin;te[ne.WorksheetFuncId.ACOS]=ka.acos;te[ne.WorksheetFuncId.ATAN]=ka.atan;te[ne.WorksheetFuncId.ATAN2]=ka.atan2;te[ne.WorksheetFuncId.FACT]=ka.fact;te[ne.WorksheetFuncId.SQRTPI]=ka.sqrtpi;te[ne.WorksheetFuncId.FACTDOUBLE]=ka.factdouble;te[ne.WorksheetFuncId.INT]=ka.int;te[ne.WorksheetFuncId.TRUNC]=ka.trunc;te[ne.WorksheetFuncId.ODD]=ka.odd;te[ne.WorksheetFuncId.MROUND]=ka.mround;te[ne.WorksheetFuncId.QUOTIENT]=ka.quotient;te[ne.WorksheetFuncId.FLOOR_MATH]=ka.floor_math;te[ne.WorksheetFuncId.FLOOR_PRECISE]=ka.floor_precise;te[ne.WorksheetFuncId.CEILING_MATH]=ka.ceiling_math;te[ne.WorksheetFuncId.CEILING_PRECISE]=ka.ceiling_precise;te[ne.WorksheetFuncId.ISO_CEILING]=ka.ceiling_precise;te[ne.WorksheetFuncId.TEXT]=$y.text;te[ne.WorksheetFuncId.FIXED]=$y.fixed;te[ne.WorksheetFuncId.DOLLAR]=$y.dollar;te[ne.WorksheetFuncId.VALUE]=$y.value;te[ne.WorksheetFuncId.DATEVALUE]=$y.datevalue;te[ne.WorksheetFuncId.TIMEVALUE]=$y.timevalue;te[ne.WorksheetFuncId.ISERROR]=up.iserror;te[ne.WorksheetFuncId.ISERR]=up.iserr;te[ne.WorksheetFuncId.ISBLANK]=up.isblank;te[ne.WorksheetFuncId.ISLOGICAL]=up.islogical;te[ne.WorksheetFuncId.ISNA]=up.isna;te[ne.WorksheetFuncId.ISNONTEXT]=up.isnontext;te[ne.WorksheetFuncId.ISTEXT]=up.istext;te[ne.WorksheetFuncId.ISNUMBER]=up.isnumber;te[ne.WorksheetFuncId.ISREF]=up.isref;te[ne.WorksheetFuncId.ISEVEN]=up.iseven;te[ne.WorksheetFuncId.ISODD]=up.isodd;te[ne.WorksheetFuncId.ISFORMULA]=up.isformula;te[ne.WorksheetFuncId.FORMULATEXT]=up.formulatext;te[ne.WorksheetFuncId.ROWS]=fS.rows;te[ne.WorksheetFuncId.COLUMNS]=fS.columns;te[ne.WorksheetFuncId.AREAS]=fS.areas;te[ne.WorksheetFuncId.SHEETS]=fS.sheets;te[ne.WorksheetFuncId.ROW]=fS.row;te[ne.WorksheetFuncId.COLUMN]=fS.column;te[ne.WorksheetFuncId.SHEET]=fS.sheet;te[ne.WorksheetFuncId.OFFSET]=fS.offset;te[ne.WorksheetFuncId.TRANSPOSE]=fS.transpose;te[ne.WorksheetFuncId.SINGLE]=fS.single;te[ne.WorksheetFuncId.ADDRESS]=jp.address;te[ne.WorksheetFuncId.INDIRECT]=jp.indirect;te[ne.WorksheetFuncId.LEFT]=gs.left;te[ne.WorksheetFuncId.RIGHT]=gs.right;te[ne.WorksheetFuncId.MID]=gs.mid;te[ne.WorksheetFuncId.LEN]=gs.len;te[ne.WorksheetFuncId.CONCATENATE]=gs.concatenate;te[ne.WorksheetFuncId.EXACT]=gs.exact;te[ne.WorksheetFuncId.REPT]=gs.rept;te[ne.WorksheetFuncId.TRIM]=gs.trim;te[ne.WorksheetFuncId.CLEAN]=gs.clean;te[ne.WorksheetFuncId.CHAR]=gs.char;te[ne.WorksheetFuncId.UNICHAR]=gs.unichar;te[ne.WorksheetFuncId.CODE]=gs.code;te[ne.WorksheetFuncId.UNICODE]=gs.unicode;te[ne.WorksheetFuncId.LOWER]=gs.lower;te[ne.WorksheetFuncId.UPPER]=gs.upper;te[ne.WorksheetFuncId.PROPER]=gs.proper;te[ne.WorksheetFuncId.FIND]=gs.find;te[ne.WorksheetFuncId.REPLACE]=gs.replace;te[ne.WorksheetFuncId.SEARCH]=gs.search;te[ne.WorksheetFuncId.SUBSTITUTE]=gs.substitute;te[ne.WorksheetFuncId.RAND]=hI.rand;te[ne.WorksheetFuncId.RANDBETWEEN]=hI.randbetween;te[ne.WorksheetFuncId.NOW]=hI.now;te[ne.WorksheetFuncId.TODAY]=hI.today;te[ne.WorksheetFuncId.HYPERLINK]=uyr.hyperlink;te[ne.WorksheetFuncId.FIELDVALUE]=J3.fieldvalue;te[ne.WorksheetFuncId._FV]=J3.fieldvalue;te[ne.WorksheetFuncId.MAKEARRAY]=vR.makearray;te[ne.WorksheetFuncId.ISOMITTED]=up.isomitted;var BRe=!1;function syr(){BRe=!0,(0,Zy.isFeatureEnabled)(Zy.FeatureName.CalcRecordFunctions)&&(te[ne.WorksheetFuncId.RECORD]=J3.record),(0,Zy.isFeatureEnabled)(Zy.FeatureName.CalcNestedRecordFunction)&&(te[ne.WorksheetFuncId.NESTEDRECORD]=J3.record),(0,Zy.isFeatureEnabled)(Zy.FeatureName.CalcLambdaBasicFunctions)&&(te[ne.WorksheetFuncId.APPLY]=vR.apply,te[ne.WorksheetFuncId.ISLAMBDA]=up.islambda),(0,Zy.isTypedChangeGateEnabled)("OfficeVSO:8501373_CalcTsFuncsFirstSlice")&&(te[ne.WorksheetFuncId.TAKE]=jp.take,te[ne.WorksheetFuncId.DROP]=jp.drop,te[ne.WorksheetFuncId.SEQUENCE]=jp.sequence,te[ne.WorksheetFuncId.TEXTBEFORE]=gs.textBefore,te[ne.WorksheetFuncId.TEXTAFTER]=gs.textAfter,te[ne.WorksheetFuncId.TEXTSPLIT]=gs.textSplit,te[ne.WorksheetFuncId.HSTACK]=jp.hstack,te[ne.WorksheetFuncId.VSTACK]=jp.vstack),(0,Zy.isTypedChangeGateEnabled)("OfficeVSO_8554430_CalcTsColRowSumProdFuncs")&&(te[ne.WorksheetFuncId.CHOOSECOLS]=jp.choosecols,te[ne.WorksheetFuncId.CHOOSEROWS]=jp.chooserows,te[ne.WorksheetFuncId.TOCOL]=jp.tocol,te[ne.WorksheetFuncId.TOROW]=jp.torow,te[ne.WorksheetFuncId.SUMPRODUCT]=Ot.sumproduct),(0,Zy.getTypedFeatureGate)("Microsoft.Office.Excel.CalcTsDec2023Funcs")&&(te[ne.WorksheetFuncId.GEOMEAN]=Ot.geomean,te[ne.WorksheetFuncId.HARMEAN]=Ot.harmean,te[ne.WorksheetFuncId.FILTER]=Y3.filter,te[ne.WorksheetFuncId.SORT]=Y3.sort,te[ne.WorksheetFuncId.SORTBY]=Y3.sortby,te[ne.WorksheetFuncId.UNIQUE]=Y3.unique,te[ne.WorksheetFuncId.MAP]=vR.map,te[ne.WorksheetFuncId.BYROW]=vR.byrow,te[ne.WorksheetFuncId.BYCOL]=vR.bycol,te[ne.WorksheetFuncId.REDUCE]=vR.reduce,te[ne.WorksheetFuncId.SCAN]=vR.scan,te[ne.WorksheetFuncId.XLOOKUP]=hR.xlookup,te[ne.WorksheetFuncId.XMATCH]=hR.xmatch,te[ne.WorksheetFuncId.MOD]=ka.mod,te[ne.WorksheetFuncId.NUMBERVALUE]=$y.numbervalue,te[ne.WorksheetFuncId.ARRAYTOTEXT]=$y.arraytotext,te[ne.WorksheetFuncId.VALUETOTEXT]=$y.valuetotext,te[ne.WorksheetFuncId.EXPAND]=jp.expand,te[ne.WorksheetFuncId.WRAPCOLS]=jp.wrapcols,te[ne.WorksheetFuncId.WRAPROWS]=jp.wraprows,te[ne.WorksheetFuncId.RANDARRAY]=hI.randarray)}function lyr(e){return BRe||syr(),te[e]}Z3.getWorksheetFunc=lyr});var URe=T(Jc=>{"use strict";p();Object.defineProperty(Jc,"__esModule",{value:!0});Jc.maxRetriesForLoadingScript=Jc.isCalcInit=Jc.initCalcThread=Jc.initCalcInThread=Jc.initCalcCalled=Jc.initCalc=Jc.getCalcAbsUrlOrThrow=Jc.getCalcAbsUrl=void 0;var PC=pr();Jc.getCalcAbsUrl=PC.config.getCalcAbsUrl;Jc.getCalcAbsUrlOrThrow=PC.config.getCalcAbsUrlOrThrow;Jc.initCalc=PC.config.initCalc;Jc.initCalcCalled=PC.config.initCalcCalled;Jc.initCalcInThread=PC.config.initCalcInThread;Jc.initCalcThread=PC.config.initCalcThread;Jc.isCalcInit=PC.config.isCalcInit;Jc.maxRetriesForLoadingScript=PC.config.maxRetriesForLoadingScript});var KRe=T(pS=>{"use strict";p();Object.defineProperty(pS,"__esModule",{value:!0});pS.randomElement=pS.randomShuffled=pS.randomIndex=pS.randomFloat=void 0;var $3=pr();pS.randomFloat=$3.testUtil.randomFloat;pS.randomIndex=$3.testUtil.randomIndex;pS.randomShuffled=$3.testUtil.randomShuffled;pS.randomElement=$3.testUtil.randomElement});var VRe=T(eK=>{"use strict";p();Object.defineProperty(eK,"__esModule",{value:!0});eK.createArrayLogger=void 0;var cyr=pr();eK.createArrayLogger=cyr.arrayLogger.createArrayLogger});var sEe=T(yn=>{"use strict";p();Object.defineProperty(yn,"__esModule",{value:!0});yn.randomCellEvaluationTest=yn.randomTestSheetContents=yn.randomTestCellContents=yn.randomTestFormula=yn.runCellEvaluationTest=yn.runMockCellEvaluationTest=yn.makeRandomizedTimer=yn.abstractEvalCells=yn.sheet=yn.document=yn.makeDirtyCellContents=yn.makeFailedCellContents=yn.makeFinalCellContents=yn.TestCellState=yn.SpecialContents=yn.locationFormula=yn.locationValue=yn.parsed=yn.compiled=yn.makeTestContext=void 0;var yI=fe(),nv=fi(),dyr=Nm(),fyr=y1e(),jRe=aJ(),gc=Fm(),ZRe=qo(),DZ=ZU(),pyr=xU(),WRe=_1e(),myr=wZ(),Kl=fs(),mc=Na(),gyr=nJ(),$Re=vJ(),HRe=kF(),vyr=URe(),tv=xF(),aN=Ua(),SI=vf(),hyr=OU(),Syr=oc(),eEe=mJ(),yyr=H0(),_yr=c3(),bn=Dl(),av=KRe(),byr=gJ(),Cyr=VRe(),Tyr=n3(),Ryr=u3(),zRe=Ky();function Eyr(e,r,t){var n=(0,Cyr.createArrayLogger)();(0,vyr.initCalc)(n,e??fyr.featureEnabledDummyCallback),(0,zRe.overrideTypedFeatureGates)(zRe.getTypedFeatureGate,{"Microsoft.Office.Excel.CalcEtaLambda":!0,"Microsoft.Office.Excel.EtaReducedLambdas":!0});var a=(0,HRe.calcConfig)(r??(0,HRe.getEnglishLocaleInfo)(),void 0,t),o={config:a},u={config:a},s={config:a},l=(0,$Re.createParser)(o),c=(0,eEe.createAnalyzer)(s),d=(0,pyr.createCompiler)(u);return{logger:n,config:a,compileGlobals:u,parser:l,analyzer:c,compiler:d}}yn.makeTestContext=Eyr;function LZ(e,r,t,n,a){a===void 0&&(a=!1);var o=r.kind===Kl.LexicalKind.NameManager?(0,jRe.analyzeLocalsName)((0,Kl.sheetGridCell)(yn.sheet,t)):(0,jRe.analyzeLocalsGrid)(r.kind,(0,Kl.sheetGridCell)(yn.sheet,t)),u=e.analyzer.checkFormula(o,n);if((0,bn.isSuccess)(u)&&(0,mc.isWellFormed)(u.value)){var s=r.kind===Kl.LexicalKind.NameManager?(0,gc.compileLocalsName)(t):(0,gc.compileLocalsGrid)(r.kind,t),l=e.compiler.compileFormula(a?yI.__assign(yI.__assign({},s),{emitStepInfo:a}):s,u.value);if(l.kind===bn.ResultKind.Success)return l.value;throw new Error("unexpected result ".concat(JSON.stringify(l)))}throw new Error("not well formed formula ".concat(JSON.stringify(u)))}yn.compiled=LZ;function Pyr(e,r,t,n,a,o,u){n===void 0&&(n=tv.RefStyle.A1),a===void 0&&(a=r.kind!==Kl.LexicalKind.NameManager?(0,mc.gridRangeAnchor)(r.range.range):(0,nv.assertFalse)("must pass origin for LexicalSourceName")),o===void 0&&(o=!1);var s=e.parser.parseFormula((0,gyr.parseLocals)(r.kind,a,{refStyle:n},u),t);if(s.kind!==bn.ResultKind.Success)throw new Error("unexpected result ".concat(JSON.stringify(s)));return LZ(e,r,a,s.value,o)}yn.parsed=Pyr;function Ayr(e,r){return{cell:e,oper:r}}yn.locationValue=Ayr;function Fyr(e,r){var t=(0,tv.formula)(r,[],[],1);return{source:e,formula:t}}yn.locationFormula=Fyr;var uu;(function(e){e.ValueMocked="ValueMocked",e.ValueUnavailable="ValueUnavailable",e.FormulaUnavailable="FormulaUnavailable",e.EvalNotImplemented="EvalNotImplemented",e.EvalJavaScriptError="EvalJavaScriptError"})(uu||(yn.SpecialContents=uu={}));var vs;(function(e){e.Dirty="Dirty",e.Final="Final",e.Failed="Failed"})(vs||(yn.TestCellState=vs={}));var Nyr=function(){var e=(0,ZRe.bottomEvalPrecedents)();return e.bound=aN.PrecsBound.Exact,e}();function qZ(e,r,t){return{oper:e,reason:r,state:t,precedents:Nyr}}function rK(e){return qZ(e,void 0,vs.Final)}yn.makeFinalCellContents=rK;function Oyr(e,r){return qZ(e,r,vs.Failed)}yn.makeFailedCellContents=Oyr;function rEe(e){return qZ(e,void 0,vs.Dirty)}yn.makeDirtyCellContents=rEe;function AC(e){var r=e.row,t=e.col;return"R".concat(r+1,"C").concat(t+1)}function tEe(e,r){return typeof r=="number"?(0,tv.literalNode)(e.config.mathpack.fromNumber(r)):r===uu.EvalNotImplemented?(0,tv.appNode)((0,tv.wsfNode)(SI.WorksheetFuncId.RAND,"RAND"),[]):r===uu.EvalJavaScriptError?(0,tv.appNode)((0,tv.wsfNode)(SI.WorksheetFuncId.NOW,"NOW"),[]):Array.isArray(r)?(0,tv.appNode)((0,tv.wsfNode)(SI.WorksheetFuncId.SUM,"SUM"),r.map(tEe.bind(void 0,e))):(0,tv.cellRefNode)((0,tv.cellRefSingle)((0,WRe.absPos)(r.row),(0,WRe.absPos)(r.col)))}yn.document={path:void 0,name:"Book1"};yn.sheet=(0,Kl.sheetIndex)(yn.document,0);function kyr(e,r){var t={},n={};function a(V){var I=t[V];return I==null&&(I=rK(aN.blankOper),t[V]=I),I}for(var o in r){var u=r[o];if(u!=null){var s=u[0],l=u[1];if(typeof l=="number"){var c=a(o);c.oper=e.config.mathpack.fromNumber(l)}else if(Array.isArray(l)||l===uu.EvalNotImplemented||l===uu.EvalJavaScriptError){var c=a(o);c.state=vs.Dirty;var d=(0,tv.formula)(tEe(e,l),[],[],2);n[o]=LZ(e,(0,Kl.lexicalSourceCell)((0,Kl.sheetGridCell)(yn.sheet,s)),s,d)}else if(l===uu.ValueMocked||l===uu.FormulaUnavailable){var c=a(o);c.state=vs.Dirty}else l===uu.ValueUnavailable||(0,nv.assertNever)("calc.runtime.makeCellEvaluationTest, tc",l)}}function f(V,I){return(0,ZRe.throwEvaluationError)((0,mc.notImplemented)(["RAND"]))}function m(V,I){throw new Error("JavaScript error")}function v(V){if(V===SI.WorksheetFuncId.SUM){var I=(0,myr.getWorksheetFunc)(V);return I!=null?(0,bn.success)(I):(0,bn.failure)((0,mc.notImplemented)(["SUM"]))}return(0,bn.success)(V===SI.WorksheetFuncId.RAND?f:m)}function h(V){var I=AC(V.range),M=r[I];if(M!=null&&M[1]===uu.ValueUnavailable)return(0,bn.failure)((0,mc.unavailable)(["value at ".concat(I)]));var B=t[I];return B==null?(0,bn.success)((0,gc.finalValue)(aN.blankOper)):B.state===vs.Final?(0,bn.success)((0,gc.finalValue)(B.oper)):B.state===vs.Failed?(0,bn.failure)((0,gc.previousFailure)(V)):(0,bn.success)((0,gc.pendingValue)(V))}function y(V){var I=V.sheet,M=V.range,B=M.row,U=M.col,j=M.rows,X=M.cols,ee=void 0,re=(0,dyr.jaggedArray)(j,X,function(Z,J){var C=q.getCellValue((0,Kl.sheetGridCell)(I,(0,Kl.gridCell)(Z+B,J+U)));return C.kind===bn.ResultKind.Failure?(ee==null&&(ee=C),(0,gc.finalValue)(aN.blankOper)):C.value});return ee??(0,bn.success)(re)}function _(V){var I=AC(V.range),M=r[I];if(M!=null&&M[1]===uu.FormulaUnavailable)return(0,bn.failure)((0,mc.unavailable)(["formula at ".concat(I)]));var B=n[I];return B!=null?(0,bn.success)((0,gc.cellFormula)((0,Kl.lexicalSourceCell)(V),B)):(0,bn.success)(void 0)}function E(V,I){var M=AC(V.range),B=t[M];if(B==null||B.state!==vs.Dirty){var U="expected dirty cell at ".concat(JSON.stringify(V)," but have ").concat(JSON.stringify(B),"; given ").concat(JSON.stringify(I));(0,nv.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellValue: ".concat(U))}B.oper=I,B.state=vs.Final}function N(V,I){if(!(0,mc.isSheetGridCell)(V)){var M="expected cell; given range ".concat(JSON.stringify(V));return(0,nv.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellFailure: ".concat(M))}var B=AC(V.range),U=t[B];if(U==null||U.state!==vs.Dirty){var M="expected dirty cell at ".concat(JSON.stringify(V)," but have ").concat(JSON.stringify(U),"; given ").concat(JSON.stringify(I));(0,nv.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellFailure: ".concat(M))}U.reason=I.kind,U.state=vs.Failed}function k(V){return(0,bn.success)((0,Kl.sheetGridRange)(V,(0,Kl.gridRange)(0,0,Kl.sheetRows,Kl.sheetCols)))}var q={config:e.config,getDocumentLoc:function(I,M){return(0,bn.success)(yn.document)},getSheetIndex:function(I,M){return(0,bn.success)(yn.sheet.index)},getSheetName:function(I,M){return(0,bn.success)("Sheet1")},getSheetRangeIndexes:function(I){return(0,bn.success)((0,Kl.sheetRangeIndexes)([yn.sheet.index],0))},getNameLoc:function(I,M){return(0,bn.failure)((0,mc.unavailable)(["name at ".concat(JSON.stringify((0,Kl.nameLoc)(I,M)))]))},getUserDefinedFuncLoc:function(I,M){return(0,bn.success)([])},getCellValue:h,getCellValues:y,getWorksheetFunc:v,getUserDefinedFunc:function(){return(0,bn.failure)((0,mc.unavailable)(["getUserDefinedFunc"]))},getNameFormula:function(I){return(0,bn.failure)((0,mc.unavailable)(["name at ".concat(JSON.stringify(I))]))},getCellFormula:_,interruptToken:[gc.Interrupt.Continue],tryGetHiddenRows:function(I,M,B){return(0,bn.success)([])},tryGetHiddenCols:function(I,M,B){return(0,bn.success)([])},isInFilterMode:function(I){return(0,bn.success)(!1)},getKnownFormat:function(){return(0,bn.failure)((0,mc.notImplemented)(["getKnownFormat"]))},getIformat:function(){return(0,bn.failure)((0,mc.notImplemented)(["getIformat"]))},getFormatString:function(){return(0,bn.failure)((0,mc.notImplemented)(["getFormatString"]))},getRandom:function(){return(0,bn.failure)((0,mc.notImplemented)(["getRandom"]))},getTime:function(){return(0,bn.failure)((0,mc.notImplemented)(["getTime"]))},schedulerConfig:{},limits:{},setCellValue:E,setCellValues:function(I,M){throw new Error("unexpected call to setCellValues")},setCellFailure:N,getUsedRange:k,getContainingTable:function(){return(0,bn.failure)((0,mc.notImplemented)(["getContainingTable"]))},getIntersectingTables:function(){return(0,bn.failure)((0,mc.notImplemented)(["getIntersectingTables"]))},getStructRefColumn:function(){return(0,bn.failure)((0,mc.notImplemented)(["getStructRefColumn"]))},getStructRefSpecialRef:function(){return(0,bn.failure)((0,mc.notImplemented)(["getStructRefSpecialRef"]))}};return[yn.sheet,t,q]}function nEe(e,r,t){var n={};for(var a in r){var o=r[a];if(o!=null){var u=o[1];if(typeof u=="number"){var s=rK(e.config.mathpack.fromNumber(u));n[a]=s}else if(Array.isArray(u)||u===uu.FormulaUnavailable||u===uu.EvalNotImplemented||u===uu.EvalJavaScriptError){var s=rEe(aN.blankOper);n[a]=s}else u===uu.ValueUnavailable||u===uu.ValueMocked||(0,nv.assertNever)("calc.runtime.abstractEvalCells, tc",u)}}function l(y,_){if(y.state!==vs.Dirty){var E="expected dirty cellContent; given ".concat(JSON.stringify(y));(0,nv.assertFalse)("calc.runtime.makeCellEvaluationTest.setContentFailed: ".concat(E))}y.reason=_,y.state=vs.Failed}function c(y,_){if(y.state!==vs.Dirty){var E="expected dirty cellContent; given ".concat(JSON.stringify(y));(0,nv.assertFalse)("calc.runtime.makeCellEvaluationTest.setContentFinal: ".concat(E))}y.oper=_,y.state=vs.Final}var d={},f=[];function m(y,_){if(typeof _=="number")return(0,bn.success)(e.config.mathpack.fromNumber(_));if(_===uu.EvalNotImplemented)return(0,bn.failure)({kind:gc.ReasonKind.NotImplemented});if(_===uu.EvalJavaScriptError)return(0,bn.failure)({kind:gc.ReasonKind.JavaScriptError});for(var E=[],N=0;N<_.length;N+=1){var k=_[N];if(typeof k!="object"||Array.isArray(k)){var q=m(y,k);if(!(0,bn.isSuccess)(q))return q;E.push(e.config.mathpack.toNumber(q.value));continue}E.push(k)}for(var V=function(re){var Z=E[re];if(typeof Z=="number")return"continue";var J=AC(Z),C=r[J];if(C!=null&&C[1]===uu.ValueUnavailable)return{value:(0,bn.failure)({kind:gc.ReasonKind.Unavailable})};var S=n[J];if(S!=null&&S.state===vs.Failed)return{value:(0,bn.failure)({kind:gc.ReasonKind.PreviousFailure})};var b=d[J];if(b!==void 0){for(var O=f.findIndex(function(w){return w===b});O!==-1&&O<f.length;O+=1)f[O].cycle=!0;return{value:(0,bn.failure)({kind:gc.ReasonKind.CellCycle})}}},N=0;N<E.length;N+=1){var I=V(N);if(typeof I=="object")return I.value}for(var M=0,N=0;N<E.length;N+=1){var B=E[N];if(typeof B=="number"){M+=B;continue}var U=v(B);if(U!==void 0)return(0,bn.failure)({kind:U});var j=AC(B),X=n[j];if(X!=null){if(X.state===vs.Failed)return(0,bn.failure)({kind:y.cycle?gc.ReasonKind.CellCycle:gc.ReasonKind.PreviousFailure});(0,nv.assertTrue)("calc.runtime.testUtil: Final after abstractEvalCell",X.state===vs.Final),M+=e.config.mathpack.toNumber(X.oper)}}return(0,bn.success)(e.config.mathpack.fromNumber(M))}function v(y){var _=AC(y),E=r[_];if(E!=null){var N=E[1];if(!(typeof N=="number"||N===uu.ValueUnavailable)){var k=n[_];if(k==null&&(k=rK(aN.blankOper),n[_]=k),k.state===vs.Failed){(0,nv.assertTrue)("calc.runtime.makeCellEvaluationTest",k.reason!=null);return}if(k.state!==vs.Final){var q={cycle:!1};(0,nv.assertTrue)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: undetected cycle",d[_]==null),d[_]=q,f.push(q);try{switch(N){case uu.ValueMocked:return(0,nv.assertFalse)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: unexpected ValueMocked");case uu.FormulaUnavailable:throw new Error("calc.runtime.makeCellEvaluationTest.abstractEvalCell: dummy Failure from getCellFormula")}var V=m(q,N);if((0,bn.isSuccess)(V)){c(k,V.value);return}l(k,V.reason.kind);return}catch(I){return gc.ReasonKind.JavaScriptError}finally{delete d[_],f.pop()}}}}}var h=t.map(function(y){try{return v(y)}catch(_){return gc.ReasonKind.JavaScriptError}});return{evalResults:h,sheetState:n}}yn.abstractEvalCells=nEe;function QRe(e){return typeof e=="string"?gc.ReasonKind.PreviousFailure:e}function XRe(e){return e==null?e:yI.__assign(yI.__assign({},e),{reason:void 0})}function YRe(e,r){for(var t in e){var n=e[t];n!=null&&n.state===vs.Dirty&&(delete e[t],delete r[t])}}function Myr(e,r){YRe(e,r),YRe(r,e)}function JRe(e,r){var t={};for(var n in e)t[n]=r(e[n]);return t}function aEe(e){for(var r=[],t=0;t<e;t+=1)r.push(t);return r}function xyr(e){return e===void 0&&(e=.5),{doTimeout:function(t){var n=(0,av.randomFloat)();return n>e}}}yn.makeRandomizedTimer=xyr;function Iyr(e,r){return r==null?r:typeof r.row=="number"&&typeof r.col=="number"&&r.rows===1&&r.cols===1?"gridCell(".concat(r.row,", ").concat(r.col,")"):r.kind===128&&Object.getOwnPropertyNames(r).length===1?"blankOper":r}function iEe(e,r,t,n,a,o,u,s){s===void 0&&(s={});var l=kyr(e,n),c=l[0],d=l[1],f=l[2];for(var m in s){var v=m;f[v]=s[v](f[v])}for(var h=[n,a,o,u],y=a.map(function(B){return(0,Kl.sheetGridCell)(c,B)}),_=u??aEe(a.length),E=[],N=0;N<_.length;N+=1)E[_[N]]=N;for(var k={globals:f,resolver:(0,hyr.createResolver)(f),numberFormatter:(0,_yr.createNumberFormatter)(f),parser:(0,$Re.createParser)(f),printer:(0,byr.createPrinter)(f),analyzer:(0,eEe.createAnalyzer)(f),createCellEvaluationMachine:r.createCellEvaluationMachine.bind(r),createFormulaEvaluationMachine:r.createFormulaEvaluationMachine.bind(r),createCallTermEvaluationMachine:r.createCallTermEvaluationMachine.bind(r)},q={globals:f,timer:t,machineContext:k},V=[],N=0;N<_.length;N+=1){var I=y[_[N]];V.push(new Syr.VoidMachine(k.createCellEvaluationMachine(k,void 0,yyr.emptyVisitedCells,I)))}var M=new DZ.EvaluationRuntime(q,V);return M.evaluateAsync((0,DZ.createSchedule)(q.globals.schedulerConfig)).then(function(B){return E.map(function(U){var j=B[U];return j.kind===bn.ResultKind.Success?j.value:j.reason.kind})}).catch(function(B){return B.reason!=null?B.reason.stack:B.stack}).then(function(B){if(Array.isArray(B)){var U=B,j=d,X=o.evalResults,ee=o.sheetState;u!=null&&(U=U.map(QRe),X=X.map(QRe),j=JRe(j,XRe),ee=JRe(ee,XRe),Myr(j,ee));try{expect([h,U,j]).toEqual([h,X,ee])}catch(re){throw console.warn("runMockCellEvaluationTest: test failure:",JSON.stringify({testData:h,testResults:U,testState:j},Iyr,2)),re}}else expect([h,B]).toEqual([h,void 0])})}yn.runMockCellEvaluationTest=iEe;function wyr(e,r,t,n,a,o){o===void 0&&(o={});var u={createCellEvaluationMachine:Tyr.createCellEvaluationMachine,createFormulaEvaluationMachine:Ryr.createFormulaEvaluationMachine,createCallTermEvaluationMachine:function(c){}},s=(0,DZ.runtimeTimer)();return iEe(e,u,s,r,t,n,a,o)}yn.runCellEvaluationTest=wyr;var Dyr=3;function GZ(e,r,t){t===void 0&&(t=0);var n=(0,av.randomFloat)()*(t<Dyr?1:.625);return n<.05?uu.EvalJavaScriptError:n<.1?uu.EvalNotImplemented:n<.55?1:yI.__spreadArray([],new Array((0,av.randomIndex)(3)+1),!0).map(function(){return(0,av.randomFloat)()<.5?(0,Kl.gridCell)((0,av.randomIndex)(e),(0,av.randomIndex)(r)):GZ(e,r,t+1)})}yn.randomTestFormula=GZ;function oEe(e,r){for(;;){var t=(0,av.randomFloat)();return t<.1?uu.ValueUnavailable:t<.2?uu.FormulaUnavailable:GZ(e,r)}}yn.randomTestCellContents=oEe;function uEe(e,r){for(var t={},n=0;n<e;n+=1)for(var a=0;a<r;a+=1)if((0,av.randomFloat)()<.5){var o=oEe(e,r),u=(0,Kl.gridCell)(n,a);t[AC(u)]=[u,o]}return t}yn.randomTestSheetContents=uEe;function Lyr(e,r,t){var n=uEe(r,t),a=[];for(var o in n){var u=n[o];u!=null&&(0,av.randomFloat)()<.75&&a.push(u[0])}a=(0,av.randomShuffled)(a);var s=nEe(e,n,a),l=(0,av.randomFloat)()<.5?(0,av.randomShuffled)(aEe(a.length)):void 0;return[n,a,s,l]}yn.randomCellEvaluationTest=Lyr});var fEe=T(tK=>{"use strict";p();Object.defineProperty(tK,"__esModule",{value:!0});tK.FuncContextMock=void 0;var qyr=c3(),lEe=qo(),cEe=NF(),dEe=Dl(),Gyr=function(){function e(r){this.config=r,this.formatter=(0,qyr.createNumberFormatter)({config:this.config}),this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"calcingArray",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),e.prototype.applyFunction=function(r,t){throw new Error("Method not implemented.")},e.prototype.applyLambda=function(r,t){throw new Error("Method not implemented.")},e.prototype.handleEvaluationError=function(r){throw new Error("Method not implemented.")},e.prototype.coerceOper=function(r,t){throw new Error("Method not implemented.")},e.prototype.parseGeneral=function(r,t){var n,a=this.formatter.parseGeneral(r,!1,t,cEe.GetTimeKind.NonVolatile);return(0,dEe.isSuccess)(a)||(0,lEe.throwEvaluationError)(a.reason),(n=a.value)===null||n===void 0?void 0:n.value},e.prototype.parseDate=function(r){var t,n=this.formatter.parseDate(r,cEe.GetTimeKind.NonVolatile);return(0,dEe.isSuccess)(n)||(0,lEe.throwEvaluationError)(n.reason),(t=n.value)===null||t===void 0?void 0:t.value},e.prototype.getCellFormula=function(r){throw new Error("Method not implemented.")},e.prototype.getSheetIndex=function(r,t){throw new Error("Method not implemented.")},e.prototype.getSheetRangePosition=function(r){throw new Error("Method not implemented.")},e.prototype.getSheetRangeIndexes=function(r){throw new Error("Method not implemented.")},e.prototype.getNameFormula=function(r,t){throw new Error("Method not implemented.")},e.prototype.getCellRef=function(r,t,n,a){throw new Error("Method not implemented.")},e.prototype.getStructRef=function(r,t,n){throw new Error("Method not implemented.")},e.prototype.dereferenceAllOpers=function(){throw new Error("Method not implemented.")},e.prototype.dereferenceAllOpersAndFormulae=function(){throw new Error("Method not implemented.")},e.prototype.dereferenceOper=function(r,t){throw new Error("Method not implemented.")},e.prototype.dereferenceOpers=function(r,t){throw new Error("Method not implemented.")},e.prototype.isInFilterMode=function(){throw new Error("Method not implemented.")},e.prototype.printFormula=function(r,t){throw new Error("Method not implemented.")},e.prototype.getBinaryOperator=function(r){throw new Error("Method not implemented.")},e.prototype.getUnaryOperator=function(r){throw new Error("Method not implemented.")},e.prototype.parseFormula=function(r,t,n,a){throw new Error("Method not implemented.")},e.prototype.applyFormat=function(r,t,n){throw new Error("Method not implemented.")},e.prototype.getRandom=function(){throw new Error("Method not implemented.")},e.prototype.getTime=function(r){throw new Error("Method not implemented.")},e}();tK.FuncContextMock=Gyr});var nK=T(FC=>{"use strict";p();Object.defineProperty(FC,"__esModule",{value:!0});FC.getAbsoluteIndexNoClamp=FC.getAbsoluteIndex=FC.ni=void 0;var Byr=Na(),Uyr=qo(),Kyr=function(r){throw new Uyr.EvaluationError((0,Byr.notImplemented)([r]))};FC.ni=Kyr;function Vyr(e,r){return r>=0?r:Math.max(e+r,0)}FC.getAbsoluteIndex=Vyr;function jyr(e,r){return r>=0?r:e+r}FC.getAbsoluteIndexNoClamp=jyr});var SEe=T(Vl=>{"use strict";p();Object.defineProperty(Vl,"__esModule",{value:!0});Vl.hstack=Vl.vstack=Vl.filter=Vl.map=Vl.drop=Vl.take=Vl.rangeOrArrayToVal=Vl.choosecols=Vl.sequence=void 0;var gEe=au(),Ni=Na(),Wyr=Ua(),Ad=Ua(),e_=oc(),Hyr=Wy(),Dm=nK(),_I=Il(),zyr=fi(),BZ=fs(),Qyr=xm(),Xyr=function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3],s=r.mathpack,l=(0,Ni.isMissingOper)(n)?1:s.sfix(n),c=a===void 0||(0,Ni.isMissingOper)(a)?1:s.sfix(a);if(l<0||l>BZ.sheetRows||c<0||c>BZ.sheetRows)return Ad.valueErrorOper;if((0,Qyr.validateArraySize)(l,c),l===0||c===0)return Ad.calcErrorOper;for(var d=o===void 0||(0,Ni.isMissingOper)(o)?s.fromNumber(1):o,f=u===void 0||(0,Ni.isMissingOper)(u)?s.fromNumber(1):u,m=d,v=[],h=0;h<l;h++){for(var y=[],_=0;_<c;_++)if(y.push(m),!(0,Ni.isErrorOper)(m)){var E=s.add(m,f);m=(0,Ni.isErrorOper)(E)?E:s.checkAlmostCancellation(f,E)}v.push(y)}return(0,Ad.arrayOper)(l,c,v)};Vl.sequence=Xyr;function Yyr(e,r){var t=[];return r.opers.forEach(function(n){n.forEach(function(a){(0,Ni.isNumberOper)(a)&&t.push(e.toNumber(a))})}),t}var Jyr=function(r,t){var n=t[0],a=t.slice(1),o=r.mathpack,u=(0,e_.refToVal)(r,n,!1);if(!(0,Ni.isArrayOper)(u))return u;var s=u.opers.map(function(l){var c=l.length,d=[];return a.forEach(function(f){(0,Ni.isNumberOper)(f)?d.push(l[(0,Dm.getAbsoluteIndex)(c,o.toNumber(f))]):Yyr(o,f).forEach(function(m){d.push(l[(0,Dm.getAbsoluteIndex)(c,m)])})}),d});return s.length===0||s[0].length===0?Ad.calcErrorOper:(0,Ad.arrayOper)(s.length,s[0].length,s)};Vl.choosecols=Jyr;var vEe=function(){function e(r){this.oper=r;var t=r.ranges[0],n=t.rows,a=t.cols;this.rows=n,this.cols=a}return e.prototype.slice=function(r,t,n,a){var o=this.oper.ranges[0],u=o.row,s=o.col;return(0,Wyr.range3DOper)(this.oper.sheets,(0,BZ.gridRange)(u+r,s+n,t,a))},e}(),hEe=function(){function e(r){this.oper=r,this.rows=r.opers.length,this.cols=r.opers[0].length}return e.prototype.slice=function(r,t,n,a){return(0,Ad.arrayOper)(t,a,this.oper.opers.slice(r,r+t).map(function(o){return o.slice(n,n+a)}))},e}();function UZ(e){return(0,Ni.isRangeOper)(e)?e.ranges.length>1?Ad.valueErrorOper:((0,zyr.assertTrue)("calc.funcs.rangeOrArrayToVal: not 3D ref",(0,Ni.isSheetIndex)(e.sheets)),e):e}Vl.rangeOrArrayToVal=UZ;function pEe(e,r){if((0,_I.fastAbs)(e)<r){var t=(0,_I.fastAbs)(e);return e<0?{start:r-t,count:t}:{start:0,count:t}}return{start:0,count:r}}function mEe(e,r){if((0,_I.fastAbs)(e)<r){var t=r-(0,_I.fastAbs)(e);return e<0?{start:0,count:t}:{start:e,count:t}}return{start:0,count:0}}var Zyr=function(r,t){var n=t[0],a=t[1],o=t[2],u=r.mathpack,s=UZ(n);if(!(0,Ni.isArrayOper)(s)&&!(0,Ni.isRangeOper)(s))return s;var l=(0,Ni.isRangeOper)(s)?new vEe(s):new hEe(s),c=(0,Ni.isMissingOper)(a)?l.rows:u.lfix(a),d=o===void 0||(0,Ni.isMissingOper)(o)?l.cols:u.lfix(o),f=pEe(c,l.rows),m=f.start,v=f.count,h=pEe(d,l.cols),y=h.start,_=h.count;return v===0||_===0?Ad.calcErrorOper:l.slice(m,v,y,_)};Vl.take=Zyr;var $yr=function(r,t){var n=t[0],a=t[1],o=t[2],u=r.mathpack,s=UZ(n);if(!(0,Ni.isArrayOper)(s)&&!(0,Ni.isRangeOper)(s))return s;var l=(0,Ni.isRangeOper)(s)?new vEe(s):new hEe(s),c=(0,Ni.isMissingOper)(a)?0:u.lfix(a),d=o===void 0||(0,Ni.isMissingOper)(o)?0:u.lfix(o),f=mEe(c,l.rows),m=f.start,v=f.count,h=mEe(d,l.cols),y=h.start,_=h.count;return v===0||_===0?Ad.calcErrorOper:l.slice(m,v,y,_)};Vl.drop=$yr;var e_r=function(r,t){var n=(0,e_.refToVal)(r,t[t.length-1],!0),a=t.slice(0,t.length-1).map(function(l){return(0,e_.refToVal)(r,l,!1)});if(!a.every(Ni.isArrayOper))return(0,Dm.ni)("MAP: Non array input");if(!(n instanceof Hyr.LambdaOper)||a.length===0)return(0,Dm.ni)("MAP: No lambda or array");var o=a[0],u=o.rows,s=o.cols;return a.every(function(l){return l.rows===u&&l.cols===s})?(0,e_.machineCall)(new e_.ArrayMachine(r,u,s,function(l,c){return r.applyLambda(n,a.map(function(d){return d.opers[l][c]}))},function(l){return(0,Ni.isRangeOper)(l)?(0,Dm.ni)("MAP: nested range"):(0,Ni.isArrayOper)(l)?(0,Dm.ni)("MAP: nested array"):(0,Ni.isMissingOper)(l)?(0,Dm.ni)("MAP: nested missing"):l})):(0,Dm.ni)("MAP: Bad dimensions")};Vl.map=e_r;function r_r(e,r,t,n){for(var a=[],o=0;o<t.length;o++){var u=t[o],s=e.coerceOper(u,gEe.OperKind.Boolean);if(!(0,Ni.isBooleanOper)(s))return u;s.value&&a.push(r[o])}return a.length===0?n:(0,Ad.arrayOper)(a.length,a[0].length,a)}function t_r(e,r,t,n){for(var a=[],o=0,u=0;u<t.length;u++){var s=t[u],l=e.coerceOper(s,gEe.OperKind.Boolean);if(!(0,Ni.isBooleanOper)(l))return s;var c=l.value;c&&(a.push(c),o++)}return o===0?n:(0,Ad.arrayOper)(r.length,o,r.map(function(d){return d.filter(function(f,m){var v;return(v=a[m])!==null&&v!==void 0?v:!0})}))}var n_r=function(r,t){var n=t[0],a=t[1],o=t[2],u=(0,e_.refToVal)(r,n,!1),s=(0,e_.refToVal)(r,a,!1),l=o===void 0||(0,Ni.isMissingOper)(o)?Ad.calcErrorOper:o;return!(0,Ni.isArrayOper)(u)||!(0,Ni.isArrayOper)(s)?(0,Dm.ni)("FILTER: non-array input"):s.rows===1&&s.cols===u.cols?t_r(r,u.opers,s.opers[0],l):s.cols===1&&s.cols===u.cols?r_r(r,u.opers,s.opers.map(function(c){return c[0]}),l):Ad.valueErrorOper};Vl.filter=n_r;var a_r=function(r,t){var n=t.map(function(y){return(0,e_.refToVal)(r,y,!1)});if(!n.every(Ni.isArrayOper))return(0,Dm.ni)("VSTACK: non array input");for(var a=0,o=0,u=n;o<u.length;o++){var s=u[o];s.cols>a&&(a=s.cols)}if(a<1)return(0,Dm.ni)("VSTACK: Empty array");for(var l=[],c=0,d=n;c<d.length;c++)for(var s=d[c],f=0,m=s.opers;f<m.length;f++){for(var v=m[f],h=v.slice();h.length<a;)h.push(Ad.naErrorOper);l.push(h)}return(0,Ad.arrayOper)(l.length,a,l)};Vl.vstack=a_r;var i_r=function(r,t){var n,a,o=t.map(function(v){return(0,e_.refToVal)(r,v,!1)});if(!o.every(Ni.isArrayOper))return(0,Dm.ni)("HSTACK: non array input");for(var u=0,s=0,l=o;s<l.length;s++){var c=l[s];c.rows>u&&(u=c.rows)}if(u<1)return(0,Dm.ni)("HSTACK: Empty array");for(var d=[],f=function(h){var y=[];o.forEach(function(_){return(0,_I.safePush)(y,h<_.rows?_.opers[h]:Array(_.cols).fill(Ad.naErrorOper))}),d.push(y)},m=0;m<u;m++)f(m);return(0,Ad.arrayOper)(u,(a=(n=d[0])===null||n===void 0?void 0:n.length)!==null&&a!==void 0?a:0,d)};Vl.hstack=i_r});var bEe=T(iN=>{"use strict";p();Object.defineProperty(iN,"__esModule",{value:!0});iN.xlookup=iN.xmatch=void 0;var yEe=vf(),bI=Na(),_Ee=Ua(),o_r=oc(),u_r=U3(),CI=nK(),s_r=function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3];if(o!==void 0&&!(0,bI.isMissingOper)(o)||u!==void 0&&!(0,bI.isMissingOper)(u))return(0,CI.ni)("XMATCH: unsupported optional args");if((0,bI.isRichOper)(n))return(0,CI.ni)("XMATCH: unsupported rich lookup");var s=(0,o_r.refToVal)(r,a,!1),l=(0,u_r.makeLookupComparer)(r,n);if(!(0,bI.isArrayOper)(s)){if((0,bI.isRangeOper)(s))return(0,CI.ni)("XMATCH: range oper");var c=l(s);return c.sgnT===yEe.OperatorId.Eq?r.mathpack.fromNumber(1):_Ee.naErrorOper}var d;if(s.rows===1)d=s.opers[0];else if(s.cols===1)d=s.opers.map(function(m){return m[0]});else return(0,CI.ni)("XMATCH: non-vector");for(var f=0;f<d.length;f++)if(l(d[f]).sgnT===yEe.OperatorId.Eq)return r.mathpack.fromNumber(f+1);return _Ee.naErrorOper};iN.xmatch=s_r;var l_r=function(r,t){return(0,CI.ni)("XLOOKUP: Not implemented")};iN.xlookup=l_r});var TEe=T(NC=>{"use strict";p();Object.defineProperty(NC,"__esModule",{value:!0});NC.textAfter=NC.textBefore=NC.textSplit=void 0;var c_r=fi(),Lm=Na(),iv=Ua(),oN=nK();function KZ(e){var r=[];if((0,Lm.isArrayOper)(e))for(var t=e.rows,n=e.cols,a=e.opers,o=0;o<t;o++)for(var u=0;u<n;u++){var s=a[o][u];if(!(0,Lm.isStringOper)(s))return(0,oN.ni)("TEXTSPLIT array with non-text element");r.push(s.value)}else r.push(e.value);return r}var d_r=function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3],s=t[4],l=t[5],c=n.value;if((0,Lm.isMissingOper)(a)||o!==void 0&&!(0,Lm.isMissingOper)(o)||s!==void 0&&!(0,Lm.isMissingOper)(s)||l!==void 0&&!(0,Lm.isMissingOper)(l))return(0,oN.ni)("TEXTSPLIT unsupported arguments");var d=KZ(a);if(d.some(function(k){return k===""}))return iv.valueErrorOper;for(var f=u===void 0||(0,Lm.isMissingOper)(u)?!1:u.value,m=[],v=0,h=c;v<h.length;){for(var y=h.length-v,_=!1,E=0;E<d.length;E++){var N=d[E];h.startsWith(N,v)&&(m.push(h.slice(0,v)),h=h.slice(v+N.length),v=0,_=!0)}_?(0,c_r.assertTrue)("calc.funcs.textsplit: Loop invariant",h.length-v<y):v++}return m.push(h),f&&(m=m.filter(function(k){return k.length!==0})),m.length===0?iv.calcErrorOper:(0,iv.arrayOper)(1,m.length,[m.map(iv.stringOper)])};NC.textSplit=d_r;function CEe(e,r){for(var t=[],n=[],a=0;a<e.length;){for(var o=!1,u=0;u<r.length;u++){var s=r[u];s.length>0&&e.startsWith(s,a)&&(t.push(a),n.push(s.length),a+=s.length,o=!0)}o||a++}return{matchStart:t,matchLength:n}}var f_r=function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3],s=t[4],l=t[5];if(u!==void 0&&!(0,Lm.isMissingOper)(u)||s!==void 0&&!(0,Lm.isMissingOper)(s))return(0,oN.ni)("TEXTBEFORE unsupported arguments");var c=n.value,d=KZ(a),f=o===void 0||(0,Lm.isMissingOper)(o)?1:Math.floor(r.mathpack.toNumber(o)),m=l??iv.naErrorOper,v=Math.abs(f);if(f===0||v>c.length||d.every(function(E){return c.length-E.length+1<v}))return iv.valueErrorOper;if(d.some(function(E){return E.length===0}))return(0,iv.stringOper)(f<0?c:"");var h=CEe(c,d).matchStart,y=(0,oN.getAbsoluteIndexNoClamp)(h.length,f<0?f:f-1),_=h[y];return _===void 0?m:(0,iv.stringOper)(c.slice(0,_))};NC.textBefore=f_r;var p_r=function(r,t){var n=t[0],a=t[1],o=t[2],u=t[3],s=t[4],l=t[5];if(u!==void 0&&!(0,Lm.isMissingOper)(u)||s!==void 0&&!(0,Lm.isMissingOper)(s))return(0,oN.ni)("TEXTAFTER unsupported arguments");var c=n.value,d=KZ(a),f=o===void 0||(0,Lm.isMissingOper)(o)?1:Math.floor(r.mathpack.toNumber(o)),m=l??iv.naErrorOper,v=Math.abs(f);if(f===0||v>c.length||d.every(function(k){return c.length-k.length+1<v}))return iv.valueErrorOper;if(d.some(function(k){return k.length===0}))return(0,iv.stringOper)(f<0?"":c);var h=CEe(c,d),y=h.matchStart,_=h.matchLength,E=(0,oN.getAbsoluteIndexNoClamp)(y.length,f<0?f:f-1),N=y[E];return N===void 0?m:(0,iv.stringOper)(c.slice(N+_[E]))};NC.textAfter=p_r});var EEe=T(aK=>{"use strict";p();var sp;Object.defineProperty(aK,"__esModule",{value:!0});aK.nextFuncs=void 0;var qm=vf(),OC=SEe(),REe=bEe(),VZ=TEe(),m_r=(sp={},sp[qm.WorksheetFuncId.TEXTBEFORE]=VZ.textBefore,sp[qm.WorksheetFuncId.TEXTAFTER]=VZ.textAfter,sp[qm.WorksheetFuncId.TEXTSPLIT]=VZ.textSplit,sp[qm.WorksheetFuncId.XMATCH]=REe.xmatch,sp[qm.WorksheetFuncId.XLOOKUP]=REe.xlookup,sp[qm.WorksheetFuncId.TAKE]=OC.take,sp[qm.WorksheetFuncId.DROP]=OC.drop,sp[qm.WorksheetFuncId.CHOOSECOLS]=OC.choosecols,sp[qm.WorksheetFuncId.SEQUENCE]=OC.sequence,sp[qm.WorksheetFuncId.MAP]=OC.map,sp[qm.WorksheetFuncId.FILTER]=OC.filter,sp[qm.WorksheetFuncId.VSTACK]=OC.vstack,sp[qm.WorksheetFuncId.HSTACK]=OC.hstack,sp);aK.nextFuncs={v1:m_r}});var ov=T(yr=>{"use strict";p();Object.defineProperty(yr,"__esModule",{value:!0});yr.nextFuncs=yr.wildcard=yr.webFuncs=yr.volatileFuncs=yr.funcsUtil=yr.funcsTestUtils=yr.stringFuncs=yr.referenceFuncs=yr.reduce=yr.recordFuncs=yr.rangeFuncs=yr.predicateFuncs=yr.numfmtFuncs=yr.mathFuncs=yr.lookupFuncs=yr.logicalFuncs=yr.lambdaFuncs=yr.informationFuncs=yr.getWorksheetFuncModule=yr.engineeringFuncs=yr.dateTimeFuncs=yr.criteria=yr.aggregationFuncs=yr.visitedMap=yr.value=yr.util=yr.testUtils=yr.term=yr.serviceTypes=yr.rtree=yr.machine=yr.extensionTypes=yr.evaluatorService=yr.evalTypes=yr.evalFormula=yr.evalCell=yr.evalRuntime=yr.evalFunction=yr.operatorsModule=yr.dereferenceModule=yr.compilerService=yr.coerce=yr.calcChain=yr.PackageName=void 0;var Yn=fe();yr.PackageName="excel-online-calc-runtime";yr.calcChain=Yn.__importStar(eCe());yr.coerce=Yn.__importStar(EU());yr.compilerService=Yn.__importStar(xU());yr.dereferenceModule=Yn.__importStar(GU());yr.operatorsModule=Yn.__importStar(VU());yr.evalFunction=Yn.__importStar(cJ());yr.evalRuntime=Yn.__importStar(ZU());yr.evalCell=Yn.__importStar(n3());yr.evalFormula=Yn.__importStar(u3());yr.evalTypes=Yn.__importStar(qo());yr.evaluatorService=Yn.__importStar(S1e());yr.extensionTypes=Yn.__importStar(dC());yr.machine=Yn.__importStar(oc());yr.rtree=Yn.__importStar(qY());yr.serviceTypes=Yn.__importStar(Fm());yr.term=Yn.__importStar(Q0());yr.testUtils=Yn.__importStar(sEe());yr.util=Yn.__importStar(uc());yr.value=Yn.__importStar(Wy());yr.visitedMap=Yn.__importStar(H0());yr.aggregationFuncs=Yn.__importStar(qJ());yr.criteria=Yn.__importStar(PJ());yr.dateTimeFuncs=Yn.__importStar(zJ());yr.engineeringFuncs=Yn.__importStar(XJ());yr.getWorksheetFuncModule=Yn.__importStar(wZ());yr.informationFuncs=Yn.__importStar(YJ());yr.lambdaFuncs=Yn.__importStar(rZ());yr.logicalFuncs=Yn.__importStar(iZ());yr.lookupFuncs=Yn.__importStar(U3());yr.mathFuncs=Yn.__importStar(K3());yr.numfmtFuncs=Yn.__importStar(vZ());yr.predicateFuncs=Yn.__importStar(SZ());yr.rangeFuncs=Yn.__importStar(_Z());yr.recordFuncs=Yn.__importStar(bZ());yr.reduce=Yn.__importStar(FJ());yr.referenceFuncs=Yn.__importStar(TZ());yr.stringFuncs=Yn.__importStar(kZ());yr.funcsTestUtils=Yn.__importStar(fEe());yr.funcsUtil=Yn.__importStar(xm());yr.volatileFuncs=Yn.__importStar(MZ());yr.webFuncs=Yn.__importStar(xZ());yr.wildcard=Yn.__importStar(Zx());yr.nextFuncs=Yn.__importStar(EEe())});var uv=T(rt=>{"use strict";p();Object.defineProperty(rt,"__esModule",{value:!0});rt.userDefinedFunc=rt.stopped=rt.previousNameFailure=rt.previousFailure=rt.pendingValue=rt.breaked=rt.paused=rt.nameCycle=rt.limitExceeded=rt.interval=rt.illFormedFormula=rt.finalValue=rt.evalLocals=rt.evalGlobals=rt.createCompileGlobals=rt.compileLocalsName=rt.compileLocalsGrid=rt.cellWellFormedFormula=rt.cellFormula=rt.cellCycle=rt.runtimePositionFirstOrderFunc=rt.runtimePositionFormulaRoot=rt.runtimePositionEtaLambdaBody=rt.runtimePositionLambdaParam=rt.runtimePositionLambdaRoot=rt.runtimePositionLetVal=rt.RuntimePositionKind=rt.StepAction=rt.ReasonKind=rt.LimitKind=rt.Interrupt=rt.CellKind=void 0;var Oi=ov();rt.CellKind=Oi.serviceTypes.CellKind;rt.Interrupt=Oi.serviceTypes.Interrupt;rt.LimitKind=Oi.serviceTypes.LimitKind;rt.ReasonKind=Oi.serviceTypes.ReasonKind;rt.StepAction=Oi.serviceTypes.StepAction;rt.RuntimePositionKind=Oi.serviceTypes.RuntimePositionKind;rt.runtimePositionLetVal=Oi.serviceTypes.runtimePositionLetVal;rt.runtimePositionLambdaRoot=Oi.serviceTypes.runtimePositionLambdaRoot;rt.runtimePositionLambdaParam=Oi.serviceTypes.runtimePositionLambdaParam;rt.runtimePositionEtaLambdaBody=Oi.serviceTypes.runtimePositionEtaLambdaBody;rt.runtimePositionFormulaRoot=Oi.serviceTypes.runtimePositionFormulaRoot;rt.runtimePositionFirstOrderFunc=Oi.serviceTypes.runtimePositionFirstOrderFunc;rt.cellCycle=Oi.serviceTypes.cellCycle;rt.cellFormula=Oi.serviceTypes.cellFormula;rt.cellWellFormedFormula=Oi.serviceTypes.cellWellFormedFormula;rt.compileLocalsGrid=Oi.serviceTypes.compileLocalsGrid;rt.compileLocalsName=Oi.serviceTypes.compileLocalsName;rt.createCompileGlobals=Oi.serviceTypes.createCompileGlobals;rt.evalGlobals=Oi.serviceTypes.evalGlobals;rt.evalLocals=Oi.serviceTypes.evalLocals;rt.finalValue=Oi.serviceTypes.finalValue;rt.illFormedFormula=Oi.serviceTypes.illFormedFormula;rt.interval=Oi.serviceTypes.interval;rt.limitExceeded=Oi.serviceTypes.limitExceeded;rt.nameCycle=Oi.serviceTypes.nameCycle;rt.paused=Oi.serviceTypes.paused;rt.breaked=Oi.serviceTypes.breaked;rt.pendingValue=Oi.serviceTypes.pendingValue;rt.previousFailure=Oi.serviceTypes.previousFailure;rt.previousNameFailure=Oi.serviceTypes.previousNameFailure;rt.stopped=Oi.serviceTypes.stopped;rt.userDefinedFunc=Oi.serviceTypes.userDefinedFunc});var WZ=T(kC=>{"use strict";p();Object.defineProperty(kC,"__esModule",{value:!0});kC.createCompiler=kC.compiledFormulaTerm=kC.compiledFormula=void 0;var jZ=ov();kC.compiledFormula=jZ.compilerService.compiledFormula;kC.compiledFormulaTerm=jZ.compilerService.compiledFormulaTerm;kC.createCompiler=jZ.compilerService.createCompiler});var HZ=T(iK=>{"use strict";p();Object.defineProperty(iK,"__esModule",{value:!0});iK.createEvaluator=void 0;var g_r=ov();iK.createEvaluator=g_r.evaluatorService.createEvaluator});var AEe=T(uN=>{"use strict";p();Object.defineProperty(uN,"__esModule",{value:!0});uN.RecordOper=uN.LambdaOper=void 0;var PEe=ov();uN.LambdaOper=PEe.value.LambdaOper;uN.RecordOper=PEe.value.RecordOper});var FEe=T(mS=>{"use strict";p();Object.defineProperty(mS,"__esModule",{value:!0});mS.rangeValues=mS.machine=mS.isRangeValues=mS.DerefOperKind=void 0;var oK=ov();mS.DerefOperKind=oK.extensionTypes.DerefOperKind;mS.isRangeValues=oK.extensionTypes.isRangeValues;mS.machine=oK.extensionTypes.machine;mS.rangeValues=oK.extensionTypes.rangeValues});var OEe=T(sN=>{"use strict";p();Object.defineProperty(sN,"__esModule",{value:!0});sN.machine=sN.DerefOperKind=void 0;var v_r=fe(),NEe=v_r.__importStar(FEe());sN.DerefOperKind=NEe.DerefOperKind;sN.machine=NEe.machine});var MEe=T(Mr=>{"use strict";p();Object.defineProperty(Mr,"__esModule",{value:!0});Mr.extension=Mr.createEvaluator=Mr.createCompiler=Mr.RecordOper=Mr.LambdaOper=Mr.LimitKind=Mr.limitExceeded=Mr.createCompileGlobals=Mr.illFormedFormula=Mr.compileLocalsName=Mr.compileLocalsGrid=Mr.evalLocals=Mr.evalGlobals=Mr.previousNameFailure=Mr.previousFailure=Mr.breaked=Mr.paused=Mr.cellCycle=Mr.nameCycle=Mr.stopped=Mr.userDefinedFunc=Mr.cellFormula=Mr.cellWellFormedFormula=Mr.pendingValue=Mr.finalValue=Mr.runtimePositionFirstOrderFunc=Mr.runtimePositionFormulaRoot=Mr.runtimePositionEtaLambdaBody=Mr.runtimePositionLambdaParam=Mr.runtimePositionLambdaRoot=Mr.runtimePositionLetVal=Mr.RuntimePositionKind=Mr.StepAction=Mr.Interrupt=Mr.CellKind=Mr.interval=Mr.ReasonKind=void 0;var TI=fe(),ki=TI.__importStar(uv()),h_r=TI.__importStar(WZ()),S_r=TI.__importStar(HZ()),kEe=TI.__importStar(AEe()),y_r=TI.__importStar(OEe());Mr.ReasonKind=ki.ReasonKind;Mr.interval=ki.interval;Mr.CellKind=ki.CellKind;Mr.Interrupt=ki.Interrupt;Mr.StepAction=ki.StepAction;Mr.RuntimePositionKind=ki.RuntimePositionKind;Mr.runtimePositionLetVal=ki.runtimePositionLetVal;Mr.runtimePositionLambdaRoot=ki.runtimePositionLambdaRoot;Mr.runtimePositionLambdaParam=ki.runtimePositionLambdaParam;Mr.runtimePositionEtaLambdaBody=ki.runtimePositionEtaLambdaBody;Mr.runtimePositionFormulaRoot=ki.runtimePositionFormulaRoot;Mr.runtimePositionFirstOrderFunc=ki.runtimePositionFirstOrderFunc;Mr.finalValue=ki.finalValue;Mr.pendingValue=ki.pendingValue;Mr.cellWellFormedFormula=ki.cellWellFormedFormula;Mr.cellFormula=ki.cellFormula;Mr.userDefinedFunc=ki.userDefinedFunc;Mr.stopped=ki.stopped;Mr.nameCycle=ki.nameCycle;Mr.cellCycle=ki.cellCycle;Mr.paused=ki.paused;Mr.breaked=ki.breaked;Mr.previousFailure=ki.previousFailure;Mr.previousNameFailure=ki.previousNameFailure;Mr.evalGlobals=ki.evalGlobals;Mr.evalLocals=ki.evalLocals;Mr.compileLocalsGrid=ki.compileLocalsGrid;Mr.compileLocalsName=ki.compileLocalsName;Mr.illFormedFormula=ki.illFormedFormula;Mr.createCompileGlobals=ki.createCompileGlobals;Mr.limitExceeded=ki.limitExceeded;Mr.LimitKind=ki.LimitKind;Mr.LambdaOper=kEe.LambdaOper;Mr.RecordOper=kEe.RecordOper;Mr.createCompiler=h_r.createCompiler;Mr.createEvaluator=S_r.createEvaluator;Mr.extension=y_r});var r_=T(he=>{"use strict";p();Object.defineProperty(he,"__esModule",{value:!0});he.copyPasteRangePasteEdit=he.rangePasteEdit=he.arrayFormulaEdit=he.rangeFormatEdit=he.formatEditChangeDecimals=he.formatEditRibbonFormat=he.formatEditSetFormat=he.formatEditOperation=he.RibbonFormat=he.inferredRangeFormulaEdit=he.valueRangeFormulaEdit=he.cellFormulaRangeFormulaEdit=he.rangeFormulaEdit=he.namedObjectsPromote=he.undefinedNamesWrite=he.namedObjectsWrite=he.namedObjectsUpdate=he.namedObject=he.namedFailureData=he.namedTableData=he.columnData=he.namedRangeData=he.namedFormulaData=he.namedValueData=he.unusedCellsUpdate=he.arrayPromote=he.arrayWrite=he.arrayUpdate=he.arrayData=he.rangePromote=he.rangeWrite=he.rangeUpdate=he.valueCellData=he.arrayFormulaCellData=he.cellFormulaCellData=he.cellData=he.sheetCellLocation=he.sheetRangeLocation=he.rangeLocation=he.cellLocation=he.getCellFormatKind=he.getCellValueKind=he.richValue=he.errorValue=he.blankValue=he.sheetName=he.numberFormat=he.localeData=he.errorTypeName=he.worksheetFunctionName=void 0;he.RecalcServiceCreateMode=he.workbookProps=he.recalcServiceConfig=he.runExperiment=he.updateRequest=he.evalFormulaData=he.evalFormulaFormatAggregate=he.evalFormulaFormatInferred=he.evalFormulaFormatKnown=he.evalFormulaFormatIformat=he.evalFormulaFormatOrigin=he.evalFormulaFormat=he.recalcResults=he.rangeFailure=he.arrayDelta=he.rangeDelta=he.cellDataDelta=he.inferredFormat=void 0;var Ra=Ar(),__r=Dx();Object.defineProperty(he,"RibbonFormat",{enumerable:!0,get:function(){return __r.RibbonFormat}});he.worksheetFunctionName=(0,Ra.typedInstanceCreator)()(function(e,r){return{functionId:e,functionName:r}});he.errorTypeName=(0,Ra.typedInstanceCreator)()(function(e,r){return{errorType:e,errorName:r}});he.localeData=(0,Ra.typedInstanceCreator)()(function(e,r,t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N,k,q,V,I,M,B,U,j,X,ee,re,Z,J,C,S,b,O,w,D,Q,W,$,me,ve,Pe,ua,Qi,go,Ro,$n,ns,Iu){return{worksheetFunctionNames:e,errorTypeNames:r,specialRefNames:$n,trueName:t,falseName:n,rowLetter:a,columnLetter:o,leftBrace:u,rightBrace:s,leftBracket:l,rightBracket:c,decimalSeparator:d,listSeparator:f,columnSeparator:m,rowSeparator:v,thousandsData:h,thousandsSeparator:y,lcid:_,country:E,numberDecimals:N,isExpSepBySpace:k,fractionSeparator:q,isPercentSepBySpace:V,currencyFormat:I,isCurrencySymbolLead:M,isCurrencySepBySpace:B,currencySymbol:U,currencyDecimals:j,dateOrder:X,dateSeparator:ee,dateAltSeparator:re,year4Digits:Z,month2Digits:J,day2Digits:C,longDateFormat:S,timeSeparator:b,timeAltSeparator:O,hour2Digits:w,clock24Hour:D,isAMPMSepBySpace:Q,ampmSymbols:W,dayNameShort:$,dayNameLong:me,monthNameShort:ve,monthNameLong:Pe,pictureSpecial:ua,pictureSingle:Qi,pictureColor:go,pictureDbnum:Ro,sysDateFormat:ns,sysTimeFormat:Iu}});he.numberFormat=(0,Ra.typedInstanceCreator)()(function(e,r,t){return{iformat:e,formatString:r,builtIn:t}});he.sheetName=(0,Ra.typedInstanceCreator)()(function(e,r){return{sheetId:e,sheetName:r}});he.blankValue={kind:"Blank"};he.errorValue=(0,Ra.typedInstanceCreator)()(function(e){return{kind:"Error",type:e}});he.richValue=(0,Ra.typedInstanceCreator)()(function(e){return{kind:"Rich",fields:e}});function b_r(e){return typeof e=="object"?e.kind:typeof e}he.getCellValueKind=b_r;function C_r(e){return typeof e=="object"?e.kind:typeof e}he.getCellFormatKind=C_r;he.cellLocation=(0,Ra.typedInstanceCreator)()(function(e,r){return{row:e,column:r}});he.rangeLocation=(0,Ra.typedInstanceCreator)()(function(e,r,t,n){return{row:e,column:r,lastRow:t,lastColumn:n}});he.sheetRangeLocation=(0,Ra.typedInstanceCreator)()(function(e,r,t,n,a){return{sheetId:e,row:r,column:t,lastRow:n,lastColumn:a}});he.sheetCellLocation=(0,Ra.typedInstanceCreator)()(function(e,r,t){return{sheetId:e,row:r,column:t,lastRow:void 0,lastColumn:void 0}});he.cellData=(0,Ra.typedInstanceCreator)()(function(e,r,t,n,a){return{formulaBarText:e,value:r,iformat:t,failureReason:n,kind:a}});function T_r(e,r,t,n){return(0,he.cellData)(e,r,t,n,"CellFormula")}he.cellFormulaCellData=T_r;function R_r(e,r,t){return(0,he.cellData)(void 0,e,r,t,"ArrayFormula")}he.arrayFormulaCellData=R_r;function E_r(e,r,t,n){return(0,he.cellData)(e,r,t,n,"Value")}he.valueCellData=E_r;he.rangeUpdate=(0,Ra.typedInstanceCreator)()(function(e,r,t,n,a){return{range:e,data:r,fromStateId:t,excludeRows:n,excludeColumns:a}});he.rangeWrite=(0,Ra.typedInstanceCreator)()(function(e,r,t,n){return(0,he.rangeUpdate)(e,r,void 0,t,n)});function P_r(e,r,t,n){return(0,he.rangeUpdate)(e,void 0,r,t,n)}he.rangePromote=P_r;he.arrayData=(0,Ra.typedInstanceCreator)()(function(e,r){return{isSpilled:e,formulaBarText:r}});he.arrayUpdate=(0,Ra.typedInstanceCreator)()(function(e,r,t){return{range:e,data:r,fromStateId:t}});function A_r(e,r){return(0,he.arrayUpdate)(e,r,void 0)}he.arrayWrite=A_r;function F_r(e,r){return(0,he.arrayUpdate)(e,void 0,r)}he.arrayPromote=F_r;he.unusedCellsUpdate=(0,Ra.typedInstanceCreator)()(function(e,r){return{sheetId:e,usedRange:r}});he.namedValueData=(0,Ra.typedInstanceCreator)()(function(e){return{kind:"NamedValue",value:e}});he.namedFormulaData=(0,Ra.typedInstanceCreator)()(function(e){return{kind:"NamedFormula",formulaBarText:e}});he.namedRangeData=(0,Ra.typedInstanceCreator)()(function(e){return{kind:"NamedRange",range:e}});he.columnData=(0,Ra.typedInstanceCreator)()(function(e,r){return{column:e,name:r}});he.namedTableData=(0,Ra.typedInstanceCreator)()(function(e,r,t,n){return{kind:"NamedTable",range:e,hasHeadersRow:r,hasTotalsRow:t,columns:n}});he.namedFailureData=(0,Ra.typedInstanceCreator)()(function(e,r){return{kind:"NamedFailure",failureReason:e,objectKind:r}});he.namedObject=(0,Ra.typedInstanceCreator)()(function(e,r){return{name:e,data:r}});he.namedObjectsUpdate=(0,Ra.typedInstanceCreator)()(function(e,r,t){return{scope:e,objects:r,fromStateId:t}});function N_r(e,r){return(0,he.namedObjectsUpdate)(e,r,void 0)}he.namedObjectsWrite=N_r;function O_r(e){return(0,he.namedObjectsUpdate)(e,void 0,void 0)}he.undefinedNamesWrite=O_r;function k_r(e,r){return(0,he.namedObjectsUpdate)(e,void 0,r)}he.namedObjectsPromote=k_r;var M_r=function(r,t,n,a,o,u){return u===void 0&&(u="Inferred"),{range:Array.isArray(r)?r:[r],formulaBarText:t,value:n,origin:a,viewport:o,kind:u}};he.rangeFormulaEdit=M_r;function x_r(e,r,t,n){return(0,he.rangeFormulaEdit)(e,r,void 0,t,n,"CellFormula")}he.cellFormulaRangeFormulaEdit=x_r;function I_r(e,r,t,n){return(0,he.rangeFormulaEdit)(e,r,t,void 0,n,"Value")}he.valueRangeFormulaEdit=I_r;function w_r(e,r,t,n){return(0,he.rangeFormulaEdit)(e,r,void 0,t,n,"Inferred")}he.inferredRangeFormulaEdit=w_r;he.formatEditOperation=(0,Ra.typedInstanceCreator)()(function(e,r,t,n){return{kind:e,format:r,ribbon:t,changeDecimals:n}});function D_r(e){return(0,he.formatEditOperation)("SetFormat",e,void 0,void 0)}he.formatEditSetFormat=D_r;function L_r(e){return(0,he.formatEditOperation)("RibbonFormat",void 0,e,void 0)}he.formatEditRibbonFormat=L_r;function q_r(e){return(0,he.formatEditOperation)("ChangeDecimals",void 0,void 0,e)}he.formatEditChangeDecimals=q_r;he.rangeFormatEdit=(0,Ra.typedInstanceCreator)()(function(e,r,t,n){return{range:e,operation:r,origin:t,viewport:n}});he.arrayFormulaEdit=(0,Ra.typedInstanceCreator)()(function(e,r,t,n){return{range:e,formulaBarText:r,origin:t,viewport:n}});he.rangePasteEdit=(0,Ra.typedInstanceCreator)()(function(e,r,t,n){return{kind:e,target:r,source:t,viewport:n}});function G_r(e,r,t){var n=(0,he.sheetCellLocation)(e.sheetId,e.row,e.column);return(0,he.rangePasteEdit)("CopyPaste",n,r,t)}he.copyPasteRangePasteEdit=G_r;he.inferredFormat=(0,Ra.typedInstanceCreator)()(function(e,r,t){return{format:e,category:r,decimals:t}});he.cellDataDelta=(0,Ra.typedInstanceCreator)()(function(e,r,t,n,a){return{formulaBarText:e,value:r,format:t,formatted:n,hasHyperlink:a}});he.rangeDelta=(0,Ra.typedInstanceCreator)()(function(e,r){return{range:e,data:r}});he.arrayDelta=(0,Ra.typedInstanceCreator)()(function(e,r){return{range:e,data:r}});he.rangeFailure=(0,Ra.typedInstanceCreator)()(function(e,r){return{range:e,reason:r}});he.recalcResults=(0,Ra.typedInstanceCreator)()(function(e,r,t,n,a,o){return{stateId:e,priorityGroup:r,isFinished:t,rangeDeltas:n,arrayDeltas:a,rangeFailures:o}});he.evalFormulaFormat=(0,Ra.typedInstanceCreator)()(function(e,r,t){return{kind:e,iformat:r,knownFormat:t}});function B_r(){return(0,he.evalFormulaFormat)("Origin")}he.evalFormulaFormatOrigin=B_r;function U_r(e){return(0,he.evalFormulaFormat)("Iformat",e)}he.evalFormulaFormatIformat=U_r;function K_r(e){return(0,he.evalFormulaFormat)("Known",void 0,e)}he.evalFormulaFormatKnown=K_r;function V_r(){return(0,he.evalFormulaFormat)("Inferred")}he.evalFormulaFormatInferred=V_r;function j_r(){return(0,he.evalFormulaFormat)("Aggregate")}he.evalFormulaFormatAggregate=j_r;function W_r(e,r){return{value:e,formatted:r}}he.evalFormulaData=W_r;he.updateRequest=(0,Ra.typedInstanceCreator)()(function(e,r,t){return{rangeUpdateRanges:e,arrayUpdateRanges:r,namesUpdateScopes:t}});he.runExperiment=(0,Ra.typedInstanceCreator)()(function(e,r){return{name:e,param:r}});he.recalcServiceConfig=(0,Ra.typedInstanceCreator)()(function(e,r,t,n,a,o,u,s,l,c,d,f){return d===void 0&&(d=c==null?void 0:c/(c>=1?1:10)),{totalEvalTimeMs:e,samplePrecisionEvalRate:r,samplePrecisionPrintFormulaRate:c,samplePrecisionPrintValueRate:d,sampleRecalcStatisticsRate:s,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:a,sampleRecalcViewportStopwatchRate:o,sampleCellEvalStopwatchRate:u,rngSeed:t,volatileMode:f,runExperiments:l}});he.workbookProps=(0,Ra.typedInstanceCreator)()(function(e,r,t){return{date1904:e,dateCompatibility:r,timezone:t}});var xEe;(function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"})(xEe||(he.RecalcServiceCreateMode=xEe={}))});var IEe=T(Ef=>{"use strict";p();Object.defineProperty(Ef,"__esModule",{value:!0});Ef.ivlCompare=Ef.ivlExcept=Ef.ivlMeetsOrTouches=Ef.ivlMeets=Ef.ivlDistance=Ef.ivlMeet=Ef.ivlJoin=void 0;var yR=pr();Ef.ivlJoin=yR.interval.ivlJoin;Ef.ivlMeet=yR.interval.ivlMeet;Ef.ivlDistance=yR.interval.ivlDistance;Ef.ivlMeets=yR.interval.ivlMeets;Ef.ivlMeetsOrTouches=yR.interval.ivlMeetsOrTouches;Ef.ivlExcept=yR.interval.ivlExcept;Ef.ivlCompare=yR.interval.ivlCompare});var Mh=T(Pn=>{"use strict";p();Object.defineProperty(Pn,"__esModule",{value:!0});Pn.forEachKeyUntyped=Pn.forEachKey=Pn.getNodeCount=Pn.complement=Pn.symmetricDiff=Pn.lazy=Pn.empty=Pn.dense=Pn.compareUntyped=Pn.combineCmp=Pn.compare=Pn.exceptUntyped=Pn.except=Pn.meetsUntyped=Pn.meets=Pn.intersectUntyped=Pn.intersect=Pn.unionUntyped=Pn.union=Pn.fromUntyped=Pn.createFromKey=Pn.cacheKeySplitting=Pn.SetKind=void 0;var hs=pr();Pn.SetKind=hs.bspSet.SetKind;Pn.cacheKeySplitting=hs.bspSet.cacheKeySplitting;Pn.createFromKey=hs.bspSet.createFromKey;Pn.fromUntyped=hs.bspSet.fromUntyped;Pn.union=hs.bspSet.union;Pn.unionUntyped=hs.bspSet.unionUntyped;Pn.intersect=hs.bspSet.intersect;Pn.intersectUntyped=hs.bspSet.intersectUntyped;Pn.meets=hs.bspSet.meets;Pn.meetsUntyped=hs.bspSet.meetsUntyped;Pn.except=hs.bspSet.except;Pn.exceptUntyped=hs.bspSet.exceptUntyped;Pn.compare=hs.bspSet.compare;Pn.combineCmp=hs.bspSet.combineCmp;Pn.compareUntyped=hs.bspSet.compareUntyped;Pn.dense=hs.bspSet.dense;Pn.empty=hs.bspSet.empty;Pn.lazy=hs.bspSet.lazy;Pn.symmetricDiff=hs.bspSet.symmetricDiff;Pn.complement=hs.bspSet.complement;Pn.getNodeCount=hs.bspSet.getNodeCount;Pn.forEachKey=hs.bspSet.forEachKey;Pn.forEachKeyUntyped=hs.bspSet.forEachKeyUntyped});var wEe=T(MC=>{"use strict";p();Object.defineProperty(MC,"__esModule",{value:!0});MC.boundedParetoSetOperations=MC.boundedParetoSplitter=MC.boundedPareto=void 0;var zZ=pr();MC.boundedPareto=zZ.split.boundedPareto;MC.boundedParetoSplitter=zZ.split.boundedParetoSplitter;MC.boundedParetoSetOperations=zZ.split.boundedParetoSetOperations});var Pf=T(co=>{"use strict";p();Object.defineProperty(co,"__esModule",{value:!0});co.productSetSerializer=co.ProductSetSerializer=co.getSubspaceCount=co.forEachProduct=co.getSubspaces=co.symmetricDiffProduct=co.complementProduct=co.meetsProduct=co.compareProduct=co.exceptProduct=co.intersectProduct=co.unionProduct=co.project=co.createFromProduct=void 0;var Wp=pr();co.createFromProduct=Wp.productSet.createFromProduct;co.project=Wp.productSet.project;co.unionProduct=Wp.productSet.unionProduct;co.intersectProduct=Wp.productSet.intersectProduct;co.exceptProduct=Wp.productSet.exceptProduct;co.compareProduct=Wp.productSet.compareProduct;co.meetsProduct=Wp.productSet.meetsProduct;co.complementProduct=Wp.productSet.complementProduct;co.symmetricDiffProduct=Wp.productSet.symmetricDiffProduct;co.getSubspaces=Wp.productSet.getSubspaces;co.forEachProduct=Wp.productSet.forEachProduct;co.getSubspaceCount=Wp.productSet.getSubspaceCount;co.ProductSetSerializer=Wp.productSet.ProductSetSerializer;co.productSetSerializer=Wp.productSet.productSetSerializer});var Zc=T(fa=>{"use strict";p();Object.defineProperty(fa,"__esModule",{value:!0});fa.translateAvailabilitySet=fa.forEachCellInSet=fa.forEachRangeInSet=fa.forEachCol=fa.forEachRow=fa.availableAllProduct=fa.availableReadProduct=fa.availableSetProduct=fa.cellSetBounds=fa.createCellSetFromRange=fa.bspFactory=fa.availabilityOperations=fa.anyAvailability=fa.AvailabilityKind=void 0;var uK=No(),H_r=qi(),DEe=IEe(),Fd=Mh(),YZ=wEe(),xC=Pf(),gS;(function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"})(gS||(fa.AvailabilityKind=gS={}));fa.anyAvailability=[gS.AvailableSet,gS.AvailableRead+1];var QZ=[0,uK.sheetRows],XZ=[0,uK.sheetCols];fa.availabilityOperations=(0,YZ.boundedParetoSetOperations)(1,fa.anyAvailability[0]+1,fa.anyAvailability[1],fa.anyAvailability,"Availability operations, alpha = 1");var z_r=(0,YZ.boundedParetoSetOperations)(.2,QZ[0]+1,QZ[1],QZ,"Row operations, alpha = 0.2"),Q_r=(0,YZ.boundedParetoSetOperations)(.35,XZ[0]+1,XZ[1],XZ,"Col operations, alpha = 0.35"),t_={availability:fa.availabilityOperations,row:z_r,col:Q_r};fa.bspFactory={availability:(0,Fd.createFromKey)(t_.availability),row:(0,Fd.createFromKey)(t_.row),col:(0,Fd.createFromKey)(t_.col)};function X_r(e){return(0,xC.createFromProduct)({row:fa.bspFactory.row([e.row,e.row+e.rows]),col:fa.bspFactory.col([e.col,e.col+e.cols])})}fa.createCellSetFromRange=X_r;function Y_r(e){if(e!==Fd.empty){var r=e===Fd.dense?void 0:e.root.bounds.row,t=e===Fd.dense?void 0:e.root.bounds.col,n=r===void 0?t_.row.top:J_r((0,Fd.fromUntyped)(t_.row,r)),a=n[0],o=n[1],u=t===void 0?t_.col.top:Z_r((0,Fd.fromUntyped)(t_.col,t)),s=u[0],l=u[1];return(0,uK.gridRange)(a,s,o-a,l-s)}}fa.cellSetBounds=Y_r;fa.availableSetProduct=(0,xC.createFromProduct)({availability:fa.bspFactory.availability([gS.AvailableSet,gS.AvailableSet+1])});fa.availableReadProduct=(0,xC.createFromProduct)({availability:fa.bspFactory.availability([gS.AvailableRead,gS.AvailableRead+1])});fa.availableAllProduct=(0,xC.createFromProduct)({availability:fa.bspFactory.availability([gS.AvailableSet,gS.AvailableRead+1])});function sK(e,r){return e!==Fd.dense?(0,Fd.forEachKey)(e,r):r(t_.row.top)}fa.forEachRow=sK;function lK(e,r){return e!==Fd.dense?(0,Fd.forEachKey)(e,r):r(t_.col.top)}fa.forEachCol=lK;function J_r(e){var r=[];return sK(e,function(t){return r.push(t),!0}),r.reduce(DEe.ivlJoin)}function Z_r(e){var r=[];return lK(e,function(t){return r.push(t),!0}),r.reduce(DEe.ivlJoin)}function LEe(e,r){var t=function(a){return sK(a.row,function(o){var u=o[0],s=o[1];return lK(a.col,function(l){var c=l[0],d=l[1];return r((0,uK.gridRange)(u,c,s-u,d-c))})})};return(0,xC.forEachProduct)(e,t,"row","col")}fa.forEachRangeInSet=LEe;function $_r(e,r){return LEe(e,function(t){return(0,H_r.forEachCellInRange)(t,r)})}fa.forEachCellInSet=$_r;function ebr(e,r,t){var n=Fd.empty;return(0,xC.forEachProduct)(e,function(a){var o=Fd.empty;sK(a.row,function(l){var c=l[0],d=l[1];return o=(0,Fd.union)(o,fa.bspFactory.row([c+r,d+r])),!0});var u=Fd.empty;lK(a.col,function(l){var c=l[0],d=l[1];return u=(0,Fd.union)(u,fa.bspFactory.col([c+t,d+t])),!0});var s=(0,xC.createFromProduct)({row:o,col:u,availability:a.availability});return n=(0,xC.unionProduct)(n,s),!0},"row","col","availability"),n}fa.translateAvailabilitySet=ebr});var Ss=T(Ja=>{"use strict";p();Object.defineProperty(Ja,"__esModule",{value:!0});Ja.isOutputFormatUnavailable=Ja.OutputMessageKind=Ja.FormulaMode=Ja.SpecialStyle=Ja.SpecialFormat=Ja.SetMessageKind=Ja.mergeRecalcStatistics=Ja.RecalcStatisticsMessage=Ja.emptyRecalcStatistics=Ja.ComputedCellKind=Ja.ComputeKind=Ja.sheetInFilterMode=Ja.sheetHiddenRows=Ja.sheetUsedRange=Ja.createSheetCellSetFromRange=Ja.sheetCellSet=Ja.UnavailableKind=void 0;var Hp=fe(),rbr=Zc(),tbr=Ba(),qEe;(function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.CellStyle="CellStyle",e.HiddenRows="HiddenRows",e.HiddenCols="HiddenCols",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.EvalFailure="EvalFailure",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.StyleId="StyleId",e.FontId="FontId",e.FillId="FillId",e.BorderId="BorderId",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable",e.NamedRanges="NamedRanges"})(qEe||(Ja.UnavailableKind=qEe={}));function HEe(e,r){return{sheet:e,set:r}}Ja.sheetCellSet=HEe;function nbr(e){return HEe(e.sheet,(0,rbr.createCellSetFromRange)(e.range))}Ja.createSheetCellSetFromRange=nbr;function abr(e,r){return{sheet:e,range:r}}Ja.sheetUsedRange=abr;function ibr(e,r,t){return{sheet:e,range:r,hidden:t}}Ja.sheetHiddenRows=ibr;function obr(e,r){return{sheet:e,inFilterMode:r}}Ja.sheetInFilterMode=obr;var GEe;(function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"})(GEe||(Ja.ComputeKind=GEe={}));var BEe;(function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"})(BEe||(Ja.ComputedCellKind=BEe={}));Ja.emptyRecalcStatistics={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};var IC;(function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"})(IC||(Ja.RecalcStatisticsMessage=IC={}));function JZ(e,r){var t,n;return Hp.__assign(Hp.__assign({},e),(t={},t[r]=((n=e[r])!==null&&n!==void 0?n:0)+1,t))}function ubr(e,r){switch(r.message){case IC.ChangedCell:return Hp.__assign(Hp.__assign({},e),{changedCellCount:JZ(e.changedCellCount,r.cellKind),calculatedCellCount:JZ(e.calculatedCellCount,r.cellKind)});case IC.UnchangedCell:return Hp.__assign(Hp.__assign({},e),{calculatedCellCount:JZ(e.calculatedCellCount,r.cellKind)});case IC.ContinueComputation:return Hp.__assign(Hp.__assign({},e),{continueCount:e.continueCount+1});case IC.StateTimedOut:return Hp.__assign(Hp.__assign({},e),{stateTimedOut:!0});case IC.EditFinished:return Hp.__assign(Hp.__assign({},e),{editFinishedCount:e.editFinishedCount+1});case IC.RecalcFinished:return Hp.__assign(Hp.__assign({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return(0,tbr.assertNever)("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",r)}}Ja.mergeRecalcStatistics=ubr;var UEe;(function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"})(UEe||(Ja.SetMessageKind=UEe={}));var KEe;(function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"})(KEe||(Ja.SpecialFormat=KEe={}));var VEe;(function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.Blank="Blank"})(VEe||(Ja.SpecialStyle=VEe={}));var jEe;(function(e){e.EvalFormula="eval-formula",e.ServerCellFormula="server-cell-formula",e.EditCellFormula="edit-cell-formula",e.ServerNamedFormula="server-named-formula",e.EditNamedFormula="edit-named-formula"})(jEe||(Ja.FormulaMode=jEe={}));var WEe;(function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.Alert="Alert",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"})(WEe||(Ja.OutputMessageKind=WEe={}));function sbr(e){return typeof e=="object"}Ja.isOutputFormatUnavailable=sbr});var _R=T(lN=>{"use strict";p();Object.defineProperty(lN,"__esModule",{value:!0});lN.makeGridRangeTable=lN.gridRangeDistance=void 0;var zEe=ov();lN.gridRangeDistance=zEe.rtree.gridRangeDistance;lN.makeGridRangeTable=zEe.rtree.makeGridRangeTable});var n_=T(br=>{"use strict";p();Object.defineProperty(br,"__esModule",{value:!0});br.PartialWorkbookGrid=br.CloningTarget=br.usedRangeIsect=br.usedRangeJoin=br.denseUsedRange=br.emptyUsedRange=br.mergeGridStatistics=br.emptyGridStatistics=br.hiddennessFullyUnavailable=br.isBlankGridValue=br.blankGridValue=br.isClientValueUnknownOper=br.clientValueUnknownOper=br.ClientOperKind=br.blankClientGridFormula=br.isBlankGridFormula=br.blankRangeGridFormula=br.blankCellGridFormula=br.SpecialString=br.SpecialBoolean=br.isBlankCellFormat=br.blankCellFormat=void 0;var sv=fe(),cK=uv(),Gm=qi(),vS=No(),lbr=_y(),Jt=Zc(),EI=_R(),bR=Ar(),pa=Mh(),Hr=Pf(),ZZ=Ss(),vc=Ss(),cN=zn(),cbr=Hf();function QEe(e){return Array.isArray(e)}br.blankCellFormat=0;var dbr=function(r){return r===0};br.isBlankCellFormat=dbr;var $Z;(function(e){e.ClientValueUnknown="ClientValueUnknown"})($Z||(br.SpecialBoolean=$Z={}));var fK;(function(e){e[e.ClientValueUnknown=0]="ClientValueUnknown"})(fK||(br.SpecialString=fK={}));br.blankCellGridFormula={fmla:"",lexicalKind:vS.LexicalKind.Cell,origin:(0,vS.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1};(0,bR.staticAssertExtends)();br.blankRangeGridFormula={fmla:"",lexicalKind:vS.LexicalKind.Range,origin:(0,vS.gridCell)(0,0),compiledFmla:void 0,hasHyperlink:!1};(0,bR.staticAssertExtends)();var fbr=function(r,t){return r===""&&!t};br.isBlankGridFormula=fbr;br.blankClientGridFormula=br.blankCellGridFormula;var pK;(function(e){e.ClientValueUnknown="ClientValueUnknown"})(pK||(br.ClientOperKind=pK={}));br.clientValueUnknownOper={kind:pK.ClientValueUnknown};function $Ee(e){return e.kind===pK.ClientValueUnknown}br.isClientValueUnknownOper=$Ee;br.blankGridValue={oper:lbr.blankOper,failure:void 0};(0,bR.staticAssertExtends)();function PI(e,r){return(0,Gm.isBlankOper)(e)&&r===void 0}br.isBlankGridValue=PI;function XEe(e,r,t){return e.setValue(r,t,function(n){return n.fmla!==t.fmla||n.lexicalKind!==t.lexicalKind||n.compiledFmla!==void 0&&!(0,Gm.isGridCellEqual)(n.origin,t.origin)||n.compiledFmla==null!=(t.compiledFmla==null)})}function YEe(e,r){return e.forEachMeets(r,function(t,n){if(n.fmla.length>0){var a=n.lexicalKind===vS.LexicalKind.Cell?br.blankCellGridFormula:br.blankRangeGridFormula;e=e.setValue(t,a)}return!0}),e}function JEe(e,r){return e.forEachMeets(r,function(t,n){return(n.fmla===fK.ClientValueUnknown||n.fmla.length>0)&&(e=e.setValue(t,br.blankClientGridFormula)),!0}),e}function ZEe(e,r,t,n){var a=(0,Hr.intersectProduct)(r,Jt.availableReadProduct),o=(0,Hr.project)((0,Hr.intersectProduct)(t,a),"row","col");return(0,Jt.forEachCellInSet)((0,Hr.exceptProduct)(r,o),function(u){return e=e.setValue(u,n),!0}),e}function pbr(e,r,t){var n=(0,Hr.intersectProduct)(r,Jt.availableReadProduct),a=(0,Hr.project)((0,Hr.intersectProduct)(t,n),"row","col");return(0,Jt.forEachCellInSet)((0,Hr.exceptProduct)(r,a),function(o){return e=e.setValue(o,vc.SpecialStyle.Unavailable),!0}),e}br.hiddennessFullyUnavailable={hidden:[],available:[]};var RI={values:(0,EI.makeGridRangeTable)(),formats:(0,EI.makeGridRangeTable)(),styles:(0,EI.makeGridRangeTable)(),formulae:(0,EI.makeGridRangeTable)(),dirty:pa.empty};br.emptyGridStatistics={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverStylesNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedStylesNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0,hiddenColsNodeCount:0};function mbr(e,r){return{serverFormulaeNodeCount:e.serverFormulaeNodeCount+r.serverFormulaeNodeCount,serverFormatsNodeCount:e.serverFormatsNodeCount+r.serverFormatsNodeCount,serverStylesNodeCount:e.serverStylesNodeCount+r.serverStylesNodeCount,serverValuesNodeCount:e.serverValuesNodeCount+r.serverValuesNodeCount,serverDirtySetSubspaceCount:e.serverDirtySetSubspaceCount+r.serverDirtySetSubspaceCount,editedFormulaeNodeCount:e.editedFormulaeNodeCount+r.editedFormulaeNodeCount,editedFormatsNodeCount:e.editedFormatsNodeCount+r.editedFormatsNodeCount,editedStylesNodeCount:e.editedStylesNodeCount+r.editedStylesNodeCount,editedValuesNodeCount:e.editedValuesNodeCount+r.editedValuesNodeCount,editedDirtySetSubspaceCount:e.editedDirtySetSubspaceCount+r.editedDirtySetSubspaceCount,clientFormulaeNodeCount:e.clientFormulaeNodeCount+r.clientFormulaeNodeCount,clientFormatsNodeCount:e.clientFormatsNodeCount+r.clientFormatsNodeCount,clientValuesNodeCount:e.clientValuesNodeCount+r.clientValuesNodeCount,recalcValuesNodeCount:e.recalcValuesNodeCount+r.recalcValuesNodeCount,recalcDirtySetSubspaceCount:e.recalcDirtySetSubspaceCount+r.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:e.recalcFailuresSetSubspaceCount+r.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:e.recalcTaintSetSubspaceCount+r.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:e.availabilitySetSubspaceCount+r.availabilitySetSubspaceCount,availabilityHistorySize:e.availabilityHistorySize+r.availabilityHistorySize,hiddenRowsNodeCount:e.hiddenRowsNodeCount+r.hiddenRowsNodeCount,hiddenColsNodeCount:e.hiddenColsNodeCount+r.hiddenColsNodeCount}}br.mergeGridStatistics=mbr;br.emptyUsedRange=void 0;br.denseUsedRange=(0,vS.gridRange)(0,0,vS.sheetRows,vS.sheetCols);function e$(e,r){return e===br.emptyUsedRange?r:r===br.emptyUsedRange?e:(0,Gm.gridRangeJoin)(e,r)}br.usedRangeJoin=e$;function dK(e,r){return e===br.emptyUsedRange||r===br.emptyUsedRange?br.emptyUsedRange:(0,Gm.gridRangeIsect)(e,r)}br.usedRangeIsect=dK;var mK;(function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"})(mK||(br.CloningTarget=mK={}));var gbr=function(){function e(r,t,n,a,o,u,s,l,c,d){r===void 0&&(r=RI),t===void 0&&(t=pa.empty),n===void 0&&(n=br.denseUsedRange),a===void 0&&(a=pa.empty),o===void 0&&(o=pa.empty),u===void 0&&(u=pa.empty),s===void 0&&(s=pa.empty),l===void 0&&(l=(0,EI.makeGridRangeTable)()),c===void 0&&(c=!1),d===void 0&&(d=!1),this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=r,this.serverAvailability=t,this.serverUsed=n,this.hiddenRows=a,this.hiddenRowsAvailability=o,this.hiddenCols=u,this.hiddenColsAvailability=s,this.mergeCells=l,this.inFilterMode=c,this.filterModeAvailable=d,this.rollBackToServerState(0)}return e.create=function(){return new e},e.prototype.clone=function(r){r===void 0&&(r=mK.Server);var t=new e(this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenRowsAvailability,this.hiddenCols,this.hiddenColsAvailability,this.mergeCells,this.inFilterMode,this.filterModeAvailable);return r===mK.Client&&(t.editedContents=this.editedContents,t.clientContents=this.clientContents,t.recalcValues=this.recalcValues,t.recalcDirty=this.recalcDirty,t.recalcFailures=this.recalcFailures,t.editedTaint=this.editedTaint,t.recalcTaint=this.recalcTaint,t.editedAvailability=this.editedAvailability),t},e.prototype.advanceState=function(r,t){this.oldAvailabilities[r]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=pa.empty,this.serverUsed=br.denseUsedRange,this.hiddenRows=this.hiddenRowsAvailability=pa.empty,this.hiddenCols=this.hiddenColsAvailability=pa.empty,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState(t)},e.prototype.rollBackToServerState=function(r){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=pa.empty,this.rollBackToEditedState(r)},e.prototype.rollBackToEditedState=function(r){this.setClientContents(this.editedContents,r),this.recalcValues=this.editedContents.values,this.recalcFailures=pa.empty,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint},e.prototype.allServerAvailable=function(r){return this.allAvailable(r,this.serverAvailability)},e.prototype.allEditedAvailable=function(r){return this.allAvailable(r,this.editedAvailability)},e.prototype.allAvailable=function(r,t){var n=(0,Jt.createCellSetFromRange)(r),a=(0,Hr.intersectProduct)(n,Jt.availableReadProduct),o=(0,Hr.intersectProduct)(t,a),u=(0,Hr.project)((0,Hr.exceptProduct)(a,o),"row","col"),s=(0,Hr.compareProduct)(o,a),l=s!==void 0&&s>=0;return l?!0:u},e.prototype.forEachRecalcDirty=function(r,t){return(0,Jt.forEachCellInSet)((0,Hr.intersectProduct)(this.recalcDirty,(0,Jt.createCellSetFromRange)(r)),t)},e.prototype.hasRecalcDirty=function(r){return(0,Hr.meetsProduct)(this.recalcDirty,(0,Jt.createCellSetFromRange)(r))},e.prototype.hasRecalcFailure=function(r){return(0,Hr.meetsProduct)(this.recalcFailures,(0,Jt.createCellSetFromRange)(r))},e.prototype.hasEditedEditTaint=function(r){return(0,Hr.meetsProduct)(this.editedTaint,(0,Jt.createCellSetFromRange)(r))},e.prototype.hasRecalcEditTaint=function(r){return(0,Hr.meetsProduct)(this.recalcTaint,(0,Jt.createCellSetFromRange)(r))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(r,t){var n=Jt.bspFactory.row((0,bR.pair)(r,t)),a=(0,pa.intersect)(this.hiddenRowsAvailability,n),o=[];(0,Jt.forEachRow)(a,function(s){var l=s[0],c=s[1];return o.push((0,cK.interval)(l,c)),!0});var u=[];return(0,Jt.forEachRow)((0,pa.intersect)(this.hiddenRows,a),function(s){var l=s[0],c=s[1];return u.push((0,cK.interval)(l,c)),!0}),{hidden:u,available:o}},e.prototype.tryGetHiddenRows=function(r,t){var n=this.getHiddenRows(r,t),a=n.available.length===1&&n.available[0].start===r&&n.available[0].end===t;return a?(0,cN.success)(n.hidden):(0,cN.failure)({kind:ZZ.UnavailableKind.HiddenRows})},e.prototype.setHiddenRows=function(r,t){var n=Jt.bspFactory.row((0,bR.pair)(r.row,r.row+r.rows));this.hiddenRows=(0,pa.union)((0,pa.except)(this.hiddenRows,n),(0,pa.intersect)(t,n)),this.hiddenRowsAvailability=(0,pa.union)(this.hiddenRowsAvailability,n)},e.prototype.getHiddenCols=function(r,t){var n=Jt.bspFactory.col((0,bR.pair)(r,t)),a=(0,pa.intersect)(this.hiddenColsAvailability,n),o=[];(0,Jt.forEachCol)(a,function(s){var l=s[0],c=s[1];return o.push((0,cK.interval)(l,c)),!0});var u=[];return(0,Jt.forEachCol)((0,pa.intersect)(this.hiddenCols,a),function(s){var l=s[0],c=s[1];return u.push((0,cK.interval)(l,c)),!0}),{hidden:u,available:o}},e.prototype.tryGetHiddenCols=function(r,t){var n=this.getHiddenCols(r,t),a=n.available.length===1&&n.available[0].start===r&&n.available[0].end===t;return a?(0,cN.success)(n.hidden):(0,cN.failure)({kind:ZZ.UnavailableKind.HiddenCols})},e.prototype.setHiddenCols=function(r,t){var n=Jt.bspFactory.col((0,bR.pair)(r.col,r.col+r.cols));this.hiddenCols=(0,pa.union)((0,pa.except)(this.hiddenCols,n),(0,pa.intersect)(t,n)),this.hiddenColsAvailability=(0,pa.union)(this.hiddenColsAvailability,n)},e.prototype.setMergeCell=function(r){this.mergeCells=this.mergeCells.setValue(r,!0)},e.prototype.getMergeCell=function(r){var t;return this.mergeCells.forEachGe(r,function(n){return t=n,!0}),t},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?(0,cN.success)(this.inFilterMode):(0,cN.failure)({kind:ZZ.UnavailableKind.InFilterMode})},e.prototype.setInFilterMode=function(r){this.inFilterMode=r,this.filterModeAvailable=!0},e.prototype.forEachNonBlankSetCellInSet=function(r,t,n,a){var o=(0,Hr.intersectProduct)(r,Jt.availableSetProduct);return(0,Jt.forEachRangeInSet)((0,Hr.intersectProduct)(n,o),function(u){return a.formulae.forEachMeets(u,function(s,l){return(0,br.isBlankGridFormula)(l.fmla,l.compiledFmla!==void 0)?!0:(0,Gm.forEachCellInRange)((0,Gm.gridRangeIsect)(u,s),t)})})},e.prototype.forEachReadableCellInSet=function(r,t,n){var a=(0,Hr.intersectProduct)(r,Jt.availableReadProduct);return(0,Jt.forEachRangeInSet)((0,Hr.intersectProduct)(n,a),function(o){return(0,Gm.forEachCellInRange)(o,t)})},e.prototype.forEachEditedNonBlankCellInSet=function(r,t){return this.forEachNonBlankSetCellInSet(r,t,this.editedAvailability,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(r,t){return this.forEachNonBlankSetCellInSet(r,t,this.serverAvailability,this.serverContents)},e.prototype.forEachEditedCellInSet=function(r,t){return this.forEachReadableCellInSet(r,t,this.editedAvailability)},e.prototype.promoteServerAvailability=function(r,t){var n=(0,Hr.intersectProduct)(r,Jt.availableSetProduct),a=this.oldAvailabilities[t];if(a===void 0)return!1;var o=(0,Hr.compareProduct)(a,n);return o!==void 0&&o>=0?(this.unionAvailability(!0,(0,Hr.intersectProduct)(r,Jt.availableAllProduct)),this.unionTaint(!0,pa.empty),this.unionUsed(!0,(0,Jt.cellSetBounds)(r)),!0):!1},e.prototype.extendServerUnused=function(r,t){var n=r===br.emptyUsedRange?pa.empty:(0,Jt.createCellSetFromRange)(r),a=(0,Hr.complementProduct)(n),o=this.serverContents,u=o.values,s=o.formats,l=o.styles,c=o.formulae,d=o.dirty;(0,Jt.forEachRangeInSet)(a,function(v){return u.forEachLe(v,function(h,y){return PI(y.oper,y.failure)||(u=u.setValue(h,br.blankGridValue)),!0}),s.forEachLe(v,function(h,y){return(0,br.isBlankCellFormat)(y)||(s=s.setValue(h,br.blankCellFormat)),!0}),l.forEachLe(v,function(h,y){return y!==vc.SpecialStyle.Blank&&(l=l.setValue(h,vc.SpecialStyle.Blank)),!0}),!0}),(0,Jt.forEachRangeInSet)(a,function(v){return c=YEe(c,v),!0}),d=(0,Hr.exceptProduct)(d,a),this.setContents(!0,{values:u,formats:s,styles:l,formulae:c,dirty:d},t);var f=(0,Hr.intersectProduct)(a,Jt.availableReadProduct);this.serverAvailability=this.editedAvailability=(0,Hr.unionProduct)(this.serverAvailability,f),this.editedTaint=this.recalcTaint=pa.empty;var m=this.serverUsed;m=dK(m,r),this.serverUsed=this.editedUsed=m},e.prototype.setRecalcFailure=function(r){this.recalcFailures=(0,Hr.unionProduct)(this.recalcFailures,r)},e.prototype.setRecalcEditTaint=function(r){this.recalcTaint=(0,Hr.unionProduct)(this.recalcTaint,r)},e.prototype.setRecalcValue=function(r,t){var n=this;(0,Gm.forEachCellInRange)(r,function(a,o,u){return n.recalcValues=n.recalcValues.setValue(a,{oper:QEe(t)?t[o][u]:t,failure:void 0}),!0}),this.recalcDirty=(0,Hr.exceptProduct)(this.recalcDirty,(0,Jt.createCellSetFromRange)(r))},e.prototype.setClientContents=function(r,t){this.clientContents=r},e.prototype.setClientValue=function(r,t,n){var a=this.clientContents.values;(0,Gm.forEachCellInRange)(r,function(o,u,s){return a=a.setValue(o,{oper:QEe(t)?t[u][s]:t,failure:void 0}),!0}),this.setClientContents(sv.__assign(sv.__assign({},this.clientContents),{values:a}),n)},e.prototype.setClientFormula=function(r,t,n,a){var o=this.clientContents.formulae;o=JEe(o,r),t!==void 0?o=o.setValue(t,n):(0,Gm.forEachCellInRange)(r,function(u){return o=o.setValue(u,n),!0}),this.setClientContents(sv.__assign(sv.__assign({},this.clientContents),{formulae:o}),a)},e.prototype.setClientFormat=function(r,t,n){var a=this.clientContents.formats;(0,Gm.forEachCellInRange)(r,function(o){return a=a.setValue(o,t),!0}),this.setClientContents(sv.__assign(sv.__assign({},this.clientContents),{formats:a}),n)},e.prototype.getRecalcValues=function(r){for(var t=r.row,n=r.col,a=r.rows,o=r.cols,u=new Array(a),s=0;s<a;s+=1)u[s]=(0,cbr.arrayFill)(new Array(o),br.blankGridValue);return this.recalcValues.forEachLe(r,function(l,c){return u[l.row-t][l.col-n]=c,!0}),u},e.prototype.forEachRecalcValue=function(r,t){return this.recalcValues.forEachMeets(r,t)},e.prototype.getClientValue=function(r){var t=this.clientContents.values.getValue(r);return t??br.blankGridValue},e.prototype.getServerValue=function(r){var t=this.serverContents.values.getValue(r);return t??br.blankGridValue},e.prototype.getEditedValue=function(r){var t=this.editedContents.values.getValue(r);return t??br.blankGridValue},e.prototype.forEachEditedValue=function(r,t){return this.editedContents.values.forEachMeets(r,t)},e.prototype.getServerFormula=function(r){return this.getFormula(r,this.serverContents.formulae)},e.prototype.getClientFormula=function(r){return this.getFormula(r,this.clientContents.formulae)},e.prototype.setEditedFormat=function(r,t){this.editedContents=sv.__assign(sv.__assign({},this.editedContents),{formats:this.editedContents.formats.setValue(r,t)})},e.prototype.getEditedFormat=function(r){var t=this.editedContents.formats.getValue(r);return t??br.blankCellFormat},e.prototype.forEachEditedFormat=function(r,t){return this.editedContents.formats.forEachMeets(r,t)},e.prototype.getServerFormat=function(r){var t=this.serverContents.formats.getValue(r);return t??br.blankCellFormat},e.prototype.getEditedStyle=function(r){var t=this.editedContents.styles.getValue(r);return t??vc.SpecialStyle.Blank},e.prototype.getServerStyle=function(r){var t=this.serverContents.styles.getValue(r);return t??vc.SpecialStyle.Blank},e.prototype.getClientFormat=function(r){var t=this.clientContents.formats.getValue(r);return t??br.blankCellFormat},e.prototype.getEditedFormula=function(r){return this.getFormula(r,this.editedContents.formulae)},e.prototype.forEachEditedFormula=function(r,t){return this.editedContents.formulae.forEachMeets(r,t)},e.prototype.getFormula=function(r,t){var n=void 0;return t.forEachGe(r,function(a,o){return(0,br.isBlankGridFormula)(o.fmla,o.compiledFmla!==void 0)?!0:(n=[a,o],!1)}),n},e.prototype.setContents=function(r,t,n){r&&(this.serverContents=t),this.editedContents=t,r&&this.setClientContents(this.editedContents,n),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=pa.empty},e.prototype.unionAvailability=function(r,t){var n=r?this.serverAvailability:this.editedAvailability;n=(0,Hr.unionProduct)(n,t),r&&(this.serverAvailability=n),this.editedAvailability=n},e.prototype.unionTaint=function(r,t){this.editedTaint=r?pa.empty:(0,Hr.unionProduct)(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(r,t){var n=r?this.serverUsed:this.editedUsed;n=e$(n,t),r&&(this.serverUsed=n),this.editedUsed=n},e.prototype.setCellContents=function(r,t,n,a,o,u,s,l,c){this.setCommon(r,t,void 0,n,a,o,u,s,l,c)},e.prototype.setRangeFormula=function(r,t,n,a,o,u,s,l){var c=(0,Jt.createCellSetFromRange)(t);this.setCommon(r,c,t,n,a,void 0,o,u,s,l)},e.prototype.setCommon=function(r,t,n,a,o,u,s,l,c,d){var f=this,m=r?this.serverContents:this.editedContents,v=m.values,h=m.formats,y=m.styles,_=m.formulae,E=m.dirty,N=a===void 0&&o!==void 0||(a==null?void 0:a.compiledFmla)!==void 0,k=a;a!==void 0&&((0,Jt.forEachRangeInSet)(t,function(W){return _=YEe(_,W),!0}),(0,br.isBlankGridFormula)(a.fmla,a.compiledFmla!==void 0)&&(k=void 0));var q=k!==void 0&&n===void 0?a:void 0,V=k!==void 0&&n!==void 0?a:void 0,I=o;o!==void 0&&PI(o,u)&&((0,Jt.forEachRangeInSet)(t,function(W){return v.forEachLe(W,function($,me){return PI(me.oper,me.failure)||(v=v.setValue($,br.blankGridValue)),!0}),!0}),E=N?(0,Hr.unionProduct)(E,t):(0,Hr.exceptProduct)(E,t),I=void 0);var M=I!==void 0?{oper:I,failure:u}:void 0,B=s;s!==void 0&&(0,br.isBlankCellFormat)(s)&&((0,Jt.forEachRangeInSet)(t,function(W){return h.forEachLe(W,function($,me){return(0,br.isBlankCellFormat)(me)||(h=h.setValue($,br.blankCellFormat)),!0}),!0}),B=void 0);var U=B===vc.SpecialFormat.Weak?void 0:B,j=B===vc.SpecialFormat.Weak?B:void 0,X=l;l!==void 0&&l===vc.SpecialStyle.Blank&&((0,Jt.forEachRangeInSet)(t,function(W){return y.forEachLe(W,function($,me){return me!==vc.SpecialStyle.Blank&&(y=y.setValue($,vc.SpecialStyle.Blank)),!0}),!0}),X=void 0);var ee=X===vc.SpecialStyle.Weak?void 0:X,re=X===vc.SpecialStyle.Weak?X:void 0,Z=t;if(!r){var J=(0,Hr.intersectProduct)(t,Jt.availableSetProduct),C=(0,Hr.project)((0,Hr.intersectProduct)(this.editedAvailability,J),"row","col"),S=(0,Hr.intersectProduct)(t,c!==void 0?(0,Jt.createCellSetFromRange)(c):pa.empty);Z=(0,Hr.unionProduct)(C,S)}if((q!==void 0||U!==void 0||ee!==void 0||M!==void 0)&&((0,Jt.forEachCellInSet)(Z,function(W){return q!==void 0&&(_=XEe(_,W,q)),U!==void 0&&(h=h.setValue(W,U)),ee!==void 0&&(y=y.setValue(W,ee)),M!==void 0&&(v=v.setValue(W,M)),!0}),(q!==void 0||M!==void 0)&&(E=N?(0,Hr.unionProduct)(E,Z):(0,Hr.exceptProduct)(E,Z))),V!==void 0){_=XEe(_,n,V);var b=(0,Jt.createCellSetFromRange)(n);E=N?(0,Hr.unionProduct)(E,b):(0,Hr.exceptProduct)(E,b)}j!==void 0&&(h=ZEe(h,Z,r?this.serverAvailability:this.editedAvailability,vc.SpecialFormat.Unavailable)),re!==void 0&&(y=pbr(y,Z,r?this.serverAvailability:this.editedAvailability));var O=o===void 0?pa.empty:Z,w=a===void 0?pa.empty:Z,D=s===void 0?pa.empty:Z,Q=o===void 0&&s===void 0?pa.empty:Z;r||((0,Jt.forEachRangeInSet)(O,function(W){return f.setClientValue(W,br.clientValueUnknownOper,d),!0}),a!==void 0&&(n!==void 0?this.setClientFormula(n,n,a,d):(0,Jt.forEachRangeInSet)(w,function(W){return f.setClientFormula(W,void 0,a,d),!0})),s===vc.SpecialFormat.Weak?this.setClientContents(sv.__assign(sv.__assign({},this.clientContents),{formats:ZEe(this.clientContents.formats,D,this.editedAvailability,vc.SpecialFormat.ClientValueUnknown)}),d):(0,Jt.forEachRangeInSet)(D,function(W){return f.setClientFormat(W,vc.SpecialFormat.ClientValueUnknown,d),!0})),this.setContents(r,{values:v,formats:h,styles:y,formulae:_,dirty:E},d),this.unionAvailability(r,(0,Hr.intersectProduct)(O,Jt.availableAllProduct)),r||(this.editedAvailability=(0,Hr.exceptProduct)(this.editedAvailability,(0,Hr.exceptProduct)(t,Z))),this.unionTaint(r,Q),this.unionUsed(r,(0,Jt.cellSetBounds)(t))},e.prototype.copyRange=function(r){function t(y,_){return y.forEachLe(r,function(E,N){return _=_.setValue(E,N),!0}),_}var n=RI.values,a=RI.formats,o=RI.styles,u=RI.formulae,s=this.editedContents,l=s.values,c=s.formats,d=s.styles,f=s.formulae;n=t(l,n),a=t(c,a),o=t(d,o),f.forEachMeets(r,function(y,_){return u=u.setValue((0,Gm.gridRangeIsect)(y,r),_),!0});var m=(0,Gm.gridRangeAnchor)(r),v=(0,Hr.intersectProduct)(this.editedAvailability,(0,Jt.createCellSetFromRange)(r)),h=dK(this.editedUsed,r);return{origin:m,formats:a,styles:o,values:n,formulae:u,availability:v,used:h}},e.prototype.pasteRange=function(r,t,n){var a=(0,Jt.createCellSetFromRange)(r),o=(0,vS.gridRange)(t.origin.row,t.origin.col,r.rows,r.cols),u=this.editedContents,s=u.values,l=u.formats,c=u.styles,d=u.formulae,f=u.dirty,m=this.editedUsed,v=r.row-t.origin.row,h=r.col-t.origin.col;function y(I){return(0,vS.gridRange)(I.row+v,I.col+h,I.rows,I.cols)}function _(I){return(0,Jt.translateAvailabilitySet)(I,v,h)}function E(I,M,B){return M.forEachMeets(r,function(U,j){return M=M.setValue(U,B),!0}),I.forEachLe(o,function(U,j){return M=M.setValue(y(U),j),!0}),M}var N=e$(m,t.used!==br.emptyUsedRange?y(t.used):br.emptyUsedRange),k=dK(N,r);s=E(t.values,s,br.blankGridValue),k!==br.emptyUsedRange&&this.setClientValue(k,br.clientValueUnknownOper,n),l=E(t.formats,l,br.blankCellFormat),c=E(t.styles,c,vc.SpecialStyle.Blank),k!==br.emptyUsedRange&&this.setClientFormat(k,vc.SpecialFormat.ClientValueUnknown,n),d=E(t.formulae,d,br.blankCellGridFormula),f=(0,Hr.exceptProduct)(f,a);{var q=this.clientContents.formulae;q=JEe(q,r),d.forEachLe(r,function(I,M){var B=M.origin,U=M.compiledFmla;return U!==void 0&&(f=(0,Hr.unionProduct)(f,(0,Jt.createCellSetFromRange)(I))),q=q.setValue(I,{fmla:fK.ClientValueUnknown,origin:B,compiledFmla:U,hasHyperlink:$Z.ClientValueUnknown}),!0}),this.setClientContents(sv.__assign(sv.__assign({},this.clientContents),{formulae:q}),n)}var V=!1;this.setContents(V,{values:s,formats:l,styles:c,formulae:d,dirty:f},n),this.editedAvailability=(0,Hr.exceptProduct)(this.editedAvailability,a),this.unionAvailability(V,_(t.availability)),this.unionTaint(V,k===br.emptyUsedRange?pa.empty:(0,Jt.createCellSetFromRange)(k)),this.unionUsed(V,N)},e.prototype.assumeRecalcFinal=function(r,t){this.recalcDirty=(0,Hr.exceptProduct)(this.recalcDirty,r)},e.prototype.getDirtyEditedCells=function(){return(0,Hr.intersectProduct)(this.recalcDirty,this.editedTaint)},e.prototype.getNonDirtyEditedCells=function(){return(0,Hr.exceptProduct)(this.editedTaint,this.recalcDirty)},e.prototype.getDirtyDependentCells=function(){return(0,Hr.exceptProduct)(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(r,t){var n=r?this.serverContents:this.editedContents;this.setContents(r,n,t),this.unionAvailability(r,pa.empty),this.unionTaint(r,pa.empty),this.unionUsed(r,br.emptyUsedRange)},e.prototype.clearCompiledFormulas=function(){for(var r=0,t=[this.serverContents.formulae,this.editedContents.formulae];r<t.length;r++){var n=t[r];n.forEach(function(a,o){return o.compiledFmla!==void 0&&o.compiledFmla.reset(),!0})}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverStylesNodeCount:this.serverContents.styles.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:(0,Hr.getSubspaceCount)(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedStylesNodeCount:this.editedContents.styles.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:(0,Hr.getSubspaceCount)(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:(0,Hr.getSubspaceCount)(this.recalcDirty),recalcFailuresSetSubspaceCount:(0,Hr.getSubspaceCount)(this.recalcFailures),recalcTaintSetSubspaceCount:(0,Hr.getSubspaceCount)(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:(0,Hr.getSubspaceCount)(this.editedAvailability),hiddenRowsNodeCount:(0,pa.getNodeCount)(this.hiddenRows)+(0,pa.getNodeCount)(this.hiddenRowsAvailability),hiddenColsNodeCount:(0,pa.getNodeCount)(this.hiddenCols)+(0,pa.getNodeCount)(this.hiddenColsAvailability)}},e.prototype.collectGarbage=function(r,t){var n=pa.empty;for(var a in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(a)){var o=Number(a);if(o>=r){n=(0,Hr.unionProduct)(n,this.oldAvailabilities[o]);continue}delete this.oldAvailabilities[o],this.availabilityHistorySize-=1}function u(m){return(0,Hr.meetsProduct)((0,Hr.intersectProduct)((0,Jt.createCellSetFromRange)(m),Jt.availableSetProduct),n)}function s(m,v){return!(0,br.isBlankGridFormula)(v.fmla,v.compiledFmla!==void 0)&&u(m)}function l(m,v){return!(0,br.isBlankCellFormat)(v)&&u(m)}function c(m,v){return v!==vc.SpecialStyle.Blank&&u(m)}function d(m,v){return!(!$Ee(v.oper)&&PI(v.oper,v.failure))&&u(m)}var f=(0,Hr.project)(n,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(s),formats:this.serverContents.formats.filter(l),styles:this.serverContents.styles.filter(c),values:this.serverContents.values.filter(d),dirty:(0,Hr.intersectProduct)(this.serverContents.dirty,f)},this.editedContents={formulae:this.editedContents.formulae.filter(s),formats:this.editedContents.formats.filter(l),styles:this.editedContents.styles.filter(c),values:this.editedContents.values.filter(d),dirty:(0,Hr.intersectProduct)(this.editedContents.dirty,f)},this.setClientContents({formulae:this.clientContents.formulae.filter(s),formats:this.clientContents.formats.filter(l),values:this.clientContents.values.filter(d)},t),this.recalcValues=this.recalcValues.filter(d),this.recalcDirty=(0,Hr.intersectProduct)(this.recalcDirty,f)},e}();br.PartialWorkbookGrid=gbr});var RR=T(Y=>{"use strict";p();var a_;Object.defineProperty(Y,"__esModule",{value:!0});Y.chNamedRangeData=Y.chNamedFormulaData=Y.chNamedValueData=Y.chNamedValue=Y.chUnusedCellsUpdate=Y.chArrayUpdate=Y.chArrayData=Y.chRangeUpdate=Y.chCellData=Y.chCellFormat=Y.chCellValue=Y.chError=Y.chBlank=Y.chSheetCellLocation=Y.chSheetRangeLocation=Y.chRangeLocation=Y.chCellLocation=Y.chCol=Y.chRow=Y.chSheetName=Y.chSheetId=Y.chNumberFormat=Y.chErrorTypeName=Y.chWorksheetFunctionName=Y.chFormulaText=Y.isFormulaText=Y.oneOfChecker=Y.eqChecker=Y.chArray=Y.chBoolean=Y.chNonemptyString=Y.chString=Y.chNatural=Y.chInteger=Y.chFiniteNumber=Y.chPossiblyInfiniteNumber=Y.chNever=Y.intChecker=Y.typeofChecker=Y.taggedUnionChecker=Y.arrayChecker=Y.depAllChecker=Y.allChecker=Y.objectChecker=Y.fromChecker=Y.optChecker=Y.filterCheck=Y.check=Y.checker=Y.incrementStat=void 0;Y.chReadOper=Y.chEvalFormulaFormat=Y.chWorkbookProps=Y.chLocaleData=Y.chPasteEdit=Y.chArrayFormulaEdit=Y.chRangeFormatEdit=Y.chRangeFormulaEdit=Y.chNamedObjectsUpdate=Y.chNamedObject=Y.chNamedObjectData=Y.chNamedFailureData=Y.chNamedTableScope=Y.chNamedTableData=Y.chColumnData=void 0;var vbr=Ar(),Ih=Ar(),CR=Eg(),AI=No(),xh=TF(),gK=Gi(),hbr=ti(),Sbr=Hf(),ybr=Dx();function nPe(e,r){var t;e[r]=((t=e[r])!==null&&t!==void 0?t:0)+1}Y.incrementStat=nPe;function dN(e,r,t){return e.push("".concat(r.join("."),": expected ").concat(t)),!1}function fo(e,r){return function(t,n,a){return(0,Ih.isDefined)(t)&&e(t)||dN(n,a,r)}}Y.checker=fo;function r$(e,r,t,n){for(var a=[],o=r(e,a,[n]),u=0,s=a;u<s.length;u++){var l=s[u];nPe(t,l)}return o}Y.check=r$;function _br(e,r,t,n){if(!r$(e,Y.chArray,t,n))return[];var a="".concat(n,".<index>");return e.filter(function(o){return r$(o,r,t,a)})}Y.filterCheck=_br;function An(e){return function(r,t,n){return(0,Ih.isNone)(r)?!0:e(r,t,n)}}Y.optChecker=An;function bbr(e){return function(r,t,n){return e(r,t,n)}}Y.fromChecker=bbr;function Gn(e){return function(r,t,n){if((0,Ih.isNone)(r))return dN(t,n,"non-null object");var a=n.length;try{var o=!0;for(var u in e)n[a]=u,o=o&&e[u](r[u],t,n);return o}finally{n.length=a}}}Y.objectChecker=Gn;function fN(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return function(t,n,a){return e.reduce(function(o,u){return o&&u(t,n,a)},!0)}}Y.allChecker=fN;function Nd(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return function(n,a,o){return r.reduce(function(u,s){return u&&s(n)(n,a,o)},e(n,a,o))}}Y.depAllChecker=Nd;function Af(e){return function(r,t,n){if(!Array.isArray(r))return dN(t,n,"Array");n.push("<index>");try{return r.reduce(function(a,o){return a&&e(o,t,n)},!0)}finally{n.pop()}}}Y.arrayChecker=Af;function wC(e){var r="one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(t,n,a){if((0,Ih.isNone)(t))return dN(n,a,"non-null object");var o=a.length;try{var u=typeof t.kind=="string"||typeof t.kind=="number"?e[t.kind]:void 0;return(0,Ih.isNone)(u)?(a.push("kind"),dN(n,a,r)):u(t,n,a)}finally{a.length=o}}}Y.taggedUnionChecker=wC;function vK(e){var r="typeof one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(t,n,a){var o=e[typeof t];return(0,Ih.isNone)(o)?dN(n,a,r):o(t,n,a)}}Y.typeofChecker=vK;function t$(e){return typeof e=="number"&&e>-(1/0)&&e<1/0}function Cbr(e){return typeof e=="number"&&!isNaN(e)}function aPe(e){return(e|0)===e||Math.floor(e)===e}function lv(e,r,t){return t===void 0&&(t=e!==0?"integer >= ".concat(e," and < ").concat(r):"natural < ".concat(r)),fo(function(n){return typeof n=="number"&&n>=e&&n<r&&aPe(n)},t)}Y.intChecker=lv;Y.chNever=fo(function(e){return!1},"never");Y.chPossiblyInfiniteNumber=fo(Cbr,"number (non-NaN)");Y.chFiniteNumber=fo(t$,"finite number");Y.chInteger=fo(function(e){return t$(e)&&aPe(e)},"integer");Y.chNatural=lv(0,1/0,"natural");Y.chString=fo(function(e){return typeof e=="string"},"string");Y.chNonemptyString=fo(function(e){return typeof e=="string"&&e.length>0},"nonempty string");Y.chBoolean=fo(function(e){return typeof e=="boolean"},"boolean");Y.chArray=fo(function(e){return Array.isArray(e)},"Array");function i_(e){return fo(function(r){return r===e},JSON.stringify(e))}Y.eqChecker=i_;function TR(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var t=Object.create(null),n=Object.create(null),a=0,o=e;a<o.length;a++){var u=o[a];typeof u=="number"?n[u]=!0:t[u]=!0}var s="one of ".concat(JSON.stringify(e.slice().sort()));return fo(function(l){switch(typeof l){case"string":case"symbol":return t[l]===!0;case"number":return n[l]===!0}return!1},s)}Y.oneOfChecker=TR;function n$(e){return e[0]==="="||e[0]==="+"||e[0]==="-"}Y.isFormulaText=n$;Y.chFormulaText=fo(function(e){return typeof e=="string"&&n$(e)},"formula text");Y.chWorksheetFunctionName=Gn({functionId:Y.chNatural,functionName:Y.chNonemptyString});var Tbr=fo(function(e){return typeof e=="string"&&e.length>1&&(0,Sbr.stringStartsWith)(e,"#")},"error name");Y.chErrorTypeName=Gn({errorType:Y.chNatural,errorName:Tbr});Y.chNumberFormat=Gn({iformat:Y.chNatural,formatString:Y.chString,builtIn:Y.chBoolean});Y.chSheetId=fo(function(e){return typeof e=="string"||t$(e)},"string or finite number");Y.chSheetName=Gn({sheetId:Y.chSheetId,sheetName:Y.chString});Y.chRow=lv(0,AI.sheetRows);Y.chCol=lv(0,AI.sheetCols);Y.chCellLocation=Gn({row:Y.chRow,column:Y.chCol});var Rbr=fo(function(e){return e.lastRow==null||e.lastRow>=e.row},"lastRow >= row"),Ebr=fo(function(e){return e.lastColumn==null||e.lastColumn>=e.column},"lastColumn >= column"),Pbr=fN(Y.chCellLocation,Gn({lastRow:An(Y.chRow),lastColumn:An(Y.chCol)}));Y.chRangeLocation=Nd(Pbr,function(e){return Rbr},function(e){return Ebr});Y.chSheetRangeLocation=fN(Y.chRangeLocation,Gn({sheetId:Y.chSheetId}));Y.chSheetCellLocation=fN(Y.chSheetRangeLocation,Gn({lastRow:An(Y.chNever),lastColumn:An(Y.chNever)}));Y.chBlank=Gn({kind:i_("Blank")});Y.chError=Gn({kind:i_("Error"),type:Y.chNatural});Y.chCellValue=vK({number:Y.chFiniteNumber,string:Y.chString,boolean:Y.chBoolean,object:wC({Blank:Y.chBlank,Error:Y.chError})});Y.chCellFormat=vK({number:Y.chNatural,string:Y.chString});Y.chCellData=fN(Gn({value:Y.chCellValue,iformat:Y.chNatural,failureReason:An(Y.chString)}),wC({CellFormula:Gn({formulaBarText:Y.chFormulaText}),ArrayFormula:Gn({formulaBarText:An(Y.chNever)}),Value:Gn({formulaBarText:Y.chString})}));Y.chRangeUpdate=Gn({range:Y.chSheetRangeLocation,excludeRows:An(Af(Y.chRow)),excludeColumns:An(Af(Y.chCol)),data:An(Y.chCellData),fromStateId:An(Y.chInteger)});Y.chArrayData=Gn({isSpilled:Y.chBoolean,formulaBarText:Y.chFormulaText});Y.chArrayUpdate=Gn({range:Y.chSheetRangeLocation,data:An(Y.chArrayData),fromStateId:An(Y.chInteger)});Y.chUnusedCellsUpdate=Gn({sheetId:Y.chSheetId,usedRange:An(Y.chRangeLocation)});Y.chNamedValue=vK({number:Y.chFiniteNumber,string:Y.chString,boolean:Y.chBoolean,object:wC({Error:Y.chError})});Y.chNamedValueData=Gn({kind:i_("NamedValue"),value:Y.chNamedValue});Y.chNamedFormulaData=Gn({kind:i_("NamedFormula"),formulaBarText:Y.chFormulaText});Y.chNamedRangeData=Gn({kind:i_("NamedRange"),range:Y.chSheetRangeLocation});Y.chColumnData=Gn({column:Y.chNatural,name:Y.chNonemptyString});var iPe=function(r){var t;return((t=r.lastRow)!==null&&t!==void 0?t:r.row)-r.row+1},oPe=function(r){var t;return((t=r.lastColumn)!==null&&t!==void 0?t:r.column)-r.column+1},Abr=fo(function(e){return(!e.hasHeadersRow||e.range.row>0)&&(!e.hasTotalsRow||e.range.row+iPe(e.range)<AI.sheetRows)},"enough rows for headers and totals"),Fbr=fo(function(e){var r=e.range.column,t=e.range.column+oPe(e.range);return e.columns.every(function(n){return n.column>=r&&n.column<t})},"column names in range");Y.chNamedTableData=Nd(Gn({kind:i_("NamedTable"),range:Y.chSheetRangeLocation,hasHeadersRow:Y.chBoolean,hasTotalsRow:Y.chBoolean,columns:Af(Y.chColumnData)}),function(e){return Abr},function(e){return Fbr});var Nbr=function(r){return fo(function(t){var n;return((n=t.data)===null||n===void 0?void 0:n.kind)!=="NamedTable"||r==null},"NamedTable at global scope")};Y.chNamedTableScope=Nbr;Y.chNamedFailureData=Gn({kind:i_("NamedFailure"),failureReason:Y.chString,objectKind:An(TR("NamedValue","NamedFormula","NamedRange","NamedTable"))});Y.chNamedObjectData=wC({NamedValue:Y.chNamedValueData,NamedFormula:Y.chNamedFormulaData,NamedRange:Y.chNamedRangeData,NamedTable:Y.chNamedTableData,NamedFailure:Y.chNamedFailureData});var Obr=Gn({name:Y.chString,data:An(Y.chNamedObjectData)}),kbr=function(r){return Nd(Obr,function(t){return(0,Y.chNamedTableScope)(r)})};Y.chNamedObject=kbr;Y.chNamedObjectsUpdate=Gn({scope:An(Y.chSheetId),objects:An(Y.chArray),fromStateId:An(Y.chInteger)});var Mbr=fo(function(e){return e.length>0},"a non-empty array"),xbr=fo(function(e){return e.every(function(r){return r.sheetId===e[0].sheetId})},"ranges on the same sheet"),uPe=Nd(Af(Y.chSheetRangeLocation),function(e){return Mbr},function(e){return xbr});Y.chRangeFormulaEdit=fN(Gn({range:uPe,origin:An(Y.chCellLocation),viewport:An(Y.chSheetRangeLocation)}),wC({CellFormula:Gn({formulaBarText:Y.chFormulaText,value:An(Y.chNever)}),Value:Gn({formulaBarText:Y.chString,value:Y.chCellValue}),Inferred:Gn({formulaBarText:Y.chString,value:An(Y.chNever)})}));var Ibr=wC({SetFormat:Gn({format:Y.chCellFormat}),RibbonFormat:Gn({ribbon:TR.apply(void 0,(0,Ih.strEnumArray)(ybr.RibbonFormat))}),ChangeDecimals:Gn({changeDecimals:lv(-20,20)})});Y.chRangeFormatEdit=Gn({range:uPe,operation:Ibr,origin:An(Y.chCellLocation),viewport:An(Y.chSheetRangeLocation)});Y.chArrayFormulaEdit=Gn({range:Y.chSheetRangeLocation,formulaBarText:fo(function(e){return typeof e=="string"&&(e.length===0||n$(e))},"empty string or text denoting formula"),origin:An(Y.chCellLocation),viewport:An(Y.chSheetRangeLocation)});var wbr=fo(function(e){var r=oPe(e.source),t=iPe(e.source);return e.target.column+r<=AI.sheetCols&&e.target.row+t<=AI.sheetRows},"(target,source) in range");Y.chPasteEdit=Nd(Gn({kind:TR("CopyPaste"),target:Y.chSheetCellLocation,source:Y.chSheetRangeLocation,viewport:An(Y.chSheetRangeLocation)}),function(e){return wbr});var Dbr=fo(function(e){return e.length===2},"2 AM/PM symbols"),ePe=fo(function(e){return e.length===7},"7 day symbols"),rPe=fo(function(e){return e.length===12},"12 month symbols");function FI(e){var r=(0,Ih.numEnumMap)(e,Ih.identity);return fo(function(t){return t.every(function(n,a){return n==null||a in r})},"indexes in enum")}var Lbr=FI(hbr.SpecialRefId),qbr=FI(gK.PictureSpecial),Gbr=FI(gK.PictureSingle),Bbr=FI(gK.PictureColor),Ubr=FI(gK.PictureDbnum);Y.chLocaleData=Gn({worksheetFunctionNames:Y.chArray,thousandsData:Af(Y.chNatural),errorTypeNames:Y.chArray,specialRefNames:Nd(Af(An(Y.chNonemptyString)),function(e){return Lbr}),trueName:Y.chNonemptyString,falseName:Y.chNonemptyString,rowLetter:Y.chNonemptyString,columnLetter:Y.chNonemptyString,leftBrace:Y.chNonemptyString,rightBrace:Y.chNonemptyString,leftBracket:Y.chNonemptyString,rightBracket:Y.chNonemptyString,decimalSeparator:Y.chNonemptyString,listSeparator:Y.chNonemptyString,columnSeparator:Y.chNonemptyString,rowSeparator:Y.chNonemptyString,thousandsSeparator:Y.chString,lcid:Y.chNatural,country:Y.chNatural,numberDecimals:Y.chNatural,isExpSepBySpace:Y.chBoolean,fractionSeparator:Y.chNonemptyString,isPercentSepBySpace:Y.chBoolean,currencyFormat:TR(xh.CurrencyFormat.Paren,xh.CurrencyFormat.Lead,xh.CurrencyFormat.Intern,xh.CurrencyFormat.Trail),isCurrencySymbolLead:Y.chBoolean,isCurrencySepBySpace:Y.chBoolean,currencySymbol:Y.chString,currencyDecimals:Y.chNatural,dateOrder:TR(xh.DateOrder.MDY,xh.DateOrder.DMY,xh.DateOrder.YMD,xh.DateOrder.MYD,xh.DateOrder.DYM,xh.DateOrder.YDM),dateSeparator:Y.chString,dateAltSeparator:Y.chString,year4Digits:Y.chBoolean,month2Digits:Y.chBoolean,day2Digits:Y.chBoolean,longDateFormat:Y.chBoolean,timeSeparator:Y.chString,timeAltSeparator:An(Y.chString),hour2Digits:Y.chBoolean,clock24Hour:Y.chBoolean,isAMPMSepBySpace:Y.chBoolean,ampmSymbols:Nd(Af(Y.chString),function(e){return Dbr}),dayNameShort:Nd(Af(Y.chString),function(e){return ePe}),dayNameLong:Nd(Af(Y.chString),function(e){return ePe}),monthNameShort:Nd(Af(Y.chString),function(e){return rPe}),monthNameLong:Nd(Af(Y.chString),function(e){return rPe}),pictureSpecial:Nd(Af(An(Y.chNonemptyString)),function(e){return qbr}),pictureSingle:Nd(Af(An(Y.chNonemptyString)),function(e){return Gbr}),pictureColor:Nd(Af(An(Y.chNonemptyString)),function(e){return Bbr}),pictureDbnum:Nd(Af(An(Y.chNonemptyString)),function(e){return Ubr}),sysDateFormat:Y.chString,sysTimeFormat:Y.chString});var tPe=Gn({yr:Y.chInteger,mon:lv(1,13),dom:lv(1,6),wdy:lv(1,8),hour:lv(0,24),min:lv(0,60),sec:lv(0,60),fracSec:i_(0),rounding:lv(0,4)}),Kbr=Nd(Gn({bias:Y.chFiniteNumber,standardDate:An(tPe),standardBias:Y.chFiniteNumber,daylightDate:An(tPe),daylightBias:Y.chFiniteNumber}),function(e){return fo(function(r){return(0,Ih.isNone)(r.standardDate)===(0,Ih.isNone)(r.daylightDate)},"standardDate iff daylightDate")});Y.chWorkbookProps=Gn({date1904:An(Y.chBoolean),dateCompatibility:An(Y.chBoolean),timezone:An(Kbr)});Y.chEvalFormulaFormat=An(wC({Origin:Gn({iformat:An(Y.chNever),knownFormat:An(Y.chNever)}),Iformat:Gn({iformat:Y.chNatural,knownFormat:An(Y.chNever)}),Known:Gn({iformat:An(Y.chNever),knownFormat:TR.apply(void 0,(0,vbr.numEnumArray)(xh.KnownFormat))}),Inferred:Gn({iformat:An(Y.chNever),knownFormat:An(Y.chNever)}),Aggregate:Gn({iformat:An(Y.chNever),knownFormat:An(Y.chNever)})}));var Vbr=(a_={},a_[CR.OperKind.Number]=!0,a_[CR.OperKind.String]=!0,a_[CR.OperKind.Boolean]=!0,a_[CR.OperKind.Error]=!0,a_[CR.OperKind.Array]=!1,a_[CR.OperKind.Blank]=!0,a_[CR.OperKind.Rich]=!1,a_);Y.chReadOper=fo(function(e){return Vbr[e.kind]},"supported ReadOper")});var a$=T(cv=>{"use strict";p();Object.defineProperty(cv,"__esModule",{value:!0});cv.enumerateKeysInOrder=cv.enumerateInOrder=cv.RootPointer=cv.ArrayMapTree=cv.floorToPowerOf2=void 0;var NI=pr();cv.floorToPowerOf2=NI.arrayMapTree.floorToPowerOf2;cv.ArrayMapTree=NI.arrayMapTree.ArrayMapTree;cv.RootPointer=NI.arrayMapTree.RootPointer;cv.enumerateInOrder=NI.arrayMapTree.enumerateInOrder;cv.enumerateKeysInOrder=NI.arrayMapTree.enumerateKeysInOrder});var hc=T(hS=>{"use strict";p();Object.defineProperty(hS,"__esModule",{value:!0});hS.getTimeImpl=hS.VolatileMode=hS.asyncLazy=hS.ResettableLazy=void 0;var hK=Ba(),OI=zn(),i$=Ss(),o_=UM(),o$=Us(),pN=qi(),sPe=function(){function e(r){this.valueCreationFunc=r,this.value=void 0}return e.prototype.getValue=function(){return this.value===void 0&&(this.value=this.valueCreationFunc()),this.value},e.prototype.force=function(){this.value===void 0&&(this.value=this.valueCreationFunc())},e.prototype.reset=function(){this.value=void 0},e}();hS.ResettableLazy=sPe;function jbr(e){return new sPe(e)}hS.asyncLazy=jbr;var ER;(function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"})(ER||(hS.VolatileMode=ER={}));var Wbr=function(){return new Date};function Hbr(e,r,t,n,a){switch(n===void 0&&(n=ER.Estimation),a===void 0&&(a=Wbr),n){case ER.PrecisionTest:return(0,OI.failure)((0,pN.unavailable)([{kind:i$.UnavailableKind.GetTimeKind,getTimeKind:t}]));case ER.Estimation:switch(t){case o$.GetTimeKind.NonVolatile:return(0,OI.failure)((0,pN.unavailable)([{kind:i$.UnavailableKind.GetTimeKind,getTimeKind:t}]));case o$.GetTimeKind.ValueCell:case o$.GetTimeKind.Volatile:break}break;case ER.GroundTruth:break}var o=e.mathpack,u=e.datepack,s=a(),l=u.utcToLocal(e,(0,o_.dateTime)(s.getUTCFullYear(),s.getUTCMonth()+1,s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCDay()+1,s.getUTCMilliseconds(),o_.Rounding.Round1000ths),e.timezone);(0,hK.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: to local",l!==!1);var c=l.yr,d=l.rounding,f=1,m=l.mon,v=l.dom,h=l.hour,y=l.min,_=l.sec,E=l.fracSec;r<o_.TimeGranularity.Instant&&(E=0,_=0,y=0,h=0),r<o_.TimeGranularity.Day&&(v=1,m=1);var N=(0,o_.dateTime)(c,m,v,h,y,_,f,E,d),k=u.toNum(e,N);(0,hK.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,pN.isErrorOper)(k));var q=o.toNumber(k);if(n===ER.GroundTruth)return(0,OI.success)(k);var V=u.toNum(e,l);(0,hK.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,pN.isErrorOper)(V));var I=o.toNumber(V),M;switch(r){case o_.TimeGranularity.Instant:M=I;break;case o_.TimeGranularity.Day:M=q+1;break;case o_.TimeGranularity.Year:{var B=(0,o_.dateTime)(c+1,m,v,h,y,_,f,E,d),U=u.toNum(e,B);(0,hK.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: toNum",!(0,pN.isErrorOper)(U)),M=o.toNumber(U);break}}var j=.006944444444444444;return I<q+j||I>M-j?(0,OI.failure)((0,pN.unavailable)([{kind:i$.UnavailableKind.TimeGranularity,granularity:r}])):(0,OI.success)(k)}hS.getTimeImpl=Hbr});var yK=T(SK=>{"use strict";p();Object.defineProperty(SK,"__esModule",{value:!0});SK.RedBlackMapTree=void 0;var zbr=pr();SK.RedBlackMapTree=zbr.rbMapTree.RedBlackMapTree});var MI=T(Xs=>{"use strict";p();Object.defineProperty(Xs,"__esModule",{value:!0});Xs.PartialWorkbookNames=Xs.isNamedTableRangeEqual=Xs.mergeNameStatistics=Xs.emptyNameStatistics=Xs.namedFailure=Xs.namedFormula=Xs.mergeNamedTables=Xs.namedTable=Xs.namedRange=Xs.namedValue=void 0;var _K=fe(),Qbr=a$(),SS=No(),bK=Ar(),Xbr=hc(),u$=yK(),Bm=zn(),DC=ti(),kI=qi(),Ybr=Ba(),lPe=_R(),Jbr=Ss();Xs.namedValue=(0,bK.typedInstanceCreator)()(function(e){return{kind:"NamedValue",value:e}});Xs.namedRange=(0,bK.typedInstanceCreator)()(function(e){return{kind:"NamedRange",value:e}});var Zbr=u$.RedBlackMapTree.create(function(e,r){return e-r});function $br(e,r,t,n,a){var o,u=e.sheet,s=e.range,l=r?(0,SS.gridRange)(s.row-1,s.col,1,s.cols):void 0,c=t?(0,SS.gridRange)(s.row+s.rows,s.col,1,s.cols):void 0,d=(0,kI.gridRangeJoinOpt)((0,kI.gridRangeJoinOpt)(l,e.range),c),f=n.reduce(function(h,y){return(0,Ybr.assertTrue)("calc.calc.namedTable: column names in range",y.column>=e.range.col&&y.column<e.range.col+e.range.cols),h.setValue(y.column,y.name)},Zbr),m=u$.RedBlackMapTree.create(a);f.forEach(function(h,y){return m=m.setValue(y,h),!0});var v=f.getCount()===e.range.cols;return{kind:"NamedTable",specialRefRanges:(o={},o[DC.SpecialRefId.Data]=e,o[DC.SpecialRefId.Headers]=l?(0,SS.sheetGridRange)(u,l):void 0,o[DC.SpecialRefId.Totals]=c?(0,SS.sheetGridRange)(u,c):void 0,o[DC.SpecialRefId.All]=(0,SS.sheetGridRange)(u,d),o),columnNames:m,columnIndexes:f,allColumnNamesAvailable:v,hasHeadersRow:r,hasTotalsRow:t}}Xs.namedTable=$br;function eCr(e,r){var t=e.columnNames,n=e.columnIndexes;r.columnIndexes.forEach(function(o,u){var s=e.columnIndexes.getValue(o);return s!==void 0&&(t=t.remove(s)),!0}),r.columnIndexes.forEach(function(o,u){return t=t.setValue(u,o),n=n.setValue(o,u),!0});var a=n.getCount()===r.specialRefRanges[DC.SpecialRefId.All].range.cols;return _K.__assign(_K.__assign({},r),{columnNames:t,columnIndexes:n,allColumnNamesAvailable:a})}Xs.mergeNamedTables=eCr;Xs.namedFormula=(0,bK.typedInstanceCreator)()(function(e){return{kind:"NamedFormula",fmla:e}});Xs.namedFailure=(0,bK.typedInstanceCreator)()(function(e,r){return{kind:"NamedFailure",failureReason:e,objectKind:r}});var rCr=(0,lPe.makeGridRangeTable)(),tCr=(0,lPe.makeGridRangeTable)();Xs.emptyNameStatistics={namesCount:0,tablesCount:0,rangesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};function nCr(e,r){return{namesCount:e.namesCount+r.namesCount,tablesCount:e.tablesCount+r.tablesCount,rangesCount:e.rangesCount+r.rangesCount,recalcFailuresCount:e.recalcFailuresCount+r.recalcFailuresCount,scopes:e.scopes+r.scopes,allAvailableScopes:e.allAvailableScopes+r.allAvailableScopes}}Xs.mergeNameStatistics=nCr;function aCr(e,r){return(0,kI.isSheetGridRangeEqual)(e.specialRefRanges[DC.SpecialRefId.Data],r.specialRefRanges[DC.SpecialRefId.Data])&&e.hasHeadersRow===r.hasHeadersRow&&e.hasTotalsRow===r.hasTotalsRow}Xs.isNamedTableRangeEqual=aCr;var iCr=function(){function e(r,t,n,a){this.names=r,this.allAvailable=t,this.tables=n,this.ranges=a}return e.create=function(r){return new e(u$.RedBlackMapTree.create(r),!1,rCr,tCr)},e.prototype.update=function(r,t,n,a){return r!==this.names||t!==this.allAvailable||n!==this.tables||a!==this.ranges?new e(r,t,n,a):this},e.prototype.getEntry=function(r,t,n){var a=this.names.getEntry(t);return a===void 0?this.allAvailable?(0,Bm.success)(void 0):(0,Bm.failure)((0,kI.unavailable)([{kind:Jbr.UnavailableKind.NameLoc,name:(0,SS.nameLoc)(r,t),source:n}])):(0,Bm.success)(a.value!==!1?a:void 0)},e.prototype.getEntryIfDefined=function(r){var t=this.names.getEntry(r);if(t!==void 0)return t.value!==!1?t:void 0},e.prototype.setValue=function(r,t){return this.update(this.names.setValue(r,t),this.allAvailable,this.tables,this.ranges)},e.prototype.remove=function(r){return this.update(this.allAvailable?this.names.remove(r):this.names.setValue(r,!1),this.allAvailable,this.tables,this.ranges)},e.prototype.getContainingTable=function(r){var t;return this.tables.forEachGe(r,function(n,a){return t=a,!1}),t},e.prototype.getIntersectingTables=function(r){var t=[];return this.tables.forEachMeets(r,function(n,a){return t.push(a),!0}),t},e.prototype.getNamedRanges=function(r){var t;return(t=this.ranges.getValue(r))!==null&&t!==void 0?t:[]},e.prototype.getAvailableNames=function(r){var t=[];return this.names.forEach(function(n,a){return a!==!1&&t.push((0,SS.nameLoc)(r,n)),!0}),t},e.prototype.forEachAvailableName=function(r){return this.names.forEach(function(t,n){return r(t,n===!1?void 0:n)})},e.prototype.setUndefined=function(){return this.update(this.names,!0,this.tables,this.ranges)},e.prototype.getStatistics=function(r){return{namesCount:this.names.getCount(),tablesCount:this.tables.getCount(),rangesCount:this.ranges.getCount(),recalcFailuresCount:r,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.update(this.allAvailable?this.names.filter(function(r,t){return t!==!1}):this.names,this.allAvailable,this.tables,this.ranges)},e.prototype.resetLazyData=function(){this.names.forEach(function(r,t){return t!==!1&&t.lazyData.reset(),!0})},e.prototype.onWriteNamedTable=function(r,t,n){var a=t.specialRefRanges[DC.SpecialRefId.All].range;return this.update(this.names,this.allAvailable,n==="remove"?this.tables.remove(a):this.tables.setValue(a,r),this.ranges)},e.prototype.onWriteNamedRange=function(r,t,n){var a,o=t.value.ranges[0],u=(a=this.ranges.getValue(o))!==null&&a!==void 0?a:[],s=n==="remove"?u.filter(function(l){return(0,kI.isNameScopeEqual)(r.scope,l.scope)&&r.name===l.name}):_K.__spreadArray(_K.__spreadArray([],u,!0),[r],!1);return this.update(this.names,this.allAvailable,this.tables,s.length===0?this.ranges.remove(o):this.ranges.setValue(o,s))},e}(),oCr=function(){function e(r,t){this.stringCompareCI=r,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=iCr.create(r),this.emptyRecalcFailures=this.recalcFailures=Qbr.ArrayMapTree.create(r)}return e.prototype.clone=function(){var r=new e(this.stringCompareCI,this.scope);return r.contents=this.contents,r},e.prototype.advanceState=function(r){this.oldContents=this.contents,this.oldStateId=this.isCurrent?r:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(r){this.oldStateId===void 0||this.oldStateId<r?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(r,t){var n=this.contents.getEntry(this.scope,r,t);return(0,Bm.isSuccess)(n)?(0,Bm.success)(n.value!==void 0?(0,SS.nameLoc)(this.scope,n.value.key):void 0):n},e.prototype.getNameFormula=function(r,t){var n=this.contents.getEntry(this.scope,r,t);return(0,Bm.isSuccess)(n)?(0,Bm.success)(n.value!==void 0?n.value.value:void 0):n},e.prototype.getContainingTable=function(r){return this.contents.getContainingTable(r)},e.prototype.getIntersectingTables=function(r){return this.contents.getIntersectingTables(r)},e.prototype.getNamedRanges=function(r){return this.contents.getNamedRanges(r)},e.prototype.allAvailable=function(){return this.contents.allAvailable},e.prototype.getAvailableNames=function(r){return this.contents.getAvailableNames(r)},e.prototype.hasRecalcFailure=function(r){return this.recalcFailures.contains(r)},e.prototype.setRecalcFailure=function(r){this.recalcFailures=this.recalcFailures.setValue(r,!0)},e.prototype.onCellModified=function(r){this.recalcFailures=this.emptyRecalcFailures},e.prototype.resetLazyData=function(){this.contents.resetLazyData(),this.oldContents!==this.contents&&this.oldContents.resetLazyData()},e.prototype.setNamedObject=function(r,t,n,a,o){var u=this.contents.getEntryIfDefined(t.name);if(u!==void 0){var s=o((0,SS.nameLoc)(this.scope,u.key),u.value.obj,"remove");if(s.kind===Bm.ResultKind.Failure)return s}if(n===void 0?this.contents=this.contents.remove(t.name):this.contents=this.contents.setValue(t.name,{obj:n,lazyData:new Xbr.ResettableLazy(function(){return a(r,t,n)})}),this.isCurrent=this.isChanged=!0,n!==void 0){var s=o(t,n,"add");if(s.kind===Bm.ResultKind.Failure)return s}return Bm.successUndefined},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(r,t){var n=this;if(this.isChanged||r!==this.oldStateId)return(0,Bm.success)(!1);this.contents=this.oldContents,this.isCurrent=!0;var a=(0,Bm.success)(!0);return this.contents.forEachAvailableName(function(o,u){if(u===void 0)return!0;var s=t((0,SS.nameLoc)(n.scope,o),u.obj,"add");return s.kind===Bm.ResultKind.Success?!0:(a=s,!1)}),a},e.prototype.onWriteNamedTable=function(r,t,n){this.contents=this.contents.onWriteNamedTable(r,t,n)},e.prototype.onWriteNamedRange=function(r,t,n){this.contents=this.contents.onWriteNamedRange(r,t,n)},e.prototype.forEachAvailableName=function(r){return this.contents.forEachAvailableName(r)},e}();Xs.PartialWorkbookNames=oCr});var dPe=T(mN=>{"use strict";p();Object.defineProperty(mN,"__esModule",{value:!0});mN.entry=mN.makeEmptyTable=void 0;var cPe=pr();mN.makeEmptyTable=cPe.table.makeEmptyTable;mN.entry=cPe.table.entry});var c$=T(RK=>{"use strict";p();Object.defineProperty(RK,"__esModule",{value:!0});RK.PartialWorkbookNameManager=void 0;var wh=No(),s$=Ar(),Ka=zn(),fPe=ti(),CK=qi(),uCr=Ba(),xI=MI(),TK=kA(),sCr=dPe(),l$=Ss(),lCr=function(){function e(r,t,n,a,o){var u=this;this.document=r,this.stringCompareCI=t,this.sheetScopedNames=n,this.oldSheetScopedNames=a,this.onWriteNamedObject=function(s,l,c){if(l.kind==="NamedRange"){var d=l.value;(0,uCr.assertTrue)("calc.calc.PartialWorkbookDocument.onWriteNamedObject: bad range",(0,CK.isDocumentLocEqual)(l.value.sheets.document,s.scope.document));var f=u.getNamesBySheetId(d.sheets.index);if(f.kind===Ka.ResultKind.Failure)return f;f.value.onWriteNamedRange(s,l,c)}if(l.kind==="NamedTable"){var f=u.getNamesBySheetId(l.specialRefRanges[fPe.SpecialRefId.All].sheet.index);if(f.kind===Ka.ResultKind.Failure)return f;f.value.onWriteNamedTable(s,l,c)}return Ka.successUndefined},this.globalNames=o??new xI.PartialWorkbookNames(t,(0,wh.documentScope)(r))}return e.prototype.clone=function(){var r;if(this.sheetScopedNames){r=(0,s$.makeStringMap)();for(var t in this.sheetScopedNames){var n=this.sheetScopedNames[t];r[t]=n.clone()}}return new e(this.document,this.stringCompareCI,r,void 0,this.globalNames.clone())},e.prototype.setNamedObject=function(r,t,n,a){var o=this.getNameFormula(t,wh.NameSource.StructRef);n!==void 0&&n.kind==="NamedTable"&&(0,Ka.isSuccess)(o)&&o.value!==void 0&&o.value.obj.kind==="NamedTable"&&(0,xI.isNamedTableRangeEqual)(o.value.obj,n)&&(n=(0,xI.mergeNamedTables)(o.value.obj,n));var u=this.getNamesBySheetId(t.scope.index);return u.kind===Ka.ResultKind.Failure?u:u.value.setNamedObject(r,t,n,a,this.onWriteNamedObject)},e.prototype.setUndefinedNames=function(r){var t=this.getNamesBySheetId(r.index);return t.kind===Ka.ResultKind.Failure?t:(0,Ka.success)(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(r,t){var n=this.getNamesBySheetId(r.index);return n.kind===Ka.ResultKind.Failure?n:n.value.promoteNamedObjects(t,this.onWriteNamedObject)},e.prototype.setSheetNames=function(r){for(var t,n,a=(t=this.sheetScopedNames)!==null&&t!==void 0?t:this.oldSheetScopedNames,o=(0,s$.makeStringMap)(),u=0,s=r;u<s.length;u++){var l=s[u].sheetId;o[l]=(n=a==null?void 0:a[l])!==null&&n!==void 0?n:new xI.PartialWorkbookNames(this.stringCompareCI,(0,wh.sheetIndex)(this.document,l))}return new e(this.document,this.stringCompareCI,o,void 0,this.globalNames)},e.prototype.getNameLoc=function(r,t,n){var a=this.getNamesBySheetId(r);if(a.kind===Ka.ResultKind.Failure)return a;var o=a.value.getNameLoc(t,n);return o.kind===Ka.ResultKind.Failure,o},e.prototype.getAvailableNamesInScope=function(r){var t=this.getAllDocumentNames(),n=this.getNamesBySheetId(r);return n.kind===Ka.ResultKind.Success&&(0,s$.safePush)(t,n.value.getAvailableNames((0,wh.nameScope)(this.document,r))),t},e.prototype.getAllDocumentNames=function(){return this.globalNames.getAvailableNames((0,wh.documentScope)(this.document))},e.prototype.getAvailableTableColumns=function(r){var t=this.getNameFormula(r,wh.NameSource.StructRef),n=[];if(t.kind!==Ka.ResultKind.Success||t.value===void 0||t.value.obj.kind!=="NamedTable")return{cols:n,isPartial:!0};var a=!t.value.obj.allColumnNamesAvailable;return t.value.obj.columnNames.forEach(function(o){return n.push(o),!0}),{cols:n,isPartial:a}},e.prototype.getNameFormula=function(r,t){var n=this.getNamesBySheetId(r.scope.index);return n.kind===Ka.ResultKind.Failure?n:n.value.getNameFormula(r.name,t)},e.prototype.hasRecalcNameFailure=function(r){var t=this.getNamesBySheetId(r.scope.index);return t.kind===Ka.ResultKind.Failure?t:(0,Ka.success)(t.value.hasRecalcFailure(r.name))},e.prototype.setRecalcNameFailure=function(r){var t=this.getNamesBySheetId(r.scope.index);return t.kind===Ka.ResultKind.Failure?t:(0,Ka.success)(t.value.setRecalcFailure(r.name))},e.prototype.getNamesBySheetId=function(r){if(r===void 0)return(0,Ka.success)(this.globalNames);if(!this.sheetScopedNames)return(0,Ka.failure)((0,CK.unavailable)([{kind:l$.UnavailableKind.SheetNames}]));var t=this.sheetScopedNames[r];return t===void 0?(0,Ka.failure)((0,CK.unavailable)([{kind:l$.UnavailableKind.SheetId,document:this.document,sheetId:r}])):(0,Ka.success)(t)},e.prototype.getContainingTable=function(r){var t=this.getNamesBySheetId(r.sheet.index);return t.kind===Ka.ResultKind.Failure?t:(0,Ka.success)(t.value.getContainingTable(r.range))},e.prototype.getNamedRanges=function(r){var t=this.getNamesBySheetId(r.sheet.index);return t.kind===Ka.ResultKind.Failure?t:(0,Ka.success)(t.value.getNamedRanges(r.range))},e.prototype.getIntersectingTables=function(r){var t=this.getNamesBySheetId(r.sheet.index);return t.kind===Ka.ResultKind.Failure?t:(0,Ka.success)(t.value.getIntersectingTables(r.range))},e.prototype.getStructRefColumn=function(r,t){var n=this.getNameFormula(r,wh.NameSource.StructRef);if(n.kind===Ka.ResultKind.Failure)return n;if(n.value===void 0)return(0,Ka.success)(void 0);if(n.value.obj.kind!=="NamedTable")return(0,Ka.failure)((0,TK.invalidStructRef)(TK.InvalidStructRefReason.NamedObjectNotTable));var a=n.value.obj,o;if(typeof t=="string")o=a.columnNames.getEntry(t);else{var u=a.columnIndexes.getValue(t);o=u===void 0?void 0:(0,sCr.entry)(u,t)}if(o===void 0)return a.allColumnNamesAvailable?(0,Ka.success)(void 0):(0,Ka.failure)((0,CK.unavailable)([{kind:l$.UnavailableKind.ColumnName,table:r,columnNameOrIndex:t}]));var s=a.specialRefRanges[fPe.SpecialRefId.Data],l=s.sheet,c=s.range,d=(0,wh.sheetGridRange)(l,(0,wh.gridRange)(c.row,o.value,c.rows,1));return(0,Ka.success)((0,wh.structRefColumnLoc)(o.key,d,a.hasHeadersRow,a.hasTotalsRow))},e.prototype.getStructRefSpecialRef=function(r,t){var n=this.getNameFormula(r,wh.NameSource.StructRef);return n.kind===Ka.ResultKind.Failure?n:n.value===void 0?(0,Ka.success)(void 0):n.value.obj.kind!=="NamedTable"?(0,Ka.failure)((0,TK.invalidStructRef)(TK.InvalidStructRefReason.NamedObjectNotTable)):(0,Ka.success)(n.value.obj.specialRefRanges[t])},e.prototype.onCellModified=function(r){this.forEachSheetScope(function(t){t.onCellModified(r)}),this.globalNames.onCellModified(r)},e.prototype.collectGarbage=function(r){this.forEachSheetScope(function(t){t.collectGarbage(r)}),this.globalNames.collectGarbage(r)},e.prototype.advanceState=function(r){this.forEachSheetScope(function(t){t.advanceState(r)}),this.globalNames.advanceState(r),this.oldSheetScopedNames=this.sheetScopedNames,this.sheetScopedNames=void 0},e.prototype.resetLazyData=function(){this.forEachSheetScope(function(r){r.resetLazyData()}),this.globalNames.resetLazyData()},e.prototype.getNameStatistics=function(){var r=this.globalNames.getStatistics();return this.forEachSheetScope(function(t){return r=(0,xI.mergeNameStatistics)(r,t.getStatistics())}),r},e.prototype.forEachSheetScope=function(r){for(var t in this.sheetScopedNames)if(Object.prototype.hasOwnProperty.call(this.sheetScopedNames,t)){var n=this.sheetScopedNames[t];r(n)}},e}();RK.PartialWorkbookNameManager=lCr});var f$=T(AK=>{"use strict";p();Object.defineProperty(AK,"__esModule",{value:!0});AK.PartialWorkbookSheets=void 0;var pPe=fe(),cCr=a$(),d$=Ar(),mPe=No(),u_=zn(),EK=qi(),PK=Ss(),dCr=function(){function e(r,t,n,a,o,u){this.document=r,this.stringCompareCI=t,this.sheetPosToId=n,this.sheetNameToId=a,this.data=o,this.oldData=u}return e.prototype.clone=function(){return new e(this.document,this.stringCompareCI,this.sheetPosToId,this.sheetNameToId,this.data,void 0)},e.prototype.setSheetNames=function(r){for(var t,n=(t=this.data)!==null&&t!==void 0?t:this.oldData,a=(0,d$.makeStringMap)(),o=[],u=[],s=0;s<r.length;s+=1){var l=r[s],c=l.sheetName,d=l.sheetId;o[s]=d,u.push([c,d]);var f=n==null?void 0:n[d];if(f===void 0){var m=(0,mPe.sheetIndex)(this.document,d);a[d]={pos:s,name:c,sheetIndex:m}}else a[d]=pPe.__assign(pPe.__assign({},f),{pos:s,name:c})}var v=cCr.ArrayMapTree.create(this.stringCompareCI).setValues(u);return new e(this.document,this.stringCompareCI,o,v,a,void 0)},e.prototype.advanceState=function(r){this.oldData=this.data,this.sheetPosToId=void 0,this.sheetNameToId=void 0,this.data=void 0},e.prototype.getSheetRangeIds=function(r){var t,n;if(!this.sheetPosToId)return(0,u_.failure)((0,EK.unavailable)([{kind:PK.UnavailableKind.SheetNames}]));if(r.index===void 0)t=0,n=this.sheetPosToId.length;else{var a=this.getSheetById(r.index);if(!(0,u_.isSuccess)(a))return a;var o=this.getSheetById(r.index2);if(!(0,u_.isSuccess)(o))return o;t=(0,d$.fastMin)(a.value.pos,o.value.pos),n=(0,d$.fastMax)(a.value.pos,o.value.pos)+1}for(var u=[],s=t;s<n;s+=1)u.push(this.sheetPosToId[s]);return(0,u_.success)((0,mPe.sheetRangeIndexes)(u,t))},e.prototype.getSheetById=function(r){if(!this.data)return(0,u_.failure)((0,EK.unavailable)([{kind:PK.UnavailableKind.SheetNames}]));var t=this.data[r];return t===void 0?(0,u_.failure)((0,EK.unavailable)([{kind:PK.UnavailableKind.SheetId,document:this.document,sheetId:r}])):(0,u_.success)(t)},e.prototype.getSheetByName=function(r){if(!this.sheetNameToId)return(0,u_.failure)((0,EK.unavailable)([{kind:PK.UnavailableKind.SheetNames}]));var t=this.sheetNameToId.getValue(r);return t===void 0?(0,u_.success)(void 0):this.getSheetById(t)},e.prototype.forEachSheet=function(r){if(!(!this.sheetPosToId||!this.data))for(var t=0,n=this.sheetPosToId;t<n.length;t++){var a=n[t],o=this.data[a];o&&r(o,a)}},e}();AK.PartialWorkbookSheets=dCr});var vPe=T(OK=>{"use strict";p();Object.defineProperty(OK,"__esModule",{value:!0});OK.PartialWorkbookDocument=void 0;var gN=qi(),gPe=Ar(),vN=n_(),FK=Zc(),PR=Ss(),je=zn(),NK=Pf(),fCr=c$(),pCr=f$(),mCr=function(){function e(r,t,n,a,o,u,s,l){o===void 0&&(o=new pCr.PartialWorkbookSheets(r,t)),l===void 0&&(l=new fCr.PartialWorkbookNameManager(r,t)),this.document=r,this.stringCompareCI=t,this.formats=n,this.styles=a,this.sheets=o,this.grids=u,this.oldGrids=s,this.nameManager=l}return e.prototype.clone=function(r){r===void 0&&(r=vN.CloningTarget.Server);var t;if(this.grids){t=(0,gPe.makeStringMap)();for(var n in this.grids){var a=this.grids[n];t[n]=a.clone(r)}}return new e(this.document,this.stringCompareCI,this.formats.clone(),this.styles.clone(),this.sheets.clone(),t,void 0,this.nameManager.clone())},e.prototype.getReadonlyNameManager=function(){return this.nameManager},e.prototype.getReadonlySheets=function(){return this.sheets},e.prototype.setClientValue=function(r,t,n){var a=this.getGridById(r.sheet.index);return a.kind===je.ResultKind.Failure?a:(0,je.success)(a.value.setClientValue(r.range,t,n))},e.prototype.setClientFormula=function(r,t,n){var a=this.getGridById(r.sheet.index);return a.kind===je.ResultKind.Failure?a:(0,je.success)(a.value.setClientFormula(r.range,r.range,t,n))},e.prototype.setRecalcFailure=function(r,t){var n=this.getGridById(r);return n.kind===je.ResultKind.Failure?n:(0,je.success)(n.value.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(r,t){var n=this.getGridById(r);return n.kind===je.ResultKind.Failure?n:(0,je.success)(n.value.setRecalcEditTaint(t))},e.prototype.setRecalcValue=function(r,t){var n=this.getGridById(r.sheet.index);return n.kind===je.ResultKind.Failure?n:(0,je.success)(n.value.setRecalcValue(r.range,t))},e.prototype.setEditedFormat=function(r,t){var n=this.getGridById(r.sheet.index);return n.kind===je.ResultKind.Failure?n:(0,je.success)(n.value.setEditedFormat(r.range,t))},e.prototype.setClientFormat=function(r,t,n){var a=this.getGridById(r.sheet.index);return a.kind===je.ResultKind.Failure?a:(0,je.success)(a.value.setClientFormat(r.range,t,n))},e.prototype.setHiddenRows=function(r,t,n){var a=this.getGridById(r);return a.kind===je.ResultKind.Failure?a:(0,je.success)(a.value.setHiddenRows(t,n))},e.prototype.setHiddenCols=function(r,t,n){var a=this.getGridById(r);return a.kind===je.ResultKind.Failure?a:(0,je.success)(a.value.setHiddenCols(t,n))},e.prototype.setMergeCell=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.setMergeCell(r.range))},e.prototype.setInFilterMode=function(r,t){var n=this.getGridById(r);return n.kind===je.ResultKind.Failure?n:(0,je.success)(n.value.setInFilterMode(t))},e.prototype.setCellContents=function(r,t,n,a,o,u,s,l,c){var d=this.getGridById(t.sheet.index);if(d.kind===je.ResultKind.Failure)return d;var f=l!==void 0&&(0,gN.isSheetIndexEqual)(t.sheet,l.sheet)?l.range:void 0;return(0,je.success)(d.value.setCellContents(r,t.set,n,a,o,u,s,f,c))},e.prototype.setRangeFormula=function(r,t,n,a,o,u,s,l){var c=this.getGridById(t.sheet.index);if(c.kind===je.ResultKind.Failure)return c;var d=s!==void 0&&(0,gN.isSheetIndexEqual)(t.sheet,s.sheet)?s.range:void 0;return(0,je.success)(c.value.setRangeFormula(r,t.range,n,a,o,u,d,l))},e.prototype.copyRange=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.copyRange(r.range))},e.prototype.pasteRange=function(r,t,n){var a=this.getGridById(r.sheet.index);return a.kind===je.ResultKind.Failure?a:(0,je.success)(a.value.pasteRange(r.range,t,n))},e.prototype.assumeRecalcFinal=function(r,t){var n=this.getGridById(r.sheet.index);return n.kind===je.ResultKind.Failure?n:(0,je.success)(n.value.assumeRecalcFinal(r.set,t))},e.prototype.getDirtyEditedCells=function(){var r=[];return this.forEachSheet(function(t,n){return void r.push((0,PR.sheetCellSet)(t.sheetIndex,n.getDirtyEditedCells()))}),r},e.prototype.getNonDirtyEditedCells=function(){var r=[];return this.forEachSheet(function(t,n){return void r.push((0,PR.sheetCellSet)(t.sheetIndex,n.getNonDirtyEditedCells()))}),r},e.prototype.getDirtyDependentCells=function(){var r=[];return this.forEachSheet(function(t,n){return void r.push((0,PR.sheetCellSet)(t.sheetIndex,n.getDirtyDependentCells()))}),r},e.prototype.setNamedObject=function(r,t,n,a){return this.nameManager.setNamedObject(r,t,n,a)},e.prototype.setUndefinedNames=function(r){return this.nameManager.setUndefinedNames(r)},e.prototype.promoteNamedObjects=function(r,t){return this.nameManager.promoteNamedObjects(r,t)},e.prototype.setSheetNames=function(r){for(var t,n,a=(t=this.grids)!==null&&t!==void 0?t:this.oldGrids,o=(0,gPe.makeStringMap)(),u=0,s=r;u<s.length;u++){var l=s[u].sheetId;o[l]=(n=a==null?void 0:a[l])!==null&&n!==void 0?n:vN.PartialWorkbookGrid.create()}return new e(this.document,this.stringCompareCI,this.formats,this.styles,this.sheets.setSheetNames(r),o,void 0,this.nameManager.setSheetNames(r))},e.prototype.extendServerUnused=function(r,t,n){var a=this.getGridById(r);return a.kind===je.ResultKind.Failure?a:(0,je.success)(a.value.extendServerUnused(t,n))},e.prototype.promoteServerAvailability=function(r,t,n){var a=this.getGridById(r);return a.kind===je.ResultKind.Failure?a:(0,je.success)(a.value.promoteServerAvailability(t,n))},e.prototype.getNameLoc=function(r,t,n){return this.nameManager.getNameLoc(r,t,n)},e.prototype.getNameFormula=function(r,t){return this.nameManager.getNameFormula(r,t)},e.prototype.hasRecalcNameFailure=function(r){return this.nameManager.hasRecalcNameFailure(r)},e.prototype.setRecalcNameFailure=function(r){return this.nameManager.setRecalcNameFailure(r)},e.prototype.getContainingTable=function(r){var t=this.nameManager.getContainingTable(r);if(t.kind===je.ResultKind.Failure||t.value!==void 0)return t;var n=this.getGridById(r.sheet.index);if(n.kind===je.ResultKind.Failure)return(0,je.failure)((0,gN.unavailable)([n.reason]));var a=(0,NK.intersectProduct)((0,FK.createCellSetFromRange)(r.range),FK.availableSetProduct);return(0,NK.meetsProduct)(a,n.value.getServerAvailability())?je.successUndefined:(0,je.failure)((0,gN.unavailable)([{kind:PR.UnavailableKind.ContainingTable,range:r}]))},e.prototype.getNamedRanges=function(r){var t=this.nameManager.getNamedRanges(r);if(t.kind===je.ResultKind.Failure||t.value!==void 0)return t;var n=this.getGridById(r.sheet.index);if(n.kind===je.ResultKind.Failure)return(0,je.failure)((0,gN.unavailable)([n.reason]));var a=(0,NK.intersectProduct)((0,FK.createCellSetFromRange)(r.range),FK.availableSetProduct);return(0,NK.meetsProduct)(a,n.value.getServerAvailability())?(0,je.success)([]):(0,je.failure)((0,gN.unavailable)([{kind:PR.UnavailableKind.NamedRanges,range:r}]))},e.prototype.getIntersectingTables=function(r){return this.nameManager.getIntersectingTables(r)},e.prototype.getStructRefColumn=function(r,t){return this.nameManager.getStructRefColumn(r,t)},e.prototype.getStructRefSpecialRef=function(r,t){return this.nameManager.getStructRefSpecialRef(r,t)},e.prototype.getEditedFormula=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getEditedFormula(r.range))},e.prototype.forEachEditedFormula=function(r,t){var n=this.getGridById(r.sheet.index);return n.kind===je.ResultKind.Failure?n:(0,je.success)(n.value.forEachEditedFormula(r.range,t))},e.prototype.getEditedValue=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getEditedValue(r.range))},e.prototype.forEachEditedValue=function(r,t){var n=this.getGridById(r.sheet.index);return n.kind===je.ResultKind.Failure?n:(0,je.success)(n.value.forEachEditedValue(r.range,t))},e.prototype.getEditedFormat=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getEditedFormat(r.range))},e.prototype.forEachEditedFormat=function(r,t){var n=this.getGridById(r.sheet.index);return n.kind===je.ResultKind.Failure?n:(0,je.success)(n.value.forEachEditedFormat(r.range,t))},e.prototype.getEditedStyle=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getEditedStyle(r.range))},e.prototype.isInFilterMode=function(r){var t=this.getGridById(r);return t.kind===je.ResultKind.Failure?t:t.value.isInFilterMode()},e.prototype.getHiddenRows=function(r,t,n){var a=this.getGridById(r);return a.kind===je.ResultKind.Failure?vN.hiddennessFullyUnavailable:a.value.getHiddenRows(t,n)},e.prototype.tryGetHiddenRows=function(r,t,n){var a=this.getGridById(r);return a.kind===je.ResultKind.Failure?a:a.value.tryGetHiddenRows(t,n)},e.prototype.getHiddenCols=function(r,t,n){var a=this.getGridById(r);return a.kind===je.ResultKind.Failure?vN.hiddennessFullyUnavailable:a.value.getHiddenCols(t,n)},e.prototype.tryGetHiddenCols=function(r,t,n){var a=this.getGridById(r);return a.kind===je.ResultKind.Failure?a:a.value.tryGetHiddenCols(t,n)},e.prototype.getMergeCell=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getMergeCell(r.range))},e.prototype.getServerFormat=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getServerFormat(r.range))},e.prototype.getServerStyle=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getServerStyle(r.range))},e.prototype.getClientFormat=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getClientFormat(r.range))},e.prototype.getClientValue=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getClientValue(r.range))},e.prototype.getRecalcValues=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getRecalcValues(r.range))},e.prototype.forEachRecalcValue=function(r,t){var n=this.getGridById(r.sheet.index);return n.kind===je.ResultKind.Failure?n:(0,je.success)(n.value.forEachRecalcValue(r.range,t))},e.prototype.getServerValue=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getServerValue(r.range))},e.prototype.getServerFormula=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getServerFormula(r.range))},e.prototype.getClientFormula=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getClientFormula(r.range))},e.prototype.getServerUsedRange=function(r){var t=this.getGridById(r);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getServerUsedRange())},e.prototype.allServerAvailable=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.allServerAvailable(r.range))},e.prototype.allEditedAvailable=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.allEditedAvailable(r.range))},e.prototype.forEachRecalcDirty=function(r,t){var n=this.getGridById(r.sheet.index);return n.kind===je.ResultKind.Failure?n:(0,je.success)(n.value.forEachRecalcDirty(r.range,t))},e.prototype.hasRecalcDirty=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.hasRecalcDirty(r.range))},e.prototype.hasRecalcFailure=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.hasRecalcFailure(r.range))},e.prototype.hasEditedEditTaint=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.hasEditedEditTaint(r.range))},e.prototype.hasRecalcEditTaint=function(r){var t=this.getGridById(r.sheet.index);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.hasRecalcEditTaint(r.range))},e.prototype.forEachEditedNonBlankCellInSet=function(r,t,n){var a=this.getGridById(r);return a.kind===je.ResultKind.Failure?a:(0,je.success)(a.value.forEachEditedNonBlankCellInSet(t,n))},e.prototype.forEachServerNonBlankCellInSet=function(r,t,n){var a=this.getGridById(r);return a.kind===je.ResultKind.Failure?a:(0,je.success)(a.value.forEachServerNonBlankCellInSet(t,n))},e.prototype.forEachEditedCellInSet=function(r,t,n){var a=this.getGridById(r);return a.kind===je.ResultKind.Failure?a:(0,je.success)(a.value.forEachEditedCellInSet(t,n))},e.prototype.getSheetIndex=function(r){var t=this.sheets.getSheetByName(r);return t.kind===je.ResultKind.Failure||t.value===void 0?t:(0,je.success)(t.value.sheetIndex)},e.prototype.getSheetName=function(r){var t=this.sheets.getSheetById(r);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.name)},e.prototype.getEditedUsedRange=function(r){var t=this.getGridById(r);return t.kind===je.ResultKind.Failure?t:(0,je.success)(t.value.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(r){return this.sheets.getSheetRangeIds(r)},e.prototype.getIformat=function(r){return this.formats.getIformat(r)},e.prototype.getIformats=function(){return this.formats.getIformats()},e.prototype.getKnownFormat=function(r){return this.formats.getKnownFormat(r)},e.prototype.getFormatString=function(r){return this.formats.getFormatString(r)},e.prototype.resolveCellStyle=function(r){return this.styles.resolveCellStyle(r)},e.prototype.setNumberFormats=function(r,t){this.formats.setNumberFormats(r,t)},e.prototype.setStyles=function(r,t){this.styles.setStyles(r,t)},e.prototype.setFonts=function(r,t){this.styles.setFonts(r,t)},e.prototype.setFills=function(r,t){this.styles.setFills(r,t)},e.prototype.setBorders=function(r,t){this.styles.setBorders(r,t)},e.prototype.onCellModified=function(r,t){this.forEachSheet(function(n,a){a.onCellModified(r,t)}),this.nameManager.onCellModified(r)},e.prototype.collectGarbage=function(r,t){this.forEachSheet(function(n,a){a.collectGarbage(r,t)}),this.nameManager.collectGarbage(r)},e.prototype.advanceState=function(r,t){this.forEachSheet(function(n,a){a.advanceState(r,t)}),this.nameManager.advanceState(r),this.sheets.advanceState(r),this.oldGrids=this.grids,this.grids=void 0},e.prototype.clearCompiledFormulas=function(){this.forEachSheet(function(r,t){t.clearCompiledFormulas()}),this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){this.formats.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){var r=vN.emptyGridStatistics;return this.forEachSheet(function(t,n){return r=(0,vN.mergeGridStatistics)(r,n.getStatistics())}),r},e.prototype.getNameStatistics=function(){return this.nameManager.getNameStatistics()},e.prototype.getServerAvailableCells=function(){var r=[];return this.forEachSheet(function(t,n){r.push({sheetIdx:t.sheetIndex,availableCells:n.getServerAvailability()})}),r},e.prototype.forEachSheet=function(r){var t=this.grids;t&&this.sheets.forEachSheet(function(n,a){var o=t[a];o&&r(n,o)})},e.prototype.getGridById=function(r){var t=this.grids;if(!t)return(0,je.failure)({kind:PR.UnavailableKind.SheetNames});var n=t[r];return n===void 0?(0,je.failure)({kind:PR.UnavailableKind.SheetId,document:this.document,sheetId:r}):(0,je.success)(n)},e}();OK.PartialWorkbookDocument=mCr});var p$=T(kK=>{"use strict";p();Object.defineProperty(kK,"__esModule",{value:!0});kK.getWorksheetFunc=void 0;var gCr=ov();kK.getWorksheetFunc=gCr.getWorksheetFuncModule.getWorksheetFunc});var xK=T(yS=>{"use strict";p();Object.defineProperty(yS,"__esModule",{value:!0});yS.kindAnonymizers=yS.anonymizeMagnitude=yS.anonymizeFormulaString=yS.anonymize=void 0;var MK=pr();yS.anonymize=MK.anonymizer.anonymize;yS.anonymizeFormulaString=MK.anonymizer.anonymizeFormulaString;yS.anonymizeMagnitude=MK.anonymizer.anonymizeMagnitude;yS.kindAnonymizers=MK.anonymizer.kindAnonymizers});var hPe=T(IK=>{"use strict";p();Object.defineProperty(IK,"__esModule",{value:!0});IK.adjustFormulaOrigin=void 0;var vCr=qr();IK.adjustFormulaOrigin=vCr.adjust.adjustFormulaOrigin});var SPe=T(DK=>{"use strict";p();Object.defineProperty(DK,"__esModule",{value:!0});DK.PartialWorkbookFormats=void 0;var m$=Ar(),wK=zn(),hCr=Ss(),SCr=function(){function e(r){this.iformats=[],this.formatStrings=(0,m$.makeStringMap)(),this.knownFormats=r}return e.prototype.clone=function(){var r=this,t=new e(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach(function(n){t.iformats[n]=r.iformats[n]}),Object.keys(this.formatStrings).forEach(function(n){t.formatStrings[n]=r.formatStrings[n]}),t},e.prototype.clearCompiledNumberFormats=function(){var r=this;this.iformats.forEach(function(t){t.compiledFormat.reset()}),Object.keys(this.knownFormats).map(function(t){return Number(t)}).forEach(function(t){r.knownFormats[t].reset()}),this.formatStrings=(0,m$.makeStringMap)(),Object.keys(this.iformats).map(Number).forEach(function(t){var n=r.iformats[t];r.formatStrings[n.formatString]=t})},e.prototype.getIformat=function(r){var t=this.iformats[r];return t===void 0?(0,wK.failure)({kind:hCr.UnavailableKind.NumberFormat,iformat:r}):(0,wK.success)(t.compiledFormat)},e.prototype.getIformats=function(){return this.iformats},e.prototype.getKnownFormat=function(r){return(0,wK.success)(this.knownFormats[r])},e.prototype.getFormatString=function(r){return(0,wK.success)(this.formatStrings[r])},e.prototype.setNumberFormats=function(r,t){var n=this;t||(this.iformats=[],this.formatStrings=(0,m$.makeStringMap)()),Object.keys(r).map(Number).forEach(function(a){var o=n.iformats[a];o!==void 0&&delete n.formatStrings[o.formatString];var u=r[a];n.iformats[a]=u,n.formatStrings[u.formatString]=a})},e}();DK.PartialWorkbookFormats=SCr});var g$=T(Ff=>{"use strict";p();Object.defineProperty(Ff,"__esModule",{value:!0});Ff.VerticalAlignment=Ff.PatternType=Ff.HorizontalAlignment=Ff.FontVerticalAlignment=Ff.FontUnderline=Ff.FillKind=Ff.BorderLineType=void 0;var AR=qr();Ff.BorderLineType=AR.styleServiceTypes.BorderLineType;Ff.FillKind=AR.styleServiceTypes.FillKind;Ff.FontUnderline=AR.styleServiceTypes.FontUnderline;Ff.FontVerticalAlignment=AR.styleServiceTypes.FontVerticalAlignment;Ff.HorizontalAlignment=AR.styleServiceTypes.HorizontalAlignment;Ff.PatternType=AR.styleServiceTypes.PatternType;Ff.VerticalAlignment=AR.styleServiceTypes.VerticalAlignment});var v$=T(_S=>{"use strict";p();Object.defineProperty(_S,"__esModule",{value:!0});_S.PartialWorkbookStyles=_S.blankStyleValue=void 0;var hN=zn(),FR=g$(),II=Ss(),LK={type:FR.BorderLineType.None,color:{argb:"00000000"}};_S.blankStyleValue={font:{name:"Calibri",bold:!1,italic:!1,underline:FR.FontUnderline.None,strikethrough:!1,verticalAlign:FR.FontVerticalAlignment.None,size:11,color:{argb:"ff000000"}},fill:{kind:FR.FillKind.Pattern,pattern:FR.PatternType.None,fgColor:{argb:"00000000"},bgColor:{argb:"00000000"}},border:{top:LK,bottom:LK,left:LK,right:LK},alignment:{horizontal:FR.HorizontalAlignment.Automatic,vertical:FR.VerticalAlignment.Bottom,textRotation:0,wrapText:!1,indent:0,relativeIndent:0,shrinkToFit:!1,readingOrder:0}};var yCr=function(){function e(){this.styles=[],this.fonts=[],this.fills=[],this.borders=[]}return e.prototype.clone=function(){function r(n,a){Object.keys(n).map(Number).forEach(function(o){return void(a[o]=n[o])})}var t=new e;return r(this.styles,t.styles),r(this.fonts,t.fonts),r(this.fills,t.fills),r(this.borders,t.borders),t},e.prototype.resolveCellStyle=function(r){if(r===II.SpecialStyle.Blank)return(0,hN.success)(_S.blankStyleValue);var t=this.styles[r];if(t===void 0)return(0,hN.failure)({kind:II.UnavailableKind.StyleId,styleId:r});var n=t.fontId,a=t.fillId,o=t.borderId,u=t.alignment,s=n!==void 0?this.fonts[n]:_S.blankStyleValue.font;if(s===void 0)return(0,hN.failure)({kind:II.UnavailableKind.FontId,fontId:n});var l=a!==void 0?this.fills[a]:_S.blankStyleValue.fill;if(l===void 0)return(0,hN.failure)({kind:II.UnavailableKind.FillId,fillId:a});var c=o!==void 0?this.borders[o]:_S.blankStyleValue.border;return c===void 0?(0,hN.failure)({kind:II.UnavailableKind.BorderId,borderId:o}):(0,hN.success)({font:s,fill:l,border:c,alignment:u})},e.prototype.setStyles=function(r,t){var n=this;t||(this.styles=[]),Object.keys(r).map(Number).forEach(function(a){return void(n.styles[a]=r[a])})},e.prototype.setFonts=function(r,t){var n=this;t||(this.fonts=[]),Object.keys(r).map(Number).forEach(function(a){return void(n.fonts[a]=r[a])})},e.prototype.setFills=function(r,t){var n=this;t||(this.fills=[]),Object.keys(r).map(Number).forEach(function(a){return void(n.fills[a]=r[a])})},e.prototype.setBorders=function(r,t){var n=this;t||(this.borders=[]),Object.keys(r).map(Number).forEach(function(a){return void(n.borders[a]=r[a])})},e}();_S.PartialWorkbookStyles=yCr});var b$=T(xR=>{"use strict";p();Object.defineProperty(xR,"__esModule",{value:!0});xR.PartialWorkbookDocumentCollection=xR.voidCallback=void 0;var _Cr=fe(),bCr=vPe(),Za=No(),yPe=qi(),Nr=qi(),qK=Gi(),Dh=n_(),GK=_y(),wI=Zc(),Od=Ss(),Mi=Ss(),CCr=tF(),DI=rF(),Sc=uv(),_Pe=$A(),TCr=cx(),RCr=WZ(),ECr=ti(),PCr=ti(),jl=ti(),NR=hc(),OR=Qf(),ACr=p$(),SN=Ar(),kR=Ba(),FCr=HZ(),NCr=CG(),h$=TG(),bPe=xK(),OCr=hPe(),dv=Us(),kCr=oU(),CPe=xY(),_$=Eg(),z=zn(),MCr=kA(),xCr=pr(),yN=TF(),ICr=MI(),wCr=SPe(),TPe=aU(),DCr=Hf(),RPe=ks(),LCr=v$(),S$=Dx(),qCr=mi(),MR=(0,Za.gridCell)(0,0),GCr=function(e){_Cr.__extends(r,e);function r(){var t=e.call(this,void 0)||this;return t.fns=[],t}return r.prototype.wsfNode=function(t){this.fns.push((0,qK.englishWorksheetFuncIdToName)(t))},r.prototype.operatorNode=function(t){this.fns.push((0,qK.englishOperatorIdToName)(t))},r}(RPe.ConstVisitor);function BCr(e){var r=new GCr;return(0,RPe.reduceBottomUp)(r,e),r.fns}var y$=(0,GK.precedents)([],[],[],_$.SpecialPrecs.None,GK.PrecsBound.Exact);xR.voidCallback={onNameFailure:function(){},onRangeFailure:function(){},onNumberFormatFailure:function(){},onInferFormatFailure:function(){},onUnavailableObject:function(){},onUnavailable:function(){},onSetCellValue:function(){},onSetCellValues:function(){},onReturnCellValue:function(){}};var UCr=function(){function e(r,t,n,a,o,u){var s=this;this.cb=t,this.schedulerConfig=n,this.limits=a,this.maxDereferenceCells=o,this.isServerWorkbookLoad=u,this.renderBlanksAsZerosEnabled=(0,qCr.isChangeGateEnabled)("OfficeVSO:7042222_renderBlanksAsZeros"),this.random=new xCr.JSF32(Math.random()*4294967296),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.version=0,this.interruptToken=[Sc.Interrupt.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.compileNamedObject=function(l,c,d){var f=l?Mi.FormulaMode.ServerNamedFormula:Mi.FormulaMode.EditNamedFormula;switch(d.kind){case"NamedFormula":{var m=d.fmla,v=s.parser.parseFormula((0,_Pe.parseLocals)(Za.LexicalKind.NameManager,MR),m);(0,kR.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",l);var h=l&&s.isServerWorkbookLoad,y=(0,DI.analyzeLocalsName)((0,Za.originCell)((0,Za.documentScope)(s.documentLoc),MR),void 0,h),_=v,E=s.checkFormula(y,_,m,f);return s.compileFormula((0,Sc.compileLocalsName)(MR),E)}case"NamedValue":case"NamedRange":case"NamedTable":{var v=void 0,N;if(d.kind==="NamedRange"){var k=d.value;(0,kR.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",(0,Nr.isDocumentLocEqual)(d.value.sheets.document,c.scope.document));var q=k.sheets,V=s.getDocument(q.document);if(!(0,z.isSuccess)(V))return s.cb.onUnavailableObject(V.reason),(0,z.failure)((0,Nr.unavailable)([V.reason]));var I=V.value.getSheetName(q.index);if(!(0,z.isSuccess)(I))return s.cb.onUnavailable(I.reason),I;var M=d.value.ranges[0];v=(0,jl.formula)((0,jl.cellRefNode)((0,jl.cellRefRange)((0,jl.cellRefSingle)((0,jl.pos)(jl.PosKind.Abs,M.row),(0,jl.pos)(jl.PosKind.Abs,M.col)),(0,jl.cellRefSingle)((0,jl.pos)(jl.PosKind.Abs,M.row+M.rows-1),(0,jl.pos)(jl.PosKind.Abs,M.col+M.cols-1))),(0,jl.sheetQualifier)(I.value)),[],[],1),N=(0,Za.sheetGridCell)(q,MR)}else d.kind==="NamedTable"?(v=(0,jl.formula)((0,jl.structRefNode)((0,jl.nameNode)((0,ECr.identNamePart)(c.name)),(0,jl.structRef)(void 0)),[],[],1),N=(0,Za.originCell)((0,Za.documentScope)(s.documentLoc),MR)):(v=(0,jl.formula)((0,jl.literalNode)(d.value,!0),[],[],1),N=(0,Za.originCell)((0,Za.documentScope)(s.documentLoc),MR));var E=s.analyzer.checkFormula((0,DI.analyzeLocalsName)(N),v);return!(0,z.isSuccess)(E)||!(0,Nr.isWellFormed)(E.value)?(0,kR.assertFalse)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula ".concat((0,h$.anonymizeFormula)(s.config,v,(0,Za.lexicalSourceName)(c)))):s.compileFormula((0,Sc.compileLocalsName)(MR),(0,z.success)(E.value))}case"NamedFailure":return(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.ClientFailure,reason:d.failureReason}]));default:return(0,kR.assertNever)("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",d)}},this.config=r,this.parser=(0,TCr.createParser)(this),this.printer=(0,h$.createPrinter)(this),this.analyzer=(0,CCr.createAnalyzer)(this),this.formatter=(0,kCr.createNumberFormatter)(this),this.compiler=(0,RCr.createCompiler)(this),this.evaluator=(0,FCr.createEvaluator)(this)}return e.prototype.clone=function(r,t){var n;r===void 0&&(r=xR.voidCallback),t===void 0&&(t=Dh.CloningTarget.Server);var a=new e(this.config,r,this.schedulerConfig,this.limits,this.maxDereferenceCells,this.isServerWorkbookLoad);return a.documentLoc=this.documentLoc,a.document=(n=this.document)===null||n===void 0?void 0:n.clone(t),a.worksheetFuncOverrides=this.worksheetFuncOverrides,a.userDefinedFuncOverrides=this.userDefinedFuncOverrides,a.version=this.version,a},e.prototype.compareVersion=function(r){return this.version===r.version},e.prototype.getSingleReadonlyDocument=function(){return this.document},e.prototype.reconfigure=function(r,t,n,a){this.schedulerConfig=r,this.limits=t,this.maxDereferenceCells=n,this.isServerWorkbookLoad=a,this.advanceVersion()},e.prototype.setConfig=function(r){this.config=r},e.prototype.forEachDocument=function(r){this.document!==void 0&&r(this.document)},e.prototype.getDocumentLoc=function(r,t){var n=this.documentLoc;return n!==void 0&&(r===void 0||r===n.path)&&this.config.localeInfo.stringCompareCI(t,n.name)===0?(0,z.success)(n):(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.DocumentLoc,document:(0,Za.documentLoc)(r,t)}]))},e.prototype.getNameLoc=function(r,t,n){var a=this.getDocument(r.document);return a.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([a.reason])):a.value.getNameLoc(r.index,t,n)},e.prototype.getUserDefinedFuncLoc=function(r,t){if(this.userDefinedFuncOverrides[t]!==void 0){var n=(0,Za.userDefinedFuncLoc)(r,t);return(0,z.success)([n])}return(0,z.failure)((0,Nr.notImplemented)(["call UDF"]))},e.prototype.getCellFormat=function(r){var t=this.allEditedAvailable(r);if(t.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([t.reason]));if(t.value!==!0)return(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.GridRange,unavailableCells:t.value,range:r}]));var n=this.getEditedFormat(r);return n.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([n.reason])):n.value===Mi.SpecialFormat.Unavailable?(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.CellFormat}])):(0,z.success)(n.value)},e.prototype.getCellStyle=function(r){var t=this.allEditedAvailable(r);if(!(0,z.isSuccess)(t))return(0,z.failure)((0,Nr.unavailable)([t.reason]));if(t.value!==!0)return(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.GridRange,unavailableCells:t.value,range:r}]));var n=this.getEditedStyle(r);return(0,z.isSuccess)(n)?n.value===Mi.SpecialStyle.Unavailable?(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.CellStyle}])):this.resolveCellStyle(r.sheet.document,n.value):(0,z.failure)((0,Nr.unavailable)([n.reason]))},e.prototype.getIformat=function(r,t){var n=this.getDocument(r);if(n.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([n.reason]));var a=n.value.getIformat(t);if(a.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([a.reason]));var o=a.value.getValue();return o.kind===z.ResultKind.Failure?(0,z.failure)((0,dv.previousFormatFailure)((0,dv.formatLocIFormat)(r,t))):o},e.prototype.getIformats=function(r,t,n){var a=this.getDocument(r);if(a.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([a.reason]));for(var o=a.value.getIformats(),u=[],s=t,l=(0,SN.fastMin)(o.length,n);s<l;s+=1){var c=o[s];c!==void 0&&u.push({iformat:s,formatString:c.formatString,builtIn:c.builtIn})}return(0,z.success)(u)},e.prototype.getKnownFormat=function(r,t){var n=this.getDocument(r);if(n.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([n.reason]));var a=n.value.getKnownFormat(t);if(a.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([a.reason]));var o=a.value.getValue();return o.kind===z.ResultKind.Failure?(0,z.failure)((0,dv.previousFormatFailure)((0,dv.formatLocKnownFormat)(r,t))):o},e.prototype.getFormatString=function(r,t){var n=this.getDocument(r);if(n.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([n.reason]));var a=n.value.getFormatString(t);return a.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([a.reason])):a},e.prototype.getNameFormula=function(r,t){var n=this.getDocument(r.scope.document);if(n.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([n.reason]));var a=n.value.getNameFormula(r,t);if(a.kind===z.ResultKind.Failure)return a;if(a.value===void 0)return(0,z.success)(void 0);var o=a.value.lazyData.getValue();if((0,z.isSuccess)(o))return o;var u=this.hasRecalcNameFailure(r);return(0,z.isSuccess)(u)?u.value||this.setNameFailure(r,o.reason):this.cb.onUnavailable(u.reason),(0,z.failure)((0,Sc.previousNameFailure)(r))},e.prototype.getCellFormula=function(r){var t=this.getEditedFormula(r);if(t.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([t.reason]));if(t.value===void 0)return(0,z.success)(void 0);var n=t.value,a=n[0],o=n[1];if(o.compiledFmla===void 0)return(0,z.success)(void 0);var u=(0,Za.sheetGridRange)(r.sheet,a),s=this.readCompiledFmla(u,o.compiledFmla);return(0,z.isSuccess)(s)?(0,z.success)((0,Sc.cellFormula)((0,Za.lexicalSourceGrid)(o.lexicalKind,u),s.value)):s},e.prototype.setCellValue=function(r,t,n){var a=this.setRecalcValue(r,t);if(a.kind===z.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);var o=this.propagateEditTaint(r,n);if(o.kind===z.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);this.cb.onSetCellValue(r,t,n,o.value,this.evalParams)},e.prototype.setCellValues=function(r,t,n){var a=this.setClientValue(r,t);if(a.kind===z.ResultKind.Failure)return this.cb.onUnavailableObject(a.reason);var o=this.setRecalcValue(r,t);if(o.kind===z.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);var u=this.propagateEditTaint(r,n);if(u.kind===z.ResultKind.Failure)return this.cb.onUnavailableObject(u.reason);this.cb.onSetCellValues(r,t,n,u.value,this.evalParams)},e.prototype.getWorksheetFunc=function(r){var t;if((0,OR.isVolatileFunc)(r)){var n=!1,a=this.evalParams.volatileMode;switch(r){case OR.WorksheetFuncId.RAND:case OR.WorksheetFuncId.RANDBETWEEN:case OR.WorksheetFuncId.RANDARRAY:case OR.WorksheetFuncId.NOW:n=a===NR.VolatileMode.GroundTruth;break;case OR.WorksheetFuncId.TODAY:n=a===NR.VolatileMode.GroundTruth||a===NR.VolatileMode.Estimation;break;default:n=OR.WorksheetFuncId[r]===void 0;break}if(!n)return(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.VolatileFunction,name:(0,qK.englishWorksheetFuncIdToName)(r)}]))}var o=(t=this.worksheetFuncOverrides[r])!==null&&t!==void 0?t:(0,ACr.getWorksheetFunc)(r);return o!=null?(0,z.success)(o):(0,z.failure)((0,Nr.notImplemented)([(0,qK.englishWorksheetFuncIdToName)(r)]))},e.prototype.getUserDefinedFunc=function(r){var t=r.id;return this.userDefinedFuncOverrides[t]!==void 0?(0,z.success)(this.userDefinedFuncOverrides[t]):(0,z.failure)((0,Nr.notImplemented)(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(r){return this.getSheetRangeIds(r)},e.prototype.setCellFailure=function(r,t,n){var a,o=this.setRecalcFailure(r.sheet,(0,wI.createCellSetFromRange)(r.range));if(o.kind===z.ResultKind.Failure)return this.cb.onUnavailableObject(o.reason);var u=this.setClientValue(r,Dh.clientValueUnknownOper);if(u.kind===z.ResultKind.Failure)return this.cb.onUnavailableObject(u.reason);var s=this.setRecalcValue(r,GK.blankOper);if(s.kind===z.ResultKind.Failure)return this.cb.onUnavailableObject(s.reason);var l=this.propagateEditTaint(r,n);if(l.kind===z.ResultKind.Failure)return this.cb.onUnavailableObject(l.reason);var c=this.evalParams;(a=c.onRangeFailure)===null||a===void 0||a.call(c,r,t,n),this.cb.onRangeFailure(r,t,n,l.value,c)},e.prototype.getUsedRange=function(r){var t=this.getEditedUsedRange(r);return t.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([t.reason])):t},e.prototype.getSheetName=function(r,t){var n=this.getDocument(r);if(n.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([n.reason]));var a=n.value.getSheetName(t);return a.kind===z.ResultKind.Failure||a.value===void 0?a:(0,z.success)(a.value)},e.prototype.getSheetIndex=function(r,t){var n=this.getDocument(r);if(n.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([n.reason]));var a=n.value.getSheetIndex(t);return a.kind===z.ResultKind.Failure||a.value===void 0?a:(0,z.success)(a.value.index)},e.prototype.getContainingTable=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([t.reason])):t.value.getContainingTable(r)},e.prototype.getNamedRanges=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([t.reason])):t.value.getNamedRanges(r)},e.prototype.getStructRefColumn=function(r,t){var n=this.getDocument(r.scope.document);return n.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([n.reason])):n.value.getStructRefColumn(r,t)},e.prototype.getStructRefSpecialRef=function(r,t){var n=this.getDocument(r.scope.document);return n.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([n.reason])):n.value.getStructRefSpecialRef(r,t)},e.prototype.getIntersectingTables=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([t.reason])):t.value.getIntersectingTables(r)},e.prototype.getNamedObject=function(r,t){var n,a=this.getDocument(r.scope.document);if(a.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([a.reason]));var o=a.value.getNameFormula(r,t);return o.kind===z.ResultKind.Failure?o:(0,z.success)((n=o.value)===null||n===void 0?void 0:n.obj)},e.prototype.getHiddenRows=function(r,t,n){var a=this.getDocument(r.document);return a.kind===z.ResultKind.Failure?Dh.hiddennessFullyUnavailable:a.value.getHiddenRows(r.index,t,n)},e.prototype.tryGetHiddenRows=function(r,t,n){var a=this.getDocument(r.document);if(a.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([a.reason]));var o=a.value.tryGetHiddenRows(r.index,t,n);return o.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([o.reason])):o},e.prototype.getHiddenCols=function(r,t,n){var a=this.getDocument(r.document);return a.kind===z.ResultKind.Failure?Dh.hiddennessFullyUnavailable:a.value.getHiddenCols(r.index,t,n)},e.prototype.tryGetHiddenCols=function(r,t,n){var a=this.getDocument(r.document);if(a.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([a.reason]));var o=a.value.tryGetHiddenCols(r.index,t,n);return o.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([o.reason])):o},e.prototype.getMergeCell=function(r){var t=this.allEditedAvailable(r);if(t.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([t.reason]));if(t.value!==!0)return(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.GridRange,unavailableCells:t.value,range:r}]));var n=this.getDocument(r.sheet.document);if(n.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([n.reason]));var a=n.value.getMergeCell(r);return a.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([a.reason])):a},e.prototype.isInFilterMode=function(r){var t=this.getDocument(r.document);if(t.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([t.reason]));var n=t.value.isInFilterMode(r.index);return n.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([n.reason])):n},e.prototype.getRandom=function(){return(0,kR.assertTrue)("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===NR.VolatileMode.GroundTruth),(0,z.success)(this.config.mathpack.fromNumber(this.random.next()))},e.prototype.getTime=function(r,t){return(0,NR.getTimeImpl)(this.config,r,t,this.evalParams.volatileMode)},e.prototype.withEvalParams=function(r,t){var n=this,a=this.evalParams;this.evalParams=r;try{var o=t();return Array.isArray(o)?o:o.kind===z.ResultKind.Paused?(0,Sc.paused)(function(){return n.withEvalParams(r,o.resume)}):(0,Sc.breaked)(function(){return n.withEvalParams(r,o.resume)})}finally{this.evalParams=a}},e.prototype.withEvalParamsEvalFormula=function(r,t){var n=this,a=this.evalParams;this.evalParams=r;try{var o=t();return o.kind===z.ResultKind.Paused?(0,Sc.paused)(function(){return n.withEvalParamsEvalFormula(r,o.resume)}):o.kind===z.ResultKind.Breaked?(0,Sc.breaked)(function(){return n.withEvalParamsEvalFormula(r,o.resume)}):o}finally{this.evalParams=a}},e.prototype.evaluate=function(r,t,n,a){var o=this;return this.withEvalParams({computeKind:r,computeCells:t,volatileMode:n,onRangeFailure:a},function(){return o.evaluator.evalCells({},t)})},e.prototype.evalFormula=function(r,t,n,a){var o=this,u={lexicalKind:Za.LexicalKind.Other,originGridCell:(0,z.success)(t.range),originSheet:(0,z.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:!1,emitStepInfo:!1,contextNames:void 0},s={lexicalSource:{kind:Za.LexicalKind.Other},originGridCell:(0,z.success)(t.range),originSheet:(0,z.success)(t.sheet),calcingArray:!1,reflectionGridCell:(0,z.success)(t.range),reflectionSheet:(0,z.success)(t.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:(0,z.success)(!1),contextNames:void 0},l=function c(d,f){if(f.kind===z.ResultKind.Paused)return(0,Sc.paused)(function(){return c(d,f.resume())});if(f.kind===z.ResultKind.Breaked)return(0,Sc.breaked)(function(){return c(d,f.resume())});if(!(0,z.isSuccess)(f))return(0,z.success)({value:f});var m=o.evalFormulaFormat(t,d,f.value,n);return(0,z.success)({value:(0,z.success)(f.value),formatted:m})};return this.withEvalParamsEvalFormula({computeKind:Mi.ComputeKind.EvalFormula,computeCells:[t],volatileMode:a},function(){var c=o.parser.parseFormula(u,r),d=o.checkFormula(u,c,r,Mi.FormulaMode.EvalFormula),f=o.compileFormula(u,d);return(0,z.isSuccess)(f)?l(f.value,o.evaluator.evalFormula(s,f.value)):(0,z.success)({value:f})})},e.prototype.evalFormulaFormat=function(r,t,n,a){var o;if(a!==void 0){if(typeof a=="number")return this.formatValueIformat(r.sheet.document,a,n);if(a.kind===Mi.SpecialFormat.Known)return this.formatValueKnownFormat(r.sheet.document,a.knownFormat,n);var u=n;if(this.renderBlanksAsZerosEnabled&&(0,Nr.isBlankOper)(n)&&(a.kind===Mi.SpecialFormat.Origin||a.kind===Mi.SpecialFormat.Inferred||a.kind===Mi.SpecialFormat.Edit)&&((o=a.renderBlanksAsZeros)!==null&&o!==void 0&&o)&&(u=this.config.mathpack.zero),a.kind===Mi.SpecialFormat.Origin||a.kind===Mi.SpecialFormat.Aggregate){var s=this.ensureCellExists(r);return(0,SN.isNone)(s)||!(0,z.isSuccess)(s)?s:a.kind===Mi.SpecialFormat.Origin?this.formatValueCell(r,u):this.formatValueAggregate(r,u)}return a.kind===Mi.SpecialFormat.Inferred?this.applyInferredFormat(r,t,u):a.kind===Mi.SpecialFormat.Edit?this.applyEditFormat(r,t,u,a.isWholeFormula):(0,kR.assertNever)("calc.calc.PartialWorkbookDocumentCollection.evalFormulaFormat",a)}},e.prototype.evalValue=function(r,t,n){var a,o=this.evalParams;this.evalParams={computeKind:t,computeCells:[r],volatileMode:n};try{var u=this.getEditedFormula(r);if(!(0,z.isSuccess)(u))return this.cb.onUnavailableObject(u.reason);if(((a=u.value)===null||a===void 0?void 0:a[1].compiledFmla)!==void 0)return;var s=this.hasRecalcDirty(r);if(!(0,z.isSuccess)(s))return this.cb.onUnavailableObject(s.reason);if(s.value)return;var l=this.tryGetCellValue(r.range,r.sheet);if(l===void 0)return;(0,kR.assertTrue)("calc.calc.PartialWorkbookDocumentCollection.evalValue",l.kind===Sc.CellKind.FinalValue),this.cb.onReturnCellValue(r,l.oper,Mi.ComputedCellKind.EditedCell)}finally{this.evalParams=o}},e.prototype.advanceVersion=function(){return this.version++,this.version},e.prototype.setUserDefinedFuncOverrides=function(r){this.userDefinedFuncOverrides=r,this.advanceVersion()},e.prototype.setWorksheetFuncOverrides=function(r){this.worksheetFuncOverrides=r,this.advanceVersion()},e.prototype.setSheetNames=function(r,t){var n=this.ensureDocument(r);return n.kind===z.ResultKind.Failure?n:(this.document=n.value.setSheetNames(t),(0,z.success)(void 0))},e.prototype.advanceState=function(r){this.document!==void 0&&this.document.advanceState(r,this.advanceVersion())},e.prototype.onCellModified=function(r){if(this.document!==void 0)return this.document.onCellModified(r,this.advanceVersion())},e.prototype.getServerDocument=function(){return this.documentLoc},e.prototype.allServerAvailable=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.allServerAvailable(r)},e.prototype.forEachEditedNonBlankCellInSet=function(r,t,n){var a=r.index,o=r.document,u=this.getDocument(o);return u.kind===z.ResultKind.Failure?u:u.value.forEachEditedNonBlankCellInSet(a,t,n)},e.prototype.forEachServerNonBlankCellInSet=function(r,t,n){var a=r.index,o=r.document,u=this.getDocument(o);return u.kind===z.ResultKind.Failure?u:u.value.forEachServerNonBlankCellInSet(a,t,n)},e.prototype.forEachEditedCellInSet=function(r,t,n){var a=r.index,o=r.document,u=this.getDocument(o);return u.kind===z.ResultKind.Failure?u:u.value.forEachEditedCellInSet(a,t,n)},e.prototype.clearCompiledFormulas=function(){if(this.document!==void 0)return this.document.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){if(this.document!==void 0)return this.document.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){return this.document!==void 0?this.document.getGridStatistics():Dh.emptyGridStatistics},e.prototype.getNameStatistics=function(){return this.document!==void 0?this.document.getNameStatistics():ICr.emptyNameStatistics},e.prototype.collectGarbage=function(r){if(this.document!==void 0)return this.document.collectGarbage(r,this.advanceVersion())},e.prototype.getEditedFormula=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getEditedFormula(r)},e.prototype.forEachEditedFormula=function(r,t){var n=this.getDocument(r.sheet.document);return n.kind===z.ResultKind.Failure?n:n.value.forEachEditedFormula(r,t)},e.prototype.getEditedValue=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getEditedValue(r)},e.prototype.forEachEditedValue=function(r,t){var n=this.getDocument(r.sheet.document);return n.kind===z.ResultKind.Failure?n:n.value.forEachEditedValue(r,t)},e.prototype.getEditedFormat=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getEditedFormat(r)},e.prototype.forEachEditedFormat=function(r,t){var n=this.getDocument(r.sheet.document);return n.kind===z.ResultKind.Failure?n:n.value.forEachEditedFormat(r,t)},e.prototype.getEditedStyle=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getEditedStyle(r)},e.prototype.getServerFormat=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getServerFormat(r)},e.prototype.getServerStyle=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getServerStyle(r)},e.prototype.getClientFormat=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getClientFormat(r)},e.prototype.getClientValue=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getClientValue(r)},e.prototype.getRecalcValues=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getRecalcValues(r)},e.prototype.forEachRecalcValue=function(r,t){var n=this.getDocument(r.sheet.document);return n.kind===z.ResultKind.Failure?n:n.value.forEachRecalcValue(r,t)},e.prototype.getServerValue=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getServerValue(r)},e.prototype.getServerFormula=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getServerFormula(r)},e.prototype.getClientFormula=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.getClientFormula(r)},e.prototype.getServerUsedRange=function(r){var t=this.getDocument(r.document);if(t.kind===z.ResultKind.Failure)return t;var n=t.value.getServerUsedRange(r.index);return n.kind===z.ResultKind.Failure||n.value===void 0?n:(0,z.success)((0,Za.sheetGridRange)(r,n.value))},e.prototype.getServerAvailableCells=function(){var r=[];return this.forEachDocument(function(t){return void(0,SN.safePush)(r,t.getServerAvailableCells())}),r},e.prototype.promoteServerAvailability=function(r,t){var n=r.sheet,a=r.set,o=this.getDocument(n.document);return o.kind===z.ResultKind.Failure?o:o.value.promoteServerAvailability(n.index,a,t)},e.prototype.extendServerUnused=function(r,t){var n=this.getDocument(r.document);return n.kind===z.ResultKind.Failure?n:n.value.extendServerUnused(r.index,t,this.advanceVersion())},e.prototype.setCellContents=function(r,t,n,a,o,u,s,l,c,d){var f=this.getDocument(t.sheet.document);if(f.kind===z.ResultKind.Failure)return f;var m=n===void 0?void 0:a?this.compileFmla(r,Za.LexicalKind.Cell,(0,Za.sheetGridCell)(t.sheet,o),void 0,n):n===""?Dh.blankCellGridFormula:{fmla:n,lexicalKind:Za.LexicalKind.Cell,origin:o,compiledFmla:void 0,hasHyperlink:Dh.SpecialBoolean.ClientValueUnknown};return f.value.setCellContents(r,t,m,u,s,l,c,d,this.advanceVersion())},e.prototype.setRangeFormula=function(r,t,n,a,o,u,s,l){var c=this.getDocument(t.sheet.document);if(c.kind===z.ResultKind.Failure)return c;var d=n===""?Dh.blankRangeGridFormula:this.compileFmla(r,Za.LexicalKind.Range,(0,Za.sheetGridCell)(t.sheet,a),(0,Nr.gridRangeAnchor)(t.range),n);return c.value.setRangeFormula(r,t,d,o,u,s,l,this.advanceVersion())},e.prototype.copyRange=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.copyRange(r)},e.prototype.pasteRange=function(r,t){var n=this.getDocument(r.sheet.document);return n.kind===z.ResultKind.Failure?n:n.value.pasteRange(r,t,this.advanceVersion())},e.prototype.assumeRecalcFinal=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.assumeRecalcFinal(r,this.advanceVersion())},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getNonDirtyEditedCells=function(){return this.document?this.document.getNonDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(r,t,n){var a=this.getDocument(t.scope.document);return a.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([a.reason])):a.value.setNamedObject(r,t,n,this.compileNamedObject)},e.prototype.setUndefinedNames=function(r){var t=this.getDocument(r.document);return t.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([t.reason])):t.value.setUndefinedNames(r)},e.prototype.promoteNamedObjects=function(r,t){var n=this.getDocument(r.document);return n.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([n.reason])):n.value.promoteNamedObjects(r,t)},e.prototype.setNumberFormats=function(r,t,n){var a=this,o=this.ensureDocument(r);if(o.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([o.reason]));var u=[];return t.forEach(function(s){var l=s.iformat,c=s.formatString,d=s.builtIn,f=a.compileNumberFormat(c,d);u[l]={formatString:c,builtIn:d,compiledFormat:f}}),(0,z.success)(o.value.setNumberFormats(u,n))},e.prototype.setStyles=function(r,t,n){var a=this.ensureDocument(r);return a.kind===z.ResultKind.Failure?a:(0,z.success)(a.value.setStyles(t,n))},e.prototype.setFonts=function(r,t,n){var a=this.ensureDocument(r);return a.kind===z.ResultKind.Failure?a:(0,z.success)(a.value.setFonts(t,n))},e.prototype.setFills=function(r,t,n){var a=this.ensureDocument(r);return a.kind===z.ResultKind.Failure?a:(0,z.success)(a.value.setFills(t,n))},e.prototype.setBorders=function(r,t,n){var a=this.ensureDocument(r);return a.kind===z.ResultKind.Failure?a:(0,z.success)(a.value.setBorders(t,n))},e.prototype.writeHiddenRows=function(r,t,n){var a=this.getDocument(r.document);return a.kind===z.ResultKind.Failure?a:a.value.setHiddenRows(r.index,t,n)},e.prototype.writeHiddenCols=function(r,t,n){var a=this.getDocument(r.document);return a.kind===z.ResultKind.Failure?a:a.value.setHiddenCols(r.index,t,n)},e.prototype.writeMergeCell=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.setMergeCell(r)},e.prototype.writeInFilterMode=function(r,t){var n=this.getDocument(r.document);return n.kind===z.ResultKind.Failure?n:n.value.setInFilterMode(r.index,t)},e.prototype.resolveCellFormat=function(r,t){if(typeof t!="number")return(0,z.success)(t);var n=this.getDocument(r);if(!(0,z.isSuccess)(n))return(0,z.failure)((0,Nr.unavailable)([n.reason]));var a=n.value.getIformat(t);return(0,z.isSuccess)(a)?a.value.getValue():(0,z.failure)((0,Nr.unavailable)([a.reason]))},e.prototype.resolveCellStyle=function(r,t){var n=this.getDocument(r);if(!(0,z.isSuccess)(n))return(0,z.failure)((0,Nr.unavailable)([n.reason]));var a=n.value.resolveCellStyle(t);return(0,z.isSuccess)(a)?(0,z.success)(a.value):(0,z.failure)((0,Nr.unavailable)([a.reason]))},e.prototype.resolveValueFormat=function(r,t){var n;if(typeof t=="string")return this.resolveStringFormat(r,t);var a=this.getKnownFormat(r,t);if(!(0,z.isSuccess)(a))return a;var o=this.getFormatString(r,a.value.formatString);return(0,z.isSuccess)(o)?(0,z.success)((n=o.value)!==null&&n!==void 0?n:a.value):o},e.prototype.resolveStringFormat=function(r,t){var n=this.getFormatString(r,t);return(0,z.isSuccess)(n)?n.value!==void 0?(0,z.success)(n.value):this.formatter.createFormat(t,!1):n},e.prototype.resolveObjectFormat=function(r,t){var n=this.getFormatString(r,t.formatString);return(0,z.isSuccess)(n)?n.value!==void 0?(0,z.success)(n.value):(0,z.success)(t):n},e.prototype.resolveEditFormat=function(r,t){return typeof t=="number"?(0,z.success)(t):this.resolveStringFormat(r,t)},e.prototype.resolveRibbonFormat=function(r,t,n){var a;switch(t){case S$.RibbonFormat.GalleryShortDate:case S$.RibbonFormat.GalleryLongDate:{var o=this.getCellFormat(n);if(!(0,z.isSuccess)(o))return o;var u=this.resolveCellFormat(n.sheet.document,o.value);if(!(0,z.isSuccess)(u))return u;a=u.value;break}}var s=(0,S$.getRibbonFormat)(this.config.localeInfo,t,a);return this.resolveStringFormat(r,s)},e.prototype.resolveChangeDecimals=function(r,t,n){var a=this.getCellFormat(n);if(!(0,z.isSuccess)(a))return a;var o=this.resolveCellFormat(n.sheet.document,a.value);if(!(0,z.isSuccess)(o))return o;var u=this.formatter.changeFormatDecimals(o.value,t);return(0,z.isSuccess)(u)?u.value===void 0?z.successUndefined:this.resolveObjectFormat(r,u.value):u},e.prototype.parseInferredEdit=function(r,t,n){var a=this.getCellFormat(r);if(!(0,z.isSuccess)(a))return a;var o=this.resolveCellFormat(r.sheet.document,a.value);if(!(0,z.isSuccess)(o))return o;var u=this.evalParams;this.evalParams={computeKind:Mi.ComputeKind.ParseEdit,computeCells:[r],volatileMode:n};try{return this.formatter.parseEdit(t,o.value)}finally{this.evalParams=u}},e.prototype.inferFormulaFormat=function(r){var t=this.getEditedFormula(r);if(!(0,z.isSuccess)(t))return(0,z.success)(void this.cb.onUnavailableObject(t.reason));if(t.value===void 0||t.value[1].compiledFmla===void 0)return(0,z.success)(void this.cb.onUnavailableObject({kind:Od.UnavailableKind.CellEvaluatingValue}));var n=t.value[1].compiledFmla.getValue();if(!(0,z.isSuccess)(n))return n;var a=(0,Za.lexicalSourceGrid)(t.value[1].lexicalKind,(0,Za.sheetGridRange)(r.sheet,t.value[0])),o=n.value;return this.formatter.evalFormat((0,dv.evalFormatLocalsGrid)(a),o)},e.prototype.fillInferredFormat=function(r,t){var n=this,a=t,o=t===Mi.SpecialFormat.Unavailable?(0,z.success)(Mi.SpecialFormat.Unavailable):this.resolveCellFormat(r.sheet.document,t);if(!(0,z.isSuccess)(o)){var u=o.reason;(0,wI.forEachRangeInSet)(r.set,function(l){var c=(0,Za.sheetGridRange)(r.sheet,l);return n.cb.onInferFormatFailure(c,u),!0}),o=(0,z.success)(Mi.SpecialFormat.Unavailable),a=Mi.SpecialFormat.Unavailable}var s=o.value;(0,wI.forEachCellInSet)(r.set,function(l){var c=(0,Za.sheetGridCell)(r.sheet,l),d=n.getEditedFormat(c);if(!(0,z.isSuccess)(d))return n.cb.onUnavailableObject(d.reason),!0;if(d.value===Mi.SpecialFormat.Unavailable)return!0;var f=n.resolveCellFormat(r.sheet.document,d.value);if(!(0,z.isSuccess)(f))return n.cb.onInferFormatFailure(c,f.reason),!0;if((0,CPe.shouldInstallFormat)(s===Mi.SpecialFormat.Unavailable?void 0:s,f.value)){var m=n.setEditedFormat(c,a);(0,z.isSuccess)(m)||n.cb.onUnavailableObject(m.reason)}return!0})},e.prototype.anonymizeFormula=function(r,t){var n,a=(n=t.compiledFmla)===null||n===void 0?void 0:n.getValue();return a!==void 0&&(0,z.isSuccess)(a)?[(0,h$.anonymizeFormula)(this.config,a.value,r),BCr(a.value)]:[(0,bPe.anonymizeFormulaString)(t.fmla),[]]},e.prototype.compileFmla=function(r,t,n,a,o){var u=this;return{fmla:o,lexicalKind:t,origin:a??n.range,compiledFmla:new NR.ResettableLazy(function(){var s=u.parser.parseFormula((0,_Pe.parseLocals)(t,n.range),o),l=r?s:u.autocorrectFormula((0,DI.analyzeLocalsGrid)(t,n),s),c=r&&u.isServerWorkbookLoad,d=u.checkFormula((0,DI.analyzeLocalsGrid)(t,n,void 0,c),l,o,r?Mi.FormulaMode.ServerCellFormula:Mi.FormulaMode.EditCellFormula),f=u.adjustFormulaOrigin(d,n,a);return u.compileFormula((0,Sc.compileLocalsGrid)(t,n.range),f)}),hasHyperlink:Dh.SpecialBoolean.ClientValueUnknown}},e.prototype.compileFormula=function(r,t){return(0,z.isSuccess)(t)?this.compiler.compileFormula(r,t.value):t},e.prototype.checkFormula=function(r,t,n,a){if(!(0,z.isSuccess)(t))return t;var o=this.analyzer.checkFormulaWithDiagnostics(r,t.value);if(!(0,z.isSuccess)(o))return o;if(!(0,Nr.isWellFormed)(o.value[0])){var u="calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+(0,bPe.anonymizeFormulaString)(n);return(0,z.failure)((0,Sc.illFormedFormula)(u,a,(0,DI.summarizeFormulaDiagnostics)(o.value[1])))}return(0,z.success)(o.value[0])},e.prototype.autocorrectFormula=function(r,t){return(0,z.isSuccess)(t)?this.analyzer.autocorrectFormula(r,t.value):t},e.prototype.adjustFormulaOrigin=function(r,t,n){if(!(0,z.isSuccess)(r)||n===void 0)return r;var a=(0,MCr.resolveLocalsGrid)(t);return(0,OCr.adjustFormulaOrigin)(this,a,n,r.value)},e.prototype.compileNumberFormat=function(r,t){var n=this;return new NR.ResettableLazy(function(){var a=n.formatter.createFormat(r,t);return(0,z.isSuccess)(a)||n.cb.onNumberFormatFailure(a.reason),a})},e.prototype.compileKnownFormats=function(){var r=this;return(0,SN.numEnumMap)(yN.KnownFormat,function(t){return r.compileNumberFormat((0,TPe.getKnownFormat)(r.config.localeInfo,t),!1)})},e.prototype.printFormulaBarText=function(r,t,n){return this.printer.printFormula((0,NCr.printLocalsGrid)(r,(0,Za.sheetGridCell)(r.range.sheet,t)),n)},e.prototype.renderValueBarText=function(r,t,n){var a=this.getEditedResolvedFormat(r);return(0,z.isSuccess)(a)?this.formatter.renderFormulaBar(r.sheet.document,t,a.value,(0,DCr.stringStartsWith)(n,"'")):a},e.prototype.formatValueCell=function(r,t){if((0,Nr.isBlankOper)(t))return(0,z.success)((0,dv.formattedValue)([],void 0,dv.Alignment.Left,dv.Clip.All));var n=this.getEditedResolvedFormat(r);if(!(0,z.isSuccess)(n))return n;var a=!0;return this.formatter.applyFormat(n.value,t,a)},e.prototype.formatValueAggregate=function(r,t){if(!(0,yPe.isNumberOper)(t))return(0,z.success)((0,dv.hashesValue)(dv.aggregationError,void 0));var n;if((0,yPe.isNumberOper)(t)&&this.config.mathpack.cond(t)===0)n=this.getKnownFormat(r.sheet.document,yN.KnownFormat.General);else{if(n=this.getEditedResolvedFormat(r),!(0,z.isSuccess)(n))return n;var a=n.value.valueType;a===dv.FormatValueType.Text?n=this.getKnownFormat(r.sheet.document,yN.KnownFormat.General):a===dv.FormatValueType.Time&&(n=this.getKnownFormat(r.sheet.document,yN.KnownFormat.AbsHMMSS))}if(!(0,z.isSuccess)(n))return n;var o=!0;return this.formatter.applyFormat(n.value,t,o)},e.prototype.formatValueIformat=function(r,t,n){var a=this.getIformat(r,t);return(0,z.isSuccess)(a)?this.formatter.applyFormat(a.value,n,!0):a},e.prototype.formatValueKnownFormat=function(r,t,n){var a=this.getKnownFormat(r,t);return(0,z.isSuccess)(a)?this.formatter.applyFormat(a.value,n,!0):a},e.prototype.getEditedResolvedFormat=function(r){var t=this.getEditedFormat(r);return(0,z.isSuccess)(t)?t.value===Mi.SpecialFormat.Unavailable?(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.CellFormat}])):this.resolveCellFormat(r.sheet.document,t.value):(0,z.failure)((0,Nr.unavailable)([t.reason]))},e.prototype.getDocument=function(r){return this.documentLoc===void 0||this.document===void 0||!(0,Nr.isDocumentLocEqual)(this.documentLoc,r)?(0,z.failure)({kind:Od.UnavailableKind.DocumentLoc,document:r}):(0,z.success)(this.document)},e.prototype.ensureDocument=function(r){return this.documentLoc===void 0&&this.document===void 0&&(this.documentLoc=r,this.document=new bCr.PartialWorkbookDocument(r,this.config.localeInfo.stringCompareCI,new wCr.PartialWorkbookFormats(this.compileKnownFormats()),new LCr.PartialWorkbookStyles)),this.getDocument(r)},e.prototype.tryGetCellValues=function(r,t){var n=this,a=(0,Za.sheetGridRange)(t,r),o=r.row,u=r.col,s=r.rows,l=r.cols,c=this.getRecalcValues(a);if(c.kind===z.ResultKind.Failure){this.cb.onUnavailableObject(c.reason);return}for(var d=!1,f=0;f<s;f+=1)for(var m=c.value[f],v=0;v<l;v+=1){var h=m[v].failure;h!==void 0&&(this.setCellFailure((0,Za.sheetGridCell)(t,(0,Za.gridCell)(o+f,u+v)),h,y$),d=!0)}if(!d){var y=function(k){return(0,Sc.finalValue)(k.oper)},_=c.value.map(function(N){return N.map(y)}),E=this.forEachRecalcDirty(a,function(N){var k=(0,Za.sheetGridCell)(t,N),q=n.getEditedFormula(k);if(q.kind===z.ResultKind.Failure)return n.cb.onUnavailableObject(q.reason),!1;if(q.value===void 0)return n.setCellFailure(k,(0,Nr.unavailable)([{kind:Od.UnavailableKind.CellMissingFormula}]),y$),d=!0,!0;var V=q.value,I=V[0],M=V[1];if(M.compiledFmla===void 0)return n.cb.onUnavailableObject({kind:Od.UnavailableKind.CellEvaluatingValue}),!1;var B=n.readCompiledFmla((0,Za.sheetGridRange)(t,I),M.compiledFmla);return(0,z.isSuccess)(B)?(_[N.row-o][N.col-u]=(0,Sc.pendingValue)((0,Za.sheetGridCell)(t,(0,Nr.gridRangeAnchor)(I))),!0):(d=!0,!0)});if(!(0,z.isSuccess)(E)){this.cb.onUnavailableObject(E.reason);return}if(!(!E.value||d))return _}},e.prototype.tryGetCellValue=function(r,t){var n=this.tryGetCellValues(r,t);return n===void 0?void 0:n[0][0]},e.prototype.makeGetCellValues=function(r){var t=this;return function(n){var a=t.allEditedAvailable(n);if(a.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([a.reason]));if(a.value!==!0)return(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.GridRange,range:n,unavailableCells:a.value}]));var o=t.hasRecalcFailure(n);if(o.kind===z.ResultKind.Failure)return(0,z.failure)((0,Nr.unavailable)([o.reason]));if(o.value)return(0,z.failure)((0,Sc.previousFailure)(n));if((0,Nr.gridRangeSize)(n.range)>t.maxDereferenceCells)return(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.GridRangeSize,range:n}]));var u=r(n.range,n.sheet);return u===void 0?(0,z.failure)((0,Sc.previousFailure)(n)):(0,z.success)(u)}},e.prototype.readCompiledFmla=function(r,t){var n=t.getValue();if((0,z.isSuccess)(n))return n;if(this.setCellFailure(r,n.reason,y$),n.reason.kind===Sc.ReasonKind.Unavailable){var a=n.reason;return n}return(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.CellFormula,reason:n.reason}]))},e.prototype.getEditedUsedRange=function(r){var t=this.getDocument(r.document);if(t.kind===z.ResultKind.Failure)return t;var n=t.value.getEditedUsedRange(r.index);return n.kind===z.ResultKind.Failure||n.value===void 0?n:(0,z.success)((0,Za.sheetGridRange)(r,n.value))},e.prototype.getSheetRangeIds=function(r){var t=this.getDocument(r.document);return t.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([t.reason])):t.value.getSheetRangeIds(r)},e.prototype.allEditedAvailable=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.allEditedAvailable(r)},e.prototype.forEachRecalcDirty=function(r,t){var n=this.getDocument(r.sheet.document);return n.kind===z.ResultKind.Failure?n:n.value.forEachRecalcDirty(r,t)},e.prototype.hasRecalcDirty=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.hasRecalcDirty(r)},e.prototype.hasRecalcFailure=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.hasRecalcFailure(r)},e.prototype.hasEditedEditTaint=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.hasEditedEditTaint(r)},e.prototype.hasRecalcEditTaint=function(r){var t=this.getDocument(r.sheet.document);return t.kind===z.ResultKind.Failure?t:t.value.hasRecalcEditTaint(r)},e.prototype.setEditedFormat=function(r,t){var n=this.getDocument(r.sheet.document);return n.kind===z.ResultKind.Failure?n:n.value.setEditedFormat(r,t)},e.prototype.setClientFormat=function(r,t){var n=this.getDocument(r.sheet.document);return n.kind===z.ResultKind.Failure?n:n.value.setClientFormat(r,t,this.advanceVersion())},e.prototype.setRecalcFailure=function(r,t){var n=this.getDocument(r.document);return n.kind===z.ResultKind.Failure?n:n.value.setRecalcFailure(r.index,t)},e.prototype.testAndSetClientValue=function(r,t){var n=this.getClientValue(r);if(n.kind===z.ResultKind.Failure)return n;var a=(0,Dh.isClientValueUnknownOper)(n.value.oper)||!(0,Nr.isReadOperEqual)(this.config.mathpack,n.value.oper,t,!0);if(a){var o=this.setClientValue(r,t);if(o.kind===z.ResultKind.Failure)return o}return(0,z.success)(a)},e.prototype.testAndSetClientFormat=function(r,t){var n=this.getClientFormat(r);if(n.kind===z.ResultKind.Failure)return n;var a=t!==n.value;if(a){var o=this.setClientFormat(r,t);if(o.kind===z.ResultKind.Failure)return o}return(0,z.success)(a)},e.prototype.testAndSetClientFormula=function(r,t,n){var a,o=this.getClientFormula((0,Nr.sheetGridRangeAnchor)(r));if(o.kind===z.ResultKind.Failure)return o;var u=(a=o.value)!==null&&a!==void 0?a:[r.range,Dh.blankClientGridFormula],s=u[0],l=u[1],c=(0,Nr.gridRangeAnchor)(r.range),d=t!==void 0&&t!==l.fmla||l.compiledFmla!==void 0&&!(0,Nr.isGridCellEqual)(c,l.origin),f=n!==void 0&&n!==l.hasHyperlink;if(d||f){var m=l.compiledFmla,v=this.setClientFormula((0,Za.sheetGridRange)(r.sheet,s),{fmla:t??l.fmla,compiledFmla:m,origin:t!==void 0?c:l.origin,hasHyperlink:n??l.hasHyperlink});if(v.kind===z.ResultKind.Failure)return v}return(0,z.success)({hasFmlaChanged:d,hasHyperlinkChanged:f})},e.prototype.setRecalcEditTaint=function(r,t){var n=this.getDocument(r.document);return n.kind===z.ResultKind.Failure?n:n.value.setRecalcEditTaint(r.index,t)},e.prototype.propagateEditTaint=function(r,t){var n=this.hasEditedEditTaint(r);if(n.kind===z.ResultKind.Failure)return n;if(n.value)return(0,z.success)(Mi.ComputedCellKind.EditedCell);for(var a=0,o=t.cells;a<o.length;a++){var u=o[a],s=this.hasRecalcEditTaint(u);if(s.kind===z.ResultKind.Failure)return s;if(s.value){var l=this.setRecalcEditTaint(r.sheet,(0,wI.createCellSetFromRange)(r.range));return l.kind===z.ResultKind.Failure?l:(0,z.success)(Mi.ComputedCellKind.DependentCell)}}if(t.special&(_$.SpecialPrecs.Calc|_$.SpecialPrecs.Time)){var l=this.setRecalcEditTaint(r.sheet,(0,wI.createCellSetFromRange)(r.range));return l.kind===z.ResultKind.Failure?l:(0,z.success)(Mi.ComputedCellKind.DependentCell)}return t.bound===GK.PrecsBound.Exact||this.evalParams!==void 0&&this.evalParams.computeKind===Mi.ComputeKind.EditedCell?(0,z.success)(Mi.ComputedCellKind.IndependentCell):(0,z.success)(Mi.ComputedCellKind.UnknownNonEditedCell)},e.prototype.setClientValue=function(r,t){var n=this.getDocument(r.sheet.document);return n.kind===z.ResultKind.Failure?n:n.value.setClientValue(r,t,this.advanceVersion())},e.prototype.setRecalcValue=function(r,t){var n=this.getDocument(r.sheet.document);return n.kind===z.ResultKind.Failure?n:n.value.setRecalcValue(r,t)},e.prototype.setClientFormula=function(r,t){var n=this.getDocument(r.sheet.document);return n.kind===z.ResultKind.Failure?n:n.value.setClientFormula(r,t,this.advanceVersion())},e.prototype.hasRecalcNameFailure=function(r){var t=this.getDocument(r.scope.document);return t.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([t.reason])):t.value.hasRecalcNameFailure(r)},e.prototype.setRecalcNameFailure=function(r){var t=this.getDocument(r.scope.document);return t.kind===z.ResultKind.Failure?(0,z.failure)((0,Nr.unavailable)([t.reason])):t.value.setRecalcNameFailure(r)},e.prototype.setNameFailure=function(r,t){var n=this.setRecalcNameFailure(r);if(n.kind===z.ResultKind.Failure)return this.cb.onUnavailable(n.reason);this.cb.onNameFailure(r,t,this.evalParams)},e.prototype.applyInferredFormat=function(r,t,n){var a=this.getInferredFormat(r,t);return(0,z.isSuccess)(a)?a.value===void 0?this.formatValueKnownFormat(r.sheet.document,yN.KnownFormat.General,n):typeof a.value=="number"?this.formatValueIformat(r.sheet.document,a.value,n):this.formatter.applyFormat(a.value,n,!0):a},e.prototype.applyEditFormat=function(r,t,n,a){if(t.node.kind===PCr.NodeKind.CellRef&&!a)return this.applyInferredFormat(r,t,n);var o=this.ensureCellExists(r);if((0,SN.isNone)(o)||!(0,z.isSuccess)(o))return o;var u=this.getEditedResolvedFormat(r);if(!(0,z.isSuccess)(u))return u;var s=this.getInferredFormat(r,t);if(!(0,z.isSuccess)(s))return s;var l;if(s.value===void 0)l=void 0;else if(typeof s.value=="number"){var c=this.getIformat(r.sheet.document,s.value);if(!(0,z.isSuccess)(c))return c;l=c.value}else l=s.value;var d=(0,TPe.getKnownFormat)(this.config.localeInfo,yN.KnownFormat.General)===u.value.formatString;return(a||d)&&(0,SN.isDefined)(l)&&(0,CPe.shouldInstallFormat)(l,u.value)?this.formatter.applyFormat(l,n,!0):this.formatter.applyFormat(u.value,n,!0)},e.prototype.getInferredFormat=function(r,t){var n={lexicalSource:{kind:Za.LexicalKind.Other},originGridCell:(0,z.success)(r.range),originSheet:(0,z.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1};return this.formatter.evalFormat(n,t)},e.prototype.ensureCellExists=function(r){var t=this.allEditedAvailable(r);return(0,z.isSuccess)(t)?t.value!==!0?(0,z.failure)((0,Nr.unavailable)([{kind:Od.UnavailableKind.GridRange,unavailableCells:t.value,range:r}])):(0,z.success)(!0):void this.cb.onUnavailableObject(t.reason)},e}();xR.PartialWorkbookDocumentCollection=UCr});var PPe=T(_N=>{"use strict";p();Object.defineProperty(_N,"__esModule",{value:!0});_N.ulsStopwatchFactory=_N.initStopwatch=void 0;var EPe=pr();_N.initStopwatch=EPe.stopwatch.initStopwatch;_N.ulsStopwatchFactory=EPe.stopwatch.ulsStopwatchFactory});var APe=T(bN=>{"use strict";p();Object.defineProperty(bN,"__esModule",{value:!0});bN.PriorityScheduler=bN.QueuePos=void 0;var KCr=hz(),C$;(function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"})(C$||(bN.QueuePos=C$={}));var VCr=function(){function e(){this.minPriority=0,this.taskDeqs=[]}return e.prototype.deleteTasks=function(r,t){var n=this.taskDeqs[r];if(n)for(var a;a=n.popFront();)typeof a!="function"&&a.onDeleted&&a.onDeleted(t)},e.prototype.addTask=function(r,t,n){var a,o=(a=this.taskDeqs[r])!==null&&a!==void 0?a:this.taskDeqs[r]=new KCr.Deque;t===C$.Back?o.pushBack(n):o.pushFront(n),r<this.minPriority&&(this.minPriority=r)},e.prototype.runTask=function(){for(var r,t=this.minPriority;t<this.taskDeqs.length;t+=1){this.minPriority=t;var n=(r=this.taskDeqs[t])===null||r===void 0?void 0:r.popFront();if(n)return typeof n=="function"?n():n.onRun(),!0}return!1},e.prototype.getCount=function(r){var t,n;return r!==void 0?(n=(t=this.taskDeqs[r])===null||t===void 0?void 0:t.getCount())!==null&&n!==void 0?n:0:this.taskDeqs.reduce(function(a,o){return o?a+o.getCount():a},0)},e}();bN.PriorityScheduler=VCr});var FPe=T(xi=>{"use strict";p();Object.defineProperty(xi,"__esModule",{value:!0});xi.earlyReturn=xi.EarlyReturnKind=xi.singleReadOperType=xi.refToVal=xi.readOperType=xi.MachineRuntime=xi.breakTransition=xi.nextTransition=xi.callMachineTransition=xi.nextOnSuccessReceiver=xi.machineCall=xi.isMachineCall=xi.ThenMachine=xi.MachineCallKind=xi.ArrayMachine=void 0;var lp=ov();xi.ArrayMachine=lp.machine.ArrayMachine;xi.MachineCallKind=lp.machine.MachineCallKind;xi.ThenMachine=lp.machine.ThenMachine;xi.isMachineCall=lp.machine.isMachineCall;xi.machineCall=lp.machine.machineCall;xi.nextOnSuccessReceiver=lp.machine.nextOnSuccessReceiver;xi.callMachineTransition=lp.machine.callMachineTransition;xi.nextTransition=lp.machine.nextTransition;xi.breakTransition=lp.machine.breakTransition;xi.MachineRuntime=lp.machine.MachineRuntime;xi.readOperType=lp.machine.readOperType;xi.refToVal=lp.machine.refToVal;xi.singleReadOperType=lp.machine.singleReadOperType;xi.EarlyReturnKind=lp.machine.EarlyReturnKind;xi.earlyReturn=lp.machine.earlyReturn});var NPe=T($c=>{"use strict";p();Object.defineProperty($c,"__esModule",{value:!0});$c.breakTransition=$c.nextTransition=$c.nextOnSuccessReceiver=$c.callMachineTransition=$c.TransitionKind=$c.MachineRuntime=$c.MachineCycle=$c.AllMachine=void 0;var LC=pr();$c.AllMachine=LC.machine.AllMachine;$c.MachineCycle=LC.machine.MachineCycle;$c.MachineRuntime=LC.machine.MachineRuntime;$c.TransitionKind=LC.machine.TransitionKind;$c.callMachineTransition=LC.machine.callMachineTransition;$c.nextOnSuccessReceiver=LC.machine.nextOnSuccessReceiver;$c.nextTransition=LC.machine.nextTransition;$c.breakTransition=LC.machine.breakTransition});var IR=T($a=>{"use strict";p();Object.defineProperty($a,"__esModule",{value:!0});$a.evalFormulaFormatToUnion=$a.cellFormatToInferredFormat=$a.namedObjectToNamedObjectData=$a.namedObjectDataToNamedObject=$a.readOperToCellValue=$a.cellValueToReadOper=$a.createExcludeCellSet=$a.gridCellToCellLocation=$a.sheetGridRangeToLocation=$a.sheetGridRangeToHiddenCols=$a.sheetGridRangeToHiddenRows=$a.sheetGridRangeToCellSet=$a.unusedCellsUpdateToUsedRange=$a.sheetCellLocationToGridCell=$a.sheetRangeLocationToGridRange=$a.localeInfoFromData=$a.createLocaleInfo=void 0;var T$=fe(),c_=Ar(),su=Gi(),l_=No(),Um=r_(),jCr=Zc(),WCr=n_(),CN=Ss(),GC=_y(),HCr=qi(),OPe=Mh(),BK=Pf(),TN=Ba(),UK=RR(),qC=MI(),s_=Eg(),zCr=ti();function QCr(e,r,t){var n=(0,su.getEnglishWorksheetFuncIdToName)().slice();return(0,UK.filterCheck)(r,UK.chWorksheetFunctionName,t,"localeData.worksheetFunctionNames").forEach(function(a){return n[a.functionId]=a.functionName}),(0,su.createWorksheetFuncNameCallbacks)(e,n)}function XCr(e,r){var t=su.englishErrorNames.slice();return(0,UK.filterCheck)(e,UK.chErrorTypeName,r,"localeData.errorTypeNames").forEach(function(n){return t[n.errorType]=n.errorName}),t}function YCr(e){return(0,c_.isNone)(e)?function(r){return r>0&&r%3===0}:(0,su.createIsThousandsPositionCallback)(e)}function MPe(e,r){var t="en-US",n=(0,c_.makeStringCompareCI)(t),a=QCr(n,e.worksheetFunctionNames,r),o=a.getWorksheetFuncId,u=a.getWorksheetFuncName,s=YCr(e.thousandsData),l=XCr(e.errorTypeNames,r),c=e.lcid,d=c===su.LCID.Thailand,f=c===su.LCID.Korea,m=c===su.LCID.Japan,v=c===su.LCID.ChinaT||c===su.LCID.HongKong,h=c===su.LCID.China,y=f||m||h||v,_=c===su.LCID.Hindi||c===su.LCID.Tamil,E=c===su.LCID.Thailand||c===su.LCID.Vietnam||_,N=(c&su.LCID.LANG)===(su.LCID.Hebrew&su.LCID.LANG)||(c&su.LCID.LANG)===(su.LCID.Arabic&su.LCID.LANG)||c===su.LCID.Syriac,k=N||E,q=e.listSeparator===";"||e.decimalSeparator===";"?";;":";";return T$.__assign(T$.__assign({},e),{leftBracket:"[",rightBracket:"]",rcLeftBracket:e.leftBracket,rcRightBracket:e.rightBracket,getWorksheetFuncId:o,getWorksheetFuncName:u,isNumeral:su.isNumeral,getOrdinal:su.getOrdinal,getNumberShape:su.getNumberShape,isThousandsPosition:s,isIdentStart:su.isIdentStart,isIdentContinue:su.isIdentContinue,stringCompareCI:n,errorNames:l,statementSeparator:q,isThai:d,isEastAsia:y,isKorea:f,isJapan:m,isChinaT:v,isChinaS:h,isComplexScript:k})}$a.createLocaleInfo=MPe;function JCr(e){return MPe(e,{})}$a.localeInfoFromData=JCr;function kPe(e,r){return(0,c_.isNone)(r)?{index:e,length:1}:{index:e,length:(0,c_.fastAbs)(r-e)+1}}function KK(e,r){var t=kPe(r.row,r.lastRow),n=t.index,a=t.length,o=kPe(r.column,r.lastColumn),u=o.index,s=o.length;return(0,l_.sheetGridRange)((0,l_.sheetIndex)(e,r.sheetId),(0,l_.gridRange)(n,u,a,s))}$a.sheetRangeLocationToGridRange=KK;function ZCr(e,r){var t=r.row,n=r.column;return(0,l_.sheetGridCell)((0,l_.sheetIndex)(e,r.sheetId),(0,l_.gridCell)(t,n))}$a.sheetCellLocationToGridCell=ZCr;function $Cr(e,r){var t=r.sheetId,n=r.usedRange;return(0,c_.isDefined)(n)?KK(e,T$.__assign({sheetId:t},n)):(0,CN.sheetUsedRange)((0,l_.sheetIndex)(e,t),WCr.emptyUsedRange)}$a.unusedCellsUpdateToUsedRange=$Cr;function e1r(e,r,t){var n=e.sheet,a=e.range,o=i1r(a,r,t);return{sheet:n,set:o}}$a.sheetGridRangeToCellSet=e1r;function r1r(e,r){var t=e.sheet,n=e.range,a=r;return{sheet:t,range:n,hidden:a}}$a.sheetGridRangeToHiddenRows=r1r;function t1r(e,r){var t=e.sheet,n=e.range,a=r;return{sheet:t,range:n,hidden:a}}$a.sheetGridRangeToHiddenCols=t1r;function R$(e){return(0,HCr.isSheetGridCell)(e)?(0,Um.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col):(0,Um.sheetRangeLocation)(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}$a.sheetGridRangeToLocation=R$;function n1r(e){var r=e.row,t=e.col;return{row:r,column:t}}$a.gridCellToCellLocation=n1r;function a1r(e,r,t,n){var a=OPe.empty;if((0,c_.isNone)(n))return a;for(var o=0;o<n.length;o+=1){var u=n[o];if(e<=u&&u<e+r){for(var s=1;o+s<n.length&&n[o+s]===u+s;)s+=1;o+=s-1,a=(0,OPe.union)(a,t((0,c_.pair)(u,u+s)))}}return a}$a.createExcludeCellSet=a1r;function i1r(e,r,t){var n=(0,BK.createFromProduct)({row:r}),a=(0,BK.createFromProduct)({col:t}),o=(0,BK.unionProduct)(n,a);return(0,BK.exceptProduct)((0,jCr.createCellSetFromRange)(e),o)}function o1r(e,r){switch(typeof r){case"string":return(0,GC.stringOper)(r);case"boolean":return(0,GC.booleanOper)(r);case"number":return e.fromNumber(r)}switch(r.kind){case"Blank":return GC.blankOper;case"Error":return(0,GC.errorOper)(r.type);default:return}}$a.cellValueToReadOper=o1r;function u1r(e,r){switch(r.kind){case s_.OperKind.String:case s_.OperKind.Boolean:return r.value;case s_.OperKind.Number:return e.toNumber(r);case s_.OperKind.Error:return(0,Um.errorValue)(r.type);case s_.OperKind.Blank:return Um.blankValue;default:return}}$a.readOperToCellValue=u1r;function s1r(e,r,t,n){if(!(0,c_.isNone)(n))switch(n.kind){case"NamedValue":switch(typeof n.value){case"string":return(0,qC.namedValue)((0,GC.stringOper)(n.value));case"boolean":return(0,qC.namedValue)((0,GC.booleanOper)(n.value));case"number":return(0,qC.namedValue)(e.fromNumber(n.value))}return n.value.kind==="Error"?(0,qC.namedValue)((0,GC.errorOper)(n.value.type)):(0,TN.assertNever)("calc.calc.namedObjectDataToNamedObject: NamedValue",n.value.kind);case"NamedFormula":return(0,qC.namedFormula)(n.formulaBarText);case"NamedRange":{var a=KK(t,n.range);return(0,qC.namedRange)((0,GC.range3DOper)(a.sheet,a.range))}case"NamedTable":{var o=KK(t,n.range);return(0,qC.namedTable)(o,n.hasHeadersRow,n.hasTotalsRow,n.columns,r)}case"NamedFailure":return(0,qC.namedFailure)(n.failureReason,(0,c_.isNone)(n.objectKind)?void 0:n.objectKind);default:return(0,TN.assertNever)("calc.calc.namedObjectDataToNamedObject: kind",n)}}$a.namedObjectDataToNamedObject=s1r;function l1r(e,r,t){if(t)switch(t.kind){case"NamedValue":switch(t.value.kind){case s_.OperKind.Number:return(0,Um.namedValueData)(e.toNumber(t.value));case s_.OperKind.String:case s_.OperKind.Boolean:return(0,Um.namedValueData)(t.value.value);case s_.OperKind.Error:return(0,Um.namedValueData)(t.value.type);default:return}case"NamedFormula":return(0,Um.namedFormulaData)(t.fmla);case"NamedRange":{var n=(0,l_.sheetGridRange)((0,l_.sheetIndex)(r,t.value.sheets.index),t.value.ranges[0]);return(0,Um.namedRangeData)(R$(n))}case"NamedTable":{var a=t.specialRefRanges[zCr.SpecialRefId.Data],o=[];return t.columnIndexes.forEach(function(u,s){return o.push((0,Um.columnData)(u,s)),!0}),(0,Um.namedTableData)(R$(a),t.hasHeadersRow,t.hasTotalsRow,o)}case"NamedFailure":return t;default:return(0,TN.assertNever)("calc.calc.namedObjectToNamedObjectData: kind",t)}}$a.namedObjectToNamedObjectData=l1r;function c1r(e){if(e!==void 0)return(0,CN.isOutputFormatUnavailable)(e.format)?(0,Um.inferredFormat)({kind:e.format.kind},e.valueType,e.decimals):(0,Um.inferredFormat)(e.format,e.valueType,e.decimals)}$a.cellFormatToInferredFormat=c1r;function d1r(e){if(e!=null)switch(e.kind){case"Origin":return{kind:CN.SpecialFormat.Origin};case"Iformat":return(0,TN.assertTrue)("calc.calc.evalFormulaFormatToUnion: iformat",typeof e.iformat=="number"),e.iformat;case"Known":return(0,TN.assertTrue)("calc.calc.evalFormulaFormatToUnion: knownFormat",typeof e.knownFormat=="number"),{kind:CN.SpecialFormat.Known,knownFormat:e.knownFormat};case"Inferred":return{kind:CN.SpecialFormat.Inferred};case"Aggregate":return{kind:CN.SpecialFormat.Aggregate};default:return(0,TN.assertNever)("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}$a.evalFormulaFormatToUnion=d1r});var wR=T(fv=>{"use strict";p();Object.defineProperty(fv,"__esModule",{value:!0});fv.incrementFailure=fv.RecalcServiceDataTransformer=fv.initialRecalcServiceConfig=void 0;var RN=fe(),xPe=No(),E$=Ar(),f1r=Gi(),Lh=RR(),bS=RR(),IPe=IR(),A$=ti(),p1r=AG(),F$=UM(),qh=Ss(),m1r=$A(),P$=Us(),ed=uv(),g1r=Ba();fv.initialRecalcServiceConfig={localeInfo:(0,f1r.getEnglishLocaleInfo)(),mathpack:p1r.xlMathpack,refStyle:A$.RefStyle.A1,timezone:F$.tzUTC,date1904:!1,dateCompatibility:!0,datepack:F$.xlDatepack};var v1r=function(){function e(){this.document=(0,xPe.documentLoc)(void 0,""),this.langConfig=fv.initialRecalcServiceConfig}return e.prototype.getLangConfig=function(){return this.langConfig},e.prototype.setA1ReferenceStyle=function(r,t,n){this.langConfig=RN.__assign(RN.__assign({},this.langConfig),{refStyle:n?A$.RefStyle.A1:A$.RefStyle.R1C1}),r.setLangConfig(t,this.langConfig)},e.prototype.setLocaleInfo=function(r,t,n,a){(0,bS.check)(n,bS.chLocaleData,a,"localeData")&&(this.langConfig=RN.__assign(RN.__assign({},this.langConfig),{localeInfo:(0,IPe.createLocaleInfo)(n,a)}),r.setLangConfig(t,this.langConfig))},e.prototype.setWorkbookProps=function(r,t,n,a){var o,u,s;(0,bS.check)(n,bS.chWorkbookProps,a,"workbookProps")&&(this.langConfig=RN.__assign(RN.__assign({},this.langConfig),{date1904:(o=n.date1904)!==null&&o!==void 0?o:fv.initialRecalcServiceConfig.date1904,dateCompatibility:(u=n.dateCompatibility)!==null&&u!==void 0?u:fv.initialRecalcServiceConfig.dateCompatibility,timezone:(s=n.timezone)!==null&&s!==void 0?s:fv.initialRecalcServiceConfig.timezone}),r.setLangConfig(t,this.langConfig))},e.prototype.updateSheetNames=function(r,t,n,a){r.setSheetNames(this.document,(0,bS.filterCheck)(n,bS.chSheetName,a,"sheetNames"),t)},e.prototype.updateNamedObjects=function(r,t,n,a){for(var o=(0,bS.filterCheck)(n,bS.chNamedObjectsUpdate,a,"namedObjectsUpdates"),u=0,s=o;u<s.length;u++){var l=s[u],c=l.scope,d=l.objects,f=l.fromStateId,m=(0,xPe.nameScope)(this.document,(0,E$.isDefined)(c)?c:void 0);if((0,E$.isDefined)(d))for(var v=(0,bS.filterCheck)(d,(0,bS.chNamedObject)(c),a,"namedObjectsUpdates.<index>.objects"),h=0,y=v;h<y.length;h++){var _=y[h],E=_.name,N=_.data;r.writeNamedObject(t,m,E,(0,IPe.namedObjectDataToNamedObject)(this.langConfig.mathpack,this.langConfig.localeInfo.stringCompareCI,this.document,N))}else(0,E$.isDefined)(f)?r.promoteNamedObjects(t,m,f):r.writeUndefinedNames(t,m)}},e}();fv.RecalcServiceDataTransformer=v1r;function h1r(e,r){var t,n;switch(r.kind){case ed.ReasonKind.NotImplemented:for(var a=0,o=r.features;a<o.length;a++){var u=o[a];(0,Lh.incrementStat)(e,"".concat(ed.ReasonKind.NotImplemented," ").concat(u))}break;case ed.ReasonKind.IllFormedFormula:(0,Lh.incrementStat)(e,"".concat(ed.ReasonKind.IllFormedFormula," ").concat((t=r.mode)!==null&&t!==void 0?t:""," ").concat(JSON.stringify({diagnostics:(n=r.diagnostics)!==null&&n!==void 0?n:{},message:r.mode===qh.FormulaMode.ServerCellFormula||r.mode===qh.FormulaMode.ServerNamedFormula?r.message:void 0})));break;case ed.ReasonKind.Unavailable:for(var s=0,l=r.objects;s<l.length;s++){var c=l[s],d=[ed.ReasonKind.Unavailable];if(typeof c.kind=="string"&&c.kind in qh.UnavailableKind){var f=c;switch(d.push(f.kind),f.kind){case qh.UnavailableKind.SheetId:d.push(f.sheetId);break;case qh.UnavailableKind.NameLoc:d.push(f.source),d.push(f.name.scope.index===void 0?"global":"sheet");break;case qh.UnavailableKind.ClientFailure:d.push(f.reason);break;case qh.UnavailableKind.CellFormula:case qh.UnavailableKind.EvalFailure:d.push(f.reason.kind);break;case qh.UnavailableKind.VolatileFunction:d.push(f.name);break;case qh.UnavailableKind.TimeGranularity:d.push(F$.TimeGranularity[f.granularity]);break;case qh.UnavailableKind.GetTimeKind:d.push(f.getTimeKind);break}}else d.push(JSON.stringify(c));(0,Lh.incrementStat)(e,d.join(" "))}break;case ed.ReasonKind.LimitExceeded:(0,Lh.incrementStat)(e,"".concat(r.kind," ").concat(ed.LimitKind[r.limit]));break;case P$.FormatReasonKind.NotFormatString:(0,Lh.incrementStat)(e,"".concat(r.kind," ").concat(r.message));break;case P$.FormatReasonKind.NotValueString:(0,Lh.incrementStat)(e,"".concat(r.kind," ").concat(r.message));break;case ed.ReasonKind.InvalidQualifier:(0,Lh.incrementStat)(e,"".concat(r.kind," ").concat(r.reason));break;case ed.ReasonKind.InvalidCellRef:(0,Lh.incrementStat)(e,"".concat(r.kind," ").concat(r.reason));break;case ed.ReasonKind.InvalidStructRef:(0,Lh.incrementStat)(e,"".concat(r.kind," ").concat(r.reason));break;case ed.ReasonKind.Internal:(0,Lh.incrementStat)(e,"".concat(r.kind," ").concat(r.message));break;case ed.ReasonKind.JavaScriptError:case m1r.ReasonKind.NotFormulaString:case ed.ReasonKind.CellCycle:case ed.ReasonKind.NameCycle:case ed.ReasonKind.Stopped:case ed.ReasonKind.PreviousFailure:case ed.ReasonKind.PreviousNameFailure:case P$.FormatReasonKind.PreviousFormatFailure:(0,Lh.incrementStat)(e,r.kind);break;default:(0,g1r.assertNever)("calc.calc.incrementFailure",r)}}fv.incrementFailure=h1r});var KPe=T(CS=>{"use strict";p();var kd,Rr;Object.defineProperty(CS,"__esModule",{value:!0});CS.PrecisionExperiment=CS.PrecisionStopReason=CS.PrecisionMessageKind=CS.precisionValue=void 0;var HK=fe(),EN=qi(),VK=No(),jK=Ar(),S1r=pr(),WK=xK(),qPe=Mh(),y1r=FPe(),LI=Tq(),_1r=Ss(),b1r=n_(),GPe=Zc(),BPe=Pf(),C1r=Gi(),UPe=Ba(),DR=Eg(),Km=zn(),O$=ks(),dr=Qf(),wPe=NPe(),N$=wR(),T1r=hc();function k$(e,r){switch(r.kind){case DR.OperKind.Number:return{kind:"n",magnitude:(0,WK.anonymizeMagnitude)(e.toNumber(r))};case DR.OperKind.String:return{kind:"s"};case DR.OperKind.Boolean:return{kind:"b"};case DR.OperKind.Error:return{kind:"e",type:(0,C1r.englishErrorTypeToName)(r.type)};case DR.OperKind.Rich:return{kind:"r"};case DR.OperKind.Array:return{kind:"a"};case DR.OperKind.Blank:return{kind:"z"};default:return(0,UPe.assertNever)("calc.calc.precisionValue",r)}}CS.precisionValue=k$;function R1r(e){return e.sampled===void 0}var Gh;(function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"})(Gh||(CS.PrecisionMessageKind=Gh={}));var qI;(function(e){e.Success="Success",e.Timeout="Timeout"})(qI||(CS.PrecisionStopReason=qI={}));function DPe(e,r){var t=e[r.sheet.index];return t!==void 0&&(0,BPe.meetsProduct)(t,(0,GPe.createCellSetFromRange)(r.range))}function LPe(e,r){var t,n=(t=e[r.sheet.index])!==null&&t!==void 0?t:qPe.empty;e[r.sheet.index]=(0,BPe.unionProduct)(n,(0,GPe.createCellSetFromRange)(r.range))}var E1r=(kd={},kd[dr.OperatorId.Add]=.05,kd[dr.OperatorId.Sub]=.069,kd[dr.OperatorId.Eq]=.097,kd[dr.OperatorId.Mul]=.1,kd[dr.OperatorId.Div]=.11,kd[dr.OperatorId.Concat]=.36,kd[dr.OperatorId.Gt]=.65,kd[dr.OperatorId.Ne]=.79,kd[dr.OperatorId.Lt]=.89,kd[dr.OperatorId.Le]=1.6,kd[dr.OperatorId.Ge]=1.9,kd[dr.OperatorId.Percent]=2.9,kd[dr.OperatorId.At]=6.2,kd[dr.OperatorId.Pow]=13,kd[dr.OperatorId.Range]=67,kd),P1r=(Rr={},Rr[dr.WorksheetFuncId.IF]=.076,Rr[dr.WorksheetFuncId.SUM]=.11,Rr[dr.WorksheetFuncId.IFERROR]=.5,Rr[dr.WorksheetFuncId.COUNTIF]=.77,Rr[dr.WorksheetFuncId.AND]=.82,Rr[dr.WorksheetFuncId.VLOOKUP]=1.5,Rr[dr.WorksheetFuncId.AVERAGE]=1.5,Rr[dr.WorksheetFuncId.HOUR]=1.9,Rr[dr.WorksheetFuncId.MINUTE]=1.9,Rr[dr.WorksheetFuncId.TEXT]=2,Rr[dr.WorksheetFuncId.OR]=2,Rr[dr.WorksheetFuncId.NOW]=2.1,Rr[dr.WorksheetFuncId.ISBLANK]=2.3,Rr[dr.WorksheetFuncId.CONCATENATE]=2.6,Rr[dr.WorksheetFuncId.SUMIF]=2.7,Rr[dr.WorksheetFuncId.COUNTIFS]=3.3,Rr[dr.WorksheetFuncId.LEFT]=3.4,Rr[dr.WorksheetFuncId.ISNUMBER]=3.7,Rr[dr.WorksheetFuncId.MID]=3.9,Rr[dr.WorksheetFuncId.COUNTA]=4,Rr[dr.WorksheetFuncId.MONTH]=4.2,Rr[dr.WorksheetFuncId.SECOND]=4.3,Rr[dr.WorksheetFuncId.LEN]=4.9,Rr[dr.WorksheetFuncId.WEEKNUM]=5,Rr[dr.WorksheetFuncId.DAY]=5.2,Rr[dr.WorksheetFuncId.ROUND]=5.4,Rr[dr.WorksheetFuncId.FIND]=5.8,Rr[dr.WorksheetFuncId.NETWORKDAYS]=6.2,Rr[dr.WorksheetFuncId.COUNT]=6.2,Rr[dr.WorksheetFuncId.YEAR]=6.3,Rr[dr.WorksheetFuncId.INT]=6.4,Rr[dr.WorksheetFuncId.RIGHT]=6.7,Rr[dr.WorksheetFuncId.ABS]=7,Rr[dr.WorksheetFuncId.CONCAT]=7.2,Rr[dr.WorksheetFuncId.CHAR]=7.4,Rr[dr.WorksheetFuncId.MAX]=8,Rr[dr.WorksheetFuncId.ROW]=8.1,Rr[dr.WorksheetFuncId.WEEKDAY]=9.1,Rr[dr.WorksheetFuncId.DAYS]=9.2,Rr[dr.WorksheetFuncId.MIN]=9.8,Rr[dr.WorksheetFuncId.SEARCH]=9.8,Rr[dr.WorksheetFuncId.WORKDAY]=11,Rr[dr.WorksheetFuncId.DATEDIF]=12,Rr[dr.WorksheetFuncId.TIME]=13,Rr[dr.WorksheetFuncId.HYPERLINK]=13,Rr[dr.WorksheetFuncId.IFS]=13,Rr[dr.WorksheetFuncId.ISERROR]=13,Rr[dr.WorksheetFuncId.COUNTBLANK]=14,Rr[dr.WorksheetFuncId.TODAY]=14,Rr[dr.WorksheetFuncId.VALUE]=18,Rr[dr.WorksheetFuncId.ROUNDUP]=18,Rr[dr.WorksheetFuncId.MATCH]=19,Rr[dr.WorksheetFuncId.DATE]=20,Rr[dr.WorksheetFuncId.SUBSTITUTE]=20,Rr[dr.WorksheetFuncId.INDIRECT]=22,Rr[dr.WorksheetFuncId.INDEX]=23,Rr[dr.WorksheetFuncId.TRIM]=24,Rr[dr.WorksheetFuncId.UPPER]=25,Rr[dr.WorksheetFuncId.SUMIFS]=28,Rr[dr.WorksheetFuncId.EXACT]=29,Rr[dr.WorksheetFuncId.NOT]=32,Rr[dr.WorksheetFuncId.PRODUCT]=35,Rr[dr.WorksheetFuncId.ROUNDDOWN]=37,Rr[dr.WorksheetFuncId.AVERAGEIF]=38,Rr[dr.WorksheetFuncId.ISTEXT]=40,Rr[dr.WorksheetFuncId.ISOWEEKNUM]=41,Rr[dr.WorksheetFuncId.EOMONTH]=42,Rr[dr.WorksheetFuncId.MROUND]=45,Rr[dr.WorksheetFuncId.COLUMN]=45,Rr[dr.WorksheetFuncId.ROWS]=46,Rr[dr.WorksheetFuncId.TIMEVALUE]=52,Rr[dr.WorksheetFuncId.TRUNC]=53,Rr[dr.WorksheetFuncId.LOOKUP]=59,Rr[dr.WorksheetFuncId.NA]=59,Rr[dr.WorksheetFuncId.DAYS360]=61,Rr[dr.WorksheetFuncId.RANK]=67,Rr[dr.WorksheetFuncId.EDATE]=72,Rr[dr.WorksheetFuncId.MOD]=82,Rr[dr.WorksheetFuncId.OFFSET]=83,Rr[dr.WorksheetFuncId.STDEV]=87,Rr[dr.WorksheetFuncId.SUBTOTAL]=91,Rr),A1r=(0,O$.binaryVisitor)(HK.__assign(HK.__assign({},(0,O$.constVisitor)(.01)),{nameNode:function(){return 1},operatorNode:function(r){var t;return(t=E1r[r])!==null&&t!==void 0?t:100},wsfNode:function(r){var t;return(t=P1r[r])!==null&&t!==void 0?t:100}}),jK.fastMax);function F1r(e){return(0,Km.isSuccess)(e)?(0,O$.reduceBottomUp)(A1r,e.value):1}var N1r=function(){function e(r){var t=this,n,a,o,u;this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=function(s){var l=s.cell,c=s.p;return t.resumeToPledge(function(){return t.docs.evaluate(_1r.ComputeKind.EditedCell,[l],T1r.VolatileMode.PrecisionTest)},c)},this.testPrint=function(s){var l=s.cell,c=s.p;return LI.Pledge.try(function(){var d=t.getFormula(l);if(!(0,Km.isSuccess)(d))return t.onUnavailableObject(d.reason);var f=d.value,m=f[0],v=f[1],h;if(v.compiledFmla===void 0){var y=t.docs.getServerValue(l);if(!(0,Km.isSuccess)(y))return t.onUnavailableObject(y.reason);h=t.docs.renderValueBarText(l,y.value.oper,v.fmla)}else{var _=v.compiledFmla.getValue();h=(0,Km.isSuccess)(_)?t.docs.printFormulaBarText(m,v.origin,_.value):_}if(!(0,Km.isSuccess)(h))return void t.log.push({kind:Gh.PrintFormulaStatistics,stats:{samples:[],failures:[h.reason]}});var E=(0,WK.anonymizeFormulaString)(v.fmla),N=h.value===v.fmla?{expected:E,p:c}:{expected:E,sampled:(0,WK.anonymizeFormulaString)(h.value),p:c};t.log.push({kind:Gh.PrintFormulaStatistics,stats:{samples:[N],failures:[]}})})},this.config={samplePrecisionEvalRate:(n=r.samplePrecisionEvalRate)!==null&&n!==void 0?n:0,samplePrecisionPrintFormulaRate:(a=r.samplePrecisionPrintFormulaRate)!==null&&a!==void 0?a:0,samplePrecisionPrintValueRate:(o=r.samplePrecisionPrintValueRate)!==null&&o!==void 0?o:0,rngSeed:(u=r.rngSeed)!==null&&u!==void 0?u:(0,jK.now)()|0},this.rng=new S1r.JSF32(this.config.rngSeed)}return Object.defineProperty(e.prototype,"done",{get:function(){return this.result!==void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return this.createResultLogMessage(qI.Success)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.createResultLogMessage(qI.Timeout)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readonlyDebugLog",{get:function(){return this.log},enumerable:!1,configurable:!0}),e.prototype.setContext=function(r){var t=this;this.stateId=r.stateId,this.docs=r.documents,this.docs.reconfigure({yieldIntervalMs:r.stepBudget/2,totalTimeMs:r.totalBudget},this.docs.limits,this.docs.maxDereferenceCells,this.docs.isServerWorkbookLoad),this.runtime=new y1r.MachineRuntime(this.sampleCells().bind(function(n){var a=n.evalCells,o=n.printCells;return LI.Pledge.all(HK.__spreadArray(HK.__spreadArray([],a.map(t.testEval),!0),o.map(t.testPrint),!0))}).catch(function(n){t.log.push({kind:Gh.UnhandledFailure,reason:n})}))},e.prototype.step=function(){if(!this.result){var r=this.runtime.step();this.result=r.kind===wPe.TransitionKind.Break||r.kind===wPe.TransitionKind.Next?void 0:r}},e.prototype.sampleCells=function(){var r=this,t=[],n=[],a=[];return this.docs.getServerAvailableCells().forEach(function(o){var u=o.sheetIdx;return a.push(LI.Pledge.try(function(){r.docs.forEachServerNonBlankCellInSet(u,qPe.dense,function(s){var l=(0,VK.sheetGridCell)(u,s),c=r.config,d=c.samplePrecisionEvalRate,f=c.samplePrecisionPrintFormulaRate,m=c.samplePrecisionPrintValueRate;if(d>0){var v=r.getWeight(l),h=v===void 0?void 0:d>=1?1:(0,jK.fastMin)(1,d*v);h!==void 0&&r.rng.next()<h&&(LPe(r.sampledSets,l),t.push({cell:l,p:h}))}var y=(0,jK.fastMax)(f,m);if(y>0){var _=r.rng.next();if(_<y){var h=r.isValueCell(l)?m:f;_<h&&n.push({cell:l,p:h})}}return!0})})),!0}),LI.Pledge.all(a).bind(function(){return{evalCells:t,printCells:n}})},e.prototype.getWeight=function(r){var t=this.getFormula(r);if(!(0,Km.isSuccess)(t))return this.onUnavailableObject(t.reason);var n=t.value,a=n[1];if(a.compiledFmla!==void 0)return F1r(a.compiledFmla.getValue())},e.prototype.isValueCell=function(r){var t=this.getFormula(r);return(0,Km.isSuccess)(t)?t.value[1].compiledFmla===void 0:(this.onUnavailableObject(t.reason),!1)},e.prototype.resumeToPledge=function(r,t){var n=this;return LI.Pledge.try(function(){try{n.p=t;var a=r();return Array.isArray(a)?a:n.resumeToPledge(a.resume,t)}finally{n.p=void 0}})},e.prototype.getFormula=function(r){var t,n=this.docs.getEditedFormula(r);if(!(0,Km.isSuccess)(n))return n;var a=(t=n.value)!==null&&t!==void 0?t:[r.range,b1r.blankCellGridFormula],o=a[0],u=a[1],s=(0,VK.lexicalSourceGrid)(u.lexicalKind,(0,VK.sheetGridRange)(r.sheet,o));return(0,Km.success)([s,u])},e.prototype.onRangeFailure=function(r,t,n,a,o){var u={samples:[],failures:[t]};this.log.push({kind:Gh.EvalStatistics,stats:u})},e.prototype.onNameFailure=function(){},e.prototype.onNumberFormatFailure=function(){},e.prototype.onInferFormatFailure=function(){},e.prototype.onReturnCellValue=function(){},e.prototype.onUnavailableObject=function(r){var t=(0,EN.unavailable)([r]);this.onUnavailable(t)},e.prototype.onUnavailable=function(r){this.log.push({kind:Gh.UnhandledFailure,reason:r})},e.prototype.hasWrongPrecedent=function(r){var t=this;return r.cells.some(function(n){return DPe(t.precisionWrongSets,n)})},e.prototype.onSetCellValue=function(r,t,n,a,o){var u=this.getFormula(r);if(!(0,Km.isSuccess)(u))return this.onUnavailableObject(u.reason);var s=u.value,l=s[0],c=s[1],d=this.hasWrongPrecedent(n);return this.logPrecisionResult(r,t,l,c,d)},e.prototype.onSetCellValues=function(r,t,n,a,o){var u=this,s=this.getFormula((0,EN.sheetGridRangeAnchor)(r));if(!(0,Km.isSuccess)(s))return this.onUnavailableObject(s.reason);var l=s.value,c=l[0],d=l[1],f=this.hasWrongPrecedent(n);(0,EN.forEachCellInRange)(r.range,function(m,v,h){return u.logPrecisionResult((0,VK.sheetGridCell)(r.sheet,m),t[v][h],c,d,f),!0})},e.prototype.logPrecisionResult=function(r,t,n,a,o){var u=this.docs.allServerAvailable(r);if(!(0,Km.isSuccess)(u))return this.onUnavailableObject(u.reason);if(u.value===!0){var s=this.docs.getServerValue(r);if(!(0,Km.isSuccess)(s))return this.onUnavailableObject(s.reason);var l=DPe(this.sampledSets,r),c=this.precisionResult(t,s.value.oper,n,a,l,o);R1r(c)||LPe(this.precisionWrongSets,r);var d={samples:[c],failures:[]};this.log.push({kind:Gh.EvalStatistics,stats:d})}},e.prototype.precisionResult=function(r,t,n,a,o,u){var s=this.p,l=this.docs.config.mathpack,c=k$(l,t),d=this.docs.anonymizeFormula(n,a),f=d[0],m=d[1];if((0,EN.isReadOperEqual)(l,r,t,!0)){var v={expected:c,formula:f,functions:m,root:o,cascaded:u,p:s};return v}var h=k$(l,r);if((0,EN.isNumberOper)(t)&&(0,EN.isNumberOper)(r)){var y=l.toNumber(t),_=l.toNumber(r),E=(0,WK.anonymizeMagnitude)(y===0?_:(_-y)/y),N={expected:c,sampled:h,relMagnitude:E,formula:f,functions:m,root:o,cascaded:u,p:s};return N}var k={expected:c,sampled:h,formula:f,functions:m,root:o,cascaded:u,p:s};return k},e.prototype.createResultLogMessage=function(r){var t,n;if(!(this.log.length===0&&r===qI.Success)){for(var a={samples:[],failures:{}},o={samples:[],failures:{}},u={},s=0,l=this.log;s<l.length;s++){var c=l[s];switch(c.kind){case Gh.EvalStatistics:(t=a.samples).push.apply(t,c.stats.samples);for(var d=0,f=c.stats.failures;d<f.length;d++){var m=f[d];(0,N$.incrementFailure)(a.failures,m)}break;case Gh.PrintFormulaStatistics:(n=o.samples).push.apply(n,c.stats.samples);for(var v=0,h=c.stats.failures;v<h.length;v++){var m=h[v];(0,N$.incrementFailure)(o.failures,m)}break;case Gh.UnhandledFailure:(0,N$.incrementFailure)(u,c.reason);break;default:(0,UPe.assertNever)("calc.calc.PrecisionExperiment.createResultMessage",c)}}return["PrecisionExperiment",r,"stateId = ".concat(this.stateId),"evalStats = ".concat(JSON.stringify(a)),"printStats = ".concat(JSON.stringify(o)),"unhandledFailures = ".concat(JSON.stringify(u))].join(", ")}},e}();CS.PrecisionExperiment=N1r});var zK=T(PN=>{"use strict";p();Object.defineProperty(PN,"__esModule",{value:!0});PN.Timer=PN.createPerf=void 0;var O1r=1e9,k1r=1e6;function VPe(){return typeof process<"u"?{now:function(){var r=process.hrtime(),t=r[0],n=r[1];return(t*O1r+n)/k1r}}:typeof performance<"u"?performance:Date}PN.createPerf=VPe;var M1r=function(){function e(r){this.perf=VPe(),this.name=r,this.start()}return e.prototype.start=function(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS},e.prototype.split=function(r){var t=this.perf.now(),n=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+r+" : = "+this.roundMe(n)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t},e.prototype.elapsedTime=function(){return this.perf.now()-this.startTimeMS},e.prototype.roundMe=function(r){return Math.round(r*100)/100},e}();PN.Timer=M1r});var XK=T(QK=>{"use strict";p();Object.defineProperty(QK,"__esModule",{value:!0});QK.watchdog=void 0;var x1r=zK(),jPe=(0,x1r.createPerf)();function I1r(){var e=1/0,r=function(n){if(n===void 0&&(n=""),jPe.now()>e)throw new Error("Time limit exceeded with message: ".concat(n))};return r.arm=function(t){e=jPe.now()+t},r}QK.watchdog=I1r()});var M$=T(YK=>{"use strict";p();Object.defineProperty(YK,"__esModule",{value:!0});YK.ExcelUtils=void 0;var Vm=XK(),w1r=function(){function e(){}return e.column_name_to_index=function(r){if(r.length===1)return r[0].charCodeAt(0)-"A".charCodeAt(0)+1;for(var t=0,n=r.split(""),a=0,o=n;a<o.length;a++){var u=o[a];t*=26,t+=u.charCodeAt(0)-"A".charCodeAt(0)+1}return t},e.column_index_to_name=function(r){for(var t="";r>0;)t+=String.fromCharCode((r-1)%26+65),r=Math.floor((r-1)/26);return t.split("").reverse().join("")},e.cell_dependency=function(r,t,n){(0,Vm.watchdog)("wd0x1a9bd3");var a=!1;{var o=e.cell_both_absolute.exec(r);if(o){var u=e.column_name_to_index(o[1]),s=Number(o[2]);return o[2][0]>="\u2000"&&(s=Number(o[2].charCodeAt(0)-16384)),[u,s,0]}}(0,Vm.watchdog)("wd0xa26bda");{var o=e.cell_col_absolute.exec(r);if(o){var u=e.column_name_to_index(o[1]),s=Number(o[2]);return o[2][0]>="\u2000"&&(s=Number(o[2].charCodeAt(0)-16384)),[u,s-n,0]}}(0,Vm.watchdog)("wd0x2a23e1");{var o=e.cell_row_absolute.exec(r);if(o){var u=e.column_name_to_index(o[1]),s=Number(o[2]);return o[2][0]>="\u2000"&&(s=Number(o[2].charCodeAt(0)-16384)),[u-t,s,0]}}(0,Vm.watchdog)("wd0x3ebc91");{var o=e.cell_both_relative.exec(r);if(o){var u=e.column_name_to_index(o[1]),s=Number(o[2]);return o[2][0]>="\u2000"&&(s=Number(o[2].charCodeAt(0)-16384)),[u-t,s-n,0]}}throw new Error("We should never get here.")},e.toR1C1=function(r,t,n){n===void 0&&(n=!1);var a=e.cell_dependency(r,0,0),o=e.cell_dependency(t,0,0),u="R",s="C";n&&(u="\u03C1",s="\u03B3");var l=[];o.forEach(function(d,f,m){l.push(d-a[f])});var c="";return e.cell_both_absolute.exec(t)?c=u+o[1]+s+o[0]:e.cell_col_absolute.exec(t)?(l[1]===0?c+=u:c+=u+"["+l[1]+"]",c+=s+o[0]):e.cell_row_absolute.exec(t)?(l[0]===0?c+=s:c+=s+"["+l[0]+"]",c=u+o[1]+c):(l[1]===0?c+=u:c+=u+"["+l[1]+"]",l[0]===0?c+=s:c+=s+"["+l[0]+"]"),c},e.formulaToR1C1=function(r,t,n){for(var a=r.slice(),o=e.column_index_to_name(t)+n,u;u=e.range_pair.exec(a);)if(u){var s=u[1],l=u[2];a=a.replace(u[0],e.toR1C1(o,u[1],!0)+":"+e.toR1C1(o,u[2],!0))}for(var c=null;c=e.single_dep.exec(a);)if(c){var s=c[1];a=a.replace(c[0],e.toR1C1(o,s,!0))}return a=a.replace(//g,"R"),a=a.replace(//g,"C"),a},e.extract_sheet_cell=function(r){(0,Vm.watchdog)("wd0x012630");var t=e.sheet_plus_cell.exec(r);return t?[t[1],t[2],t[2]]:["","",""]},e.all_cell_dependencies=function(r,t,n,a){a===void 0&&(a=!0),(0,Vm.watchdog)("wd0x2f82fe");var o=r,u=null,s=[];if(typeof r!="string")return null;for(r=r.replace(this.formulas_with_numbers,"_"),r=r.replace(this.formulas_with_quoted_sheetnames_2,"_"),r=r.replace(this.formulas_with_quoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_2,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_structured_references,"_");u=e.range_pair.exec(r);)if((0,Vm.watchdog)("wd0x784918"),u){for(var l=u[1],c=e.cell_dependency(l,t,n),d=u[2],f=e.cell_dependency(d,t,n),m=f[0]-c[0]+1,v=f[1]-c[1]+1,h=0;h<m;h++)for(var y=0;y<v;y++)s.push([h+c[0],y+c[1],0]);r=r.replace(u[0],"_")}for(var _=null;_=e.single_dep.exec(r);)if((0,Vm.watchdog)("wd0x0fb232"),_){var l=_[1],E=e.cell_dependency(l,t,n);s.push(E),r=r.replace(_[0],"_")}if(a)for(var N=null;N=e.number_dep.exec(r);)(0,Vm.watchdog)("wd0xd82ed1"),N&&(s.push([0,0,1]),r=r.replace(N[0],"_"));return s},e.numeric_constants=function(r){var t=[];if(r=r.slice(),typeof r!="string")return t;r=r.replace(this.formulas_with_numbers,"_"),r=r.replace(this.formulas_with_quoted_sheetnames_2,"_"),r=r.replace(this.formulas_with_quoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_2,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_unquoted_sheetnames_1,"_"),r=r.replace(this.formulas_with_structured_references,"_");for(var n=null;n=e.range_pair.exec(r);)n&&(r=r.replace(n[0],"_"));for(var a=null;a=e.single_dep.exec(r);)a&&(r=r.replace(a[0],"_"));for(var o=null;o=e.number_dep.exec(r);)o&&(t.push(parseFloat(o)),r=r.replace(o[0],"_"));return t},e.baseVector=function(){return[0,0,0]},e.all_dependencies=function(r,t,n,a,o){(0,Vm.watchdog)("wd0x961028");var u=[];if(r>=o.length||t>=o[0].length||r<0||t<0)return[];var s=o[r][t];return s.length>1&&s[0]==="="&&(u=e.all_cell_dependencies(s,a,n)),u},e.generate_all_references=function(r,t,n){(0,Vm.watchdog)("wd0x6a6002");for(var a={},o=0;o<r.length;o++)for(var u=r[o],s=0;s<u.length;s++){(0,Vm.watchdog)("wd0x93d412");var l=u[s];if(l[0]==="=")for(var c=e.all_cell_dependencies(l,0,0),d=0,f=c;d<f.length;d++){var m=f[d];if((0,Vm.watchdog)("wd0x8a466e"),!(m[0]===0&&m[1]===0&&m[2]!==0)){var v=m[0]-t-1,h=m[1]-n-1,y=h>=r.length||v>=r[0].length||v<0||h<0;{var _=!1;if(y)_=!0;else{var E=r[h][v];E!==void 0&&E[0]!=="="&&(_=!0)}if(_){var N=m.join(",");a[N]=!0}}}}}return a},e.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",e.sheet_re="[^\\!]+",e.sheet_plus_cell=new RegExp("("+e.sheet_re+")\\!("+e.general_re+")"),e.sheet_plus_range=new RegExp("("+e.sheet_re+")\\!("+e.general_re+"):("+e.general_re+")"),e.single_dep=new RegExp("("+e.general_re+")"),e.range_pair=new RegExp("("+e.general_re+"):("+e.general_re+")","g"),e.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),e.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),e.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),e.originalSheetSuffix="_EL",e}();YK.ExcelUtils=w1r});var WPe=T(JK=>{"use strict";p();Object.defineProperty(JK,"__esModule",{value:!0});JK.RectangleUtils=void 0;var D1r=function(){function e(){}return e.is_adjacent=function(r,t){var n=r[0],a=n[0],o=n[1],u=n[2],s=r[1],l=s[0],c=s[1],d=s[2],f=t[0],m=f[0],v=f[1],h=f[2],y=t[1],_=y[0],E=y[1],N=y[2],k=1,q=!(a-_>k||m-l>k||o-E>k||v-c>k);return q},e.bounding_box=function(r,t){var n=r[0],a=n[0],o=n[1],u=n[2],s=r[1],l=s[0],c=s[1],d=s[2],f=t[0],m=f[0],v=f[1],h=f[2],y=t[1],_=y[0],E=y[1],N=y[2];return[[Math.min(a,m),Math.min(o,v),0],[Math.max(l,_),Math.max(c,E),0]]},e.area=function(r){var t=r[0],n=t[0],a=t[1],o=t[2],u=r[1],s=u[0],l=u[1],c=u[2],d=s-n+1,f=l-a+1;return d*f},e.diagonal=function(r){var t=r[0],n=t[0],a=t[1],o=t[2],u=r[1],s=u[0],l=u[1],c=u[2],d=s-n+1,f=l-a+1;return Math.sqrt(d*d+f*f)},e.overlap=function(r,t){var n=r[0],a=n[0],o=n[1],u=n[2],s=r[1],l=s[0],c=s[1],d=s[2],f=t[0],m=f[0],v=f[1],h=f[2],y=t[1],_=y[0],E=y[1],N=y[2],k=0,q=0;return l>_?k=_-a+1:k=l-m+1,c>E?q=E-o+1:q=c-v+1,k*q},e.is_mergeable=function(r,t){return e.is_adjacent(r,t)&&e.area(r)+e.area(t)-e.overlap(r,t)===e.area(e.bounding_box(r,t))},e}();JK.RectangleUtils=D1r});var HPe=T(ZK=>{"use strict";p();Object.defineProperty(ZK,"__esModule",{value:!0});ZK.JSONclone=void 0;var L1r=function(){function e(){}return e.clone=function(r){if(r){if(Array.isArray(r))return r.slice();if(r.constructor===Object){for(var t={},n=0,a=Object.keys(r);n<a.length;n++){var o=a[n];t[o]=e.clone(r[o])}return t}return r}return null},e}();ZK.JSONclone=L1r});var zPe=T(AN=>{"use strict";p();Object.defineProperty(AN,"__esModule",{value:!0});AN.Stencil=AN.InfoGain=void 0;var q1r=function(){function e(){}return e.normalized_entropy=function(r){for(var t=r.reduce(function(u,s){return u+s},0),n=0,a=0;a<r.length;a++){var o=r[a]/t;o!==0&&(n-=o*Math.log2(o))}return n/Math.log2(t)},e}();AN.InfoGain=q1r;var G1r=function(){function e(){}return e.initialize=function(){if(!e.initialized){if(e.stencil_right=e.stencil.filter(function(t){var n=t[0],a=t[1];return n<=0}),e.stencil_left=e.stencil.filter(function(t){var n=t[0],a=t[1];return n>=0}),e.stencil_top=e.stencil.filter(function(t){var n=t[0],a=t[1];return a>=0}),e.stencil_bottom=e.stencil.filter(function(t){var n=t[0],a=t[1];return a<=0}),e.stencil_topleft=e.stencil_top.filter(function(t){var n=t[0],a=t[1];return n>=0}),e.stencil_topright=e.stencil_top.filter(function(t){var n=t[0],a=t[1];return n<=0}),e.stencil_bottomleft=e.stencil_bottom.filter(function(t){var n=t[0],a=t[1];return n>=0}),e.stencil_bottomright=e.stencil_bottom.filter(function(t){var n=t[0],a=t[1];return n<=0}),e.reflectStencils){var r=void 0;r=e.stencil.filter(function(t){var n=t[0],a=t[1];return n>0}).map(function(t){var n=t[0],a=t[1];return[-n,a]}),e.stencil_right=e.stencil_right.concat(r),r=e.stencil.filter(function(t){var n=t[0],a=t[1];return n<0}).map(function(t){var n=t[0],a=t[1];return[-n,a]}),e.stencil_left=e.stencil_left.concat(r),r=e.stencil.filter(function(t){var n=t[0],a=t[1];return a<0}).map(function(t){var n=t[0],a=t[1];return[n,-a]}),e.stencil_top=e.stencil_top.concat(r),r=e.stencil.filter(function(t){var n=t[0],a=t[1];return a>0}).map(function(t){var n=t[0],a=t[1];return[n,-a]}),e.stencil_bottom=e.stencil_bottom.concat(r),r=e.stencil_top.filter(function(t){var n=t[0],a=t[1];return n<0}).map(function(t){var n=t[0],a=t[1];return[-n,a]}),e.stencil_topleft=e.stencil_topleft.concat(r),r=e.stencil_left.filter(function(t){var n=t[0],a=t[1];return a<0}).map(function(t){var n=t[0],a=t[1];return[n,-a]}),e.stencil_topleft=e.stencil_topleft.concat(r),e.stencil_topleft.splice(e.stencil_topleft.findIndex(function(t){return JSON.stringify(t)===JSON.stringify([1,1])}),1),r=e.stencil_top.filter(function(t){var n=t[0],a=t[1];return n>0}).map(function(t){var n=t[0],a=t[1];return[-n,a]}),e.stencil_topright=e.stencil_topright.concat(r),r=e.stencil_right.filter(function(t){var n=t[0],a=t[1];return a<0}).map(function(t){var n=t[0],a=t[1];return[n,-a]}),e.stencil_topright=e.stencil_topright.concat(r),e.stencil_topright.splice(e.stencil_topright.findIndex(function(t){return JSON.stringify(t)===JSON.stringify([-1,1])}),1),r=e.stencil_bottom.map(function(t){var n=t[0],a=t[1];return[-n,a]}).filter(function(t){var n=t[0],a=t[1];return n>0}),e.stencil_bottomleft=e.stencil_bottomleft.concat(r),r=e.stencil_left.map(function(t){var n=t[0],a=t[1];return[n,-a]}).filter(function(t){var n=t[0],a=t[1];return a<0}),e.stencil_bottomleft=e.stencil_bottomleft.concat(r),e.stencil_bottomleft.splice(e.stencil_bottomleft.findIndex(function(t){return JSON.stringify(t)===JSON.stringify([1,-1])}),1),r=e.stencil_bottom.map(function(t){var n=t[0],a=t[1];return[-n,a]}).filter(function(t){var n=t[0],a=t[1];return n<0}),e.stencil_bottomright=e.stencil_bottomright.concat(r),r=e.stencil_right.map(function(t){var n=t[0],a=t[1];return[n,-a]}).filter(function(t){var n=t[0],a=t[1];return a<0}),e.stencil_bottomright=e.stencil_bottomright.concat(r),e.stencil_bottomright.splice(e.stencil_bottomright.findIndex(function(t){return JSON.stringify(t)===JSON.stringify([-1,-1])}),1)}e.initialized=!0}},e.apply_stencil=function(r,t,n,a,o,u){if(r.length!==e.stencil.length)throw Error("Length mismatched");for(var s=o,l=0;l<r.length;l++){var c=r[l],d=c[0],f=c[1];s=u(s,t[n+f][a+d])}return s},e.stencil_computation=function(r,t,n){e.initialize();for(var a=r.length,o=r[0].length,u=Array(a).fill(0).map(function(){return Array(o).fill(0)}),s=1;s<o-1;s++)for(var l=1;l<a-1;l++)u[l][s]=e.apply_stencil(e.stencil,r,s,l,n,t);for(var l=1;l<o-1;l++)u[0][l]=e.apply_stencil(e.stencil_top,r,0,l,n,t),u[a-1][l]=e.apply_stencil(e.stencil_bottom,r,a-1,l,n,t);for(var s=1;s<a-1;s++)u[s][0]=e.apply_stencil(e.stencil_left,r,s,0,n,t),u[s][o-1]=e.apply_stencil(e.stencil_right,r,s,o-1,n,t);return u[0][0]=e.apply_stencil(e.stencil_topleft,r,0,0,n,t),u[0][o-1]=e.apply_stencil(e.stencil_topright,r,0,o-1,n,t),u[a-1][0]=e.apply_stencil(e.stencil_bottomleft,r,a-1,0,n,t),u[a-1][o-1]=e.apply_stencil(e.stencil_bottomright,r,a-1,o-1,n,t),u},e.reflectStencils=!0,e.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],e.stencil=e.ninePointStencil,e.initialized=!1,e}();AN.Stencil=G1r});var XPe=T(FN=>{"use strict";p();Object.defineProperty(FN,"__esModule",{value:!0});FN.strict_binsearch=FN.binsearch=void 0;function QPe(e,r,t){for(var n=e.length,a=0,o=n;a<o;){var u=Math.floor((a+o)/2);t(e[u],r)<0?a=u+1:o=u}return a}function B1r(e,r,t){return t===void 0&&(t=void 0),typeof t>"u"&&(t=function(a,o){return a===o?0:a<o?-1:1}),QPe(e,r,t)}FN.binsearch=B1r;function U1r(e,r,t){t===void 0&&(t=void 0);var n=QPe(e,r,t);return n===e.length||t(e[n],r)!==0?-1:n}FN.strict_binsearch=U1r});var rAe=T(TS=>{"use strict";p();Object.defineProperty(TS,"__esModule",{value:!0});TS.numComparator=TS.find_all_proposed_fixes=TS.Colorize=TS.tuple=void 0;var GI=M$(),NN=WPe(),YPe=zK(),K1r=HPe(),V1r=zPe(),rd=XK(),ON=XPe();function ZPe(e,r){if(typeof e=="number")return e-r;e=e,r=r;for(var t=0;t<e.length;t+=1){var n=ZPe(e[t],r[t]);if(n!==0)return n}return 0}function x$(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e}TS.tuple=x$;var $Pe=function(){function e(){}return e.setReportingThreshold=function(r){e.reportingThreshold=r},e.getReportingThreshold=function(){return e.reportingThreshold},e.setFormattingDiscount=function(r){e.formattingDiscount=r},e.getFormattingDiscount=function(){return e.formattingDiscount},e.process_formulas=function(r,t,n){(0,rd.watchdog)("wd0xea1170");for(var a=JSON.stringify(GI.ExcelUtils.baseVector()),o=function(N,k){return[N[0]+k[0],N[1]+k[1],N[2]+k[2]]},u=[],s=0;s<r.length;s++){(0,rd.watchdog)("wd0xa1597b");for(var l=r[s],c=0;c<l.length;c++){(0,rd.watchdog)("wd0x0d7fc8");var d=l[c].toString();if(d.length>0){var f=GI.ExcelUtils.all_dependencies(s,c,n+s,t+c,r),m=c+t+1,v=s+n+1;if(f.length===0)d[0]==="="&&u.push([[m,v,0],e.distinguishedZeroHash]);else{var h=f.reduce(o);if(JSON.stringify(h)===a)u.push([[m,v,0],h.toString()]);else{var y=this.hash_vector(h),_=y.toString();u.push([[m,v,0],_])}}}}}return u},e.color_all_data=function(r){for(var t=[],n=0,a=Object.keys(r);n<a.length;n++){var o=a[n];(0,rd.watchdog)("wd0xc22046");var u=o.split(","),s=Number(u[0]),l=Number(u[1]);t.push([[s,l,0],e.distinguishedZeroHash])}return t},e.process_values=function(r,t,n,a){for(var o=[],u=0;u<r.length;u++){(0,rd.watchdog)("wd0x503d57");for(var s=r[u],l=0;l<s.length;l++){(0,rd.watchdog)("wd0x366ad1");var c=s[l].toString();if(c.length>0&&t[u][l][0]!=="="){var d=Number(c).toString();if(d===c){var f=l+n+1,m=u+a+1;o.push([[f,m,1],e.distinguishedZeroHash])}}}}return o},e.identify_ranges=function(r,t){for(var n={},a=0,o=r;a<o.length;a++){var u=o[a];(0,rd.watchdog)("wd0x770d8c"),n[u[1]]=n[u[1]]||[],n[u[1]].push(u[0])}for(var s=0,l=Object.keys(n);s<l.length;s++){var c=l[s];(0,rd.watchdog)("wd0x84ae4d"),n[c].sort(t)}return n},e.group_ranges=function(r,t){var n={},a=0,o=1;t||(a=1,o=0);for(var u=0,s=Object.keys(r);u<s.length;u++){var l=s[u];(0,rd.watchdog)("wd0xa372ae"),n[l]=[];for(var c=r[l].shift(),d=c,f=0,m=r[l];f<m.length;f++){var v=m[f];v[a]===d[a]&&v[o]===d[o]+1||(n[l].push([c,d]),c=v),d=v}n[l].push([c,d])}return n},e.identify_groups=function(r){var t=function(l,c){return l[0]===c[0]?l[1]-c[1]:l[0]-c[0]},n=this.identify_ranges(r,t),a=this.group_ranges(n,!0),o=K1r.JSONclone.clone(a),u=this.merge_groups(o);return u},e.processed_to_matrix=function(r,t,n,a,o){for(var u=new Array(r),s=0;s<r;s++)u[s]=new Array(t).fill(0);for(var l=0,c=o;l<c.length;l++){var d=c[l],f=d[0],m=f[0],v=f[1],h=f[2],y=d[1],_=v-a-1,E=m-n-1,N=Number(e.distinguishedZeroHash);h===1||(N=Number(y)),u[_][E]=N}return u},e.stencilize=function(r){var t=V1r.Stencil.stencil_computation(r,function(n,a){return n*a},1);return t},e.compute_stencil_probabilities=function(r,t,n){for(var a=new Array(r),o=0;o<r;o++)a[o]=new Array(t).fill(0);for(var u=0,s={},o=0;o<r;o++)for(var l=0;l<t;l++)s[n[o][l]]=s[n[o][l]]+1||1,n[o][l]!==0&&(u+=1);for(var o=0;o<r;o++)for(var l=0;l<t;l++)a[o][l]=s[n[o][l]]/u;for(var c=0,d=0,o=0;o<r;o++)for(var l=0;l<t;l++)n[o][l]>0&&(d+=s[n[o][l]]);for(var o=0;o<r;o++)for(var l=0;l<t;l++)s[n[o][l]]>0&&(c+=this.entropy(s[n[o][l]]/d));var f=c/Math.log2(u);return a},e.generate_suspicious_cells=function(r,t,n,a,o,u,s){s===void 0&&(s=.01);for(var l=[],c=0,d=0,f=0;f<r;f++)for(var m=0;m<t;m++){var v=m+n+1,h=f+a+1;u[f][m]>0&&(c+=o[f][m],d+=1,u[f][m]<=s&&o[f][m]!==0&&l.push([v,h,u[f][m]]))}var y=c/d;return l.sort(function(_,E){return Math.abs(E[2]-y)-Math.abs(_[2]-y)}),l},e.process_suspicious=function(r,t,n){(0,rd.watchdog)("wd0x72fd38");var a=new YPe.Timer("process_suspicious"),o=GI.ExcelUtils.extract_sheet_cell(r),u=o[0],s=o[1],l=GI.ExcelUtils.cell_dependency(s,0,0),c=[];t.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):c=e.process_formulas(t,l[0]-1,l[1]-1);var d=!1,f=[],m=[],v=n.length,h=n[0].length;if(n.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{var y=GI.ExcelUtils.generate_all_references(t,l[0]-1,l[1]-1);f=e.color_all_data(y),m=e.process_values(n,t,l[0]-1,l[1]-1)}var _=e.identify_groups(f),E=e.identify_groups(c),N=[];n.length<1e4&&(N=e.find_suspicious_cells(v,h,l,t,c,m,1));var k=e.generate_proposed_fixes(E);return x$(N,E,_,k)},e.entropy=function(r){return-r*Math.log2(r)},e.entropydiff=function(r,t){var n=r+t,a=this.entropy(r/n)+this.entropy(t/n),o=a/Math.log2(n);return-o},e.fix_metric=function(r,t,n,a){var o=t[0],u=t[1],s=a[0],l=a[1],c=NN.RectangleUtils.area([[o[0],o[1],0],[u[0],u[1],0]]),d=NN.RectangleUtils.area([[s[0],s[1],0],[l[0],l[1],0]]),f=Math.min(c,d),m=Math.max(c,d),v=Math.min(n,r),h=Math.max(n,r),y=Math.abs(h-v)/this.Multiplier;y<1&&(y=1);var _=this.entropydiff(f,m),E=(1+_)/(y*f);return E=-E,E},e.count_proposed_fixes=function(r){var t=0;for(var n in r){var a=r[n][1],o=a[0],u=a[1],s=r[n][2],l=s[0],c=s[1];t+=NN.RectangleUtils.diagonal([[o[0],o[1],0],[u[0],u[1],0]]),t+=NN.RectangleUtils.diagonal([[l[0],l[1],0],[c[0],c[1],0]])}return t},e.fix_proposed_fixes=function(r){var t=0,n={},a={};for(var o in r){if(r[o][1]>r[o][2]){var u=r[o][1];r[o][1]=r[o][2],r[o][2]=u}n[JSON.stringify(r[o][1])]=r[o],a[JSON.stringify(r[o][2])]=r[o]}var s=[],l={};for(var o in r){var c=r[o][0];if(!(-c<e.reportingThreshold/100)){var d=JSON.stringify(r[o][1]),f=JSON.stringify(r[o][2]);if(!(d in a)&&!(f in n))s.push(r[o]);else{if(!l[d]&&d in a){var m=-c*JSON.parse(a[d][0]),v=[m,r[o][1],a[d][1]];s.push(v),l[d]=!0,l[f]=!0;continue}if(!l[f]&&f in n){var m=-c*JSON.parse(n[f][0]),v=[m,r[o][1],n[f][2]];s.push(v),l[f]=!0,l[d]=!0}}}}return s},e.generate_proposed_fixes=function(r){var t=eAe(r);return t.sort(ZPe),t},e.merge_groups=function(r){for(var t=0,n=Object.keys(r);t<n.length;t++){var a=n[t];(0,rd.watchdog)("wd0x781a33");var o=r[a].slice();r[a]=this.merge_individual_groups(o)}return r},e.merge_individual_groups=function(r){var t=new YPe.Timer("merge_individual_groups"),n=0;for(r=r.sort();;){(0,rd.watchdog)("wd0x0a3668");for(var a=!1,o={},u=[],s=r.slice();s.length>0;)for(var l=s.shift(),c=0;c<s.length;c++)if((0,rd.watchdog)("wd0x9cf1d5"),NN.RectangleUtils.is_mergeable(l,s[c])){var d=JSON.stringify(l),f=JSON.stringify(s[c]);if(!(d in o)&&!(f in o)){u.push(NN.RectangleUtils.bounding_box(l,s[c])),o[d]=!0,o[f]=!0,a=!0;break}}for(var c=0;c<r.length;c++)(0,rd.watchdog)("wd0x1bc2bb"),JSON.stringify(r[c])in o||u.push(r[c]);if(u.sort(),!a)return u;if(r=u.slice(),n++,n>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+n+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}},e.hash_vector=function(r){var t=!0;{var n=0,a=0,o=Math.abs(r[0]-n),u=Math.abs(r[1]-a),s=r[2];return this.Multiplier*(o+u+s)}{var n=-7,a=-3,o=r[0]-n;o=o*o;var u=r[1]-a;u=u*u;var s=r[2];return this.Multiplier*Math.sqrt(o+u+s)}},e.adjust_proposed_fixes=function(r,t,n,a){var o=r.map(function(u){var s=u[0];if(-s*100<1)return null;for(var l=u[1].map(function(S){return S.toString().padStart(10,"0")}),c=u[2].map(function(S){return S.toString().padStart(10,"0")}),d=l<c?u[1]:u[2],f=l<c?u[2]:u[1],m=d[0],v=m[0],h=m[1],y=d[1],_=y[0],E=y[1],N=f[0],k=N[0],q=N[1],V=f[1],I=V[0],M=V[1],B=v-n-1,U=h-a-1,j=I-n-1,X=M-a-1,ee=!0,re=JSON.stringify(t[U][B]),Z=U;Z<=X;Z++)for(var J=B;J<=j;J++){var C=JSON.stringify(t[Z][J]);if(C!==re){ee=!1;break}}return x$(s,d,f,ee)}).filter(function(u){return u!==null});return o},e.find_suspicious_cells=function(r,t,n,a,o,u,s){return(0,rd.watchdog)("wd0x8cabd6"),[];var l;{u=u;var c=e.processed_to_matrix(r,t,n[0]-1,n[1]-1,o.concat(u)),d=e.stencilize(c),f=e.compute_stencil_probabilities(r,t,d),m=e.generate_suspicious_cells(r,t,n[0]-1,n[1]-1,c,f,s);if(typeof a<"u"){var v=0,h=0;l=m.filter(function(_){var E=a[_[1]-n[1]][_[0]-n[0]];return E.length<1||E[0]!=="="?(h+=_[2],!0):(v+=_[2],h+=_[2],!1)}),console.log("total formula weight = "+v),console.log("total weight = "+h);var y=v/h;console.log("after processing 1, suspiciousCells = "+JSON.stringify(l)),l=l.map(function(_){return[_[0],_[1],_[2]*y]}),console.log("after processing 2, suspiciousCells = "+JSON.stringify(l)),l=l.filter(function(_){return _[2]<=s}),console.log("after processing 3, suspiciousCells = "+JSON.stringify(l))}else l=m}return l},e.reportingThreshold=35,e.suspiciousCellsReportingThreshold=85,e.formattingDiscount=50,e.formulasThreshold=1e4,e.valuesThreshold=1e4,e.Multiplier=1,e.distinguishedZeroHash="12345",e}();TS.Colorize=$Pe;function j1r(e,r){var t=e[0],n=e[1],a=r[0],o=r[1];return t[0]!==a[0]?t[0]-a[0]:t[1]-a[1]}function W1r(e,r){for(var t=0,n=Object.keys(e);t<n.length;t++){var a=n[t];(0,rd.watchdog)("wd0xa287cd"),r[a]=e[a].sort(j1r).map(function(o,u,s){return[o[0].map(function(l,c,d){return Number(l)}),o[1].map(function(l,c,d){return Number(l)})]})}}function eAe(e){var r=[],t={};W1r(e,t);for(var n={},a={},o=0,u=Object.keys(e);o<u.length;o++){var s=u[o];(0,rd.watchdog)("wd0xb02b87"),n[s]=t[s].map(function(E,N,k){var q=E[0],V=E[1];return q}),a[s]=t[s].map(function(E,N,k){var q=E[0],V=E[1];return V})}var l=z1r(e),c=Object.keys(e);JPe(c,function(E,N){return l[E][0][0]-l[N][0][0]});var d=c.map(function(E,N,k){return l[E]}),f=Object.keys(e);JPe(f,function(E,N){return l[E][0][1]-l[N][0][1]});for(var m=f.map(function(E,N,k){return l[E]}),v=0,h=Object.keys(e);v<h.length;v++)for(var s=h[v],y=0;y<t[s].length;y++){(0,rd.watchdog)("wd0xe37031");var _=X1r(s,t[s][y],t,c,f,n,a,l,d,m);r=r.concat(_)}return r=r.map(function(E,N,k){return kN(E[1],E[2])<0?[E[0],E[2],E[1]]:[E[0],E[1],E[2]]}),r=H1r(r),r}TS.find_all_proposed_fixes=eAe;function JPe(e,r){for(var t=e.map(function(a,o){return{item:a,index:o}}).sort(function(a,o){return r(a.item,o.item)||a.index-o.index}).map(function(a){var o=a.item;return o}),n=0;n<e.length;n+=1)e[n]=t[n];return e}function H1r(e){var r={};return e.filter(function(t){return!(r[t]=t in r)})}function kN(e,r){for(var t=0;t<3;t++){if(e[t]<r[t])return-1;if(e[t]>r[t])return 1}return 0}TS.numComparator=kN;function z1r(e){for(var r={},t=0,n=Object.keys(e);t<n.length;t++){for(var a=n[t],o=1e6,u=1e6,s=-1e6,l=-1e6,c=0;c<e[a].length;c++){var d=e[a][c][0][0],f=e[a][c][1][0],m=e[a][c][0][1],v=e[a][c][1][1];f>s&&(s=f),d<o&&(o=d),v>l&&(l=v),m<u&&(u=m)}r[a]=[[o,u,0],[s,l,0]]}return r}function Q1r(e,r,t,n){var a=e[0],o=e[1],u=r[0],s=r[1],l=[a-1,s,0],c=[u,o-1,0],d=[u+1,o,0],f=[a,s+1,0],m=[],v=-1;if(v=(0,ON.strict_binsearch)(n,l,kN),v!==-1&&t[v][1]===o){var h=[t[v],n[v]];m.push(h)}if(v=(0,ON.strict_binsearch)(n,c,kN),v!==-1&&t[v][0]===a){var h=[t[v],n[v]];m.push(h)}if(v=(0,ON.strict_binsearch)(t,d,kN),v!==-1&&n[v][1]===s){var h=[t[v],n[v]];m.push(h)}if(v=(0,ON.strict_binsearch)(t,f,kN),v!==-1&&n[v][0]===u){var h=[t[v],n[v]];m.push(h)}return m}function X1r(e,r,t,n,a,o,u,s,l,c){var d=r[0],f=r[1],m=[],v=t,h=(0,ON.binsearch)(l,r,function(I,M){return I[0][0]-M[0][0]}),y=(0,ON.binsearch)(c,r,function(I,M){return I[0][1]-M[0][1]}),_,E,N;h>y?(_=n,N=h,E=0):(_=a,N=y,E=1),N>0&&(N-=1);for(var k=function(M){var B=_[M];if(B===e)return"continue";var U=s[B];if(E===0){if(f[0]+1<U[0][0])return"break"}else if(f[1]+1<U[0][1])return"break";if(!(f[0]+1<U[0][0]||f[1]+1<U[0][1]||U[1][0]+1<d[0]||U[1][1]+1<d[1])){var j=Q1r(d,f,o[B],u[B]);j.length>0&&(m=m.concat(j.map(function(X,ee,re){var Z=$Pe.fix_metric(parseFloat(e),r,parseFloat(B),X);return[Z,r,X]})))}},q=N;q<_.length;q++){var V=k(q);if(V==="break")break}return m}});var nAe=T(e4=>{"use strict";p();Object.defineProperty(e4,"__esModule",{value:!0});e4.detect_errors=void 0;var $K=M$(),BI=rAe(),Y1r=zK(),MN=XK();function tAe(e,r){for(var t=e[0],n=e[1],a=r[0],o=r[1],u=[],s=t;s<=a;s++)for(var l=n;l<=o;l++)u.push([s,l,0]);return u}function J1r(e,r,t,n){n===void 0&&(n=1/0),r=r??BI.Colorize.getFormattingDiscount(),t=t??BI.Colorize.getReportingThreshold(),MN.watchdog.arm(n);for(var a=e.worksheets.map(function(m){if((0,MN.watchdog)("wd0x8d98cc"),m.formulas.length===0&&m.values.length===0)return{name:"",out:null};var v=m.usedRangeAddress;v=v.replace(/!(!+)/,"!");var h=new Y1r.Timer("excelint"),y=BI.Colorize.process_suspicious(v,m.formulas,m.values),_=y[0],E=y[1],N=y[2],k=y[3];(0,MN.watchdog)("wd0x7919b4");var q=h.elapsedTime(),V=BI.Colorize.adjust_proposed_fixes(k,m.styles,0,0),I=h.elapsedTime(),M=V.map(function(Q){(0,MN.watchdog)("wd0xfb8f16");var W=Q[0],$=Q[1],me=Q[2],ve=Q[3],Pe=-W;return ve||(Pe*=(100-r)/100),Pe*100>=t?(0,BI.tuple)(Pe,$,me,ve):null}).filter(function(Q){return Q!==null}),B=function(W,$){return($[0]-W[0]+1)*($[1]-W[1]+1)*($[2]-W[2]+1)},U=h.elapsedTime(),j=M.map(function(Q){(0,MN.watchdog)("wd0x2375dd");for(var W=Q[1][0][0]===Q[2][0][0]?"vertical":"horizontal",$=[],me=[],ve=[],Pe=[],ua=[],Qi=[],go=[],Ro=[],$n=[],ns=Q[3],Iu=[B.apply(void 0,Q[1]),B.apply(void 0,Q[2])],wi=0;wi<2;wi++){var mp=Q[wi+1][0],zl=mp[1]-1,Ql=mp[0]-1,_c=m.formulas[zl][Ql],Gd=$K.ExcelUtils.numeric_constants(_c);ua.push(Gd),Qi.push(Qi.reduce(function(Lv,qv){return Lv+qv},0));var vl=$K.ExcelUtils.all_cell_dependencies(_c,Ql+1,zl+1,!1);go.push(vl.length);var wu=$K.ExcelUtils.formulaToR1C1(_c,Ql+1,zl+1),bs=$K.ExcelUtils.column_index_to_name(Ql+1)+(zl+1)+":",hl=bs+wu;ve.push(wu),Pe.push(hl),$.push(_c),me.push(bs+_c),Ro.push((_c.match(/\$/g)||[]).length),$n.push(vl)}for(var id=Math.abs(Qi[0]-Qi[1]),as=[],wi=0;wi<$n.length;wi++)if($n[wi].length>0){if(W==="vertical"&&$n[wi][0][0]===0&&$n[wi][0][1]===-1){as.push("recurrent-formula");break}if(W==="horizontal"&&$n[wi][0][0]===-1&&$n[wi][0][1]===0){as.push("recurrent-formula");break}}go[0]!==go[1]&&as.push("different-referent-count"),ua[0].length!==ua[1].length&&(Math.abs(ua[0].length-ua[1].length)===1?as.push("one-extra-constant"):as.push("number-of-constants-mismatch")),ua[0].length>0&&ua[1].length>0&&(go[0]+go[1]===0?as.push("both-constants"):go[0]*go[1]===0&&as.push("one-is-all-constants")),ve[0]!==ve[1]&&JSON.stringify($n[0].sort())!==JSON.stringify($n[1].sort())&&as.push("r1c1-mismatch"),Ro[0]!==Ro[1]&&as.push("absolute-ref-mismatch");for(var wi=0;wi<$n.length;wi++)if($n[wi].length>0&&$n[wi][0][0]*$n[wi][0][1]!==0){as.push("off-axis-reference");break}return as.length===0&&as.push("unclassified"),{bin:as,direction:W,sameFormat:ns,rangeSizes:Iu,numbers:Qi,sameConstants:ua[0]===ua[1],numeric_difference:id,magnitude_numeric_difference:id===0?0:Math.log10(id),formulas:me,r1c1formulas:Pe,dependence_vectors:$n}}),X=h.elapsedTime(),ee=m.formulas.flat().filter(function(Q){return Q.length>0}).length,re=m.values.flat().filter(function(Q){return Q.length>0}).length,Z=m.values[0].length,J=m.values.length,C=J*Z,S=M.map(function(Q){return Q[0]}).reduce(function(Q,W){return Q+W},0),b=M.map(function(Q){return(0,MN.watchdog)("wd0xbcc23c"),Q[0]>=t/100?tAe(Q[1][0],Q[1][1]).concat(tAe(Q[2][0],Q[2][1])):[]}),O=Array.from(new Set(b.flat(1).map(function(Q){return JSON.stringify(Q)})));b=O.map(function(Q){return JSON.parse(Q)});var w=h.elapsedTime(),D={suspiciousnessThreshold:t,formattingDiscount:r,proposedFixes:M,exampleFixes:j,suspiciousRanges:M.length,weightedSuspiciousRanges:S,suspiciousCells:b.length,elapsedTimeSeconds:w/1e3,proposedFixesTimeSeconds:q/1e3,adjustProposedFixesTimeSeconds:(I-q)/1e3,adjustFormatProposedFixesTimeSeconds:(U-I)/1e3,exampleFixesTimeSeconds:(X-U)/1e3,numCountingTimeSeconds:(w-X)/1e3,columns:Z,rows:J,totalCells:C,numFormulaCells:ee,numValueCells:re};return{name:m.sheetName,out:D}}).filter(function(m){return m.out!==null}),o={},u=0,s=a;u<s.length;u++){var l=s[u],c=l.name,d=l.out;o[c]=d}var f={workbookName:e.workbookName,worksheets:o};return f}e4.detect_errors=J1r});var aAe=T(r4=>{"use strict";p();Object.defineProperty(r4,"__esModule",{value:!0});r4.detect_errors=void 0;var Z1r=nAe();Object.defineProperty(r4,"detect_errors",{enumerable:!0,get:function(){return Z1r.detect_errors}})});var uAe=T(t4=>{"use strict";p();Object.defineProperty(t4,"__esModule",{value:!0});t4.ExceLintExperiment=void 0;var $1r=fe(),iAe=No(),eTr=aAe(),rTr=pr(),tTr=DQ(),nTr=xK(),aTr=Ba(),oAe=Gi(),xN=zn(),iTr=ti();function oTr(e){for(var r,t,n,a,o=e.getServerDocument(),u=[],s=0,l=e.getServerAvailableCells();s<l.length;s++){var c=l[s],d="UndefinedSheet";if(o!==void 0){var f=e.getSheetName(o,c.sheetIdx.index);f.kind===xN.ResultKind.Success&&(d=f.value)}var m=e.getServerUsedRange(c.sheetIdx);if(!(m.kind===xN.ResultKind.Failure||m.value===void 0)){var v=m.value.sheet,h=$1r.__assign({},m.value.range);h.cols=Math.min(h.cols,75),h.rows=Math.min(h.rows,1e3);for(var y=[],_=[],E=[],N=0,k=h.row,q=h.row+h.rows-1;k<=q;k+=1){for(var V=[],I=[],M=[],B=h.col,U=h.col+h.cols-1;B<=U;B+=1){var j=(0,iAe.sheetGridCell)(v,(0,iAe.gridCell)(k,B)),X=e.getServerValue(j),ee=X.kind===xN.ResultKind.Success?JSON.stringify(X.value):"";I.push(ee);var re=e.getServerFormat(j),Z=re.kind===xN.ResultKind.Success?(0,rTr.fnv1a)(JSON.stringify(re.value)).toString():"";M.push(Z);var J=e.getServerFormula(j),C=J.kind===xN.ResultKind.Success?(t=(r=J.value)===null||r===void 0?void 0:r[1].compiledFmla)===null||t===void 0?void 0:t.getValue():void 0,S=(C==null?void 0:C.kind)===xN.ResultKind.Success&&(a=(n=J.value)===null||n===void 0?void 0:n[1].fmla)!==null&&a!==void 0?a:"";S!==""&&(N+=1),V.push(S)}y.push(V),_.push(I),E.push(M)}if(N!==0){var b=(0,tTr.formatGridRange)(e.config.localeInfo,h,iTr.RefStyle.A1,d),O={sheetName:d,usedRangeAddress:b,values:_,formulas:y,styles:E};u.push(O)}}}var w={workbookName:"PartialWorkbook",worksheets:u};return w}var uTr=function(){function e(r){r===void 0&&(r=75),this.timeLimitMS=r,this.result=void 0}return Object.defineProperty(e.prototype,"done",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.setContext=function(r){var t=r.documents;try{aTr.ulsLogger.ULS.traceTag(578588694,oAe.LogCategory.msoulscat_ES_EWAJS,oAe.TraceLevel.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");var n=oTr(t);this.result=(0,eTr.detect_errors)(n,void 0,void 0,this.timeLimitMS)}catch(a){this.result="ExceLint experiment crashed with error: ".concat(a)}},e.prototype.step=function(){},Object.defineProperty(e.prototype,"report",{get:function(){var t=this;if(typeof this.result>"u"||typeof this.result=="string")return[];var n=Object.keys(this.result.worksheets).map(function(a){var o=t.result.worksheets[a],u=o.exampleFixes.map(function(l,c){var d=o.proposedFixes[c][0],f=l.rangeSizes,m=f.reduce(function(v,h){return v+h},0);return{anomalousnessIndex:d,categories:l.bin,sizeOfCellRange:m,sizeOfEachSFRRange:f,redactedFormulaForEachSFR:l.formulas.map(nTr.anonymizeFormulaString),stylesDiffer:!l.sameFormat,operatorsDiffer:null,direction:l.direction}}),s=u.map(function(l){return l.sizeOfEachSFRRange.length}).reduce(function(l,c){return l+c},0);return{totalFormulas:o.numFormulaCells,totalSimilarFormulaRanges:s,numberOfAdjacentSFRs:u.length,numberOfAnomalousRanges:o.suspiciousRanges,numberOfCellsInAnomalousRanges:o.suspiciousCells,anomalies:u,elapsedTimeSeconds:o.elapsedTimeSeconds,proposedFixesTimeSeconds:o.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:o.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:o.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:o.exampleFixesTimeSeconds,numCountingTimeSeconds:o.numCountingTimeSeconds,columns:o.columns,rows:o.rows}}).filter(function(a){return a.totalFormulas>0});return n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return typeof this.result=="string"?this.result:this.result===void 0?"ExceLint experiment return <undefined>":"ExceLint experiment done. Result: ".concat(JSON.stringify(this.report))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){var t=this.resultLogMessage;return t+" BTW, experiment ran out of time budget"},enumerable:!1,configurable:!0}),e}();t4.ExceLintExperiment=uTr});var a4=T(n4=>{"use strict";p();Object.defineProperty(n4,"__esModule",{value:!0});n4.Messages=void 0;var sAe;(function(e){e.Root="calc.exp.UnitExperiment",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"})(sAe||(n4.Messages=sAe={}))});var o4=T(xn=>{"use strict";p();Object.defineProperty(xn,"__esModule",{value:!0});xn.unify=xn.compose=xn.createPoisonApplication=xn.UnificationResultKind=xn.substituteVariable=xn.serialiseMeasure=xn.toUnitConstraint=xn.shuffleNormalForms=xn.pow=xn.inv=xn.prod=xn.areSignaturesEqual=xn.isSimpleUnit=xn.fromVar=xn.fromConstants=xn.makeSignature=xn.someVar=xn.everyVar=xn.someConst=xn.everyConst=void 0;var LR=Ba(),pv=a4();function sTr(e,r){for(var t in e)r(t,e[t])}function w$(e,r){for(var t in e)if(!r(t,e[t]))return!1;return!0}var pAe=function(r,t){return!w$(r,function(n,a){return!t(n,a)})},lTr=function(r,t){return w$(r.consts,t)};xn.everyConst=lTr;var cTr=function(r,t){return pAe(r.consts,t)};xn.someConst=cTr;var dTr=function(r,t){return w$(r.vars,t)};xn.everyVar=dTr;var fTr=function(r,t){return pAe(r.vars,t)};xn.someVar=fTr;function qR(e,r){var t=0;sTr(r.vars,function(){return t+=1}),(0,LR.assertTrue)(e,r.name===void 0||r.varCount===1),(0,LR.assertTrue)(e,r.varCount===t)}function wN(e,r,t){var n={varCount:e,vars:r,consts:t,name:void 0};return qR(pv.Messages.Root,n),n}xn.makeSignature=wN;function pTr(){}function mAe(){return new pTr}var gAe=mAe();function GR(){return wN(0,{},mAe())}function vAe(e){return wN(0,{},e)}xn.fromConstants=vAe;function mTr(e){var r,t=wN(1,(r={},r[e]=1,r),gAe);return t.name=e,t}xn.fromVar=mTr;var D$=function(){return!1};function gTr(e,r){for(var t in e.vars)return r===e.vars[t]?t:void 0}function vTr(e){if(e.varCount===0||e.name!==void 0)return!0;if(e.varCount===1&&(e.consts===gAe||(0,xn.everyConst)(e,D$))){var r=gTr(e,1);return r===void 0?!1:(e.name=r,!0)}return!1}xn.isSimpleUnit=vTr;function lAe(e,r){return(0,xn.everyVar)(e,function(t,n){return r.vars[t]===n})&&(0,xn.everyConst)(e,function(t,n){return r.consts[t]===n})}function hTr(e,r){return lAe(e,r)&&lAe(r,e)}xn.areSignaturesEqual=hTr;function STr(e,r){var t,n,a=GR(),o=e.vars,u=e.consts,s=r.vars,l=r.consts;for(var c in o){var d=o[c]+((t=s[c])!==null&&t!==void 0?t:0);d!==0&&(a.vars[c]=d,a.varCount+=1)}for(var c in u){var d=u[c]+((n=l[c])!==null&&n!==void 0?n:0);d!==0&&(a.consts[c]=d)}for(var c in s)o[c]===void 0&&(a.vars[c]=s[c],a.varCount+=1);for(var c in l)u[c]===void 0&&(a.consts[c]=l[c]);return qR(pv.Messages.Root,a),a}xn.prod=STr;function yTr(e){var r=GR(),t=e.vars,n=e.consts;for(var a in t)r.vars[a]=-t[a];for(var a in n)r.consts[a]=-n[a];return r.varCount=e.varCount,qR(pv.Messages.Root,r),r}xn.inv=yTr;function _Tr(e,r,t){if(r===0)return t;var n=GR(),a=e.vars,o=e.consts;for(var u in a)n.vars[u]=a[u]*r;for(var u in o)n.consts[u]=o[u]*r;return n.varCount=e.varCount,qR(pv.Messages.Root,n),n}xn.pow=_Tr;function bTr(e,r){var t,n,a=GR(),o=GR(),u=a.vars,s=o.consts;for(var l in e.vars){var c=e.vars[l]-((t=r.vars[l])!==null&&t!==void 0?t:0);c!==0&&(u[l]=c,a.varCount+=1)}for(var l in r.vars)e.vars[l]===void 0&&(u[l]=-r.vars[l],a.varCount+=1);for(var l in r.consts){var c=r.consts[l]-((n=e.consts[l])!==null&&n!==void 0?n:0);c!==0&&(s[l]=c)}for(var l in e.consts)r.consts[l]===void 0&&(s[l]=-e.consts[l]);return qR(pv.Messages.Root,a),qR(pv.Messages.Root,o),(0,LR.assertTrue)(pv.Messages.Root,(0,xn.everyConst)(a,D$)),{vars:a,consts:o}}xn.shuffleNormalForms=bTr;function hAe(e,r){var t,n,a=GR(),o=e.vars,u=e.consts,s=r.vars,l=r.consts;for(var c in o){var d=o[c]-((t=s[c])!==null&&t!==void 0?t:0);d!==0&&(a.vars[c]=d,a.varCount+=1)}for(var c in u){var d=u[c]-((n=l[c])!==null&&n!==void 0?n:0);d!==0&&(a.consts[c]=d)}for(var c in s)o[c]===void 0&&(a.vars[c]=-s[c],a.varCount+=1);for(var c in l)u[c]===void 0&&(a.consts[c]=-l[c]);return qR(pv.Messages.Root,a),a}xn.toUnitConstraint=hAe;function I$(e,r,t,n){return t?r===1?e:"".concat(e,"^").concat(r):r===-1?e:"".concat(e,"^").concat(r*n)}function CTr(e){var r=[],t=[];for(var n in e.vars){var a=e.vars[n];a>0?r.push([n,a]):t.push([n,a])}for(var o in e.consts){var a=e.consts[o];a>0?r.push([o,a]):t.push([o,a])}if(t.length===0)return r.length===0?"1":r.map(function(l){var c=l[0],d=l[1];return I$(c,d,!0,1)}).join("*");var u=t.map(function(l){var c=l[0],d=l[1];return I$(c,d,!1,-1)}).join("*");if(t.length>1&&(u="("+u+")"),r.length===0)return"1/".concat(u);var s=r.map(function(l){var c=l[0],d=l[1];return I$(c,d,!0,1)}).join("*");return"".concat(s,"/").concat(u)}xn.serialiseMeasure=CTr;function L$(e,r,t){var n=r.vars,a=r.consts,o=n[e];if(o===void 0)return r;var u=0,s=GR(),l=s.vars,c=s.consts;for(var d in n){var f=t.vars[d],m=f===void 0?0:f,v=d===e,h=(v?0:n[d])+m*o;h!==0&&(u+=1,l[d]=h)}for(var d in t.vars){var y=n[d];y===void 0&&(u+=1,l[d]=o*t.vars[d])}for(var d in a){var _=t.consts[d],h=a[d]+o*(_===void 0?0:_);h!==0&&(c[d]=h)}for(var d in t.consts){var y=a[d];y===void 0&&(c[d]=o*t.consts[d])}return wN(u,l,c)}xn.substituteVariable=L$;var IN;(function(e){e[e.Fail=0]="Fail",e[e.Subst=1]="Subst"})(IN||(xn.UnificationResultKind=IN={}));var i4=function(){},TTr={kind:IN.Subst,substitution:i4},cAe=function(r){return{kind:IN.Subst,substitution:r}},dAe={kind:IN.Fail},RTr=function(r){return r<0?-r:r};function ETr(e){return function(r,t){if(t.varCount===0||r===i4)return t;var n=t;for(var a in t.vars){var o=r(a);if(o===e)return e;o!==void 0&&(n=L$(a,n,o))}return n}}xn.createPoisonApplication=ETr;function SAe(e,r,t){var n={};return t===i4?r:r===i4?t:function(a){var o=n[a];if(o!==void 0)return o;var u=t(a);return u===void 0?n[a]=r(a):n[a]=e(r,u)}}xn.compose=SAe;function fAe(e,r){return function(t){return e===t?r:void 0}}var PTr=100;function yAe(e,r,t){if(e>=PTr)return(0,LR.assertFalse)(pv.Messages.UnifyBound);if(t.varCount===0)return(0,xn.everyConst)(t,D$)?TTr:dAe;if(t.varCount===1){var n;for(var a in t.vars){n=a;break}(0,LR.assertTrue)(pv.Messages.Root,n!==void 0);var o=t.vars[n],u={};for(var s in t.consts){var l=t.consts[s];if(l%o===0){u[s]=-(l/o);continue}return dAe}return cAe(fAe(n,vAe(u)))}var c,d=0,f=void 0,m=t.vars,v=t.consts,h=t.varCount;for(var s in m){var l=m[s],y=RTr(l);(f===void 0||y<f)&&(d=l,f=y,c=s)}(0,LR.assertTrue)(pv.Messages.Root,c!==void 0),(0,LR.assertTrue)(pv.Messages.Root,d!==0);var _={},E={};for(var s in m)if(s===c)_[s]=1;else{var l=m[s];_[s]=-Math.floor(l/d)}for(var s in v){var l=v[s];E[s]=-Math.floor(l/d)}var N=wN(h,_,E),k=yAe(e+1,r,L$(c,t,N));return k.kind===IN.Fail?k:cAe(SAe(r,k.substitution,fAe(c,N)))}var ATr=function(r,t,n){return yAe(0,r,hAe(t,n))};xn.unify=ATr});var G$=T(In=>{"use strict";p();Object.defineProperty(In,"__esModule",{value:!0});In.ExperimentState=In.isResolvedReferenceType=In.primitiveUnitType=In.primitiveType=In.topType=In.bottomType=In.oneType=In.errorType=In.dimensionlessNumberType=In.dimensionLess=In.numberType=In.stringType=In.boolType=In.typeFromDimensions=In.joinDimensions=In.getLiftingDimensionsFromTypes=In.dimensionsFromType=In.makeArrayType=In.makeResolvedReferenceType=In.makeReferenceType=In.makePrimitiveType=In.TypeKind=void 0;var u4=fe(),FTr=qi(),NTr=o4(),cp=Eg(),RS;(function(e){e[e.Scalar=0]="Scalar",e[e.Reference=1]="Reference",e[e.Array=2]="Array",e[e.Union=3]="Union"})(RS||(In.TypeKind=RS={}));function d_(e,r){return r===void 0&&(r=void 0),{kind:RS.Scalar,flags:e,unit:r}}In.makePrimitiveType=d_;function bAe(e){return{kind:RS.Reference,reference:e,resolution:void 0}}In.makeReferenceType=bAe;function OTr(e,r){var t=bAe(e);return t.resolution=r,t}In.makeResolvedReferenceType=OTr;function CAe(e,r){return{kind:RS.Array,elementType:e,dimensions:r}}In.makeArrayType=CAe;function TAe(e){return{kind:RS.Union,flags:e}}function q$(e){var r;switch(e.kind){case RS.Reference:var t=(r=e.resolution)===null||r===void 0?void 0:r.range;return t===void 0?!1:(0,FTr.isGridCell)(t)?!0:{rows:t.rows,columns:t.cols,exact:!0};case RS.Array:return e.dimensions;case RS.Scalar:return!0;case RS.Union:return!1}}In.dimensionsFromType=q$;function kTr(e,r){var t=q$(e),n=q$(r);return RAe(t,n)}In.getLiftingDimensionsFromTypes=kTr;function RAe(e,r){return typeof e=="object"?typeof r=="object"?{rows:Math.max(e.rows,r.rows),columns:Math.max(e.columns,r.columns),exact:e.exact&&r.exact}:u4.__assign(u4.__assign({},e),{exact:e.exact&&r}):typeof r=="object"?u4.__assign(u4.__assign({},r),{exact:r.exact&&e}):e&&r}In.joinDimensions=RAe;function MTr(e,r){return r===!0?e:CAe(e,r)}In.typeFromDimensions=MTr;In.boolType=d_(cp.OperKind.Boolean);In.stringType=d_(cp.OperKind.String);In.numberType=d_(cp.OperKind.Number);In.dimensionLess=(0,NTr.fromConstants)({});In.dimensionlessNumberType=d_(cp.OperKind.Number,In.dimensionLess);In.errorType=d_(cp.OperKind.Error);In.oneType=d_(cp.OperKind.Missing|cp.OperKind.Blank);In.bottomType=TAe(cp.SignatureType.None);In.topType=TAe(cp.SignatureType.All);In.primitiveType=d_(cp.OperKind.Number|cp.OperKind.Boolean|cp.OperKind.String);var xTr=function(r){return d_(cp.OperKind.Number|cp.OperKind.Boolean|cp.OperKind.String,r)};In.primitiveUnitType=xTr;function ITr(e){return e.resolution!==void 0}In.isResolvedReferenceType=ITr;var _Ae;(function(e){e[e.Checking=0]="Checking",e[e.SolvingSimple=1]="SolvingSimple",e[e.SolvingFull=2]="SolvingFull"})(_Ae||(In.ExperimentState=_Ae={}))});var EAe=T(s4=>{"use strict";p();Object.defineProperty(s4,"__esModule",{value:!0});s4.UF=void 0;var wTr=function(){function e(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}return e.prototype.makePoint=function(r){var t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(r),this.ranks.push(0),t},e.prototype.find=function(r){for(var t=this.roots,n=r;t[n]!==n;)t[n]=t[t[n]],n=t[n];return n},e.prototype.findWithDescriptor=function(r){var t=this.find(r);return[t,this.descriptors[t]]},e.prototype.union=function(r,t,n){n===void 0&&(n=!1);var a=this.find(r),o=this.find(t);if(a!==o){var u=this.roots,s=this.backlinks,l=this.ranks;if(n){var c=s[o];s[o]=s[a],s[a]=c,u[o]=a,l[a]<=l[o]&&(l[a]=l[o]+1);return}if(l[a]<l[o]){var c=s[a];s[a]=s[o],s[o]=c,u[a]=o}else{var c=s[o];s[o]=s[a],s[a]=c,u[o]=a,l[a]===l[o]&&(l[a]+=1)}}},e.prototype.forEachInClass=function(r,t){var n=this.backlinks,a=r;for(t(a);n[a]!==r;)a=n[a],t(a)},e}();s4.UF=wTr});var z$=T(Wl=>{"use strict";p();var DN;Object.defineProperty(Wl,"__esModule",{value:!0});Wl.runSolverStep=Wl.numberFormatFromCellFormat=Wl.valueTypeFromCellFormat=Wl.updateFormatStatsFromCellFormat=Wl.isInterestingFormat=Wl.makeSolverContext=Wl.ConstraintKind=Wl.UnitExperimentSettings=void 0;var LN=G$(),gv=o4(),jm=a4(),DTr=EAe(),LTr=No(),B$=qi(),Wm=Ba(),U$=Zc(),qTr=Ss(),PAe=Pf(),Bh=Us(),NAe=zn(),AAe=Ms();Wl.UnitExperimentSettings={get UnitlessTimeAndDate(){return(0,AAe.getTypedFeatureGate)("Microsoft.Office.Excel.UnitlessTimeAndDate")},get IgnoreDivMul(){return(0,AAe.getTypedFeatureGate)("Microsoft.Office.Excel.UnitExpIgnoreDivMul")}};var ES;(function(e){e[e.RangeEquality=0]="RangeEquality",e[e.StagedRangeEquality=1]="StagedRangeEquality",e[e.UnitEquality=2]="UnitEquality",e[e.FormatEquality=3]="FormatEquality"})(ES||(Wl.ConstraintKind=ES={}));var mv;(function(e){e[e.Solved=0]="Solved",e[e.Failed=1]="Failed",e[e.Deferred=2]="Deferred",e[e.Staged=3]="Staged"})(mv||(mv={}));var zp={kind:mv.Solved},GTr=function(r){return{kind:mv.Failed,error:r}},OAe=function(r){return{kind:mv.Deferred,constraint:r}},K$=(0,gv.fromConstants)({error:1}),V$=(0,gv.fromConstants)({}),BTr=(0,gv.fromConstants)({currency:1}),UTr=(0,gv.fromConstants)({date:1}),KTr=(0,gv.fromConstants)({time:1});function VTr(e,r,t){var n=new DTr.UF,a=n.makePoint(K$),o=(0,gv.createPoisonApplication)(K$);return{symbolContext:e,typeContext:r,stats:t,uf:n,errorPoint:a,errorUnit:K$,apply:o}}Wl.makeSolverContext=VTr;function j$(e,r){return r.link===void 0&&(r.link=e.uf.makePoint(r.unit)),r.link}function FAe(e,r,t,n){return(0,Wm.assertTrue)(jm.Messages.Root,t.varCount===0),e.uf.union(n===void 0?e.uf.makePoint(t):n,r,!0),zp}function l4(e,r,t,n,a){return r===e.errorUnit?((0,Wm.assertTrue)(jm.Messages.Root,t===e.errorPoint),a!==void 0&&e.uf.union(e.errorPoint,a,!0),zp):n===e.errorUnit?((0,Wm.assertTrue)(jm.Messages.Root,a===e.errorPoint),t!==void 0&&e.uf.union(e.errorPoint,t,!0),zp):r.varCount===0?n.varCount===0?(0,gv.areSignaturesEqual)(r,n)?zp:(t!==void 0&&e.uf.union(e.errorPoint,t,!0),a!==void 0&&e.uf.union(e.errorPoint,a,!0),GTr([r,n])):((0,Wm.assertTrue)(jm.Messages.Root,a!==void 0),FAe(e,a,r,t)):n.varCount===1?((0,Wm.assertTrue)(jm.Messages.Root,t!==void 0),(0,Wm.assertTrue)(jm.Messages.Root,a!==void 0),e.uf.union(t,a),zp):((0,Wm.assertTrue)(jm.Messages.Root,t!==void 0),FAe(e,t,n,a))}function W$(e,r,t){if(!(0,gv.isSimpleUnit)(r))return OAe({kind:ES.UnitEquality,unit:r,target:t});var n=j$(e,t),a=e.uf.findWithDescriptor(n),o=a[0],u=a[1];if(r.varCount===1){(0,Wm.assertTrue)(jm.Messages.Root,r.name!==void 0);var s=e.symbolContext.getTable().getValue(r.name);(0,Wm.assertTrue)(jm.Messages.Root,s!==void 0);var l=e.uf.findWithDescriptor(j$(e,s)),c=l[0],d=l[1];return l4(e,d,c,u,o)}return l4(e,r,void 0,u,o)}function jTr(e,r){return W$(e,r.unit,r.target)}function kAe(e,r){if(r===qTr.SpecialFormat.Unavailable||r===0)return!1;var t=c4(e,r);if(t===void 0)return!1;var n=t==null?void 0:t.valueType;return n===void 0||n===Bh.FormatValueType.General?!1:n===Bh.FormatValueType.Currency||n===Bh.FormatValueType.Accounting?t.currencySymbol!==void 0:!0}Wl.isInterestingFormat=kAe;function MAe(e,r,t,n){var a,o,u;n?t.referencedFormatCells+=1:t.allFormatCells+=1;var s=c4(e,r),l=n?t.enriched.referencedFormatTypes:t.enriched.allFormatTypes,c=s==null?void 0:s.valueType;if(c!==void 0&&(l[c]=((a=l[c])!==null&&a!==void 0?a:0)+1),c===Bh.FormatValueType.Currency||c===Bh.FormatValueType.Accounting){var d=n?t.enriched.referencedCurrencyTypes:t.enriched.allCurrencyTypes,f=s==null?void 0:s.currencySymbol,m=(o=s==null?void 0:s.culture)===null||o===void 0?void 0:o.culture,v=f===void 0?"none":f===Bh.FormatCurrency.LocaleInfo?"defaultSymbol":f+"_"+m;d[v]=((u=d[v])!==null&&u!==void 0?u:0)+1}}Wl.updateFormatStatsFromCellFormat=MAe;function xAe(e,r){var t;return(t=c4(e,r))===null||t===void 0?void 0:t.valueType}Wl.valueTypeFromCellFormat=xAe;function c4(e,r){if(typeof r=="number"){var t=e.getIformat(r);return(0,NAe.isSuccess)(t)?t.value:void 0}return r}Wl.numberFormatFromCellFormat=c4;function d4(e,r,t){var n=e.typeContext.types[r.index];if(n===void 0)return(0,Wm.assertFalse)(jm.Messages.Root);var a=n.getValue(t);if(a===void 0){var o=(0,LTr.sheetGridCell)(r,t),u=e.typeContext.formats(o);if((0,NAe.isSuccess)(u)){if(!kAe(e.typeContext,u.value)||e.typeContext.isStringValue(o)){var s=e.symbolContext.freshSymbol().unit;return e.typeContext.types[r.index]=n.setValue(t,(0,LN.primitiveUnitType)(s)),s}var l=H$(e,u.value);return l===void 0?l=e.symbolContext.freshSymbol().unit:MAe(e.typeContext,u.value,e.stats,!0),e.typeContext.types[r.index]=n.setValue(t,(0,LN.primitiveUnitType)(l)),l}var c=e.symbolContext.freshSymbol().unit;return e.typeContext.types[r.index]=n.setValue(t,(0,LN.primitiveUnitType)(c)),c}if(a.kind===LN.TypeKind.Scalar)return a.unit}function WTr(e,r){var t=r.type.resolution;if(!(0,B$.isSheetIndex)(t.sheet))return zp;if((0,B$.isGridCell)(t.range)){var n=d4(e,t.sheet,t.range);return n===void 0?zp:W$(e,n,r.target)}var a=e.typeContext.available[t.sheet.index];if(a===void 0)return zp;var o=a.usedRange;if(o===void 0)return zp;var u=(0,B$.gridRangeIsect)(t.range,o);if(u===void 0)return zp;var s=(0,PAe.intersectProduct)((0,PAe.intersectProduct)((0,U$.createCellSetFromRange)(u),U$.availableReadProduct),a.availableCells),l=[];return(0,U$.forEachCellInSet)(s,function(c){return l.push(c),!0}),{kind:mv.Staged,constraint:{kind:ES.StagedRangeEquality,cursor:0,index:a.sheetIdx,cells:l,target:r.target},output:void 0}}function HTr(e,r){var t=r.cursor,n=r.cells;if(t>=n.length)return zp;var a=n[t],o=d4(e,r.index,a),u=o===void 0?zp:W$(e,o,r.target);return r.cursor+=1,{kind:mv.Staged,constraint:r,output:u}}function H$(e,r){var t=xAe(e.typeContext,r);if(t!==void 0)switch(t){case Bh.FormatValueType.Currency:case Bh.FormatValueType.Accounting:return BTr;case Bh.FormatValueType.Percentage:return V$;case Bh.FormatValueType.Date:return Wl.UnitExperimentSettings.UnitlessTimeAndDate?V$:UTr;case Bh.FormatValueType.Time:return Wl.UnitExperimentSettings.UnitlessTimeAndDate?V$:KTr;default:return}}function zTr(e,r){var t=H$(e,r.format);if(t===void 0)return zp;var n=d4(e,r.cell.sheet,r.cell.range);if(n===void 0)return zp;if(!(0,gv.isSimpleUnit)(n))return OAe(r);if(n.varCount===1){(0,Wm.assertTrue)(jm.Messages.Root,n.name!==void 0);var a=e.symbolContext.getTable().getValue(n.name);(0,Wm.assertTrue)(jm.Messages.Root,a!==void 0);var o=e.uf.findWithDescriptor(j$(e,a)),u=o[0],s=o[1];return l4(e,s,u,t,void 0)}return l4(e,n,void 0,t,void 0)}function QTr(e){var r=e.symbolContext.getTable();return function(t){var n=r.getValue(t);if(!(n===void 0||n.link===void 0))return n.ufSubstitution===void 0&&(n.ufSubstitution=e.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution}}var XTr=(DN={},DN[ES.UnitEquality]=jTr,DN[ES.FormatEquality]=zTr,DN[ES.RangeEquality]=WTr,DN[ES.StagedRangeEquality]=HTr,DN);function YTr(e){var r=e.context,t=r.apply,n=r.errorUnit,a={kind:LN.ExperimentState.SolvingFull,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:function(u,s){var l=t(a.substitution,u);if(l!==n){var c=t(a.substitution,s);if(c!==n){var d=(0,gv.unify)(t,l,c);if(d.kind===gv.UnificationResultKind.Subst){a.substitution=(0,gv.compose)(t,d.substitution,a.substitution);return}a.stats.errorCount+=1,a.stats.enriched.errors.push({error:[t(a.substitution,u),t(a.substitution,s)]})}}},substitution:QTr(e.context)};return a}function JTr(e){var r=e.constraints,t=e.context,n=e.constraintCursor,a=e.deferred,o=r[n],u=XTr[o.kind](t,o);switch(u.kind){case mv.Deferred:a.push(u.constraint);break;case mv.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:u.error});break;case mv.Staged:if(r[n]=u.constraint,u.output!==void 0)switch(u.output.kind){case mv.Deferred:a.push(u.output.constraint);break;case mv.Failed:e.stats.errorCount+=1,e.stats.enriched.errors.push({error:u.output.error});break}return e;default:break}return e.constraintCursor+=1,e}function ZTr(e){var r=e.constraints,t=e.context,n=e.constraintCursor,a=e.unifyNF,o=r[n];switch(o.kind){case ES.UnitEquality:a(o.unit,o.target.unit);break;case ES.FormatEquality:var u=H$(t,o.format);if(u===void 0)break;var s=d4(t,o.cell.sheet,o.cell.range);if(s===void 0)break;a(u,s);break;default:return e.constraintCursor+=1,(0,Wm.assertNever)(jm.Messages.Root,o)}return e.constraintCursor+=1,e}function $Tr(e){return e.kind===LN.ExperimentState.SolvingSimple?e.constraintCursor===e.constraints.length?YTr(e):JTr(e):ZTr(e)}Wl.runSolverStep=$Tr});var Y$=T(m4=>{"use strict";p();Object.defineProperty(m4,"__esModule",{value:!0});m4.UnitExperiment=void 0;var IAe=fe(),BR=Ba(),wAe=No(),Vt=Qf(),UI=ti(),eRr=kA(),rRr=yG(),KI=o4(),hv=a4(),Ze=G$(),tRr=z$(),vv=z$(),nRr=yK(),DAe=Hf(),aRr=_R(),BC=zn(),PS=Eg(),LAe=ks(),td=Tq(),f4=qi(),Q$=Zc(),iRr=Pf(),oRr=function(){function e(){this.isDone=!1,this.lastStepMessage="before started"}return Object.defineProperty(e.prototype,"done",{get:function(){return this.isDone},enumerable:!1,configurable:!0}),e.prototype.freshCheckingState=function(r){var t=this;this.lastStepMessage="freshCheckingState";var n=[],a={};r.getServerAvailableCells().forEach(function(s){var l,c=r.getServerUsedRange(s.sheetIdx);if(c.kind!==BC.ResultKind.Success){t.isDone=!0,t.statsMessage="Unit experiment: getServerUsedRange failed";return}var d=IAe.__assign(IAe.__assign({},s),{usedRange:(l=c.value)===null||l===void 0?void 0:l.range});a[s.sheetIdx.index]=d,n.push(d)});var o=r.getServerDocument()===void 0?function(){return(0,BC.failure)(void 0)}:function(s){return r.getIformat(r.getServerDocument(),s)},u=function(l){if(r.getServerDocument()===void 0)return!1;var c=r.getServerValue(l);return c.kind===BC.ResultKind.Success&&c.value.oper.kind===PS.OperKind.String};return{kind:Ze.ExperimentState.Checking,locale:r.config.localeInfo,mathpack:r.config.mathpack,resolver:(0,rRr.createResolver)(r),documentTypeContext:{formats:function(l){return r.getServerFormat(l)},types:{},available:a,getIformat:o,isStringValue:u},constraints:[],stats:{formulaCells:0,referencedFormatCells:0,allFormatCells:0,totalCells:0,errorCount:0,enriched:{errors:[],referencedFormatTypes:{},allFormatTypes:{},referencedCurrencyTypes:{},allCurrencyTypes:{}}},sheets:n,mutableState:{symbolContext:uRr.init(),ranges:void 0,cells:void 0,sheetCursor:0,rangeCursor:0,cellCursor:0}}},e.prototype.freshSolvingState=function(r){return this.lastStepMessage="freshSolvingState",{kind:Ze.ExperimentState.SolvingSimple,stats:r.stats,context:(0,vv.makeSolverContext)(r.mutableState.symbolContext,r.documentTypeContext,r.stats),constraints:r.constraints,constraintCursor:0,deferred:[]}},e.prototype.step=function(){if(!this.isDone){if(this.documentContext===void 0)return this.isDone=!0,(0,BR.assertNever)("".concat(hv.Messages.Root,".").concat(hv.Messages.Initialised),this.documentContext);this.state===void 0&&(this.state=this.freshCheckingState(this.documentContext));try{var r=this.state;switch(r.kind){case Ze.ExperimentState.Checking:if(r.mutableState.sheetCursor<r.sheets.length){this.state=this.runCheckStep(this.documentContext,r);return}this.state=this.freshSolvingState(r);return;case Ze.ExperimentState.SolvingSimple:this.lastStepMessage="SolvingSimple",this.state=(0,vv.runSolverStep)(r);return;case Ze.ExperimentState.SolvingFull:if(r.constraintCursor<r.constraints.length){this.lastStepMessage="SolvingFull",this.state=(0,vv.runSolverStep)(r);return}this.lastStepMessage="done SolvingFull",this.isDone=!0,this.statsMessage=this.statsForLogging(r.stats);return}}catch(t){this.statsMessage="".concat(hv.Messages.Root,".").concat(hv.Messages.Failure,": ").concat((0,DAe.messageFromError)(t)),this.isDone=!0;return}}},e.prototype.setContext=function(r){var t=r.documents;this.documentContext=t},e.prototype.initialiseSheetStep=function(r){this.lastStepMessage="initialiseSheetStep";var t=r.mutableState,n=r.sheets,a=t.sheetCursor,o=n[a],u=o.usedRange,s=[];if(u!==void 0){var l=(0,iRr.intersectProduct)(o.availableCells,Q$.availableReadProduct);(0,Q$.forEachRangeInSet)(l,function(c){var d=(0,f4.gridRangeIsect)(c,u);if(d!==void 0){if((0,f4.gridRangeSize)(d)<250)return s.push(d),!0;(0,f4.forEachTileInRange)(d,15,function(f){return s.push(f),!0})}return!0})}return t.ranges=s,t.rangeCursor=0,r.documentTypeContext.types[o.sheetIdx.index]=(0,aRr.makeGridRangeTable)(),r},e.prototype.initialiseRangeCells=function(r,t){this.lastStepMessage="initialiseRangeCells";var n=t.mutableState,a=t.stats,o=t.sheets,u=n.sheetCursor,s=[],l=o[u],c=n.ranges[n.rangeCursor];return r.forEachServerNonBlankCellInSet(l.sheetIdx,(0,Q$.createCellSetFromRange)(c),function(d){var f,m=(0,wAe.sheetGridCell)(l.sheetIdx,d),v=r.getServerFormula(m);v.kind===BC.ResultKind.Success&&((f=v.value)===null||f===void 0?void 0:f[1].compiledFmla)!==void 0&&(s.push(v.value[1]),a.formulaCells+=1);var h=r.getServerFormat(m);return h.kind===BC.ResultKind.Success&&(0,vv.isInterestingFormat)(t.documentTypeContext,h.value)&&(0,vv.updateFormatStatsFromCellFormat)(t.documentTypeContext,h.value,a,!1),a.totalCells+=1,!0}),n.cells=s,n.cellCursor=0,t},e.prototype.checkCell=function(r,t){this.lastStepMessage="checkCell";var n=t.sheets,a=t.constraints,o=t.stats,u=t.mutableState,s=u.cells,l=u.sheetCursor,c=u.cellCursor,d=n[l],f=s[c],m=f.compiledFmla.getValue();if(m.kind===BC.ResultKind.Success){var v=(0,wAe.sheetGridCell)(d.sheetIdx,f.origin),h=_Rr(t,v,m.value);t.documentTypeContext.types[d.sheetIdx.index]=h;var y=r.getServerFormat(v);y.kind===BC.ResultKind.Success&&(0,vv.isInterestingFormat)(t.documentTypeContext,y.value)&&(a.push({kind:vv.ConstraintKind.FormatEquality,cell:v,format:y.value}),(0,vv.updateFormatStatsFromCellFormat)(t.documentTypeContext,y.value,o,!0))}return t.mutableState.cellCursor+=1,t},e.prototype.runCheckStep=function(r,t){if(!lRr(t))return this.initialiseSheetStep(t);var n=t.mutableState;return n.rangeCursor===n.ranges.length?(n.ranges=void 0,n.sheetCursor+=1,t):sRr(t)?n.cellCursor<t.mutableState.cells.length?this.checkCell(r,t):(n.cells=void 0,n.rangeCursor+=1,t):this.initialiseRangeCells(r,t)},e.prototype.statsForLogging=function(r){return JSON.stringify(r)},Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){var t;return(t=this.statsMessage)!==null&&t!==void 0?t:"".concat(hv.Messages.Root,".").concat(hv.Messages.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){var t,n,a,o,u,s=(t=this.state)===null||t===void 0?void 0:t.kind,l=((n=this.state)===null||n===void 0?void 0:n.kind)===Ze.ExperimentState.Checking&&((a=this.state)===null||a===void 0?void 0:a.mutableState.cellCursor)===0;return"Units experiment timed out. Last step: ".concat(this.lastStepMessage,". Experiment state: ").concat(s!==void 0?Ze.ExperimentState[s]:"NotStarted",". isCellCursorZero: ").concat(l,". Number of constraints: ").concat((o=this.state)===null||o===void 0?void 0:o.constraints.length,". Stats: ").concat(this.statsForLogging((u=this.state)===null||u===void 0?void 0:u.stats))},enumerable:!1,configurable:!0}),e}();m4.UnitExperiment=oRr;var uRr=function(){function e(r,t){this.seed=r,this.table=t}return e.init=function(){return new e(0,nRr.RedBlackMapTree.create(function(r,t){return r.localeCompare(t)}))},e.prototype.getTable=function(){return this.table},e.prototype.freshSymbol=function(r){var t=r===void 0?"gen":r,n="".concat(t,"@").concat(this.seed+=1),a={unit:(0,KI.fromVar)(n),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(n,a),a},e.prototype.copy=function(){return new e(this.seed,this.table)},e}();function sRr(e){return e.mutableState.cells!==void 0}function lRr(e){return e.mutableState.ranges!==void 0}function cRr(e,r){return e===Ze.bottomType?r:r===Ze.bottomType||e===Ze.topType?e:r===Ze.topType?r:e.kind===Ze.TypeKind.Scalar&&r.kind===Ze.TypeKind.Scalar&&e.unit===void 0&&r.unit===void 0?(0,Ze.makePrimitiveType)(e.flags|r.flags):Ze.topType}function qN(e,r,t){switch(e.kind){case Ze.TypeKind.Array:return e.elementType.kind===Ze.TypeKind.Reference?void 0:t?qN(e.elementType,r,!1):void 0;case Ze.TypeKind.Reference:return{kind:vv.ConstraintKind.RangeEquality,type:e,target:r};case Ze.TypeKind.Scalar:return e.unit===void 0?void 0:{kind:vv.ConstraintKind.UnitEquality,unit:e.unit,target:r};case Ze.TypeKind.Union:return;default:return(0,BR.assertNever)(hv.Messages.Root,e)}}function dRr(e){switch(e.kind){case PS.OperKind.Number:return Ze.numberType;case PS.OperKind.String:return Ze.stringType;case PS.OperKind.Boolean:return Ze.boolType;case PS.OperKind.Error:return Ze.errorType;default:return Ze.oneType}}function X$(e,r,t){switch(r.kind){case Ze.TypeKind.Array:return r.elementType.kind===Ze.TypeKind.Reference?void 0:t?X$(e,r.elementType,!1):void 0;case Ze.TypeKind.Reference:var n=e.symbolContext.freshSymbol(),a={kind:vv.ConstraintKind.RangeEquality,type:r,target:n};return[n.unit,a];case Ze.TypeKind.Scalar:return r.unit===void 0?void 0:[r.unit,void 0];case Ze.TypeKind.Union:return;default:return(0,BR.assertNever)(hv.Messages.Root,r)}}function fRr(e){var r=e.length;if(r===0)return Ze.topType;for(var t=Ze.bottomType,n=e[0].length,a=0;a<e.length;a+=1)for(var o=e[a],u=0;u<o.length;u+=1)t=cRr(t,o[u]);return(0,Ze.makeArrayType)(t,{rows:r,columns:n,exact:!0})}function pRr(e,r){var t=(0,eRr.resolveLocalsGrid)(e.origin),n=e.resolver.resolveCellRef(t,r.reference).resolution;return(0,BC.isSuccess)(n)?n.value?n.value:!0:!1}function f_(e,r){if(r.kind===Ze.TypeKind.Reference&&!(0,Ze.isResolvedReferenceType)(r)){var t=pRr(e,r);return typeof t=="object"?(0,Ze.makeResolvedReferenceType)(r.reference,t):t?Ze.errorType:void 0}if(r.kind===Ze.TypeKind.Array){var n=f_(e,r.elementType);return n===void 0?n:n===r.elementType?r:(0,Ze.makeArrayType)(n,r.dimensions)}return r}function qAe(e,r){switch(r.kind){case Ze.TypeKind.Scalar:if(r.unit===void 0){var t=e.symbolContext.freshSymbol();return(0,Ze.makePrimitiveType)(r.flags,t.unit)}return r;case Ze.TypeKind.Array:for(var n=r,a=[];n.kind===Ze.TypeKind.Array;)a.push(n.dimensions),n=n.elementType;var o=qAe(e,n);return a.reduceRight(Ze.makeArrayType,o);case Ze.TypeKind.Reference:case Ze.TypeKind.Union:return r;default:return(0,BR.assertNever)(hv.Messages.Root,r)}}function p4(e,r,t,n,a){var o=e.symbolContext.freshSymbol(),u=qN(r,o,n),s=qN(t,o,n);if(u!==void 0&&s!==void 0||a&&(u!==void 0||s!==void 0))return e.pushConstraint(u),e.pushConstraint(s),o}function mRr(e,r,t){switch(r){case Vt.WorksheetFuncId.SUM:case Vt.WorksheetFuncId.AVERAGE:case Vt.WorksheetFuncId.MAX:case Vt.WorksheetFuncId.MIN:if(t.length===0)return Ze.topType;var n=e.symbolContext.freshSymbol(),a=!0;return t.forEach(function(m){var v=f_(e,m);v&&e.pushConstraint(qN(v,n,!0))&&(a=!1)}),a?Ze.numberType:(0,Ze.makePrimitiveType)(PS.OperKind.Number,n.unit);case Vt.WorksheetFuncId.IF:if(t.length<2)return Ze.topType;var o=f_(e,t[0]),u=f_(e,t[1]),s=f_(e,t[2]===void 0?Ze.boolType:t[2]);if(o===void 0)return u!==void 0&&s!==void 0&&p4(e,u,s,!0,!1),Ze.topType;var l=(0,Ze.dimensionsFromType)(o),c=typeof l=="object";if(u===void 0||s===void 0)return Ze.topType;var d=p4(e,u,s,!0,!0),f=d?(0,Ze.primitiveUnitType)(d.unit):Ze.primitiveType;return c?(0,Ze.makeArrayType)(f,l):f;default:return Ze.topType}}function gRr(e,r,t){if(t.length<2)return Ze.topType;var n=f_(e,t[0][0]),a=f_(e,t[1][0]);if(n===void 0||a===void 0)return Ze.topType;var o=(0,Ze.getLiftingDimensionsFromTypes)(n,a);if(o===!1)return Ze.topType;var u=typeof o=="object";switch(r){case Vt.OperatorId.Add:case Vt.OperatorId.Sub:case Vt.OperatorId.Min:case Vt.OperatorId.Max:{var s=p4(e,n,a,u,!0);return(0,Ze.typeFromDimensions)(s===void 0?Ze.numberType:(0,Ze.makePrimitiveType)(PS.OperKind.Number,s.unit),o)}case Vt.OperatorId.Eq:case Vt.OperatorId.Ne:case Vt.OperatorId.Lt:case Vt.OperatorId.Le:case Vt.OperatorId.Gt:case Vt.OperatorId.Ge:return p4(e,n,a,u,!1),(0,Ze.typeFromDimensions)(Ze.boolType,o);case Vt.OperatorId.Mul:case Vt.OperatorId.Div:if(tRr.UnitExperimentSettings.IgnoreDivMul)return Ze.numberType;var l=e.symbolContext.freshSymbol(),c=e.symbolContext.freshSymbol(),d=qN(n,l,u),f=qN(a,c,u);if(e.pushConstraint(d),e.pushConstraint(f),d===void 0&&f===void 0)return(0,Ze.typeFromDimensions)(Ze.numberType,o);var m=r===Vt.OperatorId.Mul?(0,KI.prod)(l.unit,c.unit):(0,KI.prod)(l.unit,(0,KI.inv)(c.unit));return(0,Ze.typeFromDimensions)((0,Ze.makePrimitiveType)(PS.OperKind.Number,m),o);case Vt.OperatorId.Pow:var v=t[1],h=v[1];if((0,f4.isNumberLiteralNode)(h)){var y=e.mathpack.toNumber(h.oper);if((0,DAe.isInteger)(y)){var _=X$(e,n,typeof o=="object");return _===void 0?(0,Ze.typeFromDimensions)(Ze.numberType,o):(e.pushConstraint(_[1]),(0,Ze.typeFromDimensions)((0,Ze.makePrimitiveType)(PS.OperKind.Number,(0,KI.pow)(_[0],y,Ze.dimensionLess)),o))}}return Ze.topType;case Vt.OperatorId.Range:case Vt.OperatorId.Isect:case Vt.OperatorId.Union:return Ze.topType;case Vt.OperatorId.Concat:return(0,Ze.typeFromDimensions)(Ze.stringType,o);case Vt.OperatorId.And:case Vt.OperatorId.Or:case Vt.OperatorId.Xor:return(0,Ze.typeFromDimensions)(Ze.boolType,o);default:return(0,BR.assertNever)(hv.Messages.Root,r)}}function vRr(e,r,t){if(t.length<1)return Ze.topType;var n=t[0][0],a=f_(e,n);if(a===void 0)return Ze.topType;var o=(0,Ze.dimensionsFromType)(a);if(o===!1)return Ze.topType;switch(r){case Vt.OperatorId.Percent:return(0,Ze.typeFromDimensions)(Ze.dimensionlessNumberType,o);case Vt.OperatorId.Neg:case Vt.OperatorId.Pos:var u=X$(e,a,typeof o=="object");return u===void 0?(0,Ze.typeFromDimensions)(Ze.numberType,o):(e.pushConstraint(u[1]),(0,Ze.typeFromDimensions)((0,Ze.makePrimitiveType)(PS.OperKind.Number,u[0]),o));case Vt.OperatorId.At:case Vt.OperatorId.Pound:return Ze.topType;default:return(0,BR.assertNever)(hv.Messages.Root,r)}}function hRr(e,r,t){switch(r){case Vt.OperatorId.Add:case Vt.OperatorId.Sub:case Vt.OperatorId.Mul:case Vt.OperatorId.Div:case Vt.OperatorId.Pow:case Vt.OperatorId.Eq:case Vt.OperatorId.Ne:case Vt.OperatorId.Lt:case Vt.OperatorId.Le:case Vt.OperatorId.Gt:case Vt.OperatorId.Ge:case Vt.OperatorId.Range:case Vt.OperatorId.Isect:case Vt.OperatorId.Union:case Vt.OperatorId.Concat:case Vt.OperatorId.And:case Vt.OperatorId.Or:case Vt.OperatorId.Xor:case Vt.OperatorId.Min:case Vt.OperatorId.Max:return gRr(e,r,t);case Vt.OperatorId.Percent:case Vt.OperatorId.Neg:case Vt.OperatorId.Pos:case Vt.OperatorId.At:case Vt.OperatorId.Pound:return vRr(e,r,t);default:return(0,BR.assertNever)(hv.Messages.Root,r)}}var SRr=function(){function e(r){var t=this;this.context=r,this.visitFormulaNode=function(n){return(0,LAe.visitFormulaNode)(t,n)},this.lazyVisitFormulaNode=function(n){return td.Pledge.resolve(n).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(r){return td.Pledge.resolve(dRr(r))},e.prototype.arrayNode=function(r){var t=this;return td.Pledge.all(r.map(function(n){return td.Pledge.all(n.map(t.lazyVisitFormulaNode))})).bind(fRr)},e.prototype.appNode=function(r,t){var n=this;return r.kind===UI.NodeKind.Operator?td.Pledge.all(t.map(function(a){return n.lazyVisitFormulaNode(a).bind(function(o){return[o,a]})})).bind(function(a){return hRr(n.context,r.id,a)}):r.kind===UI.NodeKind.WSF?td.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind(function(a){return mRr(n.context,r.id,a)}):td.Pledge.resolve(Ze.topType)},e.prototype.letNode=function(r,t,n,a){return td.Pledge.resolve(Ze.topType)},e.prototype.lambdaNode=function(r,t,n,a){return td.Pledge.resolve(Ze.topType)},e.prototype.parenNode=function(r){return this.lazyVisitFormulaNode(r)},e.prototype.nameNode=function(r,t){return td.Pledge.resolve(Ze.topType)},e.prototype.cellRefNode=function(r,t){return td.Pledge.resolve((0,Ze.makeReferenceType)((0,UI.cellRefNode)(r,t)))},e.prototype.fieldRefNode=function(r,t){return td.Pledge.resolve(Ze.topType)},e.prototype.structRefNode=function(r,t){return td.Pledge.resolve(Ze.topType)},e.prototype.missingNode=function(r){return td.Pledge.resolve(Ze.topType)},e.prototype.badSequenceNode=function(r,t){return td.Pledge.resolve(Ze.topType)},e.prototype.badCharsNode=function(r,t){return td.Pledge.resolve(Ze.topType)},e.prototype.operatorNode=function(r,t){return td.Pledge.resolve((0,UI.operatorNode)(r,t))},e.prototype.wsfNode=function(r,t,n){return td.Pledge.resolve((0,UI.wsfNode)(r,t,n))},e}();function yRr(e,r){return(0,LAe.reducePledge)(new SRr(e),r)}function _Rr(e,r,t){var n=e.constraints,a=e.locale,o=e.mathpack,u=e.resolver,s=e.documentTypeContext,l=function(k){return k!==void 0?(n.push(k),!0):!1},c=s.types[r.sheet.index],d=e.mutableState.symbolContext.copy(),f={origin:r,locale:a,mathpack:o,resolver:u,symbolContext:d,pushConstraint:l},m=yRr(f,t),v=f_(f,m),h=qAe(f,v===void 0?Ze.topType:v),y=h;if(y.kind===Ze.TypeKind.Reference){var _=d.freshSymbol(),E={kind:vv.ConstraintKind.RangeEquality,type:y,target:_};y=(0,Ze.primitiveUnitType)(_.unit),n.push(E)}return e.mutableState.symbolContext=d,y.kind===Ze.TypeKind.Array?c:c.setValue(r.range,y)}});var jI=T(UC=>{"use strict";p();Object.defineProperty(UC,"__esModule",{value:!0});UC.registerExperimentFactory=UC.getExperimentFactories=UC.ExperimentKind=void 0;var GAe=nl(),bRr=Ba(),BAe=Ar(),CRr=uAe(),TRr=Y$(),RRr=function(){function e(r){this.stepDelay=r,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}return e.create=function(r){if(typeof r!="number"){var t="calc.calc.TestExperiment: expected number; given ".concat(r);bRr.ulsLogger.ULS.traceTag(591974878,GAe.LogCategory.msoulscat_ES_EWAJS,GAe.TraceLevel.Warning,t);return}return new e(r)},e.prototype.setContext=function(){},e.prototype.step=function(){for(var r=(0,BAe.now)();(0,BAe.now)()<r+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)},e}(),VI;(function(e){e.OneShot="OneShot",e.Recurring="Recurring",e.Precision="Precision"})(VI||(UC.ExperimentKind=VI={}));var J$={TestExperiment:function(r){return{experimentName:"TestExperiment",kind:VI.OneShot,create:function(){return RRr.create(r)}}},ExceLintExperiment:function(){return{experimentName:"ExceLintExperiment",kind:VI.OneShot,create:function(){return new CRr.ExceLintExperiment}}},UnitExperiment:function(){return{experimentName:"UnitExperiment",kind:VI.OneShot,create:function(){return new TRr.UnitExperiment},stepBudget:80}}};function ERr(e){var r=e.map(function(t){var n,a=t.name,o=t.param;return(n=J$[a])===null||n===void 0?void 0:n.call(J$,o)});return r.filter(function(t){return t!==void 0})}UC.getExperimentFactories=ERr;function PRr(e,r){J$[e]=r}UC.registerExperimentFactory=PRr});var GN=T(KC=>{"use strict";p();Object.defineProperty(KC,"__esModule",{value:!0});KC.ResolvablePromiseWithSyncValue=KC.ResolvablePromiseWithTimeout=KC.ResolvablePromise=void 0;var Z$=pr();KC.ResolvablePromise=Z$.resolvablePromise.ResolvablePromise;KC.ResolvablePromiseWithTimeout=Z$.resolvablePromise.ResolvablePromiseWithTimeout;KC.ResolvablePromiseWithSyncValue=Z$.resolvablePromise.ResolvablePromiseWithSyncValue});var KAe=T(g4=>{"use strict";p();Object.defineProperty(g4,"__esModule",{value:!0});g4.DefinedNameInfoType=void 0;var UAe;(function(e){e[e.Invalid=-1]="Invalid",e[e.Table=0]="Table",e[e.NamedRange=1]="NamedRange",e[e.Lambda=2]="Lambda",e[e.Other=3]="Other"})(UAe||(g4.DefinedNameInfoType=UAe={}))});var jAe=T(v4=>{"use strict";p();Object.defineProperty(v4,"__esModule",{value:!0});v4.MajorityDataType=void 0;var VAe;(function(e){e[e.Text=0]="Text",e[e.Number=1]="Number",e[e.Date=2]="Date",e[e.Max=3]="Max"})(VAe||(v4.MajorityDataType=VAe={}))});var JAe=T(Qp=>{"use strict";p();Object.defineProperty(Qp,"__esModule",{value:!0});Qp.RepairItemPartType=Qp.CodeActionKind=Qp.DiagnosticTag=Qp.DiagnosticSeverity=Qp.SuggestionKind=Qp.CompletionItemKind=void 0;var WAe;(function(e){e[e.Function=3]="Function",e[e.Enum=13]="Enum",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef",e[e.NamedOther=110]="NamedOther"})(WAe||(Qp.CompletionItemKind=WAe={}));var HAe;(function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"})(HAe||(Qp.SuggestionKind=HAe={}));var zAe;(function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"})(zAe||(Qp.DiagnosticSeverity=zAe={}));var QAe;(function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"})(QAe||(Qp.DiagnosticTag=QAe={}));var XAe;(function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"})(XAe||(Qp.CodeActionKind=XAe={}));var YAe;(function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"})(YAe||(Qp.RepairItemPartType=YAe={}))});var $Ae=T(ZAe=>{"use strict";p();Object.defineProperty(ZAe,"__esModule",{value:!0})});var tFe=T(BN=>{"use strict";p();Object.defineProperty(BN,"__esModule",{value:!0});BN.ReferenceMode=BN.IncompatibilityType=void 0;var eFe;(function(e){e[e.gMove=1]="gMove"})(eFe||(BN.IncompatibilityType=eFe={}));var rFe;(function(e){e[e.R1C1=0]="R1C1",e[e.A1=1]="A1"})(rFe||(BN.ReferenceMode=rFe={}))});var aFe=T(nFe=>{"use strict";p();Object.defineProperty(nFe,"__esModule",{value:!0})});var oFe=T(iFe=>{"use strict";p();Object.defineProperty(iFe,"__esModule",{value:!0})});var sFe=T(h4=>{"use strict";p();Object.defineProperty(h4,"__esModule",{value:!0});h4.Rounding=void 0;var uFe;(function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"})(uFe||(h4.Rounding=uFe={}))});var TFe=T(po=>{"use strict";p();Object.defineProperty(po,"__esModule",{value:!0});po.TableOrientation=po.RecognizedTablesMetadataState=po.ColumnFormulaSuggestionUpdateKind=po.SchedulerFeature=po.GotoCtrlClickResultKind=po.ValuePreviewResultKind=po.PositionKind=po.HighlightKind=po.PerCharacterExperimentResultKind=po.PluginAttachGroup=po.PluginGroup=po.PluginFactoryName=po.MessageType=po.EditorMessageType=void 0;var lFe;(function(e){e[e.FunctionMessage=0]="FunctionMessage"})(lFe||(po.EditorMessageType=lFe={}));var cFe;(function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"})(cFe||(po.MessageType=cFe={}));var dFe;(function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.GotoCtrlClickPlugin=18]="GotoCtrlClickPlugin",e[e.AutocompleteEnumPlugin=19]="AutocompleteEnumPlugin",e[e.FormulaByExamplePlugin=20]="FormulaByExamplePlugin",e[e.SetCellPrefetchPlugin=21]="SetCellPrefetchPlugin",e[e.FormulaTranspilerPlugin=22]="FormulaTranspilerPlugin",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin",e[e.EventsTestPlugin=2006]="EventsTestPlugin"})(dFe||(po.PluginFactoryName=dFe={}));var fFe;(function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"})(fFe||(po.PluginGroup=fFe={}));var pFe;(function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"})(pFe||(po.PluginAttachGroup=pFe={}));var mFe;(function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"})(mFe||(po.PerCharacterExperimentResultKind=mFe={}));var gFe;(function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"})(gFe||(po.HighlightKind=gFe={}));var vFe;(function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"})(vFe||(po.PositionKind=vFe={}));var hFe;(function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"})(hFe||(po.ValuePreviewResultKind=hFe={}));var SFe;(function(e){e[e.ReferenceFound=0]="ReferenceFound",e[e.NoReferenceFound=1]="NoReferenceFound",e[e.Failure=2]="Failure",e[e.RangeResolutionFailure=3]="RangeResolutionFailure",e[e.NotAFormula=4]="NotAFormula"})(SFe||(po.GotoCtrlClickResultKind=SFe={}));var yFe;(function(e){e[e.ArgumentAssistance=0]="ArgumentAssistance",e[e.SimpleAutoComplete=1]="SimpleAutoComplete",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete",e[e.ValuePreview=3]="ValuePreview",e[e.ColoredReferences=4]="ColoredReferences",e[e.ParenthesisCoupling=5]="ParenthesisCoupling",e[e.SyntaxErrors=6]="SyntaxErrors",e[e.GotoCtrlClick=7]="GotoCtrlClick",e[e.EnumAutoComplete=8]="EnumAutoComplete"})(yFe||(po.SchedulerFeature=yFe={}));var _Fe;(function(e){e[e.Accept=0]="Accept",e[e.Decline=1]="Decline",e[e.Ignore=2]="Ignore"})(_Fe||(po.ColumnFormulaSuggestionUpdateKind=_Fe={}));var bFe;(function(e){e[e.Valid=2]="Valid",e[e.Invalid=4]="Invalid",e[e.All=6]="All"})(bFe||(po.RecognizedTablesMetadataState=bFe={}));var CFe;(function(e){e[e.none=0]="none",e[e.rowMajor=1]="rowMajor",e[e.columnMajor=2]="columnMajor"})(CFe||(po.TableOrientation=CFe={}))});var EFe=T(RFe=>{"use strict";p();Object.defineProperty(RFe,"__esModule",{value:!0})});var AFe=T(PFe=>{"use strict";p();Object.defineProperty(PFe,"__esModule",{value:!0})});var NFe=T(FFe=>{"use strict";p();Object.defineProperty(FFe,"__esModule",{value:!0})});var kFe=T(OFe=>{"use strict";p();Object.defineProperty(OFe,"__esModule",{value:!0})});var MFe=T($$=>{"use strict";p();Object.defineProperty($$,"__esModule",{value:!0});var ARr=fe();ARr.__exportStar(kFe(),$$)});var ia=T(dp=>{"use strict";p();Object.defineProperty(dp,"__esModule",{value:!0});var Hm=fe();Hm.__exportStar(KAe(),dp);Hm.__exportStar(jAe(),dp);Hm.__exportStar(JAe(),dp);Hm.__exportStar($Ae(),dp);Hm.__exportStar(tFe(),dp);Hm.__exportStar(aFe(),dp);Hm.__exportStar(oFe(),dp);Hm.__exportStar(sFe(),dp);Hm.__exportStar(TFe(),dp);Hm.__exportStar(EFe(),dp);Hm.__exportStar(AFe(),dp);Hm.__exportStar(NFe(),dp);Hm.__exportStar(MFe(),dp)});var xFe=T(S4=>{"use strict";p();Object.defineProperty(S4,"__esModule",{value:!0});S4.JSF32=void 0;var FRr=pr();Object.defineProperty(S4,"JSF32",{enumerable:!0,get:function(){return FRr.JSF32}})});var ree=T(ys=>{"use strict";p();Object.defineProperty(ys,"__esModule",{value:!0});ys.sendX10UsedTelemetryEvent=ys.createX10RequestPerformanceEvent=ys.createX10AggregatedTelemetryEvent=ys.addSampleWithProbability=ys.getHistogramBinIndexForDuration=ys.updateDurationHistogramsWithRequestTimes=ys.histogramBinCount=ys.REQUEST_DURATION_THRESHOLDS=void 0;var NRr=Ar(),ORr=xFe(),WI=JS(),kRr=w1();ys.REQUEST_DURATION_THRESHOLDS=[5,10,20,50,100,200];ys.histogramBinCount=ys.REQUEST_DURATION_THRESHOLDS.length+1;var MRr=new ORr.JSF32(0),IFe=!1;function xRr(e){return Object.entries(e)}function IRr(e,r){return xRr(r).forEach(function(t){var n,a=t[0],o=t[1];if((0,NRr.isDefined)(o)&&o.numberOfRequests>0){var u=o.requestDuration/o.numberOfRequests,s=wFe(u),l=(n=e[a])!==null&&n!==void 0?n:Array(ys.histogramBinCount).fill(0);l[s]+=o.numberOfRequests,e[a]=l}}),e}ys.updateDurationHistogramsWithRequestTimes=IRr;function wFe(e){for(var r=0;r<ys.REQUEST_DURATION_THRESHOLDS.length;r++)if(e<ys.REQUEST_DURATION_THRESHOLDS[r])return r;return ys.REQUEST_DURATION_THRESHOLDS.length}ys.getHistogramBinIndexForDuration=wFe;function wRr(e,r,t){return DRr(t)&&MRr.next()<t&&e.push(r),e}ys.addSampleWithProbability=wRr;function DRr(e){return e>=0&&e<=1}function LRr(e){return{eventName:"Office.Excel.Client.X10.AggregatedTelemetry",eventFlags:eee(),dataFields:[(0,WI.makeStringDataField)("X10AggregatedTelemetryObject",e)]}}ys.createX10AggregatedTelemetryEvent=LRr;function qRr(e){return{eventName:"Office.Excel.Client.X10.RequestPerformance",eventFlags:eee(),dataFields:[(0,WI.makeStringDataField)("X10RequestPerformanceTelemetryObject",e)]}}ys.createX10RequestPerformanceEvent=qRr;function GRr(){IFe||((0,kRr.getTelemetryLogger)().sendTelemetryEvent({eventName:"Office.Excel.Client.X10.X10UsedEvent",eventFlags:eee()}),IFe=!0)}ys.sendX10UsedTelemetryEvent=GRr;function eee(){return{dataCategories:WI.EnumObjects.DataCategories.ProductServiceUsage,samplingPolicy:WI.EnumObjects.SamplingPolicy.Measure,diagnosticLevel:WI.EnumObjects.DiagnosticLevel.Optional}}});var Qm=T(Pu=>{"use strict";p();Object.defineProperty(Pu,"__esModule",{value:!0});Pu.DefaultMap=Pu.functionMapToGenericFunction1stArg=Pu.mapFromArrayOfDependantPairs=Pu.asReadonly=Pu.bindMethodsNullCheck=Pu.bindMethodsUnbox=Pu.bindLazyMethods=Pu.bindMethods=Pu.functionMapFromDUFunction=Pu.staticTypeHint=void 0;var LFe=fe(),zm=Ar();function BRr(e){}Pu.staticTypeHint=BRr;tee="",zm.staticAssertSame,zm.staticAssertSame,zm.staticAssertSame;var tee;URr=void 0,zm.staticAssertSame;var URr;function KRr(e,r){for(var t={},n=function(l){t[l]=function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return e.apply(void 0,LFe.__spreadArray([l],c,!1))}},a=0,o=r;a<o.length;a++){var u=o[a];n(u)}return t}Pu.functionMapFromDUFunction=KRr;function VRr(e,r){for(var t={},n=function(l){var c=function(){for(var f=[],m=0;m<arguments.length;m++)f[m]=arguments[m];return e[l].apply(e,f)};t[l]=c},a=0,o=r;a<o.length;a++){var u=o[a];n(u)}return t}Pu.bindMethods=VRr;function jRr(e,r){for(var t={},n=function(l){var c=function(){for(var f,m=[],v=0;v<arguments.length;v++)m[v]=arguments[v];return(f=e.getValue())[l].apply(f,m)};t[l]=c},a=0,o=r;a<o.length;a++){var u=o[a];n(u)}return t}Pu.bindLazyMethods=jRr;zm.staticAssertSame,zm.staticAssertSame,zm.staticAssertSame,zm.staticAssertSame;var WRr=function(){function e(){}return e.prototype.unbox=function(r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r(t)}},e.prototype.nullcheck=function(r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var a=0,o=t;a<o.length;a++){var u=o[a];if((0,zm.isNone)(u))return null}return r.apply(void 0,t)}},e}();function qFe(e){var r=new WRr,t=r[e].bind(r);return function(n,a){for(var o={},u=0,s=a;u<s.length;u++){var l=s[u],c=n[l].bind(n);o[l]=t(c)}return o}}Pu.bindMethodsUnbox=qFe("unbox");Pu.bindMethodsNullCheck=qFe("nullcheck");nee={methodF:function(r){return r+1},methodG:function(r){var t=r[0];return t+1}},DFe=(0,Pu.bindMethodsUnbox)(nee,["methodG"]),zm.staticAssertSame,HRr=(0,Pu.bindMethodsNullCheck)(nee,["methodG"]),zm.staticAssertSame,zRr=(0,Pu.bindMethodsNullCheck)(DFe,["methodG"]),zm.staticAssertSame;var nee,DFe,HRr,zRr;function QRr(e){return e}Pu.asReadonly=QRr;function GFe(e){return e.reduce(function(r,t){var n=t[0],a=t[1];return r[n]=a,r},{})}Pu.mapFromArrayOfDependantPairs=GFe;var knt=GFe([["a",1],["b",2]]);zm.staticAssertSame;function XRr(e){return function(r,t){for(var n,a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];return(n=e[r]).call.apply(n,LFe.__spreadArray([e,t],a,!1))}}Pu.functionMapToGenericFunction1stArg=XRr;var YRr=function(){function e(r){this.operations=r,this.map=new Map}return e.prototype.get=function(r){var t=this.operations.getKey(r),n=this.map.get(t);if(n!==void 0)return n;var a=this.operations.getDefault();return this.map.set(t,a),a},e.prototype.set=function(r,t){this.map.set(this.operations.getKey(r),t)},e}();Pu.DefaultMap=YRr});var Xp=T(Sv=>{"use strict";p();Object.defineProperty(Sv,"__esModule",{value:!0});Sv.x10Logger=Sv.CombinedLogger=Sv.ImmediateLogger=Sv.X10FailureKind=Sv.LoggerKind=void 0;var bi=fe(),zI=Ar(),Uh=Ba(),pl=Gi(),UFe=ia(),aee=Ms(),UN=ree(),JRr=Qm(),ZRr=w1(),HI="Main",$Rr=(0,aee.isTypedChangeGateEnabled)("OfficeVSO:8786821_x10SendLoggerMessagesToMainThread"),eEr=(0,aee.isTypedChangeGateEnabled)("OfficeVSO:8846142_x10SendTelemetryWithUTel"),QI;(function(e){e.Immediate="Immediate",e.Aggregating="Aggregating"})(QI||(Sv.LoggerKind=QI={}));var BFe;(function(e){e.ALFailure="ALFailure",e.AssertionFailure="AssertionFailure",e.CustomConflictResolverFailure="CustomConflictResolverFailure",e.EventCallbacksManagerFailure="EventCallbacksManagerFailure",e.GridFailure="GridFailure",e.NotificationProcessorFailure="NotificationProcessorFailure",e.PluginAttachmentFailure="PluginAttachmentFailure",e.PluginFailure="PluginFailure",e.RequestProcessorFailure="RequestProcessorFailure",e.TableIntelligenceFailure="TableIntelligenceFailure"})(BFe||(Sv.X10FailureKind=BFe={}));var Xm=function(r,t,n){return"x10arch.[".concat(r,"].").concat(t,": ").concat((0,zI.isDefined)(n.description)&&n.description.length?"".concat(n.description,". "):"").concat((0,zI.isDefined)(n.data)?JSON.stringify(n.data):"")};(0,zI.staticAssertSame)();var rEr={trackableAsyncLazy:function(r,t){return Uh.ulsLogger.ULS.traceTag(507316304,pl.LogCategory.msoulscat_ES_EWAJS,pl.TraceLevel.Info,Xm(r,"trackableAsyncLazy",{data:t}))},snapshotCreation:function(r,t){return Uh.ulsLogger.ULS.traceTag(512305240,pl.LogCategory.msoulscat_ES_EWAJS,pl.TraceLevel.Info,Xm(r,"snapshotCreation",{data:t}))},beginRequest:function(r,t){return Uh.ulsLogger.ULS.traceTag(553734792,pl.LogCategory.msoulscat_ES_EWAJS,pl.TraceLevel.Info,Xm(r,"beginRequest",{data:t}))},requestSkipped:function(r,t){return Uh.ulsLogger.ULS.traceTag(553734793,pl.LogCategory.msoulscat_ES_EWAJS,pl.TraceLevel.Info,Xm(r,"requestSkipped",{data:t}))},registerPluginFactory:function(r,t){var n=t.factoryName;return Uh.ulsLogger.ULS.traceTag(571246212,pl.LogCategory.msoulscat_ES_EWAJS,pl.TraceLevel.Info,Xm(r,"registerPluginFactory",{description:"registered ".concat(UFe.PluginFactoryName[n])}))},pluginCompletedInTime:function(r,t){var n=t.pluginName,a=t.logInfo;return Uh.ulsLogger.ULS.traceTag(553734790,pl.LogCategory.msoulscat_ES_EWAJS,pl.TraceLevel.Info,Xm(r,"pluginCompletedInTime",{description:"plugin completed in time. plugin name:".concat(n),data:a}))},computationStoppedExecution:function(r,t){var n=t.computationName,a=t.stopReason,o=t.logInfo;return Uh.ulsLogger.ULS.traceTag(509109120,pl.LogCategory.msoulscat_ES_EWAJS,pl.TraceLevel.Info,Xm(r,"pluginStoppedExecution",{data:bi.__assign({computationName:n,stopReason:a},o)}))},closeComputationFrame:function(r,t){return Uh.ulsLogger.ULS.traceTag(553734789,pl.LogCategory.msoulscat_ES_EWAJS,pl.TraceLevel.Info,Xm(r,"closeUIMessageFrame",{data:t}))},nullCheckViolation:function(r,t){return Uh.ulsLogger.ULS.traceTag(507803776,pl.LogCategory.msoulscat_ES_EWAJS,pl.TraceLevel.Warning,Xm(r,"nullCheckViolation",{data:t}))},failure:function(r,t){var n=t.failureKind,a=t.failureLevel,o=t.path,u=t.description,s=t.data;return Uh.ulsLogger.ULS.traceTag(507322970,pl.LogCategory.msoulscat_ES_EWAJS,a,Xm(r,o,{description:u,data:bi.__assign({failureKind:n,failureLevel:a},s)}))}},tEr={trackableAsyncLazy:{},snapshotCreation:{numSnapshots:0,numFreshSnapshots:0},beginRequest:{},requestSkipped:{},registerPluginFactory:{factories:[]},pluginCompletedInTime:{},computationStoppedExecution:{computationsStopReason:{},requestDurationHistograms:{},requestDurationHistogramByComputationKind:{},schedulerTimeSamples:[],computationTimeSamples:[]},closeComputationFrame:{},nullCheckViolation:{},failure:{}},nEr={trackableAsyncLazy:function(r,t){var n,a,o,u,s,l,c,d=t.name,f=t.syncTime,m=t.asyncTime;return bi.__assign(bi.__assign({},r),(n={},n[d]={numCalls:((o=(a=r[d])===null||a===void 0?void 0:a.numCalls)!==null&&o!==void 0?o:0)+1,totalSyncTime:((s=(u=r[d])===null||u===void 0?void 0:u.totalSyncTime)!==null&&s!==void 0?s:0)+f,totalAsyncTime:((c=(l=r[d])===null||l===void 0?void 0:l.totalAsyncTime)!==null&&c!==void 0?c:0)+m},n))},snapshotCreation:function(r,t){var n=r.numSnapshots,a=r.numFreshSnapshots;return{numSnapshots:n+1,numFreshSnapshots:a+(t?1:0)}},beginRequest:function(r,t){var n,a,o=t.computationKind;return bi.__assign(bi.__assign({},r),(n={},n[o]=((a=r[o])!==null&&a!==void 0?a:0)+1,n))},requestSkipped:function(r,t){var n,a,o=t.computationKind;return bi.__assign(bi.__assign({},r),(n={},n[o]=((a=r[o])!==null&&a!==void 0?a:0)+1,n))},registerPluginFactory:function(r,t){var n=r.factories,a=t.factoryName;return{factories:bi.__spreadArray(bi.__spreadArray([],n,!0),[UFe.PluginFactoryName[a]],!1)}},pluginCompletedInTime:function(r,t){var n,a,o=t.pluginName;return bi.__assign(bi.__assign({},r),(n={},n[o]=((a=r[o])!==null&&a!==void 0?a:0)+1,n))},computationStoppedExecution:function(r,t){var n,a,o,u,s,l,c=r.computationsStopReason,d=r.requestDurationHistograms,f=r.requestDurationHistogramByComputationKind,m=r.schedulerTimeSamples,v=r.computationTimeSamples,h=t.computationName,y=t.stopReason,_=t.logInfo,E=_.requestTimes,N=_.computationTime,k=_.schedulerTime;return{computationsStopReason:bi.__assign(bi.__assign({},c),(n={},n[h]=bi.__assign(bi.__assign({},c[h]),(a={},a[y]=((s=(u=c[h])===null||u===void 0?void 0:u[y])!==null&&s!==void 0?s:0)+1,a)),n)),requestDurationHistograms:(0,UN.updateDurationHistogramsWithRequestTimes)(d,E),requestDurationHistogramByComputationKind:bi.__assign(bi.__assign({},f),(o={},o[h]=(0,UN.updateDurationHistogramsWithRequestTimes)((l=f[h])!==null&&l!==void 0?l:{},E),o)),schedulerTimeSamples:(0,UN.addSampleWithProbability)(m,k,5e-4),computationTimeSamples:(0,UN.addSampleWithProbability)(v,N,5e-4)}},closeComputationFrame:function(r,t){var n,a,o,u;return bi.__assign(bi.__assign({},r),(n={},n[t.computationKind]=bi.__assign(bi.__assign({},r[t.computationKind]),(a={},a[t.stopReason]=((u=(o=r[t.computationKind])===null||o===void 0?void 0:o[t.stopReason])!==null&&u!==void 0?u:0)+1,a)),n))},nullCheckViolation:function(r,t){var n,a,o,u,s=t.requestKind,l=t.violations;return bi.__assign(bi.__assign({},r),(n={},n[s]=bi.__assign(bi.__assign({},r[s]),(a={},a[l.join(";")]=((u=(o=r[s])===null||o===void 0?void 0:o[l.join(";")])!==null&&u!==void 0?u:0)+1,a)),n))},failure:function(r,t){var n,a,o,u,s=t.failureKind,l=t.failureLevel;return bi.__assign(bi.__assign({},r),(n={},n[s]=bi.__assign(bi.__assign({},r[s]),(a={},a[l]=((u=(o=r[s])===null||o===void 0?void 0:o[l])!==null&&u!==void 0?u:0)+1,a)),n))}},KFe=function(){function e(){var r=this;this._threadId=HI,this.formatLogMessage=function(t,n){return Xm(r.threadId,t,n)}}return e.prototype.log=function(r,t){this.isMessageForAnotherLogger(t)||((0,aee.getTypedFeatureGate)("Microsoft.Office.Excel.EnableFullSessionLogging")||r.kind==="failure")&&rEr[r.kind](this.threadId,r.payload)},e.prototype.flush=function(){},e.prototype.flushBufferedMessages=function(){return[]},Object.defineProperty(e.prototype,"threadId",{get:function(){return this._threadId},set:function(t){this._threadId=t},enumerable:!1,configurable:!0}),e.prototype.isMessageForAnotherLogger=function(r){return(0,zI.isDefined)(r)&&r!==QI.Immediate},e}();Sv.ImmediateLogger=KFe;var aEr=function(){function e(){var r=this;this.loggingStates=bi.__assign({},tEr),this._threadId=HI,this.logMessageBuffer=[],this.formatLogMessage=function(t,n){return Xm(r.threadId,t,n)}}return e.prototype.log=function(r,t){this.isMessageForAnotherLogger(t)||(this.shouldBufferLogMessages()?((0,JRr.staticTypeHint)(r),this.logMessageBuffer.push([r,QI.Aggregating])):this.loggingStates[r.kind]=nEr[r.kind](this.loggingStates[r.kind],r.payload))},e.prototype.flush=function(){if(!this.shouldBufferLogMessages()){var r=this.loggingStates.computationStoppedExecution.requestDurationHistogramByComputationKind;this.loggingStates.computationStoppedExecution.requestDurationHistogramByComputationKind={};var t=this.formatLogMessage("AgggregationLogger.flush",{description:"summary logs for session",data:this.loggingStates}),n=this.formatLogMessage("AgggregationLogger.flush",{description:"request duration histogram by computation kind",data:r});if(Uh.ulsLogger.ULS.traceTag(512274703,pl.LogCategory.msoulscat_ES_EWAJS,pl.TraceLevel.Warning,t),eEr&&this.threadId===HI){var a=(0,ZRr.getTelemetryLogger)();a.sendTelemetryEvent((0,UN.createX10AggregatedTelemetryEvent)(t)),a.sendTelemetryEvent((0,UN.createX10RequestPerformanceEvent)(n))}}},e.prototype.flushBufferedMessages=function(){var r=this.logMessageBuffer;return this.logMessageBuffer=[],r},Object.defineProperty(e.prototype,"threadId",{get:function(){return this._threadId},set:function(t){this._threadId=t},enumerable:!1,configurable:!0}),e.prototype.shouldBufferLogMessages=function(){return $Rr&&this.threadId!==HI},e.prototype.isMessageForAnotherLogger=function(r){return(0,zI.isDefined)(r)&&r!==QI.Aggregating},e}(),VFe=function(){function e(){var r=this;this._threadId=HI,this.immediateLogger=new KFe,this.aggregatingLogger=new aEr,this.formatLogMessage=function(t,n){return Xm(r.threadId,t,n)}}return e.prototype.log=function(r,t){this.immediateLogger.log(r,t),this.aggregatingLogger.log(r,t)},e.prototype.flush=function(){this.immediateLogger.flush(),this.aggregatingLogger.flush()},e.prototype.flushBufferedMessages=function(){return bi.__spreadArray(bi.__spreadArray([],this.immediateLogger.flushBufferedMessages(),!0),this.aggregatingLogger.flushBufferedMessages(),!0)},Object.defineProperty(e.prototype,"threadId",{get:function(){return this._threadId},set:function(t){this._threadId=t,this.immediateLogger.threadId=t,this.aggregatingLogger.threadId=t},enumerable:!1,configurable:!0}),e}();Sv.CombinedLogger=VFe;Sv.x10Logger=new VFe});var R4=T(yv=>{"use strict";p();Object.defineProperty(yv,"__esModule",{value:!0});yv.PartialWorkbook=yv.EvalOnClonePropsFromPartialWBDocumentCollection=yv.EvalOnClonePropsFromPartialWB=yv.MaxStateIdDifferenceForGC=void 0;var VC=fe(),jFe=uv(),uee=uv(),iee=uv(),WFe=qi(),AS=qi(),Ci=No(),y4=_y(),iEr=Qf(),Lr=Ss(),UR=Ba(),_4=Zc(),XI=n_(),oEr=RR(),KN=Ar(),YI=b$(),uEr=pr(),HFe=Pf(),oee=PPe(),zFe=nl(),ei=APe(),KR=Us(),sEr=TF(),lEr=zn(),Pt=zn(),see=ks(),cEr=KPe(),b4=jI(),ZFe=GN(),lee=hc(),QFe=wR(),dEr=Hf(),fEr=Xp(),pEr=_R(),mEr=cx(),XFe=$A(),gEr=tF(),YFe=rF(),vEr=1,hEr=1e3,SEr=1,yEr=10,_Er=1e4,JFe=2*Ci.sheetCols;yv.MaxStateIdDifferenceForGC=17;var C4=(0,Ci.gridRange)(0,0,Ci.sheetRows,Ci.sheetCols);function T4(e,r){var t;return r.kind===uee.ReasonKind.Unavailable&&r.objects.length>0&&"kind"in r.objects[0]&&(t=r.objects[0].kind),(0,Pt.failure)({cell:e,kind:r.kind,innerKind:t})}var bEr=(0,see.binaryVisitor)(VC.__assign(VC.__assign({},(0,see.constVisitor)(!1)),{wsfNode:function(r){return r===iEr.WorksheetFuncId.HYPERLINK}}),function(e,r){return e||r}),FS;(function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetLangConfig="SetLangConfig"})(FS||(FS={}));var CEr=function(){function e(r,t){this.formatResults=t,this.resultsPromise=new ZFe.ResolvablePromise,this.stateId=-1,this.cloneLazy=new lee.ResettableLazy(function(){return r.createSnapshotSync()})}return e}();yv.EvalOnClonePropsFromPartialWB=CEr;var TEr=function(){function e(r,t){this.formatResults=t,this.resultsPromise=new ZFe.ResolvablePromise,this.stateId=-1,this.cloneLazy=new lee.ResettableLazy(function(){return r.clone(YI.voidCallback,XI.CloningTarget.Client)})}return e}();yv.EvalOnClonePropsFromPartialWBDocumentCollection=TEr;var zr;(function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalOnClone=6]="ComputeEvalOnClone",e[e.ComputeEvalFormula=7]="ComputeEvalFormula",e[e.RecalcFinished=8]="RecalcFinished",e[e.CompleteDataQuery=9]="CompleteDataQuery",e[e.MaybeCollectGarbage=10]="MaybeCollectGarbage",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"})(zr||(zr={}));var REr=function(){function e(r,t){t===void 0&&(t={});var n=this,a,o;this.scheduler=new ei.PriorityScheduler,this.englishParser=(0,mEr.createParser)((0,XFe.createParseGlobals)(QFe.initialRecalcServiceConfig)),this.englishAnalyzer=(0,gEr.createAnalyzer)((0,YFe.createAnalyzeGlobals)(QFe.initialRecalcServiceConfig)),this.outputMessageLog=[],this.stateId=-(1/0),this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.latestSnapshotID=-1,this.numPrecisionFailures=0,this.printFormulaProperties=function(u){var s=(0,AS.sheetGridRangeAnchor)(u),l=n.getAvailableFormula(s);if(!(0,Pt.isSuccess)(l))return void n.onUnavailableObject(l.reason);var c=l.value,d=c[0],f=c[1],m=f.compiledFmla.getValue(),v=(0,Pt.isSuccess)(m)?n.docs.printFormulaBarText(d,s.range,m.value):m,h=v.kind===Pt.ResultKind.Success?v.value:void n.outputMessageLog.push({kind:Lr.OutputMessageKind.PrintFormulaFailure,stateId:n.stateId,range:u,reason:v.reason});return{formulaBarText:h,hasHyperlink:n.formulaHasHyperlink(f),isFormula:!0}},this.printValueProperties=function(u,s){var l,c,d=n.docs.getEditedFormula(u);if(!(0,Pt.isSuccess)(d))return void n.onUnavailableObject(d.reason);var f=(c=(l=d.value)===null||l===void 0?void 0:l[1].fmla)!==null&&c!==void 0?c:"",m=n.docs.renderValueBarText(u,s,f),v=(0,Pt.isSuccess)(m)?m.value:void n.outputMessageLog.push({kind:Lr.OutputMessageKind.PrintFormulaFailure,stateId:n.stateId,range:u,reason:m.reason});return{formulaBarText:v,hasHyperlink:!1,isFormula:!1}},this.scheduleAvailableFormulas=function(u,s){var l=n.docs.forEachEditedNonBlankCellInSet(u.sheet,u.set,function(c){var d=(0,Ci.sheetGridCell)(u.sheet,c),f=n.docs.getEditedFormula(d);return f.kind===Pt.ResultKind.Failure?(n.onUnavailableObject(f.reason),!0):(f.value!==void 0&&f.value[1].compiledFmla!==void 0&&n.enqueueComputeCellValue(d,s),!0)});(0,Pt.isSuccess)(l)||n.onUnavailableObject(l.reason)},this.scheduleAvailableValues=function(u,s){var l=n.docs.forEachEditedCellInSet(u.sheet,u.set,function(c){var d=(0,Ci.sheetGridCell)(u.sheet,c),f=n.docs.getEditedFormula(d);return f.kind===Pt.ResultKind.Failure?(n.onUnavailableObject(f.reason),!0):((f.value===void 0||f.value[1].compiledFmla===void 0)&&n.enqueueReturnCellValue(d,s),!0)});(0,Pt.isSuccess)(l)||n.onUnavailableObject(l.reason)},this.docs=new YI.PartialWorkbookDocumentCollection(r,this,t,t,(a=t.maxDereferenceCells)!==null&&a!==void 0?a:JFe,(o=t.isServerWorkbookLoad)!==null&&o!==void 0?o:!1),this.reconfigure(t)}return e.prototype.reconfigure=function(r){var t,n;this.config=r,this.rng=new uEr.JSF32(r.rngSeed!==void 0?r.rngSeed:0),this.docs.reconfigure(r,r,(t=r.maxDereferenceCells)!==null&&t!==void 0?t:JFe,(n=r.isServerWorkbookLoad)!==null&&n!==void 0?n:!1)},e.prototype.getDocs=function(){return this.docs},e.prototype.setWorksheetFuncOverrides=function(r){this.docs.setWorksheetFuncOverrides(r)},e.prototype.onNameFailure=function(r,t,n){n.computeKind!==Lr.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:Lr.OutputMessageKind.NameFailure,stateId:this.stateId,name:r,reason:t})},e.prototype.onRangeFailure=function(r,t,n,a,o){o.computeKind!==Lr.ComputeKind.EvalFormula&&this.outputMessageLog.push({kind:Lr.OutputMessageKind.RangeFailure,stateId:this.stateId,cellKind:a,range:r,reason:t})},e.prototype.onNumberFormatFailure=function(r){this.outputMessageLog.push({kind:Lr.OutputMessageKind.NumberFormatFailure,stateId:this.stateId,reason:r})},e.prototype.onInferFormatFailure=function(r,t){this.outputMessageLog.push({kind:Lr.OutputMessageKind.InferFormatFailure,stateId:this.stateId,range:r,reason:t})},e.prototype.onUnavailableObject=function(r){var t=(0,AS.unavailable)([r]);this.onUnavailable(t)},e.prototype.onUnavailable=function(r){this.outputMessageLog.push({kind:Lr.OutputMessageKind.UnhandledFailure,stateId:this.stateId,reason:r})},e.prototype.onSetCellValue=function(r,t,n,a,o){if(o.computeKind!==Lr.ComputeKind.EvalFormula){var u=this.outputCell(r,t,a,this.printFormulaProperties);u!==void 0?(this.outputMessageLog.push({kind:Lr.OutputMessageKind.RecalcStatistics,message:Lr.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:a}),(a===Lr.ComputedCellKind.EditedCell||a===Lr.ComputedCellKind.DependentCell)&&this.outputMessageLog.push(VC.__assign(VC.__assign({kind:Lr.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:a,cell:r},u),{formatted:this.formatValue(a,r,t)}))):this.outputMessageLog.push({kind:Lr.OutputMessageKind.RecalcStatistics,message:Lr.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:a})}},e.prototype.onSetCellValues=function(r,t,n,a,o){var u=this;if(o.computeKind!==Lr.ComputeKind.EvalFormula){var s=this.outputRange(r,t,a);s!==void 0&&(a===Lr.ComputedCellKind.EditedCell||a===Lr.ComputedCellKind.DependentCell)&&this.outputMessageLog.push(VC.__assign(VC.__assign({kind:Lr.OutputMessageKind.RangeWrite,stateId:this.stateId,cellKind:a,range:r},s),{formatted:t.map(function(l,c){return l.map(function(d,f){return u.formatValue(a,(0,Ci.sheetGridCell)(r.sheet,(0,Ci.gridCell)(r.range.row+c,r.range.col+f)),d)})})}))}},e.prototype.onReturnCellValue=function(r,t,n){var a=this,o=this.outputCell(r,t,n,function(){return a.printValueProperties(r,t)});o!==void 0?(this.outputMessageLog.push({kind:Lr.OutputMessageKind.RecalcStatistics,message:Lr.RecalcStatisticsMessage.ChangedCell,stateId:this.stateId,cellKind:Lr.ComputedCellKind.EditedCell}),n===Lr.ComputedCellKind.EditedCell&&this.outputMessageLog.push(VC.__assign(VC.__assign({kind:Lr.OutputMessageKind.CellWrite,stateId:this.stateId,cellKind:Lr.ComputedCellKind.EditedCell,cell:r},o),{formatted:this.formatValue(n,r,t)}))):this.outputMessageLog.push({kind:Lr.OutputMessageKind.RecalcStatistics,message:Lr.RecalcStatisticsMessage.UnchangedCell,stateId:this.stateId,cellKind:Lr.ComputedCellKind.EditedCell})},e.prototype.createSnapshot=function(r,t){var n=this;return t===void 0&&(t=XI.CloningTarget.Client),new Promise(function(a){n.scheduler.addTask(zr.CompleteDataQuery,ei.QueuePos.Back,{onRun:function(){var u=!1,s=n.docs.clone(YI.voidCallback,t);(n.latestSnapshot===void 0||n.latestSnapshotID===-1||!n.latestSnapshot.compareVersion(s))&&(u=!0,n.latestSnapshot=s,n.latestSnapshotID=r),fEr.x10Logger.log({kind:"snapshotCreation",payload:u}),a({snapshot:n.latestSnapshot,correspondingId:n.latestSnapshotID})},onDeleted:function(){a(void 0)}})})},e.prototype.createSnapshotSync=function(r){return r===void 0&&(r=XI.CloningTarget.Client),this.docs.clone(YI.voidCallback,r)},e.prototype.outputCell=function(r,t,n,a){var o;if(n===Lr.ComputedCellKind.EditedCell||n===Lr.ComputedCellKind.DependentCell){var u=this.docs.testAndSetClientValue(r,t);o=(0,Pt.isSuccess)(u)?u.value?t:void 0:void this.onUnavailableObject(u.reason)}var s=this.outputFormat(r,n),l=this.outputFormulaProperties(r,n,a);return o!==void 0||s!==void 0||l!==void 0?{value:t,format:s,formulaBarText:l==null?void 0:l.formulaBarText,hasHyperlink:l==null?void 0:l.hasHyperlink}:void 0},e.prototype.outputRange=function(r,t,n){var a=this;if(n===Lr.ComputedCellKind.EditedCell||n===Lr.ComputedCellKind.DependentCell){var o=this.docs.setClientValue(r,t);(0,Pt.isSuccess)(o)||this.onUnavailableObject(o.reason)}var u=t.map(function(l,c){return l.map(function(d,f){return a.outputFormat((0,Ci.sheetGridCell)(r.sheet,(0,Ci.gridCell)(r.range.row+c,r.range.col+f)),n)})}),s=this.outputFormulaProperties(r,n,this.printFormulaProperties);return{values:t,formats:u,formulaBarText:s==null?void 0:s.formulaBarText}},e.prototype.outputFormat=function(r,t){if(t===Lr.ComputedCellKind.EditedCell){var n=this.docs.getEditedFormat(r);if(!(0,Pt.isSuccess)(n))return void this.onUnavailableObject(n.reason);var a=this.docs.testAndSetClientFormat(r,n.value);if(!(0,Pt.isSuccess)(a))return void this.onUnavailableObject(a.reason);if(a.value){var o=n.value;if(o===Lr.SpecialFormat.Unavailable)return{format:(0,AS.unavailable)([{kind:Lr.UnavailableKind.CellFormat}]),valueType:KR.FormatValueType.Custom,decimals:0};var u=this.docs.resolveCellFormat(r.sheet.document,o);if((0,Pt.isSuccess)(u))return{format:typeof o=="number"?o:o.formatString,valueType:u.value.valueType,decimals:u.value.decimals}}}},e.prototype.outputFormulaProperties=function(r,t,n){if(t===Lr.ComputedCellKind.EditedCell){var a=n(r);if(a!==void 0){var o=a.formulaBarText,u=a.hasHyperlink,s=a.isFormula,l=this.docs.testAndSetClientFormula(r,o,u);if(!(0,Pt.isSuccess)(l))return void this.onUnavailableObject(l.reason);var c=l.value,d=c.hasFmlaChanged,f=c.hasHyperlinkChanged;return d||f?{formulaBarText:d?o:void 0,hasHyperlink:f?u:void 0,isFormula:s}:void 0}}},e.prototype.formatValue=function(r,t,n,a){var o=a??this.docs,u=o.formatValueCell(t,n);if(!(0,Pt.isSuccess)(u)){o===this.docs&&this.outputMessageLog.push({kind:Lr.OutputMessageKind.FormatValueFailure,stateId:this.stateId,cellKind:r,range:t,reason:u.reason});return}return u.value},e.prototype.getAvailableFormula=function(r){var t=this.docs.getEditedFormula(r);if(!(0,Pt.isSuccess)(t))return t;if(t.value===void 0)return(0,Pt.failure)({kind:Lr.UnavailableKind.CellMissingFormula});var n=t.value,a=n[0],o=n[1];if(o.compiledFmla===void 0)return(0,Pt.failure)({kind:Lr.UnavailableKind.CellEvaluatingValue});var u=(0,Ci.lexicalSourceGrid)(o.lexicalKind,(0,Ci.sheetGridRange)(r.sheet,a));return(0,Pt.success)([u,o])},e.prototype.formulaHasHyperlink=function(r){if(r.lexicalKind!==Ci.LexicalKind.Cell)return!1;var t=r==null?void 0:r.compiledFmla.getValue();if((0,Pt.isSuccess)(t))return(0,see.reduceBottomUp)(bEr,t.value)},e.prototype.handleSetCellContents=function(r,t,n,a,o,u,s,l,c,d,f){var m,v,h,y=c!==void 0?(0,AS.unavailable)([{kind:Lr.UnavailableKind.ClientFailure,reason:c}]):void 0,_=s,E;a!==void 0?(v=a,(0,UR.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",o!==void 0),h=o):n===void 0?((0,UR.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!r&&o===void 0&&s!==void 0&&y===void 0),v=!1,h=void 0):((0,UR.assertTrue)("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!r&&y===void 0&&_===Lr.SpecialFormat.Weak),m=this.parseInferredEdit(t,n,u,y,_,f),v=m.isFormula,h=m.oper,y=m.cellFailure,_=m.cellFormat,E=m.inferredFormat);var N=f!==void 0?f.cloneLazy.getValue():this.docs,k=N.setCellContents(r,t,n,v,u,h,y,_,l,d);if(k.kind===Pt.ResultKind.Failure)return this.onUnavailableObject(k.reason);if(N.onCellModified(r),!r){var q=(0,Ci.sheetGridCell)(t.sheet,u),V=n===void 0?(0,Pt.success)(void 0):v?N.inferFormulaFormat(q):E!==void 0&&E!==sEr.KnownFormat.General?N.resolveValueFormat(t.sheet.document,E):(0,Pt.success)(void 0);V.kind!==Pt.ResultKind.Success&&(this.onInferFormatFailure(q,V.reason),V=(0,Pt.success)(Lr.SpecialFormat.Unavailable)),V.value!==void 0&&N.fillInferredFormat(t,V.value),f!==void 0?(f.stateId=this.stateId,this.enqueueEvalFormulaComputeCellValuesOnDocs(t,N,f)):this.enqueueBeforeCompute(d)}},e.prototype.parseInferredEdit=function(r,t,n,a,o,u){var s=u?u.cloneLazy.getValue().parseInferredEdit((0,Ci.sheetGridCell)(r.sheet,n),t,this.getVolatileMode()):this.docs.parseInferredEdit((0,Ci.sheetGridCell)(r.sheet,n),t,this.getVolatileMode());if(!(0,Pt.isSuccess)(s))return{isFormula:!1,oper:y4.blankOper,cellFailure:s.reason,cellFormat:Lr.SpecialFormat.Unavailable};var l=t.length>0?t.charAt(0):"";switch((l==="="||l==="+"||l==="-")&&(s.value.kind===KR.EditKind.Formula||s.value.kind===KR.EditKind.Number)&&UR.ulsLogger.ULS.dnmTraceTag(541189698,zFe.LogCategory.msoulscat_ES_EWAJS,zFe.TraceLevel.Info,JSON.stringify({startChar:l,editKind:String(s.value.kind)})),s.value.kind){case KR.EditKind.Formula:return{isFormula:!0,oper:y4.blankOper,cellFailure:a,cellFormat:o};case KR.EditKind.String:case KR.EditKind.Other:return{isFormula:!1,oper:s.value.value,cellFailure:a,cellFormat:o};case KR.EditKind.Number:return{isFormula:!1,oper:s.value.value,cellFailure:a,cellFormat:o,inferredFormat:s.value.format}}},e.prototype.handleSetRangeFormula=function(r,t,n,a,o){var u=(0,oEr.isFormulaText)(n);(0,UR.assertTrue)("calc.calc.PartialWorkbook: handleSetRangeFormula",n===""&&!r||u);var s=r?void 0:y4.blankOper,l=r?void 0:Lr.SpecialFormat.Weak,c=r?void 0:Lr.SpecialStyle.Weak,d=this.docs.setRangeFormula(r,t,n,a,s,l,c,o);if(d.kind===Pt.ResultKind.Failure)return this.onUnavailableObject(d.reason);this.docs.onCellModified(r),r||this.enqueueBeforeCompute(o)},e.prototype.handleEditPaste=function(r,t,n,a){var o=(0,Ci.sheetGridRange)(t.sheet,(0,Ci.gridRange)(t.range.row,t.range.col,n.range.rows,n.range.cols)),u=!1,s=this.docs.copyRange(n);if(s.kind===Pt.ResultKind.Failure)return this.onUnavailableObject(s.reason);var l=this.docs.pasteRange(o,s.value);if(l.kind===Pt.ResultKind.Failure)return this.onUnavailableObject(l.reason);this.docs.onCellModified(u),this.enqueueBeforeCompute(a)},e.prototype.handleAssumeRecalcFinal=function(r){var t=this;this.scheduler.getCount(zr.BeforeCompute)<0||this.scheduler.addTask(zr.ComputeCellValue,ei.QueuePos.Front,function(){var n=t.docs.assumeRecalcFinal(r);if(n.kind===Pt.ResultKind.Failure)return t.onUnavailableObject(n.reason)})},e.prototype.evalFormula=function(r,t,n,a,o){var u=this;return new Promise(function(s){var l=function(){return s({value:(0,Pt.failure)(iee.stopped)})};u.scheduler.deleteTasks(zr.EvalFormula,void 0),u.scheduler.addTask(zr.EvalFormula,ei.QueuePos.Back,{onRun:function(){if(!o&&!u.trySetStateId(zr.EvalFormula,r))return l();u.enqueueComputeEvalFormula(t,n,a,o,s)},onDeleted:l}),u.enqueueRecalcFinished()})},e.prototype.enqueueBeforeCompute=function(r){var t=this;this.scheduler.deleteTasks(zr.BeforeCompute,void 0),this.scheduler.addTask(zr.BeforeCompute,ei.QueuePos.Back,function(){t.enqueueAfterCompute(),t.restrictToViewport(t.docs.getNonDirtyEditedCells(),r,Lr.ComputeKind.EditedCell,t.scheduleAvailableValues),t.restrictToViewport(t.docs.getDirtyEditedCells(),r,Lr.ComputeKind.EditedCell,t.scheduleAvailableFormulas),t.restrictToViewport(t.docs.getDirtyDependentCells(),r,Lr.ComputeKind.DependentCell,t.scheduleAvailableFormulas)})},e.prototype.withEvalTiming=function(r){var t=this.docs.schedulerConfig.totalTimeMs;if(t===void 0)return r();var n=(0,KN.now)(),a;try{a=r()}finally{this.stateEvalTime+=(0,KN.fastMax)(vEr,(0,KN.now)()-n),this.stateEvalTime>=t&&(this.deleteComputeTasks(FS.EvalTimedOut),this.outputMessageLog.push({kind:Lr.OutputMessageKind.RecalcStatistics,stateId:this.stateId,message:Lr.RecalcStatisticsMessage.StateTimedOut}),a=[])}return a},e.prototype.enqueueEvalFormulaComputeCellValuesOnDocs=function(r,t,n){var a=this,o=[];(0,_4.forEachCellInSet)(r.set,function(d){return o.push((0,Ci.sheetGridCell)(r.sheet,d)),!0});var u=(0,pEr.makeGridRangeTable)(),s=function(f,m,v){!(0,AS.isSheetIndexEqual)(f.sheet,r.sheet)||!(0,HFe.meetsProduct)(r.set,(0,_4.createCellSetFromRange)(f.range))||(0,WFe.forEachCellInRange)(f.range,function(h){return u=u.setValue(h,m),!0})},l=function(){return t.evaluate(Lr.ComputeKind.EvalFormula,o,a.getVolatileMode(),s)},c={onRun:function(){var f=a.withEvalTiming(l);if(Array.isArray(f)){var m=f.map(function(v,h){var y,_=o[h].range;if(!(0,Pt.isSuccess)(v)){if(v.reason.kind===uee.ReasonKind.Stopped)return T4(_,v.reason);var E=(0,AS.unavailable)([{kind:Lr.UnavailableKind.EvalFailure,reason:v.reason}]);return a.onUnavailable(E),T4(_,E)}var N=t.getCellValue(o[h]);if(!(0,Pt.isSuccess)(N)){var k=(y=u.getValue(_))!==null&&y!==void 0?y:N.reason;return T4(_,k)}try{(0,UR.assertTrue)("calc.calc.PartialWorkbook: FinalValue after evalCell",N.value.kind===jFe.CellKind.FinalValue)}catch(I){var E=(0,AS.unavailable)([{kind:Lr.UnavailableKind.EvalFailure,reason:(0,lEr.javaScriptError)(I)}]);return a.onUnavailable(E),T4(_,E)}var q=N.value.oper;if(n.formatResults===!0){var V=a.formatValue(Lr.ComputedCellKind.EditedCell,o[h],q,t);return(0,Pt.success)({cell:_,value:q,formatted:V})}return n.formatResults===!1?(0,Pt.success)({cell:_,value:q,formatted:void 0}):(0,Pt.success)((0,KN.pair)(o[h].range,q))});n.resultsPromise.resolve({stateId:n.stateId,results:m});return}l=f.resume,a.scheduler.addTask(zr.ComputeEvalOnClone,ei.QueuePos.Front,c)},onDeleted:function(){return n.resultsPromise.resolve({stateId:n.stateId,results:(0,dEr.arrayFill)(new Array(o.length),(0,Pt.failure)(iee.stopped))})}};this.scheduler.addTask(zr.ComputeEvalOnClone,ei.QueuePos.Front,c)},e.prototype.enqueueComputeCellValue=function(r,t){var n=this,a=t===Lr.ComputeKind.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?(0,oee.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc edited"):void 0,o=!0,u,s=function(){return n.docs.evaluate(t,[r],n.getVolatileMode())},l=function c(){if(o){o=!1,u=n.shouldSample(n.config.sampleCellEvalStopwatchRate)?(0,oee.ulsStopwatchFactory)("calc.calc.PartialWorkbook: cell eval"):void 0;var d=n.docs.getEditedFormula(r);if(!(0,Pt.isSuccess)(d))return n.onUnavailableObject(d.reason);if(d.value===void 0)return}else n.outputMessageLog.push({kind:Lr.OutputMessageKind.RecalcStatistics,stateId:n.stateId,message:Lr.RecalcStatisticsMessage.ContinueComputation});var f=n.withEvalTiming(s);if(Array.isArray(f)){u==null||u.stop(),a==null||a.stop();for(var m=0,v=f;m<v.length;m++){var h=v[m];!(0,Pt.isSuccess)(h)&&h.reason.kind!==uee.ReasonKind.Stopped&&n.onUnavailableObject({kind:Lr.UnavailableKind.EvalFailure,reason:h.reason})}return}s=f.resume,n.scheduler.addTask(zr.ComputeCellValue,ei.QueuePos.Front,c)};this.scheduler.addTask(zr.ComputeCellValue,ei.QueuePos.Back,l)},e.prototype.enqueueComputeEvalFormula=function(r,t,n,a,o){var u=this;a===void 0&&(a=this.docs);var s=this.getVolatileMode(),l=function(){return a.evalFormula(r,t,n,s)},c={onRun:function(){var f=l();if(f.kind!==Pt.ResultKind.Paused&&f.kind!==Pt.ResultKind.Breaked){o(f.value);return}l=f.resume,u.scheduler.addTask(zr.ComputeEvalFormula,ei.QueuePos.Front,c)},onDeleted:function(){return o({value:(0,Pt.failure)(iee.stopped)})}};this.scheduler.addTask(zr.ComputeEvalFormula,ei.QueuePos.Back,c)},e.prototype.enqueueReturnCellValue=function(r,t){var n=this,a=this.getVolatileMode();this.scheduler.addTask(zr.ComputeCellValue,ei.QueuePos.Back,function(){n.docs.evalValue(r,t,a)})},e.prototype.enqueueAfterCompute=function(){var r=this;this.scheduler.deleteTasks(zr.AfterCompute,FS.EditReceived);var t=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?(0,oee.ulsStopwatchFactory)("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(zr.AfterCompute,ei.QueuePos.Back,{onRun:function(){t==null||t.stop(FS.EvalFinished),r.outputMessageLog.push({kind:Lr.OutputMessageKind.RecalcStatistics,message:Lr.RecalcStatisticsMessage.EditFinished,stateId:r.stateId})},onDeleted:function(a){t==null||t.stop(a)}})},e.prototype.enqueueRecalcFinished=function(){var r=this;this.scheduler.deleteTasks(zr.RecalcFinished,void 0),this.scheduler.addTask(zr.RecalcFinished,ei.QueuePos.Back,function(){r.outputMessageLog.push({kind:Lr.OutputMessageKind.RecalcStatistics,message:Lr.RecalcStatisticsMessage.RecalcFinished,stateId:r.stateId})})},e.prototype.promoteCellContents=function(r,t,n,a){var o=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){if(o.trySetStateId(zr.ServerUpdate,r)){var u=o.docs.promoteServerAvailability(n,a);if(u.kind===Pt.ResultKind.Failure)return o.onUnavailableObject(u.reason);o.docs.onCellModified(!0),u.value||o.outputMessageLog.push({kind:Lr.OutputMessageKind.UpdateRequest,stateId:o.stateId,range:t})}})},e.prototype.writeCellContents=function(r,t,n,a,o,u,s,l,c,d){var f=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){!d&&!f.trySetStateId(zr.ServerUpdate,r)||f.handleSetCellContents(!0,t,n,a,u,o,s,l,c,void 0,d)})},e.prototype.editCellContents=function(r,t,n,a,o,u,s,l){var c=this;u===void 0&&(u=y4.blankOper),s===void 0&&(s=(0,Ci.sheetGridRange)(t.sheet,C4)),this.lastViewport=s,this.scheduler.addTask(zr.ClientEdit,ei.QueuePos.Back,function(){c.trySetStateId(zr.ClientEdit,r)&&c.handleSetCellContents(!1,t,n,a,u,o,Lr.SpecialFormat.Weak,Lr.SpecialStyle.Weak,void 0,s,l)}),this.enqueueRecalcFinished()},e.prototype.editCellContentsOnClone=function(r,t,n,a,o){this.editCellContents(this.stateId,r,t,n,a,void 0,void 0,o)},e.prototype.editCellFormats=function(r,t,n,a,o){var u=this;o===void 0&&(o=(0,Ci.sheetGridRange)(t.sheet,C4)),this.lastViewport=o,this.scheduler.addTask(zr.ClientEdit,ei.QueuePos.Back,function(){if(u.trySetStateId(zr.ClientEdit,r)){var s=n.kind==="SetFormat"?u.docs.resolveEditFormat(t.sheet.document,n.format):n.kind==="RibbonFormat"?u.docs.resolveRibbonFormat(t.sheet.document,n.ribbon,(0,Ci.sheetGridCell)(t.sheet,a)):n.kind==="ChangeDecimals"?u.docs.resolveChangeDecimals(t.sheet.document,n.changeDecimals,(0,Ci.sheetGridCell)(t.sheet,a)):(0,UR.assertNever)("calc.calc.PartialWorkbook: editCellFormats",n);(0,Pt.isSuccess)(s)||(0,_4.forEachRangeInSet)(t.set,function(l){return u.onInferFormatFailure((0,Ci.sheetGridRange)(t.sheet,l),s.reason),!0}),!((0,Pt.isSuccess)(s)&&s.value===void 0)&&u.handleSetCellContents(!1,t,void 0,void 0,void 0,(0,Ci.gridCell)(0,0),(0,Pt.isSuccess)(s)?s.value:Lr.SpecialFormat.Unavailable,void 0,void 0,o)}}),this.enqueueRecalcFinished()},e.prototype.writeArrayFormula=function(r,t,n,a,o){var u=this;a===void 0&&(a=(0,AS.gridRangeAnchor)(t.range)),o===void 0&&(o=!1),this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){u.trySetStateId(zr.ServerUpdate,r)&&u.handleSetRangeFormula(!0,t,n,a,void 0)})},e.prototype.editArrayFormula=function(r,t,n,a,o){var u=this;a===void 0&&(a=(0,AS.gridRangeAnchor)(t.range)),o===void 0&&(o=(0,Ci.sheetGridRange)(t.sheet,C4)),this.lastViewport=o,this.scheduler.addTask(zr.ClientEdit,ei.QueuePos.Back,function(){u.trySetStateId(zr.ClientEdit,r)&&u.handleSetRangeFormula(!1,t,n,a,o)}),this.enqueueRecalcFinished()},e.prototype.editPaste=function(r,t,n,a,o){var u=this;o===void 0&&(o=(0,Ci.sheetGridRange)(n.sheet,C4)),this.scheduler.addTask(zr.ClientEdit,ei.QueuePos.Back,function(){u.trySetStateId(zr.ClientEdit,r)&&u.handleEditPaste(t,n,a,o)}),this.enqueueRecalcFinished()},e.prototype.assumeRecalcFinal=function(r,t){var n=this;this.scheduler.addTask(zr.ClientEdit,ei.QueuePos.Back,function(){n.stateId===r&&n.handleAssumeRecalcFinal(t)})},e.prototype.testAdvanceState=function(r){var t=this;this.scheduler.addTask(zr.TestAdvanceState,ei.QueuePos.Back,function(){t.trySetStateId(zr.TestAdvanceState,r)})},e.prototype.step=function(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};var r=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:r}},e.prototype.trySetStateId=function(r,t){var n=this,a,o,u,s,l;if(t<this.stateId)return!1;if(r===zr.ClientEdit&&(this.deleteComputeTasks(FS.EditReceived),this.stateEvalTime=0),t>this.stateId){if(this.stateId!==-(1/0)){var c=this.config.sampleWorkbookStatisticsRate;c!==void 0&&this.shouldSample(c)&&this.outputMessageLog.push({kind:Lr.OutputMessageKind.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:c})}var d=1;this.stateChanges===d&&this.enqueueRunExperiments(b4.ExperimentKind.OneShot),this.stateChanges>=d&&this.scheduler.getCount(zr.RunExperiment)===0&&this.enqueueRunExperiments(b4.ExperimentKind.Recurring);var f=(a=this.config.samplePrecisionEvalRate)!==null&&a!==void 0?a:0,m=(o=this.config.samplePrecisionPrintFormulaRate)!==null&&o!==void 0?o:0,v=(u=this.config.samplePrecisionPrintValueRate)!==null&&u!==void 0?u:0;if(this.stateChanges>=d&&(f>0||m>0||v>0)&&this.numPrecisionFailures<e.maxPrecisionFailures&&this.scheduler.getCount(zr.RunExperiment)===0){var h=this.config.experimentFactories,y=(s=h==null?void 0:h.stepBudget)!==null&&s!==void 0?s:yEr,_=(l=h==null?void 0:h.totalBudget)!==null&&l!==void 0?l:_Er,E=new cEr.PrecisionExperiment({samplePrecisionEvalRate:f,samplePrecisionPrintFormulaRate:m,samplePrecisionPrintValueRate:v}),N={stateId:this.stateId,documents:this.docs.clone(E),stepBudget:y,totalBudget:_,viewport:this.lastViewport};E.setContext(N),this.enqueueRunExperiment("PrecisionExperiment",y,_,b4.ExperimentKind.Precision,E,function(){return n.numPrecisionFailures=0},function(){return n.numPrecisionFailures+=1})}this.deleteComputeTasks(FS.StateIdAdvanced),this.lastViewport=void 0;var k=this.stateId;this.stateId=t,this.docs.advanceState(k),this.outputMessageLog.push({kind:Lr.OutputMessageKind.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0},e.prototype.deleteComputeTasks=function(r){this.scheduler.deleteTasks(zr.BeforeCompute,void 0),this.scheduler.deleteTasks(zr.ComputeCellValue,void 0),this.scheduler.deleteTasks(zr.AfterCompute,r),r!==FS.EvalTimedOut&&this.scheduler.deleteTasks(zr.ComputeEvalFormula,void 0)},e.prototype.enqueueRunExperiment=function(r,t,n,a,o,u,s){var l=this,c=0,d=0,f=function(h,y,_,E){var N=o.failedLogMessage;N!==void 0&&l.outputMessageLog.push({experimentName:r,kind:Lr.OutputMessageKind.ExperimentRunResult,experimentKind:a,logMessage:N,timeoutReason:{budgetType:h,budget:y,elapsedTime:_,stepsCount:E}})},m=function v(){if(o.done){var h=o.resultLogMessage;h!==void 0&&l.outputMessageLog.push({experimentName:r,kind:Lr.OutputMessageKind.ExperimentRunResult,experimentKind:a,logMessage:h}),u();return}for(var y=(0,KN.now)(),_=y,E=0;E<hEr&&_===y;E+=1){o.step(),d+=1;var N=(0,KN.now)(),k=N-_;if(k>=t&&!o.done){f("stepBudget",t,k,d),s();return}_=N}if(c+=_>y?_-y:SEr,c>=n&&!o.done){f("totalBudget",n,c,d),s();return}l.scheduler.addTask(zr.RunExperiment,ei.QueuePos.Front,v)};this.scheduler.addTask(zr.RunExperiment,ei.QueuePos.Back,m)},e.prototype.enqueueRunExperiments=function(r){var t;if(this.config.experimentFactories){var n=this.config.experimentFactories,a=n.stepBudget,o=n.totalBudget,u=n.factories,s=u.filter(function(h){var y,_;return h.kind===r&&((y=h.numFailures)!==null&&y!==void 0?y:0)<((_=h.maxFailures)!==null&&_!==void 0?_:3)});if(s.length!==0)for(var l={stateId:this.stateId,documents:this.docs.clone(YI.voidCallback,r===b4.ExperimentKind.OneShot?XI.CloningTarget.Server:XI.CloningTarget.Client),stepBudget:a,totalBudget:o,viewport:this.lastViewport},c=function(y){var _=y.create();if(!_)return"continue";_.setContext(l),d.enqueueRunExperiment(y.experimentName,(t=y.stepBudget)!==null&&t!==void 0?t:a,o,r,_,function(){return y.numFailures=0},function(){var E;return y.numFailures=((E=y.numFailures)!==null&&E!==void 0?E:0)+1})},d=this,f=0,m=s;f<m.length;f++){var v=m[f];c(v)}}},e.prototype.setSheetNames=function(r,t,n){var a=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){if(a.trySetStateId(zr.ServerUpdate,n)){var o=a.docs.setSheetNames(r,t);o.kind===Pt.ResultKind.Failure&&a.onUnavailableObject(o.reason),a.deleteComputeTasks(FS.SetSheetNames)}})},e.prototype.setLangConfig=function(r,t){var n=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){if(n.trySetStateId(zr.ServerUpdate,r)){var a=n.docs.config.localeInfo!==t.localeInfo,o=n.docs.config.refStyle!==t.refStyle;n.docs.setConfig(t),a&&n.docs.clearCompiledNumberFormats(),(a||o)&&(n.docs.clearCompiledFormulas(),n.deleteComputeTasks(FS.SetLangConfig))}})},e.prototype.setNumberFormats=function(r,t,n,a){var o=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){if(o.trySetStateId(zr.ServerUpdate,a)){var u=o.docs.setNumberFormats(r,t,n);if(u.kind===Pt.ResultKind.Failure)return o.onUnavailable(u.reason)}})},e.prototype.writeNamedObject=function(r,t,n,a){var o=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){if(o.trySetStateId(zr.ServerUpdate,r)){var u=o.docs.setNamedObject(!0,(0,Ci.nameLoc)(t,n),a);if(u.kind===Pt.ResultKind.Failure)return o.onUnavailable(u.reason)}})},e.prototype.writeUndefinedNames=function(r,t){var n=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){if(n.trySetStateId(zr.ServerUpdate,r)){var a=n.docs.setUndefinedNames(t);if(a.kind===Pt.ResultKind.Failure)return n.onUnavailable(a.reason)}})},e.prototype.promoteNamedObjects=function(r,t,n){var a=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){if(a.trySetStateId(zr.ServerUpdate,r)){var o=a.docs.promoteNamedObjects(t,n);if(o.kind===Pt.ResultKind.Failure)return a.onUnavailable(o.reason);o.value||a.outputMessageLog.push({kind:Lr.OutputMessageKind.UpdateNamesRequest,stateId:a.stateId,scope:t})}})},e.prototype.extendUnusedRange=function(r,t){var n=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){if(n.trySetStateId(zr.ServerUpdate,t)){var a=n.docs.extendServerUnused(r.sheet,r.range);if(a.kind===Pt.ResultKind.Failure)return n.onUnavailableObject(a.reason);n.docs.onCellModified(!0)}})},e.prototype.writeHiddenRows=function(r,t){var n=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){if(n.trySetStateId(zr.ServerUpdate,r)){var a=n.docs.writeHiddenRows(t.sheet,t.range,t.hidden);if(a.kind===Pt.ResultKind.Failure)return n.onUnavailableObject(a.reason)}})},e.prototype.writeHiddenCols=function(r,t){var n=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){if(n.trySetStateId(zr.ServerUpdate,r)){var a=n.docs.writeHiddenCols(t.sheet,t.range,t.hidden);if(a.kind===Pt.ResultKind.Failure)return n.onUnavailableObject(a.reason)}})},e.prototype.writeInFilterMode=function(r,t){var n=this;this.scheduler.addTask(zr.ServerUpdate,ei.QueuePos.Back,function(){if(n.trySetStateId(zr.ServerUpdate,r)){var a=n.docs.writeInFilterMode(t.sheet,t.inFilterMode);if(a.kind===Pt.ResultKind.Failure)return n.onUnavailableObject(a.reason)}})},e.prototype.getStatistics=function(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.enqueueMaybeCollectGarbage=function(){var r=this;this.scheduler.deleteTasks(zr.MaybeCollectGarbage,void 0),this.scheduler.addTask(zr.MaybeCollectGarbage,ei.QueuePos.Back,function(){if(!(r.stateChangesSinceLastGC<yv.MaxStateIdDifferenceForGC)){var t=r.stateId-yv.MaxStateIdDifferenceForGC;r.docs.collectGarbage(t),r.outputMessageLog.push({kind:Lr.OutputMessageKind.GarbageCollected,minStateIdKept:t}),r.stateChangesSinceLastGC=0}})},e.prototype.shouldSample=function(r){return r!==void 0&&this.rng.next()<=r},e.prototype.translateEnglishFormula=function(r,t){var n=this.englishParser.parseFormula((0,XFe.parseLocals)(Ci.LexicalKind.Cell,t.range),r);if(!(0,Pt.isSuccess)(n))return n;var a=this.englishAnalyzer.checkFormula((0,YFe.analyzeLocalsGrid)(Ci.LexicalKind.Cell,(0,Ci.sheetGridCell)(t.sheet,t.range)),n.value);if(!(0,Pt.isSuccess)(a))return a;if(!(0,WFe.isWellFormed)(a.value))return(0,Pt.failure)((0,jFe.illFormedFormula)("ill-formed formula"));var o=this.docs.printFormulaBarText((0,Ci.lexicalSourceGrid)(Ci.LexicalKind.Cell,t),t.range,a.value);return(0,Pt.isSuccess)(o)?(0,Pt.success)(o.value):o},e.prototype.restrictToViewport=function(r,t,n,a){if(t!==void 0)for(var o=t.sheet,u=t.range,s=(0,_4.createCellSetFromRange)(u),l=0,c=r;l<c.length;l++){var d=c[l];(0,AS.isSheetIndexEqual)(o,d.sheet)&&a((0,Lr.sheetCellSet)(o,(0,HFe.intersectProduct)(d.set,s)),n)}else for(var f=0,m=r;f<m.length;f++){var d=m[f];a(d,n)}},e.prototype.getVolatileMode=function(){var r;return(r=this.config.volatileMode)!==null&&r!==void 0?r:lee.VolatileMode.Estimation},e.maxPrecisionFailures=3,e}();yv.PartialWorkbook=REr});var dee=T(jC=>{"use strict";p();Object.defineProperty(jC,"__esModule",{value:!0});jC.delayPromiseImpl=jC.asyncLoopFactory=jC.asyncLoop=void 0;var cee=pr();jC.asyncLoop=cee.asyncLoopModule.asyncLoop;jC.asyncLoopFactory=cee.asyncLoopModule.asyncLoopFactory;jC.delayPromiseImpl=cee.asyncLoopModule.delayPromiseImpl});var jR=T(Nf=>{"use strict";p();Object.defineProperty(Nf,"__esModule",{value:!0});Nf.promiseLoop=Nf.promiseFinally=Nf.newPromise=Nf.isThenable=Nf.collapseThenable=Nf.bindMaybeThenable=Nf.MaybeThenable=void 0;var VR=pr();Nf.MaybeThenable=VR.promise.MaybeThenable;Nf.bindMaybeThenable=VR.promise.bindMaybeThenable;Nf.collapseThenable=VR.promise.collapseThenable;Nf.isThenable=VR.promise.isThenable;Nf.newPromise=VR.promise.newPromise;Nf.promiseFinally=VR.promise.promiseFinally;Nf.promiseLoop=VR.promise.promiseLoop});var eNe=T(P4=>{"use strict";p();Object.defineProperty(P4,"__esModule",{value:!0});P4.computeUnavailableCellsStats=void 0;var EEr=Ss(),fee=Zc(),$Fe=qi(),E4=Pf(),pee=Ar(),p_=Mh();function PEr(e){for(var r,t,n,a,o,u,s,l=(0,pee.makeStringMap)(),c=(0,pee.makeStringMap)(),d=0,f=e;d<f.length;d++){var m=f[d],v=m.range;if(m.reason.kind===$Fe.LangReasonKind.Unavailable)for(var h=0,y=m.reason.objects;h<y.length;h++){var _=y[h];_.kind===EEr.UnavailableKind.GridRange&&((0,$Fe.isSheetIndexEqual)(_.range.sheet,v.sheet)?l[_.range.sheet.index]=(0,E4.unionProduct)((r=l[_.range.sheet.index])!==null&&r!==void 0?r:p_.empty,_.unavailableCells!==!0?_.unavailableCells:p_.empty):c[_.range.sheet.index]=(0,E4.unionProduct)((t=c[_.range.sheet.index])!==null&&t!==void 0?t:p_.empty,_.unavailableCells!==!0?_.unavailableCells:p_.empty))}}var E=0,N=0,k=0,q=(0,pee.makeStringMap)();for(var V in l){var I=(n=l[V])!==null&&n!==void 0?n:p_.empty;q[V]=(0,E4.unionProduct)((a=q[V])!==null&&a!==void 0?a:p_.empty,I),(0,fee.forEachRangeInSet)(I,function(B){return E+=B.rows*B.cols,!0})}for(var V in c){var I=(o=c[V])!==null&&o!==void 0?o:p_.empty;q[V]=(0,E4.unionProduct)((u=q[V])!==null&&u!==void 0?u:p_.empty,I),(0,fee.forEachRangeInSet)(I,function(j){return N+=j.rows*j.cols,!0})}for(var V in q){var I=(s=q[V])!==null&&s!==void 0?s:p_.empty;(0,fee.forEachRangeInSet)(I,function(j){return k+=j.rows*j.cols,!0})}var M={numOfUnavailableCellsInTheSameSheet:E,numOfUnavailableCellsInDifferentSheet:N,totalNumOfUnavailableCells:k};return M}P4.computeUnavailableCellsStats=PEr});var rNe=T(A4=>{"use strict";p();Object.defineProperty(A4,"__esModule",{value:!0});A4.mixin=void 0;var AEr=pr();Object.defineProperty(A4,"mixin",{enumerable:!0,get:function(){return AEr.mixin}})});var mee=T(VN=>{"use strict";p();Object.defineProperty(VN,"__esModule",{value:!0});VN.logMissingJSFeatures=VN.getMissingJSFeatures=void 0;var tNe=Ba(),F4=Gi(),FEr=Hf(),NEr=[{name:"self",test:function(){return typeof self<"u"}},{name:"fetch",test:function(){return typeof fetch=="function"}},{name:"Set",test:function(){return typeof Set=="function"}},{name:"Map",test:function(){return typeof Map=="function"}},{name:"WeakMap",test:function(){return typeof WeakMap=="function"}},{name:"Symbol",test:function(){return typeof Symbol=="function"}},{name:"WebAssembly",test:function(){return typeof WebAssembly=="object"}},{name:"Atomics",test:function(){return typeof Atomics=="object"}},{name:"BigInt",test:function(){return typeof BigInt=="function"}},{name:"String.startsWith",test:function(){return!0}},{name:"String.codePointAt",test:function(){return!0}},{name:"Object.assign",test:function(){return typeof Object.assign=="function"}},{name:"Object.setPrototypeOf",test:function(){return typeof Object.setPrototypeOf=="function"}},{name:"Number.EPSILON",test:function(){return typeof Number.EPSILON=="number"}},{name:"Number.isFinite",test:function(){return typeof Number.isFinite=="function"}},{name:"Number.parseInt",test:function(){return typeof Number.parseInt=="function"}},{name:"Math.acosh",test:function(){return typeof Math.acosh=="function"}},{name:"Math.hypot",test:function(){return typeof Math.hypot=="function"}},{name:"Math.log1p",test:function(){return typeof Math.log1p=="function"}},{name:"Math.trunc",test:function(){return typeof Math.trunc=="function"}},{name:"Promise.finally",test:function(){return typeof Promise.resolve().finally=="function"}},{name:"RegExp_flags",test:function(){return new RegExp("x","i"),!0}},{name:"RegExp.flags",test:function(){return typeof/x/.flags=="string"}},{name:"Array.of",test:function(){return typeof Array.of=="function"}},{name:"Array.entries",test:function(){return typeof[].entries=="function"}},{name:"Array.find",test:function(){return typeof[].find=="function"}},{name:"performance",test:function(){return typeof performance=="object"}},{name:"performance.now",test:function(){return typeof performance.now=="function"}},{name:"performance.timeOrigin",test:function(){return typeof performance.timeOrigin=="number"}},{name:"performance.memory",test:function(){return typeof performance.memory=="object"}}];function nNe(){return NEr.map(function(e){var r=e.name,t=e.test;try{return t()?"":r}catch(n){return r}}).filter(function(e){return e.length>0})}VN.getMissingJSFeatures=nNe;function OEr(e){e().then(function(r){var t={main:nNe(),worker:r},n="calc.calc.logMissingJSFeatures: missing = ".concat(JSON.stringify(t));tNe.ulsLogger.ULS.traceTag(561534152,F4.LogCategory.msoulscat_ES_EWAJS,F4.TraceLevel.Info,n)}).catch(function(r){var t="calc.calc.logMissingJSFeatures: threw ".concat((0,FEr.messageFromError)(r));tNe.ulsLogger.ULS.traceTag(561534153,F4.LogCategory.msoulscat_ES_EWAJS,F4.TraceLevel.Info,t)})}VN.logMissingJSFeatures=OEr});var iNe=T(N4=>{"use strict";p();Object.defineProperty(N4,"__esModule",{value:!0});N4.SpecialFormat=void 0;var aNe;(function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Aggregate="Aggregate",e.Inferred="Inferred",e.Known="Known",e.Edit="Edit"})(aNe||(N4.SpecialFormat=aNe={}))});var gee=T(Hl=>{"use strict";p();Object.defineProperty(Hl,"__esModule",{value:!0});Hl.assertPositiveLength=Hl.assertPositiveInteger=Hl.assertInteger=Hl.assertIndex=Hl.assertNatural=Hl.assertNever=Hl.assertFalse=Hl.assertTrue=Hl.ulsLogger=void 0;var m_=pr();Hl.ulsLogger=m_.assertions.ulsLogger;Hl.assertTrue=m_.assertions.assertTrue;Hl.assertFalse=m_.assertions.assertFalse;Hl.assertNever=m_.assertions.assertNever;Hl.assertNatural=m_.assertions.assertNatural;Hl.assertIndex=m_.assertions.assertIndex;Hl.assertInteger=m_.assertions.assertInteger;Hl.assertPositiveInteger=m_.assertions.assertPositiveInteger;Hl.assertPositiveLength=m_.assertions.assertPositiveLength});var JI=T(cn=>{"use strict";p();Object.defineProperty(cn,"__esModule",{value:!0});cn.now=cn.mapFromArrayOfPairs=cn.singleton=cn.typedInstanceCreator=cn.makeStringCompareCI=cn.fastAbs=cn.fastMax=cn.fastMin=cn.pair=cn.filterOutNones=cn.isNone=cn.isDefined=cn.safeConcat=cn.safePush=cn.strEnumArray=cn.numEnumMap=cn.numEnumArray=cn.cloneStringMap=cn.makeStringMap=cn.identity=cn.staticAssertIsOptional=cn.staticAssertIs=cn.staticAssertSame=cn.staticAssertExtends=cn.makeNewtypeIso=void 0;var Au=pr();cn.makeNewtypeIso=Au.core.makeNewtypeIso;cn.staticAssertExtends=Au.core.staticAssertExtends;cn.staticAssertSame=Au.core.staticAssertSame;cn.staticAssertIs=Au.core.staticAssertIs;cn.staticAssertIsOptional=Au.core.staticAssertIsOptional;cn.identity=Au.core.identity;cn.makeStringMap=Au.core.makeStringMap;cn.cloneStringMap=Au.core.cloneStringMap;cn.numEnumArray=Au.core.numEnumArray;cn.numEnumMap=Au.core.numEnumMap;cn.strEnumArray=Au.core.strEnumArray;cn.safePush=Au.core.safePush;cn.safeConcat=Au.core.safeConcat;cn.isDefined=Au.core.isDefined;cn.isNone=Au.core.isNone;cn.filterOutNones=Au.core.filterOutNones;cn.pair=Au.core.pair;cn.fastMin=Au.core.fastMin;cn.fastMax=Au.core.fastMax;cn.fastAbs=Au.core.fastAbs;cn.makeStringCompareCI=Au.core.makeStringCompareCI;cn.typedInstanceCreator=Au.core.typedInstanceCreator;cn.singleton=Au.core.singleton;cn.mapFromArrayOfPairs=Au.core.mapFromArrayOfPairs;cn.now=Au.core.now});var O4=T(WC=>{"use strict";p();Object.defineProperty(WC,"__esModule",{value:!0});WC.defaultSetTimeoutInterface=WC.clearTimerUnified=WC.setImmediateUnified=void 0;var vee=pr();WC.setImmediateUnified=vee.setTimeoutInterfaceModule.setImmediateUnified;WC.clearTimerUnified=vee.setTimeoutInterfaceModule.clearTimerUnified;WC.defaultSetTimeoutInterface=vee.setTimeoutInterfaceModule.defaultSetTimeoutInterface});var See=T(jN=>{"use strict";p();Object.defineProperty(jN,"__esModule",{value:!0});jN.RepeatedTaskScheduler=jN.TaskKind=void 0;var kEr=gee(),MEr=JI(),xEr=O4(),lu;(function(e){e[e.NoWorkScheduled=0]="NoWorkScheduled",e[e.PromiseScheduled=1]="PromiseScheduled",e[e.ImmediateScheduled=2]="ImmediateScheduled",e[e.FutureScheduled=3]="FutureScheduled"})(lu||(lu={}));(0,MEr.staticAssertExtends)();function k4(e,r){return{kind:e,handle:r}}function hee(e){return e!==void 0?(e.kind=lu.NoWorkScheduled,e.handle=void 0,e):k4(lu.NoWorkScheduled,void 0)}function IEr(e){return e!==void 0?(e.kind=lu.PromiseScheduled,e.handle=void 0,e):k4(lu.PromiseScheduled,void 0)}function wEr(e,r){return r!==void 0?(r.kind=lu.ImmediateScheduled,r.handle=e,r):k4(lu.ImmediateScheduled,e)}function DEr(e,r){return r!==void 0?(r.kind=lu.FutureScheduled,r.handle=e,r):k4(lu.FutureScheduled,e)}var ZI;(function(e){e.Sync="Sync",e.MicroTask="MicroTask",e.MacroTask="MacroTask"})(ZI||(jN.TaskKind=ZI={}));var LEr=Promise.resolve(),qEr=function(){function e(r,t){t===void 0&&(t=xEr.defaultSetTimeoutInterface);var n=this;this.timer=t,this.handleState=hee(),this.clearHandleClosureAndRunBody=function(){var a;switch(n.handleState.kind){case lu.NoWorkScheduled:a=ZI.Sync;break;case lu.PromiseScheduled:a=ZI.MicroTask;break;case lu.ImmediateScheduled:case lu.FutureScheduled:a=ZI.MacroTask;break;default:(0,kEr.assertNever)("Unknown handle state",n.handleState)}n.handleState=hee(n.handleState),r(a)},this.promiseClosure=function(){n.handleState.kind===lu.PromiseScheduled&&n.clearHandleClosureAndRunBody()}}return e.prototype.runNextSynchronously=function(){switch(this.handleState.kind){case lu.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case lu.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break}this.clearHandleClosureAndRunBody()},e.prototype.runNextAsMicrotask=function(){switch(this.handleState.kind){case lu.PromiseScheduled:return;case lu.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case lu.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break}this.handleState=IEr(this.handleState),LEr.then(this.promiseClosure)},e.prototype.runNextAsMacrotask=function(){switch(this.handleState.kind){case lu.ImmediateScheduled:return;case lu.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break}this.handleState=wEr(this.timer.setImmediate(this.clearHandleClosureAndRunBody),this.handleState)},e.prototype.runNextInFuture=function(r){switch(this.handleState.kind){case lu.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case lu.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break}this.handleState=DEr(this.timer.setTimeout(this.clearHandleClosureAndRunBody,r),this.handleState)},e.prototype.clear=function(){switch(this.handleState.kind){case lu.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case lu.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break}this.handleState=hee(this.handleState)},e}();jN.RepeatedTaskScheduler=qEr});var yee=T(M4=>{"use strict";p();Object.defineProperty(M4,"__esModule",{value:!0});M4.PriorityQueue=void 0;var GEr=pr();M4.PriorityQueue=GEr.priorityQueue.PriorityQueue});var _ee=T(WR=>{"use strict";p();Object.defineProperty(WR,"__esModule",{value:!0});WR.TimelineQueueProcessor=WR.defaultTimerInterface=void 0;var oNe=fe(),BEr=JI(),UEr=yee(),KEr=O4(),uNe=See();WR.defaultTimerInterface=oNe.__assign(oNe.__assign({},KEr.defaultSetTimeoutInterface),{now:BEr.now});var VEr=function(){function e(r,t,n,a){a===void 0&&(a=WR.defaultTimerInterface);var o=this,u,s;this.cmp=r,this.consumeMessage=t,this.timer=a,this.startTime=void 0,this.totalSyncCost=0,this.maxWitnessedNow=0,this.lastFutureAbsoluteTime=void 0,this.queue=new UEr.PriorityQueue(function(l,c){var d=l.delayUntil-c.delayUntil;return d!==0?d:r(l.payload,c.payload)}),this.costThreshold=(u=n==null?void 0:n.costThreshold)!==null&&u!==void 0?u:1,this.timeThreshold=(s=n==null?void 0:n.timeThreshold)!==null&&s!==void 0?s:10,this.scheduler=new uNe.RepeatedTaskScheduler(function(l){o.totalSyncCost=0,o.lastFutureAbsoluteTime=void 0,l===uNe.TaskKind.MacroTask&&(o.startTime=void 0),o.continue()},a)}return e.prototype.enqueue=function(r,t,n){n===void 0&&(n=this.maxWitnessedNow),this.queue.enqueue({delayUntil:n,payload:r,abstractCost:t}),this.continue()},e.prototype.push=function(r,t,n){n===void 0&&(n=this.maxWitnessedNow),this.queue.push({delayUntil:n,payload:r,abstractCost:t}),this.continue()},e.prototype.pop=function(){var r;return this.queue.getCount()===1&&this.scheduler.clear(),(r=this.queue.pop())===null||r===void 0?void 0:r.payload},e.prototype.peek=function(){return this.queue.peek()},e.prototype.getCount=function(){return this.queue.getCount()},e.prototype.continue=function(){var r;for(this.startTime=(r=this.startTime)!==null&&r!==void 0?r:this.now();this.totalSyncCost<this.costThreshold;){var t=this.queue.peek();if(t===void 0||t.delayUntil>this.maxWitnessedNow&&this.tryRunNextInFuture(t.delayUntil,this.now()))return;this.queue.pop(),this.totalSyncCost+=t.abstractCost,this.consumeMessage(t.payload)}var n=this.queue.peek();if(n!==void 0){var a=this.now();a-this.startTime<this.timeThreshold&&n.delayUntil<=a?this.scheduler.runNextAsMicrotask():this.tryRunNextInFuture(n.delayUntil,a)||this.scheduler.runNextAsMacrotask()}},e.prototype.tryRunNextInFuture=function(r,t){return r>t?(this.lastFutureAbsoluteTime!==r&&(this.lastFutureAbsoluteTime=r,this.scheduler.runNextInFuture(r-t)),!0):!1},e.prototype.now=function(){return this.maxWitnessedNow=this.timer.now()},e}();WR.TimelineQueueProcessor=VEr});var sNe=T(Ys=>{"use strict";p();Object.defineProperty(Ys,"__esModule",{value:!0});Ys.values=Ys.stringStartsWith=Ys.stringEndsWith=Ys.repeat=Ys.prependErrorMessage=Ys.partialArray=Ys.messageFromError=Ys.mathLog2=Ys.isInteger=Ys.arrayFill=void 0;var NS=pr();Ys.arrayFill=NS.util.arrayFill;Ys.isInteger=NS.util.isInteger;Ys.mathLog2=NS.util.mathLog2;Ys.messageFromError=NS.util.messageFromError;Ys.partialArray=NS.util.partialArray;Ys.prependErrorMessage=NS.util.prependErrorMessage;Ys.repeat=NS.util.repeat;Ys.stringEndsWith=NS.util.stringEndsWith;Ys.stringStartsWith=NS.util.stringStartsWith;Ys.values=NS.util.values});var lNe=T(HN=>{"use strict";p();Object.defineProperty(HN,"__esModule",{value:!0});HN.MockTimerImmediate=HN.MockTimer=void 0;var x4=fe(),jEr=yee(),WEr=sNe(),WN=O4(),HEr=function(){function e(r){var t=this;this.nowTimes=r,this.setImmediateCalls=[],this.setTimeoutCalls=[],this.clearImmediateCalls=[],this.clearTimeoutCalls=[],this.setImmediate=function(n){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];if(t.handle!==void 0)throw"setImmediate called, even though we already have a callback";return t.setImmediateCalls.push(x4.__spreadArray([n],a,!0)),t.handle=(0,WN.setImmediateUnified)(function(){return t.handle=void 0,n.apply(void 0,a)})},this.clearImmediate=function(n){if(t.handle!==n)throw"clearImmediate called with a different handle than the one supplied";(0,WN.clearTimerUnified)(t.handle),t.clearImmediateCalls.push([n]),t.handle=void 0},this.setTimeout=function(n,a){for(var o=[],u=2;u<arguments.length;u++)o[u-2]=arguments[u];if(t.handle!==void 0)throw"setTimeout called, even though we already have a callback";return t.setTimeoutCalls.push(x4.__spreadArray([n,a],o,!0)),t.handle=(0,WN.setImmediateUnified)(function(){return t.handle=void 0,n.apply(void 0,o)})},this.clearTimeout=function(n){if(t.handle!==n)throw"clearTimeout called with a different handle than the one supplied";(0,WN.clearTimerUnified)(t.handle),t.clearTimeoutCalls.push([n]),t.handle=void 0}}return e.prototype.now=function(){var r=this.nowTimes.shift();if(r===void 0)throw"now was called too many times";return r},e}();HN.MockTimer=HEr;var zEr=-1,QEr=function(){function e(r,t){r===void 0&&(r=1),t===void 0&&(t=0);var n=this;this.precisionMs=r,this.startTime=t,this.setImmediate=function(a){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var s={delayUntil:zEr,callback:a,args:o,isValid:!0};return n.queue.enqueue(s),new e.Immediate(s)},this.clearImmediate=function(a){if(!(a instanceof e.Immediate))throw new TypeError("handle is not a MockFullTimer.Immediate");(0,WN.clearTimerUnified)(a)},this.setTimeout=function(a,o){for(var u=[],s=2;s<arguments.length;s++)u[s-2]=arguments[s];var l=n.time+(o>4?o:4),c={delayUntil:l,callback:a,args:u,isValid:!0};return n.queue.enqueue(c),new e.Timeout(c)},this.clearTimeout=function(a){if(!(a instanceof e.Timeout))throw new TypeError("handle is not a MockFullTimer.Timeout");(0,WN.clearTimerUnified)(a)},this.time=t>0?t:0,this.queue=new jEr.PriorityQueue(function(a,o){return a.delayUntil-o.delayUntil})}return e.prototype.preciseNow=function(){return this.time},e.prototype.now=function(){return Math.floor(this.time/this.precisionMs)*this.precisionMs},e.prototype.busyWait=function(r){this.time+=r>0?r:0},e.prototype.busyWaitUntil=function(r){this.time=this.time<r?r:this.time},e.prototype.runMacrotasksWhile=function(r){return x4.__awaiter(this,void 0,void 0,function(){var t;return x4.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(a){return setImmediate(function(){return a()})})];case 1:if(n.sent(),!r())return[2];if(t=this.queue.pop(),!t)return[2];if(this.busyWaitUntil(t.delayUntil),t.isValid)try{t.callback.apply(t,t.args)}catch(a){dispatchEvent(new ErrorEvent("error",{error:a,message:(0,WEr.messageFromError)(a),filename:"",lineno:0,colno:0}))}return[3,0];case 2:return[2]}})})},e.Immediate=function(){function r(t){this.delayedCallback=t,this.kind="Mocking"}return r}(),e.Timeout=function(){function r(t){this.delayedCallback=t,this.kind="Mocking"}return r}(),e}();HN.MockTimerImmediate=QEr});var cNe=T(Of=>{"use strict";p();Object.defineProperty(Of,"__esModule",{value:!0});Of.promiseLoop=Of.promiseFinally=Of.newPromise=Of.isThenable=Of.collapseThenable=Of.bindMaybeThenable=Of.MaybeThenable=void 0;var HR=pr();Of.MaybeThenable=HR.promise.MaybeThenable;Of.bindMaybeThenable=HR.promise.bindMaybeThenable;Of.collapseThenable=HR.promise.collapseThenable;Of.isThenable=HR.promise.isThenable;Of.newPromise=HR.promise.newPromise;Of.promiseFinally=HR.promise.promiseFinally;Of.promiseLoop=HR.promise.promiseLoop});var dNe=T(w4=>{"use strict";p();Object.defineProperty(w4,"__esModule",{value:!0});w4.runQueueProcessorUntil=void 0;var I4=fe(),XEr=cNe();function YEr(e,r){return I4.__awaiter(this,void 0,void 0,function(){var t,n,a,o=this;return I4.__generator(this,function(u){switch(u.label){case 0:return t=!1,n=Promise.resolve(r),n.then(function(){return t=!0}),a=0,[4,(0,XEr.promiseLoop)(function(){return I4.__awaiter(o,void 0,void 0,function(){return I4.__generator(this,function(s){switch(s.label){case 0:return++a%100!==0?[3,2]:[4,new Promise(function(l){return setTimeout(l,1)})];case 1:s.sent(),s.label=2;case 2:return t?[2,void 0]:(e.step(),[2,!0])}})})},!0)];case 1:return u.sent(),[2,n]}})})}w4.runQueueProcessorUntil=YEr});var pNe=T(D4=>{"use strict";p();Object.defineProperty(D4,"__esModule",{value:!0});D4.NotificationKind=void 0;var fNe;(function(e){e.doNothing="doNothing",e.setActiveCell="setActiveCell",e.setActiveCellFormat="setActiveCellFormat",e.setFunctionsInfo="setFunctionsInfo",e.setDefinedNamesInfo="setDefinedNamesInfo",e.notifyWorkbookClosing="notifyWorkbookClosing",e.setSchedulerFeatures="setSchedulerFeatures",e.setA1ReferenceStyle="setA1ReferenceStyle",e.setLocale="setLocale",e.setWorkbookProps="setWorkbookProps",e.updateSheetNames="updateSheetNames",e.updateNamedObjects="updateNamedObjects",e.conflictResolverEarlyTermination="conflictResolverEarlyTermination",e.writeRange="writeRange",e.setNumberFormats="setNumberFormats"})(fNe||(D4.NotificationKind=fNe={}))});var mNe=T(kf=>{"use strict";p();Object.defineProperty(kf,"__esModule",{value:!0});kf.successUndefined=kf.success=kf.javaScriptError=kf.isSuccess=kf.failure=kf.ResultKind=kf.ReasonKind=void 0;var zR=pr();kf.ReasonKind=zR.result.ReasonKind;kf.ResultKind=zR.result.ResultKind;kf.failure=zR.result.failure;kf.isSuccess=zR.result.isSuccess;kf.javaScriptError=zR.result.javaScriptError;kf.success=zR.result.success;kf.successUndefined=zR.result.successUndefined});var gNe=T(Le=>{"use strict";p();Object.defineProperty(Le,"__esModule",{value:!0});Le.isSheetGridRangeEqual=Le.isSheetGridRange=Le.isSheetGridCellEqual=Le.isSheetGridCell=Le.isRichOper=Le.isReadOperEqual=Le.isRangeOper=Le.isRangeOpNoMissing=Le.isRangeOpClosed=Le.isPrimitiveOper=Le.isOperatorNode=Le.isNumberOper=Le.isNumberLiteralNode=Le.isNameScopeEqual=Le.isMissingOper=Le.isMissingNode=Le.isGridRangeEqual=Le.isGridCellEqual=Le.isGridCell=Le.isErrorOper=Le.isDocumentLocEqual=Le.isCommaOpRefWellFormed=Le.isCommaOpNoBadOrMissing=Le.isCommaOpClosed=Le.isBooleanOper=Le.isBooleanLiteralNode=Le.isBlankOper=Le.isArrayOper=Le.internal=Le.gridRangesJoin=Le.gridRangeSize=Le.gridRangeJoinOpt=Le.gridRangeJoin=Le.gridRangeIsects=Le.gridRangeIsect=Le.gridRangeExcept=Le.gridRangeCompare=Le.gridRangeAnchor=Le.gridCellRange=Le.gridCellImplicitIsect=Le.getWorksheetFuncId=Le.getUserDefinedFuncName=Le.getBoundName=Le.getArguments=Le.getArgType=Le.forEachTileInRange=Le.forEachCellInRange=Le.createFailureErrorClass=Le.ReasonKind=Le.LangReasonKind=void 0;Le.unavailable=Le.shouldFieldRefBeBracketed=Le.sheetGridRangeAnchor=Le.notImplemented=Le.normalizeCommaOpRef=Le.isWriteOper=Le.isWellFormed=Le.isWSFNode=Le.isValidArgsLength=Le.isUnqualifiedNameNode=Le.isStringOper=Le.isSheetIndexEqual=Le.isSheetIndex=void 0;var bt=qr();Le.LangReasonKind=bt.util.LangReasonKind;Le.ReasonKind=bt.util.ReasonKind;Le.createFailureErrorClass=bt.util.createFailureErrorClass;Le.forEachCellInRange=bt.util.forEachCellInRange;Le.forEachTileInRange=bt.util.forEachTileInRange;Le.getArgType=bt.util.getArgType;Le.getArguments=bt.util.getArguments;Le.getBoundName=bt.util.getBoundName;Le.getUserDefinedFuncName=bt.util.getUserDefinedFuncName;Le.getWorksheetFuncId=bt.util.getWorksheetFuncId;Le.gridCellImplicitIsect=bt.util.gridCellImplicitIsect;Le.gridCellRange=bt.util.gridCellRange;Le.gridRangeAnchor=bt.util.gridRangeAnchor;Le.gridRangeCompare=bt.util.gridRangeCompare;Le.gridRangeExcept=bt.util.gridRangeExcept;Le.gridRangeIsect=bt.util.gridRangeIsect;Le.gridRangeIsects=bt.util.gridRangeIsects;Le.gridRangeJoin=bt.util.gridRangeJoin;Le.gridRangeJoinOpt=bt.util.gridRangeJoinOpt;Le.gridRangeSize=bt.util.gridRangeSize;Le.gridRangesJoin=bt.util.gridRangesJoin;Le.internal=bt.util.internal;Le.isArrayOper=bt.util.isArrayOper;Le.isBlankOper=bt.util.isBlankOper;Le.isBooleanLiteralNode=bt.util.isBooleanLiteralNode;Le.isBooleanOper=bt.util.isBooleanOper;Le.isCommaOpClosed=bt.util.isCommaOpClosed;Le.isCommaOpNoBadOrMissing=bt.util.isCommaOpNoBadOrMissing;Le.isCommaOpRefWellFormed=bt.util.isCommaOpRefWellFormed;Le.isDocumentLocEqual=bt.util.isDocumentLocEqual;Le.isErrorOper=bt.util.isErrorOper;Le.isGridCell=bt.util.isGridCell;Le.isGridCellEqual=bt.util.isGridCellEqual;Le.isGridRangeEqual=bt.util.isGridRangeEqual;Le.isMissingNode=bt.util.isMissingNode;Le.isMissingOper=bt.util.isMissingOper;Le.isNameScopeEqual=bt.util.isNameScopeEqual;Le.isNumberLiteralNode=bt.util.isNumberLiteralNode;Le.isNumberOper=bt.util.isNumberOper;Le.isOperatorNode=bt.util.isOperatorNode;Le.isPrimitiveOper=bt.util.isPrimitiveOper;Le.isRangeOpClosed=bt.util.isRangeOpClosed;Le.isRangeOpNoMissing=bt.util.isRangeOpNoMissing;Le.isRangeOper=bt.util.isRangeOper;Le.isReadOperEqual=bt.util.isReadOperEqual;Le.isRichOper=bt.util.isRichOper;Le.isSheetGridCell=bt.util.isSheetGridCell;Le.isSheetGridCellEqual=bt.util.isSheetGridCellEqual;Le.isSheetGridRange=bt.util.isSheetGridRange;Le.isSheetGridRangeEqual=bt.util.isSheetGridRangeEqual;Le.isSheetIndex=bt.util.isSheetIndex;Le.isSheetIndexEqual=bt.util.isSheetIndexEqual;Le.isStringOper=bt.util.isStringOper;Le.isUnqualifiedNameNode=bt.util.isUnqualifiedNameNode;Le.isValidArgsLength=bt.util.isValidArgsLength;Le.isWSFNode=bt.util.isWSFNode;Le.isWellFormed=bt.util.isWellFormed;Le.isWriteOper=bt.util.isWriteOper;Le.normalizeCommaOpRef=bt.util.normalizeCommaOpRef;Le.notImplemented=bt.util.notImplemented;Le.sheetGridRangeAnchor=bt.util.sheetGridRangeAnchor;Le.shouldFieldRefBeBracketed=bt.util.shouldFieldRefBeBracketed;Le.unavailable=bt.util.unavailable});var vNe=T(L4=>{"use strict";p();Object.defineProperty(L4,"__esModule",{value:!0});L4.MockGlobals=void 0;var OS=mNe(),kS=gNe(),JEr=function(){function e(r){this.config=r}return e.prototype.getDocumentLoc=function(){return(0,OS.failure)((0,kS.notImplemented)(["getDocumentLoc"]))},e.prototype.getSheetIndex=function(){return(0,OS.failure)((0,kS.notImplemented)(["getSheetIndex"]))},e.prototype.getSheetName=function(){return(0,OS.failure)((0,kS.notImplemented)(["getSheetName"]))},e.prototype.getNameLoc=function(){return(0,OS.failure)((0,kS.notImplemented)(["getNameLoc"]))},e.prototype.getUserDefinedFuncLoc=function(){return(0,OS.failure)((0,kS.notImplemented)(["getUserDefinedFuncLoc"]))},e.prototype.getSheetRangeIndexes=function(){return(0,OS.failure)((0,kS.notImplemented)(["getSheetRangeIndexes"]))},e.prototype.getContainingTable=function(){return(0,OS.failure)((0,kS.notImplemented)(["getContainingTable"]))},e.prototype.getStructRefColumn=function(){return(0,OS.failure)((0,kS.notImplemented)(["getStructRefColumn"]))},e.prototype.getStructRefSpecialRef=function(){return(0,OS.failure)((0,kS.notImplemented)(["getStructRefSpecialRef"]))},e.prototype.getTime=function(){return(0,OS.failure)((0,kS.unavailable)(["getTime"]))},e}();L4.MockGlobals=JEr});var _Ne=T(MS=>{"use strict";p();Object.defineProperty(MS,"__esModule",{value:!0});MS.spanCompare=MS.Timeline=MS.spanToLSPRange=MS.indexToLSPPosition=void 0;var hNe=fe(),ZEr=JI(),$Er=_ee(),q4=nl(),SNe=gee(),yNe=sy();function bee(e,r){for(var t=0,n=0;n<r;){var a=e.indexOf("\n",n),o=e.indexOf("\r",n),u=a<0?o:o<0?a:(0,ZEr.fastMin)(a,o);if(u<0||u>=r)break;t+=1,n=u+1+(u===o&&u+1<r&&e.charCodeAt(u+1)===10?1:0)}return{line:t,character:r-n}}MS.indexToLSPPosition=bee;function ePr(e,r,t){return{start:bee(e,r),end:bee(e,t)}}MS.spanToLSPRange=ePr;var rPr=function(){function e(r,t,n){n===void 0&&(n=!0),this.name=r,this.logThreshold=t,this.enabled=n,this.timestamps=new Map,this.timer=$Er.defaultTimerInterface,this.workerInfo={isWorkerThread:(0,yNe.isWorkerThread)(),workerName:(0,yNe.workerName)()},SNe.ulsLogger.ULS.traceTag(526223315,q4.LogCategory.msoulscat_ES_EWAJS,q4.TraceLevel.Info,"Timeline[".concat(this.name,"]: Initializing, ").concat(JSON.stringify(this.workerInfo)))}return e.prototype.stamp=function(r){this.enabled&&!this.timestamps.has(r)&&this.timestamps.set(r,this.timer.now())},e.prototype.log=function(r){if(this.enabled){this.stamp(r);var t={},n=this.timer.now(),a=0;this.timestamps.forEach(function(o,u){n=Math.min(n,o),a=Math.max(a,o),t[u]=o}),a-n>this.logThreshold&&SNe.ulsLogger.ULS.traceTag(526234881,q4.LogCategory.msoulscat_ES_EWAJS,q4.TraceLevel.Info,"Timeline[".concat(this.name,"]: ").concat(JSON.stringify(hNe.__assign(hNe.__assign({},t),this.workerInfo)))),this.timestamps.clear()}},e}();MS.Timeline=rPr;function tPr(e,r){var t;return(t=e.start-r.start)!==0||(t=r.end-e.end)!==0?t:0}MS.spanCompare=tPr});var bNe=T(vt=>{"use strict";p();Object.defineProperty(vt,"__esModule",{value:!0});vt.userDefinedFuncLoc=vt.unsafeGridRange=vt.structRefColumnLoc=vt.sheetRows=vt.sheetRangeIndexes=vt.sheetRange=vt.sheetIndex=vt.sheetGridRange=vt.sheetGridCube=vt.sheetGridCell=vt.sheetCols=vt.originCell=vt.nameScope=vt.nameLoc=vt.lexicalSourceRange=vt.lexicalSourceUDF=vt.lexicalSourceWSF=vt.lexicalSourceName=vt.lexicalSourceGrid=vt.lexicalSourceCell=vt.isSheetIndex=vt.isSheetGridRange=vt.isSheetGridCell=vt.isGridCell=vt.gridRange=vt.gridCell=vt.documentScope=vt.documentLoc=vt.allSheetsRange=vt.NameSource=vt.LexicalKind=void 0;var zi=qr();vt.LexicalKind=zi.location.LexicalKind;vt.NameSource=zi.location.NameSource;vt.allSheetsRange=zi.location.allSheetsRange;vt.documentLoc=zi.location.documentLoc;vt.documentScope=zi.location.documentScope;vt.gridCell=zi.location.gridCell;vt.gridRange=zi.location.gridRange;vt.isGridCell=zi.location.isGridCell;vt.isSheetGridCell=zi.location.isSheetGridCell;vt.isSheetGridRange=zi.location.isSheetGridRange;vt.isSheetIndex=zi.location.isSheetIndex;vt.lexicalSourceCell=zi.location.lexicalSourceCell;vt.lexicalSourceGrid=zi.location.lexicalSourceGrid;vt.lexicalSourceName=zi.location.lexicalSourceName;vt.lexicalSourceWSF=zi.location.lexicalSourceWSF;vt.lexicalSourceUDF=zi.location.lexicalSourceUDF;vt.lexicalSourceRange=zi.location.lexicalSourceRange;vt.nameLoc=zi.location.nameLoc;vt.nameScope=zi.location.nameScope;vt.originCell=zi.location.originCell;vt.sheetCols=zi.location.sheetCols;vt.sheetGridCell=zi.location.sheetGridCell;vt.sheetGridCube=zi.location.sheetGridCube;vt.sheetGridRange=zi.location.sheetGridRange;vt.sheetIndex=zi.location.sheetIndex;vt.sheetRange=zi.location.sheetRange;vt.sheetRangeIndexes=zi.location.sheetRangeIndexes;vt.sheetRows=zi.location.sheetRows;vt.structRefColumnLoc=zi.location.structRefColumnLoc;vt.unsafeGridRange=zi.location.unsafeGridRange;vt.userDefinedFuncLoc=zi.location.userDefinedFuncLoc});var CNe=T(Fn=>{"use strict";p();Object.defineProperty(Fn,"__esModule",{value:!0});Fn.valueErrorOper=Fn.trueOper=Fn.stringOper=Fn.refErrorOper=Fn.rangeSeqOper=Fn.range3DOper=Fn.precedents=Fn.numErrorOper=Fn.nullErrorOper=Fn.nameErrorOper=Fn.naErrorOper=Fn.missingOper=Fn.gettingDataErrorOper=Fn.fieldErrorOper=Fn.falseOper=Fn.errorOper=Fn.div0ErrorOper=Fn.cellStringLimit=Fn.booleanOper=Fn.blankOper=Fn.arrayOper=Fn.PrecsBound=Fn.ErrorType=void 0;var _s=qr();Fn.ErrorType=_s.value.ErrorType;Fn.PrecsBound=_s.value.PrecsBound;Fn.arrayOper=_s.value.arrayOper;Fn.blankOper=_s.value.blankOper;Fn.booleanOper=_s.value.booleanOper;Fn.cellStringLimit=_s.value.cellStringLimit;Fn.div0ErrorOper=_s.value.div0ErrorOper;Fn.errorOper=_s.value.errorOper;Fn.falseOper=_s.value.falseOper;Fn.fieldErrorOper=_s.value.fieldErrorOper;Fn.gettingDataErrorOper=_s.value.gettingDataErrorOper;Fn.missingOper=_s.value.missingOper;Fn.naErrorOper=_s.value.naErrorOper;Fn.nameErrorOper=_s.value.nameErrorOper;Fn.nullErrorOper=_s.value.nullErrorOper;Fn.numErrorOper=_s.value.numErrorOper;Fn.precedents=_s.value.precedents;Fn.range3DOper=_s.value.range3DOper;Fn.rangeSeqOper=_s.value.rangeSeqOper;Fn.refErrorOper=_s.value.refErrorOper;Fn.stringOper=_s.value.stringOper;Fn.trueOper=_s.value.trueOper;Fn.valueErrorOper=_s.value.valueErrorOper});var TNe=T(_v=>{"use strict";p();Object.defineProperty(_v,"__esModule",{value:!0});_v.wrapIntoResumeRecalc=_v.emptyRangeFormat=_v.emptyRangeFormula=_v.emptyRangeValue=_v.FormulaKind=void 0;var xS=fe(),nPr=bNe(),aPr=CNe(),iPr=JI(),Cee;(function(e){e.Value="Value",e.CellFormula="CellFormula"})(Cee||(_v.FormulaKind=Cee={}));_v.emptyRangeValue=aPr.blankOper;_v.emptyRangeFormula={kind:Cee.Value,formulaBarText:"",origin:(0,nPr.gridCell)(0,0)};(0,iPr.staticAssertExtends)();_v.emptyRangeFormat=0;function oPr(e,r){return{evalClonedModelOnSnapshot:function(n){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var u=e.evalClonedModelOnSnapshot.apply(e,xS.__spreadArray([n],a,!1));return r(n),u},discardSnapshot:e.discardSnapshot.bind(e),getRangeFormats:function(n){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var u=e.getRangeFormats.apply(e,xS.__spreadArray([n],a,!1));return r(n),u},getRangeValues:function(n){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var u=e.getRangeValues.apply(e,xS.__spreadArray([n],a,!1));return r(n),u},getRangeFormulae:function(n){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var u=e.getRangeFormulae.apply(e,xS.__spreadArray([n],a,!1));return r(n),u},getSheetNames:function(n){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var u=e.getSheetNames.apply(e,xS.__spreadArray([n],a,!1));return r(n),u},getIntersectingTables:function(n){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var u=e.getIntersectingTables.apply(e,xS.__spreadArray([n],a,!1));return r(n),u},getIformats:function(n){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var u=e.getIformats.apply(e,xS.__spreadArray([n],a,!1));return r(n),u},getHiddenRows:function(n){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var u=e.getHiddenRows.apply(e,xS.__spreadArray([n],a,!1));return r(n),u},getHiddenCols:function(n){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var u=e.getHiddenCols.apply(e,xS.__spreadArray([n],a,!1));return r(n),u},evalFormulaOnSnapshot:function(n){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];var u=e.evalFormulaOnSnapshot.apply(e,xS.__spreadArray([n],a,!1));return r(n),u},getCorrespondingSnapshotID:function(n){return e.getCorrespondingSnapshotID(n)}}}_v.wrapIntoResumeRecalc=oPr});var v_=T(Js=>{"use strict";p();Object.defineProperty(Js,"__esModule",{value:!0});Js.gridinterface=Js.helpers=Js.mockGlobals=Js.notificationKinds=Js.testUtils=Js.mockTimer=Js.timelineQueueProcessor=Js.repeatedTaskScheduler=Js.types=Js.PackageName=void 0;var g_=fe();Js.PackageName="excel-online-x10-types";Js.types=g_.__importStar(iNe());Js.repeatedTaskScheduler=g_.__importStar(See());Js.timelineQueueProcessor=g_.__importStar(_ee());Js.mockTimer=g_.__importStar(lNe());Js.testUtils=g_.__importStar(dNe());Js.notificationKinds=g_.__importStar(pNe());Js.mockGlobals=g_.__importStar(vNe());Js.helpers=g_.__importStar(_Ne());Js.gridinterface=g_.__importStar(TNe())});var QR=T(bv=>{"use strict";p();Object.defineProperty(bv,"__esModule",{value:!0});bv.wrapIntoResumeRecalc=bv.emptyRangeValue=bv.emptyRangeFormula=bv.emptyRangeFormat=bv.FormulaKind=void 0;var $I=v_();bv.FormulaKind=$I.gridinterface.FormulaKind;bv.emptyRangeFormat=$I.gridinterface.emptyRangeFormat;bv.emptyRangeFormula=$I.gridinterface.emptyRangeFormula;bv.emptyRangeValue=$I.gridinterface.emptyRangeValue;bv.wrapIntoResumeRecalc=$I.gridinterface.wrapIntoResumeRecalc});var t2=T(HC=>{"use strict";p();Object.defineProperty(HC,"__esModule",{value:!0});HC.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=HC.convertX10UpdatesToCalcUpdates=HC.RecalcSideGrid=void 0;var cu=fe(),YR=Ar(),Uo=zn(),e2=No(),uPr=qi(),Ym=qi(),RNe=QR(),r2=n_(),sPr=cu.__importStar(sy()),lPr=r_(),XR=IR(),Ree=Ss(),zN=Zc(),Tee=Pf(),cPr=ti();(0,YR.staticAssertSame)();(0,YR.staticAssertSame)();(0,YR.staticAssertSame)();(0,YR.staticAssertSame)();var dPr=function(){function e(r){this.calcGrid=r,this.snapshotPromises=[]}return e.prototype.createIGridExportEndpoint=function(r){return cu.__awaiter(this,void 0,void 0,function(){var t=this;return cu.__generator(this,function(n){switch(n.label){case 0:return[4,sPr.Endpoint.createInside(r,function(){return t})];case 1:return n.sent(),[2]}})})},e.prototype.discardSnapshot=function(r){return this.snapshotPromises[r]===void 0?!1:(delete this.snapshotPromises[r],!0)},e.prototype.evalClonedModelOnSnapshot=function(r,t,n,a){var o;return cu.__awaiter(this,void 0,void 0,function(){var u,s,l,c,d;return cu.__generator(this,function(f){switch(f.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return u=((o=f.sent())!==null&&o!==void 0?o:{snapshot:void 0}).snapshot,u===void 0?[2,(0,Uo.failure)((0,Ym.unavailable)(["evalOnClonedModel"]))]:(s=ENe(t,u.config.mathpack),l=PNe(n,u.config.mathpack),c=this.calcGrid.evalOnClonedModelOnSnapshot(s,l,u,a),this.calcGrid.resumeRecalc(),d=Uo.success,[4,c]);case 2:return[2,d.apply(void 0,[f.sent()])]}})})},e.prototype.evalFormulaOnSnapshot=function(r,t,n,a){var o;return a===void 0&&(a={kind:Ree.SpecialFormat.Origin}),cu.__awaiter(this,void 0,void 0,function(){var u,s,l,c;return cu.__generator(this,function(d){switch(d.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return u=((o=d.sent())!==null&&o!==void 0?o:{snapshot:void 0}).snapshot,u===void 0?[2,(0,Uo.failure)((0,Ym.unavailable)(["evalFormula"]))]:(s=this.calcGrid.evalFormulaOnSnapshotImpl(t,n,a,u),this.calcGrid.resumeRecalc(),c=fPr,[4,s]);case 2:return l=c.apply(void 0,[d.sent()]),[2,(0,Uo.success)(l)]}})})},e.prototype.getSheetNames=function(r){var t;return cu.__awaiter(this,void 0,void 0,function(){var n,a,o,u,s,l,c;return cu.__generator(this,function(d){switch(d.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:if(n=((t=d.sent())!==null&&t!==void 0?t:{snapshot:void 0}).snapshot,n===void 0)return[2,(0,Uo.failure)((0,Ym.unavailable)(["getSheetNames"]))];if(a={document:this.calcGrid.document,sheets:new Array},o=n.getSheetRangeIndexes((0,e2.allSheetsRange)(this.calcGrid.document)),!(0,Uo.isSuccess)(o))return[2,o];for(u=0,s=o.value.sheets;u<s.length;u++){if(l=s[u],c=n.getSheetName(this.calcGrid.document,l),!(0,Uo.isSuccess)(c))return[2,c];a.sheets.push({sheetIndex:(0,e2.sheetIndex)(this.calcGrid.document,l),sheetName:c.value})}return[2,(0,Uo.success)(a)]}})})},e.prototype.getCorrespondingSnapshotID=function(r){return cu.__awaiter(this,void 0,void 0,function(){var t;return cu.__generator(this,function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return t=n.sent(),t===void 0?[2,-1]:[2,t.correspondingId]}})})},e.prototype.getOrCreateSnapshot=function(r){return cu.__awaiter(this,void 0,void 0,function(){return cu.__generator(this,function(t){return this.snapshotPromises[r]===void 0&&(this.snapshotPromises[r]=this.calcGrid.dataModel.createSnapshot(r),this.calcGrid.resumeRecalc().catch(function(n){setTimeout(function(){throw n})})),[2,this.snapshotPromises[r]]})})},e.prototype.getRangeFormats=function(r,t){return this.getRangeData(r,t,"formats")},e.prototype.getRangeValues=function(r,t){return this.getRangeData(r,t,"values")},e.prototype.getRangeFormulae=function(r,t){return this.getRangeData(r,t,"formulae")},e.prototype.getRangeData=function(r,t,n){var a;return cu.__awaiter(this,void 0,void 0,function(){var o,u,s,l,c,d,f,m;return cu.__generator(this,function(v){switch(v.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return o=((a=v.sent())!==null&&a!==void 0?a:{snapshot:void 0}).snapshot,o===void 0?[2,(0,Uo.failure)((0,Ym.unavailable)(["getRangeData/getOrCreateSnapshot"]))]:(u=o.allEditedAvailable(t),u.kind!==Uo.ResultKind.Success?[2,(0,Uo.failure)((0,Ym.unavailable)(["getRangeData/allEditedAvailable"]))]:(s=(0,zN.createCellSetFromRange)(t.range),u.value!==!0&&(s=(0,Tee.exceptProduct)(s,u.value)),l=function(y){var _=[],E=(0,zN.forEachRangeInSet)(s,function(N){var k=y((0,e2.sheetGridRange)(t.sheet,N),function(q){s=(0,Tee.exceptProduct)(s,(0,zN.createCellSetFromRange)(q))},function(q,V){_.push([[q.row,q.col],V])});return k.kind===Uo.ResultKind.Success&&k.value});return E?(0,Uo.success)(_):(0,Uo.failure)((0,Ym.unavailable)(["getRangeData/extractData"]))},c={formulae:function(){return l(function(y,_,E){return o.forEachEditedFormula(y,function(N,k){var q=k.lexicalKind,V=k.compiledFmla,I=k.fmla,M=k.origin;return q===e2.LexicalKind.Range||!(0,Ym.isGridCell)(N)?_(N):(0,r2.isBlankGridFormula)(I,V!==void 0)||E(N,{kind:V!==void 0?RNe.FormulaKind.CellFormula:RNe.FormulaKind.Value,formulaBarText:I,origin:(0,Ym.isGridCellEqual)(M,N)?void 0:M}),!0})})},formats:function(){return l(function(y,_,E){return o.forEachEditedFormat(y,function(N,k){return k===Ree.SpecialFormat.Unavailable?_(N):(0,r2.isBlankCellFormat)(k)||E(N,typeof k=="number"?k:k.formatString),!0})})},values:function(){return l(function(y,_,E){return o.forEachRecalcValue(y,function(N,k){return k.failure!==void 0?_(N):(0,r2.isBlankGridValue)(k.oper,k.failure)||E(N,k.oper),!0})})}},d=c[n](),f=d,f.kind!==Uo.ResultKind.Success?[2,f]:(m=[],(0,zN.forEachRangeInSet)(s,function(h){return m.push(h),!0}),[2,(0,Uo.success)({nonEmptyCells:f.value,availableRanges:m})])))}})})},e.prototype.getIntersectingTables=function(r,t){var n,a;return cu.__awaiter(this,void 0,void 0,function(){var o,u,s,l,c,d,f,m,v,h,y,_;return cu.__generator(this,function(E){switch(E.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:if(o=((n=E.sent())!==null&&n!==void 0?n:{snapshot:void 0}).snapshot,o===void 0)return[2,(0,Uo.failure)((0,Ym.unavailable)(["getIntersectingTables/getOrCreateSnapshot"]))];if(u=o.allServerAvailable(t),u.kind!==Uo.ResultKind.Success)return[2,(0,Uo.failure)((0,Ym.unavailable)(["getIntersectingTables/allServerAvailable"]))];if(s=o.getIntersectingTables(t),!(0,Uo.isSuccess)(s))return[2,(0,Uo.failure)((0,Ym.unavailable)(["getIntersectingTables/getIntersectingTables"]))];for(l=[],c=function(k){var q=o.getNamedObject(k,e2.NameSource.Plain);if(q.kind!==Uo.ResultKind.Success)return{value:q};if(((a=q.value)===null||a===void 0?void 0:a.kind)!=="NamedTable")return"continue";var V=[];q.value.columnIndexes.forEach(function(I,M){return V.push({column:I,name:M}),!0}),l.push({name:k.name,dataRange:q.value.specialRefRanges[cPr.SpecialRefId.Data].range,hasHeadersRow:q.value.hasHeadersRow,hasTotalsRow:q.value.hasTotalsRow,columns:V})},d=0,f=s.value;d<f.length;d++)if(m=f[d],v=c(m),typeof v=="object")return[2,v.value];return h=(0,zN.createCellSetFromRange)(t.range),y=u.value===!0?h:(0,Tee.exceptProduct)(h,u.value),_=[],(0,zN.forEachRangeInSet)(y,function(N){return _.push(N),!0}),[2,(0,Uo.success)({tables:l,availableRanges:_})]}})})},e.prototype.getIformats=function(r,t,n,a){var o;return cu.__awaiter(this,void 0,void 0,function(){var u,s;return cu.__generator(this,function(l){switch(l.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return u=((o=l.sent())!==null&&o!==void 0?o:{snapshot:void 0}).snapshot,u===void 0?[2,(0,Uo.failure)((0,Ym.unavailable)(["getIformats/getOrCreateSnapshot"]))]:(s=u.getIformats(t,n,a),(0,Uo.isSuccess)(s)?[2,(0,Uo.success)({availableFormats:s.value})]:[2,(0,Uo.failure)((0,Ym.unavailable)(["getIformats/getIntersectingTables"]))])}})})},e.prototype.getHiddenRows=function(r,t,n,a){var o;return cu.__awaiter(this,void 0,void 0,function(){var u;return cu.__generator(this,function(s){switch(s.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return u=((o=s.sent())!==null&&o!==void 0?o:{snapshot:void 0}).snapshot,u===void 0?[2,r2.hiddennessFullyUnavailable]:[2,u.getHiddenRows(t,n,a)]}})})},e.prototype.getHiddenCols=function(r,t,n,a){var o;return cu.__awaiter(this,void 0,void 0,function(){var u;return cu.__generator(this,function(s){switch(s.label){case 0:return[4,this.getOrCreateSnapshot(r)];case 1:return u=((o=s.sent())!==null&&o!==void 0?o:{snapshot:void 0}).snapshot,u===void 0?[2,r2.hiddennessFullyUnavailable]:[2,u.getHiddenCols(t,n,a)]}})})},e}();HC.RecalcSideGrid=dPr;function ENe(e,r){return e.map(function(t){if(!(0,YR.isDefined)(t.data))return{data:void 0,range:(0,XR.sheetGridRangeToLocation)(t.range)};var n=(0,XR.readOperToCellValue)(r,t.data.value);return{data:{kind:t.data.kind,formulaBarText:t.data.formulaBarText,value:n??lPr.blankValue,iformat:t.data.iformat,failureReason:n===void 0?"unsupported Oper serialization":void 0},range:(0,XR.sheetGridRangeToLocation)(t.range)}})}HC.convertX10UpdatesToCalcUpdates=ENe;function PNe(e,r){return e.map(function(t){var n=t.range,a=n[0],o=n.slice(1),u=cu.__spreadArray([(0,XR.sheetGridRangeToLocation)(a)],o.map(function(s){return(0,XR.sheetGridRangeToLocation)(s)}),!0);return{kind:t.kind,range:u,formulaBarText:t.formulaBarText,value:(0,YR.isDefined)(t.value)?(0,XR.readOperToCellValue)(r,t.value):void 0,origin:(0,YR.isDefined)(t.origin)?(0,XR.gridCellToCellLocation)(t.origin):void 0}})}HC.convertX10RangeFormulaEditsToCalcRangeFormulaEdits=PNe;function fPr(e){if(e.value.kind===Uo.ResultKind.Failure&&e.value.reason.kind===uPr.ReasonKind.Unavailable)for(var r=e.value.reason.objects,t=0;t<r.length;t++){var n=r[t];n.kind===Ree.UnavailableKind.GridRange&&(r[t]=cu.__assign(cu.__assign({},n),{unavailableCells:!0}))}return e}});var V4=T(QN=>{"use strict";p();var Eee;Object.defineProperty(QN,"__esModule",{value:!0});QN.recalcServiceInsideInit=QN.RecalcServiceImpl=void 0;var i2=fe(),pPr=i2.__importStar(sy()),Fu=nl(),Nu=Ar(),mPr=GM(),n2=No(),zC=r_(),G4=Zc(),B4=R4(),gPr=n_(),mo=Ss(),ANe=_y(),U4=qi(),FNe=Mh(),NNe=Pf(),Mf=Ba(),vPr=uv(),hPr=dee(),du=RR(),SPr=jR(),yPr=Hf(),_Pr=jI(),bPr=eNe(),a2=zn(),CPr=Ms(),TPr=rNe(),RPr=mee(),Co=IR(),Pee=wR(),ONe=hc(),EPr=t2(),K4=10,PPr=function(){function e(r,t,n){this.onRecalcResults=r,this.onUpdateRequest=t,this.currentOutputStateId=n,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}return e.prototype.setOutputStateId=function(r){r<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=r)},e.prototype.pushCellWrite=function(r,t){(r!==mo.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(r,t){(0,Nu.safePush)(r!==mo.ComputedCellKind.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)},e.prototype.pushRangeFailure=function(r,t){(r!==mo.ComputedCellKind.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)},e.prototype.pushUpdateRequest=function(r){this.rangeUpdateRequests.push(r)},e.prototype.pushUpdateNameRequest=function(r){this.namesUpdateRequests.push(r.index)},e.prototype.pushRecalcFinished=function(r){this.recalcFinished=this.recalcFinished||r},e.prototype.isRecalcFinished=function(){return this.recalcFinished},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest((0,zC.updateRequest)(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults((0,zC.recalcResults)(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)},e.prototype.sendRecalcResults=function(r,t,n,a){for(var o=0;o<(0,Nu.fastMax)((0,Nu.fastMax)(t.length,n.length),a.length);o+=K4)this.onRecalcResults((0,zC.recalcResults)(this.currentOutputStateId,r,!1,t.slice(o,o+K4),n.slice(o,o+K4),a.slice(o,o+K4)))},e}();function Aee(e){var r=e.kind;return{kind:r}}var kNe=function(){function e(r,t,n,a,o,u,s){u===void 0&&(u={}),s===void 0&&(s="Local");var l=this;this.onRecalcResults=r,this.onUpdateRequest=t,this.onGC=n,this.onAlert=a,this.asyncLoopFactory=o,this.twConfig=u,this.dataTransformer=new Pee.RecalcServiceDataTransformer,this.currentInputStateId=-(1/0),this.currentOutputStateId=-(1/0),this.lastRecalcStatsStateId=-(1/0),this.recalcStatistics=mo.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.initCalcThreadInside=function(c,d,f){return i2.__awaiter(l,void 0,void 0,function(){return i2.__generator(this,function(m){return[2,(0,mPr.initCalcInThread)(c,d,f,this.twConfig)]})})},this.setConfig({}),this.dataModel=new B4.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config)}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mathpack",{get:function(){return this.dataTransformer.getLangConfig().mathpack},enumerable:!1,configurable:!0}),e.prototype.ping=function(){},e.prototype.setInputStateId=function(r,t){var n=r-this.currentInputStateId;return n<0?(this.logInputStateIdDecrease(t),!1):(n!==0&&(this.flushInputLogs(),this.currentInputStateId=r),!0)},e.prototype.setOutputStateId=function(r){var t=r-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(t!==0&&(this.flushOutputLogs(),this.currentOutputStateId=r),!0)},e.prototype.clearAsyncResumeRecalc=function(){this.recalcLoop!==void 0&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var r=this;this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=this.asyncLoopFactory(function(){var n=r.dataModel.step(),a=n.messages,o=n.queueEmpty;return a.length>0&&r.processRecalcResults(a),o?void 0:1},{costThreshold:1,timeThreshold:this.config.yieldIntervalMs});var t=this.recalcLoop;return(0,SPr.promiseFinally)(this.recalcLoop.promise,function(){r.recalcLoop===t&&(r.recalcLoop=void 0)})},e.prototype.testResumeRecalc=function(r){return i2.__awaiter(this,void 0,void 0,function(){var t;return i2.__generator(this,function(n){switch(n.label){case 0:return[4,this.resumeRecalc()];case 1:return n.sent(),r!==void 0&&(t="calc.calc.RecalcService: resumeRecalc finished; resumeId = ".concat(r),Mf.ulsLogger.ULS.traceTag(574128980,Fu.LogCategory.msoulscat_ES_EWAJS,Fu.TraceLevel.Info,t)),[2]}})})},e.prototype.processRecalcResults=function(r){for(var t=new PPr(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),n=0,a=r;n<a.length;n++){var o=a[n];if(o.kind===mo.OutputMessageKind.GarbageCollected){this.onGC(o.minStateIdKept);continue}if(o.kind===mo.OutputMessageKind.Alert){this.onAlert(o.message);continue}if(o.kind===mo.OutputMessageKind.ExperimentRunResult){this.logExperimentRunResult(o.experimentName,JSON.stringify({message:o.logMessage,timeoutReason:o.timeoutReason}));continue}if(this.setOutputStateId(o.stateId))switch(t.setOutputStateId(o.stateId),o.kind){case mo.OutputMessageKind.CellWrite:{var u=o.cell,s=o.value,l=o.format,c=o.cellKind,d=o.formulaBarText,f=o.formatted,m=o.hasHyperlink,v=u.sheet,h=u.range,y=this.cellWriteToRangeDelta(v.index,h.row,h.col,s,l,d,f,m,"messages.<index>.value");(0,Nu.isDefined)(y)&&t.pushCellWrite(c,y);break}case mo.OutputMessageKind.RangeWrite:{var _=o.range,E=o.values,c=o.cellKind,d=o.formulaBarText,f=o.formatted,N=o.formats,v=_.sheet,h=_.range;t.pushRangeWrite(c,this.rangeWriteToRangeDeltas(v.index,h,E,N,d,f,"messages.<index>.values"));break}case mo.OutputMessageKind.NameFailure:this.nameFailures.push(o);break;case mo.OutputMessageKind.RangeFailure:{var _=o.range,c=o.cellKind,k=o.reason;t.pushRangeFailure(c,this.rangeFailure(_,k)),this.rangeFailures.push(o);break}case mo.OutputMessageKind.NumberFormatFailure:this.numberFormatFailures.push(o);break;case mo.OutputMessageKind.PrintFormulaFailure:this.printFormulaFailures.push(o);break;case mo.OutputMessageKind.InferFormatFailure:this.inferFormatFailures.push(o);break;case mo.OutputMessageKind.FormatValueFailure:{var _=o.range,c=o.cellKind,k=o.reason;t.pushRangeFailure(c,this.rangeFailure(_,k)),this.formatValueFailures.push(o);break}case mo.OutputMessageKind.UnhandledFailure:this.unhandledFailures.push(o);break;case mo.OutputMessageKind.UpdateRequest:t.pushUpdateRequest((0,Co.sheetGridRangeToLocation)(o.range));break;case mo.OutputMessageKind.UpdateNamesRequest:t.pushUpdateNameRequest(o.scope);break;case mo.OutputMessageKind.RecalcStatistics:t.pushRecalcFinished(o.message===mo.RecalcStatisticsMessage.RecalcFinished),this.recalcStatistics=(0,mo.mergeRecalcStatistics)(this.recalcStatistics,o);break;case mo.OutputMessageKind.WorkbookStatistics:this.logWorkbookStats(o.stateId,o.stats,o.p);break;case mo.OutputMessageKind.StateAdvanced:break;default:return(0,Mf.assertNever)("calc.calc.RecalcServiceImpl.processRecalcResults",o)}}t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()},e.prototype.logExperimentRunResult=function(r,t){Mf.ulsLogger.ULS.traceTag(594409422,Fu.LogCategory.msoulscat_ES_EWAJS,Fu.TraceLevel.Info,"calc.calc.RecalcService: ".concat(r," done; ").concat(t)),r==="UnitExperiment"&&Mf.ulsLogger.ULS.traceTag(538567681,Fu.LogCategory.msoulscat_ES_EWAJS,Fu.TraceLevel.Info,"calc.calc.RecalcService: UnitExperiment done: ".concat(t))},e.prototype.logAllFailureStats=function(){var r=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var n=this.numberFormatFailures;this.numberFormatFailures=[];var a=this.printFormulaFailures;this.printFormulaFailures=[];var o=this.inferFormatFailures;this.inferFormatFailures=[];var u=this.formatValueFailures;this.formatValueFailures=[];var s=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(r,595194337,"name",Fu.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",Fu.TraceLevel.Info),this.logGenFailureStats(n,590484946,"format",Fu.TraceLevel.Info),this.logGenFailureStats(a,592730065,"print-formula",Fu.TraceLevel.Info),this.logGenFailureStats(o,590484947,"infer-format",Fu.TraceLevel.Info),this.logCellFailureStats(u,590484948,"format-value",Fu.TraceLevel.Info),this.logGenFailureStats(s,595194338,"unhandled",Fu.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(r,t,n,a){if(r.length!==0){for(var o={},u=0,s=r;u<s.length;u++){var l=s[u].reason;(0,Pee.incrementFailure)(o,l)}var c="calc.calc.RecalcService: recalc ".concat(n," failures; stateId = ").concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(o));Mf.ulsLogger.ULS.traceTag(t,Fu.LogCategory.msoulscat_ES_EWAJS,a,c),this.logJavaScriptFailures(r,n)}},e.prototype.logCellFailureStats=function(r,t,n,a){var o=this,u;if(r.length!==0){for(var s={},l=0,c=r;l<c.length;l++){var d=c[l],f=d.reason,m=d.cellKind,v=(u=s[m])!==null&&u!==void 0?u:s[m]={};(0,Pee.incrementFailure)(v,f)}Object.getOwnPropertyNames(s).sort().forEach(function(h){var y=s[h],_="calc.calc.RecalcService: recalc ".concat(n," failures; stateId = ").concat(o.currentOutputStateId,", cell kind = ").concat(h,", stats = ").concat(JSON.stringify(y));Mf.ulsLogger.ULS.traceTag(t,Fu.LogCategory.msoulscat_ES_EWAJS,a,_)}),this.logJavaScriptFailures(r,n)}},e.prototype.logJavaScriptFailures=function(r,t){for(var n=0,a=r;n<a.length;n++){var o=a[n].reason;if(o.kind===vPr.ReasonKind.JavaScriptError){var u=(0,yPr.messageFromError)(o.error),s="calc.calc.RecalcService: recalc ".concat(t," JavaScript error: ").concat(u);Mf.ulsLogger.ULS.traceTag(595658721,Fu.LogCategory.msoulscat_ES_EWAJS,Fu.TraceLevel.Warning,s)}}},e.prototype.logIgnoredStats=function(r,t,n,a){if(Object.getOwnPropertyNames(a).length!==0){var o="stateId = ".concat(t,", stats = ").concat(JSON.stringify(a)),u="calc.calc.RecalcService: ignored ".concat(n," data; ").concat(o);Mf.ulsLogger.ULS.traceTag(r,Fu.LogCategory.msoulscat_ES_EWAJS,Fu.TraceLevel.Warning,u)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-(1/0)&&!(this.lastRecalcStatsStateId===this.currentOutputStateId&&this.recalcStatistics===mo.emptyRecalcStatistics)){var r=this.recalcStatistics;this.recalcStatistics=mo.emptyRecalcStatistics,this.lastRecalcStatsStateId=this.currentOutputStateId;var t=this.config.sampleRecalcStatisticsRate;if(this.dataModel.shouldSample(t)){var n="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(r),", p = ").concat(JSON.stringify(t)),a="calc.calc.RecalcService: recalc statistics; ".concat(n);Mf.ulsLogger.ULS.traceTag(595654593,Fu.LogCategory.msoulscat_ES_EWAJS,Fu.TraceLevel.Info,a)}}},e.prototype.logUnavailableStats=function(){if(this.currentOutputStateId!==-(1/0)&&this.rangeFailures.length!==0){var r=(0,bPr.computeUnavailableCellsStats)(this.rangeFailures);if(!(r.numOfUnavailableCellsInTheSameSheet===0&&r.numOfUnavailableCellsInDifferentSheet===0&&r.totalNumOfUnavailableCells===0)){var t="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(r)),n="calc.calc.RecalcService: unavailable cells statistics; ".concat(t);Mf.ulsLogger.ULS.traceTag(589632004,Fu.LogCategory.msoulscat_ES_EWAJS,Fu.TraceLevel.Info,n)}}},e.prototype.logWorkbookStats=function(r,t,n){var a="stateId = ".concat(r,", stats = ").concat(JSON.stringify(t),", p = ").concat(JSON.stringify(n)),o="calc.calc.RecalcService: workbook statistics; ".concat(a);Mf.ulsLogger.ULS.traceTag(595359882,Fu.LogCategory.msoulscat_ES_EWAJS,Fu.TraceLevel.Info,o)},e.prototype.logInputStateIdDecrease=function(r){(0,du.incrementStat)(this.ignoredInputStats,"".concat(r,": input stateId went backwards"))},e.prototype.logOutputStateIdDecrease=function(){(0,du.incrementStat)(this.ignoredOutputStats,"output stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()},e.prototype.cellWriteToRangeDelta=function(r,t,n,a,o,u,s,l,c){if((0,du.check)(a,du.chReadOper,this.ignoredOutputStats,c)){var d=(0,Co.readOperToCellValue)(this.mathpack,a),f=(0,Co.cellFormatToInferredFormat)(o);return(0,Nu.isDefined)(u)||(0,Nu.isDefined)(d)||(0,Nu.isDefined)(f)||(0,Nu.isDefined)(s)||(0,Nu.isDefined)(l)?(0,zC.rangeDelta)((0,zC.sheetRangeLocation)(r,t,n),(0,zC.cellDataDelta)(u,d,f,s,l)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(r,t,n,a,o,u,s){for(var l="".concat(s,".<index>.<index>"),c=t.row,d=t.col,f=t.rows,m=t.cols,v=[],h=0;h<f;h+=1)for(var y=0;y<m;y+=1){var _=this.cellWriteToRangeDelta(r,c+h,d+y,n[h][y],a[h][y],h===0&&y===0?o:void 0,u[h][y],void 0,l);(0,Nu.isDefined)(_)&&v.push(_)}return v},e.prototype.rangeFailure=function(r,t){return(0,zC.rangeFailure)((0,Co.sheetGridRangeToLocation)(r),Aee(t))},e.prototype.setA1ReferenceStyle=function(r){this.clearAsyncResumeRecalc(),this.dataTransformer.setA1ReferenceStyle(this.dataModel,this.currentInputStateId,r)},e.prototype.setLocale=function(r){this.clearAsyncResumeRecalc(),this.dataTransformer.setLocaleInfo(this.dataModel,this.currentInputStateId,r,this.ignoredInputStats)},e.prototype.setWorkbookProps=function(r){this.clearAsyncResumeRecalc(),this.dataTransformer.setWorkbookProps(this.dataModel,this.currentInputStateId,r,this.ignoredInputStats)},e.prototype.setNumberFormats=function(r,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,(0,du.filterCheck)(r,du.chNumberFormat,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.updateSheetNames=function(r,t){this.setInputStateId(r,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateSheetNames(this.dataModel,r,t,this.ignoredInputStats))},e.prototype.updateNamedObjects=function(r,t){this.setInputStateId(r,"namedObjectsUpdates")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateNamedObjects(this.dataModel,r,t,this.ignoredInputStats))},e.prototype.updateUnusedCells=function(r,t){if(this.setInputStateId(r,"unusedCellsUpdates")){this.clearAsyncResumeRecalc();for(var n=(0,du.filterCheck)(t,du.chUnusedCellsUpdate,this.ignoredInputStats,"unusedCellsUpdates"),a=0,o=n;a<o.length;a++){var u=o[a];this.dataModel.extendUnusedRange((0,Co.unusedCellsUpdateToUsedRange)(this.document,u),r)}}},e.prototype.updateRanges=function(r,t){this.setInputStateId(r,"rangeUpdates")&&(this.clearAsyncResumeRecalc(),this.applyRangeUpdates(r,t))},e.prototype.updateArrays=function(r,t){if(this.setInputStateId(r,"arrayUpdates")){this.clearAsyncResumeRecalc();for(var n=(0,du.filterCheck)(t,du.chArrayUpdate,this.ignoredInputStats,"arrayUpdates"),a=0,o=n;a<o.length;a++){var u=o[a],s=u.range,l=u.data,c=u.fromStateId,d=(0,Co.sheetRangeLocationToGridRange)(this.document,s);if((0,Nu.isDefined)(l)){var f=l.formulaBarText,m=l.isSpilled,v=(0,U4.gridRangeAnchor)(d.range);this.dataModel.writeArrayFormula(r,d,f,v,m)}else(0,Nu.isDefined)(c)}}},e.prototype.editRangeFormulas=function(r,t){this.setInputStateId(r,"rangeFormulaEdits")&&(this.clearAsyncResumeRecalc(),this.applyRangeFormulaEdits(t,r))},e.prototype.evalOnClonedModel=function(r,t,n){return this.evalOnClonedModelOnSnapshot(r,t,void 0,n)},e.prototype.evalOnClonedModelOnSnapshot=function(r,t,n,a){n===void 0&&(n=void 0),(0,Mf.assertPositiveInteger)("edits array should not be empty",t.length);var o=n===void 0?new B4.EvalOnClonePropsFromPartialWB(this.dataModel,a):new B4.EvalOnClonePropsFromPartialWBDocumentCollection(n,a);return this.applyRangeUpdates(-1,r,o),this.applyRangeFormulaEdits(t,-1,o),o.resultsPromise.toPromise()},e.prototype.applyRangeUpdates=function(r,t,n){for(var a,o,u=(0,du.filterCheck)(t,du.chRangeUpdate,this.ignoredInputStats,"rangeUpdates"),s=0,l=u;s<l.length;s++){var c=l[s],d=c.range,f=c.excludeRows,m=c.excludeColumns,v=c.data,h=c.fromStateId,y=(0,Co.sheetRangeLocationToGridRange)(this.document,d),_=y.range,E=(0,Co.createExcludeCellSet)(_.row,_.rows,G4.bspFactory.row,f),N=(0,Co.createExcludeCellSet)(_.col,_.cols,G4.bspFactory.col,m),k=(0,Co.sheetGridRangeToCellSet)(y,E,N),q=(0,Nu.isDefined)(v)?(0,Co.cellValueToReadOper)(this.mathpack,v.value):ANe.blankOper;(0,Mf.assertTrue)("calc.calc.RecalcService: updateRanges oper",q!=null);var V=(0,U4.gridRangeAnchor)(_);if((0,Nu.isDefined)(v)){var I=v.iformat,M=v.kind==="ArrayFormula"?void 0:(a=v.formulaBarText)!==null&&a!==void 0?a:void 0,B=(o=v.failureReason)!==null&&o!==void 0?o:void 0,U=v.kind==="CellFormula";this.dataModel.writeCellContents(r,k,M,U,V,q,I,mo.SpecialStyle.Blank,B,n)}else if((0,Nu.isNone)(h))this.dataModel.writeCellContents(r,k,"",!1,V,ANe.blankOper,gPr.blankCellFormat,void 0,void 0,n);else{if(n)throw new Error("Promote cell data is unsupported for cloned models.");this.dataModel.promoteCellContents(r,y,k,h)}n||(this.dataModel.writeHiddenRows(r,(0,Co.sheetGridRangeToHiddenRows)(y,E)),this.dataModel.writeHiddenCols(r,(0,Co.sheetGridRangeToHiddenCols)(y,N)))}},e.prototype.localizeEnglishFormula=function(r,t){var n=this.dataModel.translateEnglishFormula(r,(0,Co.sheetCellLocationToGridCell)(this.document,t));return Promise.resolve(n)},e.prototype.applyRangeFormulaEdits=function(r,t,n){for(var a=this,o=(0,du.filterCheck)(r,du.chRangeFormulaEdit,this.ignoredInputStats,"rangeFormulaEdits"),u=function(m){var v=m.kind,h=m.range,y=m.formulaBarText,_=m.value,E=m.origin,N=m.viewport,k=FNe.empty;h.forEach(function(U){k=(0,NNe.unionProduct)(k,(0,G4.createCellSetFromRange)((0,Co.sheetRangeLocationToGridRange)(a.document,U).range))});var q=(0,Co.sheetRangeLocationToGridRange)(s.document,h[0]),V=(0,Nu.isDefined)(E)?(0,n2.gridCell)(E.row,E.column):(0,U4.gridRangeAnchor)(q.range),I=(0,Nu.isDefined)(N)?(0,Co.sheetRangeLocationToGridRange)(s.document,N):void 0,M=void 0;(0,Nu.isDefined)(_)?(M=(0,Co.cellValueToReadOper)(s.mathpack,_),(0,Mf.assertTrue)("calc.calc.RecalcService: editRangeFormulas oper",M!=null)):M=void 0;var B=v==="CellFormula"?!0:v==="Value"?!1:void 0;n?s.dataModel.editCellContentsOnClone((0,mo.sheetCellSet)(q.sheet,k),y,B,V,n):s.dataModel.editCellContents(t,(0,mo.sheetCellSet)(q.sheet,k),y,B,V,M,I)},s=this,l=0,c=o;l<c.length;l++){var d=c[l];u(d)}},e.prototype.editRangeFormats=function(r,t){var n=this;if(this.setInputStateId(r,"rangeFormatEdits")){this.clearAsyncResumeRecalc();for(var a=(0,du.filterCheck)(t,du.chRangeFormatEdit,this.ignoredInputStats,"rangeFormatEdits"),o=function(f){var m=f.range,v=f.operation,h=f.origin,y=f.viewport,_=v.kind==="SetFormat"&&!(0,Nu.isNone)(v.format)?{kind:v.kind,format:v.format}:v.kind==="RibbonFormat"&&!(0,Nu.isNone)(v.ribbon)?{kind:v.kind,ribbon:v.ribbon}:v.kind==="ChangeDecimals"&&!(0,Nu.isNone)(v.changeDecimals)?{kind:v.kind,changeDecimals:v.changeDecimals}:void 0;(0,Mf.assertTrue)("calc.calc.RecalcService: editRangeFormats operation",_!=null);var E=FNe.empty;m.forEach(function(V){E=(0,NNe.unionProduct)(E,(0,G4.createCellSetFromRange)((0,Co.sheetRangeLocationToGridRange)(n.document,V).range))});var N=(0,Co.sheetRangeLocationToGridRange)(u.document,m[0]),k=h!=null?(0,n2.gridCell)(h.row,h.column):(0,U4.gridRangeAnchor)(N.range),q=(0,Nu.isDefined)(y)?(0,Co.sheetRangeLocationToGridRange)(u.document,y):void 0;u.dataModel.editCellFormats(r,(0,mo.sheetCellSet)(N.sheet,E),_,k,q)},u=this,s=0,l=a;s<l.length;s++){var c=l[s];o(c)}}},e.prototype.editArrayFormulas=function(r,t){if(this.setInputStateId(r,"arrayFormulaEdits")){this.clearAsyncResumeRecalc();for(var n=(0,du.filterCheck)(t,du.chArrayFormulaEdit,this.ignoredInputStats,"arrayFormulaEdits"),a=0,o=n;a<o.length;a++){var u=o[a],s=u.range,l=u.formulaBarText,c=u.origin,d=u.viewport,f=(0,Co.sheetRangeLocationToGridRange)(this.document,s),m=(0,Nu.isDefined)(c)?(0,n2.gridCell)(c.row,c.column):(0,n2.gridCell)(s.row,s.column),v=(0,Nu.isDefined)(d)?(0,Co.sheetRangeLocationToGridRange)(this.document,d):void 0;this.dataModel.editArrayFormula(r,f,l,m,v)}}},e.prototype.editRangePaste=function(r,t){if(this.setInputStateId(r,"editRangePaste")){this.clearAsyncResumeRecalc();for(var n=(0,du.filterCheck)(t,du.chPasteEdit,this.ignoredInputStats,"pasteEdits"),a=0,o=n;a<o.length;a++){var u=o[a],s=u.kind,l=u.source,c=u.target,d=u.viewport,f=(0,Co.sheetRangeLocationToGridRange)(this.document,l),m=(0,Co.sheetCellLocationToGridCell)(this.document,c),v=(0,Nu.isDefined)(d)?(0,Co.sheetRangeLocationToGridRange)(this.document,d):void 0;this.dataModel.editPaste(r,s,m,f,v)}}},e.prototype.setConfig=function(r){var t,n,a,o,u,s,l,c,d,f,m,v,h=Array.isArray(r.runExperiments)?{stepBudget:(t=r.experimentStepBudget)!==null&&t!==void 0?t:10,totalBudget:(n=r.experimentTotalBudget)!==null&&n!==void 0?n:1e4,factories:(0,_Pr.getExperimentFactories)(r.runExperiments)}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:(a=r.totalEvalTimeMs)!==null&&a!==void 0?a:1e4,maxCellChain:2*n2.sheetCols,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:(o=r.samplePrecisionEvalRate)!==null&&o!==void 0?o:.02,samplePrecisionPrintFormulaRate:(u=r.samplePrecisionPrintFormulaRate)!==null&&u!==void 0?u:.001,samplePrecisionPrintValueRate:(s=r.samplePrecisionPrintValueRate)!==null&&s!==void 0?s:1e-4,sampleRecalcStatisticsRate:(l=r.sampleRecalcStatisticsRate)!==null&&l!==void 0?l:.2,sampleWorkbookStatisticsRate:(c=r.sampleWorkbookStatisticsRate)!==null&&c!==void 0?c:.1,sampleCellEvalStopwatchRate:(d=r.sampleCellEvalStopwatchRate)!==null&&d!==void 0?d:.003,sampleRecalcEditedStopwatchRate:(f=r.sampleRecalcEditedStopwatchRate)!==null&&f!==void 0?f:1,sampleRecalcViewportStopwatchRate:(m=r.sampleRecalcViewportStopwatchRate)!==null&&m!==void 0?m:1,rngSeed:(v=r.rngSeed)!==null&&v!==void 0?v:Date.now()*1e3,volatileMode:r.volatileMode!=null?ONe.VolatileMode[r.volatileMode]:ONe.VolatileMode.Estimation,experimentFactories:h}},e.prototype.reconfigure=function(r){this.setConfig(r),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new B4.PartialWorkbook(this.dataTransformer.getLangConfig(),this.config),this.recalcStatistics=mo.emptyRecalcStatistics,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-(1/0)},e.prototype.evalFormula=function(r,t,n,a){var o=this;return(0,du.check)(n,du.chSheetCellLocation,this.ignoredInputStats,"origin")?(0,du.check)(a,du.chEvalFormulaFormat,this.ignoredInputStats,"format")?this.dataModel.evalFormula(r,t,(0,Co.sheetCellLocationToGridCell)(this.document,n),(0,Co.evalFormulaFormatToUnion)(a)).then(function(u){var s=u.value,l=u.formatted,c;if((0,a2.isSuccess)(s)){if(!(0,du.check)(s.value,du.chReadOper,o.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");var d=(0,Co.readOperToCellValue)(o.mathpack,s.value);(0,Mf.assertTrue)("calc.calc.RecalcService.evalFormula",d!==void 0),c=(0,a2.success)(d)}else c=(0,a2.failure)(Aee(s.reason));var f;return l===void 0?f=void 0:(0,a2.isSuccess)(l)?f=l:f=(0,a2.failure)(Aee(l.reason)),(0,zC.evalFormulaData)(c,f)}):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))},e.prototype.evalFormulaOnSnapshotImpl=function(r,t,n,a){return this.dataModel.evalFormula(-1,r,t,n,a)},e.prototype.testAdvanceState=function(r){this.setInputStateId(r,"testAdvanceState")&&(this.dataModel.testAdvanceState(r),this.clearAsyncResumeRecalc())},e.prototype.getMissingJSFeatures=function(){return(0,RPr.getMissingJSFeatures)()},e}();QN.RecalcServiceImpl=kNe;var APr=(0,TPr.mixin)(kNe,function(e){return new EPr.RecalcSideGrid(e)},["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","getIntersectingTables","getIformats","discardSnapshot","createIGridExportEndpoint","getHiddenRows","getHiddenCols","evalFormulaOnSnapshot","evalClonedModelOnSnapshot","getCorrespondingSnapshotID"]);if((0,CPr.getTypedFeatureGate)("TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL")&&(self.__retries=((Eee=self.__retries)!==null&&Eee!==void 0?Eee:-1)+1,self.__retries===0))throw"";var FPr=function(r){var t=r.config,n=r.connection;return pPr.Endpoint.createInside(n,function(a){return new APr(function(){for(var o,u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];return(o=a.post).onRecalcResults.apply(o,u)},function(){for(var o,u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];return(o=a.post).onUpdateRequest.apply(o,u)},function(){for(var o,u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];return(o=a.post).onGC.apply(o,u)},function(){for(var o,u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];return(o=a.post).onAlert.apply(o,u)},hPr.asyncLoop,t,n.createMode)})};QN.recalcServiceInsideInit=FPr});var Kh=T(j4=>{"use strict";p();Object.defineProperty(j4,"__esModule",{value:!0});j4.NotificationKind=void 0;var NPr=v_();j4.NotificationKind=NPr.notificationKinds.NotificationKind});var Nee=T(QC=>{"use strict";p();Object.defineProperty(QC,"__esModule",{value:!0});QC.SyncDataModel=QC.MaxStateIdDifferenceForGC=void 0;var W4=fe(),OPr=wR(),kPr=IR(),H4=r_(),MPr=f$(),xPr=c$(),MNe=No(),Cv=zn(),Fee=qi(),XN=Kh(),IPr=function(){};QC.MaxStateIdDifferenceForGC=17;var wPr=function(){function e(){this.dataTransformer=new OPr.RecalcServiceDataTransformer,this.stateId=-(1/0),this.stateChangesSinceLastGC=0,this.config=this.dataTransformer.getLangConfig(),this.configNotifications=[],this.sheets=new MPr.PartialWorkbookSheets(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.nameManager=new xPr.PartialWorkbookNameManager(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.schedulerFeatures=[]}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),e.prototype.getStateAsNotifications=function(){return W4.__spreadArray(W4.__spreadArray(W4.__spreadArray(W4.__spreadArray([],this.configNotifications,!0),this.getSheetStateAsNotifications(),!0),this.getNameStateAsNotifications(),!0),this.getSchedulerFeaturesAsNotifications(),!0)},e.prototype.getSchedulerFeaturesAsNotifications=function(){return[[XN.NotificationKind.setSchedulerFeatures,[this.schedulerFeatures]]]},e.prototype.getSheetStateAsNotifications=function(){var r=[];return this.sheets.forEachSheet(function(t,n){r.push((0,H4.sheetName)(n,t.name))}),r.length>0?[[XN.NotificationKind.updateSheetNames,[this.stateId,r]]]:[]},e.prototype.getNameStateAsNotifications=function(){var r=this,t=[],n=function(u){var s=[];u.forEachAvailableName(function(l,c){var d=(0,kPr.namedObjectToNamedObjectData)(r.config.mathpack,r.dataTransformer.document,c==null?void 0:c.obj);return s.push((0,H4.namedObject)(l,d)),!0}),s.length>0&&t.push((0,H4.namedObjectsWrite)(u.scope.index,s)),u.allAvailable()&&t.push((0,H4.undefinedNamesWrite)(u.scope.index))},a=this.nameManager.getNamesBySheetId(void 0);return(0,Cv.isSuccess)(a)&&n(a.value),this.nameManager.forEachSheetScope(function(o){n(o)}),t.length>0?[[XN.NotificationKind.updateNamedObjects,[this.stateId,t]]]:[]},e.prototype.trySetStateId=function(r,t){if(t<this.stateId)return!1;if(t>this.stateId){var n=this.stateId;if(this.stateId=t,this.sheets.advanceState(n),this.nameManager.advanceState(n),this.stateChangesSinceLastGC+=1,this.stateChangesSinceLastGC>=QC.MaxStateIdDifferenceForGC){this.stateChangesSinceLastGC=0;var a=this.stateId-QC.MaxStateIdDifferenceForGC;this.nameManager.collectGarbage(a)}}return!0},e.prototype.clearCompiledFormulas=function(){this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){},e.prototype.setA1ReferenceStyle=function(r){this.configNotifications.push([XN.NotificationKind.setA1ReferenceStyle,[r]]),this.dataTransformer.setA1ReferenceStyle(this,this.stateId,r)},e.prototype.setLocale=function(r){this.configNotifications.push([XN.NotificationKind.setLocale,[r]]);var t={};this.dataTransformer.setLocaleInfo(this,this.stateId,r,t)},e.prototype.setWorkbookProps=function(r){this.configNotifications.push([XN.NotificationKind.setWorkbookProps,[r]]);var t={};this.dataTransformer.setWorkbookProps(this,this.stateId,r,t)},e.prototype.updateSheetNames=function(r,t){var n={};this.dataTransformer.updateSheetNames(this,r,t,n)},e.prototype.updateNamedObjects=function(r,t){var n={};this.dataTransformer.updateNamedObjects(this,r,t,n)},e.prototype.setSchedulerFeatures=function(r){this.schedulerFeatures=r},e.prototype.setLangConfig=function(r,t){if(this.trySetStateId(!0,r)){var n=this.config.localeInfo!==t.localeInfo,a=this.config.refStyle!==t.refStyle;this.config=t,n&&this.clearCompiledNumberFormats(),(n||a)&&this.clearCompiledFormulas()}},e.prototype.setSheetNames=function(r,t,n){this.trySetStateId(!0,n)&&(this.sheets=this.sheets.setSheetNames(t),this.nameManager=this.nameManager.setSheetNames(t))},e.prototype.writeNamedObject=function(r,t,n,a){if(this.trySetStateId(!0,r)){var o=this.nameManager.setNamedObject(!0,(0,MNe.nameLoc)(t,n),a,IPr);(0,Cv.isSuccess)(o)}},e.prototype.writeUndefinedNames=function(r,t){if(this.trySetStateId(!0,r)){var n=this.nameManager.setUndefinedNames(t);(0,Cv.isSuccess)(n)}},e.prototype.promoteNamedObjects=function(r,t,n){if(this.trySetStateId(!0,r)){var a=this.nameManager.promoteNamedObjects(t,n);(0,Cv.isSuccess)(a)&&a.value}},e.prototype.getDocumentLoc=function(r,t){var n=this.dataTransformer.document;return(r===void 0||r===n.path)&&this.config.localeInfo.stringCompareCI(t,n.name)===0?(0,Cv.success)(n):(0,Cv.failure)((0,Fee.unavailable)([(0,MNe.documentLoc)(r,t)]))},e.prototype.getSheetIndex=function(r,t){var n=this.sheets.getSheetByName(t);return!(0,Cv.isSuccess)(n)||n.value===void 0?n:(0,Cv.success)(n.value.sheetIndex.index)},e.prototype.getSheetName=function(r,t){var n=this.sheets.getSheetById(t);return(0,Cv.isSuccess)(n)?(0,Cv.success)(n.value.name):n},e.prototype.getNameLoc=function(r,t,n){return this.nameManager.getNameLoc(r.index,t,n)},e.prototype.getUserDefinedFuncLoc=function(r,t){return(0,Cv.failure)((0,Fee.notImplemented)(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(r){return this.sheets.getSheetRangeIds(r)},e.prototype.getContainingTable=function(r){return this.nameManager.getContainingTable(r)},e.prototype.getStructRefColumn=function(r,t){return this.nameManager.getStructRefColumn(r,t)},e.prototype.getStructRefSpecialRef=function(r,t){return this.nameManager.getStructRefSpecialRef(r,t)},e.prototype.getTime=function(){return(0,Cv.failure)((0,Fee.unavailable)(["getTime"]))},e}();QC.SyncDataModel=wPr});var kee=T(YN=>{"use strict";p();Object.defineProperty(YN,"__esModule",{value:!0});YN.GridImportManager=YN.GridProvider=void 0;var Oee=fe(),DPr=Oee.__importStar(sy()),xNe=Hf(),INe=nl(),o2=Xp(),LPr=Nee(),qPr=function(){function e(r){var t=this;this.onGridReady=r,this.gridService=void 0,this.syncDataModel=new LPr.SyncDataModel,this.getGridDataSink=function(){},this.getSyncDataModel=function(){return t.syncDataModel}}return e.prototype.getGrid=function(){var r;return(r=this.gridService)===null||r===void 0?void 0:r.call},e.prototype.createIGridImportEndpoint=function(r){return Oee.__awaiter(this,void 0,void 0,function(){var t,n=this;return Oee.__generator(this,function(a){switch(a.label){case 0:return this.onGridExporterClosed(),[4,DPr.Endpoint.createOutside(r,function(o){n.gridService={call:void 0,close:function(){return o.close("Force")}}})];case 1:return t=a.sent(),t.hasBeenClosed()||(this.gridService=t,this.onGridReady(this.gridService.call)),[2]}})})},e.prototype.onGridExporterClosed=function(){if(this.gridService){var r=this.gridService;this.gridService=void 0,r.close()}},e}();YN.GridProvider=qPr;function wNe(e,r,t){var n=new MessageChannel,a=n.port1,o=n.port2;Promise.all([e.createIGridImportEndpoint({port:o,options:t}),r.createIGridExportEndpoint({port:a,options:t},function(){return e.onGridExporterClosed()})]).catch(function(u){o2.x10Logger.log({kind:"failure",payload:{failureKind:o2.X10FailureKind.GridFailure,failureLevel:INe.TraceLevel.Warning,path:"gridProvider.connectGridImporterExporter",description:(0,xNe.messageFromError)(u)}});try{e.onGridExporterClosed()}catch(s){o2.x10Logger.log({kind:"failure",payload:{failureKind:o2.X10FailureKind.GridFailure,failureLevel:INe.TraceLevel.Warning,path:"gridProvider.connectGridImporterExporter",description:"".concat(o2.X10FailureKind.GridFailure,": importer threw ").concat((0,xNe.messageFromError)(s))}})}})}var GPr=function(){function e(r){this.timeout=r,this.exporter=void 0,this.importers=[]}return e.prototype.onGridExporterCreated=function(r){this.exporter=r;for(var t=0,n=this.importers;t<n.length;t++){var a=n[t],o=a.importer,u=a.id;wNe(o,r,{id:u,createTimeout:this.timeout})}},e.prototype.onGridImporterCreated=function(r,t){this.importers.push({importer:r,id:t}),this.exporter&&wNe(r,this.exporter,{id:t,createTimeout:this.timeout})},e}();YN.GridImportManager=GPr});var u2=T(z4=>{"use strict";p();Object.defineProperty(z4,"__esModule",{value:!0});z4.ExecutionType=void 0;var DNe;(function(e){e.Sync="Sync",e.Async="Async"})(DNe||(z4.ExecutionType=DNe={}))});var s2=T(IS=>{"use strict";p();Object.defineProperty(IS,"__esModule",{value:!0});IS.X10TaskInternal=IS.Ref=IS.InitializingSubject=IS.Subject=void 0;var BPr=fe(),UPr=nl(),LNe=Xp(),qNe=function(){function e(){this.subscribers=[],this.currentSubscription=0}return e.prototype.next=function(r){for(var t=0,n=this.subscribers;t<n.length;t++){var a=n[t],o=a[0],u=a[1];u(r)}},e.prototype.subscribe=function(r){return this.subscribers.push([++this.currentSubscription,r]),this.currentSubscription},e.prototype.unsubscribe=function(r){this.subscribers=this.subscribers.filter(function(t){var n=t[0],a=t[1];return n!==r})},e}();IS.Subject=qNe;var KPr=function(e){BPr.__extends(r,e);function r(t){var n=e.call(this)||this;return n.initializeSubscriber=t,n}return r.prototype.subscribe=function(t){var n=e.prototype.subscribe.call(this,t);return this.initializeSubscriber().map(t),n},r}(qNe);IS.InitializingSubject=KPr;var VPr=function(){function e(r){this.value=r}return e}();IS.Ref=VPr;var jPr=function(){function e(r,t){this.maybeThenable=r,this.token=t}return e.createToken=function(){return"Do not use outside of x10 scheduler. Resovle by yielding with an 'AwaitTask' / 'AwaitAll' request"},e.prototype.resolve=function(r){return r!==this.token&&LNe.x10Logger.log({kind:"failure",payload:{failureKind:LNe.X10FailureKind.AssertionFailure,failureLevel:UPr.TraceLevel.Warning,path:"X10TaskInternal.resolve",description:"Task is resolving with an invalid token"}}),this.maybeThenable},e}();IS.X10TaskInternal=jPr});var Xo=T(Va=>{"use strict";p();Object.defineProperty(Va,"__esModule",{value:!0});Va.ResponseState=Va.ExecutionStopReason=Va.FrameExecutionStopReason=Va.SchedulerVersionCompatibility=Va.SchedulerTimelineQueueMessageKind=Va.delay=Va.awaitPromise=Va.typedRequest=Va.makeSyncRequester=Va.makeRequester=Va.RequestKind=Va.recalcNotificationKinds=Va.ComputationRequestKind=Va.DefaultComputationGroup=void 0;var c2=fe(),wS=Ar(),UNe=Ba(),l2=Kh(),WPr=u2(),HPr=GN(),zPr=s2(),QPr=Xp(),XPr=Qm(),YPr=ree();Va.DefaultComputationGroup="";Va.ComputationRequestKind={GetSheetNames:"GetSheetNames",GetRange:"GetRange",Delay:"Delay",GetCell:"GetCell",GetContainingTable:"GetContainingTable",UnsafeGetContainingTableName:"UnsafeGetContainingTableName",GetAvailableTableHeaders:"GetAvailableTableHeaders",GetIntersectingTables:"GetIntersectingTables",UnsafeGetIntersectingTableNames:"UnsafeGetIntersectingTableNames",GetStructRefColumn:"GetStructRefColumn",GetStructRefSpecialRef:"GetStructRefSpecialRef",GetIformat:"GetIformat",ParseCellFormula:"ParseCellFormula",ParseEdit:"ParseEdit",ParseNumberFormat:"ParseNumberFormat",PrintFormula:"PrintFormula",GetActiveCell:"GetActiveCell",GetActiveCellFormat:"GetActiveCellFormat",GetConfig:"GetConfig",GetCultureTag:"GetCultureTag",AwaitPromise:"AwaitPromise",CreateTask:"CreateTask",PromiseToTask:"PromiseToTask",AwaitTask:"AwaitTask",AwaitBatch:"AwaitBatch",AwaitAll:"AwaitAll",AwaitAny:"AwaitAny",GetFunctionsInfo:"GetFunctionsInfo",GetFunctionInfo:"GetFunctionInfo",GetCorrelationId:"GetCorrelationId",SetActiveCell:"SetActiveCell",ParseActiveCell:"ParseActiveCell",GetRichValueFieldListContext:"GetRichValueFieldListContext",GetHiddenRows:"GetHiddenRows",GetHiddenCols:"GetHiddenCols",GetDefinedNamesInfo:"GetDefinedNamesInfo",GetDefinedNameInfo:"GetDefinedNameInfo",ResolveReferences:"ResolveReferences",EvalOnClonedModel:"EvalOnClonedModel",EvalFormula:"EvalFormula",GetCorrespondingSnapshotID:"GetCorrespondingSnapshotID",GetEditFormat:"GetEditFormat",GetFullTableHeadersFromServer:"GetFullTableHeadersFromServer",CreateChatGPTSession:"CreateChatGPTSession",CloseChatGPTSession:"CloseChatGPTSession",SendChatGPTQuery:"SendChatGPTQuery",IsSchedulerFeatureEnabled:"IsSchedulerFeatureEnabled",SendAugLoopSignal:"SendAugLoopSignal",TriggerEvent:"TriggerEvent",AwaitEvent:"AwaitEvent",GetRecognizedRangeTables:"GetRecognizedRangeTables",UpdateSnapshot:"UpdateSnapshot"};(0,wS.staticAssertExtends)();(0,wS.staticAssertExtends)();(0,wS.staticAssertExtends)();(0,wS.staticAssertExtends)();Va.recalcNotificationKinds=[l2.NotificationKind.setA1ReferenceStyle,l2.NotificationKind.setLocale,l2.NotificationKind.setWorkbookProps,l2.NotificationKind.updateSheetNames,l2.NotificationKind.updateNamedObjects];var nd;(function(e){e.functionSuggestion="functionSuggestion",e.inCellSuggestion="inCellSuggestion",e.formulaHighlighting="formulaHighlighting",e.argumentAssistance="argumentAssistance",e.valuePreview="valuePreview",e.gotoCtrlClick="gotoCtrlClick",e.runExperiment="runExperiment",e.runAuthoringExperiment="runAuthoringExperiment",e.runPerCharacterExperiment="runPerCharacterExperiment",e.runTest="runTest",e.formulaRepair="formulaRepair",e.chatGPTQuery="chatGPTQuery",e.columnFormulaSuggestion="columnFormulaSuggestion",e.setCellPrefetch="setCellPrefetch",e.getTranspiledFormulas="getTranspiledFormulas"})(nd||(Va.RequestKind=nd={}));(0,wS.staticAssertExtends)();(0,wS.staticAssertExtends)();function JPr(e){var r=function(n){return function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var u=a[0],s=a[1],l=a[2];return(0,wS.isNone)(u)?Promise.resolve(null):Promise.resolve(e.doRequest(n,u,s,l??Va.DefaultComputationGroup))}};return{argumentAssistance:r(nd.argumentAssistance),chatGPTQuery:r(nd.chatGPTQuery),columnFormulaSuggestion:r(nd.columnFormulaSuggestion),formulaHighlighting:r(nd.formulaHighlighting),formulaRepair:r(nd.formulaRepair),functionSuggestion:r(nd.functionSuggestion),gotoCtrlClick:r(nd.gotoCtrlClick),inCellSuggestion:r(nd.inCellSuggestion),runAuthoringExperiment:r(nd.runAuthoringExperiment),runExperiment:r(nd.runExperiment),runPerCharacterExperiment:r(nd.runPerCharacterExperiment),runTest:r(nd.runTest),valuePreview:r(nd.valuePreview),setCellPrefetch:r(nd.setCellPrefetch),getTranspiledFormulas:r(nd.getTranspiledFormulas)}}Va.makeRequester=JPr;function ZPr(e){return{formulaHighlighting:function(t,n,a){return(0,wS.isNone)(t)?null:e.doSyncRequest(nd.formulaHighlighting,t,n,a??Va.DefaultComputationGroup)}}}Va.makeSyncRequester=ZPr;function $Pr(e,r){var t;return c2.__generator(this,function(n){switch(n.label){case 0:return[4,c2.__assign({kind:e},r)];case 1:return t=n.sent(),(0,UNe.assertTrue)("Response kind coincides with request kind",t.kind===e),(0,XPr.staticTypeHint)(t),[2,t]}})}Va.typedRequest=$Pr;function eAr(e){var r;return c2.__generator(this,function(t){switch(t.label){case 0:return[4,{kind:Va.ComputationRequestKind.AwaitPromise,promise:e}];case 1:return r=t.sent(),(0,UNe.assertTrue)("Response kind coincides with request kind",r.kind===Va.ComputationRequestKind.AwaitPromise),[2,r.result]}})}Va.awaitPromise=eAr;Va.delay={kind:Va.ComputationRequestKind.Delay};var GNe;(function(e){e[e.NoOpRequest=0]="NoOpRequest",e[e.AsyncRequest=1]="AsyncRequest",e[e.SyncRequest=2]="SyncRequest",e[e.StepComputation=3]="StepComputation",e[e.StopComputationFrame=4]="StopComputationFrame",e[e.Timeout=5]="Timeout"})(GNe||(Va.SchedulerTimelineQueueMessageKind=GNe={}));var BNe;(function(e){e.Both="Both",e.SyncOnly="SyncOnly"})(BNe||(Va.SchedulerVersionCompatibility=BNe={}));(0,wS.staticAssertExtends)();(0,wS.staticAssertExtends)();var Mee;(function(e){e.Superseded="Superseded",e.Timeout="Timeout",e.ConflictResolverEarlyTermination="ConflictResolverEarlyTermination"})(Mee||(Va.FrameExecutionStopReason=Mee={}));var xee;(function(e){e.Done="Done",e.Skipped="Skipped",e.Exception="Exception"})(xee||(xee={}));var rAr="Unknown";Va.ExecutionStopReason={Unknown:rAr,Frame:Mee,Computation:xee};var tAr=function(){function e(r,t){this.computationType=r,this.computationKind=t,this._attachedComputations=[],this._attachedSyncComputations=[],this._computationFrames=new Map}return e.prototype.computationFrame=function(r){return this._computationFrames.get(r)},Object.defineProperty(e.prototype,"attachedComputations",{get:function(){return c2.__spreadArray([],this._attachedComputations,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attachedSyncComputations",{get:function(){return c2.__spreadArray([],this._attachedSyncComputations,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numComputations",{get:function(){return this._attachedComputations.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numSyncComputations",{get:function(){return this._attachedSyncComputations.length},enumerable:!1,configurable:!0}),e.prototype.attachComputation=function(r){this._attachedComputations.push(r)},e.prototype.attachSyncComputation=function(r){this._attachedSyncComputations.push(r)},e.prototype.createFrame=function(r,t,n,a,o,u,s,l){var c=new HPr.ResolvablePromise,d=this.computationKind,f={type:this.computationType,correlationId:r,computationGroup:t,computationInput:a,cache:o,config:u,startTime:s,timeWindow:l,successfulResults:{kind:d,results:[]},resolvable:c,stopReasonRef:new zPr.Ref(Va.ExecutionStopReason.Unknown),numOfComputations:n===WPr.ExecutionType.Async?this.numComputations:this.numSyncComputations,numFailures:0,numSkippedComputations:0};return this._computationFrames.set(t,f),c},e.prototype.closeFrame=function(r,t,n){var a,o=this.computationFrame(r);if(o){this._computationFrames.delete(r),o.stopReasonRef.value=t,o.resolvable.resolve(t===Va.ExecutionStopReason.Frame.Superseded?{kind:"Superseded"}:{kind:"Done",payload:o.successfulResults}),(a=o.cache)===null||a===void 0||a.close();var u=this,s=u.computationKind,l=u.numComputations,c=u.numSyncComputations,d=o.correlationId,f=o.startTime,m=o.numSkippedComputations,v=o.successfulResults,h=v.results.length,y={correlationId:d,type:this.computationType,computationKind:s,computationGroup:r,numComputations:l,numSyncComputations:c,numSent:h,numSkippedComputations:m,stopReason:t,startTime:f,stopTime:n};QPr.x10Logger.log({kind:"closeComputationFrame",payload:y}),(0,YPr.sendX10UsedTelemetryEvent)()}},e.prototype.stop=function(r,t,n){this.computationFrame(r)!==void 0&&this.closeFrame(r,t,n)},e}();Va.ResponseState=tAr});var WNe=T(Q4=>{"use strict";p();Object.defineProperty(Q4,"__esModule",{value:!0});Q4.createIEEE754Double=void 0;var VNe=new ArrayBuffer(8),KNe=new Uint32Array(VNe),nAr=new Float64Array(VNe),aAr=new Uint8Array(new Uint16Array([1]).buffer)[0]===1,jNe=aAr?[0,1]:[1,0],iAr=jNe[0],oAr=jNe[1];function uAr(e){var r=e.lowDword,t=e.highDword;return KNe[iAr]=r,KNe[oAr]=t,nAr[0]}Q4.createIEEE754Double=uAr});var zNe=T(X4=>{"use strict";p();var xf;Object.defineProperty(X4,"__esModule",{value:!0});X4.notificationMethodArgumentsConvertorsMap=void 0;var wf=fe(),Yp=Kh(),d2=wQ(),HNe=uU(),f2=Hf(),Vr=BM(),If=hG(),sAr=Ar(),lAr=WNe(),Vh=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return r},cAr=function(r){switch(r==null?void 0:r.kind){case"NamedValue":switch(r.value.kind){case"Number":return wf.__assign(wf.__assign({},r),{value:r.value.numberValue});case"String":return wf.__assign(wf.__assign({},r),{value:r.value.stringValue});case"Boolean":return wf.__assign(wf.__assign({},r),{value:r.value.booleanValue});case"Error":return wf.__assign(wf.__assign({},r),{value:r.value})}default:return r}},dAr=[[If.ErrorType.NULL,function(e){return e===0}],[If.ErrorType.DIV0,function(e){return e===7}],[If.ErrorType.VALUE,function(e){return e===15||e===53}],[If.ErrorType.REF,function(e){return e===23}],[If.ErrorType.NAME,function(e){return e===29}],[If.ErrorType.NUM,function(e){return e===36}],[If.ErrorType.NA,function(e){return e===42}],[If.ErrorType.GETTING_DATA,function(e){return e===43}],[If.ErrorType.SPILL,function(e){return e===45}],[If.ErrorType.CONNECT,function(e){return e===46}],[If.ErrorType.BLOCKED,function(e){return e===47}],[If.ErrorType.UNKNOWN,function(e){return e===48}],[If.ErrorType.FIELD,function(e){return e===49}],[If.ErrorType.CALC,function(e){return e===50}],[If.ErrorType.BUSY,function(e){return e===51||e===52||e===54}],[If.ErrorType.EXTERNAL,function(){return!1}]];(0,sAr.staticAssertSame)();function fAr(e){switch(e.kind){case"error":for(var r=0,t=dAr;r<t.length;r++){var n=t[r],a=n[0],o=n[1];if(o(e.errorValue))return{kind:"error",errorKind:a}}return{kind:"error",errorKind:void 0};case"number":return{kind:"number",value:(0,lAr.createIEEE754Double)(e)};default:return e}}X4.notificationMethodArgumentsConvertorsMap=(xf={},xf[Yp.NotificationKind.doNothing]=Vh,xf[Yp.NotificationKind.setActiveCell]=Vh,xf[Yp.NotificationKind.setActiveCellFormat]=Vh,xf[Yp.NotificationKind.setFunctionsInfo]=Vh,xf[Yp.NotificationKind.setDefinedNamesInfo]=Vh,xf[Yp.NotificationKind.notifyWorkbookClosing]=Vh,xf[Yp.NotificationKind.setSchedulerFeatures]=Vh,xf[Yp.NotificationKind.setA1ReferenceStyle]=Vh,xf[Yp.NotificationKind.setWorkbookProps]=Vh,xf[Yp.NotificationKind.updateSheetNames]=Vh,xf[Yp.NotificationKind.writeRange]=function(e,r){return[e,wf.__assign(wf.__assign({},r),{values:r.values.map(function(t){return t.map(fAr)})})]},xf[Yp.NotificationKind.setLocale]=function(){for(var e,r,t,n,a,o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];var s=o[0];return[wf.__assign(wf.__assign({},s),{specialRefNames:(0,f2.partialArray)((e={},e[d2.SpecialRefId.All]=s.specialRefNames.All,e[d2.SpecialRefId.Data]=s.specialRefNames.Data,e[d2.SpecialRefId.Headers]=s.specialRefNames.Headers,e[d2.SpecialRefId.ThisRow]=s.specialRefNames.ThisRow,e[d2.SpecialRefId.Totals]=s.specialRefNames.Totals,e)),currencyFormat:HNe.CurrencyFormat[s.currencyFormat],dateOrder:HNe.DateOrder[s.dateOrder],timeAltSeparator:s.timeAltSeparator,pictureSpecial:(0,f2.partialArray)((r={},r[Vr.PictureSpecial.AP1]=s.pictureSpecial.AP1,r[Vr.PictureSpecial.AP2]=s.pictureSpecial.AP2,r[Vr.PictureSpecial.AP3]=s.pictureSpecial.AP3,r[Vr.PictureSpecial.Currency]=s.pictureSpecial.Currency,r[Vr.PictureSpecial.General]=s.pictureSpecial.General,r[Vr.PictureSpecial.GeneralOldMAC]=s.pictureSpecial.GeneralOldMAC,r)),pictureSingle:(0,f2.partialArray)((t={},t[Vr.PictureSingle.Sep]=s.pictureSingle.Sep,t[Vr.PictureSingle.Hash]=s.pictureSingle.Hash,t[Vr.PictureSingle.Zero]=s.pictureSingle.Zero,t[Vr.PictureSingle.Decimal]=s.pictureSingle.Decimal,t[Vr.PictureSingle.Percent]=s.pictureSingle.Percent,t[Vr.PictureSingle.Comma]=s.pictureSingle.Comma,t[Vr.PictureSingle.Colon]=s.pictureSingle.Colon,t[Vr.PictureSingle.DateSep]=s.pictureSingle.DateSep,t[Vr.PictureSingle.Slash]=s.pictureSingle.Slash,t[Vr.PictureSingle.Space]=s.pictureSingle.Space,t[Vr.PictureSingle.Minus]=s.pictureSingle.Minus,t[Vr.PictureSingle.Plus]=s.pictureSingle.Plus,t[Vr.PictureSingle.OpenParen]=s.pictureSingle.OpenParen,t[Vr.PictureSingle.CloseParen]=s.pictureSingle.CloseParen,t[Vr.PictureSingle.Extra]=s.pictureSingle.Extra,t[Vr.PictureSingle.Backslash]=s.pictureSingle.Backslash,t[Vr.PictureSingle.Star]=s.pictureSingle.Star,t[Vr.PictureSingle.Year]=s.pictureSingle.Year,t[Vr.PictureSingle.Month]=s.pictureSingle.Month,t[Vr.PictureSingle.Day]=s.pictureSingle.Day,t[Vr.PictureSingle.Hour]=s.pictureSingle.Hour,t[Vr.PictureSingle.Minute]=s.pictureSingle.Minute,t[Vr.PictureSingle.Second]=s.pictureSingle.Second,t[Vr.PictureSingle.E]=s.pictureSingle.E,t[Vr.PictureSingle.APDelim]=s.pictureSingle.APDelim,t[Vr.PictureSingle.Quote]=s.pictureSingle.Quote,t[Vr.PictureSingle.ColorStart]=s.pictureSingle.ColorStart,t[Vr.PictureSingle.ColorEnd]=s.pictureSingle.ColorEnd,t[Vr.PictureSingle.Text]=s.pictureSingle.Text,t[Vr.PictureSingle.Question]=s.pictureSingle.Question,t[Vr.PictureSingle.Underscore]=s.pictureSingle.Underscore,t[Vr.PictureSingle.Reign]=s.pictureSingle.Reign,t[Vr.PictureSingle.LocDay]=s.pictureSingle.LocDay,t[Vr.PictureSingle.Era]=s.pictureSingle.Era,t[Vr.PictureSingle.EraYear]=s.pictureSingle.EraYear,t[Vr.PictureSingle.Nen1]=s.pictureSingle.Nen1,t[Vr.PictureSingle.Gatsu1]=s.pictureSingle.Gatsu1,t[Vr.PictureSingle.Nichi1]=s.pictureSingle.Nichi1,t[Vr.PictureSingle.Nen2]=s.pictureSingle.Nen2,t[Vr.PictureSingle.Gatsu2]=s.pictureSingle.Gatsu2,t[Vr.PictureSingle.Nichi2]=s.pictureSingle.Nichi2,t[Vr.PictureSingle.BidiDate]=s.pictureSingle.BidiDate,t[Vr.PictureSingle.BidiNum]=s.pictureSingle.BidiNum,t[Vr.PictureSingle.DayTh]=s.pictureSingle.DayTh,t[Vr.PictureSingle.MonthTh]=s.pictureSingle.MonthTh,t[Vr.PictureSingle.YearTh]=s.pictureSingle.YearTh,t[Vr.PictureSingle.EngYearTh]=s.pictureSingle.EngYearTh,t[Vr.PictureSingle.ThYear]=s.pictureSingle.ThYear,t[Vr.PictureSingle.HourTh]=s.pictureSingle.HourTh,t[Vr.PictureSingle.MinuteTh]=s.pictureSingle.MinuteTh,t[Vr.PictureSingle.SecondTh]=s.pictureSingle.SecondTh,t[Vr.PictureSingle.ZeroTh]=s.pictureSingle.ZeroTh,t)),pictureColor:(0,f2.partialArray)((n={},n[Vr.PictureColor.Black]=s.pictureColor.Black,n[Vr.PictureColor.Blue]=s.pictureColor.Blue,n[Vr.PictureColor.Color]=s.pictureColor.Color,n[Vr.PictureColor.Cyan]=s.pictureColor.Cyan,n[Vr.PictureColor.Green]=s.pictureColor.Green,n[Vr.PictureColor.Magenta]=s.pictureColor.Magenta,n[Vr.PictureColor.Red]=s.pictureColor.Red,n[Vr.PictureColor.White]=s.pictureColor.White,n[Vr.PictureColor.Yellow]=s.pictureColor.Yellow,n)),pictureDbnum:(0,f2.partialArray)((a={},a[Vr.PictureDbnum.DBNUM1]=s.pictureDbnum.DBNUM1,a[Vr.PictureDbnum.DBNUM2]=s.pictureDbnum.DBNUM2,a[Vr.PictureDbnum.DBNUM3]=s.pictureDbnum.DBNUM3,a[Vr.PictureDbnum.DBNUM4]=s.pictureDbnum.DBNUM4,a)),ampmSymbols:[s.ampmSymbols.first,s.ampmSymbols.second]})]},xf[Yp.NotificationKind.updateNamedObjects]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=e[0],n=e[1];return[t,n.map(function(a){var o;return wf.__assign(wf.__assign({},a),{scope:a.scope,objects:(o=a.objects)===null||o===void 0?void 0:o.map(function(u){var s;return wf.__assign(wf.__assign({},u),{data:cAr((s=u.data)!==null&&s!==void 0?s:void 0)})}),fromStateId:a.fromStateId})})]},xf[Yp.NotificationKind.setNumberFormats]=Vh,xf)});var XNe=T(J4=>{"use strict";p();Object.defineProperty(J4,"__esModule",{value:!0});J4.makeNotifier=void 0;var QNe=fe(),pAr=Ar(),wee=Ar(),Dee=Kh(),mAr=Qm(),Iee=Qm(),gAr=zNe();(0,wee.staticAssertExtends)();(0,wee.staticAssertExtends)();(0,wee.staticAssertExtends)();var vAr=[Dee.NotificationKind.conflictResolverEarlyTermination];function hAr(e){return vAr.findIndex(function(r){return r===e})<0}var Y4=(0,pAr.strEnumArray)(Dee.NotificationKind).filter(hAr);function SAr(e,r){return(0,mAr.mapFromArrayOfDependantPairs)(Y4.map(function(t){return[t,function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return e[t].apply(e,r[t].apply(r,n))}]}))}function yAr(e){var r,t=e.doNotify.bind(e),n=(0,Iee.functionMapFromDUFunction)(t,Y4),a=(0,Iee.bindMethodsUnbox)(n,Y4),o=(0,Iee.bindMethodsNullCheck)(a,Y4),u=QNe.__assign(QNe.__assign({},o),(r={},r[Dee.NotificationKind.notifyWorkbookClosing]=function(){return a.notifyWorkbookClosing()},r));return SAr(u,gAr.notificationMethodArgumentsConvertorsMap)}J4.makeNotifier=yAr});var yc=T(ad=>{"use strict";p();var ja,Z4,$4,e6,r6,t6,Md,xd;Object.defineProperty(ad,"__esModule",{value:!0});ad.ProcessNonFormulaCells=ad.getFormulaContent=ad.isFormulaRequest=ad.pluginGroupMap=ad.pluginGroupOptInDefault=ad.registerPluginFactory=ad.getPluginFactory=ad.pluginFactoryKindMap=void 0;var ht=ia(),JNe=Gi(),ZNe=Ar(),ZR=Ar(),dn=Xo(),_Ar=Ms(),JR=Xp(),YNe=Qm();ad.pluginFactoryKindMap=(ja={},ja[ht.PluginFactoryName.TestPlugin]=dn.RequestKind.runTest,ja[ht.PluginFactoryName.PythonTestPlugin]=dn.RequestKind.runTest,ja[ht.PluginFactoryName.AutocompletePlugin]=dn.RequestKind.functionSuggestion,ja[ht.PluginFactoryName.AutocompleteRangeSuggestionPlugin]=dn.RequestKind.inCellSuggestion,ja[ht.PluginFactoryName.DragPlugin]=dn.RequestKind.functionSuggestion,ja[ht.PluginFactoryName.ConfigTestPlugin]=dn.RequestKind.runTest,ja[ht.PluginFactoryName.FeatureGateTestPlugin]=dn.RequestKind.runTest,ja[ht.PluginFactoryName.ChangeGateTestPlugin]=dn.RequestKind.runTest,ja[ht.PluginFactoryName.ArgumentAssistancePlugin]=dn.RequestKind.argumentAssistance,ja[ht.PluginFactoryName.FormulaRepairShadowEvalPlugin]=dn.RequestKind.runAuthoringExperiment,ja[ht.PluginFactoryName.FormulaCollectionPlugin]=dn.RequestKind.functionSuggestion,ja[ht.PluginFactoryName.DNMTraceTagTestPlugin]=dn.RequestKind.runTest,ja[ht.PluginFactoryName.AutocompleteWrapperPlugin]=dn.RequestKind.runPerCharacterExperiment,ja[ht.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin]=dn.RequestKind.runAuthoringExperiment,ja[ht.PluginFactoryName.ParenthesesCouplingPlugin]=dn.RequestKind.formulaHighlighting,ja[ht.PluginFactoryName.ColoredReferencesPlugin]=dn.RequestKind.formulaHighlighting,ja[ht.PluginFactoryName.SlowTestPlugin]=dn.RequestKind.functionSuggestion,ja[ht.PluginFactoryName.EvalOnCloneTestPlugin]=dn.RequestKind.runTest,ja[ht.PluginFactoryName.EvalFormulaTestPlugin]=dn.RequestKind.runTest,ja[ht.PluginFactoryName.AutocompleteFunctionPlugin]=dn.RequestKind.functionSuggestion,ja[ht.PluginFactoryName.AutocompleteEnumPlugin]=dn.RequestKind.functionSuggestion,ja[ht.PluginFactoryName.AutocompleteLetPlugin]=dn.RequestKind.functionSuggestion,ja[ht.PluginFactoryName.AutocompleteRichValuePlugin]=dn.RequestKind.functionSuggestion,ja[ht.PluginFactoryName.AutocompleteNamedObjectsPlugin]=dn.RequestKind.functionSuggestion,ja[ht.PluginFactoryName.ParserPerformanceMeasurements]=dn.RequestKind.runExperiment,ja[ht.PluginFactoryName.AutocompleteTableHeadersPlugin]=dn.RequestKind.functionSuggestion,ja[ht.PluginFactoryName.PythonAutocompletePlugin]=dn.RequestKind.functionSuggestion,ja[ht.PluginFactoryName.ValuePreviewPlugin]=dn.RequestKind.valuePreview,ja[ht.PluginFactoryName.GotoCtrlClickPlugin]=dn.RequestKind.gotoCtrlClick,ja[ht.PluginFactoryName.SyntaxErrorsPlugin]=dn.RequestKind.formulaRepair,ja[ht.PluginFactoryName.ChatGPTPlugin]=dn.RequestKind.chatGPTQuery,ja[ht.PluginFactoryName.EventsTestPlugin]=dn.RequestKind.runTest,ja[ht.PluginFactoryName.FormulaByExamplePlugin]=dn.RequestKind.columnFormulaSuggestion,ja[ht.PluginFactoryName.SetCellPrefetchPlugin]=dn.RequestKind.setCellPrefetch,ja[ht.PluginFactoryName.FormulaTranspilerPlugin]=dn.RequestKind.getTranspiledFormulas,ja);(0,ZR.staticAssertExtends)();(0,ZR.staticAssertExtends)();(0,ZR.staticAssertExtends)();var ait=(Z4={},Z4[ht.PluginFactoryName.ParenthesesCouplingPlugin]=dn.SchedulerVersionCompatibility.SyncOnly,Z4[ht.PluginFactoryName.ColoredReferencesPlugin]=dn.SchedulerVersionCompatibility.SyncOnly,Z4);(0,ZR.staticAssertExtends)();(0,ZNe.staticAssertSame)();(0,ZR.staticAssertExtends)();var Lee=(0,ZR.makeStringMap)();function bAr(e){var r=Lee[e];if(!r){var t=JR.x10Logger.formatLogMessage("getPluginFactory",{description:"".concat(ht.PluginFactoryName[e]," has not been registered")});throw JR.x10Logger.log({kind:"failure",payload:{failureKind:JR.X10FailureKind.PluginAttachmentFailure,failureLevel:JNe.TraceLevel.Error,path:"pluginFactory.getPluginFactory",description:"".concat(ht.PluginFactoryName[e]," has not been registered")}}),new Error(t)}return r}ad.getPluginFactory=bAr;function CAr(e){var r=e.factoryName,t=Lee[r];if(t!==void 0&&t!==e){var n=JR.x10Logger.formatLogMessage("registerPluginFactory",{description:"".concat(ht.PluginFactoryName[r]," is already registered")});if(JR.x10Logger.log({kind:"failure",payload:{failureKind:JR.X10FailureKind.PluginAttachmentFailure,failureLevel:JNe.TraceLevel.Error,path:"pluginFactory.registerPluginFactory",description:"".concat(ht.PluginFactoryName[r]," is already registered")}}),!(0,_Ar.getTypedFeatureGate)("Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration"))throw new Error(n)}Lee[r]=e,JR.x10Logger.log({kind:"registerPluginFactory",payload:{factoryName:r}})}ad.registerPluginFactory=CAr;ad.pluginGroupOptInDefault=($4={},$4[ht.PluginGroup.Excel]=!0,$4[ht.PluginGroup.Python]=!1,$4);(0,ZR.staticAssertExtends)();ad.pluginGroupMap=(e6={},e6[ht.PluginGroup.Excel]=(r6={},r6[ht.PluginFactoryName.PythonTestPlugin]=!1,r6[ht.PluginFactoryName.PythonAutocompletePlugin]=!1,r6),e6[ht.PluginGroup.Python]=(t6={},t6[ht.PluginFactoryName.PythonTestPlugin]=!0,t6[ht.PluginFactoryName.PythonAutocompletePlugin]=!0,t6),e6);ZNe.staticAssertSame;var $Ne=(Md={},Md[dn.RequestKind.functionSuggestion]="content",Md[dn.RequestKind.inCellSuggestion]="content",Md[dn.RequestKind.formulaHighlighting]="content",Md[dn.RequestKind.argumentAssistance]="content",Md[dn.RequestKind.valuePreview]="text",Md[dn.RequestKind.runAuthoringExperiment]="content",Md[dn.RequestKind.runPerCharacterExperiment]="content",Md[dn.RequestKind.formulaRepair]="formula",Md[dn.RequestKind.gotoCtrlClick]="text",Md[dn.RequestKind.columnFormulaSuggestion]=void 0,Md[dn.RequestKind.setCellPrefetch]=void 0,Md[dn.RequestKind.runExperiment]=void 0,Md[dn.RequestKind.runTest]=void 0,Md[dn.RequestKind.chatGPTQuery]=void 0,Md[dn.RequestKind.getTranspiledFormulas]=void 0,Md);function TAr(e){return $Ne[e]!==void 0}ad.isFormulaRequest=TAr;function RAr(e){var r=$Ne[e[0]];(0,YNe.staticTypeHint)(r);var t=e[1][r];return(0,YNe.staticTypeHint)(t),t}ad.getFormulaContent=RAr;ad.ProcessNonFormulaCells=(xd={},xd[ht.PluginFactoryName.TestPlugin]=!0,xd[ht.PluginFactoryName.ParserPerformanceMeasurements]=!0,xd[ht.PluginFactoryName.ConfigTestPlugin]=!0,xd[ht.PluginFactoryName.FeatureGateTestPlugin]=!0,xd[ht.PluginFactoryName.DNMTraceTagTestPlugin]=!0,xd[ht.PluginFactoryName.ChangeGateTestPlugin]=!0,xd[ht.PluginFactoryName.SlowTestPlugin]=!0,xd[ht.PluginFactoryName.EvalOnCloneTestPlugin]=!0,xd[ht.PluginFactoryName.EvalFormulaTestPlugin]=!0,xd[ht.PluginFactoryName.PythonTestPlugin]=!0,xd[ht.PluginFactoryName.ChatGPTPlugin]=!0,xd[ht.PluginFactoryName.EventsTestPlugin]=!0,xd[ht.PluginFactoryName.FormulaByExamplePlugin]=!0,xd[ht.PluginFactoryName.SetCellPrefetchPlugin]=!0,xd[ht.PluginFactoryName.FormulaTranspilerPlugin]=!0,xd)});var ZN=T(JN=>{"use strict";p();Object.defineProperty(JN,"__esModule",{value:!0});JN.defaultTimerInterface=JN.TimelineQueueProcessor=void 0;var eOe=v_();JN.TimelineQueueProcessor=eOe.timelineQueueProcessor.TimelineQueueProcessor;JN.defaultTimerInterface=eOe.timelineQueueProcessor.defaultTimerInterface});var XC=T(Tv=>{"use strict";p();Object.defineProperty(Tv,"__esModule",{value:!0});Tv.getCompletedFunctionSuffix=Tv.getStructRefCompletionItemRank=Tv.endOf=Tv.verifyTextAndRange=Tv.filterSuggestionsAccordingToPrefix=void 0;var rOe=nl(),EAr=Ba(),tOe=Ar(),PAr=ia();function AAr(e,r,t,n){n===void 0&&(n=!1);var a=[],o=[],u=e.toLocaleLowerCase();return e===""?{prefixedSuggestions:r,notPrefixedSuggestions:o}:(r.forEach(function(s){var l=t?t(s).toLocaleLowerCase():typeof s=="string"?s.toLocaleLowerCase():void 0;if(l!==void 0)if(l.startsWith(u)&&(!n||l!==u))a.push(s);else if(n){var c=l.split(" ");(0,tOe.isDefined)(c.find(function(d){return d.startsWith(u)}))&&o.push(s)}else u.length>2&&l.includes(u)&&o.push(s)}),{prefixedSuggestions:a,notPrefixedSuggestions:o})}Tv.filterSuggestionsAccordingToPrefix=AAr;var FAr=function(r,t,n,a,o){var u,s,l,c,d,f,m;expect(r==null?void 0:r.label).toEqual(t),expect((u=r==null?void 0:r.textEdit)===null||u===void 0?void 0:u.newText).toEqual(o??t),expect((c=(l=(s=r==null?void 0:r.textEdit)===null||s===void 0?void 0:s.range)===null||l===void 0?void 0:l.start)===null||c===void 0?void 0:c.character).toEqual(n),expect((m=(f=(d=r==null?void 0:r.textEdit)===null||d===void 0?void 0:d.range)===null||f===void 0?void 0:f.end)===null||m===void 0?void 0:m.character).toEqual(a)};Tv.verifyTextAndRange=FAr;var NAr=function(r){return r.length};Tv.endOf=NAr;var OAr=function(r){var t,n,a,o,u=r.kind===PAr.CompletionItemKind.TableHeader?1:(n=(t=r.label)===null||t===void 0?void 0:t.startsWith("#"))!==null&&n!==void 0&&n?0:(o=(a=r.label)===null||a===void 0?void 0:a.startsWith("@"))!==null&&o!==void 0&&o?2:void 0;return(0,tOe.isNone)(u)?(EAr.ulsLogger.ULS.traceTag(526411872,rOe.LogCategory.msoulscat_ES_EWAJS,rOe.TraceLevel.Warning,"conflictResolver: trying to rank a structRef completion item with unexpected fields. item = ".concat(JSON.stringify(r))),0):u};Tv.getStructRefCompletionItemRank=OAr;function kAr(e,r){var t=(e==null?void 0:e.charAt(r))==="(";return t?"":"("}Tv.getCompletedFunctionSuffix=kAr});var qee=T(DS=>{"use strict";p();Object.defineProperty(DS,"__esModule",{value:!0});DS.spanCompare=DS.spanToLSPRange=DS.indexToLSPPosition=DS.Timeline=void 0;var n6=v_();DS.Timeline=n6.helpers.Timeline;DS.indexToLSPPosition=n6.helpers.indexToLSPPosition;DS.spanToLSPRange=n6.helpers.spanToLSPRange;DS.spanCompare=n6.helpers.spanCompare});var iOe=T(i6=>{"use strict";p();Object.defineProperty(i6,"__esModule",{value:!0});i6.conflictResolver=void 0;var h_=fe(),Ko=Ar(),MAr=yc(),JC=ia(),Rv=ia(),xAr=Ba(),nOe=XC(),IAr=qee();i6.conflictResolver={runTest:a6,runExperiment:a6,runAuthoringExperiment:a6,runPerCharacterExperiment:a6,argumentAssistance:YC,valuePreview:YC,gotoCtrlClick:YC,formulaRepair:YC,chatGPTQuery:YC,columnFormulaSuggestion:YC,setCellPrefetch:YC,getTranspiledFormulas:YC,inCellSuggestion:function(r){for(var t=0,n=r;t<n.length;t++){var a=n[t],o=a[0].factoryName,u=a[1];if(o===Rv.PluginFactoryName.AutocompleteRangeSuggestionPlugin&&(0,Ko.isDefined)(u))return u}return null},formulaHighlighting:function(r){var t;if(r.length>0){for(var n=[],a=0,o=r;a<o.length;a++){var u=o[a],s=u[0],l=u[1],c=(t=l.formulaHighlights)===null||t===void 0?void 0:t.filter(Ko.isDefined);c!==void 0&&(n=n.concat(c))}var d=function(m,v){return(0,Ko.isDefined)(m.span)&&(0,Ko.isDefined)(v.span)?(0,IAr.spanCompare)(m.span,v.span):(0,Ko.isDefined)(m)?1:(0,Ko.isDefined)(v)?-1:0};return n.sort(d),{formulaHighlights:n}}return null},functionSuggestion:function(r){var t=[],n=[],a=[],o=void 0,u=r.filter(function(y){var _=y[0].factoryName;return v(_)==="enum"});if(u.forEach(function(y){var _=y[0],E=y[1];(0,Ko.isDefined)(E.items)&&E.items.filter(Ko.isDefined).filter(function(N){return(0,Ko.isDefined)(N.textEdit)||(0,Ko.isDefined)(N.label)}).forEach(function(N){return a.push(h_.__assign(h_.__assign({},N),{type:JC.SuggestionKind.Simple}))})}),a.length>0)return{items:h_.__spreadArray([],a,!0),data:o};for(var s=0,l=r;s<l.length;s++){var c=l[s],d=c[0].factoryName,f=c[1],m=v(d);m===JC.SuggestionKind.Smart?((0,Ko.isDefined)(f.items)&&f.items.filter(Ko.isDefined).filter(function(y){return(0,Ko.isDefined)(y.textEdit)||(0,Ko.isDefined)(y.label)}).forEach(function(y){return t.push(h_.__assign(h_.__assign({},y),{type:JC.SuggestionKind.Smart}))}),(0,Ko.isDefined)(f.data)&&(o=f.data)):(0,Ko.isDefined)(f.items)&&f.items.filter(Ko.isDefined).filter(function(y){return(0,Ko.isDefined)(y.textEdit)||(0,Ko.isDefined)(y.label)}).forEach(function(y){return n.push(h_.__assign(h_.__assign({},y),{type:JC.SuggestionKind.Simple}))})}return{items:h_.__spreadArray(h_.__spreadArray([],t,!0),n.sort(h),!0),data:o};function v(y){switch(y){case Rv.PluginFactoryName.AutocompletePlugin:case Rv.PluginFactoryName.FormulaCollectionPlugin:return JC.SuggestionKind.Smart;case Rv.PluginFactoryName.DragPlugin:case Rv.PluginFactoryName.SlowTestPlugin:case Rv.PluginFactoryName.AutocompleteFunctionPlugin:case Rv.PluginFactoryName.AutocompleteLetPlugin:case Rv.PluginFactoryName.AutocompleteRichValuePlugin:case Rv.PluginFactoryName.AutocompleteNamedObjectsPlugin:case Rv.PluginFactoryName.AutocompleteTableHeadersPlugin:case Rv.PluginFactoryName.PythonAutocompletePlugin:return JC.SuggestionKind.Simple;case Rv.PluginFactoryName.AutocompleteEnumPlugin:return"enum";default:(0,xAr.assertNever)("unknown plugin factory name: ".concat(y),y)}}function h(y,_){if((0,Ko.isDefined)(y.label)&&(0,Ko.isDefined)(_.label)){if((0,Ko.isDefined)(y.isPrefixed)&&(0,Ko.isDefined)(_.isPrefixed)&&y.isPrefixed!==_.isPrefixed)return y.isPrefixed?-1:1;if(aOe.includes(y.kind)&&aOe.includes(_.kind)){var E=(0,nOe.getStructRefCompletionItemRank)(y),N=(0,nOe.getStructRefCompletionItemRank)(_);if(E!==N)return N-E}return y.label.toLocaleLowerCase()>_.label.toLocaleLowerCase()?1:-1}return(0,Ko.isDefined)(y.label)?1:(0,Ko.isDefined)(_.label)?-1:0}}};var aOe=[JC.CompletionItemKind.TableHeader,JC.CompletionItemKind.TableSpecialStructRef];(0,Ko.staticAssertExtends)();function a6(e){for(var r=[],t=0,n=e;t<n.length;t++){var a=n[t],o=a[0],u=a[1].results;(0,Ko.isDefined)(u)&&r.push.apply(r,u.filter(Ko.isDefined))}return{results:r}}function YC(e){if(e.length===0)return null;var r=e[0],t=r[0].factoryName,n=r[1];if(e.length===1)return n;var a=MAr.pluginFactoryKindMap[t];throw new Error("Conflict resolver: ".concat(a,": ").concat(e.length," results received, while only one active plugin is currently supported"))}});var Uee=T(ZC=>{"use strict";p();var Gee;Object.defineProperty(ZC,"__esModule",{value:!0});ZC.makeBatchRequester=ZC.customConflictResolverPluginKinds=ZC.CustomConflictResolverStrategy=void 0;var wAr=Xo(),Bee=Xo(),S_=Ar(),o6;(function(e){e.FunctionSuggestionAndArgumentAssistance="FunctionSuggestionAndArgumentAssistance"})(o6||(ZC.CustomConflictResolverStrategy=o6={}));ZC.customConflictResolverPluginKinds=(Gee={},Gee[o6.FunctionSuggestionAndArgumentAssistance]=[Bee.RequestKind.functionSuggestion,Bee.RequestKind.argumentAssistance,Bee.RequestKind.inCellSuggestion],Gee);function DAr(e){return{functionSuggestionAndArgumentAssistance:function(t,n,a){if((0,S_.isNone)(t))return Promise.resolve(null);var o=t.functionSuggestion,u=t.argumentAssistance,s=t.inCellSuggestion;return(0,S_.isNone)(o)||(0,S_.isNone)(u)||(0,S_.isNone)(s)?Promise.resolve(null):e.doBatchRequest({strategy:o6.FunctionSuggestionAndArgumentAssistance,functionSuggestion:o,argumentAssistance:u,inCellSuggestion:s},n,a??wAr.DefaultComputationGroup)}}}ZC.makeBatchRequester=DAr;(0,S_.staticAssertExtends)();(0,S_.staticAssertExtends)();(0,S_.staticAssertExtends)();(0,S_.staticAssertExtends)();(0,S_.staticAssertExtends)()});var sOe=T(rO=>{"use strict";p();var Kee;Object.defineProperty(rO,"__esModule",{value:!0});rO.customConflictResolverFactories=rO.FunctionSuggestionAndArgumentAssistanceConflictResolver=void 0;var LAr=Uee(),eO=Ar(),qAr=GN(),$N=Xo(),y_=Ba(),GAr=mi(),oOe=ia(),uOe=function(){function e(){this.argumentAssistanceResult=null,this.functionSuggestionResult=null,this.inCellSuggestionResult=null,this.argumentAssistanceSet=!1,this.functionSuggestionSet=!1,this.inCellSuggestionSet=!1,this.promise=new qAr.ResolvablePromise}return e.prototype.consumeResult=function(r){var t;if((0,GAr.isChangeGateEnabled)("OfficeVSO:7640530_InCellSuggestionRequestResolverEnabledV2"))switch(r.kind){case $N.RequestKind.functionSuggestion:(0,y_.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),this.functionSuggestionResult=r.result,this.functionSuggestionSet=!0,this.resolvePromiseIfPossible();break;case $N.RequestKind.argumentAssistance:(0,y_.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.argumentAssistanceResult=r.result,this.argumentAssistanceSet=!0,this.resolvePromiseIfPossible();break;case $N.RequestKind.inCellSuggestion:(0,y_.assertTrue)("inCellSuggestionSet should be false when receiving inCellSuggestion request",!this.inCellSuggestionSet),this.inCellSuggestionResult=r.result,this.inCellSuggestionSet=!0,this.resolvePromiseIfPossible();break;default:(0,y_.assertNever)("unknown result: ".concat(r),r)}else switch(r.kind){case $N.RequestKind.functionSuggestion:if((0,y_.assertTrue)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),(0,eO.isDefined)(r.result)&&(0,eO.isDefined)(r.result.items)&&r.result.items.length>0&&((t=r.result.items[r.result.items.length-1])===null||t===void 0?void 0:t.type)===oOe.SuggestionKind.Simple)return this.promise.resolve({functionSuggestion:r.result,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet)return this.argumentAssistanceResult!==null?this.promise.resolve({functionSuggestion:null,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:r.result,argumentAssistance:null,inCellSuggestion:null});this.functionSuggestionResult=r.result,this.functionSuggestionSet=!0;break;case $N.RequestKind.argumentAssistance:if((0,y_.assertTrue)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.functionSuggestionSet)return r.result!==null?this.promise.resolve({functionSuggestion:null,argumentAssistance:r.result,inCellSuggestion:null}):this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});this.argumentAssistanceResult=r.result,this.argumentAssistanceSet=!0;break;case $N.RequestKind.inCellSuggestion:break;default:(0,y_.assertNever)("unknown result: ".concat(r),r)}},e.create=function(){return new e},e.prototype.resolvePromiseIfPossible=function(){var r,t;if(this.functionSuggestionSet){if((0,eO.isDefined)(this.functionSuggestionResult)&&(0,eO.isDefined)(this.functionSuggestionResult.items)&&this.functionSuggestionResult.items.length>0)return((r=this.functionSuggestionResult.items[length-1])===null||r===void 0?void 0:r.type)===oOe.SuggestionKind.Smart&&((0,y_.assertTrue)("can't get argument assistance and smart suggestion at the same time",!this.argumentAssistanceSet||this.argumentAssistanceResult==null),(0,y_.assertTrue)("can't get in cell suggestion and smart suggestion at the same time",!this.inCellSuggestionSet||((t=this.inCellSuggestionResult)===null||t===void 0?void 0:t.completionItem)==null)),this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null,inCellSuggestion:null});if(this.argumentAssistanceSet&&this.inCellSuggestionSet)return this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:this.argumentAssistanceResult,inCellSuggestion:this.inCellSuggestionResult})}},e}();rO.FunctionSuggestionAndArgumentAssistanceConflictResolver=uOe;(0,eO.staticAssertExtends)();rO.customConflictResolverFactories=(Kee={},Kee[LAr.CustomConflictResolverStrategy.FunctionSuggestionAndArgumentAssistance]=uOe,Kee);(0,eO.staticAssertExtends)()});var jee=T(u6=>{"use strict";p();var Id;Object.defineProperty(u6,"__esModule",{value:!0});u6.defaultPluginResponseWindows=void 0;var fp=Xo(),Vee=Ar();u6.defaultPluginResponseWindows=(Id={},Id[fp.RequestKind.functionSuggestion]={startDelta:5,stopDelta:2e3},Id[fp.RequestKind.inCellSuggestion]={startDelta:5,stopDelta:2e3},Id[fp.RequestKind.formulaHighlighting]={startDelta:5,stopDelta:2e3},Id[fp.RequestKind.argumentAssistance]={startDelta:5,stopDelta:2e3},Id[fp.RequestKind.valuePreview]={startDelta:5,stopDelta:2e3},Id[fp.RequestKind.gotoCtrlClick]={startDelta:5,stopDelta:2e3},Id[fp.RequestKind.formulaRepair]={startDelta:5,stopDelta:2e3},Id[fp.RequestKind.runExperiment]={startDelta:0,stopDelta:15e3},Id[fp.RequestKind.runAuthoringExperiment]={startDelta:0,stopDelta:15e3},Id[fp.RequestKind.runPerCharacterExperiment]={startDelta:5,stopDelta:2e3},Id[fp.RequestKind.runTest]={startDelta:0,stopDelta:15e3},Id[fp.RequestKind.chatGPTQuery]={startDelta:0,stopDelta:15e3},Id[fp.RequestKind.columnFormulaSuggestion]={startDelta:0,stopDelta:2e4},Id[fp.RequestKind.setCellPrefetch]={startDelta:5,stopDelta:2e3},Id[fp.RequestKind.getTranspiledFormulas]={startDelta:0,stopDelta:5e3},Id);(0,Vee.staticAssertExtends)();(0,Vee.staticAssertExtends)();(0,Vee.staticAssertExtends)()});var Wee=T(s6=>{"use strict";p();Object.defineProperty(s6,"__esModule",{value:!0});s6.functionShortDescriptions=void 0;var lOe=Qf(),BAr=hc(),UAr=Ba(),cOe=nl(),KAr=Ms();s6.functionShortDescriptions=new BAr.ResettableLazy(function(){try{for(var e=new Map,r={},t=0,n=Object.keys(lOe.WorksheetFuncId);t<n.length;t++){var a=n[t],o=Number(a);if(!isNaN(Number(o))){var u=FormulaAuthoringStrings[lOe.WorksheetFuncId[o]+"ShortDescription"];e.set(o.toString(),u),r[o.toString()]=u}}return(0,KAr.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?{descriptionMap:r}:{descriptionMap:e}}catch(s){return UAr.ulsLogger.ULS.traceTag(538792415,cOe.LogCategory.msoulscat_ES_EWAJS,cOe.TraceLevel.Info,"failed to get functionShortDescriptionsMap with exception ".concat(s)),{}}})});var pOe=T($C=>{"use strict";p();Object.defineProperty($C,"__esModule",{value:!0});$C.wrapRequest=$C.wrapSyncRequest=$C.InternalSchedulerResponseKind=void 0;var VAr=Ba(),p2=Ar(),Wt=Xo(),dOe;(function(e){e[e.FirstStep=0]="FirstStep",e[e.NormalResponse=1]="NormalResponse",e[e.RequestFailure=2]="RequestFailure"})(dOe||($C.InternalSchedulerResponseKind=dOe={}));(0,p2.staticAssertExtends)();function fOe(e,r){switch(e.kind){case Wt.ComputationRequestKind.Delay:case Wt.ComputationRequestKind.CreateTask:case Wt.ComputationRequestKind.PromiseToTask:case Wt.ComputationRequestKind.GetActiveCell:case Wt.ComputationRequestKind.GetActiveCellFormat:case Wt.ComputationRequestKind.GetConfig:case Wt.ComputationRequestKind.GetCultureTag:case Wt.ComputationRequestKind.GetCorrelationId:case Wt.ComputationRequestKind.GetFunctionInfo:case Wt.ComputationRequestKind.GetFunctionsInfo:case Wt.ComputationRequestKind.GetDefinedNameInfo:case Wt.ComputationRequestKind.GetDefinedNamesInfo:case Wt.ComputationRequestKind.SetActiveCell:case Wt.ComputationRequestKind.IsSchedulerFeatureEnabled:case Wt.ComputationRequestKind.TriggerEvent:return{kind:Wt.SchedulerTimelineQueueMessageKind.NoOpRequest,request:e,computation:r};case Wt.ComputationRequestKind.GetSheetNames:case Wt.ComputationRequestKind.GetAvailableTableHeaders:case Wt.ComputationRequestKind.ParseCellFormula:case Wt.ComputationRequestKind.ParseNumberFormat:case Wt.ComputationRequestKind.PrintFormula:case Wt.ComputationRequestKind.ParseActiveCell:case Wt.ComputationRequestKind.ResolveReferences:case Wt.ComputationRequestKind.UnsafeGetContainingTableName:case Wt.ComputationRequestKind.UnsafeGetIntersectingTableNames:case Wt.ComputationRequestKind.GetStructRefColumn:case Wt.ComputationRequestKind.GetStructRefSpecialRef:return{kind:Wt.SchedulerTimelineQueueMessageKind.SyncRequest,request:e,computation:r};default:(0,VAr.assertNever)("unknown request: ".concat(e),e)}}$C.wrapSyncRequest=fOe;function jAr(e,r){switch(e.kind){case Wt.ComputationRequestKind.GetRange:case Wt.ComputationRequestKind.GetCell:case Wt.ComputationRequestKind.GetContainingTable:case Wt.ComputationRequestKind.GetIntersectingTables:case Wt.ComputationRequestKind.GetIformat:case Wt.ComputationRequestKind.AwaitPromise:case Wt.ComputationRequestKind.AwaitTask:case Wt.ComputationRequestKind.AwaitBatch:case Wt.ComputationRequestKind.AwaitAll:case Wt.ComputationRequestKind.AwaitAny:case Wt.ComputationRequestKind.ParseEdit:case Wt.ComputationRequestKind.GetRichValueFieldListContext:case Wt.ComputationRequestKind.GetHiddenRows:case Wt.ComputationRequestKind.GetHiddenCols:case Wt.ComputationRequestKind.EvalOnClonedModel:case Wt.ComputationRequestKind.EvalFormula:case Wt.ComputationRequestKind.GetCorrespondingSnapshotID:case Wt.ComputationRequestKind.GetEditFormat:case Wt.ComputationRequestKind.UpdateSnapshot:case Wt.ComputationRequestKind.GetFullTableHeadersFromServer:case Wt.ComputationRequestKind.CreateChatGPTSession:case Wt.ComputationRequestKind.CloseChatGPTSession:case Wt.ComputationRequestKind.SendChatGPTQuery:case Wt.ComputationRequestKind.SendAugLoopSignal:case Wt.ComputationRequestKind.AwaitEvent:case Wt.ComputationRequestKind.GetRecognizedRangeTables:return{kind:Wt.SchedulerTimelineQueueMessageKind.AsyncRequest,request:e,computation:r};default:return fOe(e,r)}}$C.wrapRequest=jAr;(0,p2.staticAssertExtends)();(0,p2.staticAssertExtends)();(0,p2.staticAssertExtends)();(0,p2.staticAssertExtends)()});var $R=T(Ou=>{"use strict";p();Object.defineProperty(Ou,"__esModule",{value:!0});Ou.makeEventCallbacksManager=Ou.makeALAnnotationNotifier=Ou.makeEventEmitter=Ou.isALAnnotationEventKind=Ou.ALAnnotationKinds=Ou.ExternallyHandledEventKinds=Ou.ExternallyTriggeredEventKinds=Ou.ALAnnotationKind=Ou.EventKind=void 0;var Hee=fe(),__=Ar(),zee=Qm(),tO;(function(e){e.InternalTestEvent="InternalTestEvent",e.TestEvent="TestEvent",e.FBECacheUpdateEvent="FBECacheUpdateEvent",e.FBESendSignal="FBESendSignal",e.FBEOutcomeUpdate="FBEOutcomeUpdate",e.FBECacheUpdateEventDeprecated="FBECacheUpdateEventDeprecated",e.FormulaTranspilerInitEvent="FormulaTranspilerInitEvent"})(tO||(Ou.EventKind=tO={}));var Qee;(function(e){e.FormulaByExample="FormulaByExample"})(Qee||(Ou.ALAnnotationKind=Qee={}));Ou.ExternallyTriggeredEventKinds=[tO.TestEvent,tO.FBEOutcomeUpdate,tO.FormulaTranspilerInitEvent];Ou.ExternallyHandledEventKinds=[tO.TestEvent];Ou.ALAnnotationKinds=(0,__.strEnumArray)(Qee);var WAr=function(r){return Ou.ALAnnotationKinds.findIndex(function(t){return r===t})>=0};Ou.isALAnnotationEventKind=WAr;(0,__.staticAssertSame)();(0,__.staticAssertSame)();(0,__.staticAssertSame)();(0,__.staticAssertSame)();(0,__.staticAssertSame)();(0,__.staticAssertSame)();function HAr(e){return(0,zee.mapFromArrayOfDependantPairs)(Ou.ExternallyTriggeredEventKinds.map(function(r){return[r,function(t){return e.triggerEvent(r,t).then(function(){})}]}))}Ou.makeEventEmitter=HAr;function zAr(e){var r=function(s){return function(l){return(0,__.isNone)(l)?Promise.resolve(null):Promise.resolve(e.triggerEvent(s,l))}};(0,__.staticAssertExtends)();for(var t={},n=0,a=Ou.ALAnnotationKinds;n<a.length;n++){var o=a[n];t[o]=r(o)}return t}Ou.makeALAnnotationNotifier=zAr;function QAr(){return Hee.__awaiter(this,void 0,void 0,function(){var e,r;return Hee.__generator(this,function(t){return e=(0,zee.mapFromArrayOfDependantPairs)(Ou.ExternallyHandledEventKinds.map(function(n){return[n,[]]})),r=function(a){return function(o){for(var u=0,s=e[a];u<s.length;u++){var l=s[u];l(o)}}},[2,Hee.__assign({registerEventCallback:function(a,o){return e[a].push(o)}},(0,zee.mapFromArrayOfDependantPairs)(Ou.ExternallyHandledEventKinds.map(function(n){return[n,r(n)]})))]})})}Ou.makeEventCallbacksManager=QAr});var gOe=T(nO=>{"use strict";p();Object.defineProperty(nO,"__esModule",{value:!0});nO.getBundledLocaleInfo=nO.convertKnownLCID=void 0;var mOe=ep();nO.convertKnownLCID=mOe.localeData.convertKnownLCID;nO.getBundledLocaleInfo=mOe.localeData.getBundledLocaleInfo});var Xee=T(l6=>{"use strict";p();Object.defineProperty(l6,"__esModule",{value:!0});l6.logSafeFailure=void 0;var vOe=fe(),hOe=zn();l6.logSafeFailure={failure:function(r){return vOe.__assign(vOe.__assign({},(0,hOe.failure)(r)),{logSafe:!0})},isSafe:function(r){return r.logSafe===!0},censored:function(r){return r.logSafe===!0?r:(0,hOe.failure)(void 0)}}});var COe=T(e1=>{"use strict";p();var Xt;Object.defineProperty(e1,"__esModule",{value:!0});e1.processSyncRequest=e1.processRequest=e1.requestProcessorMap=void 0;var qt=fe(),m2=Ar(),SOe=jR(),XAr=jR(),Wr=zn(),Ev=Gi(),yOe=No(),YAr=TG(),_Oe=CG(),fn=Xo(),bOe=qi(),c6=Xp(),Yee=s2(),JAr=Ms(),ZAr=$R(),$Ar=gOe(),ma=Xee(),aO=Yee.X10TaskInternal.createToken();function g2(e,r){return e.kind===Wr.ResultKind.Failure?e:(0,Wr.success)(r(e.value))}function d6(e){return qt.__awaiter(this,void 0,void 0,function(){var r,t;return qt.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r=Wr.success,[4,e];case 1:return[2,r.apply(void 0,[n.sent()])];case 2:return t=n.sent(),[2,(0,Wr.failure)(t)];case 3:return[2]}})})}e1.requestProcessorMap=(Xt={},Xt[fn.ComputationRequestKind.Delay]=function(){return(0,Wr.success)({})},Xt[fn.ComputationRequestKind.AwaitPromise]=function(e){var r=e.request.promise;return qt.__awaiter(void 0,void 0,void 0,function(){var t,n;return qt.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,r];case 1:return t=a.sent(),[2,(0,Wr.success)({result:t})];case 2:return n=a.sent(),[2,(0,Wr.failure)(n)];case 3:return[2]}})})},Xt[fn.ComputationRequestKind.CreateTask]=function(e){var r=e.request.request,t=e.handle,n=e.schedulerState,a=new Yee.X10TaskInternal(n.scheduler.processRequest(t,r,{onFulfilled:function(u){if(u.kind!==Wr.ResultKind.Success)throw{kind:"RequestFailure"};return u.value},onRejected:function(u){throw u}}),aO);return(0,Wr.success)({task:a})},Xt[fn.ComputationRequestKind.PromiseToTask]=function(e){var r=e.request.promise;return(0,Wr.success)({task:new Yee.X10TaskInternal(r,aO)})},Xt[fn.ComputationRequestKind.AwaitTask]=function(e){var r=e.request.task;return qt.__awaiter(void 0,void 0,void 0,function(){var t,n;return qt.__generator(this,function(a){switch(a.label){case 0:return t=Wr.success,n={},[4,d6(r.resolve(aO))];case 1:return[2,t.apply(void 0,[(n.result=a.sent(),n)])]}})})},Xt[fn.ComputationRequestKind.AwaitBatch]=function(e){var r=e.request.tasks;return qt.__awaiter(void 0,void 0,void 0,function(){var t,n,a,o,u,s;return qt.__generator(this,function(l){switch(l.label){case 0:t=[],n=0,a=r,l.label=1;case 1:return n<a.length?(o=a[n],s=(u=t).push,[4,d6(o.resolve(aO))]):[3,4];case 2:s.apply(u,[l.sent()]),l.label=3;case 3:return n++,[3,1];case 4:return[2,(0,Wr.success)({results:t})]}})})},Xt[fn.ComputationRequestKind.AwaitAll]=function(e){var r=e.request.tasks;return qt.__awaiter(void 0,void 0,void 0,function(){var t,n,a;return qt.__generator(this,function(o){switch(o.label){case 0:return t=SOe.MaybeThenable.all(r.map(function(u){return u.resolve(aO)})),n=Wr.success,a={},[4,d6(t)];case 1:return[2,n.apply(void 0,[(a.result=o.sent(),a)])]}})})},Xt[fn.ComputationRequestKind.AwaitAny]=function(e){var r=e.request.tasks;return qt.__awaiter(void 0,void 0,void 0,function(){var t,n,a;return qt.__generator(this,function(o){switch(o.label){case 0:return t=SOe.MaybeThenable.any(r.map(function(u){return u.resolve(aO)})),n=Wr.success,a={},[4,d6(t)];case 1:return[2,n.apply(void 0,[(a.result=o.sent(),a)])]}})})},Xt[fn.ComputationRequestKind.GetCell]=function(e){var r=e.request.cell,t=e.cache;return qt.__awaiter(void 0,void 0,void 0,function(){var n;return qt.__generator(this,function(a){switch(a.label){case 0:return t===void 0?[2,ma.logSafeFailure.failure("Cache is undefined")]:[4,t.getCell(r)];case 1:return n=a.sent(),[2,(0,Wr.success)({result:n})]}})})},Xt[fn.ComputationRequestKind.GetContainingTable]=function(e){var r=e.request.cell,t=e.cache;return qt.__awaiter(void 0,void 0,void 0,function(){var n;return qt.__generator(this,function(a){switch(a.label){case 0:return t===void 0?[2,ma.logSafeFailure.failure("Cache is undefined")]:[4,t.getContainingTable(r)];case 1:return n=a.sent(),[2,(0,Wr.success)({result:n})]}})})},Xt[fn.ComputationRequestKind.UnsafeGetContainingTableName]=function(e){var r=e.request.cell,t=e.cache;if(t===void 0)return ma.logSafeFailure.failure("Cache is undefined");var n=t.getContainingTableName(r);return(0,Wr.success)({result:n})},Xt[fn.ComputationRequestKind.GetAvailableTableHeaders]=function(e){var r=e.request.tableName,t=e.cache;if(t===void 0)return ma.logSafeFailure.failure("Cache is undefined");var n=t.getAvailableTableHeaders(r);return(0,Wr.success)({result:n})},Xt[fn.ComputationRequestKind.GetIntersectingTables]=function(e){var r=e.request.range,t=e.cache;return qt.__awaiter(void 0,void 0,void 0,function(){var n;return qt.__generator(this,function(a){switch(a.label){case 0:return t===void 0?[2,ma.logSafeFailure.failure("Cache is undefined")]:[4,t.getIntersectingTables(r)];case 1:return n=a.sent(),[2,(0,Wr.success)({result:n})]}})})},Xt[fn.ComputationRequestKind.UnsafeGetIntersectingTableNames]=function(e){var r=e.request.range,t=e.cache;if(t===void 0)return ma.logSafeFailure.failure("Cache is undefined");var n=t.getIntersectingTableNames(r);return(0,Wr.success)({result:n})},Xt[fn.ComputationRequestKind.GetRange]=function(e){var r=e.request,t=r.range,n=r.layers,a=e.cache;return qt.__awaiter(void 0,void 0,void 0,function(){var o;return qt.__generator(this,function(u){switch(u.label){case 0:return a===void 0?[2,ma.logSafeFailure.failure("Cache is undefined")]:[4,a.getRange(t,n)];case 1:return o=u.sent(),[2,(0,Wr.success)({localSheetGrid:o})]}})})},Xt[fn.ComputationRequestKind.GetSheetNames]=function(e){var r=e.cache;return r===void 0?ma.logSafeFailure.failure("Cache is undefined"):r.getSheetNames()},Xt[fn.ComputationRequestKind.GetStructRefColumn]=function(e){var r=e.request,t=r.table,n=r.nameOrCol,a=e.cache;if(a===void 0)return ma.logSafeFailure.failure("Cache is undefined");var o=a.getStructRefColumn(t,n);return(0,Wr.success)({result:o})},Xt[fn.ComputationRequestKind.GetStructRefSpecialRef]=function(e){var r=e.request,t=r.table,n=r.id,a=e.cache;if(a===void 0)return ma.logSafeFailure.failure("Cache is undefined");var o=a.getStructRefSpecialRef(t,n);return(0,Wr.success)({result:o})},Xt[fn.ComputationRequestKind.GetIformat]=function(e){var r=e.request,t=r.document,n=r.iformat,a=e.cache;return qt.__awaiter(void 0,void 0,void 0,function(){var o;return qt.__generator(this,function(u){switch(u.label){case 0:return a===void 0?[2,ma.logSafeFailure.failure("Cache is undefined")]:[4,a.getIformat(t,n)];case 1:return o=u.sent(),[2,(0,Wr.success)({result:o})]}})})},Xt[fn.ComputationRequestKind.ParseCellFormula]=function(e){var r=e.request,t=r.cell,n=r.formula,a=r.useEnglishLocaleInfo,o=e.cache;return o===void 0?ma.logSafeFailure.failure("Cache is undefined"):(0,Wr.success)(o.parseCellFormula(t,n,a))},Xt[fn.ComputationRequestKind.ParseEdit]=function(e){var r=e.request,t=r.cell,n=r.formulaBarText,a=e.cache;return qt.__awaiter(void 0,void 0,void 0,function(){var o;return qt.__generator(this,function(u){switch(u.label){case 0:return a===void 0?[2,ma.logSafeFailure.failure("Cache is undefined")]:(o=Wr.success,[4,a.parseEdit(t,n)]);case 1:return[2,o.apply(void 0,[u.sent()])]}})})},Xt[fn.ComputationRequestKind.ParseActiveCell]=function(e){var r=e.request.formulaText,t=e.schedulerState,n=t.activeCell,a=t.activeCellFormat,o=e.cache;if(o===void 0)return ma.logSafeFailure.failure("Cache is undefined");if((0,m2.isNone)(n))return ma.logSafeFailure.failure("Active Cell is undefined");if(a===void 0)return ma.logSafeFailure.failure("Active Cell Format is undefined");var u=a??{formatString:"General",builtIn:!0};return(0,Wr.success)(o.parseEditSync(n,r,u))},Xt[fn.ComputationRequestKind.ParseNumberFormat]=function(e){var r=e.request,t=r.formatString,n=r.builtIn,a=e.cache;return a===void 0?ma.logSafeFailure.failure("Cache is undefined"):(0,Wr.success)(a.parseNumberFormat(t,n))},Xt[fn.ComputationRequestKind.PrintFormula]=function(e){var r=e.request,t=r.formula,n=r.origin,a=e.config;if(a===void 0)return(0,Wr.failure)([]);var o=(0,YAr.createPrinter)((0,_Oe.createSimplePrintGlobals)(a)),u=o.printFormula((0,_Oe.printLocalsGrid)((0,yOe.lexicalSourceGrid)(yOe.LexicalKind.Cell,n),n),t);return(0,Wr.success)({result:u})},Xt[fn.ComputationRequestKind.GetActiveCell]=function(e){var r=e.schedulerState.activeCell;return r===void 0?(Ev.ulsLogger.ULS.traceTag(512274723,Ev.LogCategory.msoulscat_ES_EWAJS,Ev.TraceLevel.Info,c6.x10Logger.formatLogMessage("GetActiveCell",{description:"failed because activeCell was undefined"})),ma.logSafeFailure.failure("Active Cell is undefined")):(0,Wr.success)({activeCell:r})},Xt[fn.ComputationRequestKind.GetActiveCellFormat]=function(e){var r=e.schedulerState.activeCellFormat;return r===void 0?ma.logSafeFailure.failure("Active Cell Format is undefined"):r===null?(0,Wr.success)({result:(0,Wr.failure)((0,bOe.unavailable)(["unavailableFormat"]))}):(0,Wr.success)({result:(0,Wr.success)(r)})},Xt[fn.ComputationRequestKind.GetConfig]=function(e){var r=e.config;return r===void 0?ma.logSafeFailure.failure("Config is undefined"):(0,Wr.success)({config:r})},Xt[fn.ComputationRequestKind.GetCultureTag]=function(e){var r=e.request.lcid,t=(0,$Ar.convertKnownLCID)(r),n=t.toString();return n.indexOf("-")===-1?ma.logSafeFailure.failure("Culture-Tag '".concat(n,"' from LCID '").concat(r,"' has an unknown format")):(0,Wr.success)({cultureTag:n})},Xt[fn.ComputationRequestKind.GetFunctionsInfo]=function(e){var r=e.schedulerState,t=r.functionsInfoMap;if(t===void 0)return Ev.ulsLogger.ULS.traceTag(512274722,Ev.LogCategory.msoulscat_ES_EWAJS,Ev.TraceLevel.Info,c6.x10Logger.formatLogMessage("GetFunctionsInfo",{description:"failed because functionsInfoMap was undefined"})),ma.logSafeFailure.failure("functionsInfoMap is undefined");var n=Object.keys(t).map(function(a){return t[a]});return(0,Wr.success)({functionsInfo:n})},Xt[fn.ComputationRequestKind.GetFunctionInfo]=function(e){var r=e.request.functionName,t=e.schedulerState;if(t.functionsInfoMap===void 0)return Ev.ulsLogger.ULS.traceTag(512274721,Ev.LogCategory.msoulscat_ES_EWAJS,Ev.TraceLevel.Info,c6.x10Logger.formatLogMessage("GetFunctionInfo",{description:"failed because functionsInfoMap was undefined"})),ma.logSafeFailure.failure("functionsInfoMap is undefined");var n=t.functionsInfoMap[r.toUpperCase()];return n===void 0?ma.logSafeFailure.failure("functionsInfo is undefined"):(0,Wr.success)({functionInfo:n})},Xt[fn.ComputationRequestKind.GetDefinedNamesInfo]=function(e){var r=e.schedulerState,t=r.definedNamesInfoMap;if(t===void 0)return Ev.ulsLogger.ULS.traceTag(512274720,Ev.LogCategory.msoulscat_ES_EWAJS,Ev.TraceLevel.Info,c6.x10Logger.formatLogMessage("GetDefinedNamesInfo",{description:"failed because definedNamesInfoMap was undefined"})),ma.logSafeFailure.failure("definedNamesInfoMap is undefined");var n=Object.keys(t).map(function(a){return t[a]});return(0,Wr.success)({definedNamesInfo:n})},Xt[fn.ComputationRequestKind.GetDefinedNameInfo]=function(e){var r=e.request.definedName,t=e.schedulerState;if(t.definedNamesInfoMap===void 0)return ma.logSafeFailure.failure("definedNamesInfoMap is undefined");var n=t.definedNamesInfoMap[r.toUpperCase()];return(0,Wr.success)({definedNameInfo:n})},Xt[fn.ComputationRequestKind.EvalOnClonedModel]=function(e){var r=e.cache,t=e.request;return qt.__awaiter(void 0,void 0,void 0,function(){var n;return qt.__generator(this,function(a){switch(a.label){case 0:return[4,r==null?void 0:r.evalOnClonedModel(t.updates,t.edits,t.formatResults)];case 1:return n=a.sent(),n===void 0?[2,ma.logSafeFailure.failure("Operation did not return a result")]:n.kind!==Wr.ResultKind.Success?[2,ma.logSafeFailure.failure("Operation returned an unsuccessful result")]:[2,(0,Wr.success)({result:n.value})]}})})},Xt[fn.ComputationRequestKind.EvalFormula]=function(e){var r=e.cache,t=e.request;return qt.__awaiter(void 0,void 0,void 0,function(){var n;return qt.__generator(this,function(a){switch(a.label){case 0:return[4,r==null?void 0:r.evalFormula(t.formula,t.origin,t.format)];case 1:return n=a.sent(),n===void 0?[2,ma.logSafeFailure.failure("Operation did not return a result")]:n.kind!==Wr.ResultKind.Success?[2,ma.logSafeFailure.failure("Operation returned an unsuccessful result")]:[2,(0,Wr.success)({result:n.value})]}})})},Xt[fn.ComputationRequestKind.GetCorrelationId]=function(e){var r=e.correlationId;return(0,Wr.success)({correlationId:r})},Xt[fn.ComputationRequestKind.SetActiveCell]=function(e){return e.schedulerState=qt.__assign(qt.__assign({},e.schedulerState),{activeCell:e.request.activeCell,activeCellFormat:e.request.activeCellFormat}),(0,Wr.success)({})},Xt[fn.ComputationRequestKind.GetRichValueFieldListContext]=function(e){var r=e.schedulerState,t=e.request,n=t.rangeToQuery,a=t.dotNotationPath,o=t.singleColumn,u=t.findRange;return qt.__awaiter(void 0,void 0,void 0,function(){var s,l;return qt.__generator(this,function(c){switch(c.label){case 0:return s=r.serverDataProvider,(0,m2.isNone)(s)?[2,ma.logSafeFailure.failure("serverDataProvider is undefined")]:[4,s.getRichValueFieldListContext(n,a,o,u)];case 1:return l=c.sent(),(0,JAr.isTypedChangeGateEnabled)("OfficeVSO:8575821_x10MapGetRichValueFieldListContext")||(0,Wr.success)({result:l}),[2,(0,Wr.success)({result:l})]}})})},Xt[fn.ComputationRequestKind.GetHiddenRows]=function(e){var r=e.cache,t=e.request;return qt.__awaiter(void 0,void 0,void 0,function(){var n;return qt.__generator(this,function(a){switch(a.label){case 0:return r===void 0?[2,(0,Wr.failure)([])]:[4,r.getHiddenRows(t.sheet,t.start,t.endExclusive)];case 1:return n=a.sent(),[2,(0,Wr.success)({result:n})]}})})},Xt[fn.ComputationRequestKind.GetHiddenCols]=function(e){var r=e.cache,t=e.request;return qt.__awaiter(void 0,void 0,void 0,function(){var n;return qt.__generator(this,function(a){switch(a.label){case 0:return r===void 0?[2,(0,Wr.failure)([])]:[4,r.getHiddenCols(t.sheet,t.start,t.endExclusive)];case 1:return n=a.sent(),[2,(0,Wr.success)({result:n})]}})})},Xt[fn.ComputationRequestKind.ResolveReferences]=function(e){var r=e.cache,t=e.request,n=t.locals,a=t.nodes;if(r===void 0)return ma.logSafeFailure.failure("Cache is undefined");if(n===void 0)return ma.logSafeFailure.failure("Locals is undefined");if(a===void 0)return ma.logSafeFailure.failure("Nodes is undefined");var o=r.resolveReferences(n,a);return(0,Wr.success)({resolverResults:o})},Xt[fn.ComputationRequestKind.GetCorrespondingSnapshotID]=function(e){var r=e.cache;return qt.__awaiter(void 0,void 0,void 0,function(){var t;return qt.__generator(this,function(n){switch(n.label){case 0:return r===void 0?[2,ma.logSafeFailure.failure("Cache is undefined")]:[4,r.getCorrespondingSnapshotID()];case 1:return t=n.sent(),[2,(0,Wr.success)({snapshotID:t})]}})})},Xt[fn.ComputationRequestKind.GetEditFormat]=function(e){var r=e.cache,t=e.request.cell;return qt.__awaiter(void 0,void 0,void 0,function(){var n;return qt.__generator(this,function(a){switch(a.label){case 0:return r===void 0?[2,ma.logSafeFailure.failure("Cache is undefined")]:[4,r.getEditFormat(t)];case 1:return n=a.sent(),[2,(0,Wr.success)({result:n===void 0?(0,Wr.failure)((0,bOe.unavailable)(["Unavailable Format"])):(0,Wr.success)(n)})]}})})},Xt[fn.ComputationRequestKind.UpdateSnapshot]=function(e){var r=e.handle,t=e.schedulerState;return qt.__awaiter(void 0,void 0,void 0,function(){var n;return qt.__generator(this,function(a){switch(a.label){case 0:return[4,t.scheduler.updatePrefetchingCache(r)];case 1:return n=a.sent(),[2,n===void 0?ma.logSafeFailure.failure("Cache is undefined"):(0,Wr.success)({snapshotID:n})]}})})},Xt[fn.ComputationRequestKind.GetFullTableHeadersFromServer]=function(e){var r=e.schedulerState,t=e.request.tableName;return qt.__awaiter(void 0,void 0,void 0,function(){var n,a;return qt.__generator(this,function(o){switch(o.label){case 0:return n=r.serverDataProvider,(0,m2.isNone)(n)?[2,ma.logSafeFailure.failure("serverDataProvider is undefined")]:[4,n.getTableColHeaders(t)];case 1:return a=o.sent(),(0,m2.isNone)(a)?[2,(0,Wr.success)({result:[]})]:[2,(0,Wr.success)({result:a.filter(m2.isDefined)})]}})})},Xt[fn.ComputationRequestKind.CreateChatGPTSession]=function(e){var r=e.schedulerState.scheduler,t=e.finalizer,n=e.request.options;return qt.__awaiter(void 0,void 0,void 0,function(){var a;return qt.__generator(this,function(o){switch(o.label){case 0:return n===void 0?[2,ma.logSafeFailure.failure("Request contained undefined 'options'")]:[4,r.createChatGPTSession(n)];case 1:return a=o.sent(),a.kind===Wr.ResultKind.Success&&t.subscribe(function(){return r.closeChatGPTSession(a.value)}),[2,g2(a,function(u){return{result:u}})]}})})},Xt[fn.ComputationRequestKind.CloseChatGPTSession]=function(e){var r=e.schedulerState.scheduler,t=e.request.session;return qt.__awaiter(void 0,void 0,void 0,function(){var n;return qt.__generator(this,function(a){switch(a.label){case 0:return n=g2,[4,r.closeChatGPTSession(t)];case 1:return[2,n.apply(void 0,[a.sent(),function(){return{result:void 0}}])]}})})},Xt[fn.ComputationRequestKind.SendChatGPTQuery]=function(e){var r=e.schedulerState.scheduler,t=e.request,n=t.session,a=t.request;return qt.__awaiter(void 0,void 0,void 0,function(){var o;return qt.__generator(this,function(u){switch(u.label){case 0:return[4,r.sendChatGPTQuery(n,a)];case 1:return o=u.sent(),[2,g2(o,function(s){return{result:s}})]}})})},Xt[fn.ComputationRequestKind.IsSchedulerFeatureEnabled]=function(e){var r=e.schedulerState.scheduler,t=e.request.feature,n=r.isSchedulerFeatureEnabled(t);return(0,Wr.success)({isFeatureEnabled:n})},Xt[fn.ComputationRequestKind.SendAugLoopSignal]=function(e){var r=e.schedulerState.scheduler,t=e.handle,n=e.request.signal;return qt.__awaiter(void 0,void 0,void 0,function(){var a;return qt.__generator(this,function(o){switch(o.label){case 0:return[4,r.sendAugLoopSignal(n,t.info.computationIdentifier.factoryName)];case 1:return a=o.sent(),[2,g2(a,function(u){return{result:u}})]}})})},Xt[fn.ComputationRequestKind.TriggerEvent]=function(e){var r=e.schedulerState.scheduler,t=e.request,n=t.eventKind,a=t.event;return r.triggerEventImmediate(n,a),(0,Wr.success)({})},Xt[fn.ComputationRequestKind.AwaitEvent]=function(e){var r=e.schedulerState.scheduler,t=e.request;return qt.__awaiter(void 0,void 0,void 0,function(){var n,a;return qt.__generator(this,function(o){switch(o.label){case 0:return(0,ZAr.isALAnnotationEventKind)(t.eventKind)?[4,r.registerALAnnotation(t.eventKind)]:[3,2];case 1:if(n=o.sent(),n.kind!==Wr.ResultKind.Success)return[2,n];o.label=2;case 2:return[4,r.catchEvent(t)];case 3:return a=o.sent(),[2,(0,Wr.success)({result:a})]}})})},Xt[fn.ComputationRequestKind.GetRecognizedRangeTables]=function(e){var r=e.schedulerState.scheduler,t=e.handle,n=e.request,a=n.sheetId,o=n.range,u=n.metadataStates,s=n.maxRevisions;return qt.__awaiter(void 0,void 0,void 0,function(){var l;return qt.__generator(this,function(c){switch(c.label){case 0:return[4,r.getRecognizedTablesInfo(a,o,u,t.info.computationIdentifier.factoryName,s)];case 1:return l=c.sent(),[2,g2(l,function(d){return{result:d}})]}})})},Xt);function eFr(e,r,t,n,a){var o=t.info.correlationId,u=t.schedulerState,s=t.finalizer,l=e[r.kind],c={request:r,correlationId:o,cache:n,config:a,schedulerState:u,finalizer:s,handle:t},d=l(c);return(0,XAr.bindMaybeThenable)(d,function(f){return f.kind!==Wr.ResultKind.Success?ma.logSafeFailure.censored(f):(t.schedulerState=c.schedulerState,(0,Wr.success)(qt.__assign({kind:r.kind},f.value)))})}e1.processRequest=eFr;function rFr(e,r,t,n,a){var o=t.info.correlationId,u=t.schedulerState,s=t.finalizer,l=e[r.kind],c={request:r,correlationId:o,cache:n,config:a,schedulerState:u,finalizer:s,handle:t},d=l(c);return d.kind!==Wr.ResultKind.Success?ma.logSafeFailure.censored(d):(t.schedulerState=c.schedulerState,(0,Wr.success)(qt.__assign({kind:r.kind},d.value)))}e1.processSyncRequest=rFr});var Jee=T(f6=>{"use strict";p();Object.defineProperty(f6,"__esModule",{value:!0});f6.PriorityQueue=void 0;var tFr=pr();f6.PriorityQueue=tFr.priorityQueue.PriorityQueue});var Zee=T(p6=>{"use strict";p();Object.defineProperty(p6,"__esModule",{value:!0});p6.PackageName=void 0;p6.PackageName="excel-online-calc-recalc"});var TOe=T(m6=>{"use strict";p();Object.defineProperty(m6,"__esModule",{value:!0});m6.getExcelOnlineCalcNewPackagesNames=void 0;var nFr=pr(),aFr=qr(),iFr=Jf(),oFr=ep(),uFr=ov(),sFr=Zee(),lFr="".concat(nFr.PackageName,", ").concat(aFr.PackageName,",\n  ").concat(iFr.PackageName,", ").concat(oFr.PackageName,", ").concat(uFr.PackageName,", ").concat(sFr.PackageName);function cFr(){return lFr}m6.getExcelOnlineCalcNewPackagesNames=cFr});var ROe=T(g6=>{"use strict";p();Object.defineProperty(g6,"__esModule",{value:!0});g6.ChatGPTService=void 0;var iO=fe(),dFr=Ar(),r1=zn(),fFr=function(){function e(r){this.provider=r,this.set=new Set}return e.prototype.createSession=function(r){return iO.__awaiter(this,void 0,void 0,function(){var t;return iO.__generator(this,function(n){switch(n.label){case 0:return[4,this.provider.openChat(r)];case 1:return t=n.sent(),(0,dFr.isDefined)(t)?(this.set.add(t),[2,(0,r1.success)(t)]):[2,(0,r1.failure)(void 0)]}})})},e.prototype.closeSession=function(r){return iO.__awaiter(this,void 0,void 0,function(){var t;return iO.__generator(this,function(n){switch(n.label){case 0:if(!this.set.has(r))return[2,(0,r1.failure)(void 0)];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.provider.close(r)];case 2:return n.sent(),this.set.delete(r),[2,(0,r1.success)(void 0)];case 3:return t=n.sent(),[2,(0,r1.failure)(void 0)];case 4:return[2]}})})},e.prototype.request=function(r,t){return iO.__awaiter(this,void 0,void 0,function(){var n,a;return iO.__generator(this,function(o){switch(o.label){case 0:if(!this.set.has(r))return[2,(0,r1.failure)(void 0)];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.provider.send(r,t)];case 2:return n=o.sent(),[2,(0,r1.success)(n)];case 3:return a=o.sent(),[2,(0,r1.failure)(void 0)];case 4:return[2]}})})},e}();g6.ChatGPTService=fFr});var AOe=T(oO=>{"use strict";p();Object.defineProperty(oO,"__esModule",{value:!0});oO.X10ExceptionComputationTermination=oO.X10Exception=void 0;var EOe=fe(),POe=function(e){EOe.__extends(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r}(Error);oO.X10Exception=POe;var pFr=function(e){EOe.__extends(r,e);function r(t){var n=e.call(this,"Computation execution was terminated with '".concat(t,"'."))||this;return n.stopReason=t,n}return r}(POe);oO.X10ExceptionComputationTermination=pFr});var NOe=T(v6=>{"use strict";p();Object.defineProperty(v6,"__esModule",{value:!0});v6.ComputationFinalizer=void 0;var mFr=fe(),eE=Gi(),gFr=s2(),FOe=AOe(),vFr=Ba(),b_=Xp(),t1=Xo(),hFr=function(){function e(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this.subject=new gFr.Subject,this.isClosed=!1;for(var n=0,a=r;n<a.length;n++){var o=a[n];this.subscribe(o)}}return e.prototype.subscribe=function(r){if(this.isClosed){b_.x10Logger.log({kind:"failure",payload:{failureKind:b_.X10FailureKind.AssertionFailure,failureLevel:eE.TraceLevel.Warning,path:"PluginFinalizer.subscribe",description:"subscription for a closed finalizer was requested"}});return}return this.subject.subscribe(r)},e.prototype.finalize=function(r,t){var n=this.extractComputationInfo(r);if(t===t1.ExecutionStopReason.Unknown&&b_.x10Logger.log({kind:"failure",payload:{failureKind:b_.X10FailureKind.AssertionFailure,failureLevel:eE.TraceLevel.Warning,path:"PluginFinalizer.finalize",description:"finalize was invoked with an unknown stop reason",data:n}}),this.isClosed){b_.x10Logger.log({kind:"failure",payload:{failureKind:b_.X10FailureKind.AssertionFailure,failureLevel:eE.TraceLevel.Warning,path:"PluginFinalizer.finalize",description:"finalizer was invoked more than once",data:mFr.__assign({stopReason:t},n)}});return}this.isClosed=!0,this.finalizeComputationGeneratorExecution(r,t),this.subject.next({computationInfo:n,stopReason:t})},e.prototype.finalizeComputationGeneratorExecution=function(r,t){switch(t){case t1.ExecutionStopReason.Unknown:case t1.ExecutionStopReason.Frame.Timeout:case t1.ExecutionStopReason.Frame.Superseded:case t1.ExecutionStopReason.Frame.ConflictResolverEarlyTermination:var n=!1;try{r.generator.throw(new FOe.X10ExceptionComputationTermination(t))}catch(a){n=!0,a instanceof FOe.X10ExceptionComputationTermination&&a.stopReason&&(a==null?void 0:a.stopReason)!==t&&eE.ulsLogger.ULS.traceTag(508903693,eE.LogCategory.msoulscat_ES_EWAJS,eE.TraceLevel.Warning,b_.x10Logger.formatLogMessage("finalizeComputationGeneratorExecution",{description:"computation threw an exception during execution",data:r.info}))}finally{n||b_.x10Logger.log({kind:"failure",payload:{failureKind:b_.X10FailureKind.AssertionFailure,failureLevel:eE.TraceLevel.Warning,path:"ComputationFinalizer.finalizeComputationGeneratorExecution",description:"computation terminated by x10 with exception but did not threw the exception back",data:r.info}})}break;case t1.ExecutionStopReason.Computation.Done:case t1.ExecutionStopReason.Computation.Skipped:case t1.ExecutionStopReason.Computation.Exception:break;default:(0,vFr.assertNever)("Unknown stopReason",t)}},e.prototype.extractComputationInfo=function(r){var t,n,a=r.info;a.totalRuntime=r.info.computationTime;for(var o in r.info.requestTimes)a.totalRuntime+=(n=(t=r.info.requestTimes[o])===null||t===void 0?void 0:t.requestDuration)!==null&&n!==void 0?n:0;return a},e}();v6.ComputationFinalizer=hFr});var h2=T(uO=>{"use strict";p();var h6;Object.defineProperty(uO,"__esModule",{value:!0});uO.ComputationKinds=uO.ComputationType=void 0;var OOe=fe(),v2=Ar(),SFr=Xo(),kOe=$R(),S6;(function(e){e.UIMessage="UIMessage",e.Event="Event"})(S6||(uO.ComputationType=S6={}));uO.ComputationKinds=(h6={},h6[S6.UIMessage]=SFr.RequestKind,h6[S6.Event]=OOe.__assign(OOe.__assign({},kOe.EventKind),kOe.ALAnnotationKind),h6);(0,v2.staticAssertSame)();(0,v2.staticAssertExtends)();(0,v2.staticAssertExtends)();(0,v2.staticAssertExtends)();(0,v2.staticAssertExtends)()});var y6=T(jh=>{"use strict";p();Object.defineProperty(jh,"__esModule",{value:!0});jh.getShouldRunComputationPredicate=jh.computationRegistry=jh.registerComputation=jh.wrapRegistration=void 0;var yFr=Ar(),xOe=h2(),S2=Qm(),MOe=yc(),$ee=BM(),_Fr=function(){function e(){this.registeredComputations=new S2.DefaultMap({getKey:function(t){return"".concat(t.computationIdentifier.factoryName,".").concat(t.computationIdentifier.pluginName,".").concat(t.computationIdentifier.computationName)},getDefault:function(){return!1}}),this.byFactoryName=new S2.DefaultMap({getKey:function(t){return"".concat(t.factoryName,".").concat(t.pluginName)},getDefault:function(){return[]}})}return e.prototype.push=function(r,t){if(this.registeredComputations.get(t)){$ee.ulsLogger.ULS.traceTag(507330770,$ee.LogCategory.msoulscat_ES_EWAJS,$ee.TraceLevel.Warning,"Computation '".concat(t.computationIdentifier,"' already registered"));return}this.byFactoryName.get(r).push(t),this.registeredComputations.set(t,!0)},e.prototype.getRegistrationsByPluginIdentifier=function(r){return this.byFactoryName.get(r)},e.prototype.getRegistrationsByComputationIdentifier=function(r){return this.getRegistrationsByPluginIdentifier(r).find(function(t){return t.computationIdentifier.computationName===r.computationName})},e}(),IOe=(0,S2.mapFromArrayOfDependantPairs)((0,yFr.strEnumArray)(xOe.ComputationType).map(function(e){return[e,new _Fr]})),bFr=function(r,t,n,a,o,u,s,l){var c=wOe({type:r,kind:t,pluginGroup:a,modifiers:u},l);return{type:r,kind:t,execution:n,pluginGroup:a,computationIdentifier:o,modifiers:u,registrationMethod:function(f,m){return function(v){var h=v[0],y=v[1];if(!c(h.computationInput,y)){f.addResult({type:r,computationKind:t,computationIdentifier:o,computationGroup:h.computationGroup,correlationId:h.correlationId},{kind:"Skipped"});return}var _=s.bind(m);f.startComputation(r,t,n,o,_(h.computationInput),h)}}}};jh.wrapRegistration=bFr;var CFr=function(r,t,n,a,o,u,s,l){var c=(0,jh.wrapRegistration)(r,t,n,a,o,u,s,l);IOe[r].push(o,c)};jh.registerComputation=CFr;jh.computationRegistry=IOe;function wOe(e,r){return function(t,n){for(var a=0,o=EFr;a<o.length;a++){var u=o[a];if(!u({registration:e,input:t,pluginGroup:n}))return!1}return r===void 0||r(t,n)}}jh.getShouldRunComputationPredicate=wOe;var TFr=function(r){var t=r.registration,n=r.pluginGroup;return n===void 0||n===t.pluginGroup},RFr=function(r){var t=r.registration,n=r.input;if(t.type!==xOe.ComputationType.UIMessage||t.modifiers.runOnNonFormula||((0,S2.staticTypeHint)(t.kind),!(0,MOe.isFormulaRequest)(t.kind)))return!0;var a=[t.kind,n];(0,S2.staticTypeHint)(a);var o=(0,MOe.getFormulaContent)(a);return["=","+","-"].indexOf(o[0])!==-1},EFr=[TFr,RFr]});var GOe=T(n1=>{p();Object.defineProperty(n1,"__esModule",{value:!0});n1.ValueType=n1.FormulaByExampleResultKind=n1.FormulaByExampleInvocationMethod=void 0;var DOe;(function(e){e[e.Success=0]="Success",e[e.NoFormulas=1]="NoFormulas",e[e.Failed=2]="Failed"})(DOe||(n1.FormulaByExampleResultKind=DOe={}));var LOe;(function(e){e[e.Explicit=0]="Explicit",e[e.Implicit=1]="Implicit"})(LOe||(n1.FormulaByExampleInvocationMethod=LOe={}));var qOe;(function(e){e[e.General=0]="General",e[e.Number=1]="Number",e[e.DateTime=2]="DateTime"})(qOe||(n1.ValueType=qOe={}))});var UOe=T(LS=>{p();Object.defineProperty(LS,"__esModule",{value:!0});LS.FormulaByExampleWarmUpSignal=LS.FormulaByExampleWarmUpAnnotation=LS.FormulaByExampleSignal=LS.FormulaByExampleAnnotation=void 0;var a1=ZS();function _6(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function BOe(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PFr(n.key),n)}}function b6(e,r,t){return r&&BOe(e.prototype,r),t&&BOe(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function PFr(e){var r=AFr(e,"string");return typeof r=="symbol"?r:String(r)}function AFr(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var ere=LS.FormulaByExampleSignal=function(){function e(r){_6(this,e),a1.SchemaObject.assign(e,this,r)}return b6(e,null,[{key:"getTypeName",value:function(){return"AugLoop_FormulaByExample_FormulaByExampleSignal"}},{key:"getBaseTypes",value:function(){return["AugLoop_Signals_Signal"]}},{key:"typeGuard",value:function(t){return a1.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();ere.H_={T_:ere.getTypeName(),B_:ere.getBaseTypes()};var rre=LS.FormulaByExampleWarmUpSignal=function(){function e(r){_6(this,e),a1.SchemaObject.assign(e,this,r)}return b6(e,null,[{key:"getTypeName",value:function(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpSignal"}},{key:"getBaseTypes",value:function(){return["AugLoop_Signals_Signal"]}},{key:"typeGuard",value:function(t){return a1.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();rre.H_={T_:rre.getTypeName(),B_:rre.getBaseTypes()};var tre=LS.FormulaByExampleAnnotation=function(){function e(r){_6(this,e),a1.SchemaObject.assign(e,this,r)}return b6(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_FormulaByExample_FormulaByExampleAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return a1.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();tre.H_={T_:tre.getTypeName(),B_:tre.getBaseTypes()};var nre=LS.FormulaByExampleWarmUpAnnotation=function(){function e(r){_6(this,e),a1.SchemaObject.assign(e,this,r)}return b6(e,[{key:"metadata",get:function(){return this.M_},set:function(t){this.M_=t}}],[{key:"getTypeName",value:function(){return"AugLoop_FormulaByExample_FormulaByExampleWarmUpAnnotation"}},{key:"getBaseTypes",value:function(){return["AugLoop_Core_Annotation"]}},{key:"typeGuard",value:function(t){return a1.SchemaObject.matchesTypesFor(t,[e.getTypeName()])}}]),e}();nre.H_={T_:nre.getTypeName(),B_:nre.getBaseTypes()}});var KOe=T(i1=>{p();Object.defineProperty(i1,"__esModule",{value:!0});var are=GOe();Object.keys(are).forEach(function(e){e==="default"||e==="__esModule"||e in i1&&i1[e]===are[e]||Object.defineProperty(i1,e,{enumerable:!0,get:function(){return are[e]}})});var ire=UOe();Object.keys(ire).forEach(function(e){e==="default"||e==="__esModule"||e in i1&&i1[e]===ire[e]||Object.defineProperty(i1,e,{enumerable:!0,get:function(){return ire[e]}})})});var C6=T(sO=>{"use strict";p();Object.defineProperty(sO,"__esModule",{value:!0});sO.ALAnnotationKind=sO.EventKind=void 0;var VOe=$R();Object.defineProperty(sO,"EventKind",{enumerable:!0,get:function(){return VOe.EventKind}});Object.defineProperty(sO,"ALAnnotationKind",{enumerable:!0,get:function(){return VOe.ALAnnotationKind}})});var WOe=T(C_=>{"use strict";p();var ore,ure;Object.defineProperty(C_,"__esModule",{value:!0});C_.AnnotationDefinitionsMap=C_.RegisterAnnotation=C_.alFeatureNamePrefix=void 0;var FFr=KOe(),NFr=Ar(),sre=C6(),OFr=Qm();C_.alFeatureNamePrefix="x10";var jOe=(ore={},ore[sre.ALAnnotationKind.FormulaByExample]={annotationType:FFr.FormulaByExampleAnnotation,isModelRequired:!1},ore);C_.RegisterAnnotation=(ure={},ure[sre.ALAnnotationKind.FormulaByExample]=!0,ure);C_.AnnotationDefinitionsMap=(0,OFr.mapFromArrayOfDependantPairs)((0,NFr.strEnumArray)(sre.ALAnnotationKind).map(function(e){return[e,{annotationName:jOe[e].annotationType.getTypeName(),featureName:"".concat(C_.alFeatureNamePrefix,"_").concat(e),isModelRequired:jOe[e].isModelRequired}]}))});var XOe=T(T6=>{"use strict";p();Object.defineProperty(T6,"__esModule",{value:!0});T6.AugLoopService=void 0;var lO=fe(),y2=zn(),HOe=Ar(),kFr=ia(),zOe=WOe(),QOe=C6(),MFr=Qm(),xFr=hc(),IFr=function(){function e(r){var t=this;this.augLoopInterop=r,this.registerAnnotationCallbacks=(0,MFr.mapFromArrayOfDependantPairs)((0,HOe.strEnumArray)(QOe.ALAnnotationKind).map(function(n){return[n,new xFr.ResettableLazy(function(){return lO.__awaiter(t,void 0,void 0,function(){var a,o,u;return lO.__generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),a=zOe.AnnotationDefinitionsMap[n],[4,this.augLoopInterop.registerOnAnnotation(QOe.ALAnnotationKind[n],a.annotationName,a.featureName,a.isModelRequired)];case 1:return o=s.sent(),[2,(0,y2.success)(o)];case 2:return u=s.sent(),[2,(0,y2.failure)(u)];case 3:return[2]}})})})]}))}return e.prototype.registerALAnnotation=function(r){return lO.__awaiter(this,void 0,void 0,function(){var t;return lO.__generator(this,function(n){switch(n.label){case 0:return t=this.registerAnnotationCallbacks[r].getValue(),[4,t];case 1:return n.sent().kind==="Failure"&&this.registerAnnotationCallbacks[r].reset(),[2,t]}})})},e.prototype.sendSignal=function(r,t){return lO.__awaiter(this,void 0,void 0,function(){var n,a;return lO.__generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.augLoopInterop.sendSignal(r,"".concat(zOe.alFeatureNamePrefix,"_").concat(kFr.PluginFactoryName[t]))];case 1:return n=o.sent(),(0,HOe.isDefined)(n)?[2,(0,y2.success)(n)]:[2,(0,y2.failure)(n)];case 2:return a=o.sent(),[2,(0,y2.failure)(a)];case 3:return[2]}})})},e}();T6.AugLoopService=IFr});var $Oe=T(R6=>{"use strict";p();Object.defineProperty(R6,"__esModule",{value:!0});R6.X10TableIntelligenceService=void 0;var YOe=fe(),JOe=Ar(),lre=zn(),wFr=Gi(),ZOe=Xp(),DFr=function(){function e(r){this.tableIntelligenceProvider=r}return e.prototype.getRecognizedRangeTablesInfo=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return YOe.__awaiter(this,void 0,void 0,function(){var n,a,o;return YOe.__generator(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,(o=this.tableIntelligenceProvider).getRecognizedRangeTablesInfo.apply(o,r)];case 1:return n=u.sent(),(0,JOe.isDefined)(n)?[2,(0,lre.success)(n.filter(JOe.isDefined))]:[2,(0,lre.failure)(void 0)];case 2:return a=u.sent(),LFr("getRecognizedRangeTablesInfo","failed to get recognized range tables info: ".concat(a)),[2,(0,lre.failure)(a)];case 3:return[2]}})})},e}();R6.X10TableIntelligenceService=DFr;function LFr(e,r){ZOe.x10Logger.log({kind:"failure",payload:{failureKind:ZOe.X10FailureKind.TableIntelligenceFailure,failureLevel:wFr.TraceLevel.Warning,path:"X10TableIntelligenceService.".concat(e),description:r}})}});var N6=T(zh=>{"use strict";p();var _2,o1;Object.defineProperty(zh,"__esModule",{value:!0});zh.shouldRunComputation=zh.FormulaBarScheduler=zh.parentMethodsPost=zh.parentMethodsCall=void 0;var Bt=fe(),u1=No(),T_=ia(),qFr=Ar(),GFr=Ar(),Yo=Ar(),ku=Ba(),Hn=Gi(),cre=Xo(),Jn=Xo(),BFr=XNe(),Jo=Kh(),dre=yc(),Wh=zn(),UFr=ZN(),eke=jR(),KFr=iOe(),rE=GN(),VFr=sOe(),rke=Uee(),jFr=jee(),WFr=Wee(),HFr=Hf(),Hh=pOe(),E6=COe(),zFr=Jee(),tke=hc(),fre=Ms(),QFr=TOe(),wn=Xp(),XFr=ROe(),cO=s2(),nke=NOe(),s1=Qm(),Zs=u2(),ga=h2(),F6=y6(),YFr=y6(),P6=$R(),JFr=$R(),ZFr=$R(),$Fr=XOe(),eNr=$Oe(),A6=Xee(),ake=function(){function e(){this.current=0}return e.prototype.create=function(){return this.current+=1},e}(),rNr=(0,s1.mapFromArrayOfDependantPairs)((0,qFr.numEnumArray)(T_.PluginFactoryName).map(function(e){return[e,T_.PluginFactoryName[e]]}));zh.parentMethodsCall=["createChatGPTSession","closeChatGPTSession","sendChatGPTQuery","sendAugLoopSignal","registerALAnnotation","getRecognizedTablesInfo"];zh.parentMethodsCall;zh.parentMethodsPost=["addResult","addToComputationCount","triggerEventImmediate"];(0,GFr.staticAssertSame)();var ike={kind:Hh.InternalSchedulerResponseKind.FirstStep},tNr=(_2={},_2[Jo.NotificationKind.setActiveCell]=!0,_2[Jo.NotificationKind.setActiveCellFormat]=!0,_2[Jo.NotificationKind.doNothing]=!0,_2),oke=(0,fre.getTypedFeatureGate)("Microsoft.Office.Excel.PluginResponseWindowDebugTimeExtension"),nNr=function(){function e(r,t,n,a,o,u,s){var l,c,d,f,m,v;n===void 0&&(n=Bt.__assign({},jFr.defaultPluginResponseWindows)),u===void 0&&(u=UFr.defaultTimerInterface);var h=this;this.createPrefetchingCache=t,this.pluginResultWindows=n,this.gridDataSink=a,this.syncDataModel=o,this.timer=u,this.parent=s,this.responseStates=(0,s1.mapFromArrayOfDependantPairs)((0,Yo.strEnumArray)(ga.ComputationType).map(function(y){return[y,(0,s1.mapFromArrayOfDependantPairs)((0,Yo.strEnumArray)(ga.ComputationKinds[y]).map(function(_){return[_,new Jn.ResponseState(y,_)]}))]})),this.uiMessages=(0,s1.mapFromArrayOfDependantPairs)((0,Yo.strEnumArray)(ga.ComputationKinds[ga.ComputationType.UIMessage]).map(function(y){return[y,new cO.Subject]})),this.syncUIMessages=(0,s1.mapFromArrayOfDependantPairs)((0,Yo.strEnumArray)(ga.ComputationKinds[ga.ComputationType.UIMessage]).map(function(y){return[y,new cO.Subject]})),this.eventHandlers=(0,s1.mapFromArrayOfDependantPairs)((0,Yo.strEnumArray)(ga.ComputationKinds[ga.ComputationType.Event]).map(function(y){return[y,new cO.Subject]})),this.conflictResolvers=(l={},l[ga.ComputationType.UIMessage]=KFr.conflictResolver,l[ga.ComputationType.Event]=(0,Yo.mapFromArrayOfPairs)((0,Yo.strEnumArray)(ga.ComputationKinds[ga.ComputationType.Event]).map(function(y){return[y,function(){}]})),l),this.computationSubjects=(c={},c[ga.ComputationType.UIMessage]=(d={},d[Zs.ExecutionType.Async]=this.uiMessages,d[Zs.ExecutionType.Sync]=this.syncUIMessages,d),c[ga.ComputationType.Event]=(f={},f[Zs.ExecutionType.Async]=this.eventHandlers,f),c),this.syncMessageQueue=new zFr.PriorityQueue(function(){return 0}),this.doNotifyStatelessSubject=new cO.Subject,this.doNotifyStatefulSubject=new cO.InitializingSubject(function(){return h.syncDataModel.getStateAsNotifications()}),this.requestWithCorrelationIdSubject=new cO.Subject,this.idFactory=new ake,this.eventComputationGroupFactory=new ake,this.state={scheduler:this},this.notificationProcessorMap=(m={},m[Jo.NotificationKind.setActiveCell]=this.setActiveCellImpl.bind(this),m[Jo.NotificationKind.setActiveCellFormat]=this.setActiveCellFormatImpl.bind(this),m[Jo.NotificationKind.setA1ReferenceStyle]=this.syncDataModel.setA1ReferenceStyle.bind(this.syncDataModel),m[Jo.NotificationKind.setLocale]=this.syncDataModel.setLocale.bind(this.syncDataModel),m[Jo.NotificationKind.setWorkbookProps]=this.syncDataModel.setWorkbookProps.bind(this.syncDataModel),m[Jo.NotificationKind.updateSheetNames]=this.syncDataModel.updateSheetNames.bind(this.syncDataModel),m[Jo.NotificationKind.updateNamedObjects]=this.syncDataModel.updateNamedObjects.bind(this.syncDataModel),m[Jo.NotificationKind.doNothing]=function(){},m[Jo.NotificationKind.writeRange]=function(){for(var y,_=[],E=0;E<arguments.length;E++)_[E]=arguments[E];return(y=h.gridDataSink)===null||y===void 0?void 0:y.writeRange.apply(y,_)},m[Jo.NotificationKind.setNumberFormats]=function(){for(var y,_=[],E=0;E<arguments.length;E++)_[E]=arguments[E];return(y=h.gridDataSink)===null||y===void 0?void 0:y.setNumberFormats.apply(y,_)},m[Jo.NotificationKind.setFunctionsInfo]=this.setFunctionInfo.bind(this),m[Jo.NotificationKind.conflictResolverEarlyTermination]=function(y,_,E){return h.stopComputationFrame(y,_,ga.ComputationType.UIMessage,E,Jn.ExecutionStopReason.Frame.ConflictResolverEarlyTermination)},m[Jo.NotificationKind.setDefinedNamesInfo]=this.setDefinedNamesInfo.bind(this),m[Jo.NotificationKind.notifyWorkbookClosing]=this.onWorkbookClosing.bind(this),m[Jo.NotificationKind.setSchedulerFeatures]=this.syncDataModel.setSchedulerFeatures.bind(this.syncDataModel),m),this.notifierObject=(0,BFr.makeNotifier)(this),this.eventEmitterObject=(0,ZFr.makeEventEmitter)(this),this.alAnnotationNotifierObject=(0,JFr.makeALAnnotationNotifier)(this),this.requesterObject=(0,Jn.makeRequester)(this),this.syncRequesterObject=(0,Jn.makeSyncRequester)(this),this.batchRequesterObject=(0,rke.makeBatchRequester)(this),this.notificationQueue=[],this.isEnabledProcessNotificationsAfterShouldRunPlugin=(0,fre.isTypedChangeGateEnabled)("OfficeVSO:8579351_x10ProcessNotificationsAfterShouldRunPlugin"),this.x10GetNumOfComputationsFromFrameEnabled=(0,fre.isTypedChangeGateEnabled)("OfficeVSO:8557722_x10GetNumOfComputationsFromFrame"),this.eventResultWindows=(0,Yo.mapFromArrayOfPairs)((0,Yo.strEnumArray)(ga.ComputationKinds[ga.ComputationType.Event]).map(function(y){return[y,{startDelta:0,stopDelta:1/0}]})),this.computationResultWindows=(v={},v[ga.ComputationType.UIMessage]=this.pluginResultWindows,v[ga.ComputationType.Event]=this.eventResultWindows,v),this.recalcServiceAttachedPromise=new rE.ResolvablePromise,this.chatGPTProviderAttachedPromise=new rE.ResolvablePromise,this.alManagerAttachedPromise=new rE.ResolvablePromiseWithTimeout(3e5,this.timer),this.tableIntelligenceServiceAttachedPromise=new rE.ResolvablePromiseWithSyncValue,this.eventCallbackManagerAttachedPromise=new rE.ResolvablePromiseWithSyncValue,this.eventCallbackManagerCreated=(0,tke.asyncLazy)(P6.makeEventCallbacksManager),this.computationFinalizerHandlers=[oNr],this.warmupParse=(0,tke.asyncLazy)(function(){return Bt.__awaiter(h,void 0,void 0,function(){var y,_,E;return Bt.__generator(this,function(N){return y=this.createPrefetchingCache(this.syncDataModel,-1),y&&(_=(0,u1.documentLoc)(void 0,""),E=(0,u1.sheetGridCell)((0,u1.sheetIndex)(_,0),(0,u1.gridCell)(1,1)),y.parseEditSync(E,"=sum(5,7)",{formatString:"'GENERAL",builtIn:!0})),[2]})})}),ku.ulsLogger.ULS.traceTag(537796811,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,wn.x10Logger.formatLogMessage("excelOnlineCalcPackages",{description:"".concat((0,QFr.getExcelOnlineCalcNewPackagesNames)())})),this.processor=r(this.consumeMessage.bind(this)),this.alManagerAttachedPromise.toPromise().catch(function(){})}return e.prototype.setFunctionInfo=function(r){if((0,Yo.isNone)(r)){ku.ulsLogger.ULS.traceTag(512274762,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,wn.x10Logger.formatLogMessage("setFunctionInfo",{description:"functionsInfo was none"}));return}for(var t={},n=0,a=r;n<a.length;n++){var o=a[n];(0,Yo.isDefined)(o)&&(t[o.NameDataStrings]=o)}this.state=Bt.__assign(Bt.__assign({},this.state),{functionsInfoMap:t}),ku.ulsLogger.ULS.traceTag(512274761,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,wn.x10Logger.formatLogMessage("setFunctionInfo",{description:"set functionsInfoMap"}))},e.prototype.setDefinedNamesInfo=function(r){if((0,Yo.isNone)(r)){ku.ulsLogger.ULS.traceTag(512274760,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,wn.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"definedNamesInfo was none"}));return}for(var t={},n=0,a=r;n<a.length;n++){var o=a[n];(0,Yo.isDefined)(o)&&(0,Yo.isDefined)(o.name)&&(t[o.name.toUpperCase()]=o)}this.state=Bt.__assign(Bt.__assign({},this.state),{definedNamesInfoMap:t}),ku.ulsLogger.ULS.traceTag(512274759,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,wn.x10Logger.formatLogMessage("setDefinedNamesInfo",{description:"set definedNamesInfoMap"}))},e.prototype.onWorkbookClosing=function(){wn.x10Logger.flush()},e.prototype.getPluginResponseWindows=function(){return this.pluginResultWindows},e.prototype.setPluginResponseWindow=function(r,t,n){this.pluginResultWindows[r]={startDelta:t,stopDelta:n}},e.prototype.consumeMessage=function(r){var t=this;switch(r.kind){case Jn.SchedulerTimelineQueueMessageKind.StepComputation:this.stepComputation(r.computation,r.payload);break;case Jn.SchedulerTimelineQueueMessageKind.NoOpRequest:case Jn.SchedulerTimelineQueueMessageKind.SyncRequest:case Jn.SchedulerTimelineQueueMessageKind.AsyncRequest:var n=this.timer.now();this.processRequest(r.computation,r.request,{onFulfilled:function(o){if(o.kind===Wh.ResultKind.Success)return t.enqueueMessage({kind:Jn.SchedulerTimelineQueueMessageKind.StepComputation,computation:r.computation,payload:{kind:Hh.InternalSchedulerResponseKind.NormalResponse,response:o.value}}),o.value;var u=A6.logSafeFailure.censored(o);return t.enqueueMessage({kind:Jn.SchedulerTimelineQueueMessageKind.StepComputation,computation:r.computation,payload:{kind:Hh.InternalSchedulerResponseKind.RequestFailure,request:r.request.kind,failure:u}}),u},onRejected:function(){var o=(0,Wh.failure)(void 0);return t.enqueueMessage({kind:Jn.SchedulerTimelineQueueMessageKind.StepComputation,computation:r.computation,payload:{kind:Hh.InternalSchedulerResponseKind.RequestFailure,request:r.request.kind,failure:o}}),o}}),r.computation.info.schedulerTime+=this.timer.now()-n;break;case Jn.SchedulerTimelineQueueMessageKind.StopComputationFrame:this.stopComputationFrame(r.correlationId,r.computationGroup,r.type,r.computationKind,Jn.ExecutionStopReason.Frame.Timeout);break;case Jn.SchedulerTimelineQueueMessageKind.Timeout:r.callback();break;default:(0,ku.assertNever)("unknown message: ".concat(r),r)}},e.prototype.enqueueMessage=function(r,t){var n=e.abstractStepCosts[r.kind];this.processor.enqueue(r,n,t)},e.prototype.stepComputation=function(r,t){var n=this.responseStates[r.info.type][r.info.computationKind].computationFrame(r.info.computationGroup);if(r.info.correlationId!==(n==null?void 0:n.correlationId)){r.finalizer.finalize(r,r.stopReasonRef.value);return}try{var a=this.timer.now(),o=uke(r.generator,t);if(r.info.computationTime+=this.timer.now()-a,o.done!==!0){var u=o.value;this.enqueueMessage((0,Hh.wrapRequest)(u,r))}else this.addResultAndFinalizeComputationFrame(r,{kind:"Successful",message:o.value},Jn.ExecutionStopReason.Computation.Done)}catch(s){this.addResultAndFinalizeComputationFrame(r,{kind:"Exception"},Jn.ExecutionStopReason.Computation.Exception),wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.PluginFailure,failureLevel:Hn.TraceLevel.Warning,path:"FormulaBarScheduler.stepComputation",description:"plugin threw exception: ".concat(s," during computation"),data:r.info}})}},e.prototype.addResultAndFinalizeComputationFrame=function(r,t,n){return r.finalizer.finalize(r,n),this.addResult(r.info,t)},e.prototype.addResult=function(r,t,n){var a=this.responseStates[r.type][r.computationKind].computationFrame(r.computationGroup);if(this.parent||n==null||n.forEach(function(s){return wn.x10Logger.log.apply(wn.x10Logger,s)}),!(a===void 0||a.correlationId>r.correlationId)){if(a.correlationId<r.correlationId&&wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.AssertionFailure,failureLevel:Hn.TraceLevel.Warning,path:"FormulaBarScheduler.addResult",description:"main scheduler corelationID (".concat(a.correlationId,") is less than the child one (").concat(r.correlationId,")")}}),this.parent){var o=Bt.__spreadArray(Bt.__spreadArray([],n??[],!0),wn.x10Logger.flushBufferedMessages(),!0);this.parent.addResult(r,t,o)}switch(t.kind){case"Successful":a.successfulResults.results.push([r.computationIdentifier,t.message]);break;case"Exception":a.numFailures+=1;break;case"Skipped":a.numSkippedComputations+=1;break;default:(0,ku.assertNever)("unknown result",t)}var u=this.x10GetNumOfComputationsFromFrameEnabled?iNr(a):aNr(a)===this.responseStates[r.type][r.computationKind].numComputations?Jn.ExecutionStopReason.Computation.Done:void 0;u!==void 0&&this.stopComputationFrame(a.correlationId,r.computationGroup,r.type,r.computationKind,u)}},e.prototype.processRequest=function(r,t,n){var a=this,o,u,s=n.onFulfilled,l=n.onRejected,c=this.responseStates[r.info.type][r.info.computationKind],d=c.computationFrame(r.info.computationGroup);if(r.info.correlationId!==(d==null?void 0:d.correlationId))return r.finalizer.finalize(r,r.stopReasonRef.value),l(A6.logSafeFailure.failure("Computation timed out"));var f=this.timer.now(),m=(0,E6.processRequest)(E6.requestProcessorMap,t,r,(o=c.computationFrame(r.info.computationGroup))===null||o===void 0?void 0:o.cache,(u=c.computationFrame(r.info.computationGroup))===null||u===void 0?void 0:u.config);return(0,eke.bindMaybeThenable)(m,function(v){return a.addProcessingTime(r,t.kind,f),v.kind!==Wh.ResultKind.Success&&wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.RequestProcessorFailure,failureLevel:Hn.TraceLevel.Warning,path:"FormulaBarScheduler.processRequest",description:"request returned a scheduler-side failure",data:Bt.__assign(Bt.__assign({},r.info),{failedRequest:t.kind,failedReason:A6.logSafeFailure.censored(v)})}}),s(v)},function(v){return a.addProcessingTime(r,t.kind,f),wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.RequestProcessorFailure,failureLevel:Hn.TraceLevel.Error,path:"FormulaBarScheduler.processRequest",description:"request processor threw",data:Bt.__assign(Bt.__assign({},r.info),{failedRequest:t.kind,error:(0,HFr.messageFromError)(v)})}}),l(v)})},e.prototype.addProcessingTime=function(r,t,n){var a=this.timer.now(),o=r.info.requestTimes[t];return o?(o.requestDuration=o.requestDuration+a-n,o.numberOfRequests+=1,o.timeSinceLastRequest=a-r.lastTimestamp):r.info.requestTimes[t]={requestDuration:a-n,numberOfRequests:1,timeSinceLastRequest:a-r.lastTimestamp},r.lastTimestamp=a,a},e.prototype.stopComputationFrame=function(r,t,n,a,o){var u,s=this.responseStates[n][a];r===((u=s.computationFrame(t))===null||u===void 0?void 0:u.correlationId)&&s.stop(t,o,this.timer.now())},e.prototype.recalcServiceAttached=function(){return this.recalcServiceAttachedPromise.toPromise()},e.prototype.chatGPTProviderAttached=function(){return this.chatGPTProviderAttachedPromise.toPromise()},e.prototype.tableIntelligenceServiceAttached=function(){return this.tableIntelligenceServiceAttachedPromise.toPromise()},e.prototype.getFunctionsShortDescriptions=function(){return WFr.functionShortDescriptions.getValue()},e.prototype.getSchedulerFeatures=function(){return(0,s1.asReadonly)(this.syncDataModel.schedulerFeatures)},e.prototype.isSchedulerFeatureEnabled=function(r){return this.getSchedulerFeatures().indexOf(r)!==-1},e.prototype.doNotify=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];ku.ulsLogger.ULS.traceTag(512274758,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,wn.x10Logger.formatLogMessage("FormulaBarScheduler.doNotify",{description:"received notification of kind:\n       ".concat(r[0],"\n      ")})),this.enqueueNotification(r),(r[0]===Jo.NotificationKind.setSchedulerFeatures||r[0]===Jo.NotificationKind.notifyWorkbookClosing)&&this.processNotifications()},e.prototype.enqueueNotification=function(r){var t=this.notificationQueue.length-1,n=this.notificationQueue[t];if(n===void 0)this.notificationQueue.push(r),ku.ulsLogger.ULS.traceTag(512274757,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,wn.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:"queue empty, notification of kind:\n         ".concat(r[0]," pushed to queue\n        ")}));else{var a=n[0],o=r[0],u=a===o&&tNr[a]===!0;u?(this.notificationQueue[t]=r,ku.ulsLogger.ULS.traceTag(512274756,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,wn.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:"notification of kind:\n           ".concat(r[0]," overrode previous notification\n          ")}))):(this.notificationQueue.push(r),ku.ulsLogger.ULS.traceTag(512274755,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,wn.x10Logger.formatLogMessage("FormulaBarScheduler.enqueueNotification",{description:"couldn't coalesce, notification of kind:\n           ".concat(r[0]," pushed to queue\n          ")})))}},e.prototype.processNotifications=function(){for(var r=0,t=this.notificationQueue;r<t.length;r++){var n=t[r];ku.ulsLogger.ULS.traceTag(512274754,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,wn.x10Logger.formatLogMessage("FormulaBarScheduler.processNotifications",{description:"processing notification of kind:\n         ".concat(n[0],"\n        ")})),this.processNotification(n)}this.notificationQueue.length=0},e.prototype.processNotification=function(r){var t,n=r[0],a=r[1];switch((t=this.notificationProcessorMap)[n].apply(t,a),n){case Jo.NotificationKind.setA1ReferenceStyle:case Jo.NotificationKind.setLocale:case Jo.NotificationKind.setWorkbookProps:case Jo.NotificationKind.updateSheetNames:case Jo.NotificationKind.updateNamedObjects:case Jo.NotificationKind.setSchedulerFeatures:this.doNotifyStatefulSubject.next(r);break;default:this.doNotifyStatelessSubject.next(r);break}},e.prototype.requestWithCorrelationId=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],l=r[5],c=r[6],d=this.timer.now(),f=this.responseStates[n][a];f.closeFrame(c,Jn.ExecutionStopReason.Frame.Superseded,d);var m=this.createPrefetchingCache(this.syncDataModel,s),v=this.computationResultWindows[n][a],h=f.createFrame(s,c,Zs.ExecutionType.Async,u,m,this.syncDataModel.config,d,v);this.responseStates[n][a].numComputations===0?(wn.x10Logger.log({kind:"requestSkipped",payload:{computationKind:a,computationGroup:c}}),h.resolve({kind:"Done",payload:{kind:a,results:[]}})):wn.x10Logger.log({kind:"beginRequest",payload:{correlationId:s,computationKind:a,computationGroup:c}});var y=f.computationFrame(c);return(0,ku.assertTrue)("`frame` should be always defined at this point",y!==void 0),this.computationSubjects[n][o][a].next([y,l]),v.stopDelta<1/0&&this.enqueueMessage({kind:Jn.SchedulerTimelineQueueMessageKind.StopComputationFrame,correlationId:s,computationGroup:c,type:n,computationKind:a},d+v.stopDelta+oke),this.requestWithCorrelationIdSubject.next([n,a,o,u,s,l,c]),h},e.prototype.syncRequestWithCorrelationId=function(r,t,n,a,o,u,s){var l=this.timer.now(),c=this.responseStates[r][t];c.closeFrame(s,Jn.ExecutionStopReason.Frame.Superseded,l);var d=this.createPrefetchingCache(this.syncDataModel,o),f=this.computationResultWindows[r][t],m=c.createFrame(o,s,Zs.ExecutionType.Sync,a,d,this.syncDataModel.config,l,f);wn.x10Logger.log({kind:"beginRequest",payload:{correlationId:o,computationKind:t,computationGroup:s}});var v=c.computationFrame(s);(0,ku.assertTrue)("`frame` should be always defined at this point",v!==void 0),this.computationSubjects[r][n][t].next([v,u]);var h=l+f.stopDelta+oke,y=this.runToCompletion(d,this.syncDataModel.config,h),_=y[0],E=y[1];return c.closeFrame(s,_,this.timer.now()),m.resolve({kind:"Done",payload:{kind:t,results:[]}}),{kind:t,results:E}},e.prototype.runToCompletion=function(r,t,n){for(var a=[],o=this.timer.now(),u=this.syncMessageQueue.pop();u!==void 0;u=this.syncMessageQueue.pop(),o=this.timer.now()){if(o>=n){u.computation.finalizer.finalize(u.computation,Jn.ExecutionStopReason.Frame.Timeout);break}var s=void 0;switch(u.kind){case Jn.SchedulerTimelineQueueMessageKind.StepComputation:{var l=u.computation,c=u.payload;try{var d=uke(l.generator,c);if(l.info.computationTime+=this.timer.now()-o,d.done!==!0){var f=d.value;this.syncMessageQueue.enqueue((0,Hh.wrapSyncRequest)(f,l))}else this.addResult(l.info,{kind:"Successful",message:d.value}),l.finalizer.finalize(l,Jn.ExecutionStopReason.Computation.Done),a.push([l.info.computationIdentifier,d.value])}catch(v){ku.ulsLogger.ULS.traceTag(538581056,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Warning,wn.x10Logger.formatLogMessage("FormulaBarScheduler.runToCompletion",{description:"plugin threw exception during computation",data:l.info})),l.finalizer.finalize(l,Jn.ExecutionStopReason.Computation.Exception)}}break;case Jn.SchedulerTimelineQueueMessageKind.NoOpRequest:case Jn.SchedulerTimelineQueueMessageKind.SyncRequest:var m=(0,E6.processSyncRequest)(E6.requestProcessorMap,u.request,u.computation,r,t);s=this.addProcessingTime(u.computation,u.request.kind,o),u.computation.info.schedulerTime+=s-o,m.kind===Wh.ResultKind.Success?this.syncMessageQueue.enqueue({kind:Jn.SchedulerTimelineQueueMessageKind.StepComputation,computation:u.computation,payload:{kind:Hh.InternalSchedulerResponseKind.NormalResponse,response:m.value}}):(wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.RequestProcessorFailure,failureLevel:Hn.TraceLevel.Warning,path:"FormulaBarScheduler.runToCompletion",description:"request returned a scheduler-side failure",data:Bt.__assign(Bt.__assign({},u.computation.info),{failedRequest:u.request.kind})}}),this.syncMessageQueue.enqueue({kind:Jn.SchedulerTimelineQueueMessageKind.StepComputation,computation:u.computation,payload:{kind:Hh.InternalSchedulerResponseKind.RequestFailure,request:u.request.kind,failure:A6.logSafeFailure.censored(m)}}));break;default:(0,ku.assertNever)("unknown message: ".concat(u),u)}}return this.syncMessageQueue.clear(),[!(0,Yo.isDefined)(n)||o<n?Jn.ExecutionStopReason.Computation.Done:Jn.ExecutionStopReason.Frame.Timeout,a]},e.prototype.triggerEventImmediate=function(r,t){if(this.parent)return this.parent.triggerEventImmediate(r,t);this.triggerEvent(r,t)},e.prototype.triggerEvent=function(r,t){return this.processNotifications(),this.doRequestUntyped(ga.ComputationType.Event,r,t,void 0,this.eventComputationGroupFactory.create().toString())},e.prototype.doRequest=function(r,t,n,a){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(ga.ComputationType.UIMessage,r,t,n,Zs.ExecutionType.Async)?this.wrapResults(ga.ComputationType.UIMessage,this.skippedRequest(r,a)):(this.processNotifications(),this.doRequestUntyped(ga.ComputationType.UIMessage,r,t,n,a))},e.prototype.skippedRequest=function(r,t){wn.x10Logger.log({kind:"requestSkipped",payload:{computationKind:r,computationGroup:t}});var n=new rE.ResolvablePromise;return n.resolve({kind:"Done",payload:{kind:r,results:[]}}),n},e.prototype.wrapResults=function(r,t){return Bt.__awaiter(this,void 0,void 0,function(){var n;return Bt.__generator(this,function(a){switch(a.label){case 0:return[4,this.resolveConflicts(r,t)];case 1:return n=a.sent(),n.kind==="Superseded"?[2,n]:[2,Bt.__assign(Bt.__assign({},n),{payload:n.payload.result})]}})})},e.prototype.doRequestUntyped=function(r,t,n,a,o){return Bt.__awaiter(this,void 0,void 0,function(){var u;return Bt.__generator(this,function(s){return u=this.requestWithCorrelationId(r,t,Zs.ExecutionType.Async,n,this.idFactory.create(),a,o),[2,this.wrapResults(r,u)]})})},e.prototype.doSyncRequest=function(r,t,n,a){return this.isEnabledProcessNotificationsAfterShouldRunPlugin&&!this.shouldRunRequest(ga.ComputationType.UIMessage,r,t,n,Zs.ExecutionType.Sync)?this.wrapSyncResponse(ga.ComputationType.UIMessage,this.skippedSyncRequest(r,a)):(this.processNotifications(),this.doSyncRequestUntyped(ga.ComputationType.UIMessage,r,t,n,a))},e.prototype.skippedSyncRequest=function(r,t){return wn.x10Logger.log({kind:"requestSkipped",payload:{computationKind:r,computationGroup:t}}),{kind:r,results:[]}},e.prototype.wrapSyncResponse=function(r,t){return this.syncResolveConflicts(r,t).result},e.prototype.doSyncRequestUntyped=function(r,t,n,a,o){var u;if(this.responseStates[r][t].numSyncComputations===0)u=this.skippedSyncRequest(t,o);else{var s=this.idFactory.create();u=this.syncRequestWithCorrelationId(r,t,Zs.ExecutionType.Sync,n,s,a,o)}return this.wrapSyncResponse(r,u)},e.prototype.resolveConflicts=function(r,t){return Bt.__awaiter(this,void 0,void 0,function(){var n;return Bt.__generator(this,function(a){switch(a.label){case 0:return[4,t];case 1:return n=a.sent(),n.kind==="Superseded"?[2,n]:[2,{kind:"Done",payload:this.syncResolveConflicts(r,n.payload)}]}})})},e.prototype.syncResolveConflicts=function(r,t){var n=t.results.filter(function(a){var o=a[1];return(0,Yo.isDefined)(o)});return{kind:t.kind,result:this.conflictResolvers[r][t.kind](n)}},e.prototype.doBatchRequest=function(r,t,n){return Bt.__awaiter(this,void 0,void 0,function(){var a,o,u,s,l,c,d,v,f,m,v,h;return Bt.__generator(this,function(y){switch(y.label){case 0:for(this.isEnabledProcessNotificationsAfterShouldRunPlugin||this.processNotifications(),a=this.idFactory.create(),o=rke.customConflictResolverPluginKinds[r.strategy],u=VFr.customConflictResolverFactories[r.strategy].create(),s=o.map(function(){return!0}),l=new rE.ResolvablePromise,c=function(E){var N=o[E],k=r[N],q=void 0;d.isEnabledProcessNotificationsAfterShouldRunPlugin&&!d.shouldRunRequest(ga.ComputationType.UIMessage,N,k,t,Zs.ExecutionType.Async)?q=d.skippedRequest(N,n??cre.DefaultComputationGroup):(d.processNotifications(),q=d.requestWithCorrelationId(ga.ComputationType.UIMessage,N,Zs.ExecutionType.Async,k,a,t,n??cre.DefaultComputationGroup)),d.resolveConflicts(ga.ComputationType.UIMessage,q).then(function(V){if(s[E]=!1,V.kind==="Superseded")l.resolve({kind:"Superseded"});else{var I=V.payload;u.consumeResult(I)}},function(){wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.CustomConflictResolverFailure,failureLevel:Hn.TraceLevel.Error,path:"FormulaBarScheduler.doBatchRequest",description:'Custom conflict resolver "'.concat(r.strategy,'" got an exception for plugin kind "').concat(N,'". Skipping kind')}}),s[E]=!1,u.consumeResult({kind:N,result:null})})},d=this,v=0;v<o.length;v+=1)c(v);return f=(0,eke.bindMaybeThenable)(u.promise,function(_){return{kind:"Done",payload:_}}),[4,Promise.race([l,f])];case 1:for(m=y.sent(),v=0;v<o.length;v+=1)h=o[v],s[v]&&(this.doNotify(Jo.NotificationKind.conflictResolverEarlyTermination,[a,n??cre.DefaultComputationGroup,h]),this.processNotifications());return[2,m]}})})},e.prototype.updatePrefetchingCache=function(r){var t;return Bt.__awaiter(this,void 0,void 0,function(){var n,a,o;return Bt.__generator(this,function(u){switch(u.label){case 0:return n=this.createPrefetchingCache(this.syncDataModel,this.idFactory.create()),[4,(t=r.cache)===null||t===void 0?void 0:t.getCorrespondingSnapshotID()];case 1:return a=u.sent(),[4,n==null?void 0:n.getCorrespondingSnapshotID()];case 2:return o=u.sent(),o!==a?(r.cache=n,[2,o]):[2,a]}})})},e.prototype.notifier=function(){return this.notifierObject},e.prototype.eventEmitter=function(){return this.eventEmitterObject},e.prototype.alAnnotationNotifier=function(){return this.alAnnotationNotifierObject},e.prototype.requester=function(){return this.requesterObject},e.prototype.syncRequester=function(){return this.syncRequesterObject},e.prototype.batchRequester=function(){return this.batchRequesterObject},e.prototype.setServerDataProvider=function(r){(0,Yo.isNone)(r)||(this.state=Bt.__assign(Bt.__assign({},this.state),{serverDataProvider:r}))},e.prototype.setActiveCellImpl=function(r){if((0,Yo.isNone)(r.docName)||(0,Yo.isNone)(r.sheetIndex)){wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.NotificationProcessorFailure,failureLevel:Hn.TraceLevel.Warning,path:"FormulaBarScheduler.setActiveCellImpl",description:"early exit, some of the arguments is None"}});return}var t=(0,u1.documentLoc)(void 0,""),n=(0,u1.unsafeGridRange)(r.rowIndex,r.colIndex,1,1),a=(0,u1.sheetGridCell)((0,u1.sheetIndex)(t,r.sheetIndex),n),o=ske(r);this.state=Bt.__assign(Bt.__assign({},this.state),{activeCell:a,activeCellFormat:o}),ku.ulsLogger.ULS.traceTag(512274752,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,wn.x10Logger.formatLogMessage("setActiveCellImpl",{description:"updated activeCell to col: ".concat(a.range.col,", row: ").concat(a.range.row)}))},e.prototype.setActiveCellFormatImpl=function(r){var t=ske(r);this.state=Bt.__assign(Bt.__assign({},this.state),{activeCellFormat:t})},e.prototype.getConfig=function(){return this.syncDataModel.config},e.prototype.startComputation=function(r,t,n,a,o,u){switch(n){case Zs.ExecutionType.Async:this.enqueueMessage({kind:Jn.SchedulerTimelineQueueMessageKind.StepComputation,computation:Bt.__assign(Bt.__assign({},this.generateNewComputationInfo(r,t,a,u)),{generator:o}),payload:ike},u.startTime+u.timeWindow.startDelta);break;case Zs.ExecutionType.Sync:this.syncMessageQueue.enqueue({kind:Jn.SchedulerTimelineQueueMessageKind.StepComputation,computation:Bt.__assign(Bt.__assign({},this.generateNewComputationInfo(r,t,a,u)),{generator:o}),payload:ike});break;default:(0,ku.assertNever)("".concat(n),n)}},e.prototype.generateNewComputationInfo=function(r,t,n,a){return{info:{correlationId:a.correlationId,computationGroup:a.computationGroup,type:r,computationKind:t,computationIdentifier:n,pluginFactoryNameString:rNr[n.factoryName],computationTime:0,schedulerTime:0,requestTimes:{}},cache:a.cache,finalizer:new(nke.ComputationFinalizer.bind.apply(nke.ComputationFinalizer,Bt.__spreadArray([void 0],this.computationFinalizerHandlers,!1))),stopReasonRef:a.stopReasonRef,schedulerState:this.state,lastTimestamp:this.timer.now()}},e.prototype.getPluginComputations=function(r,t,n){var a,o,u,s=dre.pluginFactoryKindMap[t.factoryName],l={factoryName:t.factoryName,pluginName:(a=t.pluginName)!==null&&a!==void 0?a:T_.PluginFactoryName[t.factoryName]},c=Bt.__assign(Bt.__assign({},l),{computationName:"run"}),d=dre.pluginGroupMap[T_.PluginGroup.Python][t.factoryName]?T_.PluginGroup.Python:T_.PluginGroup.Excel,f=((o=t.registryInitialized)===null||o===void 0?void 0:o.call(t))!==!0?[(0,YFr.wrapRegistration)(ga.ComputationType.UIMessage,s,n,d,c,{},r.run.bind(r),function(h,y){return pre(ga.ComputationType.UIMessage,s,c,y,h)})]:[],m=((u=t.registryInitialized)===null||u===void 0?void 0:u.call(t))===!0?F6.computationRegistry.UIMessage.getRegistrationsByPluginIdentifier(l):[],v=F6.computationRegistry.Event.getRegistrationsByPluginIdentifier(l);return Bt.__spreadArray(Bt.__spreadArray(Bt.__spreadArray([],f,!0),m,!0),v,!0)},e.prototype.createAndAttachPlugin=function(r,t){this.parent&&this.warmupParse.force();for(var n=r.create(t),a=function(d){switch(d.type){case ga.ComputationType.UIMessage:o.computationSubjects[d.type][d.execution][d.kind].subscribe(d.registrationMethod(o,n)),o.addToComputationCount(d);break;case ga.ComputationType.Event:(0,P6.isALAnnotationEventKind)(d.kind)&&o.registerALAnnotation(d.kind).catch(function(f){wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.ALFailure,failureLevel:Hn.TraceLevel.Error,path:"FormulaBarScheduler.createAndAttachPlugin",description:"Failed to register on ".concat(d.kind," AL annotation: ").concat(f)}})}),o.computationSubjects[d.type][d.execution][d.kind].subscribe(d.registrationMethod(o,n)),o.addToComputationCount(d);break;default:(0,ku.assertNever)("".concat(d),d)}},o=this,u=0,s=this.getPluginComputations(n,r,Zs.ExecutionType.Async);u<s.length;u++){var l=s[u];a(l)}ku.ulsLogger.ULS.traceTag(545378970,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,"x10arch.FormulaBarScheduler.createAndAttachPlugin: ".concat(T_.PluginFactoryName[r.factoryName]," was attached."))},e.prototype.createAndAttachSyncPlugin=function(r,t){for(var n=r.create(t),a=function(d){switch(d.type){case ga.ComputationType.UIMessage:o.computationSubjects[d.type][d.execution][d.kind].subscribe(d.registrationMethod(o,n)),o.responseStates[d.type][d.kind].attachSyncComputation(d.computationIdentifier);break;case ga.ComputationType.Event:(0,P6.isALAnnotationEventKind)(d.kind)&&o.registerALAnnotation(d.kind).catch(function(f){ku.ulsLogger.ULS.traceTag(507802140,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Error,"x10arch.FormulaBarScheduler.createAndAttachSyncPlugin: Failed to register on ".concat(d.kind," AL annotation: ").concat(f))}),o.computationSubjects[d.type][d.execution][d.kind].subscribe(d.registrationMethod(o,n)),o.responseStates[d.type][d.kind].attachSyncComputation(d.computationIdentifier);break;default:(0,ku.assertNever)("".concat(d),d)}},o=this,u=0,s=this.getPluginComputations(n,r,Zs.ExecutionType.Sync);u<s.length;u++){var l=s[u];a(l)}ku.ulsLogger.ULS.traceTag(538581058,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,"x10arch.FormulaBarScheduler.createAndAttachSyncPlugin: ".concat(T_.PluginFactoryName[r.factoryName]," was attached."))},e.prototype.addToComputationCount=function(r){switch(this.parent&&this.parent.addToComputationCount({type:r.type,kind:r.kind,execution:r.execution,computationIdentifier:r.computationIdentifier}),r.execution){case Zs.ExecutionType.Async:this.responseStates[r.type][r.kind].attachComputation(r.computationIdentifier);break;case Zs.ExecutionType.Sync:this.responseStates[r.type][r.kind].attachSyncComputation(r.computationIdentifier);break}},e.prototype.attachEventCallbacksManager=function(r){for(var t=function(l){(0,Yo.isDefined)(r[l])&&n.computationSubjects[ga.ComputationType.Event][Zs.ExecutionType.Async][l].subscribe(function(c){var d=c[0],f=c[1];try{r[l](d.computationInput)}catch(m){wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.EventCallbacksManagerFailure,failureLevel:Hn.TraceLevel.Error,path:"FormulaBarScheduler.attachEventCallbacksManager",description:"Failed to call eventCallbacksManager.".concat(l,": ").concat(m)}})}})},n=this,a=0,o=P6.ExternallyHandledEventKinds;a<o.length;a++){var u=o[a];t(u)}},e.prototype.registerEventCallback=function(r,t){return Bt.__awaiter(this,void 0,void 0,function(){var n;return Bt.__generator(this,function(a){switch(a.label){case 0:return[4,this.eventCallbackManagerCreated.getValue()];case 1:return n=a.sent(),(0,Yo.isDefined)(this.eventCallbackManagerAttachedPromise.getCurrentValue())||(this.eventCallbackManagerAttachedPromise.resolve(n),this.attachEventCallbacksManager(n)),n.registerEventCallback(r,t),[2]}})})},e.prototype.catchEvent=function(r){var t=this;return new Promise(function(n,a){var o=t.computationSubjects[ga.ComputationType.Event][Zs.ExecutionType.Async][r.eventKind].subscribe(function(u){var s=u[0],l=u[1];(!(0,Yo.isDefined)(r.predicate)||r.predicate(s.computationInput))&&(t.computationSubjects[ga.ComputationType.Event][Zs.ExecutionType.Async][r.eventKind].unsubscribe(o),n((0,Wh.success)(s.computationInput)))});t.enqueueMessage({kind:Jn.SchedulerTimelineQueueMessageKind.Timeout,type:ga.ComputationType.Event,callback:function(){t.computationSubjects[ga.ComputationType.Event][Zs.ExecutionType.Async][r.eventKind].unsubscribe(o),n((0,Wh.failure)("Timeout"))}},t.timer.now()+r.timeout)})},e.prototype.registerAsyncGrid=function(){this.recalcServiceAttachedPromise.resolve(void 0)},e.prototype.registerChatGPTProvider=function(r){var t=new XFr.ChatGPTService(r);return this.chatGPTProviderAttachedPromise.resolve(t)},e.prototype.registerALProvider=function(r){var t=new $Fr.AugLoopService(r);return this.alManagerAttachedPromise.resolve(t)},e.prototype.registerALAnnotation=function(r){return Bt.__awaiter(this,void 0,void 0,function(){var t,n;return Bt.__generator(this,function(a){switch(a.label){case 0:if(this.parent!==void 0)return[2,this.parent.registerALAnnotation(r)];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.alManagerAttachedPromise];case 2:return t=a.sent(),[3,4];case 3:return n=a.sent(),wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.ALFailure,failureLevel:Hn.TraceLevel.Warning,path:"FormulaBarScheduler.registerALAnnotation",description:"Error getting AugLoopService: ".concat(n)}}),[2,(0,Wh.failure)(n)];case 4:return[2,t.registerALAnnotation(r)]}})})},e.prototype.registerTableIntelligenceProvider=function(r){this.tableIntelligenceServiceAttachedPromise.resolve(new eNr.X10TableIntelligenceService(r))},e.prototype.getRecognizedTablesInfo=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return Bt.__awaiter(this,void 0,void 0,function(){var n,a;return Bt.__generator(this,function(o){return(0,Yo.isDefined)(this.parent)?[2,(a=this.parent).getRecognizedTablesInfo.apply(a,r)]:(n=this.tableIntelligenceServiceAttachedPromise.getCurrentValue(),(0,Yo.isDefined)(n)?[2,n.getRecognizedRangeTablesInfo.apply(n,r)]:(wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.TableIntelligenceFailure,failureLevel:Hn.TraceLevel.Warning,path:"FormulaBarScheduler.getRecognizedTablesInfo",description:"tableIntelligenceService is not attached yet"}}),[2,(0,Wh.failure)(void 0)]))})})},e.prototype.sendAugLoopSignal=function(r,t){return Bt.__awaiter(this,void 0,void 0,function(){var n,a;return Bt.__generator(this,function(o){switch(o.label){case 0:if(this.parent!==void 0)return[3,5];n=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.alManagerAttachedPromise.toPromise()];case 2:return n=o.sent(),[3,4];case 3:return a=o.sent(),wn.x10Logger.log({kind:"failure",payload:{failureKind:wn.X10FailureKind.ALFailure,failureLevel:Hn.TraceLevel.Warning,path:"FormulaBarScheduler.sendAugLoopSignal",description:"Error getting AugLoopService: ".concat(a)}}),[2,(0,Wh.failure)(a)];case 4:return[2,n.sendSignal(r,t)];case 5:return[2,this.parent.sendAugLoopSignal(r,t)]}})})},e.prototype.augloopCloseCallback=function(){ku.ulsLogger.ULS.traceTag(508629987,Hn.LogCategory.msoulscat_ES_EWAJS,Hn.TraceLevel.Info,"x10arch.FormulaBarScheduler.augloopCloseCallback: Got close callback from AugLoop Manager")},e.prototype.createChatGPTSession=function(r){return Bt.__awaiter(this,void 0,void 0,function(){var t;return Bt.__generator(this,function(n){switch(n.label){case 0:return this.parent!==void 0?[3,2]:[4,this.chatGPTProviderAttached()];case 1:return t=n.sent(),[2,t.createSession(r)];case 2:return[2,this.parent.createChatGPTSession(r)]}})})},e.prototype.closeChatGPTSession=function(r){return Bt.__awaiter(this,void 0,void 0,function(){var t;return Bt.__generator(this,function(n){switch(n.label){case 0:return this.parent!==void 0?[3,2]:[4,this.chatGPTProviderAttached()];case 1:return t=n.sent(),[2,t.closeSession(r)];case 2:return[2,this.parent.closeChatGPTSession(r)]}})})},e.prototype.sendChatGPTQuery=function(r,t){return Bt.__awaiter(this,void 0,void 0,function(){var n,a;return Bt.__generator(this,function(o){switch(o.label){case 0:return this.parent!==void 0?[3,3]:[4,this.chatGPTProviderAttached()];case 1:return n=o.sent(),[4,n.request(r,t)];case 2:return a=o.sent(),a.kind===Wh.ResultKind.Success&&!(0,Yo.isDefined)(a.value)?[2,(0,Wh.failure)(void 0)]:((0,s1.staticTypeHint)(a),[2,a]);case 3:return[2,this.parent.sendChatGPTQuery(r,t)]}})})},e.prototype.shouldRunRequest=function(r,t,n,a,o){for(var u=this.responseStates[r][t],s=o===Zs.ExecutionType.Async?u.attachedComputations:u.attachedSyncComputations,l=0,c=s;l<c.length;l++){var d=c[l];if(r!==ga.ComputationType.UIMessage||pre(r,t,d,a,n))return!0}return!1},e.abstractStepCosts=(o1={},o1[Jn.SchedulerTimelineQueueMessageKind.NoOpRequest]=.01,o1[Jn.SchedulerTimelineQueueMessageKind.AsyncRequest]=.1,o1[Jn.SchedulerTimelineQueueMessageKind.SyncRequest]=.5,o1[Jn.SchedulerTimelineQueueMessageKind.StepComputation]=1,o1[Jn.SchedulerTimelineQueueMessageKind.StopComputationFrame]=.01,o1[Jn.SchedulerTimelineQueueMessageKind.Timeout]=.01,o1),e}();zh.FormulaBarScheduler=nNr;function uke(e,r){switch(r.kind){case Hh.InternalSchedulerResponseKind.FirstStep:return e.next();case Hh.InternalSchedulerResponseKind.NormalResponse:return e.next(r.response);case Hh.InternalSchedulerResponseKind.RequestFailure:return e.throw({kind:r.failure.kind,request:r.request,reason:r.failure.reason});default:(0,ku.assertNever)("x10arch: FormulaBarScheduler.stepPlugin: unknown payload",r)}}function pre(e,r,t,n,a){var o,u=(o=F6.computationRegistry[e].getRegistrationsByComputationIdentifier(t))!==null&&o!==void 0?o:{type:e,kind:r,modifiers:{},pluginGroup:n&&dre.pluginGroupMap[n][t.factoryName]===!0?n:T_.PluginGroup.Excel};return(0,F6.getShouldRunComputationPredicate)(u)(a,n)}zh.shouldRunComputation=pre;function aNr(e){return e.numFailures+e.numSkippedComputations+e.successfulResults.results.length}function iNr(e){switch(!0){case e.numFailures+e.numSkippedComputations+e.successfulResults.results.length!==e.numOfComputations:return;case e.numFailures===e.numOfComputations:return Jn.ExecutionStopReason.Computation.Exception;case e.numSkippedComputations===e.numOfComputations:return Jn.ExecutionStopReason.Computation.Skipped;default:return Jn.ExecutionStopReason.Computation.Done}}function oNr(e){wn.x10Logger.log({kind:"computationStoppedExecution",payload:{computationName:"".concat(e.computationInfo.pluginFactoryNameString,".").concat(e.computationInfo.computationIdentifier.computationName),stopReason:e.stopReason,logInfo:e.computationInfo}}),e.stopReason===Jn.ExecutionStopReason.Computation.Done&&wn.x10Logger.log({kind:"pluginCompletedInTime",payload:{pluginName:e.computationInfo.pluginFactoryNameString,logInfo:e.computationInfo}})}function ske(e){var r=null;return!(0,Yo.isNone)(e.formatString)&&!(0,Yo.isNone)(e.builtIn)&&(r={formatString:e.formatString,builtIn:e.builtIn}),r}});var cke=T(dO=>{"use strict";p();Object.defineProperty(dO,"__esModule",{value:!0});dO.experimentQueueProcessorFactory=dO.ExperimentQueueProcessor=void 0;var mre=Ar(),uNr=Jee(),sNr=Xo(),lke=function(){function e(r){this.consumeMessage=r,this.queue=new uNr.PriorityQueue(function(){return 0})}return e.prototype.enqueue=function(r,t,n){(0,mre.isDefined)(n)&&r.kind===sNr.SchedulerTimelineQueueMessageKind.StopComputationFrame||this.queue.enqueue(r)},e.prototype.step=function(){var r=this.queue.pop();(0,mre.isDefined)(r)&&this.consumeMessage(r)},Object.defineProperty(e.prototype,"done",{get:function(){return this.queue.getCount()===0},enumerable:!1,configurable:!0}),e}();dO.ExperimentQueueProcessor=lke;var lNr=function(r){return new lke(r)};dO.experimentQueueProcessorFactory=lNr;(0,mre.staticAssertExtends)()});var mke=T(O6=>{"use strict";p();Object.defineProperty(O6,"__esModule",{value:!0});O6.NaiveLocalSheetGrid=void 0;var cNr=Ar(),Pv=zn(),dke=No(),gre=qi(),b2=QR(),fke=Zc(),pke=Pf(),dNr=Mh(),fNr=Eg(),pNr=Ba(),mNr=function(){function e(r,t,n,a){this.formats=void 0,this.values=void 0,this.formulae=void 0,this.valueAvailabilitySet=void 0,this.formatAvailabilitySet=void 0,this.formulaAvailabilitySet=void 0,(0,Pv.isSuccess)(t)&&(this.values=e.buildSparseMatrix(t.value.nonEmptyCells,function(o){return o}),this.valueAvailabilitySet=e.unionRanges(t.value.availableRanges)),(0,Pv.isSuccess)(a)&&(this.formats=e.buildSparseMatrix(a.value.nonEmptyCells,function(o){return o}),this.formatAvailabilitySet=e.unionRanges(a.value.availableRanges)),(0,Pv.isSuccess)(n)&&(this.formulae=e.buildSparseMatrix(n.value.nonEmptyCells,function(o){return o}),this.formulaAvailabilitySet=e.unionRanges(n.value.availableRanges))}return e.buildSparseMatrix=function(r,t){for(var n=[],a=0,o=r;a<o.length;a++)for(var u=o[a],s=u[0],l=s[0],c=s[1],d=s[2],f=d===void 0?1:d,m=s[3],v=m===void 0?1:m,h=u.slice(1),y=h.length,_=c,E=0;_<c+v;_+=1)for(var N=l;N<l+f;N+=1,E=(E+1)%y)n[N]===void 0&&(n[N]=[]),n[N][_]=t(h[E],N,_);return n},e.forEachInSparseMatrix=function(r,t,n){n===void 0&&(n=function(){return!1});var a=!0;return r.forEach(function(o,u){a&&o.forEach(function(s,l){if(a&&!n(s)){var c=t((0,dke.gridCell)(u,l),s);c||(a=!1)}})}),a},e.unionRanges=function(r){return r.map(fke.createCellSetFromRange).reduce(pke.unionProduct,dNr.empty)},e.prototype.getCellValue=function(r,t){return this.isAvailable(r,t,"value")?this.values!==void 0&&this.values[r]!==void 0&&this.values[r][t]!==void 0?(0,Pv.success)(this.values[r][t]):(0,Pv.success)(b2.emptyRangeValue):(0,Pv.failure)((0,gre.unavailable)(["getCellValue"]))},e.prototype.getCellFormat=function(r,t){return this.isAvailable(r,t,"format")?this.formats!==void 0&&this.formats[r]!==void 0&&this.formats[r][t]!==void 0?(0,Pv.success)(this.formats[r][t]):(0,Pv.success)(b2.emptyRangeFormat):(0,Pv.failure)((0,gre.unavailable)(["getCellFormat"]))},e.prototype.getCellFormula=function(r,t){return this.isAvailable(r,t,"formula")?this.formulae!==void 0&&this.formulae[r]!==void 0&&this.formulae[r][t]!==void 0?(0,Pv.success)(this.formulae[r][t]):(0,Pv.success)(b2.emptyRangeFormula):(0,Pv.failure)((0,gre.unavailable)(["getCellFormula"]))},e.prototype.foreachNonBlankCellValue=function(r){return this.values===void 0?!0:e.forEachInSparseMatrix(this.values,r,function(t){return t.kind===fNr.OperKind.Blank})},e.prototype.foreachNonBlankCellFormula=function(r){return this.formulae===void 0?!0:e.forEachInSparseMatrix(this.formulae,r,function(t){return t.kind===b2.emptyRangeFormula.kind&&t.formulaBarText===b2.emptyRangeFormula.formulaBarText})},e.prototype.isAvailable=function(r,t,n){var a,o;switch(n){case"value":o=this.valueAvailabilitySet;break;case"formula":o=this.formulaAvailabilitySet;break;case"format":o=this.formatAvailabilitySet;break;default:(0,pNr.assertNever)("isAvailable",n)}return o===void 0?!1:((a=(0,pke.compareProduct)((0,fke.createCellSetFromRange)((0,dke.gridCell)(r,t)),o))!==null&&a!==void 0?a:1)<=0},e}();O6.NaiveLocalSheetGrid=mNr;(0,cNr.staticAssertExtends)()});var Mke=T(M6=>{"use strict";p();Object.defineProperty(M6,"__esModule",{value:!0});M6.PrefetchingCache=void 0;var $u=fe(),Jm=No(),gke=mke(),Qh=qi(),k6=zn(),Ea=zn(),vke=Gi(),gNr=Hf(),vre=jR(),C2=Ar(),vNr=_R(),Jp=Zc(),wd=Mh(),R2=Pf(),kke=yK(),hNr=Us(),fO=Us(),SNr=oU(),yNr=$A(),_Nr=rF(),hke=cx(),Ske=tF(),T2=uv(),yke=ti(),bNr=yG(),_ke=Xp();function bke(e){var r=e.hasHeadersRow,t=e.hasTotalsRow,n=e.dataRange;return(0,Jm.gridRange)(n.row-Number(r),n.col,n.rows+Number(r)+Number(t),n.cols)}function Cke(e,r,t,n){for(var a=r.name,o=r.hasHeadersRow,u=r.hasTotalsRow,s=r.dataRange,l=r.columns,c=o?(0,Jm.gridRange)(s.row-1,s.col,1,s.cols):void 0,d=u?(0,Jm.gridRange)(s.row+s.rows,s.col,1,s.cols):void 0,f={},m=kke.RedBlackMapTree.create(e.stringCompareCI),v=0,h=l;v<h.length;v++){var y=h[v];f[y.column]=y,m=m.setValue(y.name,y)}return{name:a,sheet:t,dataRange:s,headersRange:c,totalsRange:d,allRange:n,indexToColumn:f,nameToColumn:m,allColumnNamesAvailable:l.length===s.cols}}function CNr(){return{cellTiles:[],tables:(0,vNr.makeGridRangeTable)(),tableTiles:[],hiddenRows:wd.empty,hiddenRowsAvailability:wd.empty,hiddenCols:wd.empty,hiddenColsAvailability:wd.empty}}function Tke(e,r){var t;return((t=(0,R2.compareProduct)((0,Jp.createCellSetFromRange)(r),e))!==null&&t!==void 0?t:1)<=0}var Rke=(0,Ea.failure)((0,Qh.unavailable)(["getCell"])),Eke=(0,Ea.failure)((0,Qh.unavailable)(["getContainingTable"])),Pke=(0,Ea.failure)((0,Qh.unavailable)(["getIntersectingTables"])),Ake=(0,Ea.failure)((0,Qh.unavailable)(["getIntersectingTableNames"])),Fke=(0,Ea.failure)((0,Qh.unavailable)(["getIformats"])),Nke=(0,Ea.failure)((0,Qh.unavailable)(["GetAvailableTableHeaders"]));function Oke(e,r){var t=Object.create(e);for(var n in r)t[n]=r[n];return t}var TNr=function(){function e(r,t,n){this.grid=r,this.syncDataStore=t,this.correlationId=n,this.correspondingSnapshotID=-1,this.sheet2contents=(0,C2.makeStringMap)(),this.currentDocumentLoc=(0,Jm.documentLoc)(void 0,""),this.formatPages=[],this.formulaCache=new Map,this.englishFormulaCache=new Map,this.builtInFormatCache=new Map,this.customFormatCache=new Map,this.parser=(0,hke.createParser)(t),this.analyzer=(0,Ske.createAnalyzer)(t),this.formatter=(0,SNr.createNumberFormatter)(t),this.resolver=(0,bNr.createResolver)(t);var a=Oke(t,{config:Oke(t.config,{localeInfo:(0,vke.getEnglishLocaleInfo)()})});this.englishParser=(0,hke.createParser)(a),this.englishAnalyzer=(0,Ske.createAnalyzer)(a)}return e.getOrFetchTile=function(r,t,n){var a=t.range.row>>>e.tileHeightPow,o=t.range.col>>>e.tileWidthPow;r[a]===void 0&&(r[a]=[]);var u=r[a][o];if(u===void 0){var s=(0,Jm.sheetGridRange)(t.sheet,(0,Jm.gridRange)(a<<e.tileHeightPow,o<<e.tileWidthPow,1<<e.tileHeightPow,1<<e.tileWidthPow));return n(s).then(function(l){return r[a][o]=l})}return u},e.create=function(r,t,n){return new e(r,t,n)},e.prototype.getSheetContents=function(r){var t;return(t=this.sheet2contents[r])!==null&&t!==void 0?t:this.sheet2contents[r]=CNr()},e.prototype.getCurrentDocumentLoc=function(){return this.currentDocumentLoc},e.prototype.getSheetNames=function(){var r;if(this.sheetNames===void 0){var t=[];(r=this.syncDataStore.sheets)===null||r===void 0||r.forEachSheet(function(d){t.push({sheetIndex:d.sheetIndex,sheetName:d.name})});for(var n={},a=kke.RedBlackMapTree.create(this.syncDataStore.config.localeInfo.stringCompareCI),o=0;o<t.length;o+=1){var u=t[o],s=u.sheetIndex,l=u.sheetName;n[s.index]=o,a=a.setValue(l,o)}var c=this.getCurrentDocumentLoc();this.sheetNames={document:c,sheets:t,idToIndex:n,nameToIndex:a}}return(0,Ea.success)(this.sheetNames)},e.prototype.getRangeValues=function(r){return this.grid.getRangeValues(this.correlationId,r)},e.prototype.getRangeFormulae=function(r){return this.grid.getRangeFormulae(this.correlationId,r)},e.prototype.getRangeFormats=function(r){return this.grid.getRangeFormats(this.correlationId,r)},e.prototype.getHiddenRows=function(r,t,n){return $u.__awaiter(this,void 0,void 0,function(){var a,o,u,s,l,c,d;return $u.__generator(this,function(f){switch(f.label){case 0:return a=this.getSheetContents(r.index),o=Jp.bspFactory.row([t,n]),u=(0,wd.compare)(o,a.hiddenRowsAvailability),s=u===0||u===-1,s?[3,2]:[4,this.grid.getHiddenRows(this.correlationId,r,(0,C2.fastMax)(0,t-10),(0,C2.fastMin)(Jm.sheetRows,n+10))];case 1:l=f.sent(),a.hiddenRows=l.hidden.reduce(function(m,v){var h=v.start,y=v.end;return(0,wd.union)(m,Jp.bspFactory.row([h,y]))},a.hiddenRows),a.hiddenRowsAvailability=l.available.reduce(function(m,v){var h=v.start,y=v.end;return(0,wd.union)(m,Jp.bspFactory.row([h,y]))},a.hiddenRowsAvailability),f.label=2;case 2:return c=[],(0,Jp.forEachRow)((0,wd.intersect)(a.hiddenRowsAvailability,o),function(m){var v=m[0],h=m[1];return c.push((0,T2.interval)(v,h)),!0}),d=[],(0,Jp.forEachRow)((0,wd.intersect)(a.hiddenRows,o),function(m){var v=m[0],h=m[1];return d.push((0,T2.interval)(v,h)),!0}),[2,{available:c,hidden:d}]}})})},e.prototype.getHiddenCols=function(r,t,n){return $u.__awaiter(this,void 0,void 0,function(){var a,o,u,s,l,c,d;return $u.__generator(this,function(f){switch(f.label){case 0:return a=this.getSheetContents(r.index),o=Jp.bspFactory.col([t,n]),u=(0,wd.compare)(o,a.hiddenColsAvailability),s=u===0||u===-1,s?[3,2]:[4,this.grid.getHiddenCols(this.correlationId,r,(0,C2.fastMax)(0,t-10),(0,C2.fastMin)(Jm.sheetCols,n+10))];case 1:l=f.sent(),a.hiddenCols=l.hidden.reduce(function(m,v){var h=v.start,y=v.end;return(0,wd.union)(m,Jp.bspFactory.col([h,y]))},a.hiddenCols),a.hiddenColsAvailability=l.available.reduce(function(m,v){var h=v.start,y=v.end;return(0,wd.union)(m,Jp.bspFactory.col([h,y]))},a.hiddenColsAvailability),f.label=2;case 2:return c=[],(0,Jp.forEachCol)((0,wd.intersect)(a.hiddenColsAvailability,o),function(m){var v=m[0],h=m[1];return c.push((0,T2.interval)(v,h)),!0}),d=[],(0,Jp.forEachCol)((0,wd.intersect)(a.hiddenCols,o),function(m){var v=m[0],h=m[1];return d.push((0,T2.interval)(v,h)),!0}),[2,{available:c,hidden:d}]}})})},e.prototype.getRange=function(r,t){return $u.__awaiter(this,void 0,void 0,function(){var n,a,o,u,s,l,c,d;return $u.__generator(this,function(f){switch(f.label){case 0:return n=t===void 0||t.indexOf("values")>-1,a=t===void 0||t.indexOf("formulae")>-1,o=t===void 0||t.indexOf("formats")>-1,u=(0,Ea.failure)((0,Qh.unavailable)(["getRange"])),[4,Promise.all([n?this.getRangeValues(r):u,a?this.getRangeFormulae(r):u,o?this.getRangeFormats(r):u])];case 1:return s=f.sent(),l=s[0],c=s[1],d=s[2],[2,new gke.NaiveLocalSheetGrid(r.sheet,l,c,d)]}})})},e.prototype.getCell=function(r){var t=this,n=this.getSheetContents(r.sheet.index),a=e.getOrFetchTile(n.cellTiles,r,function(o){return $u.__awaiter(t,void 0,void 0,function(){var u,s,l,c,d;return $u.__generator(this,function(f){switch(f.label){case 0:return[4,this.grid.getRangeValues(this.correlationId,o)];case 1:return d=[f.sent()],[4,this.grid.getRangeFormulae(this.correlationId,o)];case 2:return d=d.concat([f.sent()]),[4,this.grid.getRangeFormats(this.correlationId,o)];case 3:return u=d.concat([f.sent()]),s=u[0],l=u[1],c=u[2],!(0,Ea.isSuccess)(s)||!(0,Ea.isSuccess)(l)||!(0,Ea.isSuccess)(c)?[2,"unavailable"]:[2,new gke.NaiveLocalSheetGrid(r.sheet,s,l,c)]}})})});return(0,vre.bindMaybeThenable)(a,function(o){if(o==="unavailable")return Rke;var u=o.getCellValue(r.range.row,r.range.col),s=o.getCellFormula(r.range.row,r.range.col),l=o.getCellFormat(r.range.row,r.range.col);return!(0,Ea.isSuccess)(u)||!(0,Ea.isSuccess)(s)||!(0,Ea.isSuccess)(l)?Rke:(0,Ea.success)({value:u.value,formula:s.value,format:l.value})})},e.prototype.getAvailableTableHeaders=function(r){var t=this.syncDataStore.nameManager;if(!t)return Nke;var n=t.getAllDocumentNames(),a=n.find(function(u){return u.name===r});if(!a)return Nke;var o=t.getAvailableTableColumns(a);return(0,Ea.success)(o)},e.prototype.getStructRefColumn=function(r,t){var n=this.syncDataStore.getStructRefColumn(r,t);return n.kind===k6.ResultKind.Failure?(0,Ea.failure)((0,Qh.unavailable)(["getStructRefColumn"])):n},e.prototype.getStructRefSpecialRef=function(r,t){var n=this.syncDataStore.getStructRefSpecialRef(r,t);return n.kind===k6.ResultKind.Failure?(0,Ea.failure)((0,Qh.unavailable)(["getStructRefSpecialRef"])):n},e.prototype.getContainingTableName=function(r){var t=this.syncDataStore.getContainingTable(r);return t.kind===k6.ResultKind.Failure?(0,Ea.failure)((0,Qh.unavailable)(["getContainingTableName"])):t},e.prototype.getContainingTable=function(r){return $u.__awaiter(this,void 0,void 0,function(){var t,n,a=this;return $u.__generator(this,function(o){return t=this.getSheetContents(r.sheet.index),n=e.getOrFetchTile(t.tableTiles,r,function(u){return $u.__awaiter(a,void 0,void 0,function(){var s,l,c,d,f,m;return $u.__generator(this,function(v){switch(v.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,u)];case 1:if(s=v.sent(),!(0,Ea.isSuccess)(s))return[2,"unavailable"];for(l=s.value.availableRanges.map(Jp.createCellSetFromRange).reduce(R2.unionProduct,wd.empty),c=0,d=s.value.tables;c<d.length;c++)f=d[c],m=bke(f),t.tables.getValue(m)||(t.tables=t.tables.setValue(m,Cke(this.syncDataStore.config.localeInfo,f,r.sheet,m)));return[2,l]}})})}),[2,(0,vre.bindMaybeThenable)(n,function(u){if(u==="unavailable")return Eke;var s;return t.tables.forEachGe(r.range,function(l,c){return s=c,!1}),s!==void 0||Tke(u,r.range)?(0,Ea.success)(s):Eke})]})})},e.prototype.getIntersectingTables=function(r){return $u.__awaiter(this,void 0,void 0,function(){var t,n,a,o,u,s,l,c,d,f,m=this;return $u.__generator(this,function(v){switch(v.label){case 0:t=this.getSheetContents(r.sheet.index),n=wd.empty,a=r.range.row,o=r.range.row+r.range.rows,v.label=1;case 1:if(!(a<o))return[3,8];u=r.range.col,s=r.range.col+r.range.cols,v.label=2;case 2:return u<s?(l=e.getOrFetchTile(t.tableTiles,(0,Jm.sheetGridCell)(r.sheet,(0,Jm.gridCell)(a,u)),function(h){return m.fetchTableTile(h.sheet,t,h)}),(0,vre.isThenable)(l)?[4,l]:[3,4]):[3,7];case 3:return d=v.sent(),[3,5];case 4:d=l,v.label=5;case 5:if(c=d,c==="unavailable")return[2,Pke];n=(0,R2.unionProduct)(n,c),v.label=6;case 6:return u+=1<<e.tileWidthPow,[3,2];case 7:return a+=1<<e.tileHeightPow,[3,1];case 8:return f=[],t.tables.forEachMeets(r.range,function(h,y){return f.push(y),n=(0,R2.unionProduct)(n,(0,Jp.createCellSetFromRange)(h)),!0}),[2,Tke(n,r.range)?(0,Ea.success)(f):Pke]}})})},e.prototype.getIntersectingTableNames=function(r){if(this.syncDataStore.nameManager===void 0)return Ake;var t=this.syncDataStore.nameManager.getIntersectingTables(r);return t.kind===k6.ResultKind.Failure?Ake:t},e.prototype.fetchTableTile=function(r,t,n){return $u.__awaiter(this,void 0,void 0,function(){var a,o,u,s,l,c;return $u.__generator(this,function(d){switch(d.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,n)];case 1:if(a=d.sent(),!(0,Ea.isSuccess)(a))return[2,"unavailable"];for(o=a.value.availableRanges.map(Jp.createCellSetFromRange).reduce(R2.unionProduct,wd.empty),u=0,s=a.value.tables;u<s.length;u++)l=s[u],c=bke(l),t.tables.getValue(c)||(t.tables=t.tables.setValue(c,Cke(this.syncDataStore.config.localeInfo,l,r,c)));return[2,o]}})})},e.prototype.getIformat=function(r,t){return $u.__awaiter(this,void 0,void 0,function(){var n,a,o,u,s,l,c,d,f,m;return $u.__generator(this,function(v){switch(v.label){case 0:return n=t>>>e.formatPagePow,a=n<<e.formatPagePow,o=a+(1<<e.formatPagePow),u=this.formatPages[n],u!==void 0?[3,2]:[4,this.grid.getIformats(this.correlationId,r,a,o)];case 1:if(s=v.sent(),!(0,Ea.isSuccess)(s))u=this.formatPages[n]="unavailable";else{for(l=[],c=0,d=s.value.availableFormats;c<d.length;c++)f=d[c],!(f.iformat<a||f.iformat>=o)&&(l[f.iformat-a]=f);u=this.formatPages[n]=l}v.label=2;case 2:return u==="unavailable"?[2,Fke]:(m=u[t-a],m===void 0?[2,Fke]:[2,(0,Ea.success)(m)])}})})},e.prototype.parseCellFormula=function(r,t,n){return{result:e.cachedParseFormula(n?this.englishFormulaCache:this.formulaCache,n?this.englishParser:this.parser,n?this.englishAnalyzer:this.analyzer,r,t)}},e.prototype.parseEdit=function(r,t){var n;return $u.__awaiter(this,void 0,void 0,function(){var a;return $u.__generator(this,function(o){switch(o.label){case 0:return[4,this.getEditFormat(r)];case 1:return a=(n=o.sent())!==null&&n!==void 0?n:{valueType:fO.FormatValueType.General,bidiDate:void 0,culture:void 0},[2,this.parseEditInternal(r,t,a)]}})})},e.prototype.parseEditSync=function(r,t,n){var a=this.parseNumberFormat(n.formatString,n.builtIn).result,o;return(0,Ea.isSuccess)(a)?o=a.value:o={valueType:fO.FormatValueType.General,bidiDate:void 0,culture:void 0},this.parseEditInternal(r,t,o)},e.prototype.resolveReferences=function(r,t){var n=this;return t.map(function(a){switch(a.kind){case yke.NodeKind.StructRef:return n.resolveStructRefSync(r,a).result;case yke.NodeKind.CellRef:return n.resolveCellRefNodeSync(r,a).result}})},e.prototype.getCorrespondingSnapshotID=function(){return $u.__awaiter(this,void 0,void 0,function(){var r;return $u.__generator(this,function(t){switch(t.label){case 0:return this.correspondingSnapshotID!==-1?[3,2]:(r=this,[4,this.grid.getCorrespondingSnapshotID(this.correlationId)]);case 1:r.correspondingSnapshotID=t.sent(),t.label=2;case 2:return[2,this.correspondingSnapshotID]}})})},e.prototype.getEditFormat=function(r){return $u.__awaiter(this,void 0,void 0,function(){var t,n,a,o,u,s;return $u.__generator(this,function(l){switch(l.label){case 0:return[4,this.getCell(r)];case 1:return t=l.sent(),(0,Ea.isSuccess)(t)?typeof t.value.format!="string"?[3,2]:(n=this.parseNumberFormat(t.value.format,!1).result,[3,4]):[2,void 0];case 2:return[4,this.getIformat(r.sheet.document,t.value.format)];case 3:if(a=l.sent(),!(0,Ea.isSuccess)(a))return[2,void 0];o=a.value,u=o.formatString,s=o.builtIn,n=this.parseNumberFormat(u,s).result,l.label=4;case 4:return[2,(0,Ea.isSuccess)(n)?n.value:void 0]}})})},e.prototype.parseEditInternal=function(r,t,n){var a=this.formatter.parseEdit(t,n);if(!(0,Ea.isSuccess)(a))return{result:a};if(a.value.kind===fO.EditKind.String&&t==="="&&n.valueType!==fO.FormatValueType.Text&&(a=(0,Ea.success)((0,hNr.formulaEdit)(t))),a.value.kind!==fO.EditKind.Formula)return{result:(0,Ea.success)(a.value)};var o=e.parseCheckedFormula(this.parser,this.analyzer,r,a.value.fmla,r.range);return(0,Ea.isSuccess)(o)?{result:(0,Ea.success)({kind:fO.EditKind.Formula,fmla:a.value.fmla,formula:o.value})}:{result:o}},e.cachedParseFormula=function(r,t,n,a,o){var u,s=r.get(o);if(s!==void 0)return s;var l=e.parseWellFormedFormula(t,n,a,o.formulaBarText,(u=o.origin)!==null&&u!==void 0?u:a.range);return r.set(o,l),l},e.parseWellFormedFormula=function(r,t,n,a,o){var u=e.parseCheckedFormula(r,t,n,a,o);return(0,Ea.isSuccess)(u)?(0,Qh.isWellFormed)(u.value)?(0,Ea.success)(u.value):(0,Ea.failure)((0,T2.illFormedFormula)("ill-formed formula")):u},e.parseCheckedFormula=function(r,t,n,a,o){var u=r.parseFormula((0,yNr.parseLocals)(Jm.LexicalKind.Cell,o),a);if(!(0,Ea.isSuccess)(u))return u;var s=t.checkFormula((0,_Nr.analyzeLocalsGrid)(Jm.LexicalKind.Cell,(0,Jm.sheetGridCell)(n.sheet,o)),u.value);return(0,Ea.isSuccess)(s)?(0,Ea.success)(s.value):s},e.prototype.parseNumberFormat=function(r,t){return{result:this.cachedParseNumberFormat(r,t)}},e.prototype.evalOnClonedModel=function(r,t,n){return this.grid.evalClonedModelOnSnapshot(this.correlationId,r,t,n)},e.prototype.evalFormula=function(r,t,n){return this.grid.evalFormulaOnSnapshot(this.correlationId,r,t,n)},e.prototype.cachedParseNumberFormat=function(r,t){var n=t?this.builtInFormatCache.get(r):this.customFormatCache.get(r);if(n!==void 0)return n;var a=this.formatter.createFormat(r,t);return t?this.builtInFormatCache.set(r,a):this.customFormatCache.set(r,a),a},e.prototype.resolveStructRefSync=function(r,t){return{result:this.resolver.resolveStructRef(r,t)}},e.prototype.resolveCellRefNodeSync=function(r,t){return{result:this.resolver.resolveCellRef(r,t)}},e.prototype.close=function(){this.grid.discardSnapshot(this.correlationId).catch(function(r){_ke.x10Logger.log({kind:"failure",payload:{failureKind:_ke.X10FailureKind.GridFailure,failureLevel:vke.TraceLevel.Warning,path:"PrefetchingCache.close",description:(0,gNr.messageFromError)(r)}})})},e.tileWidthPow=2,e.tileHeightPow=4,e.formatPagePow=6,e}();M6.PrefetchingCache=TNr});var Bke=T(qS=>{"use strict";p();Object.defineProperty(qS,"__esModule",{value:!0});qS.dynamicPluginLoaderInsideInit=qS.timelineQueueProcessorFactory=qS.createPrefetchingCacheFactory=qS.DynamicPluginLoader=void 0;var es=fe(),E2=es.__importStar(sy()),x6=nl(),I6=N6(),Dke=N6(),pO=GM(),Lke=Ba(),xke=yc(),P2=Ar(),RNr=ZN(),qke=ZN(),ENr=kee(),hre=Qm(),Ike=hc(),Sre=Xp(),wke=Mke(),Gke=function(){function e(r,t){if(!(t instanceof Dke.FormulaBarScheduler))throw new TypeError("DynamicPluginLoaderBase.constructor: unknown IFormulaBarScheduler class: ".concat(JSON.stringify(t)));this.scheduler=t,Sre.x10Logger.threadId=r}return e.prototype.loadPluginScriptTrace=function(r,t){Lke.ulsLogger.ULS.traceTag(553734797,x6.LogCategory.msoulscat_ES_EWAJS,x6.TraceLevel.Info,Sre.x10Logger.formatLogMessage("loadPluginScript",{description:"".concat(r," loaded, time to load ").concat(t)}))},e.prototype.createAndAttachPlugin=function(r,t){return es.__awaiter(this,void 0,void 0,function(){var n;return es.__generator(this,function(a){return n=(0,xke.getPluginFactory)(r),this.scheduler.createAndAttachPlugin(n,t),[2]})})},e.prototype.createAndAttachSyncPlugin=function(r,t){return es.__awaiter(this,void 0,void 0,function(){var n;return es.__generator(this,function(a){return n=(0,xke.getPluginFactory)(r),this.scheduler.createAndAttachSyncPlugin(n,t),[2]})})},e}(),PNr=function(e){es.__extends(r,e);function r(t,n,a,o){var u=e.call(this,"Main",a)||this;u.threadEntryPoint=t,u.gridManager=n,u.loader=o;var s=o.getConfig();return u.resolveScript=s.resolveScript,u}return r.prototype.loadPluginScript=function(t,n){return es.__awaiter(this,void 0,void 0,function(){var a,o,u;return es.__generator(this,function(s){switch(s.label){case 0:return(0,P2.isNone)(t)||(0,P2.isNone)(n)?[2]:(a=qke.defaultTimerInterface,o=a.now(),[4,this.loader.loadScript(t)]);case 1:return s.sent(),u=a.now()-o,this.loadPluginScriptTrace(t,u),[2]}})})},r.prototype.isThreadingSupported=function(){return E2.isThreadingSupported()&&(0,pO.getCalcAbsUrl)()!==void 0},r.prototype.createPluginThread=function(t){return es.__awaiter(this,void 0,void 0,function(){var n,a,o,u,s,l,c,d=this;return es.__generator(this,function(f){switch(f.label){case 0:return n="DynamicPluginLoaderThread-".concat(r.lastThreadNum+=1,"-").concat(t),a="".concat(n,"-IGrid"),[4,pO.initCalcCalled];case 1:return f.sent(),[4,E2.createWorker({createMode:"Thread",id:n},E2.paramInsideDef({scriptUrl:(0,pO.getCalcAbsUrlOrThrow)(),insideInitName:this.threadEntryPoint},{pluginResponseWindows:this.scheduler.getPluginResponseWindows()}),function(){return es.__assign(es.__assign({},(0,hre.bindMethods)(d.scheduler,es.__spreadArray(es.__spreadArray([],I6.parentMethodsCall,!0),I6.parentMethodsPost,!0))),{resolveScript:d.resolveScript})})];case 2:o=f.sent(),f.label=3;case 3:return f.trys.push([3,5,,6]),u=function(){},o.onClose=function(){u(),Lke.ulsLogger.ULS.traceTag(553734798,x6.LogCategory.msoulscat_ES_EWAJS,x6.TraceLevel.Info,Sre.x10Logger.formatLogMessage("DynamicPluginLoader",{description:"Thread closed"}))},[4,(0,pO.initCalcThread)(o)];case 4:return s=f.sent(),u=function(){return s.close()},this.scheduler.doNotifyStatelessSubject.subscribe(function(m){return o.post.processNotification(m)}),this.scheduler.requestWithCorrelationIdSubject.subscribe(function(m){var v;return(v=o.post).requestWithCorrelationId.apply(v,m)}),this.scheduler.doNotifyStatefulSubject.subscribe(function(m){return o.post.processNotification(m)}),l={createIGridImportEndpoint:function(v){return o.call.createIGridImportEndpoint.transfer([v.port],v)},onGridExporterClosed:o.post.onGridExporterClosed},this.gridManager.onGridImporterCreated(l,a),[2,new ANr(o)];case 5:throw c=f.sent(),o.close(),c;case 6:return[2]}})})},r.lastThreadNum=0,r}(Gke);qS.DynamicPluginLoader=PNr;var ANr=function(){function e(r){this.outside=r}return e.prototype.loadPluginScript=function(r,t){return this.outside.call.loadPluginScript(r,t)},e.prototype.createAndAttachPlugin=function(r,t){return this.outside.call.createAndAttachPlugin(r,t)},e.prototype.createAndAttachSyncPlugin=function(r,t){return this.outside.call.createAndAttachSyncPlugin(r,t)},e.prototype.recalcServiceAttached=function(){return this.outside.call.recalcServiceAttached()},e.prototype.close=function(){this.outside.close()},e}(),FNr=function(r){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=r.getGrid();if(a!==void 0)return wke.PrefetchingCache.create.apply(wke.PrefetchingCache,es.__spreadArray([a],t,!1))}};qS.createPrefetchingCacheFactory=FNr;var NNr=function(r){return function(t){return new RNr.TimelineQueueProcessor(function(n,a){return n.kind-a.kind},t,void 0,r)}};qS.timelineQueueProcessorFactory=NNr;var ONr=function(r,t){return function(n,a){var o=n.config,u=n.connection,s=a.pluginResponseWindows;return es.__awaiter(void 0,void 0,void 0,function(){return es.__generator(this,function(l){return[2,E2.Endpoint.createInside(u,function(c){var d=es.__assign(es.__assign({},(0,hre.bindLazyMethods)(new Ike.ResettableLazy(function(){return c.call}),I6.parentMethodsCall)),(0,hre.bindLazyMethods)(new Ike.ResettableLazy(function(){return c.post}),I6.parentMethodsPost)),f=void 0,m=new ENr.GridProvider(function(){return v.registerAsyncGrid()}),v=new Dke.FormulaBarScheduler(r(f),t(m),s,m.getGridDataSink(),m.getSyncDataModel(),f,d);return new kNr(String(u.options.id),m,v,o,c)})]})})}};qS.dynamicPluginLoaderInsideInit=ONr;var kNr=function(e){es.__extends(r,e);function r(t,n,a,o,u){var s=e.call(this,t,a)||this;return s.gridImporter=n,s.twConfig=o,s.inside=u,s.loadedScripts=(0,P2.makeStringMap)(),s.initCalcThreadInside=function(l,c,d){return es.__awaiter(s,void 0,void 0,function(){return es.__generator(this,function(f){switch(f.label){case 0:return[4,(0,pO.initCalcInThread)(l,c,d,this.twConfig)];case 1:return f.sent(),[2]}})})},s.createIGridImportEndpoint=s.gridImporter.createIGridImportEndpoint.bind(s.gridImporter),s.onGridExporterClosed=s.gridImporter.onGridExporterClosed.bind(s.gridImporter),s.processNotification=s.scheduler.processNotification.bind(s.scheduler),s.requestWithCorrelationId=s.scheduler.requestWithCorrelationId.bind(s.scheduler),s}return r.prototype.loadPluginScript=function(t,n){return es.__awaiter(this,void 0,void 0,function(){var a,o,u,s,l;return es.__generator(this,function(c){switch(c.label){case 0:return(0,P2.isNone)(t)||(0,P2.isNone)(n)?[2]:this.loadedScripts[t]===!0?[2]:(a=qke.defaultTimerInterface,o=a.now(),s=(u=E2).importScriptsWithRetry,[4,this.inside.call.resolveScript({identifier:t,isLocalized:n})]);case 1:return s.apply(u,[[c.sent()],pO.maxRetriesForLoadingScript]),l=a.now()-o,this.loadedScripts[t]=!0,this.loadPluginScriptTrace(t,l),[2]}})})},r.prototype.recalcServiceAttached=function(){return this.scheduler.recalcServiceAttached()},r}(Gke)});var w6=T(tE=>{"use strict";p();var yre;Object.defineProperty(tE,"__esModule",{value:!0});tE.platform=void 0;var MNr=["Web","Win32"];tE.platform=(yre=globalThis.__x10_target_platform)!==null&&yre!==void 0?yre:"Web";if(MNr.indexOf(tE.platform)<0)throw new Error("Wrong platform id ".concat(tE.platform));globalThis.__x10_target_platform=tE.platform});var Cre=T(Ii=>{"use strict";p();var mO,D6,gO,_re,L6,bre,nE;Object.defineProperty(Ii,"__esModule",{value:!0});Ii.createPartialWorkbook=Ii.blankStyle=Ii.genFmt=Ii.knownFormatData=Ii.kfToIformat=Ii.englishLocaleData=Ii.defaultConfig=Ii.mathpack=Ii.locale=Ii.createRange=Ii.assertMessageOrder=void 0;var Yh=fe(),ar=Ss(),Xh=Ba(),Uke=uv(),xNr=No(),INr=Zc(),wNr=AG(),DNr=R4(),jke=Gi(),vO=ti(),Kke=UM(),Wke=TF(),LNr=Ar(),Vke=aU(),Hke=r_(),qNr=jI(),GNr=Hf(),oa;(function(e){e.EditedPhase="EditedPhase",e.DependentPhase="DependentPhase",e.StatisticsPhase="StatisticsPhase",e.Finished="Finished"})(oa||(oa={}));var BNr={kind:oa.EditedPhase,stateId:-(1/0)};function UNr(e,r){switch(r.kind){case ar.OutputMessageKind.GarbageCollected:return expect(r.minStateIdKept).toBeLessThanOrEqual(e),e;case ar.OutputMessageKind.Alert:return e;case ar.OutputMessageKind.ExperimentRunResult:return r.experimentKind===qNr.ExperimentKind.OneShot&&expect(e).toEqual(1),e;default:return expect(e).toBeLessThanOrEqual(r.stateId),r.stateId}}var KNr=Object.getOwnPropertyNames(ar.OutputMessageKind);function l1(e,r){var t={};return e.forEach(function(n){return t[n]=r}),t}var VNr=(mO={},mO[oa.EditedPhase]=Yh.__assign(Yh.__assign(Yh.__assign((D6={},D6[ar.OutputMessageKind.StateAdvanced]=function(){return oa.EditedPhase},D6[ar.OutputMessageKind.RecalcStatistics]=function(e,r){if(r.message===ar.RecalcStatisticsMessage.ChangedCell){if(r.cellKind===ar.ComputedCellKind.EditedCell)return oa.EditedPhase;if(r.cellKind===ar.ComputedCellKind.DependentCell)return oa.DependentPhase;if(r.cellKind===ar.ComputedCellKind.IndependentCell)return oa.EditedPhase;if(r.cellKind===ar.ComputedCellKind.UnknownNonEditedCell)return e("a different message.cellKind than ".concat(r.cellKind));(0,Xh.assertNever)("calc.calc.partialWorkbook.testutilsutils.transitions",r.cellKind)}if(r.message===ar.RecalcStatisticsMessage.UnchangedCell){if(r.cellKind===ar.ComputedCellKind.EditedCell)return oa.EditedPhase;if(r.cellKind===ar.ComputedCellKind.DependentCell)return oa.DependentPhase;if(r.cellKind===ar.ComputedCellKind.IndependentCell)return oa.EditedPhase;if(r.cellKind===ar.ComputedCellKind.UnknownNonEditedCell)return e("a different message.cellKind than ".concat(r.cellKind));(0,Xh.assertNever)("calc.calc.partialWorkbook.testutils.transitions",r.cellKind)}if(r.message===ar.RecalcStatisticsMessage.ContinueComputation)return oa.EditedPhase;if(r.message===ar.RecalcStatisticsMessage.EditFinished||r.message===ar.RecalcStatisticsMessage.StateTimedOut)return oa.StatisticsPhase;if(r.message===ar.RecalcStatisticsMessage.RecalcFinished)return oa.Finished;(0,Xh.assertNever)("calc.calc.partialWorkbook.testutils.transitions",r.message)},D6),l1([ar.OutputMessageKind.CellWrite,ar.OutputMessageKind.RangeWrite],function(e,r){if(r.cellKind===ar.ComputedCellKind.EditedCell)return oa.EditedPhase;if(r.cellKind===ar.ComputedCellKind.DependentCell)return oa.DependentPhase;(0,Xh.assertNever)("calc.calc.partialWorkbook.testutils.transitions",r.cellKind)})),(gO={},gO[ar.OutputMessageKind.RangeFailure]=function(e,r){if(r.cellKind===ar.ComputedCellKind.EditedCell)return oa.EditedPhase;if(r.cellKind===ar.ComputedCellKind.DependentCell)return oa.DependentPhase;if(r.cellKind===ar.ComputedCellKind.IndependentCell)return oa.EditedPhase;if(r.cellKind===ar.ComputedCellKind.UnknownNonEditedCell)return oa.DependentPhase;(0,Xh.assertNever)("calc.calc.partialWorkbook.testutils.transitions",r.cellKind)},gO[ar.OutputMessageKind.PrintFormulaFailure]=function(){return oa.EditedPhase},gO[ar.OutputMessageKind.InferFormatFailure]=function(){return oa.EditedPhase},gO[ar.OutputMessageKind.FormatValueFailure]=function(){return oa.EditedPhase},gO)),l1([ar.OutputMessageKind.GarbageCollected,ar.OutputMessageKind.Alert,ar.OutputMessageKind.ExperimentRunResult,ar.OutputMessageKind.UpdateRequest,ar.OutputMessageKind.WorkbookStatistics,ar.OutputMessageKind.UnhandledFailure,ar.OutputMessageKind.NumberFormatFailure,ar.OutputMessageKind.NameFailure,ar.OutputMessageKind.UpdateNamesRequest],function(){return oa.EditedPhase})),mO[oa.DependentPhase]=Yh.__assign(Yh.__assign(Yh.__assign(Yh.__assign((_re={},_re[ar.OutputMessageKind.RecalcStatistics]=function(e,r){if(r.message===ar.RecalcStatisticsMessage.ChangedCell){if(r.cellKind===ar.ComputedCellKind.EditedCell)return e("a different cellKind than ".concat(r.cellKind));if(r.cellKind===ar.ComputedCellKind.DependentCell||r.cellKind===ar.ComputedCellKind.IndependentCell)return oa.DependentPhase;if(r.cellKind===ar.ComputedCellKind.UnknownNonEditedCell)return e("a different cellKind than ".concat(r.cellKind));(0,Xh.assertNever)("calc.calc.partialWorkbook.testutils.transitions",r.cellKind)}if(r.message===ar.RecalcStatisticsMessage.UnchangedCell){if(r.cellKind===ar.ComputedCellKind.EditedCell)return e("a different cellKind than ".concat(r.cellKind));if(r.cellKind===ar.ComputedCellKind.DependentCell||r.cellKind===ar.ComputedCellKind.IndependentCell)return oa.DependentPhase;if(r.cellKind===ar.ComputedCellKind.UnknownNonEditedCell)return e("a different cellKind than ".concat(r.cellKind));(0,Xh.assertNever)("calc.calc.partialWorkbook.testutils.transitions",r.cellKind)}if(r.message===ar.RecalcStatisticsMessage.ContinueComputation)return e("a different message.message than ".concat(r.message));if(r.message===ar.RecalcStatisticsMessage.EditFinished)return oa.StatisticsPhase;if(r.message===ar.RecalcStatisticsMessage.StateTimedOut||r.message===ar.RecalcStatisticsMessage.RecalcFinished)return e("a different message.message than ".concat(r.message));(0,Xh.assertNever)("calc.calc.partialWorkbook.testutils.transitions",r.message)},_re),l1([ar.OutputMessageKind.CellWrite,ar.OutputMessageKind.RangeWrite],function(e,r){if(r.cellKind===ar.ComputedCellKind.EditedCell)return e("a different message.cellKind than ".concat(r.cellKind));if(r.cellKind===ar.ComputedCellKind.DependentCell)return oa.DependentPhase;(0,Xh.assertNever)("calc.calc.partialWorkbook.testutils.transitions",r.cellKind)})),(L6={},L6[ar.OutputMessageKind.RangeFailure]=function(e,r){if(r.cellKind===ar.ComputedCellKind.EditedCell)return r.reason.kind===Uke.ReasonKind.CellCycle?oa.DependentPhase:e("the current state to be ".concat(oa.EditedPhase,", or ").concat(oa.DependentPhase," and failure ").concat(Uke.ReasonKind.CellCycle));if(r.cellKind===ar.ComputedCellKind.IndependentCell||r.cellKind===ar.ComputedCellKind.DependentCell||r.cellKind===ar.ComputedCellKind.UnknownNonEditedCell)return oa.DependentPhase;(0,Xh.assertNever)("calc.calc.partialWorkbook.testutils.transitions",r.cellKind)},L6[ar.OutputMessageKind.FormatValueFailure]=function(){return oa.DependentPhase},L6)),l1([ar.OutputMessageKind.GarbageCollected,ar.OutputMessageKind.Alert,ar.OutputMessageKind.ExperimentRunResult],function(e,r){return e("a different message.kind than ".concat(r.kind))})),l1([ar.OutputMessageKind.StateAdvanced,ar.OutputMessageKind.UpdateRequest,ar.OutputMessageKind.WorkbookStatistics,ar.OutputMessageKind.UnhandledFailure,ar.OutputMessageKind.NumberFormatFailure,ar.OutputMessageKind.NameFailure,ar.OutputMessageKind.PrintFormulaFailure,ar.OutputMessageKind.InferFormatFailure,ar.OutputMessageKind.UpdateNamesRequest],function(e,r){return e("a different message.kind than ".concat(r.kind))})),mO[oa.StatisticsPhase]=Yh.__assign(Yh.__assign((bre={},bre[ar.OutputMessageKind.RecalcStatistics]=function(e,r){if(r.message===ar.RecalcStatisticsMessage.ChangedCell||r.message===ar.RecalcStatisticsMessage.UnchangedCell||r.message===ar.RecalcStatisticsMessage.ContinueComputation||r.message===ar.RecalcStatisticsMessage.EditFinished||r.message===ar.RecalcStatisticsMessage.StateTimedOut)return e("a different message.message than ".concat(r.message));if(r.message===ar.RecalcStatisticsMessage.RecalcFinished)return oa.Finished;(0,Xh.assertNever)("calc.calc.partialWorkbook.testutils.transitions",r.message)},bre),l1([ar.OutputMessageKind.GarbageCollected,ar.OutputMessageKind.Alert,ar.OutputMessageKind.ExperimentRunResult],function(e,r){return e("a different message.kind than ".concat(r.kind))})),l1([ar.OutputMessageKind.CellWrite,ar.OutputMessageKind.RangeWrite,ar.OutputMessageKind.RangeFailure,ar.OutputMessageKind.PrintFormulaFailure,ar.OutputMessageKind.InferFormatFailure,ar.OutputMessageKind.FormatValueFailure,ar.OutputMessageKind.StateAdvanced,ar.OutputMessageKind.UpdateRequest,ar.OutputMessageKind.WorkbookStatistics,ar.OutputMessageKind.NumberFormatFailure,ar.OutputMessageKind.UnhandledFailure,ar.OutputMessageKind.NameFailure,ar.OutputMessageKind.UpdateNamesRequest],function(e,r){return e("a different message.kind than ".concat(r.kind))})),mO[oa.Finished]=l1(KNr,function(e){return e("no message once recalc finished")}),mO);function jNr(e,r,t){function n(c){return expect({state:e,message:r,index:t}).toEqual(c)}var a=e.stateId,o=e.kind,u=UNr(a,r),s=VNr[o][r.kind],l=s(n,r,o);return{kind:l,stateId:u}}function WNr(e){e.reduce(jNr,BNr)}Ii.assertMessageOrder=WNr;function HNr(e,r){return[(0,xNr.sheetGridRange)(e,r),(0,ar.sheetCellSet)(e,(0,INr.createCellSetFromRange)(r))]}Ii.createRange=HNr;Ii.locale=(0,jke.getEnglishLocaleInfo)();Ii.mathpack=wNr.xlMathpack;Ii.defaultConfig={localeInfo:Ii.locale,mathpack:Ii.mathpack,refStyle:vO.RefStyle.A1,date1904:!1,dateCompatibility:!0,timezone:Kke.tzUTC,datepack:Kke.xlDatepack};Ii.englishLocaleData=(0,Hke.localeData)([{functionId:0,functionName:"COUNT"}],[{errorType:1,errorName:"#NULL!"}],"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";",[3,0],",",1033,1,2,!1," ",!1,"Paren",!0,!1,"$",2,"MDY","/","-",!0,!1,!1,!0,":",null,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["AM/PM","A/P","\u4E0A\u5348/\u4E0B\u5348",null,"General","$"],[null,";","#","0",".","%",",",":","/","/"," ","-","+","(",")",null,"\\","*","y","m","d","h","m","s","E","/",'"',"[","]","@","?","_","r","a","g","e",null,null,null,null,null,null,"B","N","\u0E27","\u0E14","\u0E1B","b","\u0E04","\u0E0A","\u0E19","\u0E17","\u0E50",null],["Black","White","Red","Green","Blue","Yellow","Magenta","Cyan","Color"],["DBNum1","DBNum2","DBNum3","DBNum4"],(0,GNr.partialArray)((nE={},nE[vO.SpecialRefId.All]="#All",nE[vO.SpecialRefId.Data]="#Data",nE[vO.SpecialRefId.Headers]="#Headers",nE[vO.SpecialRefId.Totals]="#Totals",nE[vO.SpecialRefId.ThisRow]="#This Row",nE)),"dddd, mmmm dd, yyyy","h:mm:ss AM/PM");var zNr=function(r){return Math.abs(r)};Ii.kfToIformat=zNr;Ii.knownFormatData=(0,LNr.numEnumArray)(Wke.KnownFormat).filter(function(e){return(0,Vke.isKnownFormatDefined)(e,(0,jke.getEnglishLocaleInfo)())}).map(function(e){return(0,Hke.numberFormat)((0,Ii.kfToIformat)(e),(0,Vke.getKnownFormat)(Ii.locale,e),!0)});Ii.genFmt=(0,Ii.kfToIformat)(Wke.KnownFormat.General);Ii.blankStyle=ar.SpecialStyle.Blank;function QNr(e,r,t){var n,a,o,u=new DNr.PartialWorkbook(Yh.__assign(Yh.__assign({},Ii.defaultConfig),{localeInfo:(n=t==null?void 0:t.localeOverride)!==null&&n!==void 0?n:Ii.locale}),r);return u.setWorksheetFuncOverrides((a=t==null?void 0:t.worksheetFuncOverrides)!==null&&a!==void 0?a:{}),(!((o=t==null?void 0:t.setNumberFormats)!==null&&o!==void 0)||o)&&u.setNumberFormats(e,Ii.knownFormatData,!1,-(1/0)),u}Ii.createPartialWorkbook=QNr});var zke=T(q6=>{"use strict";p();Object.defineProperty(q6,"__esModule",{value:!0});q6.isFailureOutputMessage=void 0;var aE=Ss(),XNr=[aE.OutputMessageKind.RangeFailure,aE.OutputMessageKind.NameFailure,aE.OutputMessageKind.NumberFormatFailure,aE.OutputMessageKind.PrintFormulaFailure,aE.OutputMessageKind.InferFormatFailure,aE.OutputMessageKind.FormatValueFailure,aE.OutputMessageKind.UnhandledFailure];function YNr(e){return XNr.includes(e.kind)}q6.isFailureOutputMessage=YNr});var B6=T(rr=>{"use strict";p();Object.defineProperty(rr,"__esModule",{value:!0});rr.objectChecker=rr.chPossiblyInfiniteNumber=rr.chFiniteNumber=rr.check=rr.chBoolean=rr.arrayChecker=rr.incrementFailure=rr.registerExperimentFactory=rr.ExperimentKind=rr.UnitExperiment=rr.blankStyleValue=rr.forEachProduct=rr.project=rr.compareProduct=rr.intersectProduct=rr.exceptProduct=rr.meetsProduct=rr.unionProduct=rr.union=rr.dense=rr.empty=rr.namedTable=rr.namedFormula=rr.makeGridRangeTable=rr.forEachRangeInSet=rr.forEachCellInSet=rr.bspFactory=rr.createCellSetFromRange=rr.PartialWorkbook=rr.blankStyle=rr.knownFormatData=rr.genFmt=rr.locale=rr.createRange=rr.mathpack=rr.englishLocaleData=rr.blankCellFormat=rr.CloningTarget=rr.UnavailableKind=rr.OutputMessageKind=rr.isFailureOutputMessage=rr.SpecialFormat=rr.SpecialStyle=rr.ComputeKind=rr.ComputedCellKind=rr.createSheetCellSetFromRange=rr.sheetCellSet=rr.voidCallback=rr.VolatileMode=rr.PartialWorkbookDocumentCollection=void 0;rr.optChecker=rr.oneOfChecker=void 0;var Dd=fe(),JNr=Dd.__importStar(hc()),ZNr=Dd.__importStar(zke()),c1=Dd.__importStar(Ss()),Qke=Dd.__importStar(b$()),$Nr=Dd.__importStar(R4()),Xke=Dd.__importStar(n_()),iE=Dd.__importStar(Cre()),G6=Dd.__importStar(Zc()),Tre=Dd.__importStar(Mh()),oE=Dd.__importStar(Pf()),eOr=Dd.__importStar(v$()),rOr=Dd.__importStar(_R()),Yke=Dd.__importStar(MI()),Jke=Dd.__importStar(jI()),d1=Dd.__importStar(RR()),tOr=Dd.__importStar(Y$()),nOr=Dd.__importStar(wR());rr.PartialWorkbookDocumentCollection=Qke.PartialWorkbookDocumentCollection;rr.VolatileMode=JNr.VolatileMode;rr.voidCallback=Qke.voidCallback;rr.sheetCellSet=c1.sheetCellSet;rr.createSheetCellSetFromRange=c1.createSheetCellSetFromRange;rr.ComputedCellKind=c1.ComputedCellKind;rr.ComputeKind=c1.ComputeKind;rr.SpecialStyle=c1.SpecialStyle;rr.SpecialFormat=c1.SpecialFormat;rr.isFailureOutputMessage=ZNr.isFailureOutputMessage;rr.OutputMessageKind=c1.OutputMessageKind;rr.UnavailableKind=c1.UnavailableKind;rr.CloningTarget=Xke.CloningTarget;rr.blankCellFormat=Xke.blankCellFormat;rr.englishLocaleData=iE.englishLocaleData;rr.mathpack=iE.mathpack;rr.createRange=iE.createRange;rr.locale=iE.locale;rr.genFmt=iE.genFmt;rr.knownFormatData=iE.knownFormatData;rr.blankStyle=iE.blankStyle;rr.PartialWorkbook=$Nr.PartialWorkbook;rr.createCellSetFromRange=G6.createCellSetFromRange;rr.bspFactory=G6.bspFactory;rr.forEachCellInSet=G6.forEachCellInSet;rr.forEachRangeInSet=G6.forEachRangeInSet;rr.makeGridRangeTable=rOr.makeGridRangeTable;rr.namedFormula=Yke.namedFormula;rr.namedTable=Yke.namedTable;rr.empty=Tre.empty;rr.dense=Tre.dense;rr.union=Tre.union;rr.unionProduct=oE.unionProduct;rr.meetsProduct=oE.meetsProduct;rr.exceptProduct=oE.exceptProduct;rr.intersectProduct=oE.intersectProduct;rr.compareProduct=oE.compareProduct;rr.project=oE.project;rr.forEachProduct=oE.forEachProduct;rr.blankStyleValue=eOr.blankStyleValue;rr.UnitExperiment=tOr.UnitExperiment;rr.ExperimentKind=Jke.ExperimentKind;rr.registerExperimentFactory=Jke.registerExperimentFactory;rr.incrementFailure=nOr.incrementFailure;rr.arrayChecker=d1.arrayChecker;rr.chBoolean=d1.chBoolean;rr.check=d1.check;rr.chFiniteNumber=d1.chFiniteNumber;rr.chPossiblyInfiniteNumber=d1.chPossiblyInfiniteNumber;rr.objectChecker=d1.objectChecker;rr.oneOfChecker=d1.oneOfChecker;rr.optChecker=d1.optChecker});var Zke=T(f1=>{"use strict";p();Object.defineProperty(f1,"__esModule",{value:!0});f1.defaultSetTimeoutInterface=f1.clearTimerUnified=f1.setImmediateUnified=void 0;var Rre=pr();f1.setImmediateUnified=Rre.setTimeoutInterfaceModule.setImmediateUnified;f1.clearTimerUnified=Rre.setTimeoutInterfaceModule.clearTimerUnified;f1.defaultSetTimeoutInterface=Rre.setTimeoutInterfaceModule.defaultSetTimeoutInterface});var Ere=T(K6=>{"use strict";p();Object.defineProperty(K6,"__esModule",{value:!0});K6.makeCalcGrid=void 0;var aOr=Zke(),iOr=V4(),$ke=dee(),U6=function(){};function oOr(e){return e===void 0&&(e=aOr.defaultSetTimeoutInterface),new iOr.RecalcServiceImpl(U6,U6,U6,U6,(0,$ke.asyncLoopFactory)((0,$ke.delayPromiseImpl)(e)))}K6.makeCalcGrid=oOr});var uE=T(rs=>{"use strict";p();Object.defineProperty(rs,"__esModule",{value:!0});rs.findFieldRefSourceLhs=rs.caretInSpanScope=rs.sheetIndexToSheetName=rs.getAbsolutePosition=rs.getNamePartIfExists=rs.createNameToDefinedNameInfoMapping=rs.getRangeFromCellRef=rs.getSheetNameFromQualifier=rs.getSheetIndexFromQualifier=rs.getSheetIndexFromSheetName=rs.isValidCellRef=void 0;var Pre=ti(),eMe=ti(),hO=ti(),uOr=ti(),A2=Ar(),sOr=mi(),lOr=ia(),cOr=qi(),rMe=function(){function e(){}return e.MaxRow=1048575,e.MaxColumn=16383,e}();function dOr(e){return(0,sOr.isChangeGateEnabled)("OfficeVSO:7898117_addValidityCheckBeforeConstructingRange")?e.kind!==hO.CellRefKind.Bad&&e.kind!==hO.CellRefKind.Error:!0}rs.isValidCellRef=dOr;function tMe(e,r){var t=r.nameToIndex.getValue(e);if((0,A2.isDefined)(t))return r.sheets[t].sheetIndex}rs.getSheetIndexFromSheetName=tMe;function fOr(e,r,t){var n=nMe(e,t);return tMe(n,r)}rs.getSheetIndexFromQualifier=fOr;function nMe(e,r){return e.kind===eMe.QualifierKind.Sheet?e.sheet:e.kind===eMe.QualifierKind.Ident?e.name:((0,A2.isDefined)(r)&&r("getSheetNameFromQualifier unexpected qualifier kind: ".concat(e.kind)),"")}rs.getSheetNameFromQualifier=nMe;function pOr(e,r,t){switch(e.kind){case hO.CellRefKind.Single:{var n=Jh(e.row,r.row),a=Jh(e.col,r.col);return{firstRow:n,firstColumn:a,lastRow:n,lastColumn:a}}case hO.CellRefKind.Range:return{firstRow:Jh(e.ref1.row,r.row),firstColumn:Jh(e.ref1.col,r.col),lastRow:Jh(e.ref2.row,r.row),lastColumn:Jh(e.ref2.col,r.col)};case hO.CellRefKind.Col:return{firstRow:0,firstColumn:Jh(e.col1,r.col),lastRow:rMe.MaxRow,lastColumn:Jh(e.col2,r.col)};case hO.CellRefKind.Row:return{firstRow:Jh(e.row1,r.row),firstColumn:0,lastRow:Jh(e.row2,r.row),lastColumn:rMe.MaxColumn};default:(0,A2.isDefined)(t)&&t("getRangeFromCellRef unexpected CellRefKind: ".concat(e.kind))}}rs.getRangeFromCellRef=pOr;function mOr(e){var r=new Map;return e.forEach(function(t){(0,A2.isDefined)(t.name)&&r.set(t.name.toLocaleLowerCase(),t)}),r}rs.createNameToDefinedNameInfoMapping=mOr;function gOr(e,r){var t=r.get(e.asWhole.toLocaleLowerCase());if(t!==void 0&&t.type!==lOr.DefinedNameInfoType.Invalid)return t}rs.getNamePartIfExists=gOr;function Jh(e,r){return e.index+(e.kind===uOr.PosKind.Rel?r:0)}rs.getAbsolutePosition=Jh;function vOr(e,r){var t=r.sheets.findIndex(function(n){return(0,cOr.isSheetIndexEqual)(n.sheetIndex,e)});if(t!==-1)return r.sheets[t].sheetName}rs.sheetIndexToSheetName=vOr;function hOr(e,r){return(0,A2.isDefined)(r)&&e.valueOf()>=r.start&&e.valueOf()<r.end}rs.caretInSpanScope=hOr;function aMe(e){switch(e.kind){case Pre.NamePartKind.CellRefNamePart:case Pre.NamePartKind.IdentNamePart:return e;case Pre.NamePartKind.FieldRefNamePart:return aMe(e.lhs)}}rs.findFieldRefSourceLhs=aMe});var j6=T(p1=>{"use strict";p();Object.defineProperty(p1,"__esModule",{value:!0});p1.getPositionKindInfoFromCellRef=p1.spanCompare=p1.gridRangeToRange=void 0;var V6=ti(),SO=ia(),GS={Abs:SO.PositionKind.Absolute,Rel:SO.PositionKind.Relative};function SOr(e){var r=e.row,t=e.col;return{firstRow:r,firstColumn:t,lastRow:r+e.rows-1,lastColumn:t+e.cols-1}}p1.gridRangeToRange=SOr;function yOr(e,r){var t;return(t=e.start-r.start)!==0||(t=r.end-e.end)!==0?t:0}p1.spanCompare=yOr;function _Or(e){switch(e.kind){case V6.CellRefKind.Col:return ROr(e);case V6.CellRefKind.Row:return TOr(e);case V6.CellRefKind.Single:return COr(e);case V6.CellRefKind.Range:return bOr(e)}}p1.getPositionKindInfoFromCellRef=_Or;function bOr(e){return{firstRow:GS[e.ref1.row.kind],firstColumn:GS[e.ref1.col.kind],secondRow:GS[e.ref2.row.kind],secondColumn:GS[e.ref2.col.kind]}}function COr(e){var r,t;return{firstRow:r=GS[e.row.kind],firstColumn:t=GS[e.col.kind],secondRow:r,secondColumn:t}}function TOr(e){return{firstRow:GS[e.row1.kind],firstColumn:SO.PositionKind.Relative,secondRow:GS[e.row2.kind],secondColumn:SO.PositionKind.Relative}}function ROr(e){return{firstRow:SO.PositionKind.Relative,firstColumn:GS[e.col1.kind],secondRow:SO.PositionKind.Relative,secondColumn:GS[e.col2.kind]}}});var _O=T(ts=>{"use strict";p();Object.defineProperty(ts,"__esModule",{value:!0});ts.uniteIntersectingRangeObjects=ts.uniteIntersectingGridRanges=ts.gridRangesIntersects=ts.rangesIntersects=ts.getSheetGridCellFromRangeObject=ts.rangeToGridRange=ts.toSharedSheetRange=ts.getSheetRangeFromResolvedRef=ts.sheetRangeFromCellRef=ts.getSheetRangeFromDefinedNameInfo=ts.getRangeFromDefinedName=void 0;var yO=fe(),$s=Ar(),W6=uE(),EOr=zn(),iMe=ia(),POr=j6(),Are=No();function oMe(e){var r=e.namedRange;if(!(r==null||e.type===iMe.DefinedNameInfoType.Invalid)){var t=e.type===iMe.DefinedNameInfoType.Table?1:0;if(r.bottom&&r.top&&r.right&&r.left)return{firstRow:r.top+t-1,firstColumn:r.left-1,lastRow:r.bottom-1,lastColumn:r.right-1}}}ts.getRangeFromDefinedName=oMe;function AOr(e,r){var t=oMe(e);if((0,$s.isDefined)(t)){var n=(0,$s.isDefined)(e.sheetName)?e.sheetName:r?(0,W6.getSheetNameFromQualifier)(r):"";return yO.__assign(yO.__assign({},t),{sheetName:n,namedObjectName:(0,$s.isDefined)(e.name)?e.name:""})}}ts.getSheetRangeFromDefinedNameInfo=AOr;function FOr(e,r,t,n){var a=(0,W6.getRangeFromCellRef)(e,t,n);if((0,$s.isDefined)(a))return yO.__assign(yO.__assign({},a),{sheetName:r?(0,W6.getSheetNameFromQualifier)(r):"",namedObjectName:""})}ts.sheetRangeFromCellRef=FOr;function NOr(e,r,t){var n;if(!(0,EOr.isSuccess)(r.resolution)){t==null||t("failed to resolve StructRef, reason: ".concat(r.resolution.reason));return}if(r.resolution.value===void 0){t==null||t("failed to resolve StructRef, resolution value undefined");return}var a=r.resolution.value,o=(n=(0,W6.sheetIndexToSheetName)(a.sheet,e))!==null&&n!==void 0?n:"";return yO.__assign(yO.__assign({},(0,POr.gridRangeToRange)(a.range)),{sheetName:o,namedObjectName:r.node.lhs?r.node.lhs.whole:""})}ts.getSheetRangeFromResolvedRef=NOr;function OOr(e){return{FirstColumn:e.firstColumn,FirstRow:e.firstRow,LastColumn:e.lastColumn,LastRow:e.lastRow,NamedObjectName:e.namedObjectName,SheetName:e.sheetName}}ts.toSharedSheetRange=OOr;function kOr(e){var r=e.firstRow,t=e.firstColumn;return(0,Are.gridRange)(r,t,e.lastRow-r+1,e.lastColumn-t+1)}ts.rangeToGridRange=kOr;function MOr(e,r){return(0,Are.sheetGridCell)(r,{row:e.firstRow,col:e.firstColumn,rows:1,cols:1})}ts.getSheetGridCellFromRangeObject=MOr;function uMe(e,r){return(0,$s.fastMin)(e.lastColumn,r.lastColumn)>=(0,$s.fastMax)(e.firstColumn,r.firstColumn)&&(0,$s.fastMin)(e.lastRow,r.lastRow)>=(0,$s.fastMax)(e.firstRow,r.firstRow)}ts.rangesIntersects=uMe;function sMe(e,r){return(0,$s.fastMin)(e.col+e.cols-1,r.col+r.cols-1)>=(0,$s.fastMax)(e.col,r.col)&&(0,$s.fastMin)(e.row+e.rows-1,r.row+r.rows-1)>=(0,$s.fastMax)(e.row,r.row)}ts.gridRangesIntersects=sMe;function xOr(e,r){return sMe(e,r)?(0,Are.gridRange)((0,$s.fastMin)(e.row,r.row),(0,$s.fastMin)(e.col,r.col),(0,$s.fastMax)(e.row+e.rows,r.row+r.rows)-(0,$s.fastMin)(e.row,r.row),(0,$s.fastMax)(e.col+e.cols,r.col+r.cols)-(0,$s.fastMin)(e.col,r.col)):null}ts.uniteIntersectingGridRanges=xOr;function IOr(e,r){return uMe(e,r)?{firstRow:(0,$s.fastMin)(e.firstRow,r.firstRow),firstColumn:(0,$s.fastMin)(e.firstColumn,r.firstColumn),lastRow:(0,$s.fastMax)(e.lastRow,r.lastRow),lastColumn:(0,$s.fastMax)(e.lastColumn,r.lastColumn)}:null}ts.uniteIntersectingRangeObjects=IOr});var pMe=T(z6=>{"use strict";p();Object.defineProperty(z6,"__esModule",{value:!0});z6.CacheGrid=void 0;var lMe=fe(),cMe=IR(),wOr=Cre(),DOr=t2(),BS=B6(),H6=vG(),LOr=Ere(),dMe=pM(),qOr=_O(),GOr=Pf(),R_=hG(),fMe=Mh(),Fre=Zc(),BOr=qr(),UOr=function(){function e(){var r=this;this.calcGrid=(0,LOr.makeCalcGrid)(),this.recalcSideGrid=new DOr.RecalcSideGrid(this.calcGrid),this.schedulerFeatures=[],this.setSchedulerFeatures=function(t){r.schedulerFeatures=t},this.setA1ReferenceStyle=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];(t=r.calcGrid).setA1ReferenceStyle.apply(t,n),r.consumePartialWorkbookMessages()},this.setLocale=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];(t=r.calcGrid).setLocale.apply(t,n),r.consumePartialWorkbookMessages()},this.setWorkbookProps=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];(t=r.calcGrid).setWorkbookProps.apply(t,n),r.consumePartialWorkbookMessages()},this.updateSheetNames=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];(t=r.calcGrid).updateSheetNames.apply(t,n),r.consumePartialWorkbookMessages()},this.updateNamedObjects=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];(t=r.calcGrid).updateNamedObjects.apply(t,n),r.consumePartialWorkbookMessages()},this.setNumberFormats=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];(t=r.calcGrid).setNumberFormats.apply(t,n),r.consumePartialWorkbookMessages()},this.getStateAsNotifications=function(){return[]},this.getDocumentLoc=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.readonlyDataModel).getDocumentLoc.apply(t,n)},this.getSheetIndex=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.readonlyDataModel).getSheetIndex.apply(t,n)},this.getSheetName=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.readonlyDataModel).getSheetName.apply(t,n)},this.getNameLoc=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.readonlyDataModel).getNameLoc.apply(t,n)},this.getUserDefinedFuncLoc=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.readonlyDataModel).getUserDefinedFuncLoc.apply(t,n)},this.getSheetRangeIndexes=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.readonlyDataModel).getSheetRangeIndexes.apply(t,n)},this.getContainingTable=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.readonlyDataModel).getContainingTable.apply(t,n)},this.getStructRefSpecialRef=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.readonlyDataModel).getStructRefSpecialRef.apply(t,n)},this.getStructRefColumn=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.readonlyDataModel).getStructRefColumn.apply(t,n)},this.getRangeValues=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.recalcSideGrid).getRangeValues.apply(t,n)},this.getRangeFormulae=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.recalcSideGrid).getRangeFormulae.apply(t,n)},this.getRangeFormats=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.recalcSideGrid).getRangeFormats.apply(t,n)},this.getSheetNames=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.recalcSideGrid).getSheetNames.apply(t,n)},this.getIntersectingTables=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.recalcSideGrid).getIntersectingTables.apply(t,n)},this.getIformats=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.recalcSideGrid).getIformats.apply(t,n)},this.getHiddenRows=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.recalcSideGrid).getHiddenRows.apply(t,n)},this.getHiddenCols=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.recalcSideGrid).getHiddenCols.apply(t,n)},this.discardSnapshot=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return lMe.__awaiter(r,void 0,void 0,function(){var a;return lMe.__generator(this,function(o){return[2,(a=this.recalcSideGrid).discardSnapshot.apply(a,t)]})})},this.evalClonedModelOnSnapshot=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.recalcSideGrid).evalClonedModelOnSnapshot.apply(t,n)},this.evalFormulaOnSnapshot=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.recalcSideGrid).evalFormulaOnSnapshot.apply(t,n)},this.getCorrespondingSnapshotID=function(){for(var t,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return(t=r.recalcSideGrid).getCorrespondingSnapshotID.apply(t,n)},this.calcGrid.dataModel.setNumberFormats(this.calcGrid.document,wOr.knownFormatData,!1,-(1/0))}return Object.defineProperty(e.prototype,"readonlyDataModel",{get:function(){return this.calcGrid.dataModel.getDocs()},enumerable:!1,configurable:!0}),e.prototype.writeRange=function(r,t){var n=this.sheetRangeToSheetGridRange(t.range);if(n!==void 0){var a=this.populateHiddenCells(t,n,r),o=a.hiddenRowSet,u=a.hiddenColSet,s=(0,BS.sheetCellSet)(n.sheet,(0,GOr.createFromProduct)({row:o,col:u}));this.calcGrid.dataModel.writeCellContents(r,s,"",!1,(0,H6.gridCell)(n.range.row,n.range.col),R_.blankOper,void 0,void 0);for(var l=KOr(n,o,u),c=l.visibleRows,d=l.visibleCols,f=0;f<t.values.length;f++)for(var m=t.values[f],v=c[f],h=0;h<m.length;h++){var y=m[h],_=d[h],E=(0,H6.gridCell)(v,_);this.calcGrid.dataModel.writeCellContents(r,(0,BS.sheetCellSet)(n.sheet,(0,Fre.createCellSetFromRange)(E)),t.formulae[f][h].formulaText,t.formulae[f][h].isFormula,E,VOr(y),t.iformats[f][h],void 0)}}},Object.defineProperty(e.prototype,"sheets",{get:function(){var t;return(t=this.readonlyDataModel.getSingleReadonlyDocument())===null||t===void 0?void 0:t.getReadonlySheets()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nameManager",{get:function(){var t;return(t=this.readonlyDataModel.getSingleReadonlyDocument())===null||t===void 0?void 0:t.getReadonlyNameManager()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this.readonlyDataModel.config},enumerable:!1,configurable:!0}),e.prototype.consumePartialWorkbookMessages=function(){for(;;){var r=this.calcGrid.dataModel.step();if(r.queueEmpty)break}},e.prototype.populateHiddenCells=function(r,t,n){var a=r.hiddenRows.reduce(function(l,c){var d=c.startInclusive,f=c.endExclusive;return(0,BS.union)(l,BS.bspFactory.row([d,f]))},BS.empty),o=r.hiddenCols.reduce(function(l,c){var d=c.startInclusive,f=c.endExclusive;return(0,BS.union)(l,BS.bspFactory.col([d,f]))},BS.empty),u=(0,cMe.sheetGridRangeToHiddenRows)(t,a),s=(0,cMe.sheetGridRangeToHiddenCols)(t,o);return this.calcGrid.dataModel.writeHiddenRows(n,u),this.calcGrid.dataModel.writeHiddenCols(n,s),{hiddenRowSet:a,hiddenColSet:o}},e.prototype.sheetRangeToSheetGridRange=function(r){var t=this.calcGrid.dataModel.getDocs().getSheetIndex(this.calcGrid.document,r.sheetName);if(!(t.kind===dMe.ResultKind.Failure||!(0,dMe.isDefined)(t.value)))return(0,H6.sheetGridRange)((0,H6.sheetIndex)(this.calcGrid.document,t.value),(0,qOr.rangeToGridRange)(r))},e}();z6.CacheGrid=UOr;function KOr(e,r,t){var n=e.range,a=n.row,o=n.col,u=n.rows,s=n.cols,l=(0,fMe.except)(BS.bspFactory.row([a,a+u]),r),c=(0,fMe.except)(BS.bspFactory.col([o,o+s]),t),d=[];(0,Fre.forEachRow)(l,function(m){for(var v=m[0],h=m[1],y=v;y<h;y++)d.push(y);return!0});var f=[];return(0,Fre.forEachCol)(c,function(m){for(var v=m[0],h=m[1],y=v;y<h;y++)f.push(y);return!0}),{visibleRows:d,visibleCols:f}}function VOr(e){var r;switch(e.kind){case"number":return BOr.mathpackXL.xlMathpack.fromNumber(e.value);case"string":return(0,R_.stringOper)(e.stringValue);case"bool":return(0,R_.booleanOper)(e.boolValue);case"error":return(0,R_.errorOper)((r=e.errorKind)!==null&&r!==void 0?r:R_.ErrorType.UNKNOWN);case"rich":return{kind:R_.OperKind.Rich,getFallback:function(){return(0,R_.errorOper)(R_.ErrorType.FIELD)},getField:function(){}};case"blank":return R_.blankOper}}});var sE=T(Df=>{"use strict";p();var Nre;Object.defineProperty(Df,"__esModule",{value:!0});Df.getSchedulerFactories=Df.dynamicPluginLoaderInsideInit=Df.createDynamicPluginLoader=Df.PluginSchedulerSingleton=Df.GridImportManagerSingleton=void 0;var bO=fe(),jOr=Ms(),Q6=Ar(),gMe=kee(),F2=N6(),WOr=cke(),US=Bke(),HOr=w6(),zOr=pMe(),QOr=(0,Q6.singleton)(function(){var e=N2().createGridProvider(function(){return Df.PluginSchedulerSingleton.instance().registerAsyncGrid()});return Df.GridImportManagerSingleton.instance().onGridImporterCreated(e,"Main-IGrid"),e});Df.GridImportManagerSingleton=(0,Q6.singleton)(function(){return N2().createGridImportManager()});Df.PluginSchedulerSingleton=(0,Q6.singleton)(function(){return N2().createFormulaBarScheduler(QOr.instance())});(0,Q6.staticAssertExtends)();function XOr(e){return N2().createDynamicPluginLoader(Df.GridImportManagerSingleton.instance(),Df.PluginSchedulerSingleton.instance(),e)}Df.createDynamicPluginLoader=XOr;var YOr="excelOnlineCalc.x10.stableDynamicPluginLoaderInsideInit",vMe=function(r,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return new(F2.FormulaBarScheduler.bind.apply(F2.FormulaBarScheduler,bO.__spreadArray([void 0,(0,US.timelineQueueProcessorFactory)(n[0]),(0,US.createPrefetchingCacheFactory)(r),t,r.getGridDataSink(),r.getSyncDataModel()],n,!1)))},JOr=function(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new(US.DynamicPluginLoader.bind.apply(US.DynamicPluginLoader,bO.__spreadArray([void 0,r],t,!1)))};Df.dynamicPluginLoaderInsideInit=(0,US.dynamicPluginLoaderInsideInit)(US.timelineQueueProcessorFactory,US.createPrefetchingCacheFactory);var ZOr=function(r){return new gMe.GridImportManager(r)},$Or=function(r){return new gMe.GridProvider(r)},ekr=function(r,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var o,u=function(c){return o=new WOr.ExperimentQueueProcessor(c),o},s=new(F2.FormulaBarScheduler.bind.apply(F2.FormulaBarScheduler,bO.__spreadArray([void 0,u,(0,US.createPrefetchingCacheFactory)(r),t,r.getGridDataSink(),r.getSyncDataModel()],n,!1)));if(o===void 0)throw"not initialized";return[s,o]},mMe=function(e){bO.__extends(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"ComputationFinalizerHandlers",{get:function(){return this.computationFinalizerHandlers},set:function(n){this.computationFinalizerHandlers=n},enumerable:!1,configurable:!0}),r}(F2.FormulaBarScheduler),rkr=function(r,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return new(mMe.bind.apply(mMe,bO.__spreadArray([void 0,(0,US.timelineQueueProcessorFactory)(n[0]),(0,US.createPrefetchingCacheFactory)(r),t,r.getGridDataSink(),r.getSyncDataModel()],n,!1)))},tkr={createFormulaBarScheduler:vMe,createDynamicPluginLoader:function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return JOr.apply(void 0,bO.__spreadArray([YOr],r,!1))},createGridImportManager:ZOr,createGridProvider:$Or,createExperimentFormulaBarScheduler:ekr,createTestableFormulaBarScheduler:rkr},nkr={createFormulaBarScheduler:vMe,createExperimentFormulaBarScheduler:function(){throw new Error("Cannot use Experiment Formula Bar Scheduler in win32 context")},createTestableFormulaBarScheduler:function(){throw new Error("Cannot use Testable Formula Bar Scheduler in win32 context")},createDynamicPluginLoader:function(){throw new Error("Cannot use Dynamic Plugin Loader in win32 context")},createGridImportManager:function(){return{onGridExporterCreated:function(){},onGridImporterCreated:function(){}}},createGridProvider:function(){var r=new zOr.CacheGrid;return{getGrid:function(){return r},getGridDataSink:function(){return r},getSyncDataModel:function(){return r},createIGridImportEndpoint:function(){throw new Error("Cannot use createIGridImportEndpoint in win32 context")},onGridExporterClosed:function(){throw new Error("Cannot use onGridExporterClosed in win32 context")}}}},akr={Win32:nkr,Web:tkr};function N2(){return akr[HOr.platform]}Df.getSchedulerFactories=N2;if((0,jOr.getTypedFeatureGate)("TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL")&&(self.__retries=((Nre=self.__retries)!==null&&Nre!==void 0?Nre:-1)+1,self.__retries===0))throw""});var TMe=T(Y6=>{"use strict";p();Object.defineProperty(Y6,"__esModule",{value:!0});Y6.createRecalcService=void 0;var k2=fe(),Ore=k2.__importStar(sy()),E_=nl(),X6=Ba(),ikr=V4(),hMe=Hf(),okr=jR(),SMe=Ar(),yMe=sE(),O2=Kh(),_Me=GM(),ukr=mee(),bMe=3e4,CMe=3,skr=1e3;function lkr(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];var n=r[0],a=r[1];return k2.__awaiter(this,void 0,void 0,function(){function o(I){I===void 0&&(I="Requested"),h=I,m.close()}var u,s,l,c,d,f,m,v,h,y,_,E,N,k,q,V=this;return k2.__generator(this,function(I){switch(I.label){case 0:return u=typeof n=="boolean"?n?[new yMe.PluginSchedulerSingleton().instance(),new yMe.GridImportManagerSingleton().instance()]:[void 0,void 0]:[n,a],s=u[0],l=u[1],c=-(1/0),d=!1,f={onRecalcResults:function(B){},onUpdateRequest:function(B){},onGC:function(B){c=B},onAlert:function(B){if(!d){var U=document.createElement("div"),j=document.createElement("p");j.textContent=B,U.appendChild(j);var X=document.createElement("button");X.textContent="OK",U.appendChild(X),U.setAttribute("style","position: fixed; top: 0; left: 30%; right: 30%; background: red; color: white; font-size: 16px; font-weight: bold; z-index: 1000; padding: 3em; white-space: pre-line;"),X.onclick=function(){document.body.removeChild(U)},document.body.appendChild(U),d=!0}}},[4,Ore.createWorker({id:"RecalcService",createMode:e},{local:ikr.recalcServiceInsideInit,thread:{scriptUrl:(0,_Me.getCalcAbsUrlOrThrow)(),insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},function(){return f})];case 1:m=I.sent(),v=[],h="Requested",m.onClose=function(){for(var M=0,B=v;M<B.length;M++){var U=B[M];try{U()}catch(X){X6.ulsLogger.ULS.traceTag(539341771,E_.LogCategory.msoulscat_ES_EWAJS,E_.TraceLevel.Warning,"calc.calc.createRecalcService.service.onClose: callback threw ".concat((0,hMe.messageFromError)(X)))}}var j="calc.calc.createRecalcService.service.onClose: recalc service closed; reason = ".concat(h);X6.ulsLogger.ULS.traceTag(561534148,E_.LogCategory.msoulscat_ES_EWAJS,h==="Requested"?E_.TraceLevel.Info:E_.TraceLevel.Warning,j)},I.label=2;case 2:return I.trys.push([2,5,,6]),m.createMode!=="Thread"?[3,4]:[4,(0,_Me.initCalcThread)(m)];case 3:y=I.sent(),v.push(function(){return y.close()}),(0,ukr.logMissingJSFeatures)(m.call.getMissingJSFeatures),I.label=4;case 4:return m.call.ping.callTimeout=bMe,_=CMe,E=0,N=function(){},(0,okr.promiseLoop)(function(){return k2.__awaiter(V,void 0,void 0,function(){var M,B,U,j,X,ee,re;return k2.__generator(this,function(Z){switch(Z.label){case 0:return[4,new Promise(function(J){return setTimeout(J,skr)})];case 1:if(Z.sent(),m.hasBeenClosed())return[2,void 0];M=m.call.ping.callTimeout,B=(0,SMe.now)(),Z.label=2;case 2:return Z.trys.push([2,4,,5]),[4,m.call.ping()];case 3:return Z.sent(),[3,5];case 4:if(U=Z.sent(),!Ore.WorkerError.isWorkerError(U)||U.info.cause!=="Timeout")throw U;return j=(0,SMe.now)()-B,E+=1,E>=_&&o("Unresponsive"),X=m.hasBeenClosed(),ee={timeout:M,waitTime:j,timeoutCount:E,hasBeenClosed:X},re="calc.calc.RecalcService: unresponsive; ".concat(JSON.stringify(ee)),X6.ulsLogger.ULS.traceTag(561534149,E_.LogCategory.msoulscat_ES_EWAJS,E_.TraceLevel.Warning,re),N(M,j,E,X),[2,!0];case 5:return E=0,[2,!0]}})})},!0).catch(function(M){var B="calc.calc.RecalcService: ping loop threw an error: ".concat((0,hMe.messageFromError)(M));X6.ulsLogger.ULS.traceTag(561534150,E_.LogCategory.msoulscat_ES_EWAJS,E_.TraceLevel.Warning,B)}),m.post.updateRanges.onPostMessageError=Ore.dispatchWorkerError,k={setOnRecalcResults:function(B){f.onRecalcResults=B},setOnUpdateRequest:function(B){f.onUpdateRequest=B},setOnUnresponsive:function(B){N=B},setA1ReferenceStyle:function(){for(var B,U=[],j=0;j<arguments.length;j++)U[j]=arguments[j];(B=m.post).setA1ReferenceStyle.apply(B,U),s!==void 0&&s.doNotify(O2.NotificationKind.setA1ReferenceStyle,U)},setLocale:function(){for(var B,U=[],j=0;j<arguments.length;j++)U[j]=arguments[j];(B=m.post).setLocale.apply(B,U),s!==void 0&&s.doNotify(O2.NotificationKind.setLocale,U)},setWorkbookProps:function(){for(var B,U=[],j=0;j<arguments.length;j++)U[j]=arguments[j];(B=m.post).setWorkbookProps.apply(B,U),s!==void 0&&s.doNotify(O2.NotificationKind.setWorkbookProps,U)},updateSheetNames:function(){for(var B,U=[],j=0;j<arguments.length;j++)U[j]=arguments[j];(B=m.post).updateSheetNames.apply(B,U),s!==void 0&&s.doNotify(O2.NotificationKind.updateSheetNames,U)},updateNamedObjects:function(){for(var B,U=[],j=0;j<arguments.length;j++)U[j]=arguments[j];(B=m.post).updateNamedObjects.apply(B,U),s!==void 0&&s.doNotify(O2.NotificationKind.updateNamedObjects,U)},setNumberFormats:m.post.setNumberFormats,updateUnusedCells:m.post.updateUnusedCells,updateRanges:m.post.updateRanges,updateArrays:m.post.updateArrays,editRangeFormulas:m.post.editRangeFormulas,editRangeFormats:m.post.editRangeFormats,editArrayFormulas:m.post.editArrayFormulas,editRangePaste:m.post.editRangePaste,resumeRecalc:m.post.resumeRecalc,reconfigure:function(B){var U,j;m.call.ping.callTimeout=(U=B.responsivenessPingTimeout)!==null&&U!==void 0?U:bMe,_=(j=B.responsivenessPingAttempts)!==null&&j!==void 0?j:CMe,m.post.reconfigure(B)},clearCache:function(){m.post.clearCache(),c=-(1/0)},testAdvanceState:m.post.testAdvanceState,testResumeRecalc:m.call.testResumeRecalc,close:o,stateIdAvailable:function(B){return B>=c},evalFormula:m.call.evalFormula,evalOnClonedModel:m.call.evalOnClonedModel,localizeEnglishFormula:function(){for(var B,U=[],j=0;j<arguments.length;j++)U[j]=arguments[j];return(B=m.call).localizeEnglishFormula.apply(B,U)},createIGridExportEndpoint:function(B,U){return v.push(U),m.call.createIGridExportEndpoint.transfer([B.port],B)}},l!==void 0&&l.onGridExporterCreated(k),[2,k];case 5:throw q=I.sent(),o("Error"),q;case 6:return[2]}})})}Y6.createRecalcService=lkr});var Mre=T(Se=>{"use strict";p();Object.defineProperty(Se,"__esModule",{value:!0});Se.copyPasteRangePasteEdit=Se.rangePasteEdit=Se.arrayFormulaEdit=Se.rangeFormatEdit=Se.formatEditChangeDecimals=Se.formatEditRibbonFormat=Se.formatEditSetFormat=Se.formatEditOperation=Se.RibbonFormat=Se.inferredRangeFormulaEdit=Se.valueRangeFormulaEdit=Se.cellFormulaRangeFormulaEdit=Se.rangeFormulaEdit=Se.columnData=Se.namedTableData=Se.namedObjectsPromote=Se.undefinedNamesWrite=Se.namedObjectsWrite=Se.namedObjectsUpdate=Se.namedObject=Se.namedFailureData=Se.namedRangeData=Se.namedFormulaData=Se.namedValueData=Se.unusedCellsUpdate=Se.arrayPromote=Se.arrayWrite=Se.arrayUpdate=Se.arrayData=Se.rangePromote=Se.rangeWrite=Se.rangeUpdate=Se.valueCellData=Se.arrayFormulaCellData=Se.cellFormulaCellData=Se.cellData=Se.sheetCellLocation=Se.sheetRangeLocation=Se.rangeLocation=Se.cellLocation=Se.getCellFormatKind=Se.getCellValueKind=Se.richValue=Se.errorValue=Se.blankValue=Se.sheetName=Se.numberFormat=Se.localeData=Se.errorTypeName=Se.worksheetFunctionName=void 0;Se.internal=Se.RecalcServiceDataTransformer=Se.getTime=Se.recalcServiceInsideInit=Se.readOperToCellValue=Se.cellValueToReadOper=Se.localeInfoFromData=Se.RecalcServiceCreateMode=Se.createRecalcService=Se.workbookProps=Se.recalcServiceConfig=Se.runExperiment=Se.updateRequest=Se.evalFormulaFormatAggregate=Se.evalFormulaFormatInferred=Se.evalFormulaFormatKnown=Se.evalFormulaFormatIformat=Se.evalFormulaFormatOrigin=Se.evalFormulaFormat=Se.evalFormulaData=Se.recalcResults=Se.rangeFailure=Se.arrayDelta=Se.rangeDelta=Se.cellDataDelta=Se.inferredFormat=void 0;var lE=fe(),Yr=lE.__importStar(r_()),ckr=lE.__importStar(TMe()),kre=lE.__importStar(IR()),dkr=lE.__importStar(V4()),fkr=lE.__importStar(hc()),pkr=lE.__importStar(B6()),mkr=lE.__importStar(wR());Se.worksheetFunctionName=Yr.worksheetFunctionName;Se.errorTypeName=Yr.errorTypeName;Se.localeData=Yr.localeData;Se.numberFormat=Yr.numberFormat;Se.sheetName=Yr.sheetName;Se.blankValue=Yr.blankValue;Se.errorValue=Yr.errorValue;Se.richValue=Yr.richValue;Se.getCellValueKind=Yr.getCellValueKind;Se.getCellFormatKind=Yr.getCellFormatKind;Se.cellLocation=Yr.cellLocation;Se.rangeLocation=Yr.rangeLocation;Se.sheetRangeLocation=Yr.sheetRangeLocation;Se.sheetCellLocation=Yr.sheetCellLocation;Se.cellData=Yr.cellData;Se.cellFormulaCellData=Yr.cellFormulaCellData;Se.arrayFormulaCellData=Yr.arrayFormulaCellData;Se.valueCellData=Yr.valueCellData;Se.rangeUpdate=Yr.rangeUpdate;Se.rangeWrite=Yr.rangeWrite;Se.rangePromote=Yr.rangePromote;Se.arrayData=Yr.arrayData;Se.arrayUpdate=Yr.arrayUpdate;Se.arrayWrite=Yr.arrayWrite;Se.arrayPromote=Yr.arrayPromote;Se.unusedCellsUpdate=Yr.unusedCellsUpdate;Se.namedValueData=Yr.namedValueData;Se.namedFormulaData=Yr.namedFormulaData;Se.namedRangeData=Yr.namedRangeData;Se.namedFailureData=Yr.namedFailureData;Se.namedObject=Yr.namedObject;Se.namedObjectsUpdate=Yr.namedObjectsUpdate;Se.namedObjectsWrite=Yr.namedObjectsWrite;Se.undefinedNamesWrite=Yr.undefinedNamesWrite;Se.namedObjectsPromote=Yr.namedObjectsPromote;Se.namedTableData=Yr.namedTableData;Se.columnData=Yr.columnData;Se.rangeFormulaEdit=Yr.rangeFormulaEdit;Se.cellFormulaRangeFormulaEdit=Yr.cellFormulaRangeFormulaEdit;Se.valueRangeFormulaEdit=Yr.valueRangeFormulaEdit;Se.inferredRangeFormulaEdit=Yr.inferredRangeFormulaEdit;Se.RibbonFormat=Yr.RibbonFormat;Se.formatEditOperation=Yr.formatEditOperation;Se.formatEditSetFormat=Yr.formatEditSetFormat;Se.formatEditRibbonFormat=Yr.formatEditRibbonFormat;Se.formatEditChangeDecimals=Yr.formatEditChangeDecimals;Se.rangeFormatEdit=Yr.rangeFormatEdit;Se.arrayFormulaEdit=Yr.arrayFormulaEdit;Se.rangePasteEdit=Yr.rangePasteEdit;Se.copyPasteRangePasteEdit=Yr.copyPasteRangePasteEdit;Se.inferredFormat=Yr.inferredFormat;Se.cellDataDelta=Yr.cellDataDelta;Se.rangeDelta=Yr.rangeDelta;Se.arrayDelta=Yr.arrayDelta;Se.rangeFailure=Yr.rangeFailure;Se.recalcResults=Yr.recalcResults;Se.evalFormulaData=Yr.evalFormulaData;Se.evalFormulaFormat=Yr.evalFormulaFormat;Se.evalFormulaFormatOrigin=Yr.evalFormulaFormatOrigin;Se.evalFormulaFormatIformat=Yr.evalFormulaFormatIformat;Se.evalFormulaFormatKnown=Yr.evalFormulaFormatKnown;Se.evalFormulaFormatInferred=Yr.evalFormulaFormatInferred;Se.evalFormulaFormatAggregate=Yr.evalFormulaFormatAggregate;Se.updateRequest=Yr.updateRequest;Se.runExperiment=Yr.runExperiment;Se.recalcServiceConfig=Yr.recalcServiceConfig;Se.workbookProps=Yr.workbookProps;Se.createRecalcService=ckr.createRecalcService;Se.RecalcServiceCreateMode=Yr.RecalcServiceCreateMode;Se.localeInfoFromData=kre.localeInfoFromData;Se.cellValueToReadOper=kre.cellValueToReadOper;Se.readOperToCellValue=kre.readOperToCellValue;Se.recalcServiceInsideInit=dkr.recalcServiceInsideInit;Se.getTime=fkr.getTimeImpl;Se.RecalcServiceDataTransformer=mkr.RecalcServiceDataTransformer;Se.internal=pkr});var RMe=T(CO=>{"use strict";p();Object.defineProperty(CO,"__esModule",{value:!0});CO.nextFuncs=CO.getWorksheetFunc=void 0;var gkr=fe(),vkr=gkr.__importStar(p$()),hkr=ov();CO.getWorksheetFunc=vkr.getWorksheetFunc;CO.nextFuncs=hkr.nextFuncs.nextFuncs});var EMe=T(Lf=>{"use strict";p();Object.defineProperty(Lf,"__esModule",{value:!0});Lf.VerticalAlignment=Lf.HorizontalAlignment=Lf.BorderLineType=Lf.PatternType=Lf.FillKind=Lf.FontVerticalAlignment=Lf.FontUnderline=void 0;var Skr=fe(),cE=Skr.__importStar(g$());Lf.FontUnderline=cE.FontUnderline;Lf.FontVerticalAlignment=cE.FontVerticalAlignment;Lf.FillKind=cE.FillKind;Lf.PatternType=cE.PatternType;Lf.BorderLineType=cE.BorderLineType;Lf.HorizontalAlignment=cE.HorizontalAlignment;Lf.VerticalAlignment=cE.VerticalAlignment});var PMe=T(TO=>{"use strict";p();Object.defineProperty(TO,"__esModule",{value:!0});TO.runSmokeTest=TO.cancelSmokeTest=void 0;function ykr(){}TO.cancelSmokeTest=ykr;function _kr(){return Promise.resolve()}TO.runSmokeTest=_kr});var FMe=T(RO=>{"use strict";p();Object.defineProperty(RO,"__esModule",{value:!0});RO.cancelSmokeTest=RO.runSmokeTest=void 0;var bkr=fe(),AMe=bkr.__importStar(PMe());RO.runSmokeTest=AMe.runSmokeTest;RO.cancelSmokeTest=AMe.cancelSmokeTest});var xre=T(EO=>{"use strict";p();Object.defineProperty(EO,"__esModule",{value:!0});EO.wrapIntoAsyncClass=EO.wrapIntoAsync=void 0;var NMe=pr();EO.wrapIntoAsync=NMe.wrapIntoAsyncModule.wrapIntoAsync;EO.wrapIntoAsyncClass=NMe.wrapIntoAsyncModule.wrapIntoAsyncClass});var Ire=T(Zp=>{"use strict";p();Object.defineProperty(Zp,"__esModule",{value:!0});Zp.setMockGridSheetAndNotify=Zp.createMockGridExporter=Zp.createMockGridProvider=Zp.createConstGridProvider=Zp.createMockAsyncGrid=Zp.MockAsyncGrid=void 0;var g1=fe(),Ckr=Ere(),J6=g1.__importStar(No()),Tkr=xre(),m1=r_(),Rkr=QR(),Ekr=Gi(),Pkr=g1.__importStar(sy()),Akr=Ba(),Fkr=Kh(),Nkr=t2(),Okr=B6(),kkr=uU(),Mkr=Nee();function xkr(e){if(typeof e=="object")switch(e.kind){case"Blank":return"";case"Error":return(0,Ekr.getEnglishLocaleInfo)().errorNames[e.type];case"Rich":return"rich value formulaBarText"}return e.toString()}var OMe=function(e){g1.__extends(r,e);function r(){var t=this,n=(0,Ckr.makeCalcGrid)();n.dataModel.setNumberFormats(n.document,Okr.knownFormatData,!1,-(1/0));var a=new Nkr.RecalcSideGrid(n);return t=e.call(this,a)||this,t.sheetNames=[],t.calcGrid=n,t.document=n.document,t}return Object.defineProperty(r.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.getDocs().config},enumerable:!1,configurable:!0}),r.prototype.reconfigure=function(t){return this.calcGrid.reconfigure(t)},r.prototype.setRange=function(t,n,a,o,u){for(var s,l,c,d,f=J6.documentLoc(void 0,""),m=J6.sheetIndex(f,t),v=[],h=0;h<a.length;h+=1){var y=a[h];if(y!==void 0)for(var _=0;_<y.length;_+=1){var E=y[_];if(E!==void 0){var N=(0,m1.sheetRangeLocation)(m.index,n.firstRow+h,n.firstColumn+_),k=(l=(s=u==null?void 0:u[h])===null||s===void 0?void 0:s[_])!==null&&l!==void 0?l:xkr(E),q=(d=(c=o==null?void 0:o[h])===null||c===void 0?void 0:c[_])!==null&&d!==void 0?d:kkr.KnownFormat.General;k.startsWith("=")?v.push((0,m1.rangeWrite)(N,(0,m1.cellFormulaCellData)(k,E,q))):v.push((0,m1.rangeWrite)(N,(0,m1.valueCellData)(k,E,q)))}}}this.calcGrid.updateRanges(0,g1.__spreadArray([(0,m1.rangeWrite)((0,m1.sheetRangeLocation)(m.index,n.firstRow,n.firstColumn,n.lastRow,n.lastColumn))],v,!0)),this.runTasks()},r.prototype.setSheet=function(t,n,a,o){var u=J6.documentLoc(void 0,""),s=J6.sheetIndex(u,t);(0,Akr.assertTrue)("Sheet having sheetId ".concat(t," is already in the mock workbook"),!this.sheetNames.some(function(l){var c=l.sheetId;return c===t})),this.sheetNames.push((0,m1.sheetName)(s.index,n)),this.calcGrid.updateSheetNames(0,this.sheetNames),this.setRange(t,{firstRow:0,firstColumn:0,lastRow:0,lastColumn:0},a,o)},r.prototype.setNamedObjects=function(t){this.calcGrid.updateNamedObjects(0,t),this.runTasks()},r.prototype.runTasks=function(){for(;;){var t=this.calcGrid.dataModel.step();if(t.queueEmpty)break}},r}((0,Tkr.wrapIntoAsyncClass)()(["getRangeFormats","getRangeFormulae","getRangeValues","getSheetNames","getIformats","discardSnapshot","getHiddenRows","getHiddenCols","evalClonedModelOnSnapshot","evalFormulaOnSnapshot","getCorrespondingSnapshotID","getIntersectingTables"]));Zp.MockAsyncGrid=OMe;function Ikr(){var e=new OMe,r=g1.__assign(g1.__assign({},(0,Rkr.wrapIntoResumeRecalc)(e,function(){return e.calcGrid.resumeRecalc()})),{setSheet:e.setSheet.bind(e),setRange:e.setRange.bind(e),setNamedObjects:e.setNamedObjects.bind(e),document:e.document,reconfigure:e.reconfigure.bind(e),calcConfig:e.calcConfig});return r}Zp.createMockAsyncGrid=Ikr;function kMe(e,r,t){return{getGrid:function(){return e},getGridDataSink:function(){return r},getSyncDataModel:function(){return t}}}Zp.createConstGridProvider=kMe;var wkr=function(r){return kMe(r,void 0,new Mkr.SyncDataModel)};Zp.createMockGridProvider=wkr;function Dkr(e){return{createIGridExportEndpoint:function(t){return g1.__awaiter(this,void 0,void 0,function(){return g1.__generator(this,function(n){switch(n.label){case 0:return[4,Pkr.Endpoint.createInside(t,function(){return e})];case 1:return n.sent(),[2]}})})}}}Zp.createMockGridExporter=Dkr;function Lkr(e,r,t,n,a,o){o===void 0&&(o=0),t.setSheet(e,r,n);var u={sheetId:e,sheetName:r};a.doNotify(Fkr.NotificationKind.updateSheetNames,[o,[u]])}Zp.setMockGridSheetAndNotify=Lkr});var wre=T(PO=>{"use strict";p();Object.defineProperty(PO,"__esModule",{value:!0});PO.MockTimerImmediate=PO.MockTimer=void 0;var MMe=v_();PO.MockTimer=MMe.mockTimer.MockTimer;PO.MockTimerImmediate=MMe.mockTimer.MockTimerImmediate});var xMe=T(Z6=>{"use strict";p();Object.defineProperty(Z6,"__esModule",{value:!0});Z6.functionExamples=void 0;var L=Qf(),qkr=hc();Z6.functionExamples=new qkr.ResettableLazy(function(){var e;return e={},e[L.WorksheetFuncId.ABS]="=ABS(2)",e[L.WorksheetFuncId.CUBEMEMBERPROPERTY]='=CUBEMEMBERPROPERTY("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'","[').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time),"].[").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fiscal),'].[2014]",$A$3)'),e[L.WorksheetFuncId.CUBERANKEDMEMBER]='=CUBERANKEDMEMBER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'",$D$4,1,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TopMonth),'")'),e[L.WorksheetFuncId.BINOM_DIST_RANGE]="=BINOM.DIST.RANGE(60,0.75,48)",e[L.WorksheetFuncId.NETWORKDAYS_INTL]="=NETWORKDAYS.INTL(DATE(2006,1,1),DATE(2006,1,31))",e[L.WorksheetFuncId.AVERAGE_WEIGHTED]="=AVERAGE.WEIGHTED(A1:A10, B1:B10, 5, 0.5)",e[L.WorksheetFuncId.GAMMALN_PRECISE]="=GAMMALN.PRECISE(4)",e[L.WorksheetFuncId.CONFIDENCE_NORM]="=CONFIDENCE.NORM(0.05,2.5,50)",e[L.WorksheetFuncId.CEILING_PRECISE]="=CEILING.PRECISE(4.3)",e[L.WorksheetFuncId.FORECAST_LINEAR]="=FORECAST.LINEAR(30,A2:A6,B2:B6)",e[L.WorksheetFuncId.PERCENTRANK_EXC]="=PERCENTRANK.EXC(A2:A11,2)",e[L.WorksheetFuncId.PERCENTRANK_INC]="=PERCENTRANK.INC(A2:A11,2)",e[L.WorksheetFuncId.PERCENTILE_EXC]="=PERCENTILE.EXC(B2:B10,0.25)",e[L.WorksheetFuncId.PERCENTILE_INC]="=PERCENTILE.INC(A2:A5,0.3)",e[L.WorksheetFuncId.CUBEKPIMEMBER]='=CUBEKPIMEMBER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MySalesKPI),'",1)'),e[L.WorksheetFuncId.CHISQ_DIST_RT]="=CHISQ.DIST.RT(18.307,10)",e[L.WorksheetFuncId.FLOOR_PRECISE]="=FLOOR.PRECISE(-3.2,-1)",e[L.WorksheetFuncId.NEGBINOM_DIST]="=NEGBINOM.DIST(10,5,0.25,TRUE)",e[L.WorksheetFuncId.GETPIVOTDATA]='=GETPIVOTDATA("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'", $A$3, "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.South),'")'),e[L.WorksheetFuncId.CUBESETCOUNT]="=CUBESETCOUNT(A3)",e[L.WorksheetFuncId.ERFC_PRECISE]="=ERFC.PRECISE(1)",e[L.WorksheetFuncId.CHISQ_INV_RT]="=CHISQ.INV.RT(0.3, 2)",e[L.WorksheetFuncId.CONFIDENCE_T]="=CONFIDENCE.T(0.05,1,50)",e[L.WorksheetFuncId.CEILING_MATH]="=CEILING.MATH(24.3,5)",e[L.WorksheetFuncId.HYPGEOM_DIST]="=HYPGEOM.DIST(1,4,8,20,TRUE)",e[L.WorksheetFuncId.LOGNORM_DIST]="=LOGNORM.DIST(4,3.5,1.2,TRUE)",e[L.WorksheetFuncId.NEGBINOMDIST]="=NEGBINOMDIST(10,5,0.25)",e[L.WorksheetFuncId.PERMUTATIONA]="=PERMUTATIONA(3,2)",e[L.WorksheetFuncId.POISSON_DIST]="=POISSON.DIST(1, 2, TRUE)",e[L.WorksheetFuncId.WEIBULL_DIST]="=WEIBULL.DIST(105,20,100,TRUE)",e[L.WorksheetFuncId.COVARIANCE_P]="=COVARIANCE.P(A2:A6, B2:B6)",e[L.WorksheetFuncId.COVARIANCE_S]="=COVARIANCE.S(A3:A5,B3:B5)",e[L.WorksheetFuncId.QUARTILE_EXC]="=QUARTILE.EXC(A2:A12,1)",e[L.WorksheetFuncId.QUARTILE_INC]="=QUARTILE.INC(A2:A9,1)",e[L.WorksheetFuncId.ECMA_CEILING]="=ECMA.CEILING(1.5, 0.1)",e[L.WorksheetFuncId.WORKDAY_INTL]="=WORKDAY.INTL(DATE(2012,1,1),30,0)",e[L.WorksheetFuncId.STOCKHISTORY]="=STOCKHISTORY(MSFT,1-1-2020)",e[L.WorksheetFuncId.ERF_PRECISE]="=ERF.PRECISE(0.745)",e[L.WorksheetFuncId.NUMBERVALUE]="=NUMBERVALUE(0.035)",e[L.WorksheetFuncId.HYPGEOMDIST]="=HYPGEOMDIST(1,4,8,20)",e[L.WorksheetFuncId.LOGNORMDIST]="=LOGNORMDIST(4,3.5,1.2)",e[L.WorksheetFuncId.LOGNORM_INV]="=LOGNORM.INV(0.039084, 3.5, 1.2)",e[L.WorksheetFuncId.NORM_S_DIST]="=NORM.S.DIST(1.33, TRUE)",e[L.WorksheetFuncId.STANDARDIZE]="=STANDARDIZE(42,40,1.5)",e[L.WorksheetFuncId.FORMULATEXT]="=FORMULATEXT(A2)",e[L.WorksheetFuncId.PERCENTRANK]="=PERCENTRANK(A2:A11,2)",e[L.WorksheetFuncId.CONCATENATE]='=CONCATENATE("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas),'", " ", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser),'")'),e[L.WorksheetFuncId.ISO_CEILING]="=ISO.CEILING(4.3)",e[L.WorksheetFuncId.VALUETOTEXT]='=VALUETOTEXT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SomeText),'")'),e[L.WorksheetFuncId.ARRAYTOTEXT]="=ARRAYTOTEXT(B1:B3)",e[L.WorksheetFuncId.AVERAGEIFS]='=AVERAGEIFS(B2:B5, B2:B5, ">70", B2:B5, "<90")',e[L.WorksheetFuncId.COUNTBLANK]="=COUNTBLANK(A2:B5)",e[L.WorksheetFuncId.ERROR_TYPE]="=ERROR.TYPE(#NULL!)",e[L.WorksheetFuncId.CUBEMEMBER]='=CUBEMEMBER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'",(B4, C6, D5),"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesFor2004),'")'),e[L.WorksheetFuncId.ISOWEEKNUM]="=ISOWEEKNUM(40977)",e[L.WorksheetFuncId.SUBSTITUTE]='=SUBSTITUTE("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesData),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cost),'")'),e[L.WorksheetFuncId.SUMPRODUCT]="=SUMPRODUCT(C2:C5,D2:D5)",e[L.WorksheetFuncId.WEBSERVICE]="=WEBSERVICE(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WebServiceLink),")"),e[L.WorksheetFuncId.BINOM_DIST]="=BINOM.DIST(6,10,0.5,FALSE)",e[L.WorksheetFuncId.CHISQ_DIST]="=CHISQ.DIST(0.5,1,TRUE)",e[L.WorksheetFuncId.CONFIDENCE]="=CONFIDENCE(0.05,2.5,50)",e[L.WorksheetFuncId.EXPON_DIST]="=EXPON.DIST(0.2,10,TRUE)",e[L.WorksheetFuncId.FLOOR_MATH]="=FLOOR.MATH(24.3,5)",e[L.WorksheetFuncId.GAMMA_DIST]="=GAMMA.DIST(4.79, 1.234, 7, TRUE)",e[L.WorksheetFuncId.NORM_S_INV]="=NORM.S.INV(0.908789)",e[L.WorksheetFuncId.CHISQ_TEST]="=CHISQ.TEST(A2:B4,A6:B8)",e[L.WorksheetFuncId.PERCENTILE]="=PERCENTILE(E2:E5,0.3)",e[L.WorksheetFuncId.FIELDVALUE]='=FIELDVALUE(A2, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price),'")'),e[L.WorksheetFuncId.AVERAGEIF]='=AVERAGEIF(B2:B5,"<23000")',e[L.WorksheetFuncId.BITLSHIFT]="=BITLSHIFT(4,2)",e[L.WorksheetFuncId.BITRSHIFT]="=BITRSHIFT(13,2)",e[L.WorksheetFuncId.DATEVALUE]='=DATEVALUE("1/1/2008")',e[L.WorksheetFuncId.FILTERXML]='=FILTERXML(B3,"//rc/@title")',e[L.WorksheetFuncId.CUBEVALUE]='=CUBEVALUE(Sales,"['.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures),"].[").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit),']","[').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Time),'].[2004]","[').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProduct),"].[").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Beverages),']")'),e[L.WorksheetFuncId.ENCODEURL]='=ENCODEURL("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EncodeURLExmapleLink),'")'),e[L.WorksheetFuncId.HYPERLINK]='=HYPERLINK("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HyperlinkExampleLink),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ClickForReport),'")'),e[L.WorksheetFuncId.ISLOGICAL]="=ISLOGICAL(TRUE)",e[L.WorksheetFuncId.ISNONTEXT]="=ISNONTEXT(A2)",e[L.WorksheetFuncId.ISFORMULA]="=ISFORMULA(A2)",e[L.WorksheetFuncId.PDURATION]="=PDURATION(2.5%,2000,2200)",e[L.WorksheetFuncId.TIMEVALUE]="=TIMEVALUE(0.1)",e[L.WorksheetFuncId.TRANSPOSE]="=TRANSPOSE(A2:F9)",e[L.WorksheetFuncId.FREQUENCY]="=FREQUENCY(A2:A20, B2:B5)",e[L.WorksheetFuncId.BETA_DIST]="=BETA.DIST(2,8,10,TRUE,1,3)",e[L.WorksheetFuncId.BINOMDIST]="=BINOMDIST(6,10,0.5,FALSE)",e[L.WorksheetFuncId.BINOM_INV]="=BINOM.INV(6,0.5,0.75)",e[L.WorksheetFuncId.CHISQ_INV]="=CHISQ.INV(0.3, 2)",e[L.WorksheetFuncId.CRITBINOM]="=CRITBINOM(6,0.5,0.75)",e[L.WorksheetFuncId.EXPONDIST]="=EXPONDIST(0.2,10,TRUE)",e[L.WorksheetFuncId.F_DIST_RT]="=F.DIST.RT(15.2069,6,4)",e[L.WorksheetFuncId.FISHERINV]="=FISHERINV(0.972955)",e[L.WorksheetFuncId.GAMMADIST]="=GAMMADIST(10.00001131,9,2,FALSE)",e[L.WorksheetFuncId.GAMMA_INV]="=GAMMA.INV(0.068094,9,2)",e[L.WorksheetFuncId.NORM_DIST]="=NORM.DIST(1, 0, 1, TRUE)",e[L.WorksheetFuncId.T_DIST_2T]="=T.DIST.2T(1.959999998,60)",e[L.WorksheetFuncId.T_DIST_RT]="=T.DIST.RT(1.959999998,60)",e[L.WorksheetFuncId.INTERCEPT]="=INTERCEPT(A2:A6, B2:B6)",e[L.WorksheetFuncId.MODE_MULT]="=MODE.MULT(A2:A13)",e[L.WorksheetFuncId.MODE_SNGL]="=MODE.SNGL(A2:A7)",e[L.WorksheetFuncId.AGGREGATE]="=AGGREGATE(12, 6, A1:A11, B1:B11)",e[L.WorksheetFuncId.RANDARRAY]="=RANDARRAY(5,3,1,100)",e[L.WorksheetFuncId.COUNTIFS]='=COUNTIFS(A2:A7,"<6",A2:A7,">1")',e[L.WorksheetFuncId.DAVERAGE]='=DAVERAGE(A4:E10, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:B2)'),e[L.WorksheetFuncId.BAHTTEXT]="=BAHTTEXT(1234)",e[L.WorksheetFuncId.DPRODUCT]='=DPRODUCT(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:F3)'),e[L.WorksheetFuncId.INDIRECT]="=INDIRECT(B&A)",e[L.WorksheetFuncId.ISNUMBER]="=ISNUMBER(A2)",e[L.WorksheetFuncId.MINVERSE]="=MINVERSE(A1:D4)",e[L.WorksheetFuncId.RANK_AVG]="=RANK.AVG(94,B2:B8)",e[L.WorksheetFuncId.SUBTOTAL]="=SUBTOTAL(9,A2:A5)",e[L.WorksheetFuncId.BETADIST]="=BETADIST(2,8,10,1,3)",e[L.WorksheetFuncId.BETA_INV]="=BETA.INV(0.685470581,8,10,1,3)",e[L.WorksheetFuncId.F_INV_RT]="=F.INV.RT(0.01,6,4)",e[L.WorksheetFuncId.GAMMAINV]="=GAMMAINV(0.65, 4, 2)",e[L.WorksheetFuncId.NORMDIST]="=NORMDIST(42,40,1.5,TRUE)",e[L.WorksheetFuncId.NORM_INV]="=NORM.INV(0.908789,40,1.5)",e[L.WorksheetFuncId.NORMSINV]="=NORMSINV(0.9088)",e[L.WorksheetFuncId.SUMX2MY2]="=SUMX2MY2(A3:A9,B3:B9)",e[L.WorksheetFuncId.SUMX2PY2]="=SUMX2PY2(A3:A9,B3:B9)",e[L.WorksheetFuncId.FORECAST]="=FORECAST(30,A2:A6,B2:B6)",e[L.WorksheetFuncId.QUARTILE]="=QUARTILE(A2:A9,1)",e[L.WorksheetFuncId.TRIMMEAN]="=TRIMMEAN(A2:A12,0.2)",e[L.WorksheetFuncId.T_INV_2T]="=T.INV.2T(0.546449,60)",e[L.WorksheetFuncId.AVERAGEA]="=AVERAGEA(A2:A6)",e[L.WorksheetFuncId.TEXTJOIN]="=TEXTJOIN(, , TRUE, A2:A8)",e[L.WorksheetFuncId.SEQUENCE]="=SEQUENCE(4,5)",e[L.WorksheetFuncId.ADDRESS]='=ADDRESS(2,3,1,FALSE,"['.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Book1),"]").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sheet1),'")'),e[L.WorksheetFuncId.AVERAGE]="=AVERAGE(A2:A6)",e[L.WorksheetFuncId.COLUMNS]="=COLUMNS(C1:E4)",e[L.WorksheetFuncId.COUNTIF]='=COUNTIF(B2:B5,">55")',e[L.WorksheetFuncId.DAYS360]="=DAYS360(30-Jan-11,1-Feb-11)",e[L.WorksheetFuncId.DCOUNTA]='=DCOUNTA(A4:E10, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit),'", A1:F2)'),e[L.WorksheetFuncId.DECIMAL]="=DECIMAL(FF,16)",e[L.WorksheetFuncId.DEGREES]="=DEGREES(PI())",e[L.WorksheetFuncId.DSTDEVP]='=DSTDEVP(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:A3)'),e[L.WorksheetFuncId.CUBESET]='=CUBESET("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sales),'","[').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Product),"].[").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AllProducts),"].").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Children),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Products),'",1,"[').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Measures),"].[").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalesAmount),']")'),e[L.WorksheetFuncId.HLOOKUP]='=HLOOKUP("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Axles),'", A1:C4, 2, TRUE)'),e[L.WorksheetFuncId.IFERROR]='=IFERROR(55/0, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ErrorInCalculation),'")'),e[L.WorksheetFuncId.ISBLANK]="=ISBLANK(A2)",e[L.WorksheetFuncId.ISERROR]="=ISERROR(#REF!)",e[L.WorksheetFuncId.XLOOKUP]='=XLOOKUP("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom),'",A2:A9,C2:C9,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NotFound),'",0,1)'),e[L.WorksheetFuncId.MDETERM]="=MDETERM(A2:D5)",e[L.WorksheetFuncId.PRODUCT]="=PRODUCT(A2:A4)",e[L.WorksheetFuncId.RADIANS]="=RADIANS(270)",e[L.WorksheetFuncId.RANK_EQ]="=RANK.EQ(7,A2:A6,1)",e[L.WorksheetFuncId.REPLACE]='=REPLACE(2009,3,2,"10")',e[L.WorksheetFuncId.STDEV_S]="=STDEV.S(A2:A11)",e[L.WorksheetFuncId.STDEV_P]="=STDEV.P(A3:A12)",e[L.WorksheetFuncId.UNICODE]="=UNICODE(B)",e[L.WorksheetFuncId.UNICHAR]="=UNICHAR(66)",e[L.WorksheetFuncId.VLOOKUP]="=VLOOKUP(103, A2:B26, 2, FALSE)",e[L.WorksheetFuncId.WEEKDAY]="=WEEKDAY(39492)",e[L.WorksheetFuncId.GAMMALN]="=GAMMALN(4)",e[L.WorksheetFuncId.BETAINV]="=BETAINV(0.685470581,8,10,1,3)",e[L.WorksheetFuncId.CHIDIST]="=CHIDIST(18.307,10)",e[L.WorksheetFuncId.COMBINA]="=COMBINA(4,3)",e[L.WorksheetFuncId.CEILING]="=CEILING(2.5, 1)",e[L.WorksheetFuncId.NORMINV]="=NORMINV(0.908789,40,1.5)",e[L.WorksheetFuncId.POISSON]="=POISSON(1, 2, TRUE)",e[L.WorksheetFuncId.WEIBULL]="=WEIBULL(105,20,100,TRUE)",e[L.WorksheetFuncId.SUMXMY2]="=SUMXMY2(A3:A9,B3:B9)",e[L.WorksheetFuncId.CHITEST]="=CHITEST(A2:B4,A6:B8)",e[L.WorksheetFuncId.PEARSON]="=PEARSON(A3:A7,B3:B7)",e[L.WorksheetFuncId.GEOMEAN]="=GEOMEAN(A2:A8)",e[L.WorksheetFuncId.HARMEAN]="=HARMEAN(A2:A8)",e[L.WorksheetFuncId.STDEVPA]="=STDEVPA(A3:A12)",e[L.WorksheetFuncId.DATEDIF]='=DATEDIF(1/1/2001,1/1/2003,"Y")',e[L.WorksheetFuncId.ARABIC]="=ARABIC(LVII)",e[L.WorksheetFuncId.CHOOSE]='=CHOOSE(3,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wide),'",115,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.World),'",8)'),e[L.WorksheetFuncId.COLUMN]="=COLUMN(C9)",e[L.WorksheetFuncId.COUNTA]="=COUNTA(B2:B6)",e[L.WorksheetFuncId.DCOUNT]='=DCOUNT(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Age),'", A1:F2)'),e[L.WorksheetFuncId.DOLLAR]="=DOLLAR(1.2351, 4)",e[L.WorksheetFuncId.DSTDEV]='=DSTDEV(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:A3)'),e[L.WorksheetFuncId.GROWTH]="=GROWTH(#VALUE!)",e[L.WorksheetFuncId.IMCOSH]='=IMCOSH("4+3i")',e[L.WorksheetFuncId.IMCSCH]='=IMCSCH("4+3i")',e[L.WorksheetFuncId.IMSECH]='=IMSECH("4+3i")',e[L.WorksheetFuncId.IMSINH]='=IMSINH("4+3i")',e[L.WorksheetFuncId.ISTEXT]='=ISTEXT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Region1),'")'),e[L.WorksheetFuncId.LINEST]="=LINEST(B2:B10, A2:A10, FALSE, TRUE)",e[L.WorksheetFuncId.LOGEST]="=LOGEST(B2:B10, A2:A10, TRUE, TRUE)",e[L.WorksheetFuncId.LOOKUP]="=LOOKUP(4.19, A2:A6, B2:B6)",e[L.WorksheetFuncId.XMATCH]="=XMATCH(F2,C3:C9,1)",e[L.WorksheetFuncId.MEDIAN]="=MEDIAN(A2:A6)",e[L.WorksheetFuncId.MINUTE]="=MINUTE(0.53125)",e[L.WorksheetFuncId.OFFSET]="=OFFSET(D3,3,-2,1,1)",e[L.WorksheetFuncId.PROPER]='=PROPER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisIsATITLE),'")'),e[L.WorksheetFuncId.SEARCH]='=SEARCH("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.E),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Statements),'",6)'),e[L.WorksheetFuncId.SECOND]="=SECOND(0.700208333333333)",e[L.WorksheetFuncId.SHEETS]="=SHEETS(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.My3DRef),")"),e[L.WorksheetFuncId.STDEVP]="=STDEVP(A3:A12)",e[L.WorksheetFuncId.SUMIFS]='=SUMIFS(A2:A9, B2:B9, "<>'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bananas),'", C2:C9, "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tom),'")'),e[L.WorksheetFuncId.AVEDEV]="=AVEDEV(A2:A8)",e[L.WorksheetFuncId.CHIINV]="=CHIINV(0.3, 2)",e[L.WorksheetFuncId.COMBIN]="=COMBIN(8,2)",e[L.WorksheetFuncId.F_DIST]="=F.DIST(15.2069,6,4,TRUE)",e[L.WorksheetFuncId.FISHER]="=FISHER(0.75)",e[L.WorksheetFuncId.LOGINV]="=LOGINV(0.039084, 3.5, 1.2)",e[L.WorksheetFuncId.PERMUT]="=PERMUT(100,3)",e[L.WorksheetFuncId.T_DIST]="=T.DIST(60,1,TRUE)",e[L.WorksheetFuncId.CORREL]="=CORREL(A2:A6, B2:B6)",e[L.WorksheetFuncId.F_TEST]="=F.TEST(A2:A6,B2:B6)",e[L.WorksheetFuncId.T_TEST]="=T.TEST(A2:A10,B2:B10,2,1)",e[L.WorksheetFuncId.SKEW_P]="=SKEW.P(A2:A11)",e[L.WorksheetFuncId.Z_TEST]="=Z.TEST(A2:A11,4)",e[L.WorksheetFuncId.STDEVA]="=STDEVA(A3:A12)",e[L.WorksheetFuncId.MAXIFS]='=MAXIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB),'",D2:D7,">100")'),e[L.WorksheetFuncId.MINIFS]='=MINIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB),'",D2:D7,">100")'),e[L.WorksheetFuncId.CONCAT]='=CONCAT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Andreas),'"," ", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hauser),'")'),e[L.WorksheetFuncId.SWITCH]='=SWITCH(WEEKDAY(10/10/2016),1,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday),'",2,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday),'",3,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoMatch),'")'),e[L.WorksheetFuncId.FILTER]='=FILTER(A5:D20,(C5:C20="'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Apple),'")*(A5:A20="').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.East),'"),"")'),e[L.WorksheetFuncId.UNIQUE]="=UNIQUE(A2:A12)",e[L.WorksheetFuncId.SORTBY]="=SORTBY(D2:D9,E2:E9,1)",e[L.WorksheetFuncId.BITAND]="=BITAND(1,5)",e[L.WorksheetFuncId.BITXOR]="=BITXOR(5,3)",e[L.WorksheetFuncId.ACOSH]="=ACOSH(10)",e[L.WorksheetFuncId.ACOTH]="=ACOTH(6)",e[L.WorksheetFuncId.ATANH]="=ATANH(-0.1)",e[L.WorksheetFuncId.ATAN2]="=ATAN2(4,0)",e[L.WorksheetFuncId.CLEAN]="=CLEAN(A2)",e[L.WorksheetFuncId.COUNT]="=COUNT(A2:A7)",e[L.WorksheetFuncId.DVARP]='=DVARP(A4:E10, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:A3)'),e[L.WorksheetFuncId.EXACT]='=EXACT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Goodbye),'")'),e[L.WorksheetFuncId.FALSE]="=FALSE()",e[L.WorksheetFuncId.FIXED]="=FIXED(-1234.567, -1, TRUE)",e[L.WorksheetFuncId.IMCOT]='=IMCOT("4+3i")',e[L.WorksheetFuncId.IMCSC]='=IMCSC("4+3i")',e[L.WorksheetFuncId.IMSEC]='=IMSEC("4+3i")',e[L.WorksheetFuncId.IMTAN]='=IMTAN("4+3i")',e[L.WorksheetFuncId.INDEX]="=INDEX(A2:B3,2,1)",e[L.WorksheetFuncId.ISERR]="=ISERR(#N/A)",e[L.WorksheetFuncId.ISREF]="=ISREF(A2)",e[L.WorksheetFuncId.LOWER]='=LOWER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EECummings),'")'),e[L.WorksheetFuncId.MATCH]="=MATCH(39,B2:B5,1)",e[L.WorksheetFuncId.MMULT]="=MMULT(A1:B3, C1:F2)",e[L.WorksheetFuncId.MONTH]="=MONTH(40648)",e[L.WorksheetFuncId.RIGHT]='=RIGHT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice),'",5)'),e[L.WorksheetFuncId.ROUND]="=ROUND(2.149, 1)",e[L.WorksheetFuncId.SHEET]="=SHEET(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Table1),")"),e[L.WorksheetFuncId.STDEV]="=STDEV(A3:A12)",e[L.WorksheetFuncId.SUMIF]='=SUMIF(A2:A5,">160000")',e[L.WorksheetFuncId.TODAY]="=TODAY()",e[L.WorksheetFuncId.TREND]="=TREND(B2:B10, A2:A10, A11:A13, TRUE)",e[L.WorksheetFuncId.TRUNC]="=TRUNC(8.9)",e[L.WorksheetFuncId.UPPER]='=UPPER("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KelliXu),'")'),e[L.WorksheetFuncId.VALUE]="=VALUE(1000)",e[L.WorksheetFuncId.VAR_S]="=VAR.S(A2:A11)",e[L.WorksheetFuncId.VAR_P]="=VAR.P(A2:A11)",e[L.WorksheetFuncId.GAMMA]="=GAMMA(-3.75)",e[L.WorksheetFuncId.GAUSS]="=GAUSS(2)",e[L.WorksheetFuncId.FDIST]="=FDIST(15.20686486,6,4)",e[L.WorksheetFuncId.F_INV]="=F.INV(0.01,6,4)",e[L.WorksheetFuncId.FLOOR]="=FLOOR(23.25, 0.1)",e[L.WorksheetFuncId.TDIST]="=TDIST(60, 1, 1)",e[L.WorksheetFuncId.COVAR]="=COVAR(A2:A6, B2:B6)",e[L.WorksheetFuncId.FTEST]="=FTEST(A2:A6,B2:B6)",e[L.WorksheetFuncId.STEYX]="=STEYX(A3:A9,B3:B9)",e[L.WorksheetFuncId.SLOPE]="=SLOPE(A3:A9,B3:B9)",e[L.WorksheetFuncId.TTEST]="=TTEST(A2:A10,B2:B10,2,1)",e[L.WorksheetFuncId.DEVSQ]="=DEVSQ(A2:A8)",e[L.WorksheetFuncId.SUMSQ]="=SUMSQ(3, 4)",e[L.WorksheetFuncId.ZTEST]="=ZTEST(A2:A11,6)",e[L.WorksheetFuncId.LARGE]="=LARGE(A2:B6,7)",e[L.WorksheetFuncId.SMALL]="=SMALL(A2:A10,4)",e[L.WorksheetFuncId.MUNIT]="=MUNIT(2)",e[L.WorksheetFuncId.T_INV]="=T.INV(0.75,2)",e[L.WorksheetFuncId.ROMAN]="=ROMAN(499,0)",e[L.WorksheetFuncId.POWER]="=POWER(5,2)",e[L.WorksheetFuncId.ISPMT]="=ISPMT(10%, 2, 5, 1000)",e[L.WorksheetFuncId.VARPA]="=VARPA(1, 2)",e[L.WorksheetFuncId.AREAS]="=AREAS(B2:D4)",e[L.WorksheetFuncId.ASINH]="=ASINH(10)",e[L.WorksheetFuncId.BITOR]="=BITOR(23,10)",e[L.WorksheetFuncId.ACOS]="=ACOS(-0.5)",e[L.WorksheetFuncId.ACOT]="=ACOT(2)",e[L.WorksheetFuncId.ATAN]="=ATAN(1)",e[L.WorksheetFuncId.CELL]='=CELL("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Address),'", C2)'),e[L.WorksheetFuncId.CHAR]="=CHAR(65)",e[L.WorksheetFuncId.COSH]="=COSH(EXP(1))",e[L.WorksheetFuncId.COTH]="=COTH(2)",e[L.WorksheetFuncId.CSCH]="=CSCH(2)",e[L.WorksheetFuncId.DATE]="=DATE(2008,1,2)",e[L.WorksheetFuncId.DAYS]="=DAYS(3/15/11,2/1/11)",e[L.WorksheetFuncId.DGET]='=DGET(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:A3)'),e[L.WorksheetFuncId.DMAX]='=DMAX(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit),'", A1:F3)'),e[L.WorksheetFuncId.DMIN]='=DMIN(A5:E11, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit),'", A1:F3)'),e[L.WorksheetFuncId.DSUM]='=DSUM(A4:E10,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Profit),'", A1:F3)'),e[L.WorksheetFuncId.DVAR]='=DVAR(A4:E10, "'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yield),'", A1:A3)'),e[L.WorksheetFuncId.FACT]="=FACT(5)",e[L.WorksheetFuncId.FIND]='=FIND("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.M),'",A2)'),e[L.WorksheetFuncId.HOUR]="=HOUR(0.75)",e[L.WorksheetFuncId.IFNA]='=IFNA("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoNAError),'", "').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Error),'")'),e[L.WorksheetFuncId.IPMT]="=IPMT(10%, 3, 3, 8000)",e[L.WorksheetFuncId.ISNA]="=ISNA(#REF!)",e[L.WorksheetFuncId.LEFT]='=LEFT("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SalePrice),'",4)'),e[L.WorksheetFuncId.MIRR]="=MIRR(A2:A7, 0.1, 0.12)",e[L.WorksheetFuncId.NPER]="=NPER(0.12/12, -100, -1000, 10000, 1)",e[L.WorksheetFuncId.PPMT]="=PPMT(0.08, 10, 10, 200000)",e[L.WorksheetFuncId.RAND]="=RAND()",e[L.WorksheetFuncId.RANK]="=RANK(3.5,A2:A6,1)",e[L.WorksheetFuncId.RATE]="=RATE(4*12, -200, 8000)",e[L.WorksheetFuncId.REPT]='=REPT("*-", 3)',e[L.WorksheetFuncId.ROWS]="=ROWS(C1:E4)",e[L.WorksheetFuncId.SECH]="=SECH(0)",e[L.WorksheetFuncId.SIGN]="=SIGN(10)",e[L.WorksheetFuncId.SINH]="=SINH(2)",e[L.WorksheetFuncId.SQRT]="=SQRT(16)",e[L.WorksheetFuncId.TANH]="=TANH(0.5)",e[L.WorksheetFuncId.TEXT]='=TEXT(1234.567,"$#,##0.00")',e[L.WorksheetFuncId.TIME]="=TIME(16,48,10)",e[L.WorksheetFuncId.TRIM]='=TRIM("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuarterEarnings),'")'),e[L.WorksheetFuncId.TRUE]="=TRUE()",e[L.WorksheetFuncId.TYPE]='=TYPE("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Smith),'")'),e[L.WorksheetFuncId.VARP]="=VARP(A2:A11)",e[L.WorksheetFuncId.YEAR]="=YEAR(39634)",e[L.WorksheetFuncId.INFO]='=INFO("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numfile),'")'),e[L.WorksheetFuncId.EVEN]="=EVEN(1.5)",e[L.WorksheetFuncId.FINV]="=FINV(0.42, 2, 3)",e[L.WorksheetFuncId.PROB]="=PROB(A3:A6,B3:B6,2)",e[L.WorksheetFuncId.KURT]="=KURT(A2:A11)",e[L.WorksheetFuncId.SKEW]="=SKEW(A2:A11)",e[L.WorksheetFuncId.MODE]="=MODE(A2:A7)",e[L.WorksheetFuncId.MINA]="=MINA(A2:A6)",e[L.WorksheetFuncId.MAXA]="=MAXA(A2:A6)",e[L.WorksheetFuncId.VARA]="=VARA(1, 2)",e[L.WorksheetFuncId.SORT]="=SORT(A2:A17)",e[L.WorksheetFuncId.ASIN]="=ASIN(-0.5)",e[L.WorksheetFuncId.BASE]="=BASE(7,2)",e[L.WorksheetFuncId.CODE]='=CODE("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CodeA),'")'),e[L.WorksheetFuncId.AND]="=AND(A2>1,A2<100)",e[L.WorksheetFuncId.COS]="=COS(1.047)",e[L.WorksheetFuncId.COT]="=COT(30)",e[L.WorksheetFuncId.CSC]="=CSC(15)",e[L.WorksheetFuncId.DAY]="=DAY(40648)",e[L.WorksheetFuncId.DDB]="=DDB(2400,300,10*365,1)",e[L.WorksheetFuncId.RTD]='=RTD(mycomaddin.progid,,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ServerName),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Price),'")'),e[L.WorksheetFuncId.EXP]="=EXP(1)",e[L.WorksheetFuncId.INT]="=INT(8.9)",e[L.WorksheetFuncId.IRR]="=IRR(A2:A4,-10%)",e[L.WorksheetFuncId.LEN]='=LEN("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Excel),'")'),e[L.WorksheetFuncId.LOG]="=LOG(10)",e[L.WorksheetFuncId.MAX]="=MAX(A2:A6)",e[L.WorksheetFuncId.MID]='=MID("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FluidFlow),'",1,5)'),e[L.WorksheetFuncId.MIN]="=MIN(A2:A6)",e[L.WorksheetFuncId.MOD]="=MOD(3, 2)",e[L.WorksheetFuncId.NOT]="=NOT(A2>100)",e[L.WorksheetFuncId.NPV]="=NPV(0.1, -10000, 3000, 4200, 6800)",e[L.WorksheetFuncId.PMT]="=PMT(0.08/12,10,10000)",e[L.WorksheetFuncId.ROW]="=ROW(C10)",e[L.WorksheetFuncId.RRI]="=RRI(96,10000,11000)",e[L.WorksheetFuncId.SEC]="=SEC(30)",e[L.WorksheetFuncId.SIN]="=SIN(PI())",e[L.WorksheetFuncId.SLN]="=SLN(30000, 7500, 10)",e[L.WorksheetFuncId.SUM]="=SUM(A1:A3)",e[L.WorksheetFuncId.SYD]="=SYD(30000,7500,10,1)",e[L.WorksheetFuncId.TAN]="=TAN(0.785)",e[L.WorksheetFuncId.VAR]="=VAR(A2:A11)",e[L.WorksheetFuncId.VDB]="=VDB(2400, 300, 10*365, 0, 1)",e[L.WorksheetFuncId.XOR]="=XOR(3>0,2<9)",e[L.WorksheetFuncId.ODD]="=ODD(1.5)",e[L.WorksheetFuncId.PHI]="=PHI(0.75)",e[L.WorksheetFuncId.RSQ]="=RSQ(A3:A9, B3:B9)",e[L.WorksheetFuncId.IFS]='=IFS(A2>89,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsA),'",A2>79,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsB),'",A2>69,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsC),'",A2>59,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsD),'",TRUE,"').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IfsF),'")'),e[L.WorksheetFuncId.DB]="=DB(1000000,100000,6,1,7)",e[L.WorksheetFuncId.FV]="=FV(0.06/12, 10, -200, -500, 1)",e[L.WorksheetFuncId.IF]='=IF(C2>B2,"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OverBudget),'","').concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WithinBudget),'")'),e[L.WorksheetFuncId.LN]="=LN(86)",e[L.WorksheetFuncId.NA]="=NA()",e[L.WorksheetFuncId.OR]="=OR(A2>1,A2<100)",e[L.WorksheetFuncId.PV]="=PV(0.08/12, 12*20, 500, , 0)",e[L.WorksheetFuncId.N]="=N(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Even),")"),e[L.WorksheetFuncId.T]='=T("'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hello),'")'),e[L.WorksheetFuncId.ACCRINT]="=ACCRINT(39508,39691,39569,0.1,1000,2,0)",e[L.WorksheetFuncId.ACCRINTM]="=ACCRINTM(39539,39614,0.1,1000,3)",e[L.WorksheetFuncId.AMORDEGRC]="=AMORDEGRC(2400,39679,39813,300,1,0.15,1)",e[L.WorksheetFuncId.AMORLINC]="=AMORLINC(2400,39679,39813,300,1,0.15,1)",e[L.WorksheetFuncId.BESSELI]="=BESSELI(1.5,1)",e[L.WorksheetFuncId.BESSELJ]="=BESSELJ(1.9,2)",e[L.WorksheetFuncId.BESSELK]="=BESSELK(1.5,1)",e[L.WorksheetFuncId.BESSELY]="=BESSELY(2.5,1)",e[L.WorksheetFuncId.BIN2DEC]="=BIN2DEC(1100100)",e[L.WorksheetFuncId.BIN2HEX]="=BIN2HEX(11111011, 4)",e[L.WorksheetFuncId.BIN2OCT]="=BIN2OCT(1001, 3)",e[L.WorksheetFuncId.COMPLEX]='=COMPLEX(3,4,"j")',e[L.WorksheetFuncId.CONVERT]='=CONVERT(1,"lbm","kg")',e[L.WorksheetFuncId.COUPDAYBS]="=COUPDAYBS(25-Jan-11,15-Nov-11,2,1)",e[L.WorksheetFuncId.COUPDAYS]="=COUPDAYS(25-Jan-11,15-Nov-11,2,1)",e[L.WorksheetFuncId.COUPDAYSNC]="=COUPDAYSNC(25-Jan-11,15-Nov-11,2,1)",e[L.WorksheetFuncId.COUPNCD]="=COUPNCD(25-Jan-11,15-Nov-11,2,1)",e[L.WorksheetFuncId.COUPNUM]="=COUPNUM(25-Jan-11,15-Nov-12,2,1)",e[L.WorksheetFuncId.COUPPCD]="=COUPPCD(25-Jan-11,15-Nov-11,2,1)",e[L.WorksheetFuncId.CUMIPMT]="=CUMIPMT(A2/12,A3*12,A4,13,24,0)",e[L.WorksheetFuncId.CUMPRINC]="=CUMPRINC(A2/12,A3*12,A4,13,24,0)",e[L.WorksheetFuncId.DEC2BIN]="=DEC2BIN(9, 4)",e[L.WorksheetFuncId.DEC2HEX]="=DEC2HEX(100,4)",e[L.WorksheetFuncId.DEC2OCT]="=DEC2OCT(58,3)",e[L.WorksheetFuncId.DELTA]="=DELTA(5,4)",e[L.WorksheetFuncId.DISC]="=DISC(7/1/2018,1/1/2048,97.975,100,1)",e[L.WorksheetFuncId.DOLLARDE]="=DOLLARDE(1.02,16)",e[L.WorksheetFuncId.DOLLARFR]="=DOLLARFR(1.125,16)",e[L.WorksheetFuncId.DURATION]="=DURATION(7/1/2018,1/1/2048,8%,9%,2,1)",e[L.WorksheetFuncId.EDATE]="=EDATE(15-Jan-11,1)",e[L.WorksheetFuncId.EFFECT]="=EFFECT(0.0525,4)",e[L.WorksheetFuncId.EOMONTH]="=EOMONTH(1-Jan-11,1)",e[L.WorksheetFuncId.ERF]="=ERF(0.745)",e[L.WorksheetFuncId.ERFC]="=ERFC(1)",e[L.WorksheetFuncId.FACTDOUBLE]="=FACTDOUBLE(6)",e[L.WorksheetFuncId.FORECAST_ETS]="=FORECAST.ETS(A62,$B$4:$B$60,$A$4:$A$60,1,1)",e[L.WorksheetFuncId.FORECAST_ETS_CONFINT]="=FORECAST.ETS.CONFINT(A62,$B$4:$B$60,$A$4:$A$60,0.95,1,1)",e[L.WorksheetFuncId.FORECAST_ETS_SEASONALITY]="=FORECAST.ETS.SEASONALITY($B$4:$B$60,$A$4:$A$60,1,1)",e[L.WorksheetFuncId.FORECAST_ETS_STAT]="=FORECAST.ETS.STAT($B$4:$B$60,$A$4:$A$60,1,J48,1,1)",e[L.WorksheetFuncId.FVSCHEDULE]="=FVSCHEDULE(1,{0.09,0.11,0.1})",e[L.WorksheetFuncId.GCD]="=GCD(24,36)",e[L.WorksheetFuncId.GESTEP]="=GESTEP(5,4)",e[L.WorksheetFuncId.HEX2BIN]="=HEX2BIN(F,8)",e[L.WorksheetFuncId.HEX2DEC]="=HEX2DEC(FFFFFFFF5B)",e[L.WorksheetFuncId.HEX2OCT]="=HEX2OCT(F, 3)",e[L.WorksheetFuncId.IMABS]='=IMABS("5+12i")',e[L.WorksheetFuncId.IMAGE]='=IMAGE("https://microsoft.com/abc.jpg", "Microsoft", 0)',e[L.WorksheetFuncId.IMAGINARY]='=IMAGINARY("3+4i")',e[L.WorksheetFuncId.IMARGUMENT]='=IMARGUMENT("3+4i")',e[L.WorksheetFuncId.IMCONJUGATE]='=IMCONJUGATE("3+4i")',e[L.WorksheetFuncId.IMCOS]='=IMCOS("1+i")',e[L.WorksheetFuncId.IMDIV]='=IMDIV("-238+240i","10+24i")',e[L.WorksheetFuncId.IMEXP]='=IMEXP("1+i")',e[L.WorksheetFuncId.IMLN]='=IMLN("3+4i")',e[L.WorksheetFuncId.IMLOG10]='=IMLOG10("3+4i")',e[L.WorksheetFuncId.IMLOG2]='=IMLOG2("3+4i")',e[L.WorksheetFuncId.IMPOWER]='=IMPOWER("2+3i", 3)',e[L.WorksheetFuncId.IMPRODUCT]='=IMPRODUCT("3+4i","5-3i")',e[L.WorksheetFuncId.IMREAL]='=IMREAL("6-9i")',e[L.WorksheetFuncId.IMSIN]='=IMSIN("4+3i")',e[L.WorksheetFuncId.IMSQRT]='=IMSQRT("1+i")',e[L.WorksheetFuncId.IMSUB]='=IMSUB("13+4i","5+3i")',e[L.WorksheetFuncId.IMSUM]='=IMSUM("3+4i","5-3i")',e[L.WorksheetFuncId.INTRATE]="=INTRATE(2/15/2008,5/15/2008,1000000,1014420,2)",e[L.WorksheetFuncId.ISEVEN]="=ISEVEN(2.5)",e[L.WorksheetFuncId.ISODD]="=ISODD(2.5)",e[L.WorksheetFuncId.LAMBDA]="=LAMBDA(a, b, SQRT((a^2+b^2)))",e[L.WorksheetFuncId.LET]="=LET(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total),", SUM(A1:A10), ").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count),", COUNT(A1:A10), ").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Total)," / ").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Count),")"),e[L.WorksheetFuncId.LCM]="=LCM(5,2)",e[L.WorksheetFuncId.LOG10]="=LOG10(86)",e[L.WorksheetFuncId.MDURATION]="=MDURATION(1/1/2008,1/1/2016,8%,9%,2,1)",e[L.WorksheetFuncId.MROUND]="=MROUND(10,3)",e[L.WorksheetFuncId.MULTINOMIAL]="=MULTINOMIAL(2,3,4)",e[L.WorksheetFuncId.NETWORKDAYS]="=NETWORKDAYS(10/1/2012,3/1/2013)",e[L.WorksheetFuncId.NOMINAL]="=NOMINAL(0.053543, 4)",e[L.WorksheetFuncId.NOW]="=NOW()",e[L.WorksheetFuncId.OCT2BIN]="=OCT2BIN(3,3)",e[L.WorksheetFuncId.OCT2DEC]="=OCT2DEC(54)",e[L.WorksheetFuncId.OCT2HEX]="=OCT2HEX(100,4)",e[L.WorksheetFuncId.ODDFPRICE]="=ODDFPRICE(11/11/2008,3/1/2021,10/15/2008,3/1/2009,7.85%,6.25%,100,2,1)",e[L.WorksheetFuncId.ODDFYIELD]="=ODDFYIELD(11/11/2008,3/1/2021,10/15/2008,3/1/2009,5.75%,84.5,100,2,0)",e[L.WorksheetFuncId.ODDLPRICE]="=ODDLPRICE(2/7/2008,6/15/2008,10/15/2007,3.75%,4.05%,100,2,0)",e[L.WorksheetFuncId.ODDLYIELD]="=ODDLYIELD(4/20/2008,6/15/2008,12/24/2007,3.75%,99.875,100,2,0)",e[L.WorksheetFuncId.PI]="=PI()",e[L.WorksheetFuncId.PRICE]="=PRICE(2/15/2008,11/15/2017,5.75%,6.5%,100,2,0)",e[L.WorksheetFuncId.PRICEDISC]="=PRICEDISC(2/16/2008,3/1/2008,5.25%,100,2)",e[L.WorksheetFuncId.PRICEMAT]="=PRICEMAT(2/15/2008,4/13/2008,11/11/2007,6.1%,6.1%,0)",e[L.WorksheetFuncId.QUOTIENT]="=QUOTIENT(5,2)",e[L.WorksheetFuncId.RANDBETWEEN]="=RANDBETWEEN(1,100)",e[L.WorksheetFuncId.RECEIVED]="=RECEIVED(2/15/2008,5/15/2008,1000000,5.75%,2)",e[L.WorksheetFuncId.RECURSE]="=RECURSE()",e[L.WorksheetFuncId.ROUNDDOWN]="=ROUNDDOWN(3.14159,3)",e[L.WorksheetFuncId.ROUNDUP]="=ROUNDUP(3.14159,3)",e[L.WorksheetFuncId.SERIESSUM]="=SERIESSUM(0.785398163,0,2,A4:A7)",e[L.WorksheetFuncId.SQRTPI]="=SQRTPI(1)",e[L.WorksheetFuncId.TBILLEQ]="=TBILLEQ(3/31/2008,6/1/2008,9.14%)",e[L.WorksheetFuncId.TBILLPRICE]="=TBILLPRICE(3/31/2008,6/1/2008,9%)",e[L.WorksheetFuncId.TBILLYIELD]="=TBILLYIELD(3/31/2008,6/1/2008,98.45%)",e[L.WorksheetFuncId.TINV]="=TINV(0.05464,60)",e[L.WorksheetFuncId.WEEKNUM]="=WEEKNUM(3/9/2012,2)",e[L.WorksheetFuncId.WORKDAY]="=WORKDAY(10/1/2008,151)",e[L.WorksheetFuncId.XIRR]="=XIRR(A3:A7, B3:B7, 0.1)",e[L.WorksheetFuncId.XNPV]="=XNPV(0.09, A2:A6, B2:B6)",e[L.WorksheetFuncId.YEARFRAC]="=YEARFRAC(1/1/2012,7/30/2012)",e[L.WorksheetFuncId.YIELD]="=YIELD(2/15/2008,11/15/2016,5.75%,95.04287,100,2,0)",e[L.WorksheetFuncId.YIELDDISC]="=YIELDDISC(2/16/2008,3/1/2008,99.795,100,2)",e[L.WorksheetFuncId.YIELDMAT]="=YIELDMAT(3/15/2008,11/3/2008,11/8/2007,6.25%,100.0123,0)",e[L.WorksheetFuncId.TEXTSPLIT]='=TEXTSPLIT("1,2,3;4,5,6",",",";")',e[L.WorksheetFuncId.TEXTBEFORE]='=TEXTBEFORE("Red riding hood\'s, red hood", "hood")',e[L.WorksheetFuncId.TEXTAFTER]='=TEXTAFTER("Red riding hood\'s, red hood", "hood")',e[L.WorksheetFuncId.VSTACK]="=VSTACK({1,2},{3,4},5)",e[L.WorksheetFuncId.HSTACK]="=HSTACK({1;2},{3;4},5)",e[L.WorksheetFuncId.MAP]="=MAP(A1:C2, LAMBDA(a, IF(a>4,a*a,a)))",e[L.WorksheetFuncId.WRAPROWS]="=WRAPROWS(A2:G2,3)",e[L.WorksheetFuncId.SCAN]="=SCAN(1, A1:C2, LAMBDA(a,b,a*b))",e[L.WorksheetFuncId.MAKEARRAY]="=MAKEARRAY(3, 3, LAMBDA(row,col, row*col))",e[L.WorksheetFuncId.REDUCE]="=REDUCE(, A1:C2, LAMBDA(a,b,a+b^2))",e[L.WorksheetFuncId.NORMSDIST]="=NORMDIST(A2,A3,A4,TRUE)",e[L.WorksheetFuncId.CHOOSEROWS]="=CHOOSEROWS(A2:B7,1,3,5,1)",e[L.WorksheetFuncId.CHOOSECOLS]="=CHOOSECOLS(A2:E7,1,3,5,1)",e[L.WorksheetFuncId.DROP]="=DROP(A2:C4,2)",e[L.WorksheetFuncId.WRAPCOLS]="=WRAPCOLS(A2:F2,3)",e[L.WorksheetFuncId.TOCOL]="=TOCOL(A2:D4)",e[L.WorksheetFuncId.TAKE]="=TAKE(A2:C4,2)",e[L.WorksheetFuncId.TOROW]="=TOROW(A2:D4)",e[L.WorksheetFuncId.BYCOL]="=BYCOL(A1:C2, LAMBDA(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array),", MAX(").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array),")))"),e[L.WorksheetFuncId.BYROW]="=BYROW(A1:C2, LAMBDA(".concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array),", MAX(").concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Array),")))"),e[L.WorksheetFuncId.EXPAND]="=EXPAND(A2:B3,3,3)",e[L.WorksheetFuncId.DBCS]='=DBCS("EXCEL")',e[L.WorksheetFuncId.ASC]='=ASC("EXCEL")',e[L.WorksheetFuncId.LENB]='=LENB("EXCEL")',e[L.WorksheetFuncId.FURIGANA]="=PHONETIC(C4)",e[L.WorksheetFuncId.ISOMITTED]='=LAMBDA(x,y, IF(ISOMITTED(y),"'.concat(FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingSecondArgument),'",x+y))(1,)'),e[L.WorksheetFuncId.MIDB]="=MIDB(A2,7,20)",e[L.WorksheetFuncId.RIGHTB]="=RIGHTB(A2,7)",e})});var wMe=T($6=>{"use strict";p();Object.defineProperty($6,"__esModule",{value:!0});$6.ArgumentAssistanceVisitor=void 0;var Gkr=fe(),Bkr=Ms(),IMe=ti(),Ukr=ks(),Kkr=function(e){Gkr.__extends(r,e);function r(t,n,a){var o=e.call(this)||this;return o.parsedFormulaTree=t,o.caretPosition=n,o.newNamedObjectsEnabled=a,o.assistedFunctionScopeStart=0,o.fixHandlingWhiteSpace=!1,o.fixHandlingWhiteSpace=(0,Bkr.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces"),o}return r.prototype.appNode=function(t,n,a,o){return(t.kind===IMe.NodeKind.WSF||this.newNamedObjectsEnabled&&t.kind===IMe.NodeKind.Name)&&this.updateAssistedFunction(t,n),e.prototype.appNode.call(this,t,n,a,o)},r.prototype.letNode=function(t,n,a,o,u,s){var l=e.prototype.letNode.call(this,t,n,a,o,u,s);return this.updateAssistedFunction(t,l.args),l},r.prototype.lambdaNode=function(t,n,a,o,u,s){var l=e.prototype.lambdaNode.call(this,t,n,a,o,u,s);return this.updateAssistedFunction(t,l.args),l},r.prototype.updateAssistedFunction=function(t,n){var a=this.parsedFormulaTree.spans[n[0].label],o=this.parsedFormulaTree.spans[n[n.length-1].label],u=a.start,s=o.end;this.fixHandlingWhiteSpace&&(u-=a.pre.length,s+=o.post.length),this.caretPosition<=s&&this.caretPosition>=u&&(this.assistedFunctionHead===void 0||u>this.assistedFunctionScopeStart)&&(this.assistedFunctionHead=t,this.assistedFunctionArgs=n,this.assistedFunctionScopeStart=u)},r}(Ukr.IdentityVisitor);$6.ArgumentAssistanceVisitor=Kkr});var qre=T(Av=>{"use strict";p();Object.defineProperty(Av,"__esModule",{value:!0});Av.getBaseParamName=Av.getParamNumberSuffix=Av.getParamIndexToHighlight=Av.getActiveParamIndex=Av.createFunctionRenderingInfo=void 0;var Vkr=Qf();function jkr(e,r,t,n,a,o,u,s,l){var c=DMe(r,t,n,u),d=e.Params.split("!"),f={kind:"Full",functionName:e.NameDataStrings,functionDescription:e.Help,signatures:d.map(function(m,v){return Wkr(e,m,v,c,a,o,s,l)}),activeSignature:0,listSeparator:o,isUDF:e.IsDynamicUdf,helpID:e.HelpId};return f}Av.createFunctionRenderingInfo=jkr;function Wkr(e,r,t,n,a,o,u,s){var l=(0,Vkr.getWorksheetFuncType)(a),c=r!==""?r.split(o+" ").filter(function(y){return y!=="..."}):[],d=Xkr(c,l,n),f=zkr(u,s),m=Qkr(e.ParamsHelp,c,l,t),v=Ykr(d,m),h={signatureParams:Dre(d,Hkr(n,c.length,l)),descriptions:m,descriptionParams:Dre(v,e5(n,v.length,l)),exampleParams:f!==null?Dre(f,e5(n,f.length,l,!0)):null,exampleDescription:""};return h}function DMe(e,r,t,n){var a,o=0;if(n)for(var u=0;u<r.length;u++){var s=e.spans[r[u].label];if(s&&s.start-s.pre.length<=t&&t<=s.end+s.post.length){o=u;break}}else for(var u=r.length-1;u>=0;u-=1){var l=(a=e.spans[r[u].label])===null||a===void 0?void 0:a.end;l!==void 0&&t<=l&&(o=u)}return o}Av.getActiveParamIndex=DMe;function e5(e,r,t,n,a){n===void 0&&(n=!1),a===void 0&&(a=!1);var o=r-1,u=t.restTypes.length,s=t.headTypes.length;if(e<s+u)return e;if(e>=s&&u===0)return-1;var l=(e-s)%u;if(n)return e<=o-t.tailTypes.length?e:o-t.tailTypes.length-(u-1)+l;var c=a&&l===0&&t.tailTypes.length>0?u:l;return s+c}Av.getParamIndexToHighlight=e5;function Hkr(e,r,t){var n=e5(e,r,t);return qMe(e,t)&&(n+=1),n}function zkr(e,r){return e===void 0||r===void 0?null:r.node.args.map(function(t){var n=r.spans[t.label];return n?e.substring(n.start,n.end):""})}function Qkr(e,r,t,n){var a=e.split("!");if(n===0?a=a.slice(0,r.length):a=a.slice(-1*r.length),t.restTypes.length>0){for(var o=t.headTypes.length;o<a.length;o+=1){var u=Lre(r[o]),s="".concat(u,"1,").concat(u,"2,... ");a[o]=s+a[o]}t.restTypes.length===1&&a.push(a[t.headTypes.length])}return a}function Xkr(e,r,t){var n=e.slice(),a=r.headTypes.length,o=r.restTypes.length;if(o>0){for(var u=LMe(t,a,o),s=a;s<n.length;s+=o){for(var l=0;l<o;l+=1){var c=Lre(n[s+l]),d=u>1&&l%o===0?"[":"",f=u>1&&l%o===o-1?"]":"";n[s+l]="".concat(d).concat(c).concat(u).concat(f)}u+=1}n.push("..."),qMe(t,r)&&n.splice(a,0,"...")}return n}function LMe(e,r,t){return 1+Math.max(Math.floor((e-r)/t),0)}Av.getParamNumberSuffix=LMe;function Ykr(e,r){return e.filter(function(t){return t!=="..."}).slice(0,r.length).map(function(t){return Jkr(t)})}function qMe(e,r){return r.restTypes.length>0&&e>=r.headTypes.length+r.restTypes.length}function Lre(e){return e.match(/[^0-9\[\]]+/)}Av.getBaseParamName=Lre;function Jkr(e){return e.startsWith("[")&&!e.endsWith("]")?e+"]":!e.startsWith("[")&&e.endsWith("]")?"["+e:e}function Dre(e,r){var t={params:e,activeParam:Math.min(r,e.length-1)};return t}});var Ld=T(AO=>{"use strict";p();Object.defineProperty(AO,"__esModule",{value:!0});AO.trackableAsyncLazy=AO.TrackableAsyncLazy=void 0;var r5=fe(),Zkr=hc(),$kr=Xp(),eMr=Ar(),Gre=function(e){r5.__extends(r,e);function r(t,n,a){a===void 0&&(a=eMr.now);var o=this,u=function(){return r5.__awaiter(o,void 0,void 0,function(){var l,c,d,f,m;return r5.__generator(this,function(v){switch(v.label){case 0:return l=a(),c=t(),d=a()-l,[4,c];case 1:return f=v.sent(),m=a()-l-d,$kr.x10Logger.log({kind:"trackableAsyncLazy",payload:{name:this.name,syncTime:d,asyncTime:m}}),[2,f]}})})};return o=e.call(this,u)||this,o.name=n,o}return r.prototype.reset=function(){throw new Error("Resetting a TrackableAsyncLazy is not allowed")},r}(Zkr.ResettableLazy);AO.TrackableAsyncLazy=Gre;function rMr(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new(Gre.bind.apply(Gre,r5.__spreadArray([void 0],e,!1)))}AO.trackableAsyncLazy=rMr});var qd=T(Mu=>{"use strict";p();Object.defineProperty(Mu,"__esModule",{value:!0});Mu.autoCompletePluginsThread=Mu.workerThreadInitialized=Mu.workerThreadSpread=Mu.dynamicPluginLoaderCreated=Mu.schedulerWithTableIntelligenceServiceAttached=Mu.schedulerWithRecalcServiceAttached=Mu.scriptLoaderPromise=Mu.FormulaAuthoringStringsOnMainThread=void 0;var $p=fe(),t5=sE(),tMr=hc(),nMr=GN(),aMr=Ms(),GMe=ia(),dE=Ld();Mu.FormulaAuthoringStringsOnMainThread=(0,dE.trackableAsyncLazy)(function(){return $p.__awaiter(void 0,void 0,void 0,function(){var e;return $p.__generator(this,function(r){switch(r.label){case 0:return[4,Mu.dynamicPluginLoaderCreated.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript("formula-authoring-strings",!0)];case 2:return r.sent(),[2]}})})},"FormulaAuthoringStringsOnMainThread");Mu.scriptLoaderPromise=new nMr.ResolvablePromise;Mu.schedulerWithRecalcServiceAttached=(0,dE.trackableAsyncLazy)(function(){return $p.__awaiter(void 0,void 0,void 0,function(){var e;return $p.__generator(this,function(r){switch(r.label){case 0:return e=t5.PluginSchedulerSingleton.instance(),iMr.getValue()?[4,Mu.FormulaAuthoringStringsOnMainThread.getValue()]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,e.recalcServiceAttached()];case 3:return r.sent(),[2,e]}})})},"schedulerWithRecalcServiceAttached");Mu.schedulerWithTableIntelligenceServiceAttached=(0,dE.trackableAsyncLazy)(function(){return $p.__awaiter(void 0,void 0,void 0,function(){var e;return $p.__generator(this,function(r){switch(r.label){case 0:return e=t5.PluginSchedulerSingleton.instance(),[4,e.tableIntelligenceServiceAttached()];case 1:return r.sent(),[2,e]}})})},"schedulerWithTableIntelligenceServiceAttached");Mu.dynamicPluginLoaderCreated=(0,dE.trackableAsyncLazy)(function(){return $p.__awaiter(void 0,void 0,void 0,function(){var e;return $p.__generator(this,function(r){switch(r.label){case 0:return[4,Mu.scriptLoaderPromise];case 1:return e=r.sent(),[2,(0,t5.createDynamicPluginLoader)(e)]}})})},"dynamicPluginLoaderCreated");Mu.workerThreadSpread=(0,dE.trackableAsyncLazy)(function(){return $p.__awaiter(void 0,void 0,void 0,function(){var e;return $p.__generator(this,function(r){switch(r.label){case 0:return[4,Mu.dynamicPluginLoaderCreated.getValue()];case 1:return e=r.sent(),[2,e.createPluginThread("worker")]}})})},"workerThreadSpread");Mu.workerThreadInitialized=(0,dE.trackableAsyncLazy)(function(){return $p.__awaiter(void 0,void 0,void 0,function(){return $p.__generator(this,function(e){switch(e.label){case 0:return[4,Mu.workerThreadSpread.getValue()];case 1:return e.sent(),[2]}})})},"workerThreadInitialized");Mu.autoCompletePluginsThread=(0,dE.trackableAsyncLazy)(function(){return $p.__awaiter(void 0,void 0,void 0,function(){var e;return $p.__generator(this,function(r){switch(r.label){case 0:return(0,aMr.getTypedFeatureGate)("Microsoft.Office.Excel.AutoCompleteOnMainThread")?[4,Mu.dynamicPluginLoaderCreated.getValue()]:[3,2];case 1:return e=r.sent(),[3,4];case 2:return[4,Mu.workerThreadSpread.getValue()];case 3:e=r.sent(),r.label=4;case 4:return[2,e]}})})},"autoCompletePluginsThread");var iMr=new tMr.ResettableLazy(function(){var e=t5.PluginSchedulerSingleton.instance();return!e.isSchedulerFeatureEnabled(GMe.SchedulerFeature.SimpleAutoComplete)&&e.isSchedulerFeatureEnabled(GMe.SchedulerFeature.ArgumentAssistance)})});var Kre=T(NO=>{"use strict";p();Object.defineProperty(NO,"__esModule",{value:!0});NO.argumentAssistancePluginDependenciesResolved=NO.ArgumentAssistancePluginFactory=void 0;var Ure=fe(),ml=Xo(),oMr=yc(),uMr=ks(),sMr=xMe(),fE=Gi(),FO=zn(),BMe=Us(),UMe=QR(),lMr=wMe(),n5=qre(),cMr=hc(),Bre=qd(),dMr=ZN(),VMe=Ms(),jMe=ia(),KMe=mi(),fMr=ti(),pMr=Ld(),WMe=function(){function e(){this.factoryName=jMe.PluginFactoryName.ArgumentAssistancePlugin}return e.prototype.create=function(){var r=new mMr;return r},e}();NO.ArgumentAssistancePluginFactory=WMe;var mMr=function(){function e(){this.timer=dMr.defaultTimerInterface,this.lastRunTime=0,this.runStartTime=0,this.timeStamps=new Map,this.fixHandlingWhiteSpace=(0,VMe.isTypedChangeGateEnabled)("OfficeVSO:7920319_fixArgumentAssistanceHandlingWhitespaces"),this.newNamedObjectsEnabled=(0,KMe.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,KMe.getBooleanFeatureGate)("Microsoft.Office.Excel.XLONameManager",!1)}return e.prototype.run=function(r){var t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N,k,q,V,I,M,B,U,j,X,ee,re,Z,J,C,S,b=this;return Ure.__generator(this,function(O){switch(O.label){case 0:return this.lastRunTime=this.timer.now(),this.runStartTime=this.timer.now(),this.timeStamps=new Map,[4,{kind:ml.ComputationRequestKind.GetActiveCell}];case 1:return t=O.sent(),t.kind!==ml.ComputationRequestKind.GetActiveCell?(this.logFailure("failed to get active cell"),[2,null]):(this.addTimeStamp("GetActiveCell"),[4,{kind:ml.ComputationRequestKind.ParseActiveCell,formulaText:r.content}]);case 2:return n=O.sent(),this.addTimeStamp("ParseCellContentSync"),n===void 0||n.kind!==ml.ComputationRequestKind.ParseActiveCell||!(0,FO.isSuccess)(n.result)?[4,{kind:ml.ComputationRequestKind.ParseEdit,cell:t.activeCell,formulaBarText:r.content}]:[3,4];case 3:if(n=O.sent(),this.addTimeStamp("ParseCellContentAsync"),n.kind!==ml.ComputationRequestKind.ParseEdit||!(0,FO.isSuccess)(n.result))return[2,null];O.label=4;case 4:return n.result.value.kind!==BMe.EditKind.Formula?[2,null]:(a=n.result.value.formula,o=new lMr.ArgumentAssistanceVisitor(a,r.caretPosition,this.newNamedObjectsEnabled),(0,uMr.reduceBottomUp)(o,a),this.addTimeStamp("ArgumentAssistanceVisitor"),o.assistedFunctionHead===void 0?(this.logTimeStamp(),[2,null]):[4,{kind:ml.ComputationRequestKind.GetConfig}]);case 5:return u=O.sent(),this.addTimeStamp("GetConfig"),s=u.kind===ml.ComputationRequestKind.GetConfig?u.config.localeInfo.listSeparator:",",l=o.assistedFunctionHead,l.kind!==fMr.NodeKind.Name?[3,8]:this.newNamedObjectsEnabled?[4,{kind:ml.ComputationRequestKind.GetDefinedNamesInfo}]:[2,null];case 6:return c=O.sent(),c.kind!==ml.ComputationRequestKind.GetDefinedNamesInfo?(this.logFailure("failed to get named objects info"),[2,null]):(d=c.definedNamesInfo,f=d.find(function(w){return w.name===l.whole}),(f==null?void 0:f.reference)==null?[2,null]:[4,{kind:ml.ComputationRequestKind.ParseActiveCell,formulaText:f.reference}]);case 7:if(m=O.sent(),m.kind!==ml.ComputationRequestKind.ParseActiveCell||!(0,FO.isSuccess)(m.result)||m.result.value.kind!==BMe.EditKind.Formula)return[2,null];if(v=m.result.value.formula,!v.isWellFormed||v.node.kind!=="Lambda"||!v.node.isClosed)return[2,null];for(h=[],y=0,_=v.node.params;y<_.length;y++){if(E=_[y],N=E.name.arg.name,k=N.name,q=N.isBracketed,k.kind!=="Ident")return this.logFailure("unexpected parameter in lambda function: ".concat(k.kind)),[2,null];V=q?"[".concat(k.whole,"]"):k.whole,h.push(V)}return I=(0,n5.getActiveParamIndex)(a,o.assistedFunctionArgs,r.caretPosition,this.fixHandlingWhiteSpace),[2,{kind:"Minimal",functionName:l.whole,listSeparator:s,parameters:{params:h,activeParam:I}}];case 8:return[4,{kind:ml.ComputationRequestKind.GetFunctionInfo,functionName:l.whole}];case 9:return M=O.sent(),this.addTimeStamp("GetFunctionInfo"),M.kind!==ml.ComputationRequestKind.GetFunctionInfo?(this.logFailure("failed to get function info for ".concat(l.whole)),[2,null]):(B=new cMr.ResettableLazy(function(){return(0,n5.createFunctionRenderingInfo)(M.functionInfo,a,o.assistedFunctionArgs,r.caretPosition,l.id,s,b.fixHandlingWhiteSpace)}),U=sMr.functionExamples.getValue()[l.id],this.addTimeStamp("GetExampleString"),U===void 0?(this.logFailure("no example found for function: ".concat(l.whole,", id: ").concat(l.id)),this.addTimeStampAndLog("createFunctionRenderingInfoNoExample"),[2,B.getValue()]):[4,{kind:ml.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:U,kind:UMe.FormulaKind.CellFormula},useEnglishLocaleInfo:!0}]);case 10:return j=O.sent(),this.addTimeStamp("ParseExample"),j.kind!==ml.ComputationRequestKind.ParseCellFormula||!(0,FO.isSuccess)(j.result)?(this.logFailure("failed to parse example for function: ".concat(l.whole)),X=B.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseExample"),[2,X]):u.kind===ml.ComputationRequestKind.GetConfig&&u.config.localeInfo.lcid===fE.LCID.USA?(ee=(0,n5.createFunctionRenderingInfo)(M.functionInfo,a,o.assistedFunctionArgs,r.caretPosition,l.id,s,this.fixHandlingWhiteSpace,U,j.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoEnUs"),[2,ee]):[4,{kind:ml.ComputationRequestKind.PrintFormula,formula:j.result.value,origin:t.activeCell}];case 11:return re=O.sent(),this.addTimeStamp("localize example string"),re.kind!==ml.ComputationRequestKind.PrintFormula||!(0,FO.isSuccess)(re.result)?(this.logFailure("failed to pretty print localized example for function: ".concat(l.whole)),Z=B.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToPrintLocalizedExample"),[2,Z]):[4,{kind:ml.ComputationRequestKind.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:re.result.value,kind:UMe.FormulaKind.CellFormula},useEnglishLocaleInfo:!1}];case 12:return J=O.sent(),this.addTimeStamp("parse localized example string"),J.kind!==ml.ComputationRequestKind.ParseCellFormula||!(0,FO.isSuccess)(J.result)?(this.logFailure("failed to parse localized example for function: ".concat(l.whole)),C=B.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseLocalizedExample"),[2,C]):(S=(0,n5.createFunctionRenderingInfo)(M.functionInfo,a,o.assistedFunctionArgs,r.caretPosition,l.id,s,this.fixHandlingWhiteSpace,re.result.value,J.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoWithLocalizedExample"),[2,S])}})},e.prototype.logFailure=function(r){fE.ulsLogger.ULS.traceTag(545388683,fE.LogCategory.msoulscat_ES_EWAJS,fE.TraceLevel.Warning,"ArgumentAssistancePlugin encountered a failure with msg ".concat(r))},e.prototype.addTimeStampAndLog=function(r){this.addTimeStamp(r),this.logTimeStamp()},e.prototype.logTimeStamp=function(){this.timeStamps.set("Overall",this.timer.now()-this.runStartTime);var r={};this.timeStamps.forEach(function(t,n){r[n]=t}),fE.ulsLogger.ULS.traceTag(540377222,fE.LogCategory.msoulscat_ES_EWAJS,fE.TraceLevel.Info,"".concat(JSON.stringify(r)))},e.prototype.addTimeStamp=function(r){this.timeStamps.set(r,this.timer.now()-this.lastRunTime),this.lastRunTime=this.timer.now()},e}();(0,oMr.registerPluginFactory)(new WMe);NO.argumentAssistancePluginDependenciesResolved=(0,pMr.trackableAsyncLazy)(function(){return Ure.__awaiter(void 0,void 0,void 0,function(){var e;return Ure.__generator(this,function(r){switch(r.label){case 0:return(0,VMe.getTypedFeatureGate)("Microsoft.Office.Excel.ArgumentAssistanceOnMainThread")?[4,Bre.dynamicPluginLoaderCreated.getValue()]:[3,2];case 1:return e=r.sent(),[3,4];case 2:return[4,Bre.workerThreadSpread.getValue()];case 3:e=r.sent(),r.label=4;case 4:return[4,e.loadPluginScript("formula-authoring-strings",!0)];case 5:return r.sent(),[4,e.createAndAttachPlugin(jMe.PluginFactoryName.ArgumentAssistancePlugin)];case 6:return r.sent(),[4,Bre.schedulerWithRecalcServiceAttached.getValue()];case 7:return r.sent(),[2]}})})},"argumentAssistancePluginDependenciesResolved")});var Vre=T(i5=>{"use strict";p();Object.defineProperty(i5,"__esModule",{value:!0});i5.AutocompleteBaseVisitor=void 0;var gMr=fe(),a5=ti(),vMr=Db(),hMr=function(e){gMr.__extends(r,e);function r(t,n,a,o){var u=e.call(this,t,n)||this;return u.formulaString=a,u.autoCompleteForCellRefEnabled=o,u}return r.prototype.nameNode=function(t,n,a){return(t.kind===a5.NamePartKind.IdentNamePart||t.kind===a5.NamePartKind.FieldRefNamePart)&&this.updateAutocompleteString(a,t.asWhole),e.prototype.nameNode.call(this,t,n,a)},r.prototype.appNode=function(t,n,a,o){return this.autoCompleteForCellRefEnabled&&t.kind===a5.NodeKind.WSF&&this.updateAutocompleteString(o,t.whole),e.prototype.appNode.call(this,t,n,a,o)},r.prototype.cellRefNode=function(t,n,a){var o=this.parsedFormulaTree.spans[a];if(t.kind===a5.CellRefKind.Single&&o){var u=this.formulaString.substring(o.start,o.end);this.updateAutocompleteString(a,u)}return e.prototype.cellRefNode.call(this,t,n,a)},r.prototype.updateAutocompleteString=function(t,n){var a=this.parsedFormulaTree.spans[t].start,o=a+n.length;this.caretPosition===o&&(this.autocompleteString=n,this.stringEndPosition=o,this.stringStartPosition=a)},r}(vMr.CaretInsideArrayNodeIdentityVisitor);i5.AutocompleteBaseVisitor=hMr});var jre=T(kO=>{"use strict";p();Object.defineProperty(kO,"__esModule",{value:!0});kO.autocompleteFunctionPluginDependenciesResolved=kO.AutocompleteFunctionPluginFactory=void 0;var M2=fe(),o5=Xo(),SMr=yc(),OO=Gi(),yMr=zn(),_Mr=Us(),HMe=qd(),bMr=ks(),CMr=Wee(),TMr=ia(),XMe=ia(),zMe=XC(),RMr=Vre(),QMe=mi(),EMr=Ar(),PMr=Ms(),AMr=Ld(),YMe=function(){function e(){this.factoryName=XMe.PluginFactoryName.AutocompleteFunctionPlugin}return e.prototype.create=function(){return new FMr},e}();kO.AutocompleteFunctionPluginFactory=YMe;var FMr=function(){function e(){this.autoCompleteForCellRefEnabled=(0,QMe.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"),this.isEnumAutoCompleteFixEnabled=(0,QMe.isChangeGateEnabled)("OfficeVSO:8593118_AutoCompleteEnumDescriptions")}return e.prototype.run=function(r){var t,n,a,o,u,s,l,c,d,f,m,v,h,y,_;return M2.__generator(this,function(E){switch(E.label){case 0:return[4,{kind:o5.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return t=E.sent(),t.kind!==o5.ComputationRequestKind.ParseActiveCell||!(0,yMr.isSuccess)(t.result)?[2,null]:t.result.value.kind!==_Mr.EditKind.Formula?[2,null]:(n=t.result.value.formula,a=new RMr.AutocompleteBaseVisitor(n,r.caretPosition,r.content,this.autoCompleteForCellRefEnabled),(0,bMr.reduceBottomUp)(a,n),a.autocompleteString===void 0||a.stringStartPosition===void 0||a.stringEndPosition===void 0||a.isInsideArrayNode?[2,null]:(o=a.autocompleteString.toUpperCase(),u=a.stringStartPosition,s=a.stringEndPosition,[4,{kind:o5.ComputationRequestKind.GetFunctionsInfo}]));case 2:return l=E.sent(),l.kind!==o5.ComputationRequestKind.GetFunctionsInfo?(this.logFailure("failed to get functions info"),[2,null]):(c=l.functionsInfo,d=(0,zMe.filterSuggestionsAccordingToPrefix)(o,c,function(N){return N.NameDataStrings}),f=d.prefixedSuggestions,m=d.notPrefixedSuggestions,v=CMr.functionShortDescriptions.getValue(),(v===null||v.descriptionMap===null)&&this.logFailure("failed to get short descriptions, will show function info help description"),h=(0,zMe.getCompletedFunctionSuffix)(r.content,s),y=this.generateCompletionItems(f,v,u,s,!0,h),_=this.generateCompletionItems(m,v,u,s,!1,h),[2,{items:M2.__spreadArray(M2.__spreadArray([],y,!0),_,!0)}])}})},e.prototype.generateCompletionItems=function(r,t,n,a,o,u){var s=this,l=[],c=r.map(function(d){var f,m,v=d.FunctionIndexInServer.toString(),h=(0,PMr.isTypedChangeGateEnabled)("Microsoft.Office.Excel.UseObjectInsteadOfMapForFunctionShortDescriptions")?(f=t.descriptionMap)===null||f===void 0?void 0:f[v]:(m=t.descriptionMap)===null||m===void 0?void 0:m.get(v);return(0,EMr.isNone)(h)&&(l.push(d.FunctionIndexInServer),h=d.Help),{label:d.NameDataStrings,kind:TMr.CompletionItemKind.Function,detail:h,textEdit:{newText:d.NameDataStrings+u,range:{start:{line:0,character:n},end:{line:0,character:a}}},isPrefixed:o,shouldRequestAutocompleteOnCommit:s.isEnumAutoCompleteFixEnabled}});return l.length>0&&OO.ulsLogger.ULS.traceTag(508871621,OO.LogCategory.msoulscat_ES_EWAJS,OO.TraceLevel.Info,"AutocompleteFunctionPlugin missing short descriptions for func IDs: ".concat(JSON.stringify(l))),c},e.prototype.logFailure=function(r){OO.ulsLogger.ULS.traceTag(539083013,OO.LogCategory.msoulscat_ES_EWAJS,OO.TraceLevel.Warning,"AutocompleteFunctionPlugin encountered a failure with msg ".concat(r))},e}();(0,SMr.registerPluginFactory)(new YMe);kO.autocompleteFunctionPluginDependenciesResolved=(0,AMr.trackableAsyncLazy)(function(){return M2.__awaiter(void 0,void 0,void 0,function(){var e;return M2.__generator(this,function(r){switch(r.label){case 0:return[4,HMe.autoCompletePluginsThread.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript("formula-authoring-strings",!0)];case 2:return r.sent(),[4,e.createAndAttachPlugin(XMe.PluginFactoryName.AutocompleteFunctionPlugin)];case 3:return r.sent(),[4,HMe.schedulerWithRecalcServiceAttached.getValue()];case 4:return r.sent(),[2]}})})},"autocompleteFunctionPluginDependenciesResolved")});var JMe=T(u5=>{"use strict";p();Object.defineProperty(u5,"__esModule",{value:!0});u5.AutoCompleteEnumVisitor=void 0;var NMr=fe(),OMr=ti(),kMr=Db(),MMr=function(e){NMr.__extends(r,e);function r(t,n){return e.call(this,t,n)||this}return r.prototype.appNode=function(t,n,a,o){return t.kind===OMr.NodeKind.WSF&&this.updateAssistedFunctionAndArgIndex(t,n),e.prototype.appNode.call(this,t,n,a,o)},r.prototype.updateAssistedFunctionAndArgIndex=function(t,n){for(var a=0;a<n.length;a++){var o=this.parsedFormulaTree.spans[n[a].label];if(o&&o.start-o.pre.length<=this.caretPosition&&this.caretPosition<=o.end+o.post.length&&this.functionHead===void 0){this.functionHead=t,this.argIndex=a,this.functionArgs=n,this.stringStartPosition=o.start,this.stringEndPosition=o.end;break}}},r}(kMr.CaretInsideArrayNodeIdentityVisitor);u5.AutoCompleteEnumVisitor=MMr});var ZMe=T(s5=>{"use strict";p();Object.defineProperty(s5,"__esModule",{value:!0});s5.functionEnums=void 0;var pe=Qf(),xMr=hc(),em=_y();s5.functionEnums=new xMr.ResettableLazy(function(){var e;return e={},e[pe.WorksheetFuncId.ERROR_TYPE]={1:[{value:function(t){var n;return(n=t.errorNames[em.ErrorType.NULL])!==null&&n!==void 0?n:""},description:em.ErrorType.NULL.toString()},{value:function(t){var n;return(n=t.errorNames[em.ErrorType.DIV0])!==null&&n!==void 0?n:""},description:em.ErrorType.DIV0.toString()},{value:function(t){var n;return(n=t.errorNames[em.ErrorType.VALUE])!==null&&n!==void 0?n:""},description:em.ErrorType.VALUE.toString()},{value:function(t){var n;return(n=t.errorNames[em.ErrorType.REF])!==null&&n!==void 0?n:""},description:em.ErrorType.REF.toString()},{value:function(t){var n;return(n=t.errorNames[em.ErrorType.NAME])!==null&&n!==void 0?n:""},description:em.ErrorType.NAME.toString()},{value:function(t){var n;return(n=t.errorNames[em.ErrorType.NUM])!==null&&n!==void 0?n:""},description:em.ErrorType.NUM.toString()},{value:function(t){var n;return(n=t.errorNames[em.ErrorType.NA])!==null&&n!==void 0?n:""},description:em.ErrorType.NA.toString()}]},e[pe.WorksheetFuncId.SUBTOTAL]={1:[{value:"1",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNT)}},{value:"3",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNTA)}},{value:"4",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MAX)}},{value:"5",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MIN)}},{value:"6",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.PRODUCT)}},{value:"7",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.STDEV)}},{value:"8",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.STDEVP)}},{value:"9",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.SUM)}},{value:"10",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.VAR)}},{value:"11",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.VARP)}},{value:"101",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.AVERAGE)}},{value:"102",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNT)}},{value:"103",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNTA)}},{value:"104",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MAX)}},{value:"105",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MIN)}},{value:"106",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.PRODUCT)}},{value:"107",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.STDEV)}},{value:"108",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.STDEVP)}},{value:"109",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.SUM)}},{value:"110",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.VAR)}},{value:"111",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.VARP)}}]},e[pe.WorksheetFuncId.AGGREGATE]={1:[{value:"1",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNT)}},{value:"3",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNTA)}},{value:"4",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MAX)}},{value:"5",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MIN)}},{value:"6",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.PRODUCT)}},{value:"7",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.STDEV)}},{value:"8",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.STDEVP)}},{value:"9",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.SUM)}},{value:"10",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.VAR)}},{value:"11",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.VARP)}},{value:"12",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MEDIAN)}},{value:"13",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MODE_SNGL)}},{value:"14",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.LARGE)}},{value:"15",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.SMALL)}},{value:"16",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.PERCENTILE_INC)}},{value:"17",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.QUARTILE_INC)}},{value:"18",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.PERCENTILE_EXC)}},{value:"19",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.QUARTILE_EXC)}}],2:[{value:"0",description:function(t){return FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",t.getWorksheetFuncName(pe.WorksheetFuncId.SUBTOTAL)).replace("{1}",t.getWorksheetFuncName(pe.WorksheetFuncId.AGGREGATE))}},{value:"1",description:function(t){return FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",t.getWorksheetFuncName(pe.WorksheetFuncId.SUBTOTAL)).replace("{1}",t.getWorksheetFuncName(pe.WorksheetFuncId.AGGREGATE))}},{value:"2",description:function(t){return FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",t.getWorksheetFuncName(pe.WorksheetFuncId.SUBTOTAL)).replace("{1}",t.getWorksheetFuncName(pe.WorksheetFuncId.AGGREGATE))}},{value:"3",description:function(t){return FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValuesNestedSUBTOTALandAGGREGATEfunctions).replace("{0}",t.getWorksheetFuncName(pe.WorksheetFuncId.SUBTOTAL)).replace("{1}",t.getWorksheetFuncName(pe.WorksheetFuncId.AGGREGATE))}},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreNothing)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRows)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrorValues)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreHiddenRowsErrorValues)}]},e[pe.WorksheetFuncId.CUBESET]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.None)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaAscending)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaDescending)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalAscending)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NaturalDescending)}]},e[pe.WorksheetFuncId.VLOOKUP]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},e[pe.WorksheetFuncId.HLOOKUP]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ApproximateMatch)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)}]},e[pe.WorksheetFuncId.XLOOKUP]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},e[pe.WorksheetFuncId.RANK]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},e[pe.WorksheetFuncId.RANK_AVG]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},e[pe.WorksheetFuncId.RANK_EQ]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)}]},e[pe.WorksheetFuncId.MATCH]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LessThan)},{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GreaterThan)}]},e[pe.WorksheetFuncId.XMATCH]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatch)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextSmallerItem)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ExactMatchOrNextLargerItem)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WildcardCharacterMatch)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchFirstToLast)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SearchLastToFirst)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchAscending)},{value:"-2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BinarySearchDescending)}]},e[pe.WorksheetFuncId.FINDN]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}],7:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheFirstCharacterPositionOfTheString)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnsTheLastCharacterPositionOfTheString)}]},e[pe.WorksheetFuncId.TEXTBEFORE]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},e[pe.WorksheetFuncId.TEXTAFTER]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DontMatchToEnd)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MatchToEnd)}]},e[pe.WorksheetFuncId.TEXTSPLIT]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseSensitiveMatch)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CaseInsensitiveMatch)}]},e[pe.WorksheetFuncId.ACCRINT]={6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.ACCRINTM]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.ADDRESS]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)}],3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Absolute)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AbsoluteRowRelativeColumn)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RelativeRowAbsoluteColumn)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Relative)}]},e[pe.WorksheetFuncId.AMORDEGRC]={7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.AMORLINC]={7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.BETA_DIST]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.BINOMDIST]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[pe.WorksheetFuncId.BINOM_DIST]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[pe.WorksheetFuncId.CHISQ_DIST]={3:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.COMPLEX]={3:[{value:"i",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ISuffixDescriptionForComplexNumber)},{value:"j",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.JSuffixDescriptionForComplexNumber)}]},e[pe.WorksheetFuncId.COUPDAYBS]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.COUPDAYS]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.COUPDAYSNC]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.COUPNCD]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.COUPNUM]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.COUPPCD]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.CUMIPMT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[pe.WorksheetFuncId.CUMPRINC]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[pe.WorksheetFuncId.DAYS360]={3:[{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASDMethod)},{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EuropeanMethod)}]},e[pe.WorksheetFuncId.DISC]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.DURATION]={5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.EXPONDIST]={3:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.EXPON_DIST]={3:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.F_DIST]={3:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.FIXED]={3:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PreventCommas)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotPreventCommas)}]},e[pe.WorksheetFuncId.FV]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[pe.WorksheetFuncId.GAMMADIST]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.GAMMA_DIST]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.HYPGEOM_DIST]={5:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.INDIRECT]={2:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.A1Style)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.R1C1Style)}]},e[pe.WorksheetFuncId.INTRATE]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.IPMT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[pe.WorksheetFuncId.LINEST]={3:[{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},e[pe.WorksheetFuncId.LOGEST]={3:[{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}],4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnAdditionalRegressionStatistics)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotReturnAdditionalRegressionStatistics)}]},e[pe.WorksheetFuncId.LOGNORM_DIST]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.MDURATION]={5:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.NEGBINOM_DIST]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[pe.WorksheetFuncId.NORM_S_DIST]={2:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.NORMDIST]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[pe.WorksheetFuncId.NORM_DIST]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[pe.WorksheetFuncId.NPER]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[pe.WorksheetFuncId.ODDFPRICE]={8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.ODDFYIELD]={8:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.ODDLPRICE]={7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.ODDLYIELD]={7:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.PMT]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[pe.WorksheetFuncId.POISSON]={3:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[pe.WorksheetFuncId.POISSON_DIST]={3:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.probabilityMassFunction)}]},e[pe.WorksheetFuncId.PPMT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[pe.WorksheetFuncId.PRICE]={6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.PRICEDISC]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.PRICEMAT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.QUARTILE]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},e[pe.WorksheetFuncId.QUARTILE_INC]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MinimumValue)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MaximumValue)}]},e[pe.WorksheetFuncId.QUARTILE_EXC]={2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FirstQuartile)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MedianValue)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThirdQuartile)}]},e[pe.WorksheetFuncId.RATE]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[pe.WorksheetFuncId.RECEIVED]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.ROMAN]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Classic)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MoreConcise)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Simplified)}]},e[pe.WorksheetFuncId.STOCKHISTORY]={4:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Daily)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Weekly)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monthly)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NoHeader)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Showheader)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ShowInstrumentIdentifierAndHeader)}],6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],8:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],9:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],10:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}],11:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Date)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Close)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Open)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.High)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Low)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volume)}]},e[pe.WorksheetFuncId.TREND]={4:[{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},e[pe.WorksheetFuncId.TTEST]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},e[pe.WorksheetFuncId.T_TEST]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}],4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Paired)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleEqualVariance)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoSampleUnequalVariance)}]},e[pe.WorksheetFuncId.VDB]={7:[{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SwitchToStraightLineDepreciation)},{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.DoNotSwitchToStraightLineDepreciation)}]},e[pe.WorksheetFuncId.WEEKDAY]={2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers0Mondaythrough6Sunday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Mondaythrough7Sunday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Tuesdaythrough7Monday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Wednesdaythrough7Tuesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Thursdaythrough7Wednesday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Fridaythrough7Thursday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Saturdaythrough7Friday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Numbers1Sundaythrough7Saturday)}]},e[pe.WorksheetFuncId.WEIBULL]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.WEIBULL_DIST]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.YEARFRAC]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.YIELD]={6:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Annual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Semianual)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Quarterly)}],7:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.YIELDDISC]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.YIELDMAT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.USNASD30360)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ActualActual)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual360)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Actual365)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.European30360)}]},e[pe.WorksheetFuncId.GROWTH]={4:[{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsSetEqualTo0)},{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.bIsCalculatedNormally)}]},e[pe.WorksheetFuncId.PV]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.EndOfThePeriod)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BeginningOfThePeriod)}]},e[pe.WorksheetFuncId.TDIST]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OneTailedDistribution)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TwoTailedDistribution)}]},e[pe.WorksheetFuncId.T_DIST]={4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.cumulativeDistributionFunction)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ProbabilityDensityFunction)}]},e[pe.WorksheetFuncId.WEEKNUM]={2:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tuesday)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Wednesday)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Thursday)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Friday)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Saturday)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sunday)},{value:"21",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Monday)}]},e[pe.WorksheetFuncId.NETWORKDAYS_INTL]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},e[pe.WorksheetFuncId.WORKDAY_INTL]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdaySunday)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayMonday)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayTuesday)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayWednesday)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayThursday)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayFriday)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridaySaturday)},{value:"11",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SundayOnly)},{value:"12",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MondayOnly)},{value:"13",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TuesdayOnly)},{value:"14",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WednesdayOnly)},{value:"15",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThursdayOnly)},{value:"16",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FridayOnly)},{value:"17",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SaturdayOnly)}]},e[pe.WorksheetFuncId.FORECAST_ETS]={5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNT)}},{value:"3",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNTA)}},{value:"4",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MAX)}},{value:"5",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MIN)}},{value:"7",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.SUM)}}]},e[pe.WorksheetFuncId.FORECAST_ETS_CONFINT]={6:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],7:[{value:"1",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNT)}},{value:"3",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNTA)}},{value:"4",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MAX)}},{value:"5",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MIN)}},{value:"7",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.SUM)}}]},e[pe.WorksheetFuncId.FORECAST_ETS_SEASONALITY]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],4:[{value:"1",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNT)}},{value:"3",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNTA)}},{value:"4",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MAX)}},{value:"5",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MIN)}},{value:"7",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.SUM)}}]},e[pe.WorksheetFuncId.FORECAST_ETS_STAT]={4:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AlphaParameterOfETSalgorithm)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.BetaParameterOfETSalgorithm)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GammaParameterOfETSalgorithm)},{value:"4",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MASEMetric)},{value:"5",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMAPEMetric)},{value:"6",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MAEMetric)},{value:"7",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RMSEMetric)},{value:"8",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.StepSizeDetected)}],5:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MissingValuesTreatedAsZeroes)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AutomaticCompletionUsesLinearInterpolation)}],6:[{value:"1",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.AVERAGE)}},{value:"2",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNT)}},{value:"3",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.COUNTA)}},{value:"4",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MAX)}},{value:"5",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MEDIAN)}},{value:"6",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.MIN)}},{value:"7",description:function(t){return t.getWorksheetFuncName(pe.WorksheetFuncId.SUM)}}]},e[pe.WorksheetFuncId.TEXTJOIN]={2:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreEmptyCells)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IncludeEmptyCells)}]},e[pe.WorksheetFuncId.SORT]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}],4:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByColumn)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SortByRow)}]},e[pe.WorksheetFuncId.UNIQUE]={2:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueColumns)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnUniqueRows)}],3:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnitemsthatAppearExactlyOnce)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ReturnEveryDistinctItem)}]},e[pe.WorksheetFuncId.SORTBY]={3:[{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ascending)},{value:"-1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Descending)}]},e[pe.WorksheetFuncId.RANDARRAY]={5:[{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Integer)},{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Decimal)}]},e[pe.WorksheetFuncId.VALUETOTEXT]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},e[pe.WorksheetFuncId.ARRAYTOTEXT]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Concise)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Strict)}]},e[pe.WorksheetFuncId.TOCOL]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},e[pe.WorksheetFuncId.TOROW]={2:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.KeepAllValues)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanks)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreErrors)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.IgnoreBlanksAndErrors)}],3:[{value:function(t){return t.falseName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByRow)},{value:function(t){return t.trueName},description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ScanByColumn)}]},e[pe.WorksheetFuncId.IMAGE]={3:[{value:"0",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FitCell)},{value:"1",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FillCell)},{value:"2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.OriginalSize)},{value:"3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CustomSize)}]},e})});var exe=T(Zn=>{"use strict";p();Object.defineProperty(Zn,"__esModule",{value:!0});Zn.getConvertEnum=Zn.speedUnitTypeEnums=Zn.informationUnitTypeEnums=Zn.areaUnitTypeEnums=Zn.volumeUnitTypeEnums=Zn.temperatureUnitTypeEnums=Zn.magnetismUnitTypeEnums=Zn.powerUnitTypeEnums=Zn.energyUnitTypeEnums=Zn.forceUnitTypeEnums=Zn.pressureUnitTypeEnums=Zn.timeUnitTypeEnums=Zn.distanceUnitTypeEnums=Zn.massUnitTypeEnums=void 0;var rm=hc();Zn.massUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"g",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gram)},{value:"sg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Slug)},{value:"lbm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundM)},{value:"u",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atomic)},{value:"ozm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ozm)},{value:"grain",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Grain)},{value:"cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeight)},{value:"uk_cwt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.CWeightUk)},{value:"stone",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Stone)},{value:"ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ton)},{value:"uk_ton",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.TonUk)}]});Zn.distanceUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"m",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Meter)},{value:"mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMile)},{value:"Nmi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMile)},{value:"in",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Inch)},{value:"ft",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ft)},{value:"yd",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yd)},{value:"ang",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Angs)},{value:"Pica",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pica)},{value:"ell",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Ell)},{value:"ly",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYr)},{value:"parsec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Parsec)},{value:"survey_mi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MileUs)}]});Zn.timeUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"yr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Yr)},{value:"day",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Day)},{value:"hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hour)},{value:"mn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Minute)},{value:"sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Sec)}]});Zn.pressureUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"Pa",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pascal)},{value:"atm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Atmos)},{value:"mmHg",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Merc)},{value:"psi",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Psi)},{value:"Torr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Torr)}]});Zn.forceUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"N",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Newton)},{value:"dyn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Dyne)},{value:"lbf",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PoundF)},{value:"pond",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Pond)}]});Zn.energyUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"J",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Joule)},{value:"e",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Erg)},{value:"cal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ItCal)},{value:"eV",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Volt)},{value:"HPh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePwHr)},{value:"Wh",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.WattHr)},{value:"flb",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FtPound)},{value:"BTU",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Btu)},{value:"c",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThermCal)}]});Zn.powerUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"HP",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorsePw)},{value:"W",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Watt)},{value:"PS",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.HorseStr)}]});Zn.magnetismUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"T",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tessla)},{value:"ga",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gauss)}]});Zn.temperatureUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"C",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cels)},{value:"F",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Fahr)},{value:"K",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Kelv)},{value:"Rank",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Rankine)},{value:"Reau",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Reaumur)}]});Zn.volumeUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"tsp",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tsp)},{value:"tbs",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Tbs)},{value:"oz",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Oz)},{value:"cup",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Cup)},{value:"qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUs)},{value:"gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Gal)},{value:"l",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Liter)},{value:"uk_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUk)},{value:"us_pt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PintUs)},{value:"ang^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow3)},{value:"barrel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Barrel)},{value:"bushel",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bushel)},{value:"ft^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow3)},{value:"GRT",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.RegTon)},{value:"in^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow3)},{value:"ly^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow3)},{value:"mi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow3)},{value:"MTON",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeasTon)},{value:"Nmi^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow3)},{value:"Pica^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow3)},{value:"tspm",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MdnTsp)},{value:"uk_gal",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.GalUk)},{value:"yd^3",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow3)},{value:"uk_qt",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.QuartUk)}]});Zn.areaUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"uk_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUk)},{value:"us_acre",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AcreUs)},{value:"ang^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AngsPow2)},{value:"ar",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Are)},{value:"ft^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.FootPow2)},{value:"ha",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Hectare)},{value:"in^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.InchPow2)},{value:"ly^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.LightYrPow2)},{value:"m^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MeterPow2)},{value:"Morgen",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Morgen)},{value:"mi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SMilePow2)},{value:"Nmi^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.NMilePow2)},{value:"Pica^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.PicaPow2)},{value:"yd^2",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.YdPow2)}]});Zn.informationUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"bit",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Bit)},{value:"byte",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Byte)}]});Zn.speedUnitTypeEnums=new rm.ResettableLazy(function(){return[{value:"admkn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.AdmKnot)},{value:"kn",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.Knot)},{value:"m/hr",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashHr)},{value:"m/sec",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MSlashSec)},{value:"mph",description:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.MPH)}]});var $Me=new rm.ResettableLazy(function(){return[Zn.massUnitTypeEnums,Zn.distanceUnitTypeEnums,Zn.timeUnitTypeEnums,Zn.pressureUnitTypeEnums,Zn.forceUnitTypeEnums,Zn.energyUnitTypeEnums,Zn.powerUnitTypeEnums,Zn.magnetismUnitTypeEnums,Zn.temperatureUnitTypeEnums,Zn.volumeUnitTypeEnums,Zn.areaUnitTypeEnums,Zn.informationUnitTypeEnums,Zn.speedUnitTypeEnums]});function IMr(e,r,t,n){var a,o=$Me.getValue().map(function(l){return l.getValue()}),u=(a=[]).concat.apply(a,o);if(e===2)return u;if(e===3){var s=wMr(r,t,n);return s.length>0?s:u}return[]}Zn.getConvertEnum=IMr;function wMr(e,r,t){var n,a=e.spans[t[1].label].start,o=e.spans[t[1].label].end,u=(n=r.substring(a,o).replace(/^"|"$/g,""))!==null&&n!==void 0?n:"";if(u==="")return[];for(var s=0,l=$Me.getValue();s<l.length;s++){var c=l[s];if(c.getValue().find(function(d){return d.value===u}))return c.getValue()}return[]}});var zre=T(MO=>{"use strict";p();Object.defineProperty(MO,"__esModule",{value:!0});MO.autocompleteEnumPluginDependenciesResolved=MO.AutocompleteEnumPluginFactory=void 0;var I2=fe(),l5=Xo(),DMr=yc(),Wre=Gi(),LMr=zn(),qMr=Us(),rxe=qd(),GMr=ks(),BMr=XC(),UMr=JMe(),txe=Ar(),KMr=ZMe(),VMr=exe(),x2=Qf(),Hre=ia(),jMr=Ld(),nxe=function(){function e(){this.factoryName=Hre.PluginFactoryName.AutocompleteEnumPlugin}return e.prototype.create=function(){return new WMr},e}();MO.AutocompleteEnumPluginFactory=nxe;var WMr=function(){function e(){}return e.prototype.run=function(r){var t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N,k,q;return I2.__generator(this,function(V){switch(V.label){case 0:return[4,{kind:l5.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return t=V.sent(),t.kind!==l5.ComputationRequestKind.ParseActiveCell||!(0,LMr.isSuccess)(t.result)?[2,null]:t.result.value.kind!==qMr.EditKind.Formula?[2,null]:(n=t.result.value.formula,a=new UMr.AutoCompleteEnumVisitor(n,r.caretPosition),(0,GMr.reduceBottomUp)(a,n),a.stringStartPosition===void 0||a.stringEndPosition===void 0||a.functionHead===void 0||a.argIndex===void 0||a.functionArgs===void 0||a.isInsideArrayNode?[2,null]:(o=a.argIndex+1,u=a.stringStartPosition,s=a.stringEndPosition,l=a.functionHead,c=r.caretPosition===s?r.content.substring(u,s).toUpperCase():"",d=void 0,l.id===x2.WorksheetFuncId.CONVERT?d=(0,VMr.getConvertEnum)(o,n,r.content,a.functionArgs):(f=KMr.functionEnums.getValue(),d=this.getEnumInfoByArg(o,f,l.id)),(0,txe.isNone)(d)?[2,null]:[4,{kind:l5.ComputationRequestKind.GetConfig}]));case 2:return m=V.sent(),m.kind!==l5.ComputationRequestKind.GetConfig?(this.logFailure("failed to get config"),[2,null]):(v=m.config.localeInfo,h=this.getLocalizedEnumInfo(d,v),h.length===0?(this.logFailure("failed to get enum info for values/descriptions"),[2,null]):(y=this.getFilteredEnumInfo(c,l.id,h),_=y.prefixedEnumInfo,E=y.notPrefixedEnumInfo,N=this.shouldAddDoubleQuotes(l.id),k=this.generateCompletionItems(_,u,s,!0,N),q=this.generateCompletionItems(E,u,s,!1,N),[2,{items:I2.__spreadArray(I2.__spreadArray([],k,!0),q,!0)}]))}})},e.prototype.generateCompletionItems=function(r,t,n,a,o){var u=r.map(function(s){var l=o?'"'.concat(s.value,'"'):s.value;return{label:l,kind:Hre.CompletionItemKind.Enum,detail:s.description,textEdit:{newText:l,range:{start:{line:0,character:t},end:{line:0,character:n}}},isPrefixed:a}});return u},e.prototype.getFilteredEnumInfo=function(r,t,n){var a=[],o=[],u=r.replace(/^"|"$/g,"");if(this.shouldAddDoubleQuotes(t)&&r.endsWith('"')&&r.startsWith('"'))a=n.filter(function(l){return l.value.toUpperCase()===u});else{var s=(0,BMr.filterSuggestionsAccordingToPrefix)(u,n,function(l){return l.value});a=s.prefixedSuggestions,o=s.notPrefixedSuggestions}return a.length===0&&o.length===0&&o.push.apply(o,n),{prefixedEnumInfo:a,notPrefixedEnumInfo:o}},e.prototype.getEnumInfoByArg=function(r,t,n){var a=t[n];if(!(0,txe.isNone)(a))return a[r]},e.prototype.getLocalizedEnumInfo=function(r,t){var n=r.map(function(u){var s={value:typeof u.value=="function"?u.value(t):u.value,description:typeof u.description=="function"?u.description(t):u.description};return s}),a=n.length,o=n.filter(function(u){var s=u.value,l=u.description;return s!==void 0&&l!==void 0&&s!==""&&s!=="undefined"});return r.length!==a&&this.logFailure("failed to get enum info for some values"),o},e.prototype.shouldAddDoubleQuotes=function(r){return r===x2.WorksheetFuncId.COMPLEX||r===x2.WorksheetFuncId.INFO||r===x2.WorksheetFuncId.CONVERT||r===x2.WorksheetFuncId.CELL},e.prototype.logFailure=function(r){Wre.ulsLogger.ULS.traceTag(508350686,Wre.LogCategory.msoulscat_ES_EWAJS,Wre.TraceLevel.Warning,"AutocompleteEnumPlugin encountered a failure with msg ".concat(r))},e}();(0,DMr.registerPluginFactory)(new nxe);MO.autocompleteEnumPluginDependenciesResolved=(0,jMr.trackableAsyncLazy)(function(){return I2.__awaiter(void 0,void 0,void 0,function(){var e;return I2.__generator(this,function(r){switch(r.label){case 0:return[4,rxe.autoCompletePluginsThread.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript("formula-authoring-strings",!0)];case 2:return r.sent(),[4,e.createAndAttachPlugin(Hre.PluginFactoryName.AutocompleteEnumPlugin)];case 3:return r.sent(),[4,rxe.schedulerWithRecalcServiceAttached.getValue()];case 4:return r.sent(),[2]}})})},"autocompleteEnumPluginDependenciesResolved")});var axe=T(c5=>{"use strict";p();Object.defineProperty(c5,"__esModule",{value:!0});c5.AutocompleteLetVisitor=void 0;var HMr=fe(),zMr=ti(),QMr=Db(),XMr=function(e){HMr.__extends(r,e);function r(t,n,a,o){var u=e.call(this,a,o)||this;return u.autoCompleteForCellRefEnabled=t,u.formulaString=n,u}return r.prototype.nameNode=function(t,n,a){return this.updateCaretNodeText(a,t.asWhole),e.prototype.nameNode.call(this,t,n,a)},r.prototype.cellRefNode=function(t,n,a){var o=this.parsedFormulaTree.spans[a];if(this.autoCompleteForCellRefEnabled&&t.kind===zMr.CellRefKind.Single&&o){var u=this.formulaString.substring(o.start,o.end);this.updateCaretNodeText(a,u)}return e.prototype.cellRefNode.call(this,t,n,a)},r.prototype.updateCaretNodeText=function(t,n){var a,o=(a=this.parsedFormulaTree.spans[t])===null||a===void 0?void 0:a.end;o!==void 0&&this.caretPosition===o&&n.length>0&&(this.caretNodeText=n)},r}(QMr.ExtractLetVisitor);c5.AutocompleteLetVisitor=XMr});var Qre=T(xO=>{"use strict";p();Object.defineProperty(xO,"__esModule",{value:!0});xO.autocompleteLetPluginDependenciesResolved=xO.AutocompleteLetPluginFactory=void 0;var w2=fe(),ixe=Xo(),YMr=yc(),JMr=zn(),ZMr=Us(),oxe=qd(),$Mr=ks(),exr=axe(),rxr=XC(),txr=mi(),d5=ia(),nxr=Ld(),uxe=function(){function e(){this.factoryName=d5.PluginFactoryName.AutocompleteLetPlugin}return e.prototype.create=function(){return new axr},e}();xO.AutocompleteLetPluginFactory=uxe;var axr=function(){function e(){this.autoCompleteForCellRefEnabled=(0,txr.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef")}return e.prototype.run=function(r){var t,n,a,o,u,s,l,c,d,f,m,v,h,y;return w2.__generator(this,function(_){switch(_.label){case 0:return[4,{kind:ixe.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return t=_.sent(),t.kind!==ixe.ComputationRequestKind.ParseActiveCell||!(0,JMr.isSuccess)(t.result)?[2,null]:t.result.value.kind!==ZMr.EditKind.Formula?[2,null]:(n=t.result.value.formula,a=r.caretPosition,o=new exr.AutocompleteLetVisitor(this.autoCompleteForCellRefEnabled,r.content,n,a),(0,$Mr.reduceBottomUp)(o,n),u=o.references.reverse(),s=Array.from(new Set(u)),l=o.caretNodeText,l===void 0||o.isInsideArrayNode?[2,null]:(c=a,d=c-l.length,f=(0,rxr.filterSuggestionsAccordingToPrefix)(l,s),m=f.prefixedSuggestions,v=f.notPrefixedSuggestions,h=this.stringsToCompletionItems(m,d,c,!0),y=this.stringsToCompletionItems(v,d,c,!1),[2,{items:w2.__spreadArray(w2.__spreadArray([],h,!0),y,!0)}]))}})},e.prototype.stringsToCompletionItems=function(r,t,n,a){return r.map(function(o){return{label:o,kind:d5.CompletionItemKind.LetVariable,type:d5.SuggestionKind.Simple,textEdit:{newText:o,range:{start:{line:0,character:t},end:{line:0,character:n}}},isPrefixed:a}})},e}();(0,YMr.registerPluginFactory)(new uxe);xO.autocompleteLetPluginDependenciesResolved=(0,nxr.trackableAsyncLazy)(function(){return w2.__awaiter(void 0,void 0,void 0,function(){var e;return w2.__generator(this,function(r){switch(r.label){case 0:return[4,oxe.autoCompletePluginsThread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(d5.PluginFactoryName.AutocompleteLetPlugin)];case 2:return r.sent(),[4,oxe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})},"autocompleteLetPluginDependenciesResolved")});var cxe=T(f5=>{"use strict";p();Object.defineProperty(f5,"__esModule",{value:!0});f5.AutocompleteRichValueVisitor=void 0;var ixr=fe(),Fv=Ar(),Xre=Gi(),tm=ti(),oxr=ia(),uxr=mi(),sxr=Ms(),sxe=uE(),lxr=Db(),cxr=function(e){ixr.__extends(r,e);function r(t,n,a,o,u){var s=e.call(this,t,n)||this;return s.formulaText=a,s.definedNames=o,s.activeCell=u,s.dotNotationPath="",s.richValueItemPrefix="",s.dotNotationIndex=0,s.shouldAddEmptySuggestion=!1,s.onlySendNestedDotNotationPathEnabled=(0,sxr.isTypedChangeGateEnabled)("OfficeVSO:6476056_OnlySendNestedDotNotationPath"),s.passLogFunctionToGetRangeFromCellRef=(0,uxr.isChangeGateEnabled)("OfficeVSO:7251290_PassLogFunctionToGetRangeFromCellRef"),s}return r.prototype.nameNode=function(t,n,a){var o,u,s=(o=this.parsedFormulaTree.spans[a])===null||o===void 0?void 0:o.end;if(s===this.caretPosition&&t.kind===tm.NamePartKind.IdentNamePart&&this.trySetDefinedName(t)&&(this.dotNotationIndex=s,this.childFieldRefLabel=a),t.kind===tm.NamePartKind.FieldRefNamePart){var l=(u=this.parsedFormulaTree.spans[t.lhs.label])===null||u===void 0?void 0:u.end;if((0,Fv.isDefined)(l)&&(this.caretPosition===s||this.isCaretAfterDotBeforeStartOfFieldRef(l,t.rhs)&&t.lhs.kind!==tm.NamePartKind.FieldRefNamePart)){var c=!1;t.lhs.kind===tm.NamePartKind.CellRefNamePart?(this.setCellRef(t.lhs.ref,n),c=!0):t.lhs.kind===tm.NamePartKind.IdentNamePart&&this.trySetDefinedName(t.lhs)&&(c=!0),c&&(this.dotNotationIndex=l,t.rhs.field.kind===tm.NodeKind.Ident&&(this.caretPosition===s?this.richValueItemPrefix=t.rhs.field.whole:this.fieldRefChainEndIndex=s))}}return e.prototype.nameNode.call(this,t,n,a)},r.prototype.cellRefNode=function(t,n,a){var o,u=(o=this.parsedFormulaTree.spans[a])===null||o===void 0?void 0:o.end;return u!==void 0&&this.caretPosition===u&&(this.setCellRef(t,n),this.dotNotationIndex=u,this.childFieldRefLabel=a,this.shouldAddEmptySuggestion=!0),e.prototype.cellRefNode.call(this,t,n,a)},r.prototype.fieldRefNode=function(t,n,a){var o,u,s=(o=this.parsedFormulaTree.spans[a])===null||o===void 0?void 0:o.end,l=(u=this.parsedFormulaTree.spans[t.label])===null||u===void 0?void 0:u.end;return s===void 0||l===void 0?e.prototype.fieldRefNode.call(this,t,n,a):(this.isCaretAtEndOfFieldRefNode(s,n)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(t,a),this.dotNotationIndex=l,this.richValueItemPrefix=lxe(n)):this.isCaretAfterDotBeforeStartOfFieldRef(l,n)?(this.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath(t,a),this.dotNotationIndex=l,this.fieldRefChainEndIndex=s):t.label===this.childFieldRefLabel&&(this.fieldRefChainEndIndex=s,this.childFieldRefLabel=a),e.prototype.fieldRefNode.call(this,t,n,a))},r.prototype.structRefNode=function(t,n,a){var o,u=e.prototype.structRefNode.call(this,t,n,a),s=(o=this.parsedFormulaTree.spans[a])===null||o===void 0?void 0:o.end;if(this.caretPosition===s&&(0,Fv.isDefined)(t)&&n.isClosed&&u.kind===tm.NodeKind.StructRef){var l=this.definedNames.some(function(c){return c.type===oxr.DefinedNameInfoType.Table&&(0,Fv.isDefined)(c.name)&&c.name.toLowerCase()===t.whole.toLowerCase()});l&&(this.setNamedNodeRef(u),this.dotNotationIndex=s)}return u},r.prototype.initCellRefAtFieldsRefsChainStartAndAccumulateDotNotationPath=function(t,n){for(var a=t;a.kind===tm.NodeKind.FieldRef;)this.dotNotationPath=dxr(a.rhs)+"."+this.dotNotationPath,a=a.lhs;a.kind===tm.NodeKind.CellRef&&this.setCellRef(a.ref,a.qualifier),a.kind===tm.NodeKind.StructRef&&this.setNamedNodeRef(a),a.kind===tm.NodeKind.Name&&this.trySetDefinedName(a.parts),this.childFieldRefLabel=n},r.prototype.getRefString=function(t){var n,a,o=(n=this.parsedFormulaTree.spans[t])===null||n===void 0?void 0:n.start,u=(a=this.parsedFormulaTree.spans[t])===null||a===void 0?void 0:a.end;return(0,Fv.isDefined)(o)&&(0,Fv.isDefined)(u)&&o>=0&&u<this.formulaText.length?this.formulaText.substring(o,u):""},r.prototype.setCellRef=function(t,n){var a=this;(t.kind===tm.CellRefKind.Single||t.kind===tm.CellRefKind.Range)&&(this.cellRef=(0,sxe.getRangeFromCellRef)(t,this.activeCell,this.passLogFunctionToGetRangeFromCellRef?Yre:void 0)),(0,Fv.isDefined)(n)&&(this.sheetName=(0,sxe.getSheetNameFromQualifier)(n,Yre)),this.trySetDotNotationPathOrigin(function(){return a.getRefString(t.label)})},r.prototype.setNamedNodeRef=function(t){var n=this;this.namedRangeNode=t,this.trySetDotNotationPathOrigin(function(){return n.getRefString(t.label)})},r.prototype.isCaretAfterDotBeforeStartOfFieldRef=function(t,n){var a;if(!(0,Fv.isDefined)(n))return!1;var o=(a=this.parsedFormulaTree.spans[n.field.label])===null||a===void 0?void 0:a.start;return o!==void 0&&this.caretPosition>t&&(this.caretPosition<o||!n.isBracketed&&this.caretPosition===o)},r.prototype.isCaretAtEndOfFieldRefNode=function(t,n){var a;if(this.caretPosition===t)return!0;var o=(a=this.parsedFormulaTree.spans[n.field.label])===null||a===void 0?void 0:a.end;return!!((0,Fv.isDefined)(o)&&this.caretPosition===o)},r.prototype.trySetDefinedName=function(t){if(t.canDenoteNamedObject){var n=this.definedNames.find(function(a){var o;return((o=a.name)===null||o===void 0?void 0:o.toLowerCase())===t.asWhole.toLowerCase()});if((0,Fv.isDefined)(n))return this.setDefinedName(n),!0}return!1},r.prototype.setDefinedName=function(t){var n,a=t.namedRange;if((0,Fv.isDefined)(a)){var o=(n=t.sheetName)!==null&&n!==void 0?n:a.sheetName;(0,Fv.isDefined)(o)&&(this.sheetName=o),this.cellRef={firstRow:a.top-1,firstColumn:a.left-1,lastRow:a.bottom-1,lastColumn:a.right-1},this.trySetDotNotationPathOrigin(function(){return t.name})}},r.prototype.trySetDotNotationPathOrigin=function(t){if(this.onlySendNestedDotNotationPathEnabled){if(this.dotNotationPath.length>0){var n=t();(0,Fv.isDefined)(n)?this.dotNotationPath=n+"."+this.dotNotationPath:Yre("tryUpdateDotNotationPath with undefined name")}}else this.dotNotationPath=t()+(this.dotNotationPath.length>0?"."+this.dotNotationPath:"")},r}(lxr.CaretInsideArrayNodeIdentityVisitor);f5.AutocompleteRichValueVisitor=cxr;function dxr(e){return"["+lxe(e)+"]"}function lxe(e){return e.field.kind!==tm.NodeKind.Ident?"":e.field.whole}function Yre(e){Xre.ulsLogger.ULS.traceTag(523257827,Xre.LogCategory.msoulscat_ES_EWAJS,Xre.TraceLevel.Warning,"AutocompleteRichValueVisitor failed with msg: ".concat(e))}});var fxe=T(IO=>{"use strict";p();Object.defineProperty(IO,"__esModule",{value:!0});IO.parseFieldRef=IO.isUnbracketedField=void 0;var dxe=Jf();IO.isUnbracketedField=dxe.parseFieldRefModule.isUnbracketedField;IO.parseFieldRef=dxe.parseFieldRefModule.parseFieldRef});var Jre=T(wO=>{"use strict";p();Object.defineProperty(wO,"__esModule",{value:!0});wO.autocompleteRichValuePluginDependenciesResolved=wO.AutocompleteRichValuePluginFactory=void 0;var v1=fe(),nm=Xo(),fxr=yc(),pxe=qd(),gxe=ia(),pxr=cxe(),p5=zn(),mxr=Us(),gxr=ks(),vxr=qi(),P_=Ar(),hxr=Ba(),mxe=dL(),Sxr=XC(),yxr=kA(),vxe=ia(),_xr=fxe(),bxr=mi(),Cxr=Ld(),hxe=function(){function e(){this.factoryName=vxe.PluginFactoryName.AutocompleteRichValuePlugin}return e.prototype.create=function(){return new Txr},e}();wO.AutocompleteRichValuePluginFactory=hxe;var Txr=function(){function e(){this.dontAlwaysAddBracketsEnabled=(0,bxr.isChangeGateEnabled)("OfficeVSO:7765276_RichValueAutoCompleteDontAlwayAddBrackets")}return e.prototype.run=function(r){var t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N,k,q,V,I,M,B,U,j,X,ee;return v1.__generator(this,function(re){switch(re.label){case 0:return(0,P_.isNone)(r.content)||(0,P_.isNone)(r.caretPosition)?(A_("missing request arguments"),[2,null]):[4,{kind:nm.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return t=re.sent(),t.kind!==nm.ComputationRequestKind.ParseActiveCell||!(0,p5.isSuccess)(t.result)?[2,null]:t.result.value.kind!==mxr.EditKind.Formula?[2,null]:(n=t.result.value.formula,[4,{kind:nm.ComputationRequestKind.GetDefinedNamesInfo}]);case 2:return a=re.sent(),a.kind!==nm.ComputationRequestKind.GetDefinedNamesInfo?(A_("failed to get named objects info"),[2,null]):[4,{kind:nm.ComputationRequestKind.GetActiveCell}];case 3:return o=re.sent(),o.kind!==nm.ComputationRequestKind.GetActiveCell?(A_("failed to get active cell"),[2,null]):(u=o.activeCell,s=new pxr.AutocompleteRichValueVisitor(n,r.caretPosition,r.content,a.definedNamesInfo,u.range),(0,gxr.reduceBottomUp)(s,n),s.isInsideArrayNode?[2,null]:(c=void 0,(0,P_.isDefined)(s.cellRef)?(l=s.cellRef,c=u.sheet.index,[3,6]):[3,4]));case 4:return(0,P_.isDefined)(s.namedRangeNode)?(d={originGridCell:(0,p5.success)(u.range),originSheet:(0,p5.success)(u.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},[4,{kind:nm.ComputationRequestKind.ResolveReferences,nodes:[s.namedRangeNode],locals:d}]):[3,6];case 5:f=re.sent(),f.kind===nm.ComputationRequestKind.ResolveReferences&&(m=f.resolverResults[0],m.kind===yxr.ResolvedKind.ResolvedStructRef&&(0,p5.isSuccess)(m.resolution)&&m.resolution.value!==void 0&&(v=m.resolution.value.range,l={firstRow:v.row,firstColumn:v.col,lastRow:v.row+v.rows-1,lastColumn:v.col+v.cols-1},c=m.resolution.value.sheet.index)),re.label=6;case 6:return(0,P_.isDefined)(l)?(h=s.dotNotationPath,(0,P_.isNone)(h)?(A_("failed to parse cellRef"),[2,null]):(y="",(0,P_.isDefined)(s.sheetName)?(y=s.sheetName,[3,9]):[3,7])):[2,null];case 7:return[4,{kind:nm.ComputationRequestKind.GetSheetNames}];case 8:if(_=re.sent(),_.kind!==nm.ComputationRequestKind.GetSheetNames)return A_("failed to get sheet names"),[2,null];if(!(0,vxr.isDocumentLocEqual)(u.sheet.document,_.document))return A_("sheet names document is different than that of active cell"),[2,null];if(!(0,P_.isDefined)(c))return A_("sheet index is undefined"),[2,null];y=_.sheets[_.idToIndex[c]].sheetName,re.label=9;case 9:return E=v1.__assign(v1.__assign({},l),{sheetName:y,namedObjectName:""}),[4,{kind:nm.ComputationRequestKind.GetRichValueFieldListContext,rangeToQuery:E,dotNotationPath:h,singleColumn:!1,findRange:!1}];case 10:return N=re.sent(),N.kind!==nm.ComputationRequestKind.GetRichValueFieldListContext?(A_("failed to get field list context data"),[2,null]):(0,P_.isNone)(N.result)||N.result.length===0?[2,null]:(N.result.length>1&&A_("fieldListContextRequest results length greater than 1"),k=(0,Sxr.filterSuggestionsAccordingToPrefix)(s.richValueItemPrefix,N.result[0].FieldInfoDataList,function(Z){return Z.Name},!0),q=k.prefixedSuggestions,V=k.notPrefixedSuggestions,[4,{kind:nm.ComputationRequestKind.GetConfig}]);case 11:return I=re.sent(),M=this.resultsToCompletionItems(q,!0,s.dotNotationIndex,(j=s.fieldRefChainEndIndex)!==null&&j!==void 0?j:r.caretPosition,I,!!s.namedRangeNode),B=this.resultsToCompletionItems(V,!1,s.dotNotationIndex,(X=s.fieldRefChainEndIndex)!==null&&X!==void 0?X:r.caretPosition,I,!!s.namedRangeNode),U=v1.__spreadArray(v1.__spreadArray([],M,!0),B,!0),s.shouldAddEmptySuggestion&&(U=v1.__spreadArray([Rxr(s.dotNotationIndex,(ee=s.fieldRefChainEndIndex)!==null&&ee!==void 0?ee:r.caretPosition)],U,!0)),[2,{items:U}]}})},e.getTextToCommit=function(r,t,n,a){var o=r.Name;if(o=o.replace("'","''"),o=o.replace("[","'["),o=o.replace("]","']"),r.RefersToDotFunction)return".".concat(o);if(n){if(a)return".[".concat(o,"]");var u=t.kind===nm.ComputationRequestKind.GetConfig?t.config.localeInfo:void 0;return u&&!(0,_xr.isUnbracketedField)(u,o)?".[".concat(o,"]"):".".concat(o)}return".[".concat(o,"]")},e.prototype.resultsToCompletionItems=function(r,t,n,a,o,u){var s=this;return r.map(function(l){return{label:l.Name,kind:gxe.CompletionItemKind.RichEntity,detail:"",textEdit:{newText:e.getTextToCommit(l,o,s.dontAlwaysAddBracketsEnabled,u),range:{start:{line:0,character:n},end:{line:0,character:a}}},isPrefixed:t}})},e}();function Rxr(e,r){return{label:"",kind:gxe.CompletionItemKind.RichEntityEmptyCellRef,detail:"",textEdit:{newText:"",range:{start:{line:0,character:e},end:{line:0,character:r}}},isPrefixed:!0}}function A_(e){hxr.ulsLogger.ULS.traceTag(529056660,mxe.LogCategory.msoulscat_ES_EWAJS,mxe.TraceLevel.Warning,"AutocompleteRichValuePlugin encountered a failure with msg ".concat(e))}(0,fxr.registerPluginFactory)(new hxe);wO.autocompleteRichValuePluginDependenciesResolved=(0,Cxr.trackableAsyncLazy)(function(){return v1.__awaiter(void 0,void 0,void 0,function(){var e;return v1.__generator(this,function(r){switch(r.label){case 0:return[4,pxe.dynamicPluginLoaderCreated.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(vxe.PluginFactoryName.AutocompleteRichValuePlugin)];case 2:return r.sent(),[4,pxe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})},"autocompleteRichValuePluginDependenciesResolved")});var ete=T(LO=>{"use strict";p();Object.defineProperty(LO,"__esModule",{value:!0});LO.autocompleteNamedObjectsPluginDependenciesResolved=LO.AutocompleteNamedObjectsPluginFactory=void 0;var Zh=fe(),DO=Xo(),Exr=yc(),Zre=Gi(),Sxe=zn(),yxe=Us(),_xe=qd(),F_=ia(),Pxr=Vre(),Axr=ks(),bxe=XC(),m5=Ar(),h1=ia(),$re=mi(),Cxe=ia(),Fxr=Ld(),Txe=function(){function e(){this.factoryName=Cxe.PluginFactoryName.AutocompleteNamedObjectsPlugin}return e.prototype.create=function(){return new Nxr},e}();LO.AutocompleteNamedObjectsPluginFactory=Txe;var Nxr=function(){function e(){this.autoCompleteForCellRefEnabled=(0,$re.isChangeGateEnabled)("OfficeVSO:6212698_fixFunctionAutoCompleteForCellRef"),this.newNamedObjectsEnabled=(0,$re.getBooleanFeatureGate)("Microsoft.Office.Excel.FormulaAuthoringWithNameManager",!1)&&(0,$re.getBooleanFeatureGate)("Microsoft.Office.Excel.XLONameManager",!1)}return e.prototype.run=function(r){var t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N,k,q,V,I;return Zh.__generator(this,function(M){switch(M.label){case 0:return[4,{kind:DO.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return t=M.sent(),t.kind!==DO.ComputationRequestKind.ParseActiveCell||!(0,Sxe.isSuccess)(t.result)?[2,null]:t.result.value.kind!==yxe.EditKind.Formula?[2,null]:(n=t.result.value.formula,[4,{kind:DO.ComputationRequestKind.GetDefinedNamesInfo}]);case 2:if(a=M.sent(),a.kind!==DO.ComputationRequestKind.GetDefinedNamesInfo)return this.logFailure("failed to get named objects info"),[2,null];if(o=a.definedNamesInfo,u=new Pxr.AutocompleteBaseVisitor(n,r.caretPosition,r.content,this.autoCompleteForCellRefEnabled),(0,Axr.reduceBottomUp)(u,n),s=u.autocompleteString,l=u.stringStartPosition,c=u.stringEndPosition,d=u.isInsideArrayNode,!(0,m5.isDefined)(s)||!(0,m5.isDefined)(c)||!(0,m5.isDefined)(l)||d)return[2,null];if(f=(0,bxe.filterSuggestionsAccordingToPrefix)(s,o,function(B){return B.name}),m=f.prefixedSuggestions,v=f.notPrefixedSuggestions,!this.newNamedObjectsEnabled)return[3,7];h=Zh.__spreadArray(Zh.__spreadArray([],m.map(function(B){return Zh.__assign(Zh.__assign({},B),{isPrefixed:!0})}),!0),v.map(function(B){return Zh.__assign(Zh.__assign({},B),{isPrefixed:!1})}),!0),y=0,_=h,M.label=3;case 3:return y<_.length?(E=_[y],(0,m5.isNone)(E.reference)||E.type!==h1.DefinedNameInfoType.Other?[3,5]:[4,{kind:DO.ComputationRequestKind.ParseActiveCell,formulaText:E.reference}]):[3,6];case 4:if(N=M.sent(),N.kind!==DO.ComputationRequestKind.ParseActiveCell||!(0,Sxe.isSuccess)(N.result)||N.result.value.kind!==yxe.EditKind.Formula)return[2,null];k=N.result.value.formula,k.isWellFormed&&k.node.kind==="Lambda"&&k.node.isClosed&&(E.type=h1.DefinedNameInfoType.Lambda),M.label=5;case 5:return y++,[3,3];case 6:return q=(0,bxe.getCompletedFunctionSuffix)(r.content,c),[2,{items:this.namesToCompletionItems(h,l,c,q)}];case 7:return V=this.namesToCompletionItemsOld(m,l,c,!0),I=this.namesToCompletionItemsOld(v,l,c,!1),[2,{items:Zh.__spreadArray(Zh.__spreadArray([],V,!0),I,!0)}]}})},e.prototype.namesToCompletionItemsOld=function(r,t,n,a){return r.filter(function(o){return o.type!==h1.DefinedNameInfoType.Invalid}).map(function(o){return{label:o.name,kind:o.type===h1.DefinedNameInfoType.NamedRange?F_.CompletionItemKind.NamedRange:F_.CompletionItemKind.Table,type:F_.SuggestionKind.Simple,textEdit:{newText:o.name,range:{start:{line:0,character:t},end:{line:0,character:n}}},detail:o.tooltip,isPrefixed:a}})},e.prototype.namesToCompletionItems=function(r,t,n,a){return r.filter(function(o){return o.type!==h1.DefinedNameInfoType.Invalid}).map(function(o){var u=Oxr(o),s=o.name;return u===F_.CompletionItemKind.Lambda&&(s+=a),{label:o.name,kind:u,type:F_.SuggestionKind.Simple,textEdit:{newText:s,range:{start:{line:0,character:t},end:{line:0,character:n}}},detail:o.tooltip,isPrefixed:o.isPrefixed}})},e.prototype.logFailure=function(r){Zre.ulsLogger.ULS.traceTag(528562134,Zre.LogCategory.msoulscat_ES_EWAJS,Zre.TraceLevel.Warning,"AutocompleteNamedObjectPlugin encountered a failure with msg ".concat(r))},e}();function Oxr(e){switch(e.type){case h1.DefinedNameInfoType.NamedRange:return F_.CompletionItemKind.NamedRange;case h1.DefinedNameInfoType.Table:return F_.CompletionItemKind.Table;case h1.DefinedNameInfoType.Lambda:return F_.CompletionItemKind.Lambda;default:return F_.CompletionItemKind.NamedOther}}(0,Exr.registerPluginFactory)(new Txe);LO.autocompleteNamedObjectsPluginDependenciesResolved=(0,Fxr.trackableAsyncLazy)(function(){return Zh.__awaiter(void 0,void 0,void 0,function(){var e;return Zh.__generator(this,function(r){switch(r.label){case 0:return[4,_xe.autoCompletePluginsThread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(Cxe.PluginFactoryName.AutocompleteNamedObjectsPlugin)];case 2:return r.sent(),[4,_xe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})},"autocompleteNamedObjectsPluginDependenciesResolved")});var Rxe=T(g5=>{"use strict";p();Object.defineProperty(g5,"__esModule",{value:!0});g5.AutocompleteTableHeadersVisitor=void 0;var kxr=fe(),D2=Ar(),pE=ti(),Mxr=Db(),xxr=function(e){kxr.__extends(r,e);function r(t,n,a){var o=e.call(this,t,n)||this;return o.tableNames=a,o.isWithinThisRowOp=!1,o.isStructRefClosed=!1,o.isNodeClosed=!1,o.findContainingNode=function(u){var s=o.parsedFormulaTree.spans[u.label];if(o.isCaretInNode(u))switch(u.kind){case pE.StructRefKind.SpecialRef:case pE.StructRefKind.ColumnRef:case pE.StructRefKind.BadRef:o.isTighterThanCurrent(s)&&(o.containingNode=s,o.isNodeClosed=o.getIsNodeClosed(u));break;case pE.StructRefKind.ThisRowOpRef:var l=u,c=l.ref;if(o.isCaretInBeginningOfNode(s))break;o.isWithinThisRowOp=!0,(0,D2.isDefined)(c)?o.findContainingNode(c):o.isTighterThanCurrent(s)&&(o.containingNode=s,o.isNodeClosed=o.isStructRefClosed);break;case pE.StructRefKind.CommaOpRef:if(o.isCaretInBeginningOfNode(s))break;var d=u;d.refs.map(o.findContainingNode);break;case pE.StructRefKind.RangeOpRef:if(o.isCaretInBeginningOfNode(s))break;var f=u;o.findContainingNode(f.lhs),o.findContainingNode(f.rhs);break;case pE.StructRefKind.MissingRef:o.containingNode=void 0;break}},o.isTighterThanCurrent=function(u){return(0,D2.isDefined)(u)&&((0,D2.isNone)(o.containingNode)||u.end<o.containingNode.end||u.start>o.containingNode.start)},o}return r.prototype.structRefNode=function(t,n,a){var o=this;if(this.isCaretInNode(n)){t&&this.tableNames.forEach(function(s){s.toLocaleLowerCase()===t.whole.toLocaleLowerCase()&&(o.tableName=s)});var u=this.parsedFormulaTree.spans[n.label];this.isNodeClosed=this.isStructRefClosed=n.isClosed,this.containingNode=u,n.innerRef!==void 0&&this.findContainingNode(n.innerRef)}return e.prototype.structRefNode.call(this,t,n,a)},r.prototype.getIsNodeClosed=function(t){return t.isBracketed?t.isClosed:this.isStructRefClosed},r.prototype.isCaretInNode=function(t){var n=this.parsedFormulaTree.spans[t.label];return(0,D2.isDefined)(n)&&this.caretPosition<=n.end&&this.caretPosition>=n.start},r.prototype.isCaretInBeginningOfNode=function(t){return(0,D2.isDefined)(t)&&this.caretPosition===t.start},r}(Mxr.CaretInsideArrayNodeIdentityVisitor);g5.AutocompleteTableHeadersVisitor=xxr});var Exe=T(h5=>{"use strict";p();Object.defineProperty(h5,"__esModule",{value:!0});h5.AutocompleteTableHeadersVisitorOld=void 0;var Ixr=fe(),v5=Ar(),mE=ti(),wxr=Db(),Dxr=function(e){Ixr.__extends(r,e);function r(t,n,a){var o=e.call(this,t,n)||this;return o.tableNames=a,o.isWithinThisRowOp=!1,o.isNodeClosed=!1,o.findContainingNode=function(u){var s=o.parsedFormulaTree.spans[u.label];if(o.isCaretInNode(u))switch(u.kind){case mE.StructRefKind.SpecialRef:case mE.StructRefKind.ColumnRef:case mE.StructRefKind.BadRef:o.isTighterThanCurrent(s)&&(o.containingNode=s);break;case mE.StructRefKind.ThisRowOpRef:var l=u,c=l.ref;o.isWithinThisRowOp=!0,(0,v5.isDefined)(c)?o.findContainingNode(c):o.isTighterThanCurrent(s)&&(o.containingNode=s);break;case mE.StructRefKind.CommaOpRef:var d=u;d.refs.map(o.findContainingNode);break;case mE.StructRefKind.RangeOpRef:var f=u;o.findContainingNode(f.lhs),o.findContainingNode(f.rhs);break;case mE.StructRefKind.MissingRef:o.containingNode=void 0;break}},o.isTighterThanCurrent=function(u){return(0,v5.isDefined)(u)&&((0,v5.isNone)(o.containingNode)||u.end<o.containingNode.end||u.start>o.containingNode.start)},o}return r.prototype.structRefNode=function(t,n,a){var o=this;return this.isCaretInNode(n)&&(t&&this.tableNames.forEach(function(u){u.toLocaleLowerCase()===t.whole.toLocaleLowerCase()&&(o.tableName=u)}),n.innerRef===void 0?this.containingNode=this.parsedFormulaTree.spans[n.label]:this.findContainingNode(n.innerRef)),e.prototype.structRefNode.call(this,t,n,a)},r.prototype.isCaretInNode=function(t){var n=this.parsedFormulaTree.spans[t.label];return(0,v5.isDefined)(n)&&this.caretPosition<=n.end&&this.caretPosition>=n.start},r}(wxr.CaretInsideArrayNodeIdentityVisitor);h5.AutocompleteTableHeadersVisitorOld=Dxr});var nte=T(GO=>{"use strict";p();Object.defineProperty(GO,"__esModule",{value:!0});GO.autocompleteTableHeadersPluginDependenciesResolved=GO.AutocompleteTableHeadersPluginFactory=void 0;var vE=fe(),am=Xo(),Lxr=yc(),qO=Gi(),rte=zn(),qxr=Us(),Gxr=hc(),tte=qd(),gE=ia(),Bxr=ks(),KS=Ar(),Uxr=ia(),Kxr=Rxe(),Pxe=XC(),VS=ti(),Axe=ia(),Fxe=Ms(),Vxr=mi(),jxr=Exe(),Wxr=Ld(),Nxe=function(){function e(){this.factoryName=Axe.PluginFactoryName.AutocompleteTableHeadersPlugin}return e.prototype.create=function(){return new Hxr},e}();GO.AutocompleteTableHeadersPluginFactory=Nxe;var Hxr=function(){function e(){var r=this;this.getTableHeadersFromServerEnabled=(0,Fxe.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer"),this.fixAutocompleteTableHeadersBugEnabled=(0,Vxr.isChangeGateEnabled)("OfficeVSO:7899833_fixAutocompleteTableHeadersBug"),this.getCompletionItems=function(t,n,a,o,u,s){var l,c=n.charAt(0)==="@";if(c||u){var d=c?a+1:a,f=c?n.substring(1):n;return r.generateHeadersCompletionItems(f,t,d,o,!0)}var m=[],v=n==="";if(v){var h=(l=s[VS.SpecialRefId.ThisRow])===null||l===void 0?void 0:l.substring(1);r.fixAutocompleteTableHeadersBugEnabled?m.push(r.generateThisRowOpCompletionItem(a,a,h)):m.push(r.generateThisRowOpCompletionItem(a,o,h))}return m.push.apply(m,r.generateSpecialCaseCompletionItems(a,o,n,s)),m.push.apply(m,r.generateHeadersCompletionItems(n,t,a,o)),m},this.getHeaderTextEditCallback=function(t){return function(n){var a=Qxr(n);return t&&r.hasSpecialChars(a)?"[".concat(a,"]"):a}},this.hasSpecialChars=function(t){try{var n=new RegExp("(?=\\P{L})(?=\\P{M})(?=\\P{N})","u");return n.test(t)}catch(a){return r.logFailure("hasSpecialChars method, error: ".concat(a,".")),!0}}}return e.prototype.run=function(r){var t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N,k,q,V,I,M,B;return vE.__generator(this,function(U){switch(U.label){case 0:return t=r.content,n=r.caretPosition,(0,KS.isNone)(t)||(0,KS.isNone)(n)?[2,null]:[4,{kind:am.ComputationRequestKind.ParseActiveCell,formulaText:t}];case 1:return a=U.sent(),a.kind!==am.ComputationRequestKind.ParseActiveCell||!(0,rte.isSuccess)(a.result)?[2,null]:a.result.value.kind!==qxr.EditKind.Formula?[2,null]:(o=a.result.value.formula,[4,{kind:am.ComputationRequestKind.GetDefinedNamesInfo}]);case 2:return u=U.sent(),u.kind!==am.ComputationRequestKind.GetDefinedNamesInfo?(this.logFailure("failed to get named objects info"),[2,null]):(s=u.definedNamesInfo.filter(function(j){return j.type===Uxr.DefinedNameInfoType.Table}).map(function(j){return j.name}).filter(KS.isDefined),s.length===0?[2,null]:(this.fixAutocompleteTableHeadersBugEnabled?l=new Kxr.AutocompleteTableHeadersVisitor(o,n,s):l=new jxr.AutocompleteTableHeadersVisitorOld(o,n,s),(0,Bxr.reduceBottomUp)(l,o),c=l.tableName,d=l.containingNode,f=l.isInsideArrayNode,m=l.isNodeClosed,(0,KS.isNone)(d)||f?[2,null]:(0,KS.isNone)(c)?[4,{kind:am.ComputationRequestKind.GetActiveCell}]:[3,5]));case 3:return v=U.sent(),v.kind!==am.ComputationRequestKind.GetActiveCell?(this.logFailure("Couldn't get active cell"),[2,null]):[4,{kind:am.ComputationRequestKind.GetContainingTable,cell:v.activeCell}];case 4:if(h=U.sent(),h.kind!==am.ComputationRequestKind.GetContainingTable||!(0,rte.isSuccess)(h.result))return this.logFailure("GetContainingTable request failed. result kind = ".concat(JSON.stringify(h))),[2,null];if(c=(B=h.result.value)===null||B===void 0?void 0:B.name,(0,KS.isNone)(c))return[2,null];U.label=5;case 5:return y=d.start,_=d.end,E=t.charAt(_-1),(E==="]"||E===")")&&_--,t.charAt(y)==="["&&y++,n!==_&&(!this.fixAutocompleteTableHeadersBugEnabled||!this.caretIsInTheBeginning(t,y,n))?[2,null]:[4,{kind:am.ComputationRequestKind.GetAvailableTableHeaders,tableName:c}];case 6:return N=U.sent(),N.kind===am.ComputationRequestKind.GetAvailableTableHeaders&&(0,rte.isSuccess)(N.result)&&!(0,KS.isNone)(N.result.value)&&(!this.getTableHeadersFromServerEnabled||!N.result.value.isPartial)?(k=N.result.value.cols,[3,9]):[3,7];case 7:return this.getTableHeadersFromServerEnabled?(qO.ulsLogger.ULS.traceTag(509682331,qO.LogCategory.msoulscat_ES_EWAJS,qO.TraceLevel.Info,"AutocompleteTableHeadersPlugin getting col headers from server"),[4,{kind:am.ComputationRequestKind.GetFullTableHeadersFromServer,tableName:c}]):[3,9];case 8:if(q=U.sent(),q.kind===am.ComputationRequestKind.GetFullTableHeadersFromServer&&(0,KS.isDefined)(q.result))k=q.result;else return this.logFailure("Failed to get header names from server"),[2,null];U.label=9;case 9:return!(0,KS.isDefined)(k)||k.length===0?[2,null]:(V="",this.fixAutocompleteTableHeadersBugEnabled&&this.caretIsInTheBeginning(t,y,n)?_=m?_:y:V=t.substring(y,_),[4,{kind:am.ComputationRequestKind.GetConfig}]);case 10:return I=U.sent(),I.kind!==am.ComputationRequestKind.GetConfig?(this.logFailure("getConfig request failed"),[2,null]):(M=this.getCompletionItems(k,V,y,_,l.isWithinThisRowOp,I.config.localeInfo.specialRefNames),[2,{items:M}])}})},e.prototype.caretIsInTheBeginning=function(r,t,n){var a=r.substring(t,n).trim();return a.length===0},e.prototype.generateCompletionItems=function(r,t,n,a,o,u){var s=[];return r.forEach(function(l){var c=typeof l=="string",d=c?l:l.name,f=c?void 0:l.description;s.push({label:d,kind:o,type:gE.SuggestionKind.Simple,textEdit:{newText:(0,KS.isDefined)(u)?u(d):d,range:{start:{line:0,character:t},end:{line:0,character:n}}},detail:f,isPrefixed:a})}),s},e.prototype.generateHeadersCompletionItems=function(r,t,n,a,o){o===void 0&&(o=!1);var u=(0,Pxe.filterSuggestionsAccordingToPrefix)(r,t),s=u.prefixedSuggestions,l=u.notPrefixedSuggestions,c=this.getHeaderTextEditCallback(o);return vE.__spreadArray(vE.__spreadArray([],this.generateCompletionItems(s,n,a,!0,gE.CompletionItemKind.TableHeader,c),!0),this.generateCompletionItems(l,n,a,!1,gE.CompletionItemKind.TableHeader,c),!0)},e.prototype.generateSpecialCaseCompletionItems=function(r,t,n,a){var o=[VS.SpecialRefId.All,VS.SpecialRefId.Data,VS.SpecialRefId.Headers,VS.SpecialRefId.Totals].map(function(c){var d;return{name:(d=a[c])!==null&&d!==void 0?d:"",description:zxr.getValue()[c]}}),u=(0,Pxe.filterSuggestionsAccordingToPrefix)(n,o,function(c){return c.name}),s=u.prefixedSuggestions,l=u.notPrefixedSuggestions;return vE.__spreadArray(vE.__spreadArray([],this.generateCompletionItems(s,r,t,!0,gE.CompletionItemKind.TableSpecialStructRef),!0),this.generateCompletionItems(l,r,t,!1,gE.CompletionItemKind.TableSpecialStructRef),!0)},e.prototype.generateThisRowOpCompletionItem=function(r,t,n){return{label:"@ - ".concat(n),kind:gE.CompletionItemKind.TableSpecialStructRef,type:gE.SuggestionKind.Simple,textEdit:{newText:"@",range:{start:{line:0,character:r},end:{line:0,character:t}}},detail:FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription),shouldRequestAutocompleteOnCommit:!0}},e.prototype.logFailure=function(r){qO.ulsLogger.ULS.traceTag(526508764,qO.LogCategory.msoulscat_ES_EWAJS,qO.TraceLevel.Warning,"AutocompleteTableHeadersPlugin encountered a failure with msg ".concat(r))},e}();(0,Lxr.registerPluginFactory)(new Nxe);GO.autocompleteTableHeadersPluginDependenciesResolved=(0,Wxr.trackableAsyncLazy)(function(){return vE.__awaiter(void 0,void 0,void 0,function(){var e,r;return vE.__generator(this,function(t){switch(t.label){case 0:return(0,Fxe.isTypedChangeGateEnabled)("OfficeVSO:7396249_getTableHeadersFromServer")?[4,tte.dynamicPluginLoaderCreated.getValue()]:[3,2];case 1:return r=t.sent(),[3,4];case 2:return[4,tte.autoCompletePluginsThread.getValue()];case 3:r=t.sent(),t.label=4;case 4:return e=r,[4,e.createAndAttachPlugin(Axe.PluginFactoryName.AutocompleteTableHeadersPlugin)];case 5:return t.sent(),[4,tte.schedulerWithRecalcServiceAttached.getValue()];case 6:return t.sent(),[2]}})})},"autocompleteTableHeadersPluginDependenciesResolved");var zxr=new Gxr.ResettableLazy(function(){var e;return e={},e[VS.SpecialRefId.All]=FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefAllDescription),e[VS.SpecialRefId.Data]=FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefDataDescription),e[VS.SpecialRefId.Headers]=FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefHeadersDescription),e[VS.SpecialRefId.Totals]=FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.SpecialRefTotalsDescription),e[VS.SpecialRefId.ThisRow]=FormulaAuthoringStringsManager.get(FormulaAuthoringStringsEnum.ThisRowOpDescription),e}),Qxr=function(r){return r.replace(/\[|\]|\'|\@|\#/g,"'$&")}});var Oxe=T(S5=>{"use strict";p();Object.defineProperty(S5,"__esModule",{value:!0});S5.ParenthesesCouplingVisitor=void 0;var Xxr=fe(),Yxr=ti(),Jxr=ks(),Zxr=function(e){Xxr.__extends(r,e);function r(t,n){var a=e.call(this)||this;return a.formula=t,a.caretPosition=n,a.parenthesesSpan=void 0,a.checkLeft=!1,a.checkRight=!1,a.areParenthesesLeftOfCaret=!1,a}return r.prototype.appNode=function(t,n,a,o){return t.kind!==Yxr.NodeKind.Operator&&this.matchFormula(t,a,o),e.prototype.appNode.call(this,t,n,a,o)},r.prototype.parenNode=function(t,n,a){var o=this.formula.spans[a];return n&&o&&this.matchParentheses(o.start,o.end-1),e.prototype.parenNode.call(this,t,n,a)},r.prototype.letNode=function(t,n,a,o,u,s){return this.matchFormula(t,u,s),e.prototype.letNode.call(this,t,n,a,o,u,s)},r.prototype.lambdaNode=function(t,n,a,o,u,s){return this.matchFormula(t,u,s),e.prototype.lambdaNode.call(this,t,n,a,o,u,s)},r.prototype.matchFormula=function(t,n,a){var o=this.formula.spans[a],u=this.formula.spans[t.label];n&&o&&u&&this.matchParentheses(u.end,o.end-1)},r.prototype.matchParentheses=function(t,n){t===this.caretPosition&&(this.checkRight=!0),n===this.caretPosition-1&&(this.checkLeft=!0),this.checkRight&&this.shouldUpdateLocation(t,n,this.caretPosition+1)?(this.parenthesesSpan={start:t,end:n},this.areParenthesesLeftOfCaret=!1):this.shouldUpdateLocation(t,n,this.caretPosition)?(this.parenthesesSpan={start:t,end:n},this.areParenthesesLeftOfCaret=!1):this.checkLeft&&this.shouldUpdateLocation(t,n,this.caretPosition-1)&&(this.parenthesesSpan={start:t,end:n},this.areParenthesesLeftOfCaret=!0)},r.prototype.shouldUpdateLocation=function(t,n,a){return t<a&&a<=n&&(this.parenthesesSpan===void 0||this.areParenthesesLeftOfCaret&&t<=this.parenthesesSpan.start||t>this.parenthesesSpan.start)},r}(Jxr.IdentityVisitor);S5.ParenthesesCouplingVisitor=Zxr});var ite=T(BO=>{"use strict";p();Object.defineProperty(BO,"__esModule",{value:!0});BO.parenthesesCouplingPluginDependenciesResolved=BO.ParenthesesCouplingPluginFactory=void 0;var ate=fe(),$xr=Ar(),eIr=zn(),rIr=ks(),tIr=Us(),nIr=yc(),kxe=qd(),Mxe=Xo(),aIr=Oxe(),y5=ia(),iIr=Ld(),xxe=function(){function e(){this.factoryName=y5.PluginFactoryName.ParenthesesCouplingPlugin}return e.prototype.create=function(){return new oIr},e}();BO.ParenthesesCouplingPluginFactory=xxe;var oIr=function(){function e(){}return e.prototype.run=function(r){var t,n,a;return ate.__generator(this,function(o){switch(o.label){case 0:return r.selectionLength!=null&&r.selectionLength>0?[2,null]:[4,{kind:Mxe.ComputationRequestKind.ParseActiveCell,formulaText:r.content}];case 1:return t=o.sent(),t.kind!==Mxe.ComputationRequestKind.ParseActiveCell||!(0,eIr.isSuccess)(t.result)?[2,null]:t.result.value.kind!==tIr.EditKind.Formula?[2,null]:(n=t.result.value.formula,a=new aIr.ParenthesesCouplingVisitor(n,r.caretPosition),(0,rIr.reduceBottomUp)(a,n),(0,$xr.isDefined)(a.parenthesesSpan)?[2,this.getParenthesesHighlights(a.parenthesesSpan)]:[2,{formulaHighlights:void 0}])}})},e.prototype.getParenthesesHighlights=function(r){var t=r.start,n=r.end,a={kind:y5.HighlightKind.Parentheses,span:{start:t,end:t+1}},o={kind:y5.HighlightKind.Parentheses,span:{start:n,end:n+1}},u=[o,a];return{formulaHighlights:u}},e}();(0,nIr.registerPluginFactory)(new xxe);BO.parenthesesCouplingPluginDependenciesResolved=(0,iIr.trackableAsyncLazy)(function(){return ate.__awaiter(void 0,void 0,void 0,function(){var e;return ate.__generator(this,function(r){switch(r.label){case 0:return[4,kxe.dynamicPluginLoaderCreated.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachSyncPlugin(y5.PluginFactoryName.ParenthesesCouplingPlugin)];case 2:return r.sent(),[4,kxe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})},"parenthesesCouplingPluginDependenciesResolved")});var qxe=T(b5=>{"use strict";p();Object.defineProperty(b5,"__esModule",{value:!0});b5.ColoredReferencesVisitor=void 0;var Ixe=fe(),Nv=Ar(),ote=Gi(),wxe=Qf(),ute=ia(),_5=ti(),ste=ti(),uIr=ks(),L2=uE(),Dxe=qi(),sIr=j6(),lIr=_O(),Lxe=ia(),cIr=function(e){Ixe.__extends(r,e);function r(t,n,a,o,u,s){var l=e.call(this)||this;return l.activeCell=t,l.parsedFormulaTree=n,l.formulaString=a,l.sheetNames=o,l.definedNameInfoList=u,l.failureCallback=s,l.structRefNodes=[],l.formulaHighlights=[],l.activeCellSheetName=void 0,l._namedObjectsMap=void 0,l}return r.prototype.structRefNode=function(t,n,a){var o=e.prototype.structRefNode.call(this,t,n,a);return this.structRefNodes.push(o),o},r.prototype.nameNode=function(t,n,a){var o=e.prototype.nameNode.call(this,t,n,a);if(!this.isRefInActiveSheet(n))return o;if(o.parts.kind===_5.NamePartKind.FieldRefNamePart)return this.createAndAppendFieldRefHighlight(o.parts.lhs),o;if(!(0,Nv.isDefined)(this.namedObjectsMap))return o;var u=this.namedObjectsMap.get(t.asWhole.toLocaleLowerCase()),s=u!==void 0&&u.type!==Lxe.DefinedNameInfoType.Invalid;return s&&this.createAndAppendNamedRefHighlight(a,u),o},r.prototype.cellRefNode=function(t,n,a){var o=e.prototype.cellRefNode.call(this,t,n,a);if(!(0,L2.isValidCellRef)(t)||!this.isRefInActiveSheet(n))return o;var u=this.parsedFormulaTree.spans[a];if(u){var s=this.createRangeInfoFromCellRef(t),l=this.formulaSpanToHighlightingSpan(u,ste.NodeKind.CellRef);this.formulaHighlights.push(lte(ute.HighlightKind.CellRef,l,s))}return o},Object.defineProperty(r.prototype,"namedObjectsMap",{get:function(){return(0,Nv.isDefined)(this._namedObjectsMap)?this._namedObjectsMap:((0,Nv.isDefined)(this.definedNameInfoList)&&(this._namedObjectsMap=(0,L2.createNameToDefinedNameInfoMapping)(this.definedNameInfoList)),this._namedObjectsMap)},enumerable:!1,configurable:!0}),r.prototype.createAndAppendNamedRefHighlight=function(t,n){var a=this.parsedFormulaTree.spans[t];if(!(!(0,Nv.isDefined)(a)||!(0,Nv.isDefined)(this.sheetNames))){var o=n.sheetName;if(!(0,Nv.isDefined)(o)){cte("createAndAppendNamedRef - sheetName undefined, DefinedNameInfo type: ".concat(n.type));return}var u=(0,L2.getSheetIndexFromSheetName)(o,this.sheetNames);if(!(0,Nv.isDefined)(u)){cte("createAndAppendNamedRef: sheetIndex undefined, DefinedNameInfo type: ".concat(n.type));return}if((0,Dxe.isSheetIndexEqual)(u,this.activeCell.sheet)){var s=(0,lIr.getRangeFromDefinedName)(n);s!==void 0&&this.formulaHighlights.push(lte(ute.HighlightKind.NamedRange,a,{range:s}))}}},r.prototype.createAndAppendFieldRefHighlight=function(t){switch(t.kind){case _5.NamePartKind.CellRefNamePart:{this.createAndAppendCellRefPartHighlight(t);break}case _5.NamePartKind.IdentNamePart:{if(!(0,Nv.isDefined)(this.namedObjectsMap))return;var n=this.namedObjectsMap.get(t.asWhole.toLocaleLowerCase()),a=n!==void 0&&n.type!==Lxe.DefinedNameInfoType.Invalid;a&&this.createAndAppendNamedRefHighlight(t.label,n);break}case _5.NamePartKind.FieldRefNamePart:this.createAndAppendFieldRefHighlight(t.lhs)}},r.prototype.createAndAppendCellRefPartHighlight=function(t){var n=this.parsedFormulaTree.spans[t.label];if((0,Nv.isDefined)(n)){var a=this.createRangeInfoFromCellRef(t.ref),o=this.formulaSpanToHighlightingSpan(n,ste.NodeKind.CellRef),u=lte(ute.HighlightKind.CellRef,o,a);this.formulaHighlights.push(u)}},r.prototype.formulaSpanToHighlightingSpan=function(t,n){var a=Ixe.__assign({},t);return n===ste.NodeKind.CellRef&&dIr(t,this.formulaString)&&(a.end+=1),a},r.prototype.createRangeInfoFromCellRef=function(t){var n=(0,L2.getRangeFromCellRef)(t,this.activeCell.range,cte);return{range:n,positionKindInfo:(0,sIr.getPositionKindInfoFromCellRef)(t)}},r.prototype.isRefInActiveSheet=function(t){var n;if(!(0,Nv.isDefined)(t))return!0;if(!(0,Nv.isDefined)(this.sheetNames))return!1;var a=(0,L2.getSheetIndexFromQualifier)(t,this.sheetNames,this.failureCallback);return(0,Nv.isDefined)(a)?(0,Dxe.isSheetIndexEqual)(a,this.activeCell.sheet):((n=this.failureCallback)===null||n===void 0||n.call(this,"CellRefHighlightCreator.isRefInActiveSheet: sheetIndex is undefined"),!1)},r}(uIr.IdentityVisitor);b5.ColoredReferencesVisitor=cIr;function lte(e,r,t){return{kind:e,span:r,rangeInfo:t}}function dIr(e,r){return r.length>e.end&&r.charAt(e.end)===wxe.operatorStrings[wxe.OperatorId.Pound]}function cte(e){ote.ulsLogger.ULS.traceTag(520935561,ote.LogCategory.msoulscat_ES_EWAJS,ote.TraceLevel.Warning,"ColoredReferencesVisitor encountered a failure with msg ".concat(e))}});var mte=T(UO=>{"use strict";p();Object.defineProperty(UO,"__esModule",{value:!0});UO.coloredReferencesPluginDependenciesResolved=UO.ColoredReferencesPluginFactory=void 0;var fte=fe(),dte=Gi(),C5=zn(),fIr=ks(),pIr=Us(),mIr=yc(),Gxe=qd(),jS=Xo(),gIr=qxe(),vIr=Ar(),hIr=j6(),Bxe=qi(),pte=ia(),SIr=Ld(),Uxe=function(){function e(){this.factoryName=pte.PluginFactoryName.ColoredReferencesPlugin}return e.prototype.create=function(){return new yIr},e}();UO.ColoredReferencesPluginFactory=Uxe;var yIr=function(){function e(){}return e.prototype.run=function(r){var t,n,a,o,u,s,l,c,d,f,m,v,h;return fte.__generator(this,function(y){switch(y.label){case 0:return t=r.content,[4,{kind:jS.ComputationRequestKind.ParseActiveCell,formulaText:t}];case 1:return n=y.sent(),n.kind!==jS.ComputationRequestKind.ParseActiveCell||!(0,C5.isSuccess)(n.result)?[2,null]:n.result.value.kind!==pIr.EditKind.Formula?[2,null]:[4,{kind:jS.ComputationRequestKind.GetActiveCell}];case 2:return a=y.sent(),a.kind!==jS.ComputationRequestKind.GetActiveCell?(hE("failed to get active cell"),[2,null]):(o=void 0,[4,{kind:jS.ComputationRequestKind.GetSheetNames}]);case 3:return u=y.sent(),u.kind===jS.ComputationRequestKind.GetSheetNames?o=u:hE("failed to get sheet names"),s=void 0,[4,{kind:jS.ComputationRequestKind.GetDefinedNamesInfo}];case 4:return l=y.sent(),l.kind===jS.ComputationRequestKind.GetDefinedNamesInfo?s=l.definedNamesInfo:hE("failed to get defined names"),c=a.activeCell,d=n.result.value.formula,f=new gIr.ColoredReferencesVisitor(c,d,t,o,s),(0,fIr.reduceBottomUp)(f,d),m=f.formulaHighlights,f.structRefNodes.length===0?[3,6]:(v={originGridCell:(0,C5.success)(c.range),originSheet:(0,C5.success)(c.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},[4,{kind:jS.ComputationRequestKind.ResolveReferences,nodes:f.structRefNodes,locals:v}]);case 5:h=y.sent(),h.kind===jS.ComputationRequestKind.ResolveReferences?m=m.concat(_Ir(d,c,h.resolverResults)):hE("failed to resolve node references"),y.label=6;case 6:return[2,{formulaHighlights:m}]}})},e}();(0,mIr.registerPluginFactory)(new Uxe);UO.coloredReferencesPluginDependenciesResolved=(0,SIr.trackableAsyncLazy)(function(){return fte.__awaiter(void 0,void 0,void 0,function(){var e;return fte.__generator(this,function(r){switch(r.label){case 0:return[4,Gxe.dynamicPluginLoaderCreated.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachSyncPlugin(pte.PluginFactoryName.ColoredReferencesPlugin)];case 2:return r.sent(),[4,Gxe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})},"coloredReferencesPluginDependenciesResolved");function _Ir(e,r,t){var n=[];return t.forEach(function(a){var o,u=e.spans[a.node.label];if(!u){hE("failed to resolve StructRef, formulaSpan null");return}if(!(0,C5.isSuccess)(a.resolution)){hE("failed to resolve StructRef, reason: ".concat((o=a.resolution)===null||o===void 0?void 0:o.reason.kind));return}if(a.resolution.value===void 0){hE("failed to resolve StructRef, resolution value undefined");return}var s=a.resolution.value,l=(0,Bxe.sheetRangeToSheetIndex)(s.sheet);if(!(!(0,vIr.isDefined)(l)||!(0,Bxe.isSheetIndexEqual)(l,r.sheet))){var c=(0,hIr.gridRangeToRange)(s.range),d={kind:pte.HighlightKind.StructRef,span:u,rangeInfo:{range:c}};n.push(d)}}),n}function hE(e){dte.ulsLogger.ULS.traceTag(525133647,dte.LogCategory.msoulscat_ES_EWAJS,dte.TraceLevel.Warning,"ColoredReferencesPlugin encountered a failure with msg ".concat(e))}});var Vxe=T(im=>{"use strict";p();Object.defineProperty(im,"__esModule",{value:!0});im.chatGPTPluginAttach=im.parserPerformanceMeasurementsAttach=im.autocompleteBinaryModelExperimentPluginAttach=im.autocompleteRangeSuggestionPluginAttach=im.autocompleteWrapperPluginAttach=im.autocompletePluginDependenciesResolved=void 0;var om=fe(),KO=ia(),Kxe=qd(),SE=Ld(),bIr=Ms(),VO=(0,SE.trackableAsyncLazy)(function(){return om.__awaiter(void 0,void 0,void 0,function(){var e;return om.__generator(this,function(r){switch(r.label){case 0:return[4,Kxe.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript((0,bIr.isTypedChangeGateEnabled)("OfficeVSO:8927842_CalcWP5ES6")?"excelOnlineAutocompleteWP5":"excelOnlineAutocomplete",!1)];case 2:return r.sent(),[2,e]}})})},"threadWithExcelOnlineAutocompleteScriptLoaded");im.autocompletePluginDependenciesResolved=(0,SE.trackableAsyncLazy)(function(){return om.__awaiter(void 0,void 0,void 0,function(){var e;return om.__generator(this,function(r){switch(r.label){case 0:return[4,VO.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(KO.PluginFactoryName.AutocompletePlugin)];case 2:return r.sent(),[4,Kxe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})},"autocompletePluginDependenciesResolved");im.autocompleteWrapperPluginAttach=(0,SE.trackableAsyncLazy)(function(){return om.__awaiter(void 0,void 0,void 0,function(){var e;return om.__generator(this,function(r){switch(r.label){case 0:return[4,VO.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(KO.PluginFactoryName.AutocompleteWrapperPlugin)];case 2:return r.sent(),[2]}})})},"autocompleteWrapperPluginAttach");im.autocompleteRangeSuggestionPluginAttach=(0,SE.trackableAsyncLazy)(function(){return om.__awaiter(void 0,void 0,void 0,function(){var e;return om.__generator(this,function(r){switch(r.label){case 0:return[4,VO.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(KO.PluginFactoryName.AutocompleteRangeSuggestionPlugin)];case 2:return r.sent(),[2]}})})},"autocompleteRangeSuggestionPluginAttach");im.autocompleteBinaryModelExperimentPluginAttach=(0,SE.trackableAsyncLazy)(function(){return om.__awaiter(void 0,void 0,void 0,function(){var e;return om.__generator(this,function(r){switch(r.label){case 0:return[4,VO.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(KO.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin)];case 2:return r.sent(),[2]}})})},"autocompleteBinaryModelExperimentPluginAttach");im.parserPerformanceMeasurementsAttach=(0,SE.trackableAsyncLazy)(function(){return om.__awaiter(void 0,void 0,void 0,function(){var e;return om.__generator(this,function(r){switch(r.label){case 0:return[4,VO.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(KO.PluginFactoryName.ParserPerformanceMeasurements)];case 2:return r.sent(),[2]}})})},"parserPerformanceMeasurementsAttach");im.chatGPTPluginAttach=(0,SE.trackableAsyncLazy)(function(){return om.__awaiter(void 0,void 0,void 0,function(){var e;return om.__generator(this,function(r){switch(r.label){case 0:return[4,VO.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(KO.PluginFactoryName.ChatGPTPlugin)];case 2:return r.sent(),[2]}})})},"chatGPTPluginAttach")});var jxe=T(P5=>{"use strict";p();Object.defineProperty(P5,"__esModule",{value:!0});P5.GotoCtrlClickVisitor=void 0;var CIr=fe(),gte=Gi(),T5=Ar(),vte=ti(),TIr=ks(),RIr=ia(),S1=uE(),R5=_O(),EIr=function(e){CIr.__extends(r,e);function r(t,n,a,o){var u=e.call(this)||this;return u.parsedFormulaTree=t,u.activeCell=n,u.definedNameInfoList=a,u.caretPosition=o,u.structRefNodeToResolve=void 0,u.span=void 0,u.sheetRange=void 0,u.referenceFound=!1,u._namedObjectsMap=void 0,u}return Object.defineProperty(r.prototype,"namedObjectsMap",{get:function(){if((0,T5.isDefined)(this._namedObjectsMap))return this._namedObjectsMap;if(!(0,T5.isDefined)(this.definedNameInfoList)){E5("namedObjectsMap: was called but definedNameInfoList is undefined");return}return this._namedObjectsMap=(0,S1.createNameToDefinedNameInfoMapping)(this.definedNameInfoList),this._namedObjectsMap},enumerable:!1,configurable:!0}),r.prototype.structRefNode=function(t,n,a){var o=e.prototype.structRefNode.call(this,t,n,a);if(this.referenceFound)return o;var u=this.parsedFormulaTree.spans[a];return(0,S1.caretInSpanScope)(this.caretPosition,u)&&(this.referenceFound=!0,this.span=u,this.structRefNodeToResolve=o),o},r.prototype.cellRefNode=function(t,n,a){var o=e.prototype.cellRefNode.call(this,t,n,a);if(this.referenceFound)return o;var u=this.parsedFormulaTree.spans[a];return(0,S1.caretInSpanScope)(this.caretPosition,u)&&(this.referenceFound=!0,this.span=u,this.sheetRange=(0,R5.sheetRangeFromCellRef)(t,n,this.activeCell,E5)),o},r.prototype.nameNode=function(t,n,a){var o,u=e.prototype.nameNode.call(this,t,n,a);if(this.referenceFound)return u;var s=this.parsedFormulaTree.spans[a];if(!(0,S1.caretInSpanScope)(this.caretPosition,s))return u;if(u.parts.kind===vte.NamePartKind.FieldRefNamePart)this.tryFindFieldRefGotoReference(u.parts,n);else{var l=(o=this.namedObjectsMap)===null||o===void 0?void 0:o.get(t.asWhole.toLocaleLowerCase()),c=l!==void 0&&l.type!==RIr.DefinedNameInfoType.Invalid;c&&(this.referenceFound=!0,this.span=s,this.sheetRange=(0,R5.getSheetRangeFromDefinedNameInfo)(l,n))}return u},r.prototype.tryFindFieldRefGotoReference=function(t,n){var a=(0,S1.findFieldRefSourceLhs)(t);switch(a.kind){case vte.NamePartKind.CellRefNamePart:{var o=this.parsedFormulaTree.spans[a.label];(0,S1.caretInSpanScope)(this.caretPosition,o)&&(this.referenceFound=!0,this.span=o,this.sheetRange=(0,R5.sheetRangeFromCellRef)(a.ref,void 0,this.activeCell,E5));return}case vte.NamePartKind.IdentNamePart:{var o=this.parsedFormulaTree.spans[a.label];if((0,T5.isDefined)(this.namedObjectsMap)&&(0,S1.caretInSpanScope)(this.caretPosition,o)){this.referenceFound=!0,this.span=o;var u=(0,S1.getNamePartIfExists)(a,this.namedObjectsMap);if(!(0,T5.isDefined)(u))return;this.sheetRange=(0,R5.getSheetRangeFromDefinedNameInfo)(u,n)}return}default:E5("tryFindFieldRefGotoReference: Was not able to parse a left-most NamePart")}},r}(TIr.IdentityVisitor);P5.GotoCtrlClickVisitor=EIr;function E5(e){gte.ulsLogger.ULS.traceTag(508687388,gte.LogCategory.msoulscat_ES_EWAJS,gte.TraceLevel.Warning,"GotoCtrlClickVisitor encountered a failure with msg ".concat(e))}});var Qxe=T(F5=>{"use strict";p();Object.defineProperty(F5,"__esModule",{value:!0});F5.PluginRegistry=void 0;var PIr=fe(),A5=h2(),Wxe=y6(),Hxe=pM(),zxe=u2(),AIr=Ms(),FIr=function(){function e(r,t,n){this.factoryName=r,this.pluginGroup=t,this.gate=n,this.factory=void 0,this.registeredUIHandlers=[],this.registeredEventHandlers=[]}return e.creator=function(){return function(r,t,n){return new e(r,t,n)}},Object.defineProperty(e,"create",{get:function(){return e.creator()},enumerable:!1,configurable:!0}),e.prototype.x10Plugin=function(r){var t=this;return function(n,a){var o=String(a.name),u={registryInitialized:function(){return t.gate?(0,AIr.isTypedChangeGateEnabled)(t.gate):!0},factoryName:t.factoryName,pluginName:o,pluginGroup:t.pluginGroup,create:function(v){return new(n.bind.apply(n,PIr.__spreadArray([void 0],r?r(v):[],!1)))}};(0,Hxe.assertTrue)("Registry object cannot be used on '".concat(u.pluginName,"' class. 'x10Plugin' decorator must be called only once on plugin class"),t.factory===void 0),t.factory=u;for(var s=0,l=t.registeredUIHandlers;s<l.length;s++){var c=l[s];(0,Wxe.registerComputation)(A5.ComputationType.UIMessage,c.kind,c.executionType,t.pluginGroup,{factoryName:t.factoryName,pluginName:o,computationName:c.name},c.modifiers,c.computationGenerator,c.predicate)}for(var d=0,f=t.registeredEventHandlers;d<f.length;d++){var c=f[d];(0,Wxe.registerComputation)(A5.ComputationType.Event,c.kind,c.executionType,t.pluginGroup,{factoryName:t.factoryName,pluginName:o,computationName:c.name},c.modifiers,c.computationGenerator,c.predicate)}}},e.prototype.uiMessageHandler=function(r){var t=this;return function(n,a){var o,u,s;t.registeredUIHandlers.push({type:A5.ComputationType.UIMessage,kind:r.kind,name:String(a.name),executionType:(u=(o=r.modifiers)===null||o===void 0?void 0:o.executionType)!==null&&u!==void 0?u:zxe.ExecutionType.Async,modifiers:(s=r.modifiers)!==null&&s!==void 0?s:{},computationGenerator:n,predicate:r.predicate})}},e.prototype.eventHandler=function(r){var t=this;return function(n,a){var o,u,s;t.registeredEventHandlers.push({type:A5.ComputationType.Event,kind:r.kind,name:String(a.name),executionType:(u=(o=r.modifiers)===null||o===void 0?void 0:o.executionType)!==null&&u!==void 0?u:zxe.ExecutionType.Async,modifiers:(s=r.modifiers)!==null&&s!==void 0?s:{},computationGenerator:n,predicate:r.predicate})}},e.prototype.injectPluginFactory=function(){return(0,Hxe.assertTrue)("Plugin factory not initialized. `x10Plugin` decorator must be called on plugin class",this.factory!==void 0),this.factory},e}();F5.PluginRegistry=FIr});var hte=T(N5=>{"use strict";p();Object.defineProperty(N5,"__esModule",{value:!0});N5.PluginRegistry=void 0;var NIr=Qxe();Object.defineProperty(N5,"PluginRegistry",{enumerable:!0,get:function(){return NIr.PluginRegistry}})});var Jxe=T(O5=>{"use strict";p();Object.defineProperty(O5,"__esModule",{value:!0});O5.gotoCtrlClickPluginDependenciesResolved=void 0;var _1=fe(),Ste=Gi(),Xxe=Ar(),yte=zn(),WS=ia(),Yxe=qd(),OIr=_O(),$h=Xo(),kIr=jxe(),MIr=ks(),xIr=Us(),IIr=Ld(),wIr=hte(),DIr=yc(),_te=wIr.PluginRegistry.create(WS.PluginFactoryName.GotoCtrlClickPlugin,WS.PluginGroup.Excel),LIr=function(){var e=[_te.x10Plugin()],r,t=[],n,a=[],o,u=n=function(){function s(){_1.__runInitializers(this,a)}return s.prototype.run=function(l){var c,d,f,m,v,h,y,_,E,N,k,q,V=l.text,I=l.index;return _1.__generator(this,function(M){switch(M.label){case 0:return c=V,I<0||I>=c.length?(y1("caret out of formula scope"),[2,{kind:WS.GotoCtrlClickResultKind.NoReferenceFound}]):[4,{kind:$h.ComputationRequestKind.ParseActiveCell,formulaText:c}];case 1:return d=M.sent(),d.kind!==$h.ComputationRequestKind.ParseActiveCell||!(0,yte.isSuccess)(d.result)?(y1("failed to parse active cell"),[2,{kind:WS.GotoCtrlClickResultKind.Failure}]):d.result.value.kind!==xIr.EditKind.Formula?(y1("Not a formula cell"),[2,{kind:WS.GotoCtrlClickResultKind.NotAFormula}]):[4,{kind:$h.ComputationRequestKind.GetActiveCell}];case 2:return f=M.sent(),f.kind!==$h.ComputationRequestKind.GetActiveCell?(y1("failed to get active cell"),[2,null]):(m=void 0,[4,{kind:$h.ComputationRequestKind.GetDefinedNamesInfo}]);case 3:return v=M.sent(),v.kind===$h.ComputationRequestKind.GetDefinedNamesInfo?m=v.definedNamesInfo:y1("failed to get defined names"),h=f.activeCell,y=d.result.value.formula,_=new kIr.GotoCtrlClickVisitor(y,h.range,m,I),(0,MIr.reduceBottomUp)(_,y),_.referenceFound?(E=_.sheetRange,(0,Xxe.isDefined)(_.structRefNodeToResolve)?(N=void 0,[4,{kind:$h.ComputationRequestKind.GetSheetNames}]):[3,6]):[2,{kind:WS.GotoCtrlClickResultKind.NoReferenceFound}];case 4:if(k=M.sent(),k.kind===$h.ComputationRequestKind.GetSheetNames)N=k;else return y1("failed to get sheet names"),[2,{kind:WS.GotoCtrlClickResultKind.RangeResolutionFailure,span:_.span}];return[4,{kind:$h.ComputationRequestKind.ResolveReferences,nodes:[_.structRefNodeToResolve],locals:{originGridCell:(0,yte.success)(h.range),originSheet:(0,yte.success)(h.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0}}];case 5:q=M.sent(),q.kind===$h.ComputationRequestKind.ResolveReferences?E=(0,OIr.getSheetRangeFromResolvedRef)(N,q.resolverResults[0],y1):y1("failed to resolve node references"),M.label=6;case 6:return(0,Xxe.isDefined)(E)?[2,{kind:WS.GotoCtrlClickResultKind.ReferenceFound,sheetRange:E,span:_.span}]:[2,{kind:WS.GotoCtrlClickResultKind.RangeResolutionFailure,span:_.span}]}})},s}();return _1.__setFunctionName(n,"GotoCtrlClickPlugin"),function(){var s=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;o=[_te.uiMessageHandler({kind:$h.RequestKind.gotoCtrlClick})],_1.__esDecorate(n,null,o,{kind:"method",name:"run",static:!1,private:!1,access:{has:function(c){return"run"in c},get:function(c){return c.run}},metadata:s},null,a),_1.__esDecorate(null,r={value:n},e,{kind:"class",name:n.name,metadata:s},null,t),u=n=r.value,s&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:s})}(),n.factory=_te.injectPluginFactory(),function(){_1.__runInitializers(n,t)}(),u=n}();(0,DIr.registerPluginFactory)(LIr.factory);O5.gotoCtrlClickPluginDependenciesResolved=(0,IIr.trackableAsyncLazy)(function(){return _1.__awaiter(void 0,void 0,void 0,function(){var e;return _1.__generator(this,function(r){switch(r.label){case 0:return[4,Yxe.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(WS.PluginFactoryName.GotoCtrlClickPlugin)];case 2:return r.sent(),[4,Yxe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})},"gotoCtrlClickPluginDependenciesResolved");function y1(e){Ste.ulsLogger.ULS.traceTag(508687389,Ste.LogCategory.msoulscat_ES_EWAJS,Ste.TraceLevel.Warning,"GotoCtrlClickPlugin encountered a failure with msg ".concat(e))}});var Zxe=T(k5=>{"use strict";p();Object.defineProperty(k5,"__esModule",{value:!0});k5.tokenizeFormula=void 0;var qIr=Jf();k5.tokenizeFormula=qIr.tokenizeFormulaModule.tokenizeFormula});var $xe=T($e=>{"use strict";p();Object.defineProperty($e,"__esModule",{value:!0});$e.subOperatorToken=$e.specialRefToken=$e.spacesToken=$e.rowSepToken=$e.rightSQuoteToken=$e.rightParenToken=$e.rightBracketToken=$e.rightBraceToken=$e.rangeOperatorToken=$e.qualSepToken=$e.powOperatorToken=$e.poundOperatorToken=$e.percentOperatorToken=$e.operatorToken=$e.neOperatorToken=$e.mulOperatorToken=$e.ltOperatorToken=$e.literalToken=$e.listSepToken=$e.leftSQuoteToken=$e.leftParenToken=$e.leftBracketToken=$e.leftBraceToken=$e.leOperatorToken=$e.isNumberLikeOper=$e.isBadNumberOper=$e.isBadErrorOper=$e.identToken=$e.identOrBooleanToken=$e.gtOperatorToken=$e.geOperatorToken=$e.escapeToken=$e.eqOperatorToken=$e.endToken=$e.dotSepToken=$e.divOperatorToken=$e.concatOperatorToken=$e.colSepToken=$e.cellRefR1C1Token=$e.cellRefA1Token=$e.badNumberOper=$e.badErrorOper=$e.atOperatorToken=$e.assignSepToken=$e.appendToken=$e.addOperatorToken=$e.TokenOperKind=$e.TokenKind=$e.SepId=$e.DelimId=void 0;$e.multiLineCommentToken=$e.singleLineCommentToken=$e.unexpectedToken=void 0;var Zt=Jf();$e.DelimId=Zt.token.DelimId;$e.SepId=Zt.token.SepId;$e.TokenKind=Zt.token.TokenKind;$e.TokenOperKind=Zt.token.TokenOperKind;$e.addOperatorToken=Zt.token.addOperatorToken;$e.appendToken=Zt.token.appendToken;$e.assignSepToken=Zt.token.assignSepToken;$e.atOperatorToken=Zt.token.atOperatorToken;$e.badErrorOper=Zt.token.badErrorOper;$e.badNumberOper=Zt.token.badNumberOper;$e.cellRefA1Token=Zt.token.cellRefA1Token;$e.cellRefR1C1Token=Zt.token.cellRefR1C1Token;$e.colSepToken=Zt.token.colSepToken;$e.concatOperatorToken=Zt.token.concatOperatorToken;$e.divOperatorToken=Zt.token.divOperatorToken;$e.dotSepToken=Zt.token.dotSepToken;$e.endToken=Zt.token.endToken;$e.eqOperatorToken=Zt.token.eqOperatorToken;$e.escapeToken=Zt.token.escapeToken;$e.geOperatorToken=Zt.token.geOperatorToken;$e.gtOperatorToken=Zt.token.gtOperatorToken;$e.identOrBooleanToken=Zt.token.identOrBooleanToken;$e.identToken=Zt.token.identToken;$e.isBadErrorOper=Zt.token.isBadErrorOper;$e.isBadNumberOper=Zt.token.isBadNumberOper;$e.isNumberLikeOper=Zt.token.isNumberLikeOper;$e.leOperatorToken=Zt.token.leOperatorToken;$e.leftBraceToken=Zt.token.leftBraceToken;$e.leftBracketToken=Zt.token.leftBracketToken;$e.leftParenToken=Zt.token.leftParenToken;$e.leftSQuoteToken=Zt.token.leftSQuoteToken;$e.listSepToken=Zt.token.listSepToken;$e.literalToken=Zt.token.literalToken;$e.ltOperatorToken=Zt.token.ltOperatorToken;$e.mulOperatorToken=Zt.token.mulOperatorToken;$e.neOperatorToken=Zt.token.neOperatorToken;$e.operatorToken=Zt.token.operatorToken;$e.percentOperatorToken=Zt.token.percentOperatorToken;$e.poundOperatorToken=Zt.token.poundOperatorToken;$e.powOperatorToken=Zt.token.powOperatorToken;$e.qualSepToken=Zt.token.qualSepToken;$e.rangeOperatorToken=Zt.token.rangeOperatorToken;$e.rightBraceToken=Zt.token.rightBraceToken;$e.rightBracketToken=Zt.token.rightBracketToken;$e.rightParenToken=Zt.token.rightParenToken;$e.rightSQuoteToken=Zt.token.rightSQuoteToken;$e.rowSepToken=Zt.token.rowSepToken;$e.spacesToken=Zt.token.spacesToken;$e.specialRefToken=Zt.token.specialRefToken;$e.subOperatorToken=Zt.token.subOperatorToken;$e.unexpectedToken=Zt.token.unexpectedToken;$e.singleLineCommentToken=Zt.token.singleLineCommentToken;$e.multiLineCommentToken=Zt.token.multiLineCommentToken});var I5=T(x5=>{"use strict";p();Object.defineProperty(x5,"__esModule",{value:!0});x5.ConsistentAnonymizer=void 0;var eIe=fe(),GIr=Zxe(),To=$xe(),bte=ti(),M5=Eg(),rIe=Ba(),BIr=function(){function e(){this.nonLiteralStore=new Map,this.literalStore=new Map}return e.prototype.get=function(r,t,n){var a,o;if(r===To.TokenKind.Literal){if(n===void 0)throw new Error("Expected subkind");return(a=this.literalStore.get(n))===null||a===void 0?void 0:a.get(t)}return(o=this.nonLiteralStore.get(r))===null||o===void 0?void 0:o.get(t)},e.prototype.set=function(r,t,n,a){var o,u;if(r===To.TokenKind.Literal){if(a===void 0)throw new Error("Expected subkind");var s=(o=this.literalStore.get(a))!==null&&o!==void 0?o:new Map;s.set(t,n),this.literalStore.set(a,s)}else{var s=(u=this.nonLiteralStore.get(r))!==null&&u!==void 0?u:new Map;s.set(t,n),this.nonLiteralStore.set(r,s)}},e}();function UIr(e){return e===void 0?!1:e.kind===To.TokenKind.Left&&e.value===To.DelimId.Paren}function KIr(e,r){var t=r??e.start;return e.chars==="	"||e.chars===";"?(0,To.unexpectedToken)(t,e.chars):(0,To.unexpectedToken)(t,"	")}function VIr(e){return e.map(function(r){return r.chars}).join("")}var jIr=function(){function e(){this.store=new BIr,this.counter=1}return e.prototype.getAnonymization=function(r,t,n,a){var o=this.store.get(r,n,t);if(o!==void 0)return o;var u=a(this.counter);return this.counter+=1,this.store.set(r,n,u,t),u},e.prototype.anonymizeIdent=function(r,t,n,a){var o=t??r.start,u=n==null?void 0:n.localeInfo.getWorksheetFuncId(r.chars);if(u!==void 0&&UIr(a))return(0,To.identToken)(o,r.chars);var s=this.getAnonymization(r.kind,void 0,r.chars,function(l){return"ident".concat(l)});return(0,To.identToken)(o,s)},e.prototype.anonymizeA1CellRef=function(r,t){if(r.refStyle!==bte.RefStyle.A1)throw new Error("Expected RefStyle.A1");var n=t??r.start,a=this.getAnonymization(r.kind,void 0,r.chars,function(u){return"A".concat(u)}),o=(0,To.cellRefA1Token)(n,a,void 0,void 0);return o},e.prototype.anonymizeR1C1CellRef=function(r,t){if(r.refStyle!==bte.RefStyle.R1C1)throw new Error("Expected RefStyle.R1C1");var n=t??r.start,a=this.getAnonymization(r.kind,void 0,r.chars,function(o){return"R".concat(o,"C").concat(o)});return(0,To.cellRefR1C1Token)(n,a,void 0,void 0)},e.prototype.anonymizeCellRef=function(r,t){return r.refStyle===bte.RefStyle.A1?this.anonymizeA1CellRef(r,t):this.anonymizeR1C1CellRef(r,t)},e.prototype.anonymizeLiteral=function(r,t){var n=t??r.start,a=void 0;switch(r.oper.kind){case M5.OperKind.Number:a=this.getAnonymization(r.kind,r.oper.kind,r.chars,function(s){return"".concat(s)});break;case M5.OperKind.String:a=this.getAnonymization(r.kind,r.oper.kind,r.chars,function(s){return'"s'.concat(s,'"')});break;case To.TokenOperKind.BadNumber:a=this.getAnonymization(r.kind,r.oper.kind,r.chars,function(s){return"1e".concat(s,"000")});break;case To.TokenOperKind.BadError:a=this.getAnonymization(r.kind,r.oper.kind,r.chars,function(s){for(var l=["a"],c="a".charCodeAt(0),d=s;d>0;){var f=s%10,m=String.fromCharCode(c+f);l.push(m),d=Math.floor(d/10)}var v=l.join("");return"#".concat(v)});break;case M5.OperKind.Boolean:case M5.OperKind.Error:a=r.chars;break;default:(0,rIe.assertNever)("error",r.oper)}var o=r.oper,u=r.hasRight;return(0,To.literalToken)(n,a,o,u)},e.prototype.anonymizeToken=function(r,t,n,a){switch(r.kind){case To.TokenKind.Ident:return this.anonymizeIdent(r,t,n,a);case To.TokenKind.CellRef:return this.anonymizeCellRef(r,t);case To.TokenKind.Literal:return this.anonymizeLiteral(r,t);case To.TokenKind.Unexpected:return KIr(r,t);case To.TokenKind.SingleLineComment:return(0,To.singleLineCommentToken)(t,"redacted");case To.TokenKind.MultiLineComment:return(0,To.multiLineCommentToken)(t,"redacted",r.isClosed);case To.TokenKind.End:case To.TokenKind.Left:case To.TokenKind.Right:case To.TokenKind.Sep:case To.TokenKind.Operator:case To.TokenKind.Spaces:case To.TokenKind.SpecialRef:case To.TokenKind.Escape:return eIe.__assign(eIe.__assign({},r),{start:t});default:return(0,rIe.assertNever)("ConsistentAnonymizer.anonymizeToken",r)}},e.prototype.anonymize=function(r,t,n){for(var a=(0,GIr.tokenizeFormula)(t.localeInfo,t.mathpack,t.refStyle,n,r,0,{}),o=[],u=0,s=0;s<a.length;s+=1){var l=a[s],c=s+1<a.length?a[s+1]:void 0,d=this.anonymizeToken(l,u,t,c);u+=d.chars.length,o.push(d)}return VIr(o)},e}();x5.ConsistentAnonymizer=jIr});var uIe=T(Ov=>{"use strict";p();Object.defineProperty(Ov,"__esModule",{value:!0});Ov.formulaCollectionPluginDependenciesResolved=Ov.combineSplitCollectedFormulaLogs=Ov.deserializeSplitCollectedFormulaLog=Ov.FormulaCollectionPlugin=Ov.FormulaCollectionPluginFactory=void 0;var Cte=fe(),yE=Xo(),WIr=yc(),WO=Gi(),tIe=zn(),HIr=Us(),zIr=No(),QIr=nl(),XIr=I5(),nIe=rF(),YIr=tF(),JIr=qi(),aIe=qd(),Tte=ia(),ZIr=Ld();function $Ir(e){for(var r=i2r(e),t=0,n=r;t<n.length;t++){var a=n[t],o=t2r(a);WO.ulsLogger.ULS.dnmTraceTag(537962336,WO.LogCategory.msoulscat_ES_EWAJS,WO.TraceLevel.Info,o)}}function w5(e){WO.ulsLogger.ULS.traceTag(537962337,WO.LogCategory.msoulscat_ES_EWAJS,WO.TraceLevel.Verbose,e)}function e2r(e,r){var t={},n={};return Object.keys(e).forEach(function(a){var o=Number(a),u=e[o];u!==void 0&&(t[a]=u);var s=r.spans[o];s!==void 0&&(n[a]=s)}),{spanDiagnostics:t,spans:n}}var iIe=function(){function e(){this.factoryName=Tte.PluginFactoryName.FormulaCollectionPlugin}return e.prototype.create=function(){return new oIe},e}();Ov.FormulaCollectionPluginFactory=iIe;var oIe=function(){function e(){this.lastEdit=void 0,this.consistentAnonymizer=new XIr.ConsistentAnonymizer,this.sheetIdAnonymization=new Map}return e.prototype.getEditEntry=function(r,t){var n={content:r,cell:t};if(!(this.lastEdit!==void 0&&(0,JIr.isSheetGridCellEqual)(this.lastEdit.cell,t)&&this.lastEdit.content===r))return this.lastEdit=n,n},e.prototype.anonymizeSheetId=function(r){if(this.sheetIdAnonymization.has(r)){var t=this.sheetIdAnonymization.get(r);return t}var n=(0,QIr.getNewGuid)()[0];return this.sheetIdAnonymization.set(r,n),n},e.prototype.run=function(r){var t,n,a,o,u,s,l,c,d,f,m,v,h,y,_,E,N,k,q;return Cte.__generator(this,function(V){switch(V.label){case 0:return[4,{kind:yE.ComputationRequestKind.GetActiveCell}];case 1:return t=V.sent(),t.kind!==yE.ComputationRequestKind.GetActiveCell?(w5(jO.GetActiveCell),[2,null]):(n=t.activeCell,r.content==null?(w5(jO.EmptyContent),[2,null]):r.content.trimLeft().startsWith("=")?(a=this.getEditEntry(r.content,n),a===void 0?[2,null]:[4,{kind:yE.ComputationRequestKind.GetConfig}]):[2,null]);case 2:return o=V.sent(),o.kind!==yE.ComputationRequestKind.GetConfig?(w5(jO.GetConfig),[2,null]):(u=o.config,s=(0,nIe.createAnalyzeGlobals)(u),l=(0,zIr.lexicalSourceCell)(a.cell),c=(0,nIe.analyzeLocalsGrid)(l.kind,l.range),d=(0,YIr.createAnalyzer)(s),f=this.consistentAnonymizer.anonymize(a.content,u,n.range),[4,{kind:yE.ComputationRequestKind.ParseEdit,cell:a.cell,formulaBarText:f}]);case 3:return m=V.sent(),m.kind!==yE.ComputationRequestKind.ParseEdit||!(0,tIe.isSuccess)(m.result)?(w5(jO.ParseEdit),[2,null]):m.result.value.kind!==HIr.EditKind.Formula?[2,null]:(v=m.result.value.formula,h=v.isWellFormed,y=void 0,h||(_=d.checkFormulaWithDiagnostics(c,v),(0,tIe.isSuccess)(_)&&(E=_==null?void 0:_.value[1],E!==void 0&&(y=e2r(E,v)))),[4,{kind:yE.ComputationRequestKind.GetCorrelationId}]);case 4:return N=V.sent(),N.kind!=="GetCorrelationId"?[2,null]:(k=N.correlationId,q={v:e.formulaCollectionVersion,f,ok:h,d:y,c:{s:this.anonymizeSheetId(a.cell.sheet.index),c:a.cell.range.col,r:a.cell.range.row},i:k},$Ir(q),[2,null])}})},e.factoryName=Tte.PluginFactoryName.FormulaCollectionPlugin,e.formulaCollectionVersion=1,e}();Ov.FormulaCollectionPlugin=oIe;var r2r=2300;function t2r(e){return e.correlationId.toString()+","+e.logPartId.toString()+","+e.partialMessage}function n2r(e){var r=e,t=r.indexOf(","),n=Number(r.slice(0,t));r=r.slice(t+1),t=r.indexOf(",");var a=Number(r.slice(0,t)),o=r.slice(t+1);return{correlationId:n,logPartId:a,partialMessage:o}}Ov.deserializeSplitCollectedFormulaLog=n2r;function a2r(e,r,t){var n=t.toString().length+r.toString().length+2,a=r2r-n,o=e.slice(0,a),u={correlationId:t,logPartId:r,partialMessage:o},s=e.slice(a);return[u,s]}function i2r(e){for(var r=JSON.stringify(e),t=0,n=[];r.length>0;){var a=a2r(r,t,e.i),o=a[0],u=a[1];r=u,t+=1,n.push(o)}return n}function o2r(e){var r=e.sort(function(t){return t.logPartId}).map(function(t){return t.partialMessage}).join("");return JSON.parse(r)}Ov.combineSplitCollectedFormulaLogs=o2r;var jO;(function(e){e.GetActiveCell="GetActiveCell failed",e.GetConfig="GetConfig failed",e.ParseEdit="ParseEdit failed",e.EmptyContent="empty content"})(jO||(jO={}));(0,WIr.registerPluginFactory)(new iIe);Ov.formulaCollectionPluginDependenciesResolved=(0,ZIr.trackableAsyncLazy)(function(){return Cte.__awaiter(void 0,void 0,void 0,function(){var e;return Cte.__generator(this,function(r){switch(r.label){case 0:return[4,aIe.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(Tte.PluginFactoryName.FormulaCollectionPlugin)];case 2:return r.sent(),[4,aIe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})},"formulaCollectionPluginDependenciesResolved")});var cIe=T(D5=>{"use strict";p();Object.defineProperty(D5,"__esModule",{value:!0});D5.ValuePreviewVisitor=void 0;var u2r=fe(),s2r=Ba(),sIe=nl(),_E=Ar(),HO=ti(),l2r=Qf(),c2r=ks(),lIe=mi(),d2r=function(e){u2r.__extends(r,e);function r(t,n,a,o){var u=e.call(this)||this;return u.parsedFormulaTree=t,u.selectionStart=n,u.selectionEnd=a,u.formula=o,u.subFormulaStart=-1,u.subFormulaEnd=-1,u.isBadSelection=!1,u.isRefNode=!1,u.isVolatile=!1,u.letDefinitions=void 0,u.volatileFunctions=[],u.nodeLabel=-1,u.isBadSelectionValidationEnabled=(0,lIe.isChangeGateEnabled)("OfficeVSO:8549607_ValuePreviewBadSelection"),u.isDetectVolatileEnabled=(0,lIe.isChangeGateEnabled)("OfficeVSO:8501487_ValuePreviewDetectVolatile"),u}return r.prototype.appNode=function(t,n,a,o){var u=e.prototype.appNode.call(this,t,n,a,o);return this.tryUpdateAppNodeAsSubFormula(t,u),u},r.prototype.literalNode=function(t,n,a){var o=e.prototype.literalNode.call(this,t,n,a);return this.tryUpdateNodeAsSubFormula(o),o},r.prototype.missingNode=function(t,n){var a=e.prototype.missingNode.call(this,t,n);return this.tryUpdateNodeAsSubFormula(a),a},r.prototype.arrayNode=function(t,n,a){var o=e.prototype.arrayNode.call(this,t,n,a);return this.tryUpdateNodeAsSubFormula(o),o},r.prototype.cellRefNode=function(t,n,a){var o=e.prototype.cellRefNode.call(this,t,n,a);return this.validateSelection(a,"whole"),this.tryUpdateNodeAsSubFormula(o)&&(this.isRefNode=!0),o},r.prototype.fieldRefNode=function(t,n,a){var o=e.prototype.fieldRefNode.call(this,t,n,a);return this.validateSelection(a,"prefix"),this.tryUpdateNodeAsSubFormula(o),o},r.prototype.structRefNode=function(t,n,a){var o=e.prototype.structRefNode.call(this,t,n,a);return this.validateSelection(a,"prefix"),this.tryUpdateNodeAsSubFormula(o)&&(this.isRefNode=!0),o},r.prototype.nameNode=function(t,n,a){var o=e.prototype.nameNode.call(this,t,n,a);return this.validateSelection(a,"prefix"),this.tryUpdateNodeAsSubFormula(o)&&(this.isRefNode=!0),o},r.prototype.badSequenceNode=function(t,n,a){var o=this,u=e.prototype.badSequenceNode.call(this,t,n,a);return n.some(function(s){return s.label===o.nodeLabel})&&(this.updateNodeAsSubFormula(u),this.isBadSelection=!0),u},r.prototype.parenNode=function(t,n,a){var o=e.prototype.parenNode.call(this,t,n,a);return n&&this.tryUpdateNodeAsSubFormula(o),o},r.prototype.letNode=function(t,n,a,o,u,s){var l=e.prototype.letNode.call(this,t,n,a,o,u,s),c=this.parsedFormulaTree.spans[s];return this.isMatchingArg(c,!0)&&this.updateLetNodeAsSubFormula(l),l},r.prototype.wsfNode=function(t,n,a){var o=e.prototype.wsfNode.call(this,t,n,a);return this.validateSelection(a,"none"),o},r.prototype.operatorNode=function(t,n){var a=e.prototype.operatorNode.call(this,t,n);return this.validateSelection(n,"none"),a},r.prototype.tryUpdateNodeAsSubFormula=function(t){return this.isMinimalMatchingSpan(this.parsedFormulaTree.spans[t.label])?(this.updateNodeAsSubFormula(t),!0):!1},r.prototype.tryUpdateAppNodeAsSubFormula=function(t,n){if(!(t.kind===HO.NodeKind.WSF||t.kind===HO.NodeKind.Operator)){s2r.ulsLogger.ULS.traceTag(509347166,sIe.LogCategory.msoulscat_ES_EWAJS,sIe.TraceLevel.Info,"ValuePreviewVisitor - visitor encountered higher order function, kind: ".concat(t.kind));return}var a=this.parsedFormulaTree.spans[t.label],o=this.parsedFormulaTree.spans[n.label];this.tryAddVolatileFunction(t,n),this.isMatchingAppNode(a,o,t.kind,n.isClosed)&&this.updateNodeAsSubFormula(n)},r.prototype.updateLetNodeAsSubFormula=function(t){var n=this.parsedFormulaTree.spans[t.head.label],a=this.parsedFormulaTree.spans[t.label];if(this.isMatchingAppNode(n,a,HO.NodeKind.WSF,t.isClosed)){this.updateNodeAsSubFormula(t);return}for(var o=0;o<t.args.length;o++){var u=t.args[o],s=this.parsedFormulaTree.spans[u.label];if(!(0,_E.isDefined)(s))return;if(this.isMatchingArg(s,!0)){if(o===1)return;var l=o%2===0,c=t.args.length-2,d=l?Math.min(c,o+1):o-2,f=this.parsedFormulaTree.spans[t.args[d].label];if(!(0,_E.isDefined)(f))return;var m=this.formula.substring(a.start,f.end);this.letDefinitions=m,this.isVolatile=this.checkIntersectionWithVolatileFunction(a),this.isMinimalMatchingSpan(s)&&(this.subFormulaStart=s.start,this.subFormulaEnd=s.end,this.nodeLabel=u.label)}}},r.prototype.updateNodeAsSubFormula=function(t){var n=this.parsedFormulaTree.spans[t.label];this.subFormulaStart=n.start,this.subFormulaEnd=n.end,this.nodeLabel=t.label,this.isVolatile=this.checkIntersectionWithVolatileFunction(n)},r.prototype.isMinimalMatchingSpan=function(t){return this.nodeLabel!==-1?!1:this.isMatchingArg(t)},r.prototype.isMatchingArg=function(t,n){return n===void 0&&(n=!1),(0,_E.isDefined)(t)?this.selectionStart===this.selectionEnd?this.selectionStart>=t.start&&this.selectionEnd<t.end:n?this.selectionStart>=t.start&&this.selectionEnd<=t.end:this.selectionStart===t.start&&this.selectionEnd===t.end:!1},r.prototype.isMatchingAppNode=function(t,n,a,o){if(!(0,_E.isDefined)(t)||!(0,_E.isDefined)(n)||!o)return!1;if(this.selectionStart===this.selectionEnd)switch(a){case HO.NodeKind.WSF:return this.selectionStart===t.end||this.selectionStart===n.end-1?!0:this.selectionStart>=t.start&&this.selectionStart<t.end;case HO.NodeKind.Operator:return this.selectionStart>=t.start-t.pre.length&&this.selectionStart<t.end+t.post.length}else if(this.isBadSelectionValidationEnabled&&t.start<=this.selectionStart&&this.selectionEnd<=t.end)return this.isBadSelection=!0,!1;return this.selectionStart===n.start&&this.selectionEnd===n.end},r.prototype.tryAddVolatileFunction=function(t,n){if(this.isDetectVolatileEnabled&&t.kind===HO.NodeKind.WSF&&n.isClosed){var a=this.parsedFormulaTree.spans[n.label];(0,_E.isNone)(a)||(0,l2r.isVolatileFunc)(t.id)&&this.volatileFunctions.push({start:a.start,end:a.end})}},r.prototype.checkIntersectionWithVolatileFunction=function(t){return this.isDetectVolatileEnabled?this.volatileFunctions.some(function(n){return t.start<=n.start&&t.end>=n.end}):!1},r.prototype.validateSelection=function(t,n){if(this.isBadSelectionValidationEnabled&&this.selectionStart!==this.selectionEnd){var a=this.parsedFormulaTree.spans[t];if((0,_E.isDefined)(a)&&!(this.selectionStart<a.start||this.selectionEnd>a.end))switch(n){case"prefix":{this.selectionStart!==a.start&&(this.isBadSelection=!0);return}case"suffix":{this.selectionEnd!==a.end&&(this.isBadSelection=!0);return}case"whole":{(this.selectionStart!==a.start||this.selectionEnd!==a.end)&&(this.isBadSelection=!0);return}case"none":{this.isBadSelection=!0;return}}}},r}(c2r.IdentityVisitor);D5.ValuePreviewVisitor=d2r});var Ete=T(q5=>{"use strict";p();Object.defineProperty(q5,"__esModule",{value:!0});q5.ValuePreviewResultExtractor=void 0;var dIe=fe(),f2r=Ar(),q2=zn(),HS=Eg(),Rte=_y(),L5=Us(),N_=uv(),p2r=ep(),m2r=Ba(),fIe=dL(),G2=mi(),g2r=function(){function e(r){this.onlyFallbackToServerOnSpecificErrorsEnabled=(0,G2.isChangeGateEnabled)("OfficeVSO:8501092_ValuePreviewSpecificErrorFallback"),this.isUnavailableDetailedReasonEnabled=(0,G2.isChangeGateEnabled)("OfficeVSO:8545001_ValuePreviewUnavailableReason"),this.isUnformattedStringFixEnabled=(0,G2.isChangeGateEnabled)("OfficeVSO:8524802_ValuePreviewUnformattedString"),this.isBooleanFixEnabled=(0,G2.isChangeGateEnabled)("OfficeVSO:8561267_ValuePreviewUnformattedBoolean"),this.isUnformattedBlankFixEnabled=(0,G2.isChangeGateEnabled)("OfficeVSO:8554558_ValuePreviewUnformattedBlank"),this.mathpack=r.mathpack,this.localeInfo=r.localeInfo}return e.prototype.fromEvalFormulaOutput=function(r){var t=r.value,n=r.formatted;switch(t.kind){case q2.ResultKind.Success:return this.resultFromSuccess(t.value,n);case q2.ResultKind.Failure:return this.resultFromFailureReason(t.reason);default:{var a=t;return a}}},e.prototype.resultFromSuccess=function(r,t){var n;switch(r.kind){case HS.OperKind.String:case HS.OperKind.Array:case HS.OperKind.Blank:case HS.OperKind.Number:{n=this.resultFromFormatted(t);break}case HS.OperKind.Boolean:{n=this.isBooleanFixEnabled?this.resultFromBoolean(r):this.resultFromFormatted(t);break}case HS.OperKind.Error:{n=this.resultFromError(r,t);break}default:return{kind:"Failure",reason:"Unsupported operKind: ".concat(r.kind)}}if(n.kind!=="Success")return n;var a=this.getUnformattedValue(r,n);return dIe.__assign(dIe.__assign({},n),{unformattedValue:a,operKind:r.kind})},e.prototype.resultFromFormatted=function(r){if((0,f2r.isNone)(r))return{kind:"Failure",reason:"No formatted value"};switch(r.kind){case q2.ResultKind.Success:{if((0,L5.isHashesValue)(r.value)){var t=r.value.units;return v2r("Evaluate HashesValue: ".concat(t.kind)),{kind:"Failure",reason:"HashesValue: ".concat(t.kind)}}return this.resultFromFormattedValue(r.value)}case q2.ResultKind.Failure:return this.resultFromFailureReason(r.reason);default:{var n=r;return n}}},e.prototype.resultFromFormattedValue=function(r){var t=p2r.render.renderValue(this.mathpack,r,L5.renderInfiniteWidth);if(t.kind===q2.ResultKind.Failure)return{kind:"Failure",reason:"renderValue fail"};if((0,L5.isHashesValue)(t.value)){var n=t.value.units;return{kind:"Failure",reason:"Render HashesValue: ".concat(n.kind)}}var a=(0,L5.renderedValueToString)(t.value);return{kind:"Success",value:a,color:r.color}},e.prototype.resultFromFailureReason=function(r){if(!this.isUnavailableDetailedReasonEnabled)return this.resultFromFailureReasonOld(r);var t=h2r(r);switch(r.kind){case N_.ReasonKind.Unavailable:case N_.ReasonKind.NotImplemented:case N_.ReasonKind.PreviousFailure:return{kind:"Unavailable",reason:"FailureReason: ".concat(t)};default:return{kind:"Failure",reason:"Unsupported FailureReason: ".concat(t)}}},e.prototype.resultFromFailureReasonOld=function(r){switch(r.kind){case N_.ReasonKind.Unavailable:case N_.ReasonKind.NotImplemented:case N_.ReasonKind.PreviousFailure:return{kind:"Unavailable",reason:"FailureReason: ".concat(r.kind)};default:return{kind:"Failure",reason:"Unsupported FailureReason: ".concat(r.kind)}}},e.prototype.resultFromError=function(r,t){if(!this.onlyFallbackToServerOnSpecificErrorsEnabled)return{kind:"Unavailable",reason:"Unsupported error: ".concat(r.type)};switch(r.type){case Rte.ErrorType.NAME:case Rte.ErrorType.VALUE:case Rte.ErrorType.FIELD:return{kind:"Unavailable",reason:"Unsupported error: ".concat(r.type)}}return this.resultFromFormatted(t)},e.prototype.getUnformattedValue=function(r,t){var n=t.value;return r.kind===HS.OperKind.String&&(t.value='"'.concat(t.value,'"'),this.isUnformattedStringFixEnabled&&(n=r.value)),r.kind===HS.OperKind.Number&&(n=this.mathpack.toNumber(r).toString()),r.kind===HS.OperKind.Blank&&this.isUnformattedBlankFixEnabled&&(n=this.mathpack.toNumber(this.mathpack.zero).toString()),n},e.prototype.resultFromBoolean=function(r){var t=r.value?this.localeInfo.trueName:this.localeInfo.falseName;return{kind:"Success",value:t,unformattedValue:t,operKind:HS.OperKind.Boolean}},e}();q5.ValuePreviewResultExtractor=g2r;function v2r(e){m2r.ulsLogger.ULS.traceTag(520680450,fIe.LogCategory.msoulscat_ES_EWAJS,fIe.TraceLevel.Warning,"ValuePreviewResultExtractor encountered a failure with msg ".concat(e))}function h2r(e){switch(e.kind){case N_.ReasonKind.Unavailable:return"Unavailable - [".concat(e.objects.map(function(r){return"kind"in r?r.kind:""}).join(","),"]");case N_.ReasonKind.NotImplemented:return"NotImplemented - [".concat(e.features.join(","),"]");case N_.ReasonKind.PreviousFailure:return"PreviousFailure";default:return"".concat(e.kind)}}});var Ate=T(zO=>{"use strict";p();Object.defineProperty(zO,"__esModule",{value:!0});zO.valuePreviewPluginDependenciesResolved=zO.ValuePreviewPluginFactory=void 0;var gl=fe(),kv=Xo(),S2r=yc(),pIe=qd(),CE=zn(),y2r=Us(),b1=Ar(),mIe=Ba(),G5=nl(),gIe=cIe(),vIe=ks(),_2r=Ete(),hIe=ia(),b2r=v_(),B2=mi(),C2r=b2r.types.SpecialFormat,T2r=QR(),Pte=No(),R2r=Ld(),SIe=function(){function e(){this.factoryName=hIe.PluginFactoryName.ValuePreviewPlugin}return e.prototype.create=function(){var r=new E2r;return r},e}();zO.ValuePreviewPluginFactory=SIe;var E2r=function(){function e(){this.isLocalizedLetEnabled=(0,B2.isChangeGateEnabled)("OfficeVSO:8549693_ValuePreviewLocalizedLet"),this.isDetectVolatileEnabled=(0,B2.isChangeGateEnabled)("OfficeVSO:8501487_ValuePreviewDetectVolatile"),this.isRelabelPluginFailuresEnabled=(0,B2.isChangeGateEnabled)("OfficeVSO:8544629_ValuePreviewFailureCaching"),this.isSnapshotActiveCellEnabled=(0,B2.isChangeGateEnabled)("OfficeVSO:8561808_ValuePreviewSnapshotActiveCell"),this.isFailOnEmptyFormulaEnabled=(0,B2.isChangeGateEnabled)("OfficeVSO:8983026_ValuePreviewEmptyFormula")}return e.prototype.run=function(r){var t,n,a,u,o,u,s,l,c,d,f,m,v,h,y,_,E,N,k,q,V=r.text,I=r.index,M=r.length,B=r.activeCell;return gl.__generator(this,function(U){switch(U.label){case 0:return(0,b1.isNone)(V)||(0,b1.isNone)(I)||(0,b1.isNone)(M)?(bE("missing request arguments"),[2,null]):I<0||I+M>V.length?(bE("invalid selection, ".concat(V.length,", ").concat(I,", ").concat(M)),[2,null]):[4,{kind:kv.ComputationRequestKind.GetActiveCell}];case 1:return t=U.sent(),t.kind!==kv.ComputationRequestKind.GetActiveCell?this.isRelabelPluginFailuresEnabled?[2,{kind:"Failure",index:I,length:M,reason:"GetActiveCell failed"}]:(bE("GetActiveCell fail"),[2,null]):(n=t.activeCell,!this.isSnapshotActiveCellEnabled||(0,b1.isNone)(B)||(0,b1.isNone)(B.sheetName)||F2r(n,B)?[4,{kind:kv.ComputationRequestKind.ParseActiveCell,formulaText:V}]:[3,3]);case 2:return u=U.sent(),u.kind!==kv.ComputationRequestKind.ParseActiveCell||!(0,CE.isSuccess)(u.result)?[2,null]:u.result.value.kind!==y2r.EditKind.Formula?[2,null]:(a=u.result.value.formula,[3,5]);case 3:return o=(0,Pte.unsafeGridRange)(B.firstRow,B.firstColumn,1,1),n=(0,Pte.sheetGridCell)((0,Pte.sheetIndex)(n.sheet.document,B.sheetName),o),[4,{kind:kv.ComputationRequestKind.ParseCellFormula,cell:n,formula:{formulaBarText:V,kind:T2r.FormulaKind.CellFormula},useEnglishLocaleInfo:!1}];case 4:if(u=U.sent(),u.kind!==kv.ComputationRequestKind.ParseCellFormula||!(0,CE.isSuccess)(u.result))return[2,null];a=u.result.value,U.label=5;case 5:return s=this.isDetectVolatileEnabled?P2r(V,I,M,a):A2r(V,I,M,a),s.kind!=="Success"?[2,null]:(l=s.value.subFormula,c=s.value,d=c.subFormulaSpan,f=c.isVolatile,m=c.letDefinitions,v={index:d.start,length:d.end-d.start},!this.isLocalizedLetEnabled&&(0,b1.isDefined)(m)&&(l=m+", "+l+")"),[4,{kind:kv.ComputationRequestKind.GetConfig}]);case 6:return h=U.sent(),h.kind!==kv.ComputationRequestKind.GetConfig?this.isRelabelPluginFailuresEnabled?[2,gl.__assign(gl.__assign({kind:"Failure"},v),{reason:"GetConfig failed"})]:(bE("GetConfig fail"),[2,null]):(this.isLocalizedLetEnabled&&(0,b1.isDefined)(m)&&(l=m+h.config.localeInfo.listSeparator+l+")"),y=(l.startsWith("=")?"":"=")+l,this.isFailOnEmptyFormulaEnabled&&y==="="?[2,gl.__assign(gl.__assign({kind:"Failure"},v),{reason:"Empty formula"})]:[4,{kind:kv.ComputationRequestKind.GetActiveCellFormat}]);case 7:return _=U.sent(),_.kind!==kv.ComputationRequestKind.GetActiveCellFormat?(bE("GetActiveCellFormat failed"),[2,gl.__assign(gl.__assign({kind:"Unavailable",evaluatedFormula:y},v),{isVolatile:f,reason:"GetActiveCellFormat failed"})]):!(0,CE.isSuccess)(_.result)||(0,b1.isNone)(_.result.value)?(bE("Empty cell format"),[2,gl.__assign(gl.__assign({kind:"Unavailable",evaluatedFormula:y},v),{isVolatile:f,reason:"Empty cell format"})]):(E={kind:C2r.Edit,renderBlanksAsZeros:!0,isWholeFormula:y===V},[4,{kind:kv.ComputationRequestKind.EvalFormula,formula:y,origin:{sheet:n.sheet,range:{col:n.range.col,row:n.range.row,rows:1,cols:1}},format:E}]);case 8:if(N=U.sent(),N.kind!==kv.ComputationRequestKind.EvalFormula)return this.isRelabelPluginFailuresEnabled?[2,gl.__assign(gl.__assign({kind:"Failure",evaluatedFormula:y},v),{reason:"EvalFormula failed"})]:(bE("EvalFormula failed"),[2,null]);switch(k=new _2r.ValuePreviewResultExtractor(h.config),q=k.fromEvalFormulaOutput(N.result),q.kind){case"Success":return[2,gl.__assign(gl.__assign(gl.__assign(gl.__assign({},q),{evaluatedFormula:y}),v),{isVolatile:f})];case"Unavailable":return[2,gl.__assign(gl.__assign({kind:q.kind,evaluatedFormula:y},v),{isVolatile:f,reason:q.reason})];case"Failure":return[2,gl.__assign(gl.__assign({kind:q.kind,evaluatedFormula:y},v),{reason:q.reason})]}return[2]}})},e}();function P2r(e,r,t,n){var a;r===0?a={start:1,end:t>0?t:e.length}:a={start:r,end:r+t};var o=new gIe.ValuePreviewVisitor(n,a.start,a.end,e);(0,vIe.reduceBottomUp)(o,n);var u;if(t===0?u={start:r===0?r:o.subFormulaStart,end:o.subFormulaEnd}:u={start:r,end:r+t},u.start===-1||u.end===u.start||o.isBadSelection||t>0&&!yIe(n,u))return(0,CE.failure)("invalid selection");var s=e.substring(u.start,u.end);return(0,CE.success)({subFormula:s,subFormulaSpan:u,isVolatile:o.isVolatile,letDefinitions:o.letDefinitions})}function A2r(e,r,t,n){var a,o=void 0;if(e.startsWith("=")&&r===0&&t===0||t===e.length)a={start:0,end:e.length};else if(o=new gIe.ValuePreviewVisitor(n,r,r+t,e),(0,vIe.reduceBottomUp)(o,n),a=t===0?{start:o.subFormulaStart,end:o.subFormulaEnd}:{start:r,end:r+t},a.start===-1||a.end===a.start||o.isBadSelection||t>0&&!yIe(n,a))return(0,CE.failure)("invalid selection");var u=e.substring(a.start,a.end);return(0,CE.success)({subFormula:u,subFormulaSpan:a,isVolatile:!1,letDefinitions:o==null?void 0:o.letDefinitions})}function yIe(e,r){var t=r.start===0,n=t||Object.keys(e.spans).some(function(o){var u;return((u=e.spans[Number(o)])===null||u===void 0?void 0:u.start)===r.start}),a=Object.keys(e.spans).some(function(o){var u;return((u=e.spans[Number(o)])===null||u===void 0?void 0:u.end)===r.end});return n&&a}function F2r(e,r){var t=[];return e.sheet.index!==r.sheetName&&t.push("sheet"),e.range.col!==r.firstColumn&&t.push("col"),e.range.row!==r.firstRow&&t.push("row"),t.length>0&&mIe.ulsLogger.ULS.traceTag(507777486,G5.LogCategory.msoulscat_ES_EWAJS,G5.TraceLevel.Info,"ValuePreviewPlugin.areCellsEqual - active cell diff: ".concat(t.join(","))),t.length===0}function bE(e){mIe.ulsLogger.ULS.traceTag(521692767,G5.LogCategory.msoulscat_ES_EWAJS,G5.TraceLevel.Warning,"ValuePreviewPlugin encountered a failure with msg ".concat(e))}(0,S2r.registerPluginFactory)(new SIe);zO.valuePreviewPluginDependenciesResolved=(0,R2r.trackableAsyncLazy)(function(){return gl.__awaiter(void 0,void 0,void 0,function(){var e;return gl.__generator(this,function(r){switch(r.label){case 0:return[4,pIe.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(hIe.PluginFactoryName.ValuePreviewPlugin)];case 2:return r.sent(),[4,pIe.schedulerWithRecalcServiceAttached.getValue()];case 3:return r.sent(),[2]}})})},"valuePreviewPluginDependenciesResolved")});var bIe=T(U5=>{"use strict";p();Object.defineProperty(U5,"__esModule",{value:!0});U5.pythonAutocompletePluginAttach=void 0;var B5=fe(),N2r=qd(),O2r=Ms(),k2r=ia(),_Ie=Ld(),M2r=(0,_Ie.trackableAsyncLazy)(function(){return B5.__awaiter(void 0,void 0,void 0,function(){var e;return B5.__generator(this,function(r){switch(r.label){case 0:return[4,N2r.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript((0,O2r.isTypedChangeGateEnabled)("Microsoft.Office.Excel.X10IntelligentPythonWP5")?"pythonIntelliSenseWP5":"pythonIntelliSense",!1)];case 2:return r.sent(),[2,e]}})})},"threadWithExcelOnlinePythonPluginScriptLoaded");U5.pythonAutocompletePluginAttach=(0,_Ie.trackableAsyncLazy)(function(){return B5.__awaiter(void 0,void 0,void 0,function(){var e;return B5.__generator(this,function(r){switch(r.label){case 0:return[4,M2r.getValue()];case 1:return e=r.sent(),[4,e.createAndAttachPlugin(k2r.PluginFactoryName.PythonAutocompletePlugin)];case 2:return r.sent(),[2]}})})},"pythonAutocompletePluginAttach")});var CIe=T(Mv=>{"use strict";p();Object.defineProperty(Mv,"__esModule",{value:!0});Mv.formulaTranspilerPluginAttach=Mv.setCellPreftechPluginAttach=Mv.formulaByExamplePluginAttach=Mv.formulaRepairShadowEvalPluginDependenciesResolved=Mv.syntaxErrorsPluginDependenciesResolved=void 0;var xv=fe(),U2=ia(),QO=qd(),XO=Ld(),K5=(0,XO.trackableAsyncLazy)(function(){return xv.__awaiter(void 0,void 0,void 0,function(){var e;return xv.__generator(this,function(r){switch(r.label){case 0:return[4,QO.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript("excelOnlineX10Plugins",!1)];case 2:return r.sent(),[2,e]}})})},"threadWithExcelOnlineX10PluginsScriptLoaded");Mv.syntaxErrorsPluginDependenciesResolved=(0,XO.trackableAsyncLazy)(function(){return xv.__awaiter(void 0,void 0,void 0,function(){var e;return xv.__generator(this,function(r){switch(r.label){case 0:return[4,K5.getValue()];case 1:return e=r.sent(),[4,QO.schedulerWithRecalcServiceAttached.getValue()];case 2:return r.sent(),[4,e.createAndAttachPlugin(U2.PluginFactoryName.SyntaxErrorsPlugin)];case 3:return r.sent(),[2]}})})},"syntaxErrorsPluginDependenciesResolved");Mv.formulaRepairShadowEvalPluginDependenciesResolved=(0,XO.trackableAsyncLazy)(function(){return xv.__awaiter(void 0,void 0,void 0,function(){var e;return xv.__generator(this,function(r){switch(r.label){case 0:return[4,K5.getValue()];case 1:return e=r.sent(),[4,QO.schedulerWithRecalcServiceAttached.getValue()];case 2:return r.sent(),[4,e.createAndAttachPlugin(U2.PluginFactoryName.FormulaRepairShadowEvalPlugin)];case 3:return r.sent(),[2]}})})},"formulaRepairShadowEvalPluginDependenciesResolved");Mv.formulaByExamplePluginAttach=(0,XO.trackableAsyncLazy)(function(){return xv.__awaiter(void 0,void 0,void 0,function(){var e;return xv.__generator(this,function(r){switch(r.label){case 0:return[4,K5.getValue()];case 1:return e=r.sent(),[4,QO.schedulerWithRecalcServiceAttached.getValue()];case 2:return r.sent(),[4,e.createAndAttachPlugin(U2.PluginFactoryName.FormulaByExamplePlugin)];case 3:return r.sent(),[2]}})})},"formulaByExamplePluginAttach");Mv.setCellPreftechPluginAttach=(0,XO.trackableAsyncLazy)(function(){return xv.__awaiter(void 0,void 0,void 0,function(){var e;return xv.__generator(this,function(r){switch(r.label){case 0:return[4,K5.getValue()];case 1:return e=r.sent(),[4,QO.schedulerWithRecalcServiceAttached.getValue()];case 2:return r.sent(),[4,e.createAndAttachPlugin(U2.PluginFactoryName.SetCellPrefetchPlugin)];case 3:return r.sent(),[2]}})})},"setCellPreftechPluginAttach");Mv.formulaTranspilerPluginAttach=(0,XO.trackableAsyncLazy)(function(){return xv.__awaiter(void 0,void 0,void 0,function(){var e;return xv.__generator(this,function(r){switch(r.label){case 0:return[4,QO.workerThreadSpread.getValue()];case 1:return e=r.sent(),[4,e.loadPluginScript("excelOnlineFormulaTranspiler",!1)];case 2:return r.sent(),[4,e.createAndAttachPlugin(U2.PluginFactoryName.FormulaTranspilerPlugin)];case 3:return r.sent(),[2]}})})},"formulaTranspilerPluginAttach")});var OIe=T(um=>{"use strict";p();var Zo,K2,V2,Fte,Nte;Object.defineProperty(um,"__esModule",{value:!0});um.ensureGroupAttachedLegacy=um.ensureGroupAttached=um.ensurePluginAttached=um.setX10Features=um.ensurePluginAttachedLegacy=um.resolveScriptLoaderPromise=void 0;var C1=fe(),W2=Ms(),x2r=Kre(),YO=Vxe(),Ote=qd(),I2r=jre(),w2r=zre(),D2r=ite(),L2r=mte(),q2r=Jxe(),G2r=Qre(),B2r=Jre(),U2r=uIe(),K2r=ete(),V2r=nte(),j2r=Ate(),W2r=bIe(),TIe=Gi(),H2r=Ar(),V5=Xp(),kte=sE(),RIe=Kh(),Ga=ia(),j2=CIe(),EIe=w6(),j5={Web:(Zo={},Zo[Ga.PluginFactoryName.ArgumentAssistancePlugin]=[x2r.argumentAssistancePluginDependenciesResolved,void 0,void 0,"ArgumentAssistance"],Zo[Ga.PluginFactoryName.AutocompletePlugin]=[YO.autocompletePluginDependenciesResolved,void 0,void 0,"SmartSuggestionsAutoComplete"],Zo[Ga.PluginFactoryName.AutocompleteFunctionPlugin]=[I2r.autocompleteFunctionPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],Zo[Ga.PluginFactoryName.ParenthesesCouplingPlugin]=[D2r.parenthesesCouplingPluginDependenciesResolved,void 0,void 0,"ParenthesisCoupling"],Zo[Ga.PluginFactoryName.ColoredReferencesPlugin]=[L2r.coloredReferencesPluginDependenciesResolved,void 0,void 0,"ColoredReferences"],Zo[Ga.PluginFactoryName.GotoCtrlClickPlugin]=[q2r.gotoCtrlClickPluginDependenciesResolved,void 0,void 0,"GotoCtrlClick"],Zo[Ga.PluginFactoryName.AutocompleteLetPlugin]=[G2r.autocompleteLetPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],Zo[Ga.PluginFactoryName.AutocompleteRichValuePlugin]=[B2r.autocompleteRichValuePluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],Zo[Ga.PluginFactoryName.FormulaCollectionPlugin]=[U2r.formulaCollectionPluginDependenciesResolved,"Microsoft.Office.Excel.FormulaCollection"],Zo[Ga.PluginFactoryName.AutocompleteNamedObjectsPlugin]=[K2r.autocompleteNamedObjectsPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],Zo[Ga.PluginFactoryName.ParserPerformanceMeasurements]=[YO.parserPerformanceMeasurementsAttach,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements"],Zo[Ga.PluginFactoryName.AutocompleteTableHeadersPlugin]=[V2r.autocompleteTableHeadersPluginDependenciesResolved,void 0,void 0,"SimpleAutoComplete"],Zo[Ga.PluginFactoryName.ValuePreviewPlugin]=[j2r.valuePreviewPluginDependenciesResolved,void 0,void 0,"ValuePreview"],Zo[Ga.PluginFactoryName.SyntaxErrorsPlugin]=[j2.syntaxErrorsPluginDependenciesResolved,void 0,void 0,"SyntaxErrors"],Zo[Ga.PluginFactoryName.AutocompleteRangeSuggestionPlugin]=[YO.autocompleteRangeSuggestionPluginAttach,"Microsoft.Office.Excel.AutocompleteRangeSuggestionPlugin"],Zo[Ga.PluginFactoryName.AutocompleteWrapperPlugin]=[YO.autocompleteWrapperPluginAttach,"Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled"],Zo[Ga.PluginFactoryName.AutocompleteBinaryModelExperimentPlugin]=[YO.autocompleteBinaryModelExperimentPluginAttach,"Microsoft.Office.Excel.x10AutocompleteBinaryModelExperimentPlugin"],Zo[Ga.PluginFactoryName.FormulaRepairShadowEvalPlugin]=[j2.formulaRepairShadowEvalPluginDependenciesResolved,"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled"],Zo[Ga.PluginFactoryName.PythonAutocompletePlugin]=[W2r.pythonAutocompletePluginAttach,"Microsoft.Office.Excel.x10PythonAutocompletionEnabled"],Zo[Ga.PluginFactoryName.ChatGPTPlugin]=[YO.chatGPTPluginAttach,"Microsoft.Office.Excel.ChatGPTPluginEnabled"],Zo[Ga.PluginFactoryName.FormulaByExamplePlugin]=[j2.formulaByExamplePluginAttach,"Microsoft.Office.Excel.FormulaByExamplePluginSuggestionShowing"],Zo[Ga.PluginFactoryName.TestPlugin]=[Ote.workerThreadInitialized,"Microsoft.Office.Excel.MockWorkerThreadPlugin"],Zo[Ga.PluginFactoryName.AutocompleteEnumPlugin]=[w2r.autocompleteEnumPluginDependenciesResolved,void 0,void 0,"EnumAutoComplete"],Zo[Ga.PluginFactoryName.SetCellPrefetchPlugin]=[j2.setCellPreftechPluginAttach,"Microsoft.Office.Excel.SetCellPrefetchPluginEnabled"],Zo[Ga.PluginFactoryName.FormulaTranspilerPlugin]=[j2.formulaTranspilerPluginAttach,"Microsoft.Office.Excel.FormulaRemediation"],Zo),Win32:{}},z2r=(K2={},K2[Ga.PluginAttachGroup.Core]=!0,K2[Ga.PluginAttachGroup.Python]=!1,K2[Ga.PluginAttachGroup.SmartSuggestionsAutoComplete]=!1,K2);(0,H2r.staticAssertExtends)();var Q2r=(V2={},V2[Ga.PluginAttachGroup.Core]=(Fte={},Fte[Ga.PluginFactoryName.AutocompletePlugin]=!1,Fte),V2[Ga.PluginAttachGroup.Python]={},V2[Ga.PluginAttachGroup.SmartSuggestionsAutoComplete]=(Nte={},Nte[Ga.PluginFactoryName.AutocompletePlugin]=!0,Nte),V2);function X2r(e){Ote.scriptLoaderPromise.resolve(e)}um.resolveScriptLoaderPromise=X2r;function PIe(e,r,t){return t===void 0&&(t=[]),C1.__awaiter(this,void 0,void 0,function(){var n,a,o,u,s,l,c;return C1.__generator(this,function(d){switch(d.label){case 0:if((0,W2.isTypedChangeGateEnabled)("OfficeVSO:7903424_Microsoft.Office.Excel.ProvideX10FeaturesFromSchedulerFeatures")&&(n=kte.PluginSchedulerSingleton.instance(),n.doNotify(RIe.NotificationKind.setSchedulerFeatures,[t.map(function(f){return Ga.SchedulerFeature[f]})])),Ote.scriptLoaderPromise.resolve(r),a=j5.Web[e],a===void 0)return[2,!1];if(o=a[0],u=a[1],s=a[2],l=a[3],!((u===void 0||(0,W2.getTypedFeatureGate)(u))&&(s===void 0||(0,W2.isTypedChangeGateEnabled)(s))&&(l===void 0||t.indexOf(l)!==-1)))return[3,4];d.label=1;case 1:return d.trys.push([1,3,,4]),[4,o.getValue()];case 2:return d.sent(),[2,!0];case 3:return c=d.sent(),V5.x10Logger.log({kind:"failure",payload:{failureKind:V5.X10FailureKind.PluginAttachmentFailure,failureLevel:TIe.TraceLevel.Error,path:"ensurePluginAttachedLegacy",description:'Failed to ensure plugin "'.concat(Ga.PluginFactoryName[e],'" is attached with exception'),data:c}}),[3,4];case 4:return[2,!1]}})})}um.ensurePluginAttachedLegacy=PIe;function Y2r(e){var r=kte.PluginSchedulerSingleton.instance();r.doNotify(RIe.NotificationKind.setSchedulerFeatures,[e.map(function(t){return Ga.SchedulerFeature[t]})])}um.setX10Features=Y2r;function AIe(e){return C1.__awaiter(this,void 0,void 0,function(){var r,t,n,a,o,u,s,l;return C1.__generator(this,function(c){switch(c.label){case 0:if(r=j5[EIe.platform][e],r===void 0)return[2,!1];if(t=kte.PluginSchedulerSingleton.instance(),n=t.getSchedulerFeatures(),a=r[0],o=r[1],u=r[2],s=r[3],!((o===void 0||(0,W2.getTypedFeatureGate)(o))&&(u===void 0||(0,W2.isTypedChangeGateEnabled)(u))&&(s===void 0||n.indexOf(Ga.SchedulerFeature[s])!==-1)))return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,a.getValue()];case 2:return c.sent(),[2,!0];case 3:return l=c.sent(),V5.x10Logger.log({kind:"failure",payload:{failureKind:V5.X10FailureKind.PluginAttachmentFailure,failureLevel:TIe.TraceLevel.Error,path:"ensurePluginAttached",description:'Failed to ensure plugin "'.concat(Ga.PluginFactoryName[e],'" is attached with exception'),data:l}}),[3,4];case 4:return[2,!1]}})})}um.ensurePluginAttached=AIe;function FIe(e){return Object.keys(e).map(function(r){return parseInt(r,10)})}function NIe(e,r){var t;return(t=Q2r[r][e])!==null&&t!==void 0?t:z2r[r]}function J2r(e){return C1.__awaiter(this,void 0,void 0,function(){var r,t,n,a,o;return C1.__generator(this,function(u){switch(u.label){case 0:r=0,t=0,n=FIe(j5[EIe.platform]),u.label=1;case 1:return t<n.length?(a=n[t],NIe(a,e)?[4,AIe(a)]:[3,3]):[3,4];case 2:o=u.sent(),o&&(r+=1),u.label=3;case 3:return t++,[3,1];case 4:return[2,r]}})})}um.ensureGroupAttached=J2r;function Z2r(e,r,t){return t===void 0&&(t=[]),C1.__awaiter(this,void 0,void 0,function(){var n,a,o,u,s;return C1.__generator(this,function(l){switch(l.label){case 0:n=0,a=0,o=FIe(j5.Web),l.label=1;case 1:return a<o.length?(u=o[a],NIe(u,r)?[4,PIe(u,e,t)]:[3,3]):[3,4];case 2:s=l.sent(),s&&(n+=1),l.label=3;case 3:return a++,[3,1];case 4:return[2,n]}})})}um.ensureGroupAttachedLegacy=Z2r});var xIe=T(ZO=>{"use strict";p();Object.defineProperty(ZO,"__esModule",{value:!0});ZO.ChatGPTPlugin=ZO.ChatGPTPluginFactory=void 0;var $2r=fe(),ewr=ia(),rwr=Ar(),twr=yc(),JO=Xo(),kIe=function(){function e(){this.factoryName=ewr.PluginFactoryName.ChatGPTPlugin}return e.prototype.create=function(){return new MIe},e}();ZO.ChatGPTPluginFactory=kIe;var MIe=function(){function e(){}return e.prototype.run=function(r){var t,n,a,o;return $2r.__generator(this,function(u){switch(u.label){case 0:return t=r.query,(0,rwr.isDefined)(t)?[4,{kind:JO.ComputationRequestKind.CreateChatGPTSession,options:r.context}]:[2,null];case 1:if(n=u.sent(),n.kind!==JO.ComputationRequestKind.CreateChatGPTSession)throw new Error("Inconsistent yield request response type");return[4,{kind:JO.ComputationRequestKind.SendChatGPTQuery,session:n.result,request:t}];case 2:if(a=u.sent(),a.kind!==JO.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");return[4,{kind:JO.ComputationRequestKind.SendChatGPTQuery,session:n.result,request:"Explain your answer"}];case 3:if(o=u.sent(),o.kind!==JO.ComputationRequestKind.SendChatGPTQuery)throw new Error("Inconsistent yield request response type");return[2,{result:a.result,details:o.result}]}})},e}();ZO.ChatGPTPlugin=MIe;(0,twr.registerPluginFactory)(new kIe)});var IIe=T(W5=>{"use strict";p();Object.defineProperty(W5,"__esModule",{value:!0});W5.runQueueProcessorUntil=void 0;var nwr=v_();W5.runQueueProcessorUntil=nwr.testUtils.runQueueProcessorUntil});var LIe=T(Iv=>{"use strict";p();Object.defineProperty(Iv,"__esModule",{value:!0});Iv.flaky=Iv.YarnExecutionArgs=Iv.GateOverrideManager=Iv.testingCGOverrides=void 0;var H5=Ms(),awr=mi(),iwr=mi(),Mte=Ar(),wIe=[];Iv.testingCGOverrides=[];wIe.length===0?Iv.testingCGOverrides.push(void 0):wIe.forEach(function(e){var r,t;return Iv.testingCGOverrides.push((r={},r[e]=!0,r),(t={},t[e]=!1,t))});var owr=function(){function e(){}return e.prototype.override=function(r){return{changeGates:(0,Mte.isDefined)(r.changeGates)?(0,iwr.overrideTypedChangeGates)(H5.isTypedChangeGateEnabled,r.changeGates):void 0,featureGates:(0,Mte.isDefined)(r.featureGates)?(0,H5.overrideTypedFeatureGates)(H5.getTypedFeatureGate,r.featureGates):void 0}},e.prototype.revert=function(r){(0,awr.setChangeGateDictionaryGetter)(r.changeGates),(0,H5.setFeatureGateDictionaryGetter)(r.featureGates)},e}();Iv.GateOverrideManager=owr;var DIe=function(){function e(){var r,t;this.args=[],this.args=(t=JSON.parse((r=process.env.npm_config_argv)!==null&&r!==void 0?r:"{}").original)!==null&&t!==void 0?t:[]}return Object.defineProperty(e,"instance",{get:function(){return(0,Mte.isDefined)(this._instance)||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.has=function(r){return e.instance.args.findIndex(function(t){return t===r})>=0},e}();Iv.YarnExecutionArgs=DIe;var uwr=function(){return DIe.has("--flaky")?it:it.skip};Iv.flaky=uwr});var wte=T(T1=>{"use strict";p();Object.defineProperty(T1,"__esModule",{value:!0});T1.GridInterface=T1.SheetInterface=T1.RangeInterface=void 0;var TE=fe(),swr=vG(),BIe=Kh(),$O=Mre(),UIe=KQ(),qIe=BM(),GIe=VX(),lwr=uE();function xte(e){return e!==void 0&&e.hasOwnProperty("value")}var cwr=function(){function e(){this.map={}}return e.prototype.set=function(r,t,n){r in this.map||(this.map[r]={}),this.map[r][t]=n},e.prototype.get=function(r,t){if(r in this.map&&t in this.map[r])return this.map[r][t]},e}(),KIe=function(){function e(r,t,n,a,o,u,s){this.grid=r,this.scheduler=t,this.sheetId=n,this.row=a,this.col=o,this.rows=u,this.cols=s}return e.prototype.setRange=function(r){var t=r.map(function(o){return o.map(function(u){return xte(u)?u.value:u})}),n=r.map(function(o){return o.map(function(u){return xte(u)?u.format:void 0})}),a=r.map(function(o){return o.map(function(u){return xte(u)?u.formulaBarText:void 0})});this.grid.setRange(this.sheetId,this,t,n,a)},e.prototype.setTable=function(r,t,n){var a=this,o,u,s=[!((o=r==null?void 0:r.hideHeadersRow)!==null&&o!==void 0&&o),(u=r==null?void 0:r.hasTotalsRow)!==null&&u!==void 0?u:!1],l=s[0],c=s[1];this.setRange(l?TE.__spreadArray([t],n,!0):n);var d=[(0,$O.namedObjectsWrite)(void 0,[(0,$O.namedObject)(r.name,(0,$O.namedTableData)((0,$O.sheetRangeLocation)(this.sheetId,this.firstRow+(l?1:0),this.firstColumn,this.firstRow+n.length-(c?1:0),this.firstColumn+t.length-1),l,c,t.map(function(f,m){return(0,$O.columnData)(a.firstColumn+m,f)})))])];this.grid.setNamedObjects(d),this.scheduler.doNotify(BIe.NotificationKind.updateNamedObjects,[0,d])},Object.defineProperty(e.prototype,"topLeft",{get:function(){return{row:this.firstRow,col:this.firstColumn,rows:1,cols:1}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstRow",{get:function(){return this.row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstColumn",{get:function(){return this.col},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastRow",{get:function(){return this.row+this.rows-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastColumn",{get:function(){return this.col+this.cols-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sheet",{get:function(){return{document:{name:"",path:void 0},index:this.sheetId,index2:this.sheetId}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this.firstRow},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"colIndex",{get:function(){return this.firstColumn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sheetIndex",{get:function(){return this.sheet.index},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docPath",{get:function(){var t;return(t=this.sheet.document.path)!==null&&t!==void 0?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docName",{get:function(){return this.sheet.document.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tables",{get:function(){var t=this,n=this;return this.grid.getIntersectingTables(0,this).then(function(a){return TE.__awaiter(t,void 0,void 0,function(){return TE.__generator(this,function(o){switch(o.label){case 0:return[4,n.grid.discardSnapshot(0)];case 1:return o.sent(),[2,a.kind==="Success"?a.value.tables:[]]}})})})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellValues",{get:function(){return this.cells.then(function(t){return t.map(function(n){return n.map(function(a){return a.value})})})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellFormats",{get:function(){return this.cells.then(function(t){return t.map(function(n){return n.map(function(a){return a.format})})})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cells",{get:function(){var t=this,n=this;return n.grid.getRangeValues(0,n).then(function(a){return n.grid.getRangeFormats(0,n).then(function(o){return TE.__awaiter(t,void 0,void 0,function(){var u=this;return TE.__generator(this,function(s){return[2,n.grid.getRangeFormulae(0,n).then(function(l){return TE.__awaiter(u,void 0,void 0,function(){var c,d,f,m,v,h,y;return TE.__generator(this,function(_){switch(_.label){case 0:for(c=Ite(a.kind==="Success"?a.value.nonEmptyCells:[],function(E){return(0,$O.readOperToCellValue)(UIe.xlMathpack,E)}),d=Ite(o.kind==="Success"?o.value.nonEmptyCells:[],function(E){return Number(E)}),f=Ite(l.kind==="Success"?l.value.nonEmptyCells:[],function(E){return E}),m=[],v=n.firstRow;v<=n.lastRow;v++)for(m.push([]),h=n.firstColumn;h<=n.lastColumn;h++)m[v-n.firstRow].push({value:c.get(v,h),formulaBarText:(y=f.get(v,h))===null||y===void 0?void 0:y.formulaBarText,format:d.get(v,h)});return[4,n.grid.discardSnapshot(0)];case 1:return _.sent(),[2,m]}})})})]})})})})},enumerable:!1,configurable:!0}),e}();T1.RangeInterface=KIe;var VIe=function(){function e(r,t,n){this.grid=r,this.scheduler=t,this.id=n;var a={config:(0,qIe.calcConfig)((0,qIe.getEnglishLocaleInfo)(),void 0,UIe.xlMathpack)};this.parser=(0,GIe.createParser)(a)}return e.prototype.get=function(r){var t=this.parseRangeIndex(r);return this.getCoordinates(t.firstRow,t.firstColumn,t.lastRow,t.lastColumn)},e.prototype.getCoordinates=function(r,t,n,a){return new KIe(this.grid,this.scheduler,this.id,r,t,(n??r)-r+1,(a??t)-t+1)},e.prototype.parseRangeIndex=function(r){var t={col:0,row:0,cols:1,rows:1},n=this.parser.parseFormulaExpression((0,GIe.parseLocals)(swr.LexicalKind.Range,t),r);if(n.kind!=="Success"||n.value.node.kind!=="CellRef")throw"Could not parse range: ".concat(r);var a=(0,lwr.getRangeFromCellRef)(n.value.node.ref,t,function(o){throw o});if(a===void 0)throw"Could not parse range: ".concat(r);return a},e}();T1.SheetInterface=VIe;var dwr=function(){function e(r,t){this.grid=r,this.scheduler=t,this.sheets={}}return e.prototype.createSheet=function(r){var t=new VIe(this.grid,this.scheduler,r);return this.grid.setSheet(r,r,[[]]),this.sheets[r]=t,this.scheduler.doNotify(BIe.NotificationKind.updateSheetNames,[0,[{sheetId:r,sheetName:r}]]),t},e}();T1.GridInterface=dwr;function Ite(e,r){for(var t,n,a=new cwr,o=0,u=e;o<u.length;o++)for(var s=u[o],l=s[0],c=l[0],d=l[1],f=(t=l[2])!==null&&t!==void 0?t:1,m=(n=l[3])!==null&&n!==void 0?n:1,v=s[1],h=c;h<c+f;h++)for(var y=d;y<d+m;y++)a.set(h,y,r(v));return a}});var zIe=T(wv=>{"use strict";p();Object.defineProperty(wv,"__esModule",{value:!0});wv.x10Test=wv.flaky=wv.skip=wv.each=wv.test=void 0;var H2=fe(),fwr=pM(),jIe=Ire(),pwr=wre(),mwr=sE(),gwr=wte(),vwr=function(){function e(){var r,t;this.args=[],this.args=(t=JSON.parse((r=process.env.npm_config_argv)!==null&&r!==void 0?r:"{}").original)!==null&&t!==void 0?t:[]}return Object.defineProperty(e,"instance",{get:function(){return(0,fwr.isDefined)(this._instance)||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.has=function(r){return e.instance.args.findIndex(function(t){return t===r})>=0},e}(),hwr=function(){function e(r){var t=this;this.timer=r,this.runMacrotasksWhile=function(){for(var n,a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return(n=t.timer).runMacrotasksWhile.apply(n,a)},this.runMacrotasksFor=function(n){var a=t.preciseNow;return t.runMacrotasksWhile(function(){return t.preciseNow<a+n})}}return Object.defineProperty(e.prototype,"startTime",{get:function(){return this.timer.startTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"preciseNow",{get:function(){return this.timer.preciseNow()},enumerable:!1,configurable:!0}),e.prototype.jolt=function(){return new Promise(function(r){return setImmediate(function(){return r()})})},e.prototype.runUntilResolved=function(r){return H2.__awaiter(this,void 0,void 0,function(){var t,n;return H2.__generator(this,function(a){switch(a.label){case 0:return t=!1,n=Promise.resolve(r),n.then(function(){return t=!0}),[4,this.runMacrotasksWhile(function(){return!t})];case 1:return a.sent(),[2,n]}})})},e}();function Dte(){var e=(0,jIe.createMockAsyncGrid)(),r=new pwr.MockTimerImmediate,t=(0,mwr.getSchedulerFactories)().createFormulaBarScheduler((0,jIe.createMockGridProvider)(e),void 0,r),n=new gwr.GridInterface(e,t);return t.registerAsyncGrid(),{scheduler:t,grid:n,timer:new hwr(r)}}function Lte(e,r,t){it(e,function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return r.apply(void 0,H2.__spreadArray([Dte()],n,!1))},t)}wv.test=Lte;function WIe(e){return function(r,t,n){it.each(e)(r,function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return t.apply(void 0,H2.__spreadArray([Dte()],a,!1))},n)}}wv.each=WIe;function qte(e,r,t){it.skip(e,function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return r.apply(void 0,H2.__spreadArray([Dte()],n,!1))},t)}wv.skip=qte;function HIe(e){return vwr.has("--flaky")?Lte:qte}wv.flaky=HIe;wv.x10Test={test:Lte,each:WIe,skip:qte,flaky:HIe}});var QIe=T(R1=>{"use strict";p();Object.defineProperty(R1,"__esModule",{value:!0});R1.RangeInterface=R1.SheetInterface=R1.GridInterface=void 0;var Swr=fe(),Gte=Swr.__importStar(wte());R1.GridInterface=Gte.GridInterface;R1.SheetInterface=Gte.SheetInterface;R1.RangeInterface=Gte.RangeInterface});var YIe=T(Dv=>{"use strict";p();Object.defineProperty(Dv,"__esModule",{value:!0});Dv.Types=Dv.flaky=Dv.skip=Dv.each=Dv.test=void 0;var XIe=fe(),z5=XIe.__importStar(zIe()),ywr=XIe.__importStar(QIe());Dv.test=z5.test;Dv.each=z5.each;Dv.skip=z5.skip;Dv.flaky=z5.flaky;Dv.Types=ywr});var e2e=T(Ue=>{"use strict";p();Object.defineProperty(Ue,"__esModule",{value:!0});Ue.setX10Features=Ue.ensurePluginAttached=Ue.ensureGroupAttachedLegacy=Ue.ensureGroupAttached=Ue.spanToLSPRange=Ue.ValuePreviewResultExtractor=Ue.ValuePreviewPluginFactory=Ue.ColoredReferencesPluginFactory=Ue.ParenthesesCouplingPluginFactory=Ue.AutocompleteTableHeadersPluginFactory=Ue.AutocompleteNamedObjectsPluginFactory=Ue.AutocompleteRichValuePluginFactory=Ue.AutocompleteLetPluginFactory=Ue.AutocompleteEnumPluginFactory=Ue.AutocompleteFunctionPluginFactory=Ue.ArgumentAssistancePluginFactory=Ue.PluginRegistry=Ue.ALAnnotationKind=Ue.EventKind=Ue.ExecutionType=Ue.ComputationType=Ue.NotificationKind=Ue.RequestKind=Ue.delay=Ue.wrapIntoAsync=Ue.awaitPromise=Ue.typedRequest=Ue.PluginRequestKind=Ue.ComputationRequestKind=Ue.stableDynamicPluginLoaderInsideInit=Ue.DefaultComputationGroup=Ue.registerPluginFactory=Ue.PluginFactoryName=Ue.PluginGroup=Ue.MockTimerImmediate=Ue.setMockGridSheetAndNotify=Ue.createMockGridExporter=Ue.createMockGridProvider=Ue.createMockAsyncGrid=Ue.RecalcSideGrid=Ue.SchedulerVersionCompatibility=Ue.FormulaKind=Ue.GridImportManagerSingleton=Ue.PluginSchedulerSingleton=Ue.getSchedulerFactories=Ue.defaultPluginResponseWindows=Ue.ChatGPTPlugin=Ue.staticTypeHint=Ue.core=Ue.platform=void 0;Ue.Test=Ue.TestGateOverrideManager=Ue.runQueueProcessorUntil=Ue.VisitorHelpers=Ue.RangeHelpers=Ue.TimelineQueueProcessor=Ue.defaultTimerInterface=Ue.resolveScriptLoaderPromise=void 0;var Wa=fe(),_wr=Wa.__importStar(Ar()),bwr=Wa.__importStar(Qm()),Cwr=Wa.__importStar(jee()),Q5=Wa.__importStar(sE()),X5=Wa.__importStar(Ire()),Twr=Wa.__importStar(wre()),Rwr=Wa.__importStar(yc()),E1=Wa.__importStar(Xo()),Ewr=Wa.__importStar(Kh()),Pwr=Wa.__importStar(QR()),Awr=Wa.__importStar(Kre()),Fwr=Wa.__importStar(jre()),Nwr=Wa.__importStar(zre()),Owr=Wa.__importStar(Qre()),kwr=Wa.__importStar(Jre()),Mwr=Wa.__importStar(ete()),xwr=Wa.__importStar(nte()),Iwr=Wa.__importStar(ite()),wwr=Wa.__importStar(mte()),Dwr=Wa.__importStar(qee()),z2=Wa.__importStar(OIe()),Lwr=Wa.__importStar(xre()),qwr=Wa.__importStar(t2()),Gwr=Wa.__importStar(Ate()),Bwr=Wa.__importStar(Ete()),JIe=Wa.__importStar(ZN()),Uwr=Wa.__importStar(xIe()),ZIe=Wa.__importStar(C6()),Kwr=Wa.__importStar(hte()),Vwr=Wa.__importStar(h2()),jwr=Wa.__importStar(u2()),$Ie=Wa.__importStar(ia()),Wwr=Wa.__importStar(_O()),Hwr=Wa.__importStar(uE()),zwr=Wa.__importStar(IIe()),Qwr=Wa.__importStar(LIe()),Xwr=Wa.__importStar(YIe()),Ywr=w6();Object.defineProperty(Ue,"platform",{enumerable:!0,get:function(){return Ywr.platform}});Ue.core=_wr;Ue.staticTypeHint=bwr.staticTypeHint;Ue.ChatGPTPlugin=Uwr.ChatGPTPlugin;Ue.defaultPluginResponseWindows=Cwr.defaultPluginResponseWindows;Ue.getSchedulerFactories=Q5.getSchedulerFactories;Ue.PluginSchedulerSingleton=Q5.PluginSchedulerSingleton;Ue.GridImportManagerSingleton=Q5.GridImportManagerSingleton;Ue.FormulaKind=Pwr.FormulaKind;Ue.SchedulerVersionCompatibility=E1.SchedulerVersionCompatibility;Ue.RecalcSideGrid=qwr.RecalcSideGrid;Ue.createMockAsyncGrid=X5.createMockAsyncGrid;Ue.createMockGridProvider=X5.createMockGridProvider;Ue.createMockGridExporter=X5.createMockGridExporter;Ue.setMockGridSheetAndNotify=X5.setMockGridSheetAndNotify;Ue.MockTimerImmediate=Twr.MockTimerImmediate;Ue.PluginGroup=$Ie.PluginGroup;Ue.PluginFactoryName=$Ie.PluginFactoryName;Ue.registerPluginFactory=Rwr.registerPluginFactory;Ue.DefaultComputationGroup=E1.DefaultComputationGroup;Ue.stableDynamicPluginLoaderInsideInit=Q5.dynamicPluginLoaderInsideInit;Ue.ComputationRequestKind=E1.ComputationRequestKind;Ue.PluginRequestKind=E1.ComputationRequestKind;Ue.typedRequest=E1.typedRequest;Ue.awaitPromise=E1.awaitPromise;Ue.wrapIntoAsync=Lwr.wrapIntoAsync;Ue.delay=E1.delay;Ue.RequestKind=E1.RequestKind;Ue.NotificationKind=Ewr.NotificationKind;Ue.ComputationType=Vwr.ComputationType;Ue.ExecutionType=jwr.ExecutionType;Ue.EventKind=ZIe.EventKind;Ue.ALAnnotationKind=ZIe.ALAnnotationKind;Ue.PluginRegistry=Kwr.PluginRegistry;Ue.ArgumentAssistancePluginFactory=Awr.ArgumentAssistancePluginFactory;Ue.AutocompleteFunctionPluginFactory=Fwr.AutocompleteFunctionPluginFactory;Ue.AutocompleteEnumPluginFactory=Nwr.AutocompleteEnumPluginFactory;Ue.AutocompleteLetPluginFactory=Owr.AutocompleteLetPluginFactory;Ue.AutocompleteRichValuePluginFactory=kwr.AutocompleteRichValuePluginFactory;Ue.AutocompleteNamedObjectsPluginFactory=Mwr.AutocompleteNamedObjectsPluginFactory;Ue.AutocompleteTableHeadersPluginFactory=xwr.AutocompleteTableHeadersPluginFactory;Ue.ParenthesesCouplingPluginFactory=Iwr.ParenthesesCouplingPluginFactory;Ue.ColoredReferencesPluginFactory=wwr.ColoredReferencesPluginFactory;Ue.ValuePreviewPluginFactory=Gwr.ValuePreviewPluginFactory;Ue.ValuePreviewResultExtractor=Bwr.ValuePreviewResultExtractor;Ue.spanToLSPRange=Dwr.spanToLSPRange;Ue.ensureGroupAttached=z2.ensureGroupAttached;Ue.ensureGroupAttachedLegacy=z2.ensureGroupAttachedLegacy;Ue.ensurePluginAttached=z2.ensurePluginAttached;Ue.setX10Features=z2.setX10Features;Ue.resolveScriptLoaderPromise=z2.resolveScriptLoaderPromise;Ue.defaultTimerInterface=JIe.defaultTimerInterface;Ue.TimelineQueueProcessor=JIe.TimelineQueueProcessor;Ue.RangeHelpers=Wwr;Ue.VisitorHelpers=Hwr;Ue.runQueueProcessorUntil=zwr.runQueueProcessorUntil;Ue.TestGateOverrideManager=Qwr.GateOverrideManager;Ue.Test=Xwr});var r2e=T(Y5=>{"use strict";p();var Q2;Object.defineProperty(Y5,"__esModule",{value:!0});Y5.getWorksheetFuncTypeWrapper=void 0;var ek=Qf(),Jwr=Qf();function Zwr(e){return $wr(e)?eDr[e.FunctionIndexInServer][e.signatureIndex]:(0,Jwr.getWorksheetFuncType)(e.FunctionIndexInServer)}Y5.getWorksheetFuncTypeWrapper=Zwr;var $wr=function(r){if(r===void 0)return!1;var t=r,n=t.FunctionIndexInServer,a=t.signatureIndex;return(a===0||a===1)&&(n===ek.WorksheetFuncId.AGGREGATE||n===ek.WorksheetFuncId.INDEX||n===ek.WorksheetFuncId.LOOKUP)},eDr=(Q2={},Q2[ek.WorksheetFuncId.AGGREGATE]=[{headTypes:[1,1,48,17],restTypes:[],tailTypes:[],minArgs:3,maxArgs:4},{headTypes:[1,1],restTypes:[16],tailTypes:[],minArgs:3,maxArgs:255}],Q2[ek.WorksheetFuncId.INDEX]=[{headTypes:[48,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[48,1,1,1],restTypes:[],tailTypes:[],minArgs:2,maxArgs:4}],Q2[ek.WorksheetFuncId.LOOKUP]=[{headTypes:[263,48,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:3},{headTypes:[263,48],restTypes:[],tailTypes:[],minArgs:2,maxArgs:2}],Q2)});var t2e=T(Z5=>{"use strict";p();Object.defineProperty(Z5,"__esModule",{value:!0});Z5.FormulaAuthoringHelper=void 0;var RE=Ar(),Bte=Gi(),J5=qre(),rDr=I5(),Ute=r2e(),tDr=function(){function e(){var r=this;this.hasRepeatingParams=function(t){return(0,RE.isNone)(t)?(r.logError("hasRepeatingParams: funcInfo is null or undefined"),!1):(0,Ute.getWorksheetFuncTypeWrapper)(t).restTypes.length>0}}return e.prototype.getMinimalParamArray=function(r,t){var n;if(!(0,RE.isNone)(t)){for(var a=(0,Ute.getWorksheetFuncTypeWrapper)(t),o=a.minArgs,u=a.restTypes,s=u.length>0?Math.max(o,2):(n=r==null?void 0:r.length)!==null&&n!==void 0?n:0,l=[],c=0;c<s;c+=1){var d=this.getFunctionParamByIndex(r,t,c);(0,RE.isDefined)(d)&&l.push(d)}return l}},e.prototype.getFunctionParamByIndex=function(r,t,n){if(!(!nDr(r)||(0,RE.isNone)(t))){var a=(0,Ute.getWorksheetFuncTypeWrapper)(t),o=a.headTypes.length,u=t.ParamsHelp.split("!"),s=(0,J5.getParamIndexToHighlight)(n,r.length,a,!1,!0);if(s===-1){this.logError("Trying to get param by index that is out of bounds");return}else if(s>=r.length){this.logError("Trying to add param for a signature that doesn't have rest params.");return}var l=n<o?r[s].match(/[^\[\]]+/).toString():"".concat((0,J5.getBaseParamName)(r[s])).concat((0,J5.getParamNumberSuffix)(n,o,a.restTypes.length)),c=(0,J5.getParamIndexToHighlight)(n,t.ParamsHelp.split("!").length,a),d=u[c];return{name:l,isOptional:n>=a.minArgs,description:d,type:"TO DO"}}},e.prototype.getFormulaAnonymizer=function(r){var t=this,n=new rDr.ConsistentAnonymizer,a=function(u,s){try{return aDr(u)?iDr(r)?oDr(s)?n.anonymize(u,r,s):(t.logError("getFormulaAnonymizer: Origin"),null):(t.logError("getFormulaAnonymizer: Config"),null):(t.logError("getFormulaAnonymizer: Formula"),null)}catch(l){return t.logError("getFormulaAnonymizer: ".concat(l)),null}};return{anonymize:a}},e.prototype.logError=function(r){Bte.ulsLogger.ULS.traceTag(512331973,Bte.LogCategory.msoulscat_ES_EWAJS,Bte.TraceLevel.Error,"FormulaAuthoringHelper error: ".concat(r))},e}();Z5.FormulaAuthoringHelper=tDr;function nDr(e){return!0}function aDr(e){return(0,RE.isDefined)(e)&&typeof e=="string"}function iDr(e){return(0,RE.isDefined)(e)&&typeof e=="object"&&"localeInfo"in e&&"mathpack"in e&&"refStyle"in e}function oDr(e){return(0,RE.isDefined)(e)&&typeof e=="object"&&"row"in e&&"col"in e&&e.rows===1&&e.cols===1}});var n2e=T($5=>{"use strict";p();Object.defineProperty($5,"__esModule",{value:!0});$5.FormulaAuthoringHelperSingleton=void 0;var uDr=Ar(),sDr=t2e();$5.FormulaAuthoringHelperSingleton=(0,uDr.singleton)(function(){return new sDr.FormulaAuthoringHelper})});var i2e=T(tt=>{"use strict";p();Object.defineProperty(tt,"__esModule",{value:!0});tt.ConsistentAnonymizer=tt.x10TypesSubpackage=tt.syntaxSubpackage=tt.runtimeSubpackage=tt.recalcSubpackage=tt.numfmtSubpackage=tt.langSubpackage=tt.commonSubpackage=tt.isTypedChangeGateEnabled=tt.getTypedFeatureGate=tt.x10=tt.worker=tt.style=tt.funcs=tt.calc=tt.runtime=tt.numfmt=tt.analyze=tt.parse=tt.date=tt.math=tt.config=tt.util=tt.signature=tt.value=tt.formula=tt.location=tt.common=tt.sheetName=tt.FormulaAuthoringHelperSingletonGlobal=tt.PluginSchedulerSingletonGlobal=tt.packageVersion=void 0;var xu=fe(),lDr=Ofe();Object.defineProperty(tt,"packageVersion",{enumerable:!0,get:function(){return lDr.packageVersion}});var cDr=xu.__importStar(pM());tt.common=cDr;var dDr=xu.__importStar(vG());tt.location=dDr;var fDr=xu.__importStar(wQ());tt.formula=fDr;var pDr=xu.__importStar(hG());tt.value=pDr;var mDr=xu.__importStar(_0e());tt.signature=mDr;var gDr=xu.__importStar(P0e());tt.util=gDr;var vDr=xu.__importStar(BM());tt.config=vDr;var hDr=xu.__importStar(KQ());tt.math=hDr;var SDr=xu.__importStar(M0e());tt.date=SDr;var yDr=xu.__importStar(VX());tt.parse=yDr;var _Dr=xu.__importStar(e_e());tt.analyze=_Dr;var bDr=xu.__importStar(uU());tt.numfmt=bDr;var CDr=xu.__importStar(MEe());tt.runtime=CDr;var TDr=xu.__importStar(Mre());tt.calc=TDr;var RDr=xu.__importStar(RMe());tt.funcs=RDr;var EDr=xu.__importStar(EMe());tt.style=EDr;var PDr=xu.__importStar(FMe());tt.worker=PDr;var ADr=xu.__importStar(e2e());tt.x10=ADr;var FDr=sE(),NDr=n2e();tt.PluginSchedulerSingletonGlobal=new FDr.PluginSchedulerSingleton;tt.FormulaAuthoringHelperSingletonGlobal=new NDr.FormulaAuthoringHelperSingleton;var ODr=r_();Object.defineProperty(tt,"sheetName",{enumerable:!0,get:function(){return ODr.sheetName}});var a2e=Ms();Object.defineProperty(tt,"getTypedFeatureGate",{enumerable:!0,get:function(){return a2e.getTypedFeatureGate}});Object.defineProperty(tt,"isTypedChangeGateEnabled",{enumerable:!0,get:function(){return a2e.isTypedChangeGateEnabled}});var kDr=xu.__importStar(pr());tt.commonSubpackage=kDr;var MDr=xu.__importStar(qr());tt.langSubpackage=MDr;var xDr=xu.__importStar(ep());tt.numfmtSubpackage=xDr;var IDr=xu.__importStar(Zee());tt.recalcSubpackage=IDr;var wDr=xu.__importStar(ov());tt.runtimeSubpackage=wDr;var DDr=xu.__importStar(Jf());tt.syntaxSubpackage=DDr;var LDr=xu.__importStar(v_());tt.x10TypesSubpackage=LDr;var qDr=I5();Object.defineProperty(tt,"ConsistentAnonymizer",{enumerable:!0,get:function(){return qDr.ConsistentAnonymizer}})});var Vte=T(Kte=>{p();Object.defineProperty(Kte,"__esModule",{value:!0});Kte.debugLog=BDr;var GDr=Q9();function BDr(e){(0,GDr.getTypedFeatureGate)("Microsoft.Office.Excel.DesktopX10JavascriptDebug")&&console.log(e)}});var u2e=T(jte=>{p();Object.defineProperty(jte,"__esModule",{value:!0});jte.nulls2undefs=o2e;function o2e(e){for(var r=0,t=Object.keys(e);r<t.length;r++){var n=t[r],a=e[n];a===null?e[n]=void 0:typeof a=="object"&&o2e(a)}}});var d2e=T(Y2=>{p();Object.defineProperty(Y2,"__esModule",{value:!0});Y2.attachPlugins=jDr;Y2.makeNotifierJSProxy=QDr;Y2.makeRequesterJSProxy=zDr;var s2e=VDr(Nfe()),eV=i2e(),X2=Vte(),UDr=u2e(),KDr=ia();function l2e(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,t=new WeakMap;return(l2e=function(a){return a?t:r})(e)}function VDr(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=l2e(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}function EE(){"use strict";EE=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(C,S,b){C[S]=b.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(C,S,b){return Object.defineProperty(C,S,{value:b,enumerable:!0,configurable:!0,writable:!0}),C[S]}try{c({},"")}catch(C){c=function(b,O,w){return b[O]=w}}function d(C,S,b,O){var w=S&&S.prototype instanceof E?S:E,D=Object.create(w.prototype),Q=new Z(O||[]);return a(D,"_invoke",{value:j(C,b,Q)}),D}function f(C,S,b){try{return{type:"normal",arg:C.call(S,b)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var m="suspendedStart",v="suspendedYield",h="executing",y="completed",_={};function E(){}function N(){}function k(){}var q={};c(q,u,function(){return this});var V=Object.getPrototypeOf,I=V&&V(V(J([])));I&&I!==t&&n.call(I,u)&&(q=I);var M=k.prototype=E.prototype=Object.create(q);function B(C){["next","throw","return"].forEach(function(S){c(C,S,function(b){return this._invoke(S,b)})})}function U(C,S){function b(w,D,Q,W){var $=f(C[w],C,D);if($.type!=="throw"){var me=$.arg,ve=me.value;return ve&&typeof ve=="object"&&n.call(ve,"__await")?S.resolve(ve.__await).then(function(Pe){b("next",Pe,Q,W)},function(Pe){b("throw",Pe,Q,W)}):S.resolve(ve).then(function(Pe){me.value=Pe,Q(me)},function(Pe){return b("throw",Pe,Q,W)})}W($.arg)}var O;a(this,"_invoke",{value:function(D,Q){function W(){return new S(function($,me){b(D,Q,$,me)})}return O=O?O.then(W,W):W()}})}function j(C,S,b){var O=m;return function(w,D){if(O===h)throw new Error("Generator is already running");if(O===y){if(w==="throw")throw D;return{value:e,done:!0}}for(b.method=w,b.arg=D;;){var Q=b.delegate;if(Q){var W=X(Q,b);if(W){if(W===_)continue;return W}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(O===m)throw O=y,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);O=h;var $=f(C,S,b);if($.type==="normal"){if(O=b.done?y:v,$.arg===_)continue;return{value:$.arg,done:b.done}}$.type==="throw"&&(O=y,b.method="throw",b.arg=$.arg)}}}function X(C,S){var b=S.method,O=C.iterator[b];if(O===e)return S.delegate=null,b==="throw"&&C.iterator.return&&(S.method="return",S.arg=e,X(C,S),S.method==="throw")||b!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+b+"' method")),_;var w=f(O,C.iterator,S.arg);if(w.type==="throw")return S.method="throw",S.arg=w.arg,S.delegate=null,_;var D=w.arg;return D?D.done?(S[C.resultName]=D.value,S.next=C.nextLoc,S.method!=="return"&&(S.method="next",S.arg=e),S.delegate=null,_):D:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,_)}function ee(C){var S={tryLoc:C[0]};1 in C&&(S.catchLoc=C[1]),2 in C&&(S.finallyLoc=C[2],S.afterLoc=C[3]),this.tryEntries.push(S)}function re(C){var S=C.completion||{};S.type="normal",delete S.arg,C.completion=S}function Z(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(ee,this),this.reset(!0)}function J(C){if(C||C===""){var S=C[u];if(S)return S.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var b=-1,O=function w(){for(;++b<C.length;)if(n.call(C,b))return w.value=C[b],w.done=!1,w;return w.value=e,w.done=!0,w};return O.next=O}}throw new TypeError(typeof C+" is not iterable")}return N.prototype=k,a(M,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:N,configurable:!0}),N.displayName=c(k,l,"GeneratorFunction"),r.isGeneratorFunction=function(C){var S=typeof C=="function"&&C.constructor;return!!S&&(S===N||(S.displayName||S.name)==="GeneratorFunction")},r.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,k):(C.__proto__=k,c(C,l,"GeneratorFunction")),C.prototype=Object.create(M),C},r.awrap=function(C){return{__await:C}},B(U.prototype),c(U.prototype,s,function(){return this}),r.AsyncIterator=U,r.async=function(C,S,b,O,w){w===void 0&&(w=Promise);var D=new U(d(C,S,b,O),w);return r.isGeneratorFunction(S)?D:D.next().then(function(Q){return Q.done?Q.value:D.next()})},B(M),c(M,l,"Generator"),c(M,u,function(){return this}),c(M,"toString",function(){return"[object Generator]"}),r.keys=function(C){var S=Object(C),b=[];for(var O in S)b.push(O);return b.reverse(),function w(){for(;b.length;){var D=b.pop();if(D in S)return w.value=D,w.done=!1,w}return w.done=!0,w}},r.values=J,Z.prototype={constructor:Z,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(re),!S)for(var b in this)b.charAt(0)==="t"&&n.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=e)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var b=this;function O(me,ve){return Q.type="throw",Q.arg=S,b.next=me,ve&&(b.method="next",b.arg=e),!!ve}for(var w=this.tryEntries.length-1;w>=0;--w){var D=this.tryEntries[w],Q=D.completion;if(D.tryLoc==="root")return O("end");if(D.tryLoc<=this.prev){var W=n.call(D,"catchLoc"),$=n.call(D,"finallyLoc");if(W&&$){if(this.prev<D.catchLoc)return O(D.catchLoc,!0);if(this.prev<D.finallyLoc)return O(D.finallyLoc)}else if(W){if(this.prev<D.catchLoc)return O(D.catchLoc,!0)}else{if(!$)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return O(D.finallyLoc)}}}},abrupt:function(S,b){for(var O=this.tryEntries.length-1;O>=0;--O){var w=this.tryEntries[O];if(w.tryLoc<=this.prev&&n.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var D=w;break}}D&&(S==="break"||S==="continue")&&D.tryLoc<=b&&b<=D.finallyLoc&&(D=null);var Q=D?D.completion:{};return Q.type=S,Q.arg=b,D?(this.method="next",this.next=D.finallyLoc,_):this.complete(Q)},complete:function(S,b){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&b&&(this.next=b),_},finish:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),re(O),_}},catch:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.tryLoc===S){var w=O.completion;if(w.type==="throw"){var D=w.arg;re(O)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(S,b,O){return this.delegate={iterator:J(S),resultName:b,nextLoc:O},this.method==="next"&&(this.arg=e),_}},r}(0,X2.debugLog)("x10Scheduler.ts loaded");var rV=eV.PluginSchedulerSingletonGlobal.instance();rV.registerAsyncGrid();function jDr(){return EE().async(function(r){for(;;)switch(r.prev=r.next){case 0:if(eV.x10.platform==="Win32"){r.next=2;break}throw new Error("Target platform for x10-UXPP has not been set correctly. Probably `excel-online-calc` loaded before __x10_target_platform was set");case 2:return r.next=4,EE().awrap(eV.x10.ensureGroupAttached(KDr.PluginAttachGroup.Core));case 4:(0,X2.debugLog)("Plugins attached");case 5:case"end":return r.stop()}},null,null,null,Promise)}rV.createAndAttachPlugin({factoryName:eV.x10.PluginFactoryName.ValuePreviewPlugin,create:function(){return{run:function(){return EE().mark(function t(){return EE().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return(0,X2.debugLog)("Plugin run"),a.abrupt("return",{index:0,isVolatile:!0,kind:"Success",length:1,operKind:1,value:"4242"});case 2:case"end":return a.stop()}},t)})()}}}});function c2e(e){return function(r){for(var t,n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];return(t=e[r]).call.apply(t,[e].concat(a))}}var WDr=c2e(rV.requester());function pp(e){return function(){var t,n,a,o,u=arguments;return EE().async(function(l){for(;;)switch(l.prev=l.next){case 0:for(t=u.length,n=new Array(t),a=0;a<t;a++)n[a]=u[a];return l.next=3,EE().awrap(WDr.apply(void 0,[e].concat(n)));case 3:return o=l.sent,(0,X2.debugLog)(e+"() called"),(0,UDr.nulls2undefs)(o),l.abrupt("return",o);case 7:case"end":return l.stop()}},null,null,null,Promise)}}var HDr=c2e(rV.notifier());function sm(e){return function(){(0,X2.debugLog)(e+"() called");for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];HDr.apply(void 0,[e].concat(t))}}function zDr(){return{ServiceInfo:s2e.ServiceInfos.Requester,functionSuggestion:pp("functionSuggestion"),argumentAssistance:pp("argumentAssistance"),chatGPTQuery:pp("chatGPTQuery"),columnFormulaSuggestion:pp("columnFormulaSuggestion"),formulaHighlighting:pp("formulaHighlighting"),formulaRepair:pp("formulaRepair"),gotoCtrlClick:pp("gotoCtrlClick"),inCellSuggestion:pp("inCellSuggestion"),runAuthoringExperiment:pp("runAuthoringExperiment"),runExperiment:pp("runExperiment"),runPerCharacterExperiment:pp("runPerCharacterExperiment"),runTest:pp("runTest"),valuePreview:pp("valuePreview"),setCellPrefetch:pp("setCellPrefetch"),getTranspiledFormulas:pp("getTranspiledFormulas")}}function QDr(){return{ServiceInfo:s2e.ServiceInfos.Notifier,doNothing:sm("doNothing"),setActiveCell:sm("setActiveCell"),setActiveCellFormat:sm("setActiveCellFormat"),setFunctionsInfo:sm("setFunctionsInfo"),setDefinedNamesInfo:sm("setDefinedNamesInfo"),notifyWorkbookClosing:sm("notifyWorkbookClosing"),setSchedulerFeatures:sm("setSchedulerFeatures"),setA1ReferenceStyle:sm("setA1ReferenceStyle"),setLocale:sm("setLocale"),setWorkbookProps:sm("setWorkbookProps"),updateSheetNames:sm("updateSheetNames"),updateNamedObjects:sm("updateNamedObjects"),writeRange:sm("writeRange"),setNumberFormats:sm("setNumberFormats")}}});var p2e=T(rk=>{p();Object.defineProperty(rk,"__esModule",{value:!0});rk.ServiceInfos=rk.NativeServices=void 0;var XDr=rl();function YDr(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function f2e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ZDr(n.key),n)}}function JDr(e,r,t){return r&&f2e(e.prototype,r),t&&f2e(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ZDr(e){var r=$Dr(e,"string");return typeof r=="symbol"?r:String(r)}function $Dr(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var eLr=rk.ServiceInfos={GridService:["X10::GridService",{stub:["ReturnsPromiseMethod","$any",[]]}]},ult=rk.NativeServices=function(){function e(){YDr(this,e)}return JDr(e,null,[{key:"GridService",get:function(){return e._GridService??=XDr.RekaServiceRegistry.getNativeService(eLr.GridService)}}]),e}()});var v2e=T(nV=>{p();Object.defineProperty(nV,"__esModule",{value:!0});nV.DesktopGrid=void 0;var rLr=tLr(p2e()),tV=Vte();function g2e(e){if(typeof WeakMap!="function")return null;var r=new WeakMap,t=new WeakMap;return(g2e=function(a){return a?t:r})(e)}function tLr(e,r){if(!r&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var t=g2e(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}function Wte(){"use strict";Wte=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(C,S,b){C[S]=b.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(C,S,b){return Object.defineProperty(C,S,{value:b,enumerable:!0,configurable:!0,writable:!0}),C[S]}try{c({},"")}catch(C){c=function(b,O,w){return b[O]=w}}function d(C,S,b,O){var w=S&&S.prototype instanceof E?S:E,D=Object.create(w.prototype),Q=new Z(O||[]);return a(D,"_invoke",{value:j(C,b,Q)}),D}function f(C,S,b){try{return{type:"normal",arg:C.call(S,b)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var m="suspendedStart",v="suspendedYield",h="executing",y="completed",_={};function E(){}function N(){}function k(){}var q={};c(q,u,function(){return this});var V=Object.getPrototypeOf,I=V&&V(V(J([])));I&&I!==t&&n.call(I,u)&&(q=I);var M=k.prototype=E.prototype=Object.create(q);function B(C){["next","throw","return"].forEach(function(S){c(C,S,function(b){return this._invoke(S,b)})})}function U(C,S){function b(w,D,Q,W){var $=f(C[w],C,D);if($.type!=="throw"){var me=$.arg,ve=me.value;return ve&&typeof ve=="object"&&n.call(ve,"__await")?S.resolve(ve.__await).then(function(Pe){b("next",Pe,Q,W)},function(Pe){b("throw",Pe,Q,W)}):S.resolve(ve).then(function(Pe){me.value=Pe,Q(me)},function(Pe){return b("throw",Pe,Q,W)})}W($.arg)}var O;a(this,"_invoke",{value:function(D,Q){function W(){return new S(function($,me){b(D,Q,$,me)})}return O=O?O.then(W,W):W()}})}function j(C,S,b){var O=m;return function(w,D){if(O===h)throw new Error("Generator is already running");if(O===y){if(w==="throw")throw D;return{value:e,done:!0}}for(b.method=w,b.arg=D;;){var Q=b.delegate;if(Q){var W=X(Q,b);if(W){if(W===_)continue;return W}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(O===m)throw O=y,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);O=h;var $=f(C,S,b);if($.type==="normal"){if(O=b.done?y:v,$.arg===_)continue;return{value:$.arg,done:b.done}}$.type==="throw"&&(O=y,b.method="throw",b.arg=$.arg)}}}function X(C,S){var b=S.method,O=C.iterator[b];if(O===e)return S.delegate=null,b==="throw"&&C.iterator.return&&(S.method="return",S.arg=e,X(C,S),S.method==="throw")||b!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+b+"' method")),_;var w=f(O,C.iterator,S.arg);if(w.type==="throw")return S.method="throw",S.arg=w.arg,S.delegate=null,_;var D=w.arg;return D?D.done?(S[C.resultName]=D.value,S.next=C.nextLoc,S.method!=="return"&&(S.method="next",S.arg=e),S.delegate=null,_):D:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,_)}function ee(C){var S={tryLoc:C[0]};1 in C&&(S.catchLoc=C[1]),2 in C&&(S.finallyLoc=C[2],S.afterLoc=C[3]),this.tryEntries.push(S)}function re(C){var S=C.completion||{};S.type="normal",delete S.arg,C.completion=S}function Z(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(ee,this),this.reset(!0)}function J(C){if(C||C===""){var S=C[u];if(S)return S.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var b=-1,O=function w(){for(;++b<C.length;)if(n.call(C,b))return w.value=C[b],w.done=!1,w;return w.value=e,w.done=!0,w};return O.next=O}}throw new TypeError(typeof C+" is not iterable")}return N.prototype=k,a(M,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:N,configurable:!0}),N.displayName=c(k,l,"GeneratorFunction"),r.isGeneratorFunction=function(C){var S=typeof C=="function"&&C.constructor;return!!S&&(S===N||(S.displayName||S.name)==="GeneratorFunction")},r.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,k):(C.__proto__=k,c(C,l,"GeneratorFunction")),C.prototype=Object.create(M),C},r.awrap=function(C){return{__await:C}},B(U.prototype),c(U.prototype,s,function(){return this}),r.AsyncIterator=U,r.async=function(C,S,b,O,w){w===void 0&&(w=Promise);var D=new U(d(C,S,b,O),w);return r.isGeneratorFunction(S)?D:D.next().then(function(Q){return Q.done?Q.value:D.next()})},B(M),c(M,l,"Generator"),c(M,u,function(){return this}),c(M,"toString",function(){return"[object Generator]"}),r.keys=function(C){var S=Object(C),b=[];for(var O in S)b.push(O);return b.reverse(),function w(){for(;b.length;){var D=b.pop();if(D in S)return w.value=D,w.done=!1,w}return w.done=!0,w}},r.values=J,Z.prototype={constructor:Z,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(re),!S)for(var b in this)b.charAt(0)==="t"&&n.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=e)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var b=this;function O(me,ve){return Q.type="throw",Q.arg=S,b.next=me,ve&&(b.method="next",b.arg=e),!!ve}for(var w=this.tryEntries.length-1;w>=0;--w){var D=this.tryEntries[w],Q=D.completion;if(D.tryLoc==="root")return O("end");if(D.tryLoc<=this.prev){var W=n.call(D,"catchLoc"),$=n.call(D,"finallyLoc");if(W&&$){if(this.prev<D.catchLoc)return O(D.catchLoc,!0);if(this.prev<D.finallyLoc)return O(D.finallyLoc)}else if(W){if(this.prev<D.catchLoc)return O(D.catchLoc,!0)}else{if(!$)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return O(D.finallyLoc)}}}},abrupt:function(S,b){for(var O=this.tryEntries.length-1;O>=0;--O){var w=this.tryEntries[O];if(w.tryLoc<=this.prev&&n.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var D=w;break}}D&&(S==="break"||S==="continue")&&D.tryLoc<=b&&b<=D.finallyLoc&&(D=null);var Q=D?D.completion:{};return Q.type=S,Q.arg=b,D?(this.method="next",this.next=D.finallyLoc,_):this.complete(Q)},complete:function(S,b){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&b&&(this.next=b),_},finish:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),re(O),_}},catch:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.tryLoc===S){var w=O.completion;if(w.type==="throw"){var D=w.arg;re(O)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(S,b,O){return this.delegate={iterator:J(S),resultName:b,nextLoc:O},this.method==="next"&&(this.arg=e),_}},r}function nLr(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function m2e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iLr(n.key),n)}}function aLr(e,r,t){return r&&m2e(e.prototype,r),t&&m2e(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function iLr(e){var r=oLr(e,"string");return typeof r=="symbol"?r:String(r)}function oLr(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}(0,tV.debugLog)("desktopGrid.ts loaded");var clt=nV.DesktopGrid=function(){function e(){nLr(this,e),this.service=rLr.NativeServices.GridService,(0,tV.debugLog)("DesktopGrid created")}return aLr(e,[{key:"init",value:function(){return Wte().async(function(n){for(;;)switch(n.prev=n.next){case 0:return(0,tV.debugLog)("DesktopGrid init"),n.next=3,Wte().awrap(this.service.stub());case 3:(0,tV.debugLog)("DesktopGrid init done");case 4:case"end":return n.stop()}},null,this,null,Promise)}}]),e}()});var h2e=T(zte=>{p();Object.defineProperty(zte,"__esModule",{value:!0});zte.default=sLr;var Hte=d2e(),uLr=v2e();function aV(){"use strict";aV=function(){return r};var e,r={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(C,S,b){C[S]=b.value},o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(C,S,b){return Object.defineProperty(C,S,{value:b,enumerable:!0,configurable:!0,writable:!0}),C[S]}try{c({},"")}catch(C){c=function(b,O,w){return b[O]=w}}function d(C,S,b,O){var w=S&&S.prototype instanceof E?S:E,D=Object.create(w.prototype),Q=new Z(O||[]);return a(D,"_invoke",{value:j(C,b,Q)}),D}function f(C,S,b){try{return{type:"normal",arg:C.call(S,b)}}catch(O){return{type:"throw",arg:O}}}r.wrap=d;var m="suspendedStart",v="suspendedYield",h="executing",y="completed",_={};function E(){}function N(){}function k(){}var q={};c(q,u,function(){return this});var V=Object.getPrototypeOf,I=V&&V(V(J([])));I&&I!==t&&n.call(I,u)&&(q=I);var M=k.prototype=E.prototype=Object.create(q);function B(C){["next","throw","return"].forEach(function(S){c(C,S,function(b){return this._invoke(S,b)})})}function U(C,S){function b(w,D,Q,W){var $=f(C[w],C,D);if($.type!=="throw"){var me=$.arg,ve=me.value;return ve&&typeof ve=="object"&&n.call(ve,"__await")?S.resolve(ve.__await).then(function(Pe){b("next",Pe,Q,W)},function(Pe){b("throw",Pe,Q,W)}):S.resolve(ve).then(function(Pe){me.value=Pe,Q(me)},function(Pe){return b("throw",Pe,Q,W)})}W($.arg)}var O;a(this,"_invoke",{value:function(D,Q){function W(){return new S(function($,me){b(D,Q,$,me)})}return O=O?O.then(W,W):W()}})}function j(C,S,b){var O=m;return function(w,D){if(O===h)throw new Error("Generator is already running");if(O===y){if(w==="throw")throw D;return{value:e,done:!0}}for(b.method=w,b.arg=D;;){var Q=b.delegate;if(Q){var W=X(Q,b);if(W){if(W===_)continue;return W}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(O===m)throw O=y,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);O=h;var $=f(C,S,b);if($.type==="normal"){if(O=b.done?y:v,$.arg===_)continue;return{value:$.arg,done:b.done}}$.type==="throw"&&(O=y,b.method="throw",b.arg=$.arg)}}}function X(C,S){var b=S.method,O=C.iterator[b];if(O===e)return S.delegate=null,b==="throw"&&C.iterator.return&&(S.method="return",S.arg=e,X(C,S),S.method==="throw")||b!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+b+"' method")),_;var w=f(O,C.iterator,S.arg);if(w.type==="throw")return S.method="throw",S.arg=w.arg,S.delegate=null,_;var D=w.arg;return D?D.done?(S[C.resultName]=D.value,S.next=C.nextLoc,S.method!=="return"&&(S.method="next",S.arg=e),S.delegate=null,_):D:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,_)}function ee(C){var S={tryLoc:C[0]};1 in C&&(S.catchLoc=C[1]),2 in C&&(S.finallyLoc=C[2],S.afterLoc=C[3]),this.tryEntries.push(S)}function re(C){var S=C.completion||{};S.type="normal",delete S.arg,C.completion=S}function Z(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(ee,this),this.reset(!0)}function J(C){if(C||C===""){var S=C[u];if(S)return S.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var b=-1,O=function w(){for(;++b<C.length;)if(n.call(C,b))return w.value=C[b],w.done=!1,w;return w.value=e,w.done=!0,w};return O.next=O}}throw new TypeError(typeof C+" is not iterable")}return N.prototype=k,a(M,"constructor",{value:k,configurable:!0}),a(k,"constructor",{value:N,configurable:!0}),N.displayName=c(k,l,"GeneratorFunction"),r.isGeneratorFunction=function(C){var S=typeof C=="function"&&C.constructor;return!!S&&(S===N||(S.displayName||S.name)==="GeneratorFunction")},r.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,k):(C.__proto__=k,c(C,l,"GeneratorFunction")),C.prototype=Object.create(M),C},r.awrap=function(C){return{__await:C}},B(U.prototype),c(U.prototype,s,function(){return this}),r.AsyncIterator=U,r.async=function(C,S,b,O,w){w===void 0&&(w=Promise);var D=new U(d(C,S,b,O),w);return r.isGeneratorFunction(S)?D:D.next().then(function(Q){return Q.done?Q.value:D.next()})},B(M),c(M,l,"Generator"),c(M,u,function(){return this}),c(M,"toString",function(){return"[object Generator]"}),r.keys=function(C){var S=Object(C),b=[];for(var O in S)b.push(O);return b.reverse(),function w(){for(;b.length;){var D=b.pop();if(D in S)return w.value=D,w.done=!1,w}return w.done=!0,w}},r.values=J,Z.prototype={constructor:Z,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(re),!S)for(var b in this)b.charAt(0)==="t"&&n.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=e)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var b=this;function O(me,ve){return Q.type="throw",Q.arg=S,b.next=me,ve&&(b.method="next",b.arg=e),!!ve}for(var w=this.tryEntries.length-1;w>=0;--w){var D=this.tryEntries[w],Q=D.completion;if(D.tryLoc==="root")return O("end");if(D.tryLoc<=this.prev){var W=n.call(D,"catchLoc"),$=n.call(D,"finallyLoc");if(W&&$){if(this.prev<D.catchLoc)return O(D.catchLoc,!0);if(this.prev<D.finallyLoc)return O(D.finallyLoc)}else if(W){if(this.prev<D.catchLoc)return O(D.catchLoc,!0)}else{if(!$)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return O(D.finallyLoc)}}}},abrupt:function(S,b){for(var O=this.tryEntries.length-1;O>=0;--O){var w=this.tryEntries[O];if(w.tryLoc<=this.prev&&n.call(w,"finallyLoc")&&this.prev<w.finallyLoc){var D=w;break}}D&&(S==="break"||S==="continue")&&D.tryLoc<=b&&b<=D.finallyLoc&&(D=null);var Q=D?D.completion:{};return Q.type=S,Q.arg=b,D?(this.method="next",this.next=D.finallyLoc,_):this.complete(Q)},complete:function(S,b){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&b&&(this.next=b),_},finish:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.finallyLoc===S)return this.complete(O.completion,O.afterLoc),re(O),_}},catch:function(S){for(var b=this.tryEntries.length-1;b>=0;--b){var O=this.tryEntries[b];if(O.tryLoc===S){var w=O.completion;if(w.type==="throw"){var D=w.arg;re(O)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(S,b,O){return this.delegate={iterator:J(S),resultName:b,nextLoc:O},this.method==="next"&&(this.arg=e),_}},r}function sLr(e){var r,t,n;return aV().async(function(o){for(;;)switch(o.prev=o.next){case 0:return r=(0,Hte.makeNotifierJSProxy)(),e.registerServiceInstances(r),t=(0,Hte.makeRequesterJSProxy)(),e.registerServiceInstances(t),n=new uLr.DesktopGrid,o.next=7,aV().awrap(n.init());case 7:return o.next=9,aV().awrap((0,Hte.attachPlugins)());case 9:case"end":return o.stop()}},null,null,null,Promise)}});p();mne();hne();$oe();oue();due();var lLr=lP(),S2e=Sle(),cLr=Q9();globalThis.__x10_target_platform="Win32";var dLr={appName:S2e.AppName,ariaTenantToken:S2e.AriaTenantToken,headlessApps:[{name:"DataCleansing",enableOption:!0,importModule:function(){return Promise.resolve().then(()=>NV(dfe()))}},{name:"x10",enableOption:function(){return(0,cLr.getTypedFeatureGate)("Microsoft.Office.Excel.DesktopX10UxppEnabled")},importModule:function(){return Promise.resolve().then(()=>NV(h2e()))}}]};(0,lLr.initHeadlessUxpp)(dLr);})();
//# sourceMappingURL=index.win32.bundle.map
