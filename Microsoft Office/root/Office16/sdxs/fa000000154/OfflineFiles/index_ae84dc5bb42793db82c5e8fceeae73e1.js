var TypeScriptModule;(()=>{var e,t=!1;window.onerror=function(){console.log("Window error")};var o=function(){var e=document.getElementById("loading");if(null!=e){e.style.visibility="hidden",e.style.display="none";var t=document.getElementById("spinnerContainer");null!=t?(t.style.visibility="hidden",t.style.display="none"):console.log("Failed to find spinnerContainer div.")}else console.log("Failed to find loading span.")},n=function(e,t){var o=document.getElementById("error");null!=o?(o.style.visibility="visible",o.style.display="block",o.style.padding="5px",o.textContent=e,t&&(o.style.color="#f3f2f1")):console.log("Failed to find error span.")},i=function(n){var i;console.log(n.data),console.log("Clear timer for connectivity error message since we connected with sharedialog.aspx"),clearTimeout(e);try{i=JSON.parse(n.data)}catch(e){return void console.log("Failed to parse postMessage event.")}var l=i.name;if("share_resize"===l){if(null==(r=document.getElementById("shareFrame")))return void console.log("Failed to find shareFrame.");r.style.height=i.height+"px",r.style.width=i.width+"px",Office.ExtensionLifeCycle.resize(i.width+10,i.height+35)}else if("share_started"===l&&!t){var r;if(o(),null==(r=document.getElementById("shareFrame")))return void console.log("Failed to find shareFrame.");r.style.visibility="visible",t=!0}try{OfficeFirstParty.PrivateApi.execute(n.data).then((function(e){return console.log(e)}))}catch(e){return void console.log("Failed to call PrivateApi.execute(): "+e)}},l=function(){var t=Office.context.hostSettings.get("Parameters");console.log("AuthToken="+t.AuthToken);var i=document.getElementById("shareForm");if(null!=i){var l={authToken:t.AuthToken.replace(/^(Bearer )/,""),webAbsoluteUrl:t.WebAbsoluteUrl,clientId:t.ClientId,mode:t.Mode,isFolder:!1,itemName:t.ItemName,itemUrl:t.ItemUrl,organizationName:t.OrganizationName,emailAddress:t.EmailAddress,correlationId:t.CorrelationId,scenarioId:t.ScenarioId,smkt:t.Smkt,disableLinkedInFeatures:!1,errorMessageNonConnectivity:t.ErrorMessageNonConnectivity,errorMessageConnectivity:t.ErrorMessageConnectivity,navId:t.NavId,hostOptions:{showCloseButton:!1,outlookAvailability:t.OutlookAvailability,isDarkMode:t.IsDarkMode,isSendCopyEnabled:t.IsSendCopyEnabled,isSendPdfEnabled:t.IsSendPdfEnabled}},r=document.createElement("input");if(r.type="text",r.name="context",r.value=JSON.stringify(l),i.appendChild(r),l.hostOptions.isDarkMode){var a=document.getElementById("body");if(null==a)return void console.log("Failed to find html body.");a.style.backgroundColor="#252423"}if(!l.webAbsoluteUrl)return console.log("Empty webAbsoluteUrl"),o(),void n(l.errorMessageNonConnectivity,l.hostOptions.isDarkMode);var s=document.createElement("input");s.type="text",s.name="access_token",s.value=l.authToken,i.appendChild(s);var d=l.webAbsoluteUrl+"/_layouts/15/sharedialog.aspx?crossdomain=true&migratedhosting=true&clientId="+l.clientId+"&clickTime="+Date.now();i.action=d;var c=document.getElementById("shareFrame");if(null!=c){var u="clipboard-read self "+l.webAbsoluteUrl+"; clipboard-write self "+l.webAbsoluteUrl;c.allow=u,i.submit(),e=setTimeout((function(){var e,t;console.log("Didn't get any post messages from sharedialog.aspx, likely not connected."),e=l.errorMessageConnectivity,t=l.hostOptions.isDarkMode,o(),n(e,t)}),3e4)}else console.log("Failed to find shareFrame.")}else console.log("Failed to find shareForm.")};document.addEventListener("DOMContentLoaded",(function(e){window.addEventListener("message",i,!1),Office.onReady(l)})),TypeScriptModule={}})();